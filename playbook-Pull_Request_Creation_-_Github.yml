contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 1.2.23
    packID: ContentManagement
    packName: XSOAR CI/CD
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: This playbook creates a pull request using Github integration.
id: Pull Request Creation - Github
inputs:
- description: Pull request description template.
  key: PullRequestTemplate
  playbookInputQuery: null
  required: true
  value: {}
- description: The name of the branch you want the changes pulled into, which must
    be an existing branch on the current repository.
  key: MainBranch
  playbookInputQuery: null
  required: true
  value: {}
name: Pull Request Creation - Github
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 21f56ea1-e6e2-4f27-8140-68d9e22529d9
      iscommand: false
      name: ""
      version: -1
    taskid: 21f56ea1-e6e2-4f27-8140-68d9e22529d9
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 480,
          "y": 725
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      branch_name:
        complex:
          root: inputs.MainBranch
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a branch.
      id: dd384c27-7c83-4c18-8e53-790b016c06c7
      iscommand: true
      name: Get main branch
      script: '|||GitHub-get-branch'
      type: regular
      version: -1
    taskid: dd384c27-7c83-4c18-8e53-790b016c06c7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1740
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      branch_name:
        complex:
          root: BranchName
      commit_sha:
        complex:
          accessor: CommitSHA
          root: GitHub.Branch
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Create a new branch.
      id: ab1f8a8d-96b2-43d5-8a88-fdebec91d755
      iscommand: true
      name: Create new branch
      script: '|||GitHub-create-branch'
      type: regular
      version: -1
    taskid: ab1f8a8d-96b2-43d5-8a88-fdebec91d755
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 367.5,
          "y": 2410
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      branch:
        complex:
          root: BranchName
      comment:
        complex:
          accessor: cicdpullrequestcomment
          root: incident
      files:
        complex:
          root: File
      git_integration:
        simple: GitHub
      pack:
        complex:
          root: PackName
      template:
        complex:
          root: inputs.PullRequestTemplate
      user:
        complex:
          root: DemistoUsers
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Commit the given files to GitHub, Bitbucket ot Gitlab.
      id: cae729f9-6d8f-4dc7-8360-f216b32f5813
      iscommand: false
      name: Commit files
      script: CommitFiles
      type: regular
      version: -1
    taskid: cae729f9-6d8f-4dc7-8360-f216b32f5813
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2730
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      base:
        complex:
          root: inputs.MainBranch
      body:
        complex:
          root: PR_text
      draft:
        simple: "false"
      head:
        complex:
          root: BranchName
      title:
        complex:
          accessor: cicdpullrequesttitle
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a new pull request.
      id: bd5da6c3-be6e-40cc-84e8-b7df09bd76a0
      iscommand: true
      name: Create pull request
      script: '|||GitHub-create-pull-request'
      type: regular
      version: -1
    taskid: bd5da6c3-be6e-40cc-84e8-b7df09bd76a0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3400
        }
      }
  "8":
    continueonerror: true
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      pull_number:
        complex:
          accessor: Number
          root: GitHub.PR
      reviewers:
        complex:
          accessor: cicdreviewer
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Requests reviews from GitHub users for a given pull request.
      id: 99a60e25-a0f2-4877-8249-46417c49a779
      iscommand: true
      name: Request pr review
      script: '|||GitHub-request-review'
      type: regular
      version: -1
    taskid: 99a60e25-a0f2-4877-8249-46417c49a779
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 3750
        }
      }
  "9":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: incident.cicdreviewer
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Add reviewer?
      id: 87625665-5af9-4f16-8852-9d7cc1158a75
      iscommand: false
      name: Add reviewer?
      type: condition
      version: -1
    taskid: 87625665-5af9-4f16-8852-9d7cc1158a75
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3575
        }
      }
  "18":
    continueonerror: true
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      branch_name:
        complex:
          root: BranchName
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a branch.
      id: acf12aa7-e0b5-4be7-82f3-b681fe4fce4c
      iscommand: true
      name: Get branch
      script: '|||GitHub-get-branch'
      type: regular
      version: -1
    taskid: acf12aa7-e0b5-4be7-82f3-b681fe4fce4c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2060
        }
      }
  "19":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Name
                root: GitHub.Branch
          operator: isEqualString
          right:
            iscontext: true
            value:
              simple: BranchName
      label: "yes"
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Does branch exist?
      id: 633c7cad-6240-4b33-8692-60eecedc81f3
      iscommand: false
      name: Does branch exist?
      type: condition
      version: -1
    taskid: 633c7cad-6240-4b33-8692-60eecedc81f3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2235
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Name
                root: GitHub.Branch
          operator: isEqualString
          right:
            iscontext: true
            value:
              simple: BranchName
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Does branch exist?
      id: fb955df1-6d7a-4ee0-80ae-416e900ab26c
      iscommand: false
      name: Does branch exist?
      type: condition
      version: -1
    taskid: fb955df1-6d7a-4ee0-80ae-416e900ab26c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2905
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: BranchName
      value:
        complex:
          accessor: cicdbranch
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e9293da4-c2f9-44f7-87c3-df00d582f1cb
      iscommand: false
      name: Set branch name from CI/CD Branch field
      script: Set
      type: regular
      version: -1
    taskid: e9293da4-c2f9-44f7-87c3-df00d582f1cb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1565
        }
      }
  "26":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: incident.cicdbranch
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Is there a branch name in the update branch field in the incident.
      id: 619e5339-d6a2-40df-820e-8358aca8c738
      iscommand: false
      name: Is CI/CD Branch field given
      type: condition
      version: -1
    taskid: 619e5339-d6a2-40df-820e-8358aca8c738
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1215
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      pack:
        complex:
          root: PackName
      use_command:
        simple: GitHub-get-branch
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        The script gets the pack name as input and suggests an available branch name, for example:
        pack name is "MyPack" the branch name will be "MyPack".
        If a branch with the name "MyPack" exists, the script return "MyPack_1".
      id: 52106987-11ce-4e99-8fdf-e801727e413c
      iscommand: false
      name: Suggest branch name
      script: SuggestBranchName
      type: regular
      version: -1
    taskid: 52106987-11ce-4e99-8fdf-e801727e413c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1390
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: BranchName
      value:
        complex:
          root: AvailableBranch
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1db5ed38-8943-4f14-8ef6-7e2834859a5a
      iscommand: false
      name: Set branch name from SuggestBranchName output
      script: Set
      type: regular
      version: -1
    taskid: 1db5ed38-8943-4f14-8ef6-7e2834859a5a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1565
        }
      }
  "29":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: incident.cicdpullrequestbranch
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Is there a branch name in the matching field in the CI/CD incident.
      id: 2641253d-0171-4231-8cbc-db33e3e6b601
      iscommand: false
      name: Is CI/CD Pull Request Branch field given
      type: condition
      version: -1
    taskid: 2641253d-0171-4231-8cbc-db33e3e6b601
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1040
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: BranchName
      value:
        complex:
          accessor: cicdpullrequestbranch
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 87d2f0fd-30c7-42d6-8310-a57bb1bc380e
      iscommand: false
      name: Set branch name from CI/CD Pull Request Branch field
      script: Set
      type: regular
      version: -1
    taskid: 87d2f0fd-30c7-42d6-8310-a57bb1bc380e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1565
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    scriptarguments:
      branch_name:
        complex:
          root: BranchName
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets pull requests corresponding to the given branch name.
      id: bf871ea0-2ab9-4a93-8fa9-a5258cc0d053
      iscommand: true
      name: Get pull request
      script: '|||GitHub-list-branch-pull-requests'
      type: regular
      version: -1
    taskid: bf871ea0-2ab9-4a93-8fa9-a5258cc0d053
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3750
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: MessageText
      value:
        simple: |-
          This pull request for the pack ${PackName} was updated by ${DemistoUsers.[0].username}:
          https://github.com/${GitHub.PR.Head.Repo.FullName}/pull/${GitHub.PR.Number}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: fd372789-c9c9-4074-83ee-93a3a19fd64c
      iscommand: false
      name: Set MessageText value for update action
      script: Set
      type: regular
      version: -1
    taskid: fd372789-c9c9-4074-83ee-93a3a19fd64c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 4100
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: MessageText
      value:
        simple: |-
          New pull request was created by ${DemistoUsers.[0].username} for the pack ${PackName}:
          https://github.com/${GitHub.PR.Head.Repo.FullName}/pull/${GitHub.PR.Number}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 82810f35-b458-4860-8444-a380498c539b
      iscommand: false
      name: Set MessageText for new pull request
      script: Set
      type: regular
      version: -1
    taskid: 82810f35-b458-4860-8444-a380498c539b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3925
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ba80256a-c59c-4f8a-8288-3321f6f8ef48
      iscommand: false
      name: Set the branch name
      type: title
      version: -1
    taskid: ba80256a-c59c-4f8a-8288-3321f6f8ef48
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3e27cc27-c147-4619-8f43-ce67ab50cfb5
      iscommand: false
      name: Check if branch exists and create it if not
      type: title
      version: -1
    taskid: 3e27cc27-c147-4619-8f43-ce67ab50cfb5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1915
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e7592ef9-7d47-45a2-8db4-5dca5a1cade7
      iscommand: false
      name: Commit the files
      type: title
      version: -1
    taskid: e7592ef9-7d47-45a2-8db4-5dca5a1cade7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2585
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: abd6533c-52cc-404f-8d93-12d89645e3ef
      iscommand: false
      name: Create new pull request
      type: title
      version: -1
    taskid: abd6533c-52cc-404f-8d93-12d89645e3ef
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3080
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c66df801-2886-421d-85c5-ef0a9368f1a8
      iscommand: false
      name: Update existing pull request
      type: title
      version: -1
    taskid: c66df801-2886-421d-85c5-ef0a9368f1a8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3590
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      base:
        complex:
          root: inputs.MainBranch
      body:
        complex:
          root: PR_text
      draft:
        simple: "false"
      head:
        complex:
          root: BranchName
      title:
        complex:
          root: PackName
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a new pull request.
      id: fd9eb151-0af1-4cfe-8eee-98bbe2be8883
      iscommand: true
      name: Create pull request with pack name as title
      script: '|||GitHub-create-pull-request'
      type: regular
      version: -1
    taskid: fd9eb151-0af1-4cfe-8eee-98bbe2be8883
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3400
        }
      }
  "46":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: cicdpullrequesttitle
                root: incident
          operator: isEmpty
      label: "yes"
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Is the field of the pull request title in the incident empty?
      id: b4fc03fc-4dbd-4f59-8653-6b19e87fbe21
      iscommand: false
      name: Is Pull Request title empty?
      type: condition
      version: -1
    taskid: b4fc03fc-4dbd-4f59-8653-6b19e87fbe21
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3225
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: ${PR_text}
      pull_number:
        simple: ${GitHub.PR.Number}
    separatecontext: false
    skipunavailable: false
    task:
      brand: GitHub
      description: Updates a pull request in a repository.
      id: 6cec6b0e-aae6-4377-8753-3d21e2561c5e
      iscommand: true
      name: Update pull request
      script: GitHub|||GitHub-update-pull-request
      type: regular
      version: -1
    taskid: 6cec6b0e-aae6-4377-8753-3d21e2561c5e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3925
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3295,
        "width": 1240,
        "x": 50,
        "y": 725
      }
    }
  }
