contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: This is a guided playbook for investigating malware alerts from EDR
id: bf3cd675-2c7d-46ec-87e3-bb237b0fada4
inputs: []
name: TCS-Malware Investigation IDP v1.2_JP
outputs: []
sourceplaybookid: 89a8c7df-1534-4678-8470-75050d4bc58d
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c9227bd7-161b-4c27-8ad1-e4c20e72bc81
      iscommand: false
      name: ""
      version: -1
    taskid: c9227bd7-161b-4c27-8ad1-e4c20e72bc81
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -290,
          "y": -14810
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: rawCloseReason
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: duplicate
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "120"
      "yes":
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 31432d4b-97c6-4876-869d-d23069fd9e90
      iscommand: false
      name: Is This a Re-Opened Duplicate Alert
      type: condition
      version: -1
    taskid: 31432d4b-97c6-4876-869d-d23069fd9e90
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -290,
          "y": -14660
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f1d04abd-5f1e-4d3c-84d1-1b15540bcbe6
      iscommand: false
      name: Start Detection and Closure SLA Timers
      type: title
      version: -1
    taskid: f1d04abd-5f1e-4d3c-84d1-1b15540bcbe6
    timertriggers:
    - action: start
      fieldname: closuresla
    - action: start
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": -290,
          "y": -14270
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.rawType
          operator: isEqualString
          right:
            value:
              simple: C2Communication
        - left:
            iscontext: true
            value:
              simple: incident.rawType
          operator: isEqualString
          right:
            value:
              simple: DoS
        - left:
            iscontext: true
            value:
              simple: incident.rawType
          operator: isEqualString
          right:
            value:
              simple: Reconnaissance
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 84a0ab85-39f3-49a8-8352-6b66650110b3
      iscommand: false
      name: Is This Playbook Triggered From Another Investigation Playbook ?
      type: condition
      version: -1
    taskid: 84a0ab85-39f3-49a8-8352-6b66650110b3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -290,
          "y": -14140
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "88"
    note: false
    quietmode: 0
    scriptarguments:
      username:
        complex:
          accessor: owner
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.get.user.by.username
      id: 379ae4a4-b14d-47f9-80a3-07dd412074cb
      iscommand: true
      name: Get Incident Owner Details
      script: Builtin|||getUserByUsername
      type: regular
      version: -1
    taskid: 379ae4a4-b14d-47f9-80a3-07dd412074cb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 150,
          "y": -12260
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    scriptarguments:
      assign_to_name:
        complex:
          accessor: email
          root: UserByUsername
      ids:
        complex:
          accessor: crowdstrikecompositeid
          root: incident
      update_status:
        simple: closed
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Perform actions on identity detection alerts.
      id: 1b9d3020-6a29-49b0-8eee-e63c75c3ef2f
      iscommand: true
      name: Update 'False Positive' Status In CrowdSrtike
      script: CrowdstrikeFalcon|||cs-falcon-resolve-identity-detection
      type: regular
      version: -1
    taskid: 1b9d3020-6a29-49b0-8eee-e63c75c3ef2f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1010,
          "y": -13555
        }
      }
  "11":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: csinvestigator
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: be5dbd54-8a56-4c18-8228-c78ce6b4cc1c
      iscommand: false
      name: Has Investigator Been Assigned in CrowdStrike ?
      type: condition
      version: -1
    taskid: be5dbd54-8a56-4c18-8228-c78ce6b4cc1c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -290,
          "y": -13460
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      email:
        complex:
          accessor: csinvestigator
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Assign analyst to incident.
        By default,  the analyst is picked randomly from the available users, according to the provided roles (if no roles provided, will fetch all users).
        Otherwise, the analyst will be picked according to the 'assignBy' arguments.
        machine-learning: DBot will calculated and decide who is the best analyst for the job.
        top-user: The user that is most commonly owns this type of incident
        less-busy-user: The less busy analyst will be picked to be the incident owner.
        online: The analyst is picked randomly from all online analysts, according to the provided roles (if no roles provided, will fetch all users).
        current: The user that executed the command
      id: 03f6f44f-7e77-4714-8fe9-07ee19d6a78b
      iscommand: false
      name: Assign Incident in XSOAR
      script: AssignAnalystToIncident
      type: regular
      version: -1
    taskid: 03f6f44f-7e77-4714-8fe9-07ee19d6a78b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -290,
          "y": -13220
        }
      }
  "13":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: owner
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d96cc103-b39c-48b7-839b-f56cd5e4496a
      iscommand: false
      name: Has Owner Been Assigned
      type: condition
      version: -1
    taskid: d96cc103-b39c-48b7-839b-f56cd5e4496a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -290,
          "y": -13650
        }
      }
  "16":
    continueonerror: true
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        simple: AutoAssignment_Lock
      timeout:
        simple: "600"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Demisto Lock
      description: Gets a specific lock. If the lock doesn't exist, it creates one.
        If the lock is already in use, the command waits until the lock is released
        or until timeout is reached. If timeout is reached and the lock hasn't been
        released, the command fails to get the lock.
      id: 0814a241-09a4-4388-8c9e-e369311da085
      iscommand: true
      name: Locking the Assignment Task
      script: Demisto Lock|||demisto-lock-get
      type: regular
      version: -1
    taskid: 0814a241-09a4-4388-8c9e-e369311da085
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 150,
          "y": -12810
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 2
    scriptarguments:
      desc:
        complex:
          accessor: incident_type
          root: incident.labels
      incidentid:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 97cd96f7-d803-4390-8dcb-dd7699ef8518
      iscommand: false
      name: AutoAssign Analyst To Incident
      script: 0021cb92-321d-4754-81a1-66fc6a41635d
      type: regular
      version: -1
    taskid: 97cd96f7-d803-4390-8dcb-dd7699ef8518
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 150,
          "y": -12610
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        simple: AutoAssignment_Lock
    separatecontext: false
    skipunavailable: false
    task:
      brand: Demisto Lock
      description: Release a lock
      id: 52165c62-d75a-4029-867a-bef67274a23f
      iscommand: true
      name: Release the Assignment Task
      script: Demisto Lock|||demisto-lock-release
      type: regular
      version: -1
    taskid: 52165c62-d75a-4029-867a-bef67274a23f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 150,
          "y": -12420
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      selectshift:
        complex:
          accessor: roles
          root: UserByUsername
          transformers:
          - args:
              from:
                value:
                  simple: '['
            operator: substringFrom
          - args:
              to:
                value:
                  simple: ']'
            operator: substringTo
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ' '
            operator: join
          - args:
              regex:
                value:
                  simple: ' CSOC-XSOAR-Admin'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Read-Only'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Operator'
              replaceWith: {}
            operator: replaceMatch
          - args:
              delimiter: {}
            operator: splitAndTrim
      shift:
        complex:
          accessor: roles
          root: UserByUsername
          transformers:
          - args:
              from:
                value:
                  simple: '['
            operator: substringFrom
          - args:
              to:
                value:
                  simple: ']'
            operator: substringTo
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ' '
            operator: join
          - args:
              regex:
                value:
                  simple: ' CSOC-XSOAR-Admin'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Read-Only'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Operator'
              replaceWith: {}
            operator: replaceMatch
          - args:
              delimiter: {}
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: e74ecaf0-adc1-4fa5-80fe-dd7dfe83394b
      iscommand: true
      name: Set Investigator Role In Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: e74ecaf0-adc1-4fa5-80fe-dd7dfe83394b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 150,
          "y": -11980
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "139"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6abd409f-341f-41ef-8417-5a30644d2a5a
      iscommand: false
      name: 'Sub Playbook: Check If Any Script For Auto Remediation Needs To Be Triggered'
      playbookId: 35d7c4a3-3bdc-4a91-8f36-e4746773113f
      type: playbook
      version: -1
    taskid: 6abd409f-341f-41ef-8417-5a30644d2a5a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 150,
          "y": -11810
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "0.5"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f8b8dfa5-fbe6-40fe-87d8-1bb463918dd6
      iscommand: true
      name: Set Severity to Informational
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f8b8dfa5-fbe6-40fe-87d8-1bb463918dd6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 150,
          "y": -11195
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        complex:
          accessor: severity
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 0833b473-8f37-4966-8857-b7c71aa1a243
      iscommand: true
      name: 'Set Original Severity to Incident '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 0833b473-8f37-4966-8857-b7c71aa1a243
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": -10740
        }
      }
  "25":
    continueonerror: true
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      assign_to_name:
        complex:
          accessor: email
          root: UserByUsername
      ids:
        complex:
          accessor: crowdstrikecompositeid
          root: incident
      update_status:
        simple: in_progress
      using:
        simple: CrowdstrikeFalcon_IDP
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Perform actions on identity detection alerts.
      id: 378c5ddb-0004-497e-8c98-bcafd147d0b8
      iscommand: true
      name: Update Incident Status In CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-resolve-identity-detection
      type: regular
      version: -1
    taskid: 378c5ddb-0004-497e-8c98-bcafd147d0b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -80,
          "y": -10420
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: runStatus
                root: incident.responsesla
          operator: isEqualString
          right:
            value:
              simple: running
      label: "yes"
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "89"
      "yes":
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a6ae0007-9cc4-4e49-83f7-b67933f73f8d
      iscommand: false
      name: Is Response SLA Still Running ?
      type: condition
      version: -1
    taskid: a6ae0007-9cc4-4e49-83f7-b67933f73f8d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 150,
          "y": -10250
        }
      }
  "27":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Have You Completed This Task
        options: []
        optionsarg:
        - simple: Yes - I've completed this task move to next stage
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Please Click The 'Lets Get Started!' Button To Stop The Response SLA
        Timer
      totalanswers: 0
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a412e0bf-8de7-4739-8c74-7037a8d205d1
      iscommand: false
      name: Please Click The 'Lets Get Started!' Button To Stop The Response SLA Timer
      type: collection
      version: -1
    taskid: a412e0bf-8de7-4739-8c74-7037a8d205d1
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 150,
          "y": -10070
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: "Is This a True Positive Alert ?\n(Study The IoC Threat Intelligence
          Report. Are IoCs Part of The XSOAR Block List ? Check if the indicators
          have block tags and the expiration status. Also check for 'Related Incidents') "
      cc: null
      format: ""
      methods: []
      replyOptions:
      - 'No, It is False Positive '
      - Not Sure - To Be Determined
      - No, its a Benign-True Positive
      - Yes, it is True Positive
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: {}
    nexttasks:
      'No, It is False Positive ':
      - "39"
      No, its a Benign-True Positive:
      - "38"
      Not Sure - To Be Determined:
      - "29"
      Yes, it is True Positive:
      - "133"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0689c156-fd74-4d1d-8a8d-b8da79410a58
      iscommand: false
      name: "Is This a True Positive Alert ? \n(Study The IoC Threat Intelligence
        Report. Are IoCs Part of The XSOAR Block List ? Check if the indicators have
        block tags and the expiration status. Also check for 'Related Incidents') "
      tags:
      - Note
      type: condition
      version: -1
    taskid: 0689c156-fd74-4d1d-8a8d-b8da79410a58
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -290,
          "y": -9580
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 24cf5214-52c8-4fd2-8090-5f5a998ed3b3
      iscommand: false
      name: Not Sure - To Be Determined
      type: title
      version: -1
    taskid: 24cf5214-52c8-4fd2-8090-5f5a998ed3b3
    timertriggers:
    - action: start
      fieldname: mitigationsla
    type: title
    view: |-
      {
        "position": {
          "x": 170,
          "y": -8530
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Based on The IoC Intel, Do You Need To Change The Alert Severity ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "34"
      "Yes":
      - "33"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 802f6de0-d9ec-4362-8da9-e05606c58880
      iscommand: false
      name: Based on The IoC Intel, Do You Need To Change The Alert Severity ?
      tags:
      - report
      type: condition
      version: -1
    taskid: 802f6de0-d9ec-4362-8da9-e05606c58880
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 170,
          "y": -8210
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 56d82c73-6e63-435b-8a88-0695800a31fa
      iscommand: false
      name: 'Sub Playbook: Re-Assess - Triage The Alert Severity'
      playbookId: b82a6df1-9a17-4fae-889e-c6f7bde37df1
      type: playbook
      version: -1
    taskid: 56d82c73-6e63-435b-8a88-0695800a31fa
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": -7880
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Based on Your Investigation So Far - Is This a True Positive Alert
          ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No, Its a Confirmed - False Positive
      - No, Its a Benign-True Positive
      - Yes, it is True Positive
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      No, Its a Benign-True Positive:
      - "38"
      No, Its a Confirmed - False Positive:
      - "39"
      Yes, it is True Positive:
      - "40"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 695e5a8e-e7cd-4e09-86c3-ff398ae93219
      iscommand: false
      name: Based on Your Investigation So Far - Is This a True Positive Alert ?
      tags:
      - report
      type: condition
      version: -1
    taskid: 695e5a8e-e7cd-4e09-86c3-ff398ae93219
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 170,
          "y": -7420
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 748da3b4-d170-4d38-8f79-dc97251e9f3b
      iscommand: false
      name: Benign True Positive (Stop Detection SLA)
      type: title
      version: -1
    taskid: 748da3b4-d170-4d38-8f79-dc97251e9f3b
    timertriggers:
    - action: stop
      fieldname: detectionsla
    - action: stop
      fieldname: mitigationsla
    type: title
    view: |-
      {
        "position": {
          "x": -70,
          "y": -4770
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d6651a62-e873-4819-86f9-880bdfe0ee96
      iscommand: false
      name: False Positive (Stop Detection SLA)
      type: title
      version: -1
    taskid: d6651a62-e873-4819-86f9-880bdfe0ee96
    timertriggers:
    - action: stop
      fieldname: detectionsla
    - action: stop
      fieldname: mitigationsla
    type: title
    view: |-
      {
        "position": {
          "x": -470,
          "y": -4770
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f17fda57-3b7f-4f8c-8c9e-1f7f30155091
      iscommand: false
      name: True Positive (Stop Detection SLA & Start Threat Response SLA)
      type: title
      version: -1
    taskid: f17fda57-3b7f-4f8c-8c9e-1f7f30155091
    timertriggers:
    - action: stop
      fieldname: detectionsla
    - action: start
      fieldname: threatresponsesla
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": -6135
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "134"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b7768339-4102-4862-8b22-e911eda24d9b
      iscommand: false
      name: Document & Close Investigation
      type: title
      version: -1
    taskid: b7768339-4102-4862-8b22-e911eda24d9b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -70,
          "y": -3375
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8504e435-70cd-4f38-8064-3a0783185dc2
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 8504e435-70cd-4f38-8064-3a0783185dc2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -70,
          "y": -2445
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d792c0bb-b03f-4141-8e8a-1570c140a515
      iscommand: false
      name: 'Sub Playbook: Re-Assess - Triage The Alert Severity'
      playbookId: b82a6df1-9a17-4fae-889e-c6f7bde37df1
      type: playbook
      version: -1
    taskid: d792c0bb-b03f-4141-8e8a-1570c140a515
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 480,
          "y": -6340
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: True Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: e2dcfa3a-8130-44eb-8b5f-34b973d68a9e
      iscommand: true
      name: Set 'Investigation Conclusion' To True Positive
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: e2dcfa3a-8130-44eb-8b5f-34b973d68a9e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": -5990
        }
      }
  "64":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: anyimpact
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Was there any Impact ? (service disruption, malware installed,
            successful C&C communication..etc) '
        options: []
        optionsarg:
        - {}
        - simple: "No"
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Was there any Impact ? (service disruption, malware installed, successful
        C&C communication..etc)
      totalanswers: 0
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "65"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f0b8c9da-e57f-43d7-8d0f-58cffd53c4d2
      iscommand: false
      name: 'Was there any Impact ? (service disruption, malware installed, successful
        C&C communication..etc) '
      type: collection
      version: -1
    taskid: f0b8c9da-e57f-43d7-8d0f-58cffd53c4d2
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 480,
          "y": -5820
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Was there any Impact ? .Answers
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "92"
      "yes":
      - "66"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 37467740-8be2-4841-8f2b-a62b37c30a18
      iscommand: false
      name: Does The CSOC Manager Need To Be Notified ? (auto select if impact is
        'Yes')
      tags:
      - report
      type: condition
      version: -1
    taskid: 37467740-8be2-4841-8f2b-a62b37c30a18
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": -5650
        }
      }
  "66":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: emailbody
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter Notification Message To CSOC Manager (give a brief about the
            true positive alert and the impact)
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: ""
      title: Enter Notification Message To CSOC Manager
      totalanswers: 0
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "113"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d2690ca2-4b66-47e4-8bf2-c13e7fdfd0c5
      iscommand: false
      name: Enter Notification Message To CSOC Manager (give a brief about the true
        positive alert and the impact)
      type: collection
      version: -1
    taskid: d2690ca2-4b66-47e4-8bf2-c13e7fdfd0c5
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 480,
          "y": -5475
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "92"
    note: false
    quietmode: 2
    scriptarguments:
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: "${incident.emailbody}\n\nInvestigation Link --> \nhttps://soar.tcsapps.com/#/Custom/caseinfoid/${incident.id}"
      cc:
        simple: ${UserByUsername.email}
      subject:
        simple: '*True Positive Notification* EDR Investigation - Severity - ${incident.mailerseverity}'
      to:
        simple: nimisha.prajapati@tcs.com,yogesh.gholap@tcs.com,csocsenioroperator@tcscomprod.onmicrosoft.com,csocanalyst@tcscomprod.onmicrosoft.com
      using:
        simple: Mail Sender_instance_CSOC_Mail
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 83e72cfa-c86c-475f-8c5d-faa185617f81
      iscommand: true
      name: Notify CSOC Manager & Necessary Stakeholders
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 83e72cfa-c86c-475f-8c5d-faa185617f81
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": -5090
        }
      }
  "72":
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Review The Alert - Check If You Need To Raise an IMT ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No -  IMT Not Required
      - Yes - I Have Raised an IMT
      - I'm Not Sure - Will Do It later
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      I'm Not Sure - Will Do It later:
      - "55"
      No -  IMT Not Required:
      - "73"
      Yes - I Have Raised an IMT:
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 27cb3b6c-2372-4b32-8640-98b8560b9877
      iscommand: false
      name: Review The Alert - Check If You Need To Raise an IMT ?
      type: condition
      version: -1
    taskid: 27cb3b6c-2372-4b32-8640-98b8560b9877
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": -4640
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 0c0b7fb6-d4bb-4eaf-8b30-7276ee99da74
      iscommand: true
      name: Update IMT Context To - No
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 0c0b7fb6-d4bb-4eaf-8b30-7276ee99da74
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": -4370
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "Yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: cad7f901-3d11-4535-8397-74bc81dc56fc
      iscommand: true
      name: Update IMT Context To - Yes
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: cad7f901-3d11-4535-8397-74bc81dc56fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": -4020
        }
      }
  "75":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtnumber
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Number
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: ""
      title: Enter The IMT Number
      totalanswers: 0
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "126"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 29038ac1-2fce-4bf8-87e1-7d035cd48fed
      iscommand: false
      name: Enter The IMT Number
      type: collection
      version: -1
    taskid: 29038ac1-2fce-4bf8-87e1-7d035cd48fed
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 500,
          "y": -3850
        }
      }
  "76":
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 1
    scriptarguments:
      closeNotes:
        simple: Duplicate - Auto Close
      closingnote:
        simple: Duplicate - Auto Close
      duplicateticketnumber:
        simple: NA. This is Duplicate - Auto Close incident.
      forensicsdone:
        simple: Not Applicable
      incidentclosingreason:
        simple: Duplicate
      investigationanalysis:
        simple: Not Applicable
      investigationconclusion:
        simple: Duplicate
      remediationrequired:
        simple: Not Applicable
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: e69bb1c9-bd5b-4eb7-85bc-b1de17549397
      iscommand: true
      name: Set Incident Closing Reason Context - Duplicate
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: e69bb1c9-bd5b-4eb7-85bc-b1de17549397
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -730,
          "y": -14100
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    scriptarguments:
      closeNotes:
        simple: False Positive - Auto Close
      closingnote:
        simple: False Positive - Auto Close
      forensicsdone:
        simple: Not Applicable
      incidentclosingreason:
        simple: False Positive
      investigationanalysis:
        simple: Not Applicable
      investigationconclusion:
        simple: False Positive
      remediationrequired:
        simple: Not Applicable
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 70e7921b-a474-4f9d-857d-82a0b0b01878
      iscommand: true
      name: Set Incident Closing Reason Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 70e7921b-a474-4f9d-857d-82a0b0b01878
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1010,
          "y": -3030
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: e2caf490-1dfe-4d93-8074-c5d9dcd08713
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: e2caf490-1dfe-4d93-8074-c5d9dcd08713
    timertriggers:
    - action: stop
      fieldname: closuresla
    type: regular
    view: |-
      {
        "position": {
          "x": -760,
          "y": -2775
        }
      }
  "82":
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c9cf914d-523e-4c03-83a0-76b1586eaa38
      iscommand: false
      name: 'Sub Playbook: Enrich & Contextualize EDR Alert Information'
      playbookId: 7fc59798-8aed-40aa-8d42-eb7b85340cd0
      type: playbook
      version: -1
    taskid: c9cf914d-523e-4c03-83a0-76b1586eaa38
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 150,
          "y": -11650
        }
      }
  "83":
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b25dd31f-9fd4-430f-8e85-b2a42ad51e59
      iscommand: false
      name: 'Sub Playbook  : Does Offence Belongs To Citi Project'
      playbookId: 5f927e50-cf6b-4d54-837b-d3ade76bc624
      type: playbook
      version: -1
    taskid: b25dd31f-9fd4-430f-8e85-b2a42ad51e59
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 200,
          "y": -14320
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Based on The IoC Intel, Do You Need To Change The Alert Severity ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "40"
      "Yes":
      - "62"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4c052943-994c-4ae7-8395-e9a1c264400c
      iscommand: false
      name: Based on The IoC Intel, Do You Need To Change The Alert Severity ?
      tags:
      - report
      type: condition
      version: -1
    taskid: 4c052943-994c-4ae7-8395-e9a1c264400c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": -6530
        }
      }
  "88":
    continueonerrortype: ""
    id: "88"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 917e0546-9663-40a7-83d6-260c3c75e232
      iscommand: false
      name: Start Acknowledgement SLA
      type: title
      version: -1
    taskid: 917e0546-9663-40a7-83d6-260c3c75e232
    timertriggers:
    - action: start
      fieldname: responsesla
    - action: start
      fieldname: acknowledgementsla
    type: title
    view: |-
      {
        "position": {
          "x": 150,
          "y": -12100
        }
      }
  "89":
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b2062245-f709-4f22-8c44-27dc6661783a
      iscommand: false
      name: Stop Acknowledgement SLA
      type: title
      version: -1
    taskid: b2062245-f709-4f22-8c44-27dc6661783a
    timertriggers:
    - action: stop
      fieldname: responsesla
    - action: stop
      fieldname: acknowledgementsla
    type: title
    view: |-
      {
        "position": {
          "x": 150,
          "y": -9905
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b847d599-cc99-4f5f-89e6-254a10f82efc
      iscommand: false
      name: Stop Threat Response SLA
      type: title
      version: -1
    taskid: b847d599-cc99-4f5f-89e6-254a10f82efc
    timertriggers:
    - action: stop
      fieldname: threatresponsesla
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": -4860
        }
      }
  "113":
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get the Server URL.
      id: e4dcafaa-9c4e-4250-8f9d-d19ece46d858
      iscommand: false
      name: Get server url
      script: GetServerURL
      type: regular
      version: -1
    taskid: e4dcafaa-9c4e-4250-8f9d-d19ece46d858
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": -5310
        }
      }
  "120":
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
      - "83"
    note: false
    quietmode: 0
    scriptarguments:
      tenant:
        complex:
          accessor: name
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: ' '
              fields:
                value:
                  simple: "-0"
            operator: Cut
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 4f59ebca-8bde-4e87-8dfe-39e6a011ffc1
      iscommand: true
      name: Set Tenant in Incident Field
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 4f59ebca-8bde-4e87-8dfe-39e6a011ffc1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -290,
          "y": -14450
        }
      }
  "121":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: whichslabreached
                root: incident
          operator: isEqualString
          right:
            value:
              simple: acknowledgementsla
        - left:
            iscontext: true
            value:
              complex:
                accessor: whichslabreached
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: acknowledgementsla
      label: "yes"
    continueonerrortype: ""
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "122"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cec9dbce-63ce-4d1c-8d10-4f23dd729b2f
      iscommand: false
      name: Is response sla breached?
      type: condition
      version: -1
    taskid: cec9dbce-63ce-4d1c-8d10-4f23dd729b2f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 150,
          "y": -9765
        }
      }
  "122":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: justificationforacknowledgementslabreached
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Provide justification for response sla violated
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: Your SOC team
      title: Provide justification for response sla violated
      totalanswers: 0
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Provide justification for response sla violated
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fae04a44-6b3a-4f5e-8f59-2166da23ab9a
      iscommand: false
      name: Provide justification for response sla violated
      type: collection
      version: -1
    taskid: fae04a44-6b3a-4f5e-8f59-2166da23ab9a
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 540,
          "y": -9590
        }
      }
  "123":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: vip_user_list
                root: lists
          operator: containsGeneral
          right:
            value:
              simple: ${incident.crowdstrikeusername}
      label: "yes"
    continueonerrortype: ""
    id: "123"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "125"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      id: bba92000-d249-4acc-8f39-01c1207a8d5c
      iscommand: false
      name: Check If User is Part of VIP List
      type: condition
      version: -1
    taskid: bba92000-d249-4acc-8f39-01c1207a8d5c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 150,
          "y": -11000
        }
      }
  "124":
    continueonerrortype: ""
    id: "124"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: High
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: ed24cd64-73af-45fb-8d46-62e70de593a9
      iscommand: true
      name: Set Severity to High
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ed24cd64-73af-45fb-8d46-62e70de593a9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -80,
          "y": -10590
        }
      }
  "125":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikeseverity
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: critical
      label: "yes"
    continueonerrortype: ""
    id: "125"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "124"
      "yes":
      - "26"
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2afc22ac-2eaf-453c-8ef5-fc6a83e79f89
      iscommand: false
      name: Check if Current CrowdStrike Severity is Critical
      type: condition
      version: -1
    taskid: 2afc22ac-2eaf-453c-8ef5-fc6a83e79f89
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -80,
          "y": -10780
        }
      }
  "126":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtlocation
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Location
        options: []
        optionsarg: []
        placeholder: 'Enter Branch and Location.  Eg: TCS-Mumbai-Olympus'
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: Your SOC team
      title: Enter The IMT Location
      totalanswers: 0
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: ""
      headerfontcolor: ""
      isexternalrtl: false
      sender: ""
      submitbuttonbackgroundcolor: ""
      submitbuttonfontcolor: ""
      submittext: ""
    id: "126"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2e4bed32-1d31-4aa2-8fac-7eb45c21598c
      iscommand: false
      name: Enter The IMT Location
      type: collection
      version: -1
    taskid: 2e4bed32-1d31-4aa2-8fac-7eb45c21598c
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 500,
          "y": -3700
        }
      }
  "133":
    continueonerrortype: ""
    id: "133"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "84"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7b080d0b-eb22-4669-8c7f-bdffe566a44b
      iscommand: false
      name: True Positive (Stop Detection SLA )
      type: title
      version: -1
    taskid: 7b080d0b-eb22-4669-8c7f-bdffe566a44b
    timertriggers:
    - action: stop
      fieldname: detectionsla
    - action: stop
      fieldname: mitigationsla
    type: title
    view: |-
      {
        "position": {
          "x": 550,
          "y": -6795
        }
      }
  "134":
    continueonerrortype: ""
    id: "134"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: 'If You''ve Concluded The Investigation Head Over To The ''Report
          Summary'' Tab And Write Your Report  '
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes, I've finished Writing My Report
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Yes, I've finished Writing My Report:
      - "135"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea5a9be7-aee3-4f59-8386-d4529faa2132
      iscommand: false
      name: 'If You''ve Concluded The Investigation Head Over To The ''Report Summary''
        Tab And Write Your Report  '
      type: condition
      version: -1
    taskid: ea5a9be7-aee3-4f59-8386-d4529faa2132
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -70,
          "y": -3250
        }
      }
  "135":
    continueonerrortype: ""
    id: "135"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Are You Ready To Close The Investigation ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes (make sure all mandatory fields are populated else the investigation will
        not close)
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Yes (make sure all mandatory fields are populated else the investigation will not close):
      - "138"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f6837c2c-b0cf-46a6-89c0-16899acee5e0
      iscommand: false
      name: Are You Ready To Close The Investigation ?
      type: condition
      version: -1
    taskid: f6837c2c-b0cf-46a6-89c0-16899acee5e0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -70,
          "y": -3060
        }
      }
  "136":
    continueonerror: true
    continueonerrortype: ""
    id: "136"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 8564806d-3047-402e-804e-6f1c88f43736
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 8564806d-3047-402e-804e-6f1c88f43736
    timertriggers:
    - action: stop
      fieldname: closuresla
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": -2650
        }
      }
  "137":
    continueonerrortype: ""
    id: "137"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 93e99556-0e0b-404e-85ce-294e4827c361
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 93e99556-0e0b-404e-85ce-294e4827c361
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 170,
          "y": -1050
        }
      }
  "138":
    continueonerrortype: ""
    id: "138"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "136"
    note: false
    quietmode: 0
    scriptarguments:
      append_comment:
        complex:
          accessor: closingnote
          root: incident
      assign_to_name:
        complex:
          accessor: email
          root: UserByUsername
      ids:
        complex:
          accessor: crowdstrikecompositeid
          root: incident
      update_status:
        simple: closed
      using:
        simple: CrowdstrikeFalcon_IDP
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Perform actions on identity detection alerts.
      id: a1558de7-264b-4a57-85f8-b2966580a13d
      iscommand: true
      name: Update Investigation Conclusion in EDR
      script: CrowdstrikeFalcon|||cs-falcon-resolve-identity-detection
      type: regular
      version: -1
    taskid: a1558de7-264b-4a57-85f8-b2966580a13d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": -2860
        }
      }
  "139":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikeseverity
                root: incident
          operator: InRange
          right:
            value:
              simple: 40,59
      label: Medium
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikeseverity
                root: incident
          operator: InRange
          right:
            value:
              simple: "60.79"
      label: High
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikeseverity
                root: incident
          operator: InRange
          right:
            value:
              simple: 80,100
      label: Critical
    continueonerrortype: ""
    id: "139"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      Critical:
      - "142"
      High:
      - "141"
      Medium:
      - "140"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4eee2bbd-8944-4508-8922-5bd08d3a9e93
      iscommand: false
      name: Check severity
      type: condition
      version: -1
    taskid: 4eee2bbd-8944-4508-8922-5bd08d3a9e93
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 150,
          "y": -11490
        }
      }
  "140":
    continueonerrortype: ""
    id: "140"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f99d6203-4c29-47e7-8219-fdc0e16d1c34
      iscommand: true
      name: Set severity to Medium
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f99d6203-4c29-47e7-8219-fdc0e16d1c34
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -690,
          "y": -11195
        }
      }
  "141":
    continueonerrortype: ""
    id: "141"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "3"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 80e6adfb-31f9-4eaa-89a0-49492465c22d
      iscommand: true
      name: Set severity to High
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 80e6adfb-31f9-4eaa-89a0-49492465c22d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -260,
          "y": -11195
        }
      }
  "142":
    continueonerrortype: ""
    id: "142"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "4"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 4b6983f3-34ad-4209-8211-c71ab2bdd956
      iscommand: true
      name: Set severity to Critical
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 4b6983f3-34ad-4209-8211-c71ab2bdd956
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 600,
          "y": -11195
        }
      }
  "143":
    continueonerrortype: ""
    id: "143"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "144"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 33597560-21bc-4ace-8994-420367194119
      iscommand: false
      name: 'Sub Playbook: Check If Alert is False Positive (Automated Check)'
      playbookId: 57cbcfda-6923-44d2-8210-227b97a195df
      type: playbook
      version: -1
    taskid: 33597560-21bc-4ace-8994-420367194119
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 210,
          "y": -13950
        }
      }
  "144":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${create Ticket}
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "Yes"
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: createTicket
          operator: isNotExists
      label: "No"
    continueonerrortype: ""
    id: "144"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "No":
      - "13"
      "Yes":
      - "145"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ab7964d9-7fc8-4ddf-852a-9e78c8424c1c
      iscommand: false
      name: Is This a False Positive Event ? (Automated Check)
      type: condition
      version: -1
    taskid: ab7964d9-7fc8-4ddf-852a-9e78c8424c1c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 200,
          "y": -13800
        }
      }
  "145":
    continueonerrortype: ""
    id: "145"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e3bb1d01-fa02-48d8-8923-19f4a1cff9e6
      iscommand: false
      name: False Positive (Stop Detection SLA)
      type: title
      version: -1
    taskid: e3bb1d01-fa02-48d8-8923-19f4a1cff9e6
    timertriggers:
    - action: stop
      fieldname: detectionsla
    - action: stop
      fieldname: mitigationsla
    type: title
    view: |-
      {
        "position": {
          "x": -1010,
          "y": -13680
        }
      }
  "146":
    continueonerror: true
    continueonerrortype: ""
    id: "146"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      assign_to_name:
        complex:
          accessor: email
          root: UserByUsername
      ids:
        complex:
          accessor: crowdstrikedetectionid
          root: incident
      using:
        simple: CrowdstrikeFalcon_IDP
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Perform actions on alerts.
      id: 0b38821a-59bf-4f6e-802f-3b9ce1853469
      iscommand: true
      name: Update Incident Owner In CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-resolve-identity-detection
      type: regular
      version: -1
    taskid: 0b38821a-59bf-4f6e-802f-3b9ce1853469
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 800,
          "y": -10380
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "123_24_#default#": 0.49,
      "125_124_#default#": 0.59,
      "13_11_#default#": 0.44,
      "1_76_yes": 0.52,
      "26_27_yes": 0.51,
      "28_29_Not Sure - To Be Determined": 0.31,
      "28_38_No, its a Benign-True Positive": 0.17,
      "28_39_No, It is False Positive ": 0.1,
      "32_33_Yes": 0.53,
      "34_38_No, Its a Benign-True Positive": 0.74,
      "34_40_Yes, it is True Positive": 0.46,
      "4_28_yes": 0.12,
      "65_66_yes": 0.39,
      "72_73_No -  IMT Not Required": 0.83
    },
    "paper": {
      "dimensions": {
        "height": 13825,
        "width": 2190,
        "x": -1010,
        "y": -14810
      }
    }
  }
