contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 3508ed26-1149-4c84-8d43-074a39a31fe9
inputs:
- description: ""
  key: IOC
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Add New Tag CSP Block Indicator v1.1_KR_WIP
outputs: []
quiet: true
sourceplaybookid: 3186f946-ebeb-4fec-8c59-71f81733bb52
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 868e2fb1-950d-458c-8c07-61c19a49fb43
      iscommand: false
      name: ""
      version: -1
    taskid: 868e2fb1-950d-458c-8c07-61c19a49fb43
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -390,
          "y": -5260
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e2a54ad2-954e-470f-86d1-81d6e0287595
      iscommand: false
      name: Is Indicator Context Set ?
      type: condition
      version: -1
    taskid: e2a54ad2-954e-470f-86d1-81d6e0287595
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -390,
          "y": -5120
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: indicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: ad2e638c-e08a-4bea-8eb7-b2ede07e1167
      iscommand: false
      name: Delete 'Indicator' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: ad2e638c-e08a-4bea-8eb7-b2ede07e1167
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -390,
          "y": -4905
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 29523c21-afc8-48e3-8887-81a1d36fbbce
      iscommand: true
      name: Check If IP Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 29523c21-afc8-48e3-8887-81a1d36fbbce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -350,
          "y": -315
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 874ad861-b587-45f9-85cf-5b66f0afa090
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 874ad861-b587-45f9-85cf-5b66f0afa090
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -350,
          "y": -90
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: expirydate
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: in 24 months
            operator: ModifyDateTime
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: da0c485d-00e8-4f7a-8883-afaa0ed4794c
      iscommand: false
      name: Calculate Expiry Date
      script: Set
      type: regular
      version: -1
    taskid: da0c485d-00e8-4f7a-8883-afaa0ed4794c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 120
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9fb1b04a-92dd-412a-8bbe-9fee181bdc5b
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 9fb1b04a-92dd-412a-8bbe-9fee181bdc5b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -310,
          "y": 660
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 732ee798-c1af-4d10-8129-2afad721a413
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 732ee798-c1af-4d10-8129-2afad721a413
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -290,
          "y": 890
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 3049cf25-857d-471d-8260-ffbcdb006a1e
      iscommand: true
      name: Add New CSP Tag to IP
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 3049cf25-857d-471d-8260-ffbcdb006a1e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -310,
          "y": 1165
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: IP
      value:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 0165bb23-df43-47ca-8f3d-008ff60d901e
      iscommand: true
      name: Tag The IP Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 0165bb23-df43-47ca-8f3d-008ff60d901e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1650,
          "y": -75
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ccc50a08-f1a9-4571-8d09-0dd1b290d86d
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: ccc50a08-f1a9-4571-8d09-0dd1b290d86d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -20,
          "y": 2220
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 48ac58dd-90c1-4e30-886a-0efdc69765a1
      iscommand: true
      name: Check If  domain Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 48ac58dd-90c1-4e30-886a-0efdc69765a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 120,
          "y": -410
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: d032c69e-7e58-43f4-86c1-faaf6c2ac159
      iscommand: true
      name: Check If Indicators Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: d032c69e-7e58-43f4-86c1-faaf6c2ac159
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -390,
          "y": -4740
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 48d987c4-9fa6-42dc-8f40-e006898227f7
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 48d987c4-9fa6-42dc-8f40-e006898227f7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -340,
          "y": 135
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: Domain
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 9f623b6d-13a3-4d51-83c7-e63a36c23508
      iscommand: true
      name: Tag The Domain Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 9f623b6d-13a3-4d51-83c7-e63a36c23508
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 20
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: URL
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: d883713f-3a5a-4d4a-867e-84f89928cc58
      iscommand: true
      name: Tag The URL Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: d883713f-3a5a-4d4a-867e-84f89928cc58
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1270,
          "y": 40
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: b5b2bee4-55ba-452d-8260-98e2c7063ddd
      iscommand: true
      name: Add New CSP Tag to Domain
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: b5b2bee4-55ba-452d-8260-98e2c7063ddd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 1165
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 36257bc1-1281-40b9-8202-8644e1536f5f
      iscommand: true
      name: Add New CSP Tag to URL
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 36257bc1-1281-40b9-8202-8644e1536f5f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -800,
          "y": 1165
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Address2.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 3d1a0db3-8754-41ea-8cf3-48ee07fe3f5d
      iscommand: false
      name: Delete IP IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 3d1a0db3-8754-41ea-8cf3-48ee07fe3f5d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -280,
          "y": 355
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 1a289272-5dd4-42ab-8bec-1fec46792189
      iscommand: false
      name: Delete URL IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 1a289272-5dd4-42ab-8bec-1fec46792189
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 355
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 342e6179-27b5-4bae-83f5-2b000b3c454e
      iscommand: false
      name: Delete  domain IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 342e6179-27b5-4bae-83f5-2b000b3c454e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 140,
          "y": 355
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: IP
      value:
        simple: ${inputs.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 80b8d22c-6a06-454c-8c8f-d1daff4b9703
      iscommand: true
      name: Tag The Hash Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 80b8d22c-6a06-454c-8c8f-d1daff4b9703
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2080,
          "y": -75
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: a3a66b8c-1d41-4050-8433-6b46679cb865
      iscommand: false
      name: Delete hash IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: a3a66b8c-1d41-4050-8433-6b46679cb865
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 340
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: a75d7a74-0c31-4b34-8961-0bc4c54634d1
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: a75d7a74-0c31-4b34-8961-0bc4c54634d1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 180,
          "y": 900
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 46a32c58-37f0-4c5e-833a-e5f0052daf05
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 46a32c58-37f0-4c5e-833a-e5f0052daf05
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -830,
          "y": 880
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 81adabba-63d4-43f4-8442-df01e641e7dd
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 81adabba-63d4-43f4-8442-df01e641e7dd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 900
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 8cd62e74-8823-43cc-8f09-e5de66e38b82
      iscommand: true
      name: Add New CSP Tag to  hash
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 8cd62e74-8823-43cc-8f09-e5de66e38b82
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 1165
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 3e06de71-8715-48ba-8e93-e7a195dc9937
      iscommand: true
      name: Check If  hash Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 3e06de71-8715-48ba-8e93-e7a195dc9937
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 590,
          "y": -450
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: ip
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.URL
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: url
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: domain
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.File
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: file
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      domain:
      - "39"
      file:
      - "67"
      ip:
      - "65"
      url:
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 329e4261-2282-4233-8453-55f0813ed7a4
      iscommand: false
      name: Check which input is defined
      type: condition
      version: -1
    taskid: 329e4261-2282-4233-8453-55f0813ed7a4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -390,
          "y": -4560
        }
      }
  "30":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 804ac496-4073-4bcb-89fb-bc0d1f5ad8cc
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 804ac496-4073-4bcb-89fb-bc0d1f5ad8cc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1150,
          "y": -345
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fac656f4-d1d8-449f-8545-140089d87969
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: fac656f4-d1d8-449f-8545-140089d87969
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 120,
          "y": -250
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9c2c55bc-1e14-413e-80ae-b49bc8b27281
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 9c2c55bc-1e14-413e-80ae-b49bc8b27281
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 580,
          "y": -240
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6363db13-b7f3-4762-8308-0988dbc8d1a9
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 6363db13-b7f3-4762-8308-0988dbc8d1a9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 630,
          "y": 120
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f4f246ae-a5ce-40a8-89bb-bc735f9106df
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: f4f246ae-a5ce-40a8-89bb-bc735f9106df
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -930,
          "y": 120
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a95375c3-3dcd-4540-8d45-40f86454f83d
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: a95375c3-3dcd-4540-8d45-40f86454f83d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 130,
          "y": 120
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 95355304-7e40-4582-8f88-a059b4f545c5
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 95355304-7e40-4582-8f88-a059b4f545c5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 620,
          "y": 680
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 67ac3689-27cc-4075-8a06-726239bd8dc1
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 67ac3689-27cc-4075-8a06-726239bd8dc1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 160,
          "y": 670
        }
      }
  "38":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "18"
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 988a4403-6050-4ed8-822a-3a0d1b3b3548
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 988a4403-6050-4ed8-822a-3a0d1b3b3548
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -960,
          "y": 680
        }
      }
  "39":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "75"
      "yes":
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d4986a8d-508c-40d2-8d7a-09e40d5f2128
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: d4986a8d-508c-40d2-8d7a-09e40d5f2128
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -800,
          "y": -4350
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "54"
      "yes":
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bd1402ba-46b2-4df5-8ced-3f6323d41533
      iscommand: false
      name: Is This IP Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: bd1402ba-46b2-4df5-8ced-3f6323d41533
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2130,
          "y": -4160
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "76"
      "yes":
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c305fb61-f7bc-4c38-813f-ca0e2705cb73
      iscommand: false
      name: Is This Domain Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: c305fb61-f7bc-4c38-813f-ca0e2705cb73
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -800,
          "y": -4140
        }
      }
  "47":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "104"
      "yes":
      - "101"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 30560d52-eb8e-400d-89cb-12347d419ada
      iscommand: false
      name: Is This Hash Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 30560d52-eb8e-400d-89cb-12347d419ada
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1880,
          "y": -4160
        }
      }
  "48":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "82"
      "yes":
      - "84"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 802d6f24-26b8-47bd-8a67-a72f0447244e
      iscommand: false
      name: Is This URL Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 802d6f24-26b8-47bd-8a67-a72f0447244e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": -4140
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3c2336f2-a17a-4f2b-8c62-6930b19bc88e
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 3c2336f2-a17a-4f2b-8c62-6930b19bc88e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1970,
          "y": -3990
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 56921211-9edc-4093-8547-b972d4acf2c6
      iscommand: true
      name: Add New CSP Tag to IP and Set Expiry to 30 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 56921211-9edc-4093-8547-b972d4acf2c6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1930,
          "y": -3640
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 64bf5642-86bb-446d-8bf0-a7810ed6d06b
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 64bf5642-86bb-446d-8bf0-a7810ed6d06b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1970,
          "y": -3810
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "70"
      "yes":
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5763cd03-0329-486f-8cf5-af09a8004ca6
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 5763cd03-0329-486f-8cf5-af09a8004ca6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1900,
          "y": -4350
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "81"
      "yes":
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 330da877-dab7-4efd-8bc1-3cc6570f1149
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 330da877-dab7-4efd-8bc1-3cc6570f1149
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": -4330
        }
      }
  "67":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "102"
      "yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 34986c64-0902-451d-8116-6f5a4f8714a7
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 34986c64-0902-451d-8116-6f5a4f8714a7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1870,
          "y": -4330
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 914ca75a-aa83-4629-86cd-0d27f857fd3f
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 914ca75a-aa83-4629-86cd-0d27f857fd3f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -640,
          "y": -3380
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: IP
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 90aabe9e-d6fb-48fc-8a5e-0036c497358f
      iscommand: true
      name: Create New CSP IP Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 90aabe9e-d6fb-48fc-8a5e-0036c497358f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1520,
          "y": -4140
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: ef239745-284a-4308-83f0-1395d09189d2
      iscommand: true
      name: 'Set expiry date to 30 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: ef239745-284a-4308-83f0-1395d09189d2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1520,
          "y": -3745
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 503a7493-b102-41ba-89e3-3e72d9e24cf7
      iscommand: false
      name: Delete IP IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 503a7493-b102-41ba-89e3-3e72d9e24cf7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2340,
          "y": -3690
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "80"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: Domain
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 77f2ba4e-6f92-47be-8778-f8725100f95b
      iscommand: true
      name: Create New CSP Domain Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 77f2ba4e-6f92-47be-8778-f8725100f95b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -360,
          "y": -4065
        }
      }
  "76":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b8dcd231-5857-4a3d-8360-c18812868df1
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: b8dcd231-5857-4a3d-8360-c18812868df1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -780,
          "y": -3965
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: b2dacc2d-2e0f-4085-839d-94167e1878f8
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: b2dacc2d-2e0f-4085-839d-94167e1878f8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -770,
          "y": -3730
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: b1c7130f-7af0-4ab7-8343-649ed8d3f07c
      iscommand: false
      name: Delete Domain IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: b1c7130f-7af0-4ab7-8343-649ed8d3f07c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1140,
          "y": -3610
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 823039d0-ca02-4d7e-84f7-1f9a26ffb68e
      iscommand: true
      name: Add New CSP Tag to Domain and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 823039d0-ca02-4d7e-84f7-1f9a26ffb68e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -730,
          "y": -3560
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: d507fd09-7022-4065-8016-1d9a005abf9a
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: d507fd09-7022-4065-8016-1d9a005abf9a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -340,
          "y": -3690
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: URL
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: ba41e8ca-a43d-478e-8c5a-b0a6264cfa17
      iscommand: true
      name: Create New CSP URL Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: ba41e8ca-a43d-478e-8c5a-b0a6264cfa17
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": -3990
        }
      }
  "82":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "85"
      "yes":
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fb6ecce5-e179-4843-80f9-8395109ba196
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: fb6ecce5-e179-4843-80f9-8395109ba196
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 420,
          "y": -3920
        }
      }
  "83":
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "85"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 8e42f1ab-62f0-4881-8307-0b4d6df00b66
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 8e42f1ab-62f0-4881-8307-0b4d6df00b66
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": -3745
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 8d535c61-e70c-46b9-8b62-b3d3ad09dbe4
      iscommand: false
      name: Delete  URL OC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 8d535c61-e70c-46b9-8b62-b3d3ad09dbe4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": -3580
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 16b1390b-3e4b-4f37-8f81-10e57854f7ce
      iscommand: true
      name: Add New CSP Tag to URL and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 16b1390b-3e4b-4f37-8f81-10e57854f7ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 420,
          "y": -3595
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: 44d65846-9dd3-4f48-857a-14bbc168ed1f
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: 44d65846-9dd3-4f48-857a-14bbc168ed1f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 830,
          "y": -3605
        }
      }
  "101":
    continueonerrortype: ""
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: File
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: ff769c3d-d653-4043-80c3-56b843768f08
      iscommand: false
      name: Delete  File OC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: ff769c3d-d653-4043-80c3-56b843768f08
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1730,
          "y": -3785
        }
      }
  "102":
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "103"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: File
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 0bd63ea7-a533-47bf-8eb7-c78a97727abb
      iscommand: true
      name: Create New CSP File Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 0bd63ea7-a533-47bf-8eb7-c78a97727abb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1290,
          "y": -3980
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: 95481c13-a738-4997-8179-fbeb1f9ec924
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: 95481c13-a738-4997-8179-fbeb1f9ec924
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1280,
          "y": -3650
        }
      }
  "104":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "106"
      "yes":
      - "105"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 50d2abff-b468-4e6b-88c7-0ca0c0b1944a
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 50d2abff-b468-4e6b-88c7-0ca0c0b1944a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2170,
          "y": -3940
        }
      }
  "105":
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 109dc94f-82f7-4a2c-890b-97facadba3c6
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 109dc94f-82f7-4a2c-890b-97facadba3c6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2190,
          "y": -3760
        }
      }
  "106":
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 0690a55f-8e37-4018-8309-6c920b99aae8
      iscommand: true
      name: Add New CSP Tag to File and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 0690a55f-8e37-4018-8309-6c920b99aae8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2170,
          "y": -3560
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "1_2_yes": 0.44,
      "29_67_file": 0.45,
      "39_45_yes": 0.51,
      "54_56_yes": 0.53,
      "65_44_yes": 0.35,
      "66_48_yes": 0.37,
      "67_47_yes": 0.58
    },
    "paper": {
      "dimensions": {
        "height": 7545,
        "width": 4910,
        "x": -2340,
        "y": -5260
      }
    }
  }
