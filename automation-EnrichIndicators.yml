args:
- auto: PREDEFINED
  name: Type
  predefined:
  - IP
  - URL
  - Domain
  - File
  required: true
- description: Enter parameter value for the Type selected
  name: Field1
- description: Enter parameter value for the Type selected
  name: Field2
- description: Enter parameter value for the Type selected
  name: Field3
- description: Enter parameter value for the Type selected
  name: Field4
- description: Enter parameter value for the Type selected
  name: Field5
comment: Enrich the indicators. For now, 5 fields are the maximum. Change if needed.
commonfields:
  id: bc888e3b-5e7f-4516-8476-4e2b361ba508
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: 4. UTILITY - IOCs Enrichment Contribution Pack
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.10.8.39276
enabled: true
engineinfo: {}
mainengineinfo: {}
name: EnrichIndicators
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  ########################################################################################
  ## PANW XSOAR - Custom Integration
  ##
  ## Description  : Enrich the indicators for all the needed types
  ## Use Case     : Enrich indicators
  ##
  ## Vendor       : PANW XSOAR
  ## Version      : v0.1
  ## Changelog    : 01-12-2022: Initial version
  ##
  ##
  ## Status       : WORKING
  ## Author       : Senthil
  ##
  ## File Name    : EnrichIndicators
  ##
  ## Comments     : - N/A
  ##
  ## Requirements : 1. PANW XSOAR installed
  ##
  ##
  ## Installation : 1. Comply with script requirements above mentioned
  ##                2. Copy/import script into PANW Automations
  ##                3.
  ##
  ## TO DO's      : - N/A
  ######################################################################################


  INC = demisto.incidents()[0]
  TYPE = demisto.args()['Type']
  FIELD1 = demisto.args()['Field1'] if "Field1" in demisto.args() else ""
  FIELD2 = demisto.args()['Field2'] if "Field2" in demisto.args() else ""
  FIELD3 = demisto.args()['Field3'] if "Field3" in demisto.args() else ""
  FIELD4 = demisto.args()['Field4'] if "Field4" in demisto.args() else ""
  FIELD5 = demisto.args()['Field5'] if "Field5" in demisto.args() else ""
  ENRICHMENTS = "Enrichments:\n-----------------------------------------\n"

  def call_enrichment(cmd, val):
      global ENRICHMENTS
      result = demisto.executeCommand(cmd, {cmd:val})
      ENRICHMENTS += results  + "\n-------------\n"


  if TYPE == "IP":
      cmd = "ip"
      ENRICHMENTS += "IP Enrichment : \n--------------------------------------\n"
  elif TYPE == "URL":
      cmd = "url"
      ENRICHMENTS += "URL Enrichment : \n--------------------------------------\n"
  elif TYPE == "Domain":
      cmd = "domain"
      ENRICHMENTS += "Domain Enrichment : \n--------------------------------------\n"
  elif TYPE == "File":
      cmd = "file"
      ENRICHMENTS += "File Enrichment : \n--------------------------------------\n"

  if FIELD1 != "":
      call_enrichment(cmd, FIELD1)
  elif FIELD2 != "":
      call_enrichment(cmd, FIELD2)
  elif FIELD3 != "":
      call_enrichment(cmd, FIELD3)
  elif FIELD4 != "":
      call_enrichment(cmd, FIELD4)
  elif FIELD5 != "":
      call_enrichment(cmd, FIELD5)

  demisto.executeCommand('setIncident', {'enrichments':ENRICHMENTS})
scripttarget: 0
subtype: python3
tags: []
type: python
