contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
hidden: true
id: df52d942-4f2c-4ce5-8439-82546190fad3
inputs: []
name: TCS-OnDemand Host Containment Playbook v1.4
outputs: []
sourceplaybookid: dc7d02c4-9e4e-4e78-866e-35dde9c38272
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 373bafaf-ed9f-45b4-8ce1-b7d3b7a3d6a8
      iscommand: false
      name: ""
      version: -1
    taskid: 373bafaf-ed9f-45b4-8ce1-b7d3b7a3d6a8
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 910,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: b68a50af-d0ea-4379-86f7-5bd5aed2cd90
      iscommand: false
      name: Read The Text Attachment
      script: ReadFile
      type: regular
      version: -1
    taskid: b68a50af-d0ea-4379-86f7-5bd5aed2cd90
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 370
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TCSHostname
      value:
        complex:
          root: FileData
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c11a494c-0f3d-472b-8fcc-d360734ee956
      iscommand: false
      name: Set Data To Context
      script: Set
      type: regular
      version: -1
    taskid: c11a494c-0f3d-472b-8fcc-d360734ee956
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 545
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          root: TCSHostname
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: e0dbc1ba-90ae-4fa8-81bc-e0f448afc542
      iscommand: true
      name: Get Host Data From Crowdstrike
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: e0dbc1ba-90ae-4fa8-81bc-e0f448afc542
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 1070
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        complex:
          accessor: Device
          root: CrowdStrike
      fileName:
        simple: Crowdstrike_Host_Contained_Report.csv
      headers:
        simple: Hostname,ID,FirstSeen,LastSeen,OS,ExternalIP,LocalIP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: dd82a309-d35f-472e-88e7-531b84ed134c
      iscommand: false
      name: Create Excel Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: dd82a309-d35f-472e-88e7-531b84ed134c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1945
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: dd7bffb8-4274-4ac2-8082-0d8fe7aa3e64
      iscommand: false
      name: Set Report To New Context
      script: Set
      type: regular
      version: -1
    taskid: dd7bffb8-4274-4ac2-8082-0d8fe7aa3e64
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2120
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        complex:
          root: TCSHostname
          transformers:
          - operator: toUpperCase
      right:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
          transformers:
          - operator: toUpperCase
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 24692cfe-c371-4e76-8f24-00be0c32b7ce
      iscommand: false
      name: Compare Submitted List With CS Results
      script: CompareLists
      type: regular
      version: -1
    taskid: 24692cfe-c371-4e76-8f24-00be0c32b7ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2295
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8c2d782a-0f32-44ab-8bbe-423ac10fadb1
      iscommand: false
      name: Are There Any Hosts Not Found in CrowdStrike ?
      type: condition
      version: -1
    taskid: 8c2d782a-0f32-44ab-8bbe-423ac10fadb1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2470
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Hostnotfound
      value:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8106e896-6b0e-4098-82ea-dfdf81087cd8
      iscommand: false
      name: Set The Host To Context
      script: Set
      type: regular
      version: -1
    taskid: 8106e896-6b0e-4098-82ea-dfdf81087cd8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2645
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: CrowdStrike
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Hostname
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f3361de0-0547-48a7-8956-a7fa51fb4f41
      iscommand: false
      name: Host Found on CrowdStrike?
      type: condition
      version: -1
    taskid: f3361de0-0547-48a7-8956-a7fa51fb4f41
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 1245
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |
          Hello Human,

          None of the Hostname in this list - ${incident.attachment.name} were found in Crowdstrike.

          Regards,
          Cyber Autobot
          Automation task id : ${incident.id}
      cc:
        simple: v.ghule@tcs.com
      subject:
        simple: None of The Hostname in this list - ${incident.attachment.name} Were
          Found in Crowdstrike
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 52e25925-4cba-4564-8fe4-5ac10cba732c
      iscommand: true
      name: Send Notification 'No Hosts Found on Crowdstrike'
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 52e25925-4cba-4564-8fe4-5ac10cba732c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 3345
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${Report}
      body:
        simple: |
          Hello Human,

          I have contained all the hosts shared in this list - ${incident.attachment.name}. Please refer to the attached report.


          Regards,
          Cyber Autobot
          Automation id : ${incident.id}
      cc:
        simple: v.ghule@tcs.com,kunal.krushev@tcs.com
      subject:
        simple: ' Crowdstrike Contained Host Report For Submitted File - ${incident.attachment.name}'
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 3e26db6c-a20c-4ff1-8b7c-2707886aac85
      iscommand: true
      name: Send Host Containment Report (All Hosts)
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 3e26db6c-a20c-4ff1-8b7c-2707886aac85
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3345
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${Report}
      body:
        simple: |
          Hello Human,

          I have contained some of the hosts shared in this list - ${incident.attachment.name}

          PFA report of hosts contained and also a list of hosts not found in the CrowdStrike database.


          Regards,
          Cyber Autobot
          Automation id : ${incident.id}
      cc:
        simple: v.ghule@tcs.com,kunal.krushev@tcs.com
      subject:
        simple: ' Crowdstrike Contained Host Report For Submitted File - ${incident.attachment.name}'
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: c1dd4d10-021c-436a-82fa-75c3db612bde
      iscommand: true
      name: Send Host Containment Report (Some Hosts)
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: c1dd4d10-021c-436a-82fa-75c3db612bde
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3345
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: Priyanka.chouhan2@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: shiva1.shankar@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: v.ghule@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: kunal.krushev@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: yogesh.gholap@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: InternalIS.SecurityCompliance@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: pawan.pavanje@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8b22be2b-a2c8-4d85-8b48-1cfffb3e4e27
      iscommand: false
      name: Is Email From Authorized Sender ?
      type: condition
      version: -1
    taskid: 8b22be2b-a2c8-4d85-8b48-1cfffb3e4e27
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 910,
          "y": 195
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello Human,

          You are not on my authorized list of senders. Please contact Your XSOAR Support team.

          Regards,
          CSOC Cyber AutoBot
          Automation task id : ${incident.id}
      cc:
        simple: kunal.krushev@tcs.com,v.ghule@tcs.com,sonam.bhandari@tcs.com
      subject:
        simple: Not Authorized For This Task
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: bc3d3b1b-e808-484f-83cb-e6af7b410c7b
      iscommand: true
      name: Send Notification 'Not Authorized Sender'
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: bc3d3b1b-e808-484f-83cb-e6af7b410c7b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3345
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 2ffb430a-cbcb-4568-83a6-83f31b85c847
      iscommand: true
      name: Close Playbook
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 2ffb430a-cbcb-4568-83a6-83f31b85c847
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3520
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 85435cde-074d-4d75-825b-227286b1d6c4
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 85435cde-074d-4d75-825b-227286b1d6c4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3695
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      context_key:
        simple: Hostnotfoundarray
      file_name:
        simple: Host_Not_Found.csv
      header:
        simple: Hostname
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c5f08ccb-acb2-4ba7-8ea8-e559eba42c4a
      iscommand: false
      name: Create Excel Report of Hosts Not Found
      script: 98fd7176-124d-4739-8f9d-2f1edb20aa55
      type: regular
      version: -1
    taskid: c5f08ccb-acb2-4ba7-8ea8-e559eba42c4a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2985
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: acdc949e-8551-4bcd-80c1-be642828496b
      iscommand: false
      name: Set Report To New Context
      script: Set
      type: regular
      version: -1
    taskid: acdc949e-8551-4bcd-80c1-be642828496b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3170
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        complex:
          root: Hostnotfound
      contextKey:
        simple: Hostnotfoundarray
      separator:
        simple: ','
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: ee1aee5c-5fc7-4f56-8e34-f776c13547eb
      iscommand: false
      name: Create Array For Report
      script: CreateArray
      type: regular
      version: -1
    taskid: ee1aee5c-5fc7-4f56-8e34-f776c13547eb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2820
        }
      }
  "21":
    continueonerror: true
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          root: CrowdStrike.Device
          transformers:
          - operator: uniq
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Contains containment for a specified host. When contained, a host
        can only communicate with the CrowdStrike cloud and any IPs specified in your
        containment policy.
      id: a669edbb-48a7-410a-86f1-3e79a111f9cd
      iscommand: true
      name: Contain Host
      script: CrowdstrikeFalcon|||cs-falcon-contain-host
      type: regular
      version: -1
    taskid: a669edbb-48a7-410a-86f1-3e79a111f9cd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": 1730
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${TCSHostname}
      contextKey:
        simple: TCSHostnameArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: 8f6c7a70-09d5-41b4-8612-74bc75eeb999
      iscommand: false
      name: Create Array of Input Data
      script: CreateArray
      type: regular
      version: -1
    taskid: 8f6c7a70-09d5-41b4-8612-74bc75eeb999
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 720
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        simple: ${TCSHostnameArray}
      contextKey:
        simple: TCSHostnameArrayCount
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 538f704b-6436-4654-8efd-91985a5eed4f
      iscommand: false
      name: Count The Array Data And Set It To Context
      script: CountArraySize
      type: regular
      version: -1
    taskid: 538f704b-6436-4654-8efd-91985a5eed4f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 895
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        simple: ${CrowdStrike.Device.ID}
      contextKey:
        simple: CrowdStrikeDeviceIDCount
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 951f5c18-7a26-4fb1-82a4-663d8c3f37ac
      iscommand: false
      name: Count The CS Host ID Array Count And Set It To Context
      script: CountArraySize
      type: regular
      version: -1
    taskid: 951f5c18-7a26-4fb1-82a4-663d8c3f37ac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1380
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "31"
      "yes":
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      first:
        simple: ${CrowdStrikeDeviceIDCount}
      second:
        simple: ${TCSHostnameArrayCount}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Checks if one number(float) as bigger than the other(float)
        Returns yes: if first > second
        Returns no: if first <= second
        Returns exception if one of the inputs is not a number
      id: 525607c2-6882-4a59-8fbe-e2c5eeb95ca0
      iscommand: false
      name: Compare The Count Value Of The CrowdStrike Output With The Original Input
      script: IsGreaterThan
      type: condition
      version: -1
    taskid: 525607c2-6882-4a59-8fbe-e2c5eeb95ca0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1550
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |
          Hello Human,

          One of the Hostnames in this list - ${incident.attachment.name} is not unique, and resolves to multiple device IDs. Unfortunately I've not yet learnt to identify the hostname causing the issue. Request you to review this manually.

          Regards,
          Cyber Autobot
          Automation task id : ${incident.id}
      cc:
        simple: v.ghule@tcs.com, kunal.krushev@tcs.com
      subject:
        simple: One of The CrowdStrike Host(s) Is Not Unique - ${incident.attachment.name}
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: c654e03e-8d2f-412a-8df7-9bfb8f20bf31
      iscommand: true
      name: Send Notification 'One of The Host Inputs is Not Unique'
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: c654e03e-8d2f-412a-8df7-9bfb8f20bf31
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3345
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ${CrowdStrike}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 42cd8183-92f5-4589-8f59-e3ef34359975
      iscommand: false
      name: Delete Crowdstrike Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 42cd8183-92f5-4589-8f59-e3ef34359975
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 390,
          "y": 1430
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "4"
      "yes":
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      id: d898366f-d4e9-49c0-8ef9-8b941ebfcec3
      iscommand: false
      name: check if containment fails
      script: isError
      type: condition
      version: -1
    taskid: d898366f-d4e9-49c0-8ef9-8b941ebfcec3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 130,
          "y": 1760
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e6efa119-5b3d-4719-88d8-7d768b4295bc
      iscommand: false
      name: Get error message
      script: dfaf73eb-0458-4817-86b5-7588ccf04c64
      type: regular
      version: -1
    taskid: e6efa119-5b3d-4719-88d8-7d768b4295bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 140,
          "y": 1990
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hi Team,

          Please find below Contain host details:

          Hostname :${CrowdStrike.Device.Hostname}
          Device ID: ${CrowdStrike.Device.ID}
          Local IP: ${CrowdStrike.Device.LocalIP}
          External IP: ${CrowdStrike.Device.ExternalIP}
          OS: ${CrowdStrike.Device.OS}
          Offence ID : ${incident.labels.id}

          Thanks & Regards,
          CSOC Cyber AutoBot
      cc:
        simple: sonam.bhandari@tcs.com,v.ghule@tcs.com
      subject:
        simple: unable to contain  Device ID ${CrowdStrike.Device.ID} .
      to:
        complex:
          accessor: labels.Email/from
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: e6eadfc1-e3e1-45c8-8dd5-44e22a2e5049
      iscommand: true
      name: 'Notify  Analyst/Operator_lead  for unsuccessful host containment '
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: e6eadfc1-e3e1-45c8-8dd5-44e22a2e5049
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 140,
          "y": 2170
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: CrowdStrike.Device.ID
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "32"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 177b0513-7217-4074-85f7-64e07b83956d
      iscommand: false
      name: Is Device in containment state ?
      type: condition
      version: -1
    taskid: 177b0513-7217-4074-85f7-64e07b83956d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1270,
          "y": 1620
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      cc:
        simple: sonam.bhandari@tcs.com,v.ghule@tcs.com
      to:
        complex:
          accessor: labels.Email/from
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 2c1bce5f-7734-4d40-86e6-37beb902e934
      iscommand: true
      name: Notify  Analyst/Operator_lead  for  host already in containment state
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 2c1bce5f-7734-4d40-86e6-37beb902e934
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1420,
          "y": 2060
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      filter:
        simple: device_id:'${incident.labels.offense_source}'+status:'contained'
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: f91d5fa3-dff7-4b63-8b4d-5c0674a27005
      iscommand: true
      name: Serach for host
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: f91d5fa3-dff7-4b63-8b4d-5c0674a27005
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1420,
          "y": 1410
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "14_15_#default#": 0.35,
      "25_26_yes": 0.24
    },
    "paper": {
      "dimensions": {
        "height": 3710,
        "width": 2110,
        "x": 50,
        "y": 50
      }
    }
  }
