contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 6084ec03-490f-4893-8152-6aaecc81b47a
inputs:
- description: ""
  key: suspiciousiocs
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Validate Submitted IOC CSO v3.3_KK
outputs: []
sourceplaybookid: 7e0105f5-2558-456a-85df-77c9558ebba6
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3e46bcc5-2ef8-4750-8b8d-e985f2e7d0df
      iscommand: false
      name: ""
      version: -1
    taskid: 3e46bcc5-2ef8-4750-8b8d-e985f2e7d0df
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 580,
          "y": -2120
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.suspiciousiocs
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "62"
      "yes":
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8c3c047b-e985-403f-844d-e4d1ff2f57f3
      iscommand: false
      name: Are There IoC(s) For Blacklisting ?
      type: condition
      version: -1
    taskid: 8c3c047b-e985-403f-844d-e4d1ff2f57f3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 580,
          "y": -1940
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.URL
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.URL
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: fb5188b9-4dd5-4445-86a7-0508c707877f
      iscommand: false
      name: Set Blacklist URL in 'Blacklist.URL' Context
      script: Set
      type: regular
      version: -1
    taskid: fb5188b9-4dd5-4445-86a7-0508c707877f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 610,
          "y": 315
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain_Test_
            - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 786dce97-bdda-45b6-80bf-c6349b29403f
      iscommand: false
      name: Set Blacklist Domain in 'Blacklist.Domain' Context
      script: Set
      type: regular
      version: -1
    taskid: 786dce97-bdda-45b6-80bf-c6349b29403f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 340
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.IPV4
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c969e81e-ad11-4091-82ae-6c2ea6fc3f61
      iscommand: false
      name: Set Blacklist IPv4 IP Address in 'Blacklist.IPV4' Context
      script: Set
      type: regular
      version: -1
    taskid: c969e81e-ad11-4091-82ae-6c2ea6fc3f61
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 160,
          "y": 340
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.Hash
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.File
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c9dcecef-7466-4545-8dee-8a33869cee21
      iscommand: false
      name: Set Blacklist Hash in 'Blacklist.Hash' Context
      script: Set
      type: regular
      version: -1
    taskid: c9dcecef-7466-4545-8dee-8a33869cee21
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 340
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cc6a3f30-a5e8-423a-8d2d-660b50ce3b38
      iscommand: false
      name: Check If Submitted IoC(s) Are Part of The Trusted Domain List
      type: title
      version: -1
    taskid: cc6a3f30-a5e8-423a-8d2d-660b50ce3b38
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2280,
          "y": 885
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      domains:
        simple: ${lists.TCS_Customer_Domain_List},${lists.TCS_Created_Domain},${lists.Zscaler
          autofetch indicators},${lists.TrustedIOClist-Autofetched}
      urls:
        complex:
          accessor: URL
          root: Blacklist
          transformers:
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the supplied URLs are in the specified domains.
      id: 1799ec4e-bb33-4719-8f66-aa8172aa6453
      iscommand: false
      name: Is The URL Part of The Trusted List
      script: IsUrlPartOfDomain
      type: regular
      version: -1
    taskid: 1799ec4e-bb33-4719-8f66-aa8172aa6453
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 550
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.URL
      value:
        complex:
          accessor: URL
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IsUrlPartOfDomain.IsInternal
              operator: isEqualString
              right:
                value:
                  simple: "true"
          - - left:
                iscontext: true
                value:
                  simple: IsUrlPartOfDomain.URL
              operator: in
              right:
                iscontext: true
                value:
                  simple: Blacklist.URL
          root: IsUrlPartOfDomain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1d1ddd33-8269-4688-80a9-4fbad755e94c
      iscommand: false
      name: Set Identified Trusted URL in Context
      script: Set
      type: regular
      version: -1
    taskid: 1d1ddd33-8269-4688-80a9-4fbad755e94c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 920
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 2
    scriptarguments:
      main_domains:
        simple: ${lists.TCS_Customer_Domain_List},${lists.TCS_Created_Domain},${lists.Zscaler
          autofetch indicators},${lists.TrustedIOClist-Autofetched}
      possible_sub_domains_to_test:
        complex:
          accessor: Domain
          root: Blacklist
          transformers:
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script accepts multiple values for both arguments and will
        iterate through each of the domains to check if the specified subdomains are
        located in at least one of the specified main domains. If the tested subdomain
        is in one of the main domains, the result will be true. For example, if the
        domain_to_check values are apps.paloaltonetworks.com and apps.paloaltonetworks.bla
        and the domains_to_compare values are paloaltonetworks.com and demisto.com,
        the result for apps.paloaltonetworks.com will be true since it is a part of
        the paloaltonetworks.com domain. The result for apps.paloaltonetworks.bla
        will be false since it is not a part of the paloaltonetworks.com or demisto.com
        domain.
      id: ed35b90a-dd4a-4d70-850f-677e10490297
      iscommand: false
      name: Is The Domain Part of The Trusted List
      script: IsInternalDomainName
      type: regular
      version: -1
    taskid: ed35b90a-dd4a-4d70-850f-677e10490297
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 550
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: Blacklist
          operator: notIn
          right:
            iscontext: true
            value:
              simple: Trusted.URL
      label: "yes"
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 84bf8b3d-bf13-46b9-8df2-5000961408af
      iscommand: false
      name: Are There Any URLs For Blacklisting ?
      type: condition
      version: -1
    taskid: 84bf8b3d-bf13-46b9-8df2-5000961408af
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1400
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.URL
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Blacklist.URL
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: Trusted.URL
          root: Blacklist.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 79d7e09b-75a6-423e-81c5-dce24525aa51
      iscommand: false
      name: Set The Filtered Blacklisting URLs in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: 79d7e09b-75a6-423e-81c5-dce24525aa51
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1650
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsInternal
                root: IsInternalDomain
          operator: containsGeneral
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 320fe2d6-5fb0-45aa-869f-4dce5be6cc40
      iscommand: false
      name: Are There Domain(s) Part of The Trusted List
      type: condition
      version: -1
    taskid: 320fe2d6-5fb0-45aa-869f-4dce5be6cc40
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 720
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.Domain
      value:
        complex:
          accessor: DomainToTest
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IsInternalDomain.DomainToTest
              operator: in
              right:
                iscontext: true
                value:
                  simple: Blacklist.Domain
          - - left:
                iscontext: true
                value:
                  simple: IsInternalDomain.IsInternal
              operator: isEqualString
              right:
                value:
                  simple: "true"
          root: IsInternalDomain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f88c7d70-5d74-4872-8f2e-6cbf4f4f5c3c
      iscommand: false
      name: Set Identified Trusted Domain in Context
      script: Set
      type: regular
      version: -1
    taskid: f88c7d70-5d74-4872-8f2e-6cbf4f4f5c3c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 920
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: Blacklist
          operator: notIn
          right:
            iscontext: true
            value:
              simple: Trusted.Domain
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 633c0a50-7261-4ae4-83b4-6c8b9138cb55
      iscommand: false
      name: Are There Any Domains For Blacklisting ?
      type: condition
      version: -1
    taskid: 633c0a50-7261-4ae4-83b4-6c8b9138cb55
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 1400
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Blacklist.Domain
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: Trusted.Domain
          root: Blacklist.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b918a74d-8ee4-4e78-85c8-279859dd28b6
      iscommand: false
      name: Set The Filtered Blacklisting Domains in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: b918a74d-8ee4-4e78-85c8-279859dd28b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 1650
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "31"
      "yes":
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IPV4
          root: Blacklist
      ipRanges:
        simple: ${lists.Google Public IP Addresses},${lists.Microsoft Public IP Addresses},${lists.TCS_Public_IP_Addresses},${lists.MasterIOC_IP
          Address},${lists.ZscalerIPAddresses},${lists.TCS_RFScanIP_list},${lists.Zscaler
          autofetch indicators},${lists.TrustedIOClist-Autofetched}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 2b1cab2b-5e19-461b-82f2-72ca1216a7ff
      iscommand: false
      name: Is The IP Address Part of The Trusted List
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 2b1cab2b-5e19-461b-82f2-72ca1216a7ff
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 170,
          "y": 540
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.IPV4
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3b9d0dc3-87a5-4b06-8afa-a8b3aeeae87d
      iscommand: false
      name: Set Identified Trusted IP Address in Context
      script: Set
      type: regular
      version: -1
    taskid: 3b9d0dc3-87a5-4b06-8afa-a8b3aeeae87d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 920
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: InRange
                root: IP
          operator: isEqualString
          right:
            value:
              simple: "no"
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 40c19331-8867-43e3-8f6c-c4cd4ad5651f
      iscommand: false
      name: Are There Any IP Addresses For Blacklisting ?
      type: condition
      version: -1
    taskid: 40c19331-8867-43e3-8f6c-c4cd4ad5651f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 200,
          "y": 1400
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.IPV4
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2c7cc2fa-c48a-41f1-84e8-5233f446d9b2
      iscommand: false
      name: Set The Filtered Blacklisting IP Address in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: 2c7cc2fa-c48a-41f1-84e8-5233f446d9b2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 1650
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9f99578d-b8b3-451f-8fca-eda48f77dac1
      iscommand: false
      name: Update Widgets For Trusted & Validated IoC(s)
      type: title
      version: -1
    taskid: 9f99578d-b8b3-451f-8fca-eda48f77dac1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2060,
          "y": 1870
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Trusted
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 22114ab2-6067-4d24-80c6-72fd76d2a806
      iscommand: false
      name: Are There Trusted IoC(s)?
      type: condition
      version: -1
    taskid: 22114ab2-6067-4d24-80c6-72fd76d2a806
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 2020
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f82d845f-5756-48c9-883e-e6b32b3bd597
      iscommand: false
      name: Verify & Close Automation
      type: title
      version: -1
    taskid: f82d845f-5756-48c9-883e-e6b32b3bd597
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2280,
          "y": 3290
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${inputs.suspiciousiocs}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 437eee70-0e83-4877-8f9b-40a64cee7b8e
      iscommand: true
      name: Extract & Enrich Indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 437eee70-0e83-4877-8f9b-40a64cee7b8e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1345
        }
      }
  "40":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: FinalBlacklist
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 7c713330-bf41-4325-8e8e-9093c4497ad8
      iscommand: false
      name: 'Are There Validated IoC(s)? '
      type: condition
      version: -1
    taskid: 7c713330-bf41-4325-8e8e-9093c4497ad8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2300,
          "y": 2020
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      trustediocs:
        complex:
          root: Trusted
          transformers:
          - operator: Stringify
          - args:
              chars:
                value:
                  simple: '{}'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 2b5a64ad-b7ed-47f4-879f-d5e27f59b405
      iscommand: true
      name: Set The Trusted IoC(s) Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 2b5a64ad-b7ed-47f4-879f-d5e27f59b405
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 2190
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      validatediocsforblacklisting:
        complex:
          root: FinalBlacklist
          transformers:
          - operator: Stringify
          - args:
              chars:
                value:
                  simple: '{}'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 2bc9bd50-ae28-4fbf-8f95-8220694a7363
      iscommand: true
      name: Set The Trusted IoC(s) Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 2bc9bd50-ae28-4fbf-8f95-8220694a7363
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2300,
          "y": 2200
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      validatedurl:
        complex:
          accessor: URL
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: d209a635-5691-41be-89e7-a025263dcd59
      iscommand: true
      name: Set Incident Context ' Validated URL'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: d209a635-5691-41be-89e7-a025263dcd59
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1820
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      validatedipaddress:
        complex:
          accessor: IPV4
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 697e376c-8021-446a-8d02-d9fc56da04bc
      iscommand: true
      name: Set Incident Context ' Validated IP Address'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 697e376c-8021-446a-8d02-d9fc56da04bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 1820
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      validateddomain:
        complex:
          accessor: Domain
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 0e46348d-d78b-4c8d-88ee-76ff726199dc
      iscommand: true
      name: Set Incident Context ' Validated Domain'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 0e46348d-d78b-4c8d-88ee-76ff726199dc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 1820
        }
      }
  "46":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Hash
                root: FinalBlacklist
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 88a560e4-a782-4781-8c77-71a8dfad7419
      iscommand: false
      name: Check If Context 'FinalBlacklist.Hash' is Set
      type: condition
      version: -1
    taskid: 88a560e4-a782-4781-8c77-71a8dfad7419
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 590
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      validatedhash:
        complex:
          accessor: Hash
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 254a5061-557e-4888-8e81-a3f49aec56ed
      iscommand: true
      name: Set Incident Context ' Validated Hash'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 254a5061-557e-4888-8e81-a3f49aec56ed
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 1010
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      trustedipaddress:
        complex:
          accessor: IPV4
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: bc794bd0-3122-46a0-8bdd-1f7f9958791b
      iscommand: true
      name: Set Incident Context ' Trusted IP Address'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: bc794bd0-3122-46a0-8bdd-1f7f9958791b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 1140
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      trustedurl:
        complex:
          accessor: URL
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 5237da39-e3e1-451e-893d-065591f4b656
      iscommand: true
      name: Set Incident Context ' Trusted URL'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 5237da39-e3e1-451e-893d-065591f4b656
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1140
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      trusteddomain:
        complex:
          accessor: Domain
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: a91a817b-f63d-4c3d-8372-e5dbf76a72c7
      iscommand: true
      name: Set Incident Context ' Trusted Domain'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: a91a817b-f63d-4c3d-8372-e5dbf76a72c7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 1140
        }
      }
  "51":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ab2d9b0f-5890-4098-8288-4623e9119d71
      iscommand: false
      name: Is There an IPv4 IP Address in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: ab2d9b0f-5890-4098-8288-4623e9119d71
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 160,
          "y": 100
        }
      }
  "52":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 84f7174f-c5e3-482d-8deb-a34e7f2f33a6
      iscommand: false
      name: Is There a URL in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 84f7174f-c5e3-482d-8deb-a34e7f2f33a6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 610,
          "y": 110
        }
      }
  "53":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExtractedIndicators.Domain
                    operator: in
                    right:
                      iscontext: true
                      value:
                        simple: BlacklistIOC
                root: ExtractedIndicators.Domain
          operator: isExists
        - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExtractedIndicators.Domain_Test_
                    operator: in
                    right:
                      iscontext: true
                      value:
                        simple: BlacklistIOC
                root: ExtractedIndicators.Domain_Test_
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 85c4a85d-7b3c-4642-85da-cf407a99c291
      iscommand: false
      name: Is There a Domain in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 85c4a85d-7b3c-4642-85da-cf407a99c291
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 110
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExtractedIndicators.File
                    operator: in
                    right:
                      iscontext: true
                      value:
                        simple: BlacklistIOC
                root: ExtractedIndicators.File
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4358b377-7a74-4198-8731-11349a46361b
      iscommand: false
      name: Is There a Hash in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 4358b377-7a74-4198-8731-11349a46361b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 110
        }
      }
  "55":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsInternal
                root: IsUrlPartOfDomain
          operator: containsGeneral
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e2fa6234-fccf-4dc3-8b04-3c02c4f2d466
      iscommand: false
      name: Are There URL(s) Part of The Trusted Domain List
      type: condition
      version: -1
    taskid: e2fa6234-fccf-4dc3-8b04-3c02c4f2d466
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 630,
          "y": 720
        }
      }
  "56":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      "yes":
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 852fc173-dcee-4fd4-8696-04c3d946a447
      iscommand: false
      name: Is 'ExtractedIndicators' Context Set ?
      type: condition
      version: -1
    taskid: 852fc173-dcee-4fd4-8696-04c3d946a447
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1730
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: cdd9a973-cc4d-4036-85f5-f47eb44419d8
      iscommand: false
      name: Detele 'ExtractedIndicators' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: cdd9a973-cc4d-4036-85f5-f47eb44419d8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1530
        }
      }
  "58":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: rawType
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: ioc validation for blacklisting
      label: "yes"
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "60"
      "yes":
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ed77aaf6-20fc-4863-87de-215115ec1f2c
      iscommand: false
      name: Check If Type is 'IOC Validation For Blacklisting'
      type: condition
      version: -1
    taskid: ed77aaf6-20fc-4863-87de-215115ec1f2c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2060,
          "y": 2590
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 6772c62d-c8cb-43d9-83b3-654ca923b537
      iscommand: true
      name: Close Automation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 6772c62d-c8cb-43d9-83b3-654ca923b537
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2060,
          "y": 2790
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6633b67b-a524-435e-809c-d260104f2307
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 6633b67b-a524-435e-809c-d260104f2307
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2060,
          "y": 2970
        }
      }
  "61":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1dc630f7-2395-4d1f-88e2-e1938505614e
      iscommand: false
      name: Check the IP present in txt
      type: condition
      version: -1
    taskid: 1dc630f7-2395-4d1f-88e2-e1938505614e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 160,
          "y": -395
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 3b730506-6caa-435e-8688-603528504e0c
      iscommand: true
      name: Extract Indicators From Text File
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 3b730506-6caa-435e-8688-603528504e0c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1150,
          "y": -1390
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlacklistIOC
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: IPfromURL
          root: ExtractedIndicators.IP
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 49bf914e-77ca-4e25-8648-04b64562dbf3
      iscommand: false
      name: Set IoC(s) In Contest
      script: Set
      type: regular
      version: -1
    taskid: 49bf914e-77ca-4e25-8648-04b64562dbf3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 160,
          "y": -180
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlacklistIOC
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: domainfromURL
          root: ExtractedIndicators.Domain
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8bb7a69d-671f-4931-8ad6-88580769ba4b
      iscommand: false
      name: Set IoC(s) In Contest
      script: Set
      type: regular
      version: -1
    taskid: 8bb7a69d-671f-4931-8ad6-88580769ba4b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1160,
          "y": -160
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.URL
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2493ac51-4bf3-4a89-8c0b-1bdebce16daa
      iscommand: false
      name: Check the URL present in txt
      type: condition
      version: -1
    taskid: 2493ac51-4bf3-4a89-8c0b-1bdebce16daa
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 600,
          "y": -395
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlacklistIOC
      value:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a48f40a7-ecf9-4632-8ad1-9868c5f2b637
      iscommand: false
      name: Set IoC(s) In Contest
      script: Set
      type: regular
      version: -1
    taskid: a48f40a7-ecf9-4632-8ad1-9868c5f2b637
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 610,
          "y": -180
        }
      }
  "67":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "64"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a19c17ea-3143-41f2-82d3-b3bcdd162629
      iscommand: false
      name: Check the Domain present in txt
      type: condition
      version: -1
    taskid: a19c17ea-3143-41f2-82d3-b3bcdd162629
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1160,
          "y": -395
        }
      }
  "69":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: File
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "70"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5854fa49-c1df-4cf9-8908-946cb2f009a2
      iscommand: false
      name: Is There a Hash in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 5854fa49-c1df-4cf9-8908-946cb2f009a2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1720,
          "y": -395
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlacklistIOC
      value:
        complex:
          accessor: File
          root: ExtractedIndicators
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: cc707eff-306a-4953-8caf-429193f6df4a
      iscommand: false
      name: Set IoC(s) In Contest
      script: Set
      type: regular
      version: -1
    taskid: cc707eff-306a-4953-8caf-429193f6df4a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1710,
          "y": -150
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlacklistIOC
      value:
        complex:
          root: inputs.suspiciousiocs
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b13be34d-7707-42bf-8ff6-b89dca6a3dc2
      iscommand: false
      name: Set IoC(s) In Contest
      script: Set
      type: regular
      version: -1
    taskid: b13be34d-7707-42bf-8ff6-b89dca6a3dc2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -100,
          "y": -730
        }
      }
  "72":
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "73"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: domainfromURL=.=JSON.parse(val).Domain
      ignore-outputs:
        simple: "true"
      text:
        simple: ${ExtractedIndicators.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: a98377d3-ae2a-450a-806a-f3d54d54f5be
      iscommand: true
      name: Extract  Domain from URL
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: a98377d3-ae2a-450a-806a-f3d54d54f5be
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 610,
          "y": -880
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
      - "65"
      - "67"
      - "69"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: IPfromURL=.=JSON.parse(val).IP
      ignore-outputs:
        simple: "true"
      text:
        simple: ${ExtractedIndicators.URL.}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: af72bf10-5d44-462b-825c-a634db0f0032
      iscommand: true
      name: Extract IP from URL
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: af72bf10-5d44-462b-825c-a634db0f0032
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 610,
          "y": -710
        }
      }
  "74":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.URL
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "61"
      - "65"
      - "67"
      - "69"
      "yes":
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ad75fc5f-04d5-4cd0-868e-b347ade47cbb
      iscommand: false
      name: Check whether URL is present
      type: condition
      version: -1
    taskid: ad75fc5f-04d5-4cd0-868e-b347ade47cbb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 600,
          "y": -1105
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "1_62_#default#": 0.45,
      "23_24_yes": 0.45,
      "23_36_#default#": 0.1,
      "25_26_yes": 0.5,
      "25_27_#default#": 0.21,
      "27_28_yes": 0.46,
      "27_36_#default#": 0.11,
      "29_30_yes": 0.47,
      "29_31_#default#": 0.32,
      "31_32_yes": 0.48,
      "31_36_#default#": 0.1,
      "46_36_#default#": 0.13,
      "46_47_yes": 0.21,
      "51_9_yes": 0.5,
      "52_5_yes": 0.45,
      "53_7_yes": 0.47,
      "54_11_yes": 0.47,
      "55_21_yes": 0.44,
      "55_23_#default#": 0.22,
      "56_57_yes": 0.42,
      "58_59_yes": 0.53
    },
    "paper": {
      "dimensions": {
        "height": 5475,
        "width": 2780,
        "x": -100,
        "y": -2120
      }
    }
  }
