contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 7802596d-27e1-4f55-8056-322e7d444945
inputs: []
name: TCS-Zscaler IP for casb team_WIP
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 06f31ddc-cb3b-4b6d-889a-2b8bc3f67dee
      iscommand: false
      name: ""
      version: -1
    taskid: 06f31ddc-cb3b-4b6d-889a-2b8bc3f67dee
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -600,
          "y": 150
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      method:
        simple: GET
      proxy:
        simple: "true"
      url:
        simple: https://config.zscaler.com/api/zscaler.net/future/json
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends http request. Returns the response as json.
      id: d3208535-4f4f-48a6-815f-eeaf98bb0202
      iscommand: false
      name: Get indicators from json 1(Zscaler Aggregate IP Address Ranges)
      script: http
      type: regular
      version: -1
    taskid: d3208535-4f4f-48a6-815f-eeaf98bb0202
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -590,
          "y": 350
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      ignore-outputs:
        simple: "false"
      text:
        simple: ${HttpRequest.Response.Body}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: aa0d91cf-64d3-4737-8c24-33284b174b96
      iscommand: true
      name: Extract Indicators from context
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: aa0d91cf-64d3-4737-8c24-33284b174b96
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -590,
          "y": 560
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Zscaler
      value:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a9b60f56-0b42-4a61-85d6-5b36bd1b98f3
      iscommand: false
      name: 'Set  common context for IP '
      script: Set
      type: regular
      version: -1
    taskid: a9b60f56-0b42-4a61-85d6-5b36bd1b98f3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -590,
          "y": 740
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Zscaler
      value:
        complex:
          accessor: CIDR
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 32d7f6c4-0c6e-4c95-8851-0127f29525a8
      iscommand: false
      name: set common context for CIDR
      script: Set
      type: regular
      version: -1
    taskid: 32d7f6c4-0c6e-4c95-8851-0127f29525a8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -590,
          "y": 930
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ExtractedIndicators,HttpRequest
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: bcad756e-c7e9-40a2-89ac-cc04a4bf61fa
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: bcad756e-c7e9-40a2-89ac-cc04a4bf61fa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1110,
          "y": 1010
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      context_key:
        simple: Zscaler
      file_name:
        simple: Zscaler IP.csv
      header:
        simple: Zscaler IP's
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ce8515db-f61d-4f01-8279-558868f78ae6
      iscommand: false
      name: Get data into CSV
      script: 98fd7176-124d-4739-8f9d-2f1edb20aa55
      type: regular
      version: -1
    taskid: ce8515db-f61d-4f01-8279-558868f78ae6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -590,
          "y": 1150
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          root: File
      body:
        simple: |-
          Hi Team,

          Please find attached sheet of zscaler IP ranges and request you to please whitelist same on casb console.

          Regards,
          CSOC Cyber AutoBot
      subject:
        simple: Zscaler IP's
      to:
        simple: komal.lugade@tcs.com,porkodi.g@tcs.com,gayathri.pulla@tcs.com
      using:
        simple: EWS Mail Sender_Autobot
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: bc519ba2-7673-4c71-83f1-80f4bf8eb514
      iscommand: true
      name: Send email notification to Casb team
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: bc519ba2-7673-4c71-83f1-80f4bf8eb514
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -590,
          "y": 1375
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 80bf6c11-aa52-4557-8d1f-f1f0f62e39c1
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 80bf6c11-aa52-4557-8d1f-f1f0f62e39c1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -590,
          "y": 1590
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0cacfff9-2975-4bdd-8264-f708384d33b5
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
    taskid: 0cacfff9-2975-4bdd-8264-f708384d33b5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -590,
          "y": 1800
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1715,
        "width": 900,
        "x": -1110,
        "y": 150
      }
    }
  }
