contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: This playbook is used to get all the asset discovered in last 24 hours,
  export the assets into csv and sends an email notification along with csv file.
id: 0a245f01-3326-459a-825e-56a530657f50
inputs: []
name: Cortex Xpanse - AssetDiscovered24Hours
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9579273f-e42e-437a-843c-397f50a3e541
      iscommand: false
      name: ""
      version: -1
    taskid: 9579273f-e42e-437a-843c-397f50a3e541
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 50,
          "y": -90
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 2
    scriptarguments:
      search_from:
        simple: "0"
      search_to:
        simple: "25"
      sort_by_first_observed:
        simple: desc
      type:
        simple: certificate,cloud_integration,cloud_compute_instance,domain,unassociated_responsive_ip
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex Xpanse_Custom
      description: Get a list of all your assets or a filtered list of your assets.
      id: 5cc42ee9-df8e-4f0e-890b-bb9fce3df969
      iscommand: true
      name: Get Assets from Xpanse
      script: Cortex Xpanse_Custom|||asm-list-all-assets
      type: regular
      version: -1
    taskid: 5cc42ee9-df8e-4f0e-890b-bb9fce3df969
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 60
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      dateFormat:
        simple: ISO
      daysAgo:
        simple: "17"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: 05a63984-217b-4a85-85ea-5a511fa7b7b2
      iscommand: false
      name: Get time
      script: GetTime
      type: regular
      version: -1
    taskid: 05a63984-217b-4a85-85ea-5a511fa7b7b2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 260
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 2
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: LastDate
      value:
        complex:
          root: TimeNow
          transformers:
          - args:
              to:
                value:
                  simple: T
            operator: substringTo
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: ad474021-5861-4d69-8134-26db94575bc9
      iscommand: false
      name: Set the date
      script: Set
      type: regular
      version: -1
    taskid: ad474021-5861-4d69-8134-26db94575bc9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 460
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 2
    scriptarguments:
      Assets:
        simple: ${ASM.AssetInternetExposure}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 52fd3187-3c83-4743-8932-7f503ff2e7c4
      iscommand: false
      name: Cortex Xpanse - ListAssetDiscovred
      playbookId: 37170fa7-a9df-4cf3-882e-a60eb9c4d90c
      type: playbook
      version: -1
    taskid: 52fd3187-3c83-4743-8932-7f503ff2e7c4
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 880,
          "y": 630
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "9"
      "yes":
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${AssetsDiscovered}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 76578e02-7a39-436c-876d-42de4d04e05b
      iscommand: false
      name: Check any assets discovered in last 24 hours
      script: Exists
      type: condition
      version: -1
    taskid: 76578e02-7a39-436c-876d-42de4d04e05b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 60,
          "y": 850
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 2
    reputationcalc: 1
    scriptarguments:
      csvArray:
        simple: ${AssetsDiscovered}
      fileName:
        simple: AssetsDiscovered24Hours.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 53675072-61e2-4c99-83d7-21b6317e7374
      iscommand: false
      name: Export the Asset discovered in last 24 hrs to CSV
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 53675072-61e2-4c99-83d7-21b6317e7374
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 1030
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: AssetsDiscovered24Hours.csv
          root: File
      attachNames:
        simple: AssetsDiscovered24Hours.csv
      body:
        simple: |-
          Hi Team,


          Please find the attached report.

          Thanks,
          Dbot
      subject:
        simple: Xpanse - Asset Discovered in last 24 hours
    separatecontext: false
    skipunavailable: false
    task:
      brand: Gmail Single User
      description: Sends an email using Gmail.
      id: 1275f791-1767-4d11-8688-b8ab8fd23596
      iscommand: true
      name: Send email notification to ASM team
      script: Gmail Single User|||send-mail
      type: regular
      version: -1
    taskid: 1275f791-1767-4d11-8688-b8ab8fd23596
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 1240
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1d8c7d8f-e359-448b-84fd-8e5b1cea4d3b
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 1d8c7d8f-e359-448b-84fd-8e5b1cea4d3b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1520
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: AssetsDiscovered
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.DateAdded
              operator: isEqualString
              right:
                iscontext: true
                value:
                  simple: LastDate
          root: ASM.AssetInternetExposure
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 67b8d338-466b-42a0-885a-00c34e5d537e
      iscommand: false
      name: Get the Assets discovered in last 24 hours
      script: Set
      type: regular
      version: -1
    taskid: 67b8d338-466b-42a0-885a-00c34e5d537e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 650
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1675,
        "width": 1560,
        "x": -300,
        "y": -90
      }
    }
  }
