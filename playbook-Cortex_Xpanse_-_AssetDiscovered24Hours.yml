contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: This playbook is used to get all the asset discovered in last 24 hours,
  export the assets into csv and sends an email notification along with csv file.
id: 0a245f01-3326-459a-825e-56a530657f50
inputs: []
name: Cortex Xpanse - AssetDiscovered24Hours
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e53a8426-a43c-44ea-8ea6-669d1fcae2a8
      iscommand: false
      name: ""
      version: -1
    taskid: e53a8426-a43c-44ea-8ea6-669d1fcae2a8
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 50,
          "y": -90
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 2
    scriptarguments:
      search_from:
        simple: "0"
      search_to:
        simple: "25"
      sort_by_first_observed:
        simple: desc
      type:
        simple: certificate,cloud_integration,cloud_compute_instance,domain,unassociated_responsive_ip
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex Xpanse_Custom
      description: Get a list of all your assets or a filtered list of your assets.
      id: 62d4e04e-01d4-4374-84b3-0081524e6b54
      iscommand: true
      name: Get Assets from Xpanse
      script: Cortex Xpanse_Custom|||asm-list-all-assets
      type: regular
      version: -1
    taskid: 62d4e04e-01d4-4374-84b3-0081524e6b54
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 60
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      dateFormat:
        simple: ISO
      daysAgo:
        simple: "17"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: 026c7c83-3472-4d38-8aaf-9546281acbc2
      iscommand: false
      name: Get time
      script: GetTime
      type: regular
      version: -1
    taskid: 026c7c83-3472-4d38-8aaf-9546281acbc2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 260
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 2
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: LastDate
      value:
        complex:
          root: TimeNow
          transformers:
          - args:
              to:
                value:
                  simple: T
            operator: substringTo
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f416ad8a-27a1-4745-8f8e-2312e07dc02e
      iscommand: false
      name: Set the date
      script: Set
      type: regular
      version: -1
    taskid: f416ad8a-27a1-4745-8f8e-2312e07dc02e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 460
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 2
    scriptarguments:
      Assets:
        simple: ${ASM.AssetInternetExposure}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0bf89a86-9336-4efd-8dcb-984deb1570b5
      iscommand: false
      name: Cortex Xpanse - ListAssetDiscovred
      playbookId: 37170fa7-a9df-4cf3-882e-a60eb9c4d90c
      type: playbook
      version: -1
    taskid: 0bf89a86-9336-4efd-8dcb-984deb1570b5
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 880,
          "y": 630
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "9"
      "yes":
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${AssetsDiscovered}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: e2f217ed-705e-46b6-89bd-68e8c64f34ea
      iscommand: false
      name: Check any assets discovered in last 24 hours
      script: Exists
      type: condition
      version: -1
    taskid: e2f217ed-705e-46b6-89bd-68e8c64f34ea
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 60,
          "y": 850
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 2
    reputationcalc: 1
    scriptarguments:
      csvArray:
        simple: ${AssetsDiscovered}
      fileName:
        simple: AssetsDiscovered24Hours.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: de35795f-a844-447d-8810-5ecacb997bcb
      iscommand: false
      name: Export the Asset discovered in last 24 hrs to CSV
      script: ExportToCSV
      type: regular
      version: -1
    taskid: de35795f-a844-447d-8810-5ecacb997bcb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 1030
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: AssetsDiscovered24Hours.csv
          root: File
      attachNames:
        simple: AssetsDiscovered24Hours.csv
      body:
        simple: |-
          Hi Team,


          Please find the attached report.

          Thanks,
          Dbot
      subject:
        simple: Xpanse - Asset Discovered in last 24 hours
    separatecontext: false
    skipunavailable: false
    task:
      brand: Gmail Single User
      description: Sends an email using Gmail.
      id: 866a0454-6681-4c5d-8744-655d5c79fea8
      iscommand: true
      name: Send email notification to ASM team
      script: Gmail Single User|||send-mail
      type: regular
      version: -1
    taskid: 866a0454-6681-4c5d-8744-655d5c79fea8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 1240
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bf07f836-efa2-4640-8041-1b5479acf7c1
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: bf07f836-efa2-4640-8041-1b5479acf7c1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1520
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: AssetsDiscovered
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.DateAdded
              operator: isEqualString
              right:
                iscontext: true
                value:
                  simple: LastDate
          root: ASM.AssetInternetExposure
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 352b7cee-dfdc-4731-8ddc-dbd04537d795
      iscommand: false
      name: Get the Assets discovered in last 24 hours
      script: Set
      type: regular
      version: -1
    taskid: 352b7cee-dfdc-4731-8ddc-dbd04537d795
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 650
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1675,
        "width": 1560,
        "x": -300,
        "y": -90
      }
    }
  }
