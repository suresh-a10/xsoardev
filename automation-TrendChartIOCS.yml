args:
- name: to
- name: from
commonfields:
  id: e744e2e8-27b5-43d0-8f5a-2038b7bdab2f
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.9.6.22912
enabled: true
engineinfo: {}
mainengineinfo: {}
name: TrendChartIOCS
outputs:
- {}
pswd: ""
runas: DBotWeakRole
runonce: false
script: |+
  to_arg = demisto.args().get('to')
  from_arg = demisto.args().get('from')
  to_formatted = datetime.strptime(to_arg[0:10], '%Y-%m-%d').strftime('%d %b %Y')
  from_formatted = datetime.strptime(from_arg[0:10], '%Y-%m-%d').strftime('%d %b %Y')
  timeline = json.loads(demisto.executeCommand('getList', {'listName':'IPSIOCTimeline'})[0]['Contents'])

  bar_widget = BarColumnPieWidget()

  for k,v in timeline.items():
      k_formatted=datetime.strptime(k[0:10], '%Y-%m-%d').strftime('%d %b %Y')
      # Checking if 'To' is not set in the widget
      if to_arg == '0001-01-01T00:00:00Z':
          if k > from_arg:
              bar_widget.add_category(name=k_formatted, number=int(v))
      else:
          if k > from_arg and k <= to_arg:
              bar_widget.add_category(name=k_formatted, number=int(v))


  return_results(bar_widget)



















scripttarget: 0
subtype: python3
tags:
- widget
type: python
