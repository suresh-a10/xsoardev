contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: ebddaae3-16d8-430c-8935-6228b7289abb
inputs:
- description: ""
  key: IOC
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Add New Tag CSP Block Indicator v1.2_KR_WIP
outputs: []
quiet: true
sourceplaybookid: 3186f946-ebeb-4fec-8c59-71f81733bb52
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c67a0b2e-0cd6-4915-8775-16e8af733e8e
      iscommand: false
      name: ""
      version: -1
    taskid: c67a0b2e-0cd6-4915-8775-16e8af733e8e
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -390,
          "y": -5260
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c38127d0-af81-4b63-8a2b-abd449d64363
      iscommand: false
      name: Is Indicator Context Set ?
      type: condition
      version: -1
    taskid: c38127d0-af81-4b63-8a2b-abd449d64363
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -390,
          "y": -5120
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: indicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 5047b52a-4451-454f-812b-9306e984b9b4
      iscommand: false
      name: Delete 'Indicator' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 5047b52a-4451-454f-812b-9306e984b9b4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -390,
          "y": -4905
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: bb0c55c4-683a-47fa-8725-f0325ce519bc
      iscommand: true
      name: Check If IP Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: bb0c55c4-683a-47fa-8725-f0325ce519bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -350,
          "y": -315
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 289e6fde-33be-496b-8bec-9b9ba49e2ddf
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 289e6fde-33be-496b-8bec-9b9ba49e2ddf
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -350,
          "y": -90
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: expirydate
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: in 24 months
            operator: ModifyDateTime
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9c643724-183c-4c8b-86b1-80430be46ddb
      iscommand: false
      name: Calculate Expiry Date
      script: Set
      type: regular
      version: -1
    taskid: 9c643724-183c-4c8b-86b1-80430be46ddb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 120
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 136bb131-1ead-42ad-8695-ad9d8a5d7f68
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 136bb131-1ead-42ad-8695-ad9d8a5d7f68
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -310,
          "y": 660
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: e2976ff9-29de-44ab-8b1a-f27642d6df04
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: e2976ff9-29de-44ab-8b1a-f27642d6df04
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -290,
          "y": 890
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 993e64f5-bf9e-4c29-8186-ed4738ae5dcd
      iscommand: true
      name: Add New CSP Tag to IP
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 993e64f5-bf9e-4c29-8186-ed4738ae5dcd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -310,
          "y": 1165
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: IP
      value:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: eae4bc3b-65e7-4790-8f12-128a696467f4
      iscommand: true
      name: Tag The IP Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: eae4bc3b-65e7-4790-8f12-128a696467f4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1650,
          "y": -75
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 61090c76-0e4d-4210-8e77-8b6b9fa2c1f9
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 61090c76-0e4d-4210-8e77-8b6b9fa2c1f9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -20,
          "y": 2220
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 3461ce96-37cf-432a-8686-74fc6c9fa8c1
      iscommand: true
      name: Check If  domain Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 3461ce96-37cf-432a-8686-74fc6c9fa8c1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 120,
          "y": -410
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: b5cc1d41-d483-4351-8750-9ca81e7b12c2
      iscommand: true
      name: Check If Indicators Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: b5cc1d41-d483-4351-8750-9ca81e7b12c2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -390,
          "y": -4740
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7aca4f81-689e-4dad-8255-d58a41e1d992
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 7aca4f81-689e-4dad-8255-d58a41e1d992
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -340,
          "y": 135
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: Domain
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 55194706-feb4-453e-8600-75c541b3a9da
      iscommand: true
      name: Tag The Domain Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 55194706-feb4-453e-8600-75c541b3a9da
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 20
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: URL
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 8f0d3ead-33ba-4b80-8724-439a1bfc695f
      iscommand: true
      name: Tag The URL Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 8f0d3ead-33ba-4b80-8724-439a1bfc695f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1270,
          "y": 40
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: ec5ac071-edba-4d72-8121-ce1c5d226e5e
      iscommand: true
      name: Add New CSP Tag to Domain
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: ec5ac071-edba-4d72-8121-ce1c5d226e5e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 1165
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 5de1383d-473f-4bf7-8574-19888fdebfbb
      iscommand: true
      name: Add New CSP Tag to URL
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 5de1383d-473f-4bf7-8574-19888fdebfbb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -800,
          "y": 1165
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Address2.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 4e68c1f4-a614-45d5-88d3-29a4f640d59f
      iscommand: false
      name: Delete IP IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 4e68c1f4-a614-45d5-88d3-29a4f640d59f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -280,
          "y": 355
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: c4e655b2-3c05-48ec-866a-b7244af71990
      iscommand: false
      name: Delete URL IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: c4e655b2-3c05-48ec-866a-b7244af71990
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 355
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 320ab855-c22a-4042-820b-19939592d83f
      iscommand: false
      name: Delete  domain IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 320ab855-c22a-4042-820b-19939592d83f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 140,
          "y": 355
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: IP
      value:
        simple: ${inputs.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: bbc9260b-ee43-4fd5-8e3f-4137eb8fcc20
      iscommand: true
      name: Tag The Hash Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: bbc9260b-ee43-4fd5-8e3f-4137eb8fcc20
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2080,
          "y": -75
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: f1807156-ee81-4d9f-8f57-923b0783b6b4
      iscommand: false
      name: Delete hash IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: f1807156-ee81-4d9f-8f57-923b0783b6b4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 340
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 1df141c5-c52e-4680-85da-4ad5f2887388
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 1df141c5-c52e-4680-85da-4ad5f2887388
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 180,
          "y": 900
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 3cc07b43-30f5-4c0e-8967-a5e5fd0ab45b
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 3cc07b43-30f5-4c0e-8967-a5e5fd0ab45b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -830,
          "y": 880
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: d7dd662d-2bfb-453d-8893-45b7fd296ecb
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: d7dd662d-2bfb-453d-8893-45b7fd296ecb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 900
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 97f7cb26-d3a6-4350-8766-93e648903279
      iscommand: true
      name: Add New CSP Tag to  hash
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 97f7cb26-d3a6-4350-8766-93e648903279
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 1165
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 74db726d-370d-403f-8735-6bc29c261e2f
      iscommand: true
      name: Check If  hash Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 74db726d-370d-403f-8735-6bc29c261e2f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 590,
          "y": -450
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: ip
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.URL
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: url
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: domain
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.File
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: file
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      domain:
      - "39"
      file:
      - "67"
      ip:
      - "65"
      url:
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5f629267-55bb-460b-8016-705190a9d0aa
      iscommand: false
      name: Check which input is defined
      type: condition
      version: -1
    taskid: 5f629267-55bb-460b-8016-705190a9d0aa
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -390,
          "y": -4560
        }
      }
  "30":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8d133665-93d9-458f-8aed-f57e730b200c
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 8d133665-93d9-458f-8aed-f57e730b200c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1150,
          "y": -345
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8d9a953b-ea67-43f9-8cce-cb8e266f3291
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 8d9a953b-ea67-43f9-8cce-cb8e266f3291
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 120,
          "y": -250
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 83380abb-8f17-4610-8a7c-18de003dc0dc
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 83380abb-8f17-4610-8a7c-18de003dc0dc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 580,
          "y": -240
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3a7c801d-33dc-4b06-8cbd-43cabb7b9f70
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 3a7c801d-33dc-4b06-8cbd-43cabb7b9f70
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 630,
          "y": 120
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1ba30ac6-d56a-4bc8-8594-c46f5e94db88
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 1ba30ac6-d56a-4bc8-8594-c46f5e94db88
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -930,
          "y": 120
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 04891a34-7333-43d8-8818-caa48f1f5a5b
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 04891a34-7333-43d8-8818-caa48f1f5a5b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 130,
          "y": 120
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b62b8be2-e160-4b70-824e-ca184108c927
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: b62b8be2-e160-4b70-824e-ca184108c927
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 620,
          "y": 680
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6e45003a-9661-4091-875e-7a0dd7e96cc4
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 6e45003a-9661-4091-875e-7a0dd7e96cc4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 160,
          "y": 670
        }
      }
  "38":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "18"
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3108f7f9-1216-4950-87d0-c04c117b3f8e
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 3108f7f9-1216-4950-87d0-c04c117b3f8e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -960,
          "y": 680
        }
      }
  "39":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "75"
      "yes":
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 67dbb220-2de4-41b6-8f72-64dd9ae07eef
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 67dbb220-2de4-41b6-8f72-64dd9ae07eef
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -800,
          "y": -4350
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "54"
      "yes":
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 459bcb6e-5c65-495b-8cc1-9a494147ea87
      iscommand: false
      name: Is This IP Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 459bcb6e-5c65-495b-8cc1-9a494147ea87
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2130,
          "y": -4160
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "76"
      "yes":
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 26f1fbc9-5f04-45a4-8424-d96b6cbd9b16
      iscommand: false
      name: Is This Domain Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 26f1fbc9-5f04-45a4-8424-d96b6cbd9b16
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -800,
          "y": -4140
        }
      }
  "47":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "104"
      "yes":
      - "101"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 48fdfec7-1380-4321-8a48-029ec2520304
      iscommand: false
      name: Is This Hash Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 48fdfec7-1380-4321-8a48-029ec2520304
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1880,
          "y": -4160
        }
      }
  "48":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "82"
      "yes":
      - "84"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ff29d5a2-6f83-419e-8204-3690d37f8c85
      iscommand: false
      name: Is This URL Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: ff29d5a2-6f83-419e-8204-3690d37f8c85
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": -4140
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea1e3603-d5f5-4a83-8478-f6826c4c8d84
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: ea1e3603-d5f5-4a83-8478-f6826c4c8d84
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1970,
          "y": -3990
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: ebd50c60-9533-4b75-868b-f6fa5d25110a
      iscommand: true
      name: Add New CSP Tag to IP and Set Expiry to 30 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: ebd50c60-9533-4b75-868b-f6fa5d25110a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1930,
          "y": -3640
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 35266b68-520d-4def-847f-fc4eb66743b2
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 35266b68-520d-4def-847f-fc4eb66743b2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1970,
          "y": -3810
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "70"
      "yes":
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2090eba6-8cec-4a98-88cf-2d89765df5bc
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 2090eba6-8cec-4a98-88cf-2d89765df5bc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1900,
          "y": -4350
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "81"
      "yes":
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4266f4f4-b5be-40ce-84c5-3f4f445a65d6
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 4266f4f4-b5be-40ce-84c5-3f4f445a65d6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": -4330
        }
      }
  "67":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "102"
      "yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ef5205fb-2e07-40f1-8210-ff81e6e026dd
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: ef5205fb-2e07-40f1-8210-ff81e6e026dd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1870,
          "y": -4330
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 65f06e07-416f-419f-8b7c-fdadc9500dd6
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 65f06e07-416f-419f-8b7c-fdadc9500dd6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -640,
          "y": -3380
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: IP
      value:
        simple: ${inputs.IOC}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: cb6e75ca-0962-4b1b-806c-c11b35a3083a
      iscommand: true
      name: Create New CSP IP Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: cb6e75ca-0962-4b1b-806c-c11b35a3083a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1530,
          "y": -4045
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: 61b9f146-514e-4121-8824-b4bc721afb3d
      iscommand: true
      name: 'Set expiry date to 30 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: 61b9f146-514e-4121-8824-b4bc721afb3d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2310,
          "y": -3500
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 599a3d97-d782-4d27-8b67-73804f41d87f
      iscommand: false
      name: Delete IP IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 599a3d97-d782-4d27-8b67-73804f41d87f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2340,
          "y": -3690
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: Domain
      value:
        simple: ${inputs.IOC}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: ad33ab3e-8c71-4922-87a6-4267854ad14b
      iscommand: true
      name: Create New CSP Domain Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: ad33ab3e-8c71-4922-87a6-4267854ad14b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -360,
          "y": -4065
        }
      }
  "76":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5eb1175b-3567-47e3-8ded-2ed045d1128b
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 5eb1175b-3567-47e3-8ded-2ed045d1128b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -780,
          "y": -3965
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: d7097dd6-a15d-48a0-82ae-7d7206f55378
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: d7097dd6-a15d-48a0-82ae-7d7206f55378
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -770,
          "y": -3730
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 8a8a891a-e82f-43e1-8181-27d594ecc55a
      iscommand: false
      name: Delete Domain IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 8a8a891a-e82f-43e1-8181-27d594ecc55a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1140,
          "y": -3605
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 9500515e-902f-44ba-80a8-e52c319613d5
      iscommand: true
      name: Add New CSP Tag to Domain and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 9500515e-902f-44ba-80a8-e52c319613d5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -730,
          "y": -3560
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: 3038e3bb-38c0-443f-8477-74b7bdf14e76
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: 3038e3bb-38c0-443f-8477-74b7bdf14e76
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -330,
          "y": -3260
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: URL
      value:
        simple: ${inputs.IOC}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: f4cf6a66-b745-470f-8f9d-ba9825bd3d38
      iscommand: true
      name: Create New CSP URL Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: f4cf6a66-b745-470f-8f9d-ba9825bd3d38
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": -3990
        }
      }
  "82":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "85"
      "yes":
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 70d21271-cd8b-43ea-842e-2b5269523b8e
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 70d21271-cd8b-43ea-842e-2b5269523b8e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 420,
          "y": -3920
        }
      }
  "83":
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "85"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: c78395f4-12b3-42b5-8196-6bec65dc0a5a
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: c78395f4-12b3-42b5-8196-6bec65dc0a5a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": -3745
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 8cc03c6e-5c81-45b9-8ddb-a2b058ba9a21
      iscommand: false
      name: Delete  URL OC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 8cc03c6e-5c81-45b9-8ddb-a2b058ba9a21
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": -3580
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 3aad4246-6e52-4a9c-8ea8-dd2a75214682
      iscommand: true
      name: Add New CSP Tag to URL and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 3aad4246-6e52-4a9c-8ea8-dd2a75214682
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 420,
          "y": -3595
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: a0117e80-3807-41cf-81fd-7525f89aae72
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: a0117e80-3807-41cf-81fd-7525f89aae72
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1080,
          "y": -3260
        }
      }
  "101":
    continueonerrortype: ""
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: File
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: dd1ff869-3fb7-40c1-8913-2b73756e0e66
      iscommand: false
      name: Delete  File OC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: dd1ff869-3fb7-40c1-8913-2b73756e0e66
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1730,
          "y": -3785
        }
      }
  "102":
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: File
      value:
        simple: ${inputs.IOC}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 71139d1e-3880-4f1d-8954-349ad12bf714
      iscommand: true
      name: Create New CSP File Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 71139d1e-3880-4f1d-8954-349ad12bf714
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1290,
          "y": -3980
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: ed65dacb-f7b1-47d4-83ba-4a05a1912c7a
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: ed65dacb-f7b1-47d4-83ba-4a05a1912c7a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1280,
          "y": -3650
        }
      }
  "104":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "106"
      "yes":
      - "105"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 26862faf-ffe3-4e13-8bd1-3e9912b8dff4
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 26862faf-ffe3-4e13-8bd1-3e9912b8dff4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2170,
          "y": -3940
        }
      }
  "105":
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 383811ae-25d7-4427-8746-8ab7f1edec67
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 383811ae-25d7-4427-8746-8ab7f1edec67
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2190,
          "y": -3760
        }
      }
  "106":
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 597a5d3a-bc99-4d76-8278-af3a33c16141
      iscommand: true
      name: Add New CSP Tag to File and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 597a5d3a-bc99-4d76-8278-af3a33c16141
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2170,
          "y": -3560
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "1_2_yes": 0.44,
      "29_67_file": 0.45,
      "39_45_yes": 0.51,
      "54_56_yes": 0.53,
      "65_44_yes": 0.35,
      "66_48_yes": 0.37,
      "67_47_yes": 0.58
    },
    "paper": {
      "dimensions": {
        "height": 7545,
        "width": 4910,
        "x": -2340,
        "y": -5260
      }
    }
  }
