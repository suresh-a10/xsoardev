contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: f09dcf66-6b8d-48ea-8243-17029fa36bf8
inputs: []
name: TCS-OnDemand Lift Host Containment Playbook v1.3_Kunal
outputs: []
sourceplaybookid: dc7d02c4-9e4e-4e78-866e-35dde9c38272
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: da755d78-794f-441e-87d9-bd562260a7b3
      iscommand: false
      name: ""
      version: -1
    taskid: da755d78-794f-441e-87d9-bd562260a7b3
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 270,
          "y": -125
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 3069253d-b07e-46e7-8b07-9e9c3a773d8d
      iscommand: false
      name: Read The Text Attachment
      script: ReadFile
      type: regular
      version: -1
    taskid: 3069253d-b07e-46e7-8b07-9e9c3a773d8d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 370
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TCSHostname
      value:
        complex:
          root: FileData
          transformers:
          - operator: trim
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: de4ceb45-f6c1-4588-8faa-24a8b27484d9
      iscommand: false
      name: Set Data To Context
      script: Set
      type: regular
      version: -1
    taskid: de4ceb45-f6c1-4588-8faa-24a8b27484d9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 545
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          root: TCSHostname
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: 27126b30-54f2-4262-8496-2bb05c73a2d6
      iscommand: true
      name: Get Host Data From Crowdstrike
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: 27126b30-54f2-4262-8496-2bb05c73a2d6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 1070
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        complex:
          accessor: Device
          root: CrowdStrike
      fileName:
        simple: Crowdstrike_Host_Contain_Removed.csv
      headers:
        simple: Hostname,ID,FirstSeen,LastSeen,OS,ExternalIP,LocalIP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 5acd25b9-ad73-4095-8208-70b87683daa5
      iscommand: false
      name: Create Excel Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 5acd25b9-ad73-4095-8208-70b87683daa5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2840
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 59593162-fa9c-4877-82f5-993101dfcd9a
      iscommand: false
      name: Set Report To New Context
      script: Set
      type: regular
      version: -1
    taskid: 59593162-fa9c-4877-82f5-993101dfcd9a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2995
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        complex:
          root: TCSHostname
          transformers:
          - operator: toUpperCase
      right:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
          transformers:
          - operator: toUpperCase
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: e609c6cb-500a-43c5-8b5b-bcc2c851cf82
      iscommand: false
      name: Compare Submitted List With CS Results
      script: CompareLists
      type: regular
      version: -1
    taskid: e609c6cb-500a-43c5-8b5b-bcc2c851cf82
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 3170
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4bb94114-51ef-45fa-8b4c-a85830616654
      iscommand: false
      name: Are There Any Hosts Not Found in CrowdStrike ?
      type: condition
      version: -1
    taskid: 4bb94114-51ef-45fa-8b4c-a85830616654
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 3345
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Hostnotfound
      value:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 298cfd49-6a43-4f33-8f94-3c9f75493516
      iscommand: false
      name: Set The Host To Context
      script: Set
      type: regular
      version: -1
    taskid: 298cfd49-6a43-4f33-8f94-3c9f75493516
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3520
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: CrowdStrike
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Status
                root: CrowdStrike.Device
          operator: isEqualString
          right:
            value:
              simple: contained
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fd2b9ade-b66a-4e41-8728-05d010aab8d0
      iscommand: false
      name: Host Found on CrowdStrike?
      type: condition
      version: -1
    taskid: fd2b9ade-b66a-4e41-8728-05d010aab8d0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 1260
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |
          Hello Human,

          None of the Hosts in this list - ${incident.attachment.name} are contained. Hence 'Lift Containment was not required.

          Regards,
          Cyber Autobot
          Automation task id : ${incident.id}
      cc:
        simple: InternalIS.SecurityCompliance@tcs.com, kunal.krushev@tcs.com
      subject:
        simple: 'No Contained Hosts Found For Lift Containment - ${incident.attachment.name} '
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 8df5558a-4bfa-4b04-8cec-f27d5770c69f
      iscommand: true
      name: Send Notification 'No Hosts Found on Crowdstrike'
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 8df5558a-4bfa-4b04-8cec-f27d5770c69f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4220
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${Report}
      body:
        simple: |
          Hello Human,

          I have removed the host(s) in this list  ${incident.attachment.name} from network containment. Please refer attached report.


          Regards,
          Cyber Autobot
          Automation id : ${incident.id}
      cc:
        simple: kunal.krushev@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: ' Crowdstrike lift Host containment Report For Submitted File (Compliance
          Team)- ${incident.attachment.name}'
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: d6bb200c-372f-48bf-815c-c0e0e0089097
      iscommand: true
      name: Send Host Remove Containment Report (All Hosts)
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: d6bb200c-372f-48bf-815c-c0e0e0089097
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4220
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${Report}
      body:
        simple: |-
          Hello Human,

          I have removed some of the host(s) in this list ${incident.attachment.name}  from containment, however there were some hosts I did not find in the CrowdStrike database. PFA report for reference.


          Regards,
          Cyber Autobot
          Automation id : ${incident.id}
      cc:
        simple: kunal.krushev@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: ' Crowdstrike lift Host containment Report For Submitted File (compliance
          Team)- ${incident.attachment.name}'
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 4dc9d69b-1162-421d-8e9e-58b0ce496163
      iscommand: true
      name: Send Report of Hosts Found on Crowdstrike (Some Hosts)
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 4dc9d69b-1162-421d-8e9e-58b0ce496163
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 4220
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello Human,

          You are not on my authorized list of senders. Please contact Your XSOAR Support team.

          Regards,
          CSOC Cyber AutoBot
          Automation task id : ${incident.id}
      cc:
        simple: kunal.krushev@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: Not Authorized For This Task
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: a2a6225b-0434-4d7b-8863-e35a1e0ec4cc
      iscommand: true
      name: Send Notification 'Not Authorized Sender'
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: a2a6225b-0434-4d7b-8863-e35a1e0ec4cc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4220
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 278052db-9763-4678-855a-3ce4e1ac78ae
      iscommand: true
      name: Close Playbook
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 278052db-9763-4678-855a-3ce4e1ac78ae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4395
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6360584d-0fa8-45d8-8b03-be0a378322f1
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 6360584d-0fa8-45d8-8b03-be0a378322f1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4570
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      context_key:
        simple: Hostnotfoundarray
      file_name:
        simple: Host_Not_Found.csv
      header:
        simple: Hostname
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fa4f4869-516f-41c0-8eb0-9bc60789cf4a
      iscommand: false
      name: Create Excel Report of Hosts Not Found
      script: 98fd7176-124d-4739-8f9d-2f1edb20aa55
      type: regular
      version: -1
    taskid: fa4f4869-516f-41c0-8eb0-9bc60789cf4a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3870
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 157b56be-42d3-4032-8c1c-769d4f785943
      iscommand: false
      name: Set Report To New Context
      script: Set
      type: regular
      version: -1
    taskid: 157b56be-42d3-4032-8c1c-769d4f785943
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 4045
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        complex:
          root: Hostnotfound
      contextKey:
        simple: Hostnotfoundarray
      separator:
        simple: ','
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: 847018c0-31c5-407e-8e8d-a04f36a3003a
      iscommand: false
      name: Create Array For Report
      script: CreateArray
      type: regular
      version: -1
    taskid: 847018c0-31c5-407e-8e8d-a04f36a3003a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3695
        }
      }
  "21":
    continueonerror: true
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.Status
              operator: isNotEqualString
              right:
                value:
                  simple: normal
          root: CrowdStrike.Device
          transformers:
          - operator: uniq
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Lifts containment on the host, which returns its network communications
        to normal.
      id: 3452cb44-a8cb-40ed-8fe9-61470e58f724
      iscommand: true
      name: Lift Host Containment
      script: '|||cs-falcon-lift-host-containment'
      type: regular
      version: -1
    taskid: 3452cb44-a8cb-40ed-8fe9-61470e58f724
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 1945
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${TCSHostname}
      contextKey:
        simple: TCSHostnameArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: 7fb4accd-292b-438d-8d05-8c24bf8c48cd
      iscommand: false
      name: Create Array of Input Data
      script: CreateArray
      type: regular
      version: -1
    taskid: 7fb4accd-292b-438d-8d05-8c24bf8c48cd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 720
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        simple: ${TCSHostnameArray}
      contextKey:
        simple: TCSHostnameArrayCount
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 76de0f52-f8ea-4d75-8013-cdaa52c55068
      iscommand: false
      name: Count The Array Data And Set It To Context
      script: CountArraySize
      type: regular
      version: -1
    taskid: 76de0f52-f8ea-4d75-8013-cdaa52c55068
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 895
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        simple: ${CSDeviceIDArray}
      contextKey:
        simple: CrowdStrikeDeviceIDCount
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: dce1df7b-f6cd-4c85-83ec-515ac82d2823
      iscommand: false
      name: Count The CS Host ID Array Count And Set It To Context
      script: CountArraySize
      type: regular
      version: -1
    taskid: dce1df7b-f6cd-4c85-83ec-515ac82d2823
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1595
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "21"
      "yes":
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      first:
        simple: ${CrowdStrikeDeviceIDCount}
      second:
        simple: ${TCSHostnameArrayCount}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Checks if one number(float) as bigger than the other(float)
        Returns yes: if first > second
        Returns no: if first <= second
        Returns exception if one of the inputs is not a number
      id: 15ca09e6-12a9-4cad-8138-c368bed464c1
      iscommand: false
      name: Compare The Count Value Of The CrowdStrike Output With The Original Input
      script: IsGreaterThan
      type: condition
      version: -1
    taskid: 15ca09e6-12a9-4cad-8138-c368bed464c1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1770
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |
          Hello Human,

          One of the Hostnames in this list - ${incident.attachment.name} is not unique, and resolves to multiple device IDs. Unfortunately I've not yet learnt to identify the hostname causing the issue. Request you to review this manually.

          Regards,
          Cyber Autobot
          Automation task id : ${incident.id}
      cc:
        simple: kunal.krushev@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: One of The CrowdStrike Host(s) Is Not Unique - ${incident.attachment.name}
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 300100ff-7b03-4dcc-87a3-26d5259e0bac
      iscommand: true
      name: Send Notification 'One of The Host Inputs is Not Unique'
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 300100ff-7b03-4dcc-87a3-26d5259e0bac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 4220
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${CrowdStrike.Device.ID}
      contextKey:
        simple: CSDeviceIDArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: eaedac80-f981-43f3-8641-7de93c5ac5ab
      iscommand: false
      name: Create Array of  CS Device ID DataData
      script: CreateArray
      type: regular
      version: -1
    taskid: eaedac80-f981-43f3-8641-7de93c5ac5ab
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1440
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: Indicator.name.Tag=CustomFields.tags::Indicator.name.value=value
      value:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 37ad9ef2-3499-41c3-8d6e-5072c7aa5f5c
      iscommand: true
      name: Find Indicators And Set In Context
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 37ad9ef2-3499-41c3-8d6e-5072c7aa5f5c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2120
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "32"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bec4f30d-0baf-4185-86d8-05a68b4d3671
      iscommand: false
      name: Are There Any Fetched Indicators ?
      type: condition
      version: -1
    taskid: bec4f30d-0baf-4185-86d8-05a68b4d3671
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2285
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: hostcontaincompliance
      indicatorsValues:
        complex:
          accessor: value
          root: Indicator.name
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 16e079e3-dae4-4beb-896a-800d04143250
      iscommand: true
      name: Erase The Indicator Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 16e079e3-dae4-4beb-896a-800d04143250
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2470
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: hostliftcontaincompliance
      type:
        simple: Host
      value:
        complex:
          accessor: value
          root: Indicator.name
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: d19d063c-f441-45ff-8543-96b373279eb3
      iscommand: true
      name: Set New Indicator Tag
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: d19d063c-f441-45ff-8543-96b373279eb3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2645
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          accessor: ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.Status
              operator: isNotEqualString
              right:
                value:
                  simple: normal
          root: CrowdStrike.Device
      relateToIncident:
        simple: "true"
      tags:
        simple: hostliftcontaincompliance
      type:
        simple: Host
      value:
        complex:
          accessor: Hostname
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.Status
              operator: isNotEqualString
              right:
                value:
                  simple: normal
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: f632dcab-328c-402e-814c-b0115712cefe
      iscommand: true
      name: Create New Host Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: f632dcab-328c-402e-814c-b0115712cefe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 700,
          "y": 2470
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: komal.lugade@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: InternalIS.SecurityCompliance@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: kunal.krushev@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: sonam.bhandari@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: komala.kp@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: ramprakash1.r@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: sonali.teli@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: manoharan.g@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: shreya.nayak@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: k.premanandhan@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: somraj.chakravarty@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: s.moharana@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: arunsastha.p@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: sala.e@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: vanita.gonjare@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: pawan.pavanje@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: Hemnath.V@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: umarshariff.a@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e5755be8-c696-4f0c-8a97-ecede6230208
      iscommand: false
      name: Is Email From Authorized Sender ?
      type: condition
      version: -1
    taskid: e5755be8-c696-4f0c-8a97-ecede6230208
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1190,
          "y": -140
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: komal.lugade@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: InternalIS.SecurityCompliance@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: kunal.krushev@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: sonam.bhandari@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: komala.kp@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: ramprakash1.r@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: sonali.teli@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: manoharan.g@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: shreya.nayak@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: k.premanandhan@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: somraj.chakravarty@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: s.moharana@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: arunsastha.p@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: sala.e@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: vanita.gonjare@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: pawan.pavanje@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: umarshariff.a@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: Hemnath.V@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: ${lists.AuthorizedsendersCompliance}
      label: "yes"
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1a0557ee-5704-40b5-88e4-7ac5386eaa49
      iscommand: false
      name: Is Email From Authorized Sender ?
      type: condition
      version: -1
    taskid: 1a0557ee-5704-40b5-88e4-7ac5386eaa49
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 270,
          "y": 100
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "25_26_yes": 0.24,
      "29_30_yes": 0.6
    },
    "paper": {
      "dimensions": {
        "height": 4775,
        "width": 2100,
        "x": 50,
        "y": -140
      }
    }
  }
