contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 987bbd69-05f3-4c7e-823d-bfb5b4ddce35
inputs: []
name: BulkIOC_Hunt_WIP
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c66576a7-7f8f-436d-8276-cbc6e5a26029
      iscommand: false
      name: ""
      version: -1
    taskid: c66576a7-7f8f-436d-8276-cbc6e5a26029
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
      - "5"
      - "10"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: be52387b-cb22-49e0-8d4c-132838b51670
      iscommand: false
      name: Extract Indicators From File - Generic v2
      playbookId: Extract Indicators From File - Generic v2
      type: playbook
      version: -1
    taskid: be52387b-cb22-49e0-8d4c-132838b51670
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 450,
          "y": 230
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 617c2a93-61ad-48c7-8032-3bb2499e04ec
      iscommand: false
      name: is there domains present?
      type: condition
      version: -1
    taskid: 617c2a93-61ad-48c7-8032-3bb2499e04ec
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 450
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: ${DomainAqlQuery}
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 6b2abed5-4dad-44e8-87e5-4e1967b4c941
      iscommand: false
      name: QRadarFullSearch
      playbookId: QRadarFullSearch
      type: playbook
      version: -1
    taskid: 6b2abed5-4dad-44e8-87e5-4e1967b4c941
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 450,
          "y": 990
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: ioc,hits
      data:
        simple: ${QRadar.Search.Result}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 9634d5bf-9a43-4d97-87fc-ca15dc3c3bd7
      iscommand: false
      name: generate report
      script: ToTable
      type: regular
      version: -1
    taskid: 9634d5bf-9a43-4d97-87fc-ca15dc3c3bd7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1500
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: IP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ad9b808e-4071-4f7d-8089-a425002f486a
      iscommand: false
      name: is Ip present?
      type: condition
      version: -1
    taskid: ad9b808e-4071-4f7d-8089-a425002f486a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 950,
          "y": 450
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      base_field_match:
        simple: exact
      base_field_state:
        simple: include
      base_fields_to_search:
        simple: sourceip,destinationip
      base_values_to_search:
        complex:
          accessor: Address
          root: IP
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      first_additional_field_match:
        simple: exact
      first_additional_field_state:
        simple: include
      second_additional_field_state:
        simple: include
      select_fields:
        simple: QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as 'Log Source',"eventCount"
          as 'Event Count',"startTime" as 'Time',categoryname(category) as 'Low Level
          Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source Port',"destinationIP"
          as 'Destination IP',"destinationPort" as 'Destination Port',"userName" as
          'Username'
      time_frame:
        simple: LAST 30 DAYS
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Build QRadar AQL Query.
      id: d7756cc7-331c-4f3a-8209-4c23d80be3cb
      iscommand: false
      name: Create AQL query for Qradar
      script: QRadarCreateAQLQuery
      type: regular
      version: -1
    taskid: d7756cc7-331c-4f3a-8209-4c23d80be3cb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 950,
          "y": 650
        }
      }
  "8":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Domain Name
      output:
        simple: ${QRadarQuery}
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      base_field_match:
        simple: exact
      base_field_state:
        simple: include
      base_fields_to_search:
        simple: BC_ParentDomain,URL
      base_values_to_search:
        complex:
          accessor: Name
          root: Domain
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      first_additional_field_match:
        simple: exact
      first_additional_field_state:
        simple: include
      first_additional_fields:
        simple: deviceGroupList
      first_additional_values:
        simple: "100074"
      second_additional_field_state:
        simple: include
      select_fields:
        simple: QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as 'Log Source',"eventCount"
          as 'Event Count',"startTime" as 'Time',categoryname(category) as 'Low Level
          Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source Port',"destinationIP"
          as 'Destination IP',"destinationPort" as 'Destination Port',"userName" as
          'Username',"ActualAction" as "Actual Action"
      time_frame:
        simple: LAST 30 DAYS
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Build QRadar AQL Query.
      id: 63d20634-90f8-4b90-8d97-6ab9e4100171
      iscommand: false
      name: Create AQL query for Domains search in qradar
      script: QRadarCreateAQLQuery
      type: regular
      version: -1
    taskid: 63d20634-90f8-4b90-8d97-6ab9e4100171
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 640
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: URL
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a3b12d1a-b117-429f-8837-4f3bd819bcae
      iscommand: false
      name: is there url Present?
      type: condition
      version: -1
    taskid: a3b12d1a-b117-429f-8837-4f3bd819bcae
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -40,
          "y": 450
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      base_field_match:
        simple: exact
      base_field_state:
        simple: include
      base_fields_to_search:
        simple: URL
      base_values_to_search:
        complex:
          accessor: Data
          root: URL
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      first_additional_field_match:
        simple: exact
      first_additional_field_state:
        simple: include
      first_additional_fields:
        simple: deviceGroupList
      first_additional_values:
        simple: "100074"
      second_additional_field_state:
        simple: include
      select_fields:
        simple: QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as 'Log Source',"eventCount"
          as 'Event Count',"startTime" as 'Time',categoryname(category) as 'Low Level
          Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source Port',"destinationIP"
          as 'Destination IP',"destinationPort" as 'Destination Port',"userName" as
          'Username',"ActualAction" as "Actual action"
      time_frame:
        simple: LAST 30 DAYS
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Build QRadar AQL Query.
      id: 7dc93747-3f75-48be-800a-feb324b3dd09
      iscommand: false
      name: create AQL query for URL search in qradar
      script: QRadarCreateAQLQuery
      type: regular
      version: -1
    taskid: 7dc93747-3f75-48be-800a-feb324b3dd09
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": 650
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: ${UrlAqlQuery}
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 16d8d98b-b524-492c-833f-9f6718f77024
      iscommand: false
      name: QRadarFullSearch
      playbookId: QRadarFullSearch
      type: playbook
      version: -1
    taskid: 16d8d98b-b524-492c-833f-9f6718f77024
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -40,
          "y": 980
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: ${IpAqlQuery}
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 8c025501-5830-440d-8487-24be90ddb296
      iscommand: false
      name: QRadarFullSearch
      playbookId: QRadarFullSearch
      type: playbook
      version: -1
    taskid: 8c025501-5830-440d-8487-24be90ddb296
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 950,
          "y": 970
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: UrlAqlQuery
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: QRadarQuery
              operator: containsString
              right:
                value:
                  simple: URL
          - - left:
                iscontext: true
                value:
                  simple: QRadarQuery
              operator: notContainsString
              right:
                value:
                  simple: BC_ParentDomain
          root: QRadarQuery
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5e1d9686-307e-4f5a-88e6-9a03d02d2cbb
      iscommand: false
      name: Set query for url search
      script: Set
      type: regular
      version: -1
    taskid: 5e1d9686-307e-4f5a-88e6-9a03d02d2cbb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": 820
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: IpAqlQuery
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: QRadarQuery
              operator: notContainsString
              right:
                value:
                  simple: BC_ParentDomain
          - - left:
                iscontext: true
                value:
                  simple: QRadarQuery
              operator: notContainsString
              right:
                value:
                  simple: URL
          root: QRadarQuery
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 43fa2ee8-6a8e-40c8-8f5d-8bbd94b3847e
      iscommand: false
      name: set ip aql query
      script: Set
      type: regular
      version: -1
    taskid: 43fa2ee8-6a8e-40c8-8f5d-8bbd94b3847e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 950,
          "y": 810
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: DomainAqlQuery
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: QRadarQuery
              operator: containsString
              right:
                value:
                  simple: BC_ParentDomain
          root: QRadarQuery
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 61ce4682-9942-4547-87f4-9ed1f430c7c2
      iscommand: false
      name: set domail query
      script: Set
      type: regular
      version: -1
    taskid: 61ce4682-9942-4547-87f4-9ed1f430c7c2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 820
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6556a94e-cba8-4f97-864c-548793575a0b
      iscommand: false
      name: Close
      type: title
      version: -1
    taskid: 6556a94e-cba8-4f97-864c-548793575a0b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 440,
          "y": 1770
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1785,
        "width": 1370,
        "x": -40,
        "y": 50
      }
    }
  }
