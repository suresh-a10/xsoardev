commonfields:
  id: 75eb2182-1152-406a-8a4b-b877f9507165
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.9.7.24076
enabled: true
engineinfo: {}
mainengineinfo: {}
name: ReviewedIncidentsPercentage
pswd: ""
runas: DBotWeakRole
runonce: false
script: |-
  res = demisto.executeCommand("getIncidents", {
      "query": '-category:job and -owner:"" and -reviewedby:""',
      "fromdate": demisto.args()["from"],
      "todate": demisto.args()["to"],
      "size": 0
  })
  reviewedIncidents = res[0]["Contents"]["total"]
  # demisto.results(reviewedIncidents)
  res = demisto.executeCommand("getIncidents", {
      "query": '(type:"Malware Investigation" or type:"QRadar offences onboarding" or type:Reports/UEBA or type:"Phishing Investigation" or type:"GRA Alert" or type:"Google Workspace Incident") and status:Closed and -closeReason:Duplicate and -owner:""',
      "fromdate": demisto.args()["from"],
      "todate": demisto.args()["to"],
      "size": 0
  });
  overallIncidents = res[0]["Contents"]["total"]
  if overallIncidents == 0:
      demisto.results(0)
  else:
      result = round(reviewedIncidents * 100 / overallIncidents)
      demisto.results(result);
scripttarget: 0
subtype: python3
tags:
- widget
type: python
