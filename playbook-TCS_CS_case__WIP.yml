contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: b86deb8e-2f0b-4e00-80f6-8168e8b2b7fa
inputs: []
name: TCS_CS case _WIP
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a68a7a9a-c6e4-4713-8dc9-150c95d03e23
      iscommand: false
      name: ""
      version: -1
    taskid: a68a7a9a-c6e4-4713-8dc9-150c95d03e23
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 440,
          "y": -470
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      filter:
        simple: device.hostname:'${TCSHostnameArray}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Search for details of specific detections, either using a filter
        query, or by providing the IDs of the detections.
      id: 4da23068-1a9a-43c7-813a-3bd14b90a7e9
      iscommand: true
      name: Fetch the CS detection
      script: CrowdstrikeFalcon|||cs-falcon-search-detection
      type: regular
      version: -1
    taskid: 4da23068-1a9a-43c7-813a-3bd14b90a7e9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 270,
          "y": 1270
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Csstatus
      value:
        simple: ${CrowdStrike.Detection.Status}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e6a1f0a4-a297-4bfe-8d02-bc17a24abfec
      iscommand: false
      name: Set value for CS status
      script: Set
      type: regular
      version: -1
    taskid: e6a1f0a4-a297-4bfe-8d02-bc17a24abfec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 270,
          "y": 1440
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Csstatus
          operator: isEqualString
          right:
            value:
              simple: new
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 56b6f0ad-5bca-41ff-8332-47fbd03d181f
      iscommand: false
      name: Checked the CS new status
      type: condition
      version: -1
    taskid: 56b6f0ad-5bca-41ff-8332-47fbd03d181f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 270,
          "y": 1610
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      name:
        simple: ${inputs.hostname} sample
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.create.inc
      id: 99a00c2c-e8bc-4e1a-8721-3380597dab05
      iscommand: true
      name: Create new incident
      script: Builtin|||createNewIncident
      type: regular
      version: -1
    taskid: 99a00c2c-e8bc-4e1a-8721-3380597dab05
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 1195
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 119641e9-bd42-42fe-8aa0-6f538ec571c0
      iscommand: false
      name: Untitled Task
      type: regular
      version: -1
    taskid: 119641e9-bd42-42fe-8aa0-6f538ec571c0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -50,
          "y": 1810
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      createddate:
        simple: ${CrowdStrike.Detection.FirstBehavior}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: e8201f08-f28c-4f84-88de-d8b38b8a50fb
      iscommand: true
      name: set occurred date
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: e8201f08-f28c-4f84-88de-d8b38b8a50fb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 1810
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5147864c-f224-4991-85b0-f7de12f825b2
      iscommand: false
      name: update to status in cs console
      type: regular
      version: -1
    taskid: 5147864c-f224-4991-85b0-f7de12f825b2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 2000
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: CsStatus
          operator: isEqualString
          right:
            value:
              simple: new
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ef93b715-3b66-4a82-8b09-4cbe23329ca1
      iscommand: false
      name: f
      type: condition
      version: -1
    taskid: ef93b715-3b66-4a82-8b09-4cbe23329ca1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 790
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: detectionid
      value:
        complex:
          accessor: ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Detection.Status
              operator: in
              right:
                value:
                  simple: new
          root: CrowdStrike.Detection
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b4b93145-4099-4e9c-8251-826c8fcea0db
      iscommand: false
      name: set detection id
      script: Set
      type: regular
      version: -1
    taskid: b4b93145-4099-4e9c-8251-826c8fcea0db
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 530,
          "y": 1790
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        simple: ${detectionid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Search for details of specific detections, either using a filter
        query, or by providing the IDs of the detections.
      id: bbf6bb4f-b281-4021-8b2c-c8afd22c767f
      iscommand: true
      name: CS detection id
      script: CrowdstrikeFalcon|||cs-falcon-search-detection
      type: regular
      version: -1
    taskid: bbf6bb4f-b281-4021-8b2c-c8afd22c767f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 270,
          "y": 1640
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        complex:
          accessor: ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Detection.Status
              operator: in
              right:
                value:
                  simple: new
          root: CrowdStrike.Detection
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: d7f9cce8-f271-43d6-890e-61da884941d2
      iscommand: false
      name: 'delete context '
      script: DeleteContext
      type: regular
      version: -1
    taskid: d7f9cce8-f271-43d6-890e-61da884941d2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 270,
          "y": 1480
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      casedetectionid:
        simple: ${detectionid}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: d00ed229-f1b4-4124-8c37-1f69a0ac1daf
      iscommand: false
      name: TCS-CS incident created
      playbookId: 6488e426-8d3e-45a1-821f-7ccd97f996e2
      type: playbook
      version: -1
    taskid: d00ed229-f1b4-4124-8c37-1f69a0ac1daf
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 530,
          "y": 1955
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 7689f02b-ef51-41a1-880f-eed1da0a09e3
      iscommand: false
      name: Read The Text Attachment
      script: ReadFile
      type: regular
      version: -1
    taskid: 7689f02b-ef51-41a1-880f-eed1da0a09e3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": -330
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TCSHostname
      value:
        complex:
          root: FileData
          transformers:
          - operator: trim
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c8bfb35e-4e3a-4da9-8269-835db44a6af5
      iscommand: false
      name: set data
      script: Set
      type: regular
      version: -1
    taskid: c8bfb35e-4e3a-4da9-8269-835db44a6af5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": -170
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${TCSHostname}
      contextKey:
        simple: TCSHostnameArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: 06084ca4-22cc-4992-8e64-00276008cda7
      iscommand: false
      name: Create Array
      script: CreateArray
      type: regular
      version: -1
    taskid: 06084ca4-22cc-4992-8e64-00276008cda7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": -10
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        simple: ${TCSHostnameArray}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b26342b7-a49d-4f0c-84f1-c906456da60b
      iscommand: false
      name: TCS-Fetch incident from CS
      playbookId: 2299210a-f915-4b88-865c-e5596c75c5e7
      type: playbook
      version: -1
    taskid: b26342b7-a49d-4f0c-84f1-c906456da60b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 440,
          "y": 155
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d81ee056-9ba9-44b3-8707-703213a76bb7
      iscommand: false
      name: Untitled Task
      type: title
      version: -1
    taskid: d81ee056-9ba9-44b3-8707-703213a76bb7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 440,
          "y": 320
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        simple: ${TCSHostnameArray}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9da86433-07e6-4d79-8321-d7a46b400c02
      iscommand: false
      name: TCS-Fetch incident from CS
      playbookId: 2299210a-f915-4b88-865c-e5596c75c5e7
      type: playbook
      version: -1
    taskid: 9da86433-07e6-4d79-8321-d7a46b400c02
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 930,
          "y": 270
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2565,
        "width": 1660,
        "x": -50,
        "y": -470
      }
    }
  }
