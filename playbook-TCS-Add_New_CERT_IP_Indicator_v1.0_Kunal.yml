contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: b02ea39f-55e2-4e65-8cf4-2510e23e374a
inputs:
- description: ""
  key: IP
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Add New CERT IP Indicator v1.0_Kunal
outputs: []
sourceplaybookid: e653e5ab-6658-4f7a-806d-6a79d92d5d98
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0151abe9-790f-4f6b-8003-eaea400a41a9
      iscommand: false
      name: ""
      version: -1
    taskid: 0151abe9-790f-4f6b-8003-eaea400a41a9
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -550,
          "y": -380
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${lists.CERT IP Address Block}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 18f4f448-bead-43d1-8b52-04b681b48fb9
      iscommand: true
      name: Fetch New Indicators From List
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 18f4f448-bead-43d1-8b52-04b681b48fb9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 770,
          "y": -40
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      relateToIncident:
        simple: "false"
      reputation:
        simple: Bad
      tags:
        simple: blockedipaddress,rfblockedip
      type:
        simple: IP
      value:
        complex:
          accessor: LeftOnly
          root: ListCompare
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 6674903a-2447-4c7f-867d-5f6a0e2737d4
      iscommand: true
      name: Create New Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 6674903a-2447-4c7f-867d-5f6a0e2737d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1190
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a02a875f-fae3-4cf9-88bf-adc6e245bec0
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: a02a875f-fae3-4cf9-88bf-adc6e245bec0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1515
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: ExtractedIndicators.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: dea68716-2948-45ef-87b6-f80bec6014f3
      iscommand: true
      name: Check If Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: dea68716-2948-45ef-87b6-f80bec6014f3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 360
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${ExtractedIndicators.IP}
      right:
        simple: ${indicator.value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 9d002e6a-f255-49f2-87cc-1443db3f0332
      iscommand: false
      name: Compare Indicator Lists
      script: CompareLists
      type: regular
      version: -1
    taskid: 9d002e6a-f255-49f2-87cc-1443db3f0332
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 735
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 25e26e53-6bad-43c4-8dc7-dd4e858fdaa9
      iscommand: false
      name: Is The Indicator Context Value Defined ?
      type: condition
      version: -1
    taskid: 25e26e53-6bad-43c4-8dc7-dd4e858fdaa9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 520
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      relateToIncident:
        simple: "false"
      reputation:
        simple: Bad
      tags:
        simple: blockedipaddress,rfblockedip
      type:
        simple: IP
      value:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: f711b852-e4e5-4ac1-86d3-ff0cacccdff9
      iscommand: true
      name: Create New Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: f711b852-e4e5-4ac1-86d3-ff0cacccdff9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -390,
          "y": 1190
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ListCompare.LeftOnly}
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: ${ListCompare.LeftOnly}
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fca2c834-92a0-4fce-877b-579ef6cc01fa
      iscommand: false
      name: Is There An Indicator To Create ?
      type: condition
      version: -1
    taskid: fca2c834-92a0-4fce-877b-579ef6cc01fa
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 940
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      relateToIncident:
        simple: "false"
      reputation:
        simple: Bad
      tags:
        simple: certblockipaddress
      type:
        simple: IP
      value:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: cf2377a3-416f-4df3-86e6-b7d15f11735c
      iscommand: true
      name: Create New CERT Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: cf2377a3-416f-4df3-86e6-b7d15f11735c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 1190
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      extend-context:
        simple: indicator.ip=value::indicator.tag=CustomFields.tags
      query:
        simple: tags:certblockipaddress
      using:
        simple: InnerServicesModule
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: b6b7baac-de66-4eb5-830f-ff79794da07a
      iscommand: true
      name: Check If Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: b6b7baac-de66-4eb5-830f-ff79794da07a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -550,
          "y": -20
        }
      }
  "11":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ip
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8ab2da72-59e7-402d-8c8d-36613a9b5e7f
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 8ab2da72-59e7-402d-8c8d-36613a9b5e7f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -550,
          "y": 170
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a25ef1ce-8291-4513-8776-612b2361f312
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: a25ef1ce-8291-4513-8776-612b2361f312
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -550,
          "y": 930
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      tags:
        simple: certblockipaddress
      type:
        simple: IP
      value:
        simple: ${ListCompare.LeftOnly}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 386b0628-44a8-4eb6-806c-9ff74d1fd5da
      iscommand: true
      name: Tag The Indicator With 'certblockipaddress'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 386b0628-44a8-4eb6-806c-9ff74d1fd5da
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -550,
          "y": 720
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      left:
        simple: ${ExtractedIndicators.IP}
      right:
        simple: ${indicator.value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 94350e1a-8a75-4322-8602-aecfcf92eca0
      iscommand: false
      name: Compare The New IP With Exiting Indicator
      script: CompareLists
      type: regular
      version: -1
    taskid: 94350e1a-8a75-4322-8602-aecfcf92eca0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -550,
          "y": 380
        }
      }
  "15":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 675153ea-e175-435a-8cb4-04ff8c53faa9
      iscommand: false
      name: Is There A New Indicator To Add ?
      type: condition
      version: -1
    taskid: 675153ea-e175-435a-8cb4-04ff8c53faa9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -550,
          "y": 530
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Info
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 87b8b4b9-3ca4-463a-8e41-7129d7b1a815
      iscommand: true
      name: Extract Indicators From Text File
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 87b8b4b9-3ca4-463a-8e41-7129d7b1a815
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -550,
          "y": -210
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: certblockipaddress
      type:
        simple: IP
      value:
        simple: ${ExtractedIndicators.IP}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 6e0f7cac-2a80-4219-80da-bd5ae7c36710
      iscommand: true
      name: Tag The Indicator With 'certblockipaddress'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 6e0f7cac-2a80-4219-80da-bd5ae7c36710
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1510,
          "y": -80
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: e549cc29-56a3-4b49-8dfd-33b4ef577f06
      iscommand: true
      name: Check If Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: e549cc29-56a3-4b49-8dfd-33b4ef577f06
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 75
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TaggedIndicator
      value:
        complex:
          accessor: ip
          root: indicator
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 81738eda-180a-4525-851c-e0967664a6fb
      iscommand: false
      name: Set Tagged Indictor In Context
      script: Set
      type: regular
      version: -1
    taskid: 81738eda-180a-4525-851c-e0967664a6fb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1100,
          "y": 540
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      right:
        simple: ${TaggedIndicator}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 3d998942-9395-4432-80dc-3ebb0cc80127
      iscommand: false
      name: Compare Context 'Extracted Indicator' and 'Indicator.Ip'
      script: CompareLists
      type: regular
      version: -1
    taskid: 3d998942-9395-4432-80dc-3ebb0cc80127
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1100,
          "y": 710
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "6_5_yes": 0.62
    },
    "paper": {
      "dimensions": {
        "height": 1960,
        "width": 2660,
        "x": -1510,
        "y": -380
      }
    }
  }
