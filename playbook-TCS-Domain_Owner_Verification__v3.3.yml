contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: aa4cb35f-adb7-47da-8f34-c72c23c3c1e5
inputs:
- description: ""
  key: Domain
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Domain
      root: ExtractedIndicators
name: TCS-Domain Owner Verification  v3.3
outputs:
- contextPath: ExtractedIndicators.Domain
  description: Domain
  type: unknown
sourceplaybookid: 10a892d4-e4b5-4b5e-80ea-dcaccb53541a
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 48a8c6de-4108-4760-8ec8-f388b1e5d8a4
      iscommand: false
      name: ""
      version: -1
    taskid: 48a8c6de-4108-4760-8ec8-f388b1e5d8a4
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -210,
          "y": -1040
        }
      }
  "3":
    continueonerror: true
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "62"
      "yes":
      - "7"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.TCS_Customer_Domain_List}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: b2b3c01e-b88e-406c-81f0-49d04326ffc4
      iscommand: false
      name: Does Domain Belong To Customer ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: b2b3c01e-b88e-406c-81f0-49d04326ffc4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -670,
          "y": 310
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain4.Customer
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b4346249-dcbb-4df6-84b6-8d3a09ce80dd
      iscommand: false
      name: Set Customer Domain into Context
      script: Set
      type: regular
      version: -1
    taskid: b4346249-dcbb-4df6-84b6-8d3a09ce80dd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 550
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain3
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: cf0bd8ed-7482-40fe-81e4-a0cd10b8abcc
      iscommand: false
      name: Set Output into Context
      script: Set
      type: regular
      version: -1
    taskid: cf0bd8ed-7482-40fe-81e4-a0cd10b8abcc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": 550
        }
      }
  "11":
    continueonerror: true
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "no":
      - "10"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.TCS_Customer_Domain_List},${lists.MasterIOC_Domain},${lists.TCS_Created_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 286f0d2e-1b0b-4366-883a-4270fbdd3772
      iscommand: false
      name: Does Domain Belong To TCS or Customer or In Master IOC List?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 286f0d2e-1b0b-4366-883a-4270fbdd3772
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -210,
          "y": 320
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      attachIDs:
        simple: ${.=val.File.filter(function(f){return f.EntryID;}).reduce(function(acc,
          f) {return f;}, null).EntryID}
      body:
        simple: "Hello Human,\n\nI found Internal/Customer Domain in this file ${incident.attachment.name}.
          \nPFA Risk Score report.\n\nInternal/Customer Domain:\n\n${Domain4.Customer}\n\n\nRegards,\nCSOC
          CyberAutoBot"
      subject:
        simple: Found Internal/Customer Domain In This File ${incident.attachment.name}
      to:
        complex:
          accessor: emailfrom
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: c1c35c8b-5f97-4620-8b05-ff39c5e50285
      iscommand: true
      name: Send Email Notification That Internal/Customer Domain Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: c1c35c8b-5f97-4620-8b05-ff39c5e50285
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1500
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b6444c68-9259-4bfc-8d58-bdc8cb853096
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: b6444c68-9259-4bfc-8d58-bdc8cb853096
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -430,
          "y": 2220
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1bdc0c83-55f3-4ba3-8339-da4936384824
      iscommand: false
      name: Generate Report & Notify
      type: title
      version: -1
    taskid: 1bdc0c83-55f3-4ba3-8339-da4936384824
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -200,
          "y": 930
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain4.Customer
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: check for trusted ioc
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "36"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 509c1bcc-ec7d-4788-8944-f18e0fc2f890
      iscommand: false
      name: Verify There Are No Customer Domain In The List ?
      type: condition
      version: -1
    taskid: 509c1bcc-ec7d-4788-8944-f18e0fc2f890
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 1290
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI did not find any customer domain in this file ${incident.attachment.name}\n\n\nRegards,\nCSOC
          CyberAutoBot "
      subject:
        simple: No Customer Domain Found In This File ${incident.attachment.name}
      to:
        complex:
          accessor: emailfrom
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 863516dc-fffb-40ac-81d2-9a4a88b9c173
      iscommand: true
      name: Send Email Notification That No Customer Domain Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 863516dc-fffb-40ac-81d2-9a4a88b9c173
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 1500
        }
      }
  "40":
    continueonerror: true
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${Domain4.Customer}
      retry-count:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: 6b50898c-24c8-4b62-87f9-99b694bce4d7
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2|||domain
      type: regular
      version: -1
    taskid: 6b50898c-24c8-4b62-87f9-99b694bce4d7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 750
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 2
    scriptarguments:
      csvArray:
        simple: ${RecordedFuture.Domain}
      fileName:
        simple: Domain Risk Score.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 1ee5f03a-fa7a-4397-825c-6636b3b3557d
      iscommand: false
      name: Generate CSV Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 1ee5f03a-fa7a-4397-825c-6636b3b3557d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1080
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: RecordedFuture.Domain
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "35"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 86e46077-67e5-45e6-8769-0772fcfb4194
      iscommand: false
      name: Is There a Report To Generate
      type: condition
      version: -1
    taskid: 86e46077-67e5-45e6-8769-0772fcfb4194
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 1080
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Domain2
      value:
        complex:
          accessor: Domain
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9079652d-0d41-4c15-8f7a-ef8656fa8573
      iscommand: false
      name: Set Domain In New Context For DeDup
      script: Set
      type: regular
      version: -1
    taskid: 9079652d-0d41-4c15-8f7a-ef8656fa8573
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 90,
          "y": -10
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Domain2
      value:
        complex:
          accessor: Domain_Test_
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 776dfefd-7cd7-49ce-8792-7fc0e4833e66
      iscommand: false
      name: Set Unique Domain In New Context
      script: Set
      type: regular
      version: -1
    taskid: 776dfefd-7cd7-49ce-8792-7fc0e4833e66
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 120
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators2.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain2
              operator: notContainsGeneral
              right:
                value:
                  simple: www.
          - - left:
                iscontext: true
                value:
                  simple: Domain2
              operator: notContainsGeneral
              right:
                value:
                  simple: /
          root: Domain2
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: .
              toReplace:
                value:
                  simple: '[.]'
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c17a910b-1eb4-4c2b-8ab1-09244b540787
      iscommand: false
      name: Set New Unique Domains Into Extracted Indicators
      script: Set
      type: regular
      version: -1
    taskid: c17a910b-1eb4-4c2b-8ab1-09244b540787
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 120
        }
      }
  "58":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain_Test_
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8d70823f-aa41-4d1a-8b0a-22a707a05631
      iscommand: false
      name: Are there any Domains ?
      type: condition
      version: -1
    taskid: 8d70823f-aa41-4d1a-8b0a-22a707a05631
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -210,
          "y": -860
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 3e0972b6-1cd5-4918-84ec-3ad43446ed04
      iscommand: false
      name: Delete Extracted Indicators Domain Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 3e0972b6-1cd5-4918-84ec-3ad43446ed04
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 220,
          "y": 550
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .tcs.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .ultimatix.net
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .google.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .microsoft.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .gstatic.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .amazonaws.com
          root: Domain3
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 0103efd7-8782-40cf-854b-79842eeed88f
      iscommand: false
      name: Set New Unique Domains Into Extracted Indicators
      script: Set
      type: regular
      version: -1
    taskid: 0103efd7-8782-40cf-854b-79842eeed88f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": 750
        }
      }
  "61":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain4.Customer
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "19"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eec97739-5565-4dc9-8c4c-5314ef017ad9
      iscommand: false
      name: Is There a Internal/Customer Domain ?
      type: condition
      version: -1
    taskid: eec97739-5565-4dc9-8c4c-5314ef017ad9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1290
        }
      }
  "62":
    continueonerror: true
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "63"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.MasterIOC_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 40db971f-167e-4a23-86b4-205e90349388
      iscommand: false
      name: Is Domain In Master IOC List ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 40db971f-167e-4a23-86b4-205e90349388
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1110,
          "y": 320
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
      - "66"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain5.MasterIOC
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 788aec81-e1a5-403a-8af6-8205f5508e75
      iscommand: false
      name: Set Master IOC Domain into Context
      script: Set
      type: regular
      version: -1
    taskid: 788aec81-e1a5-403a-8af6-8205f5508e75
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1110,
          "y": 550
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI found that below Domains from the file ${incident.attachment.name}
          are already in the Master IOC list. I will not be performing any action
          on these IOCs.\n\nDomain:\n\n${Domain5.MasterIOC} \n\n\n\nRegards,\nCSOC
          CyberAutoBot "
      subject:
        simple: Domains In Master IOC List Found In This File ${incident.attachment.name}
      to:
        complex:
          accessor: emailfrom
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: f91cdf8c-39b3-44ec-8a7e-919d5250f729
      iscommand: true
      name: Send Email Notification Found Domain In Master IOC
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: f91cdf8c-39b3-44ec-8a7e-919d5250f729
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 680,
          "y": 1500
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "54"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2218cb24-e2d7-4cc1-87c3-fdeb041bcc4b
      iscommand: false
      name: Is There Extracted Indicator Context ?
      type: condition
      version: -1
    taskid: 2218cb24-e2d7-4cc1-87c3-fdeb041bcc4b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 90,
          "y": -300
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: MasterIOC
                root: Domain5
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: check for trusted ioc
        - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: block ioc
        - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: blacklist ioc
      label: "yes"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "64"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b6304cfe-5f4e-42aa-8a04-de3ca9454c30
      iscommand: false
      name: Verify The Master IOC & Email Subject Condition
      type: condition
      version: -1
    taskid: b6304cfe-5f4e-42aa-8a04-de3ca9454c30
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 680,
          "y": 1290
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
    note: false
    quietmode: 1
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          accessor: Domain_Test_
          root: ExtractedIndicators
          transformers:
          - args:
              chars:
                value:
                  simple: www.
            operator: StripChars
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1c87c7be-0eda-4390-8699-754c4db51f01
      iscommand: false
      name: Set Extracted Indicators Context (Strip www. & Unique)
      script: Set
      type: regular
      version: -1
    taskid: 1c87c7be-0eda-4390-8699-754c4db51f01
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": -445
        }
      }
  "68":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain_Test_
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "70"
      "yes":
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 746cdfd7-7759-4e5e-82a0-cda4ca850c12
      iscommand: false
      name: Is Domain Test Context Defined ?
      type: condition
      version: -1
    taskid: 746cdfd7-7759-4e5e-82a0-cda4ca850c12
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -430,
          "y": -620
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain_Test_
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 3242bc01-1a8d-4cae-8141-78708574fd1c
      iscommand: false
      name: Delete Domain Test Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 3242bc01-1a8d-4cae-8141-78708574fd1c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": -260
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators2.Domain
      value:
        complex:
          accessor: Domain
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5e4fbf00-95fe-4b0a-8b08-28398df81c8c
      iscommand: false
      name: Set Indicators In Context
      script: Set
      type: regular
      version: -1
    taskid: 5e4fbf00-95fe-4b0a-8b08-28398df81c8c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": -80
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "58_33_#default#": 0.44
    },
    "paper": {
      "dimensions": {
        "height": 3325,
        "width": 2600,
        "x": -1110,
        "y": -1040
      }
    }
  }
