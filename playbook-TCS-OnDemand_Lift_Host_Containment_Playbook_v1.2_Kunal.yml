contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
hidden: true
id: 194e3777-0564-4c95-880f-8b41822affc6
inputs: []
name: TCS-OnDemand Lift Host Containment Playbook v1.2_Kunal
outputs: []
sourceplaybookid: dc7d02c4-9e4e-4e78-866e-35dde9c38272
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b1ffe688-0e91-4b20-8b9e-1cd21192fedd
      iscommand: false
      name: ""
      version: -1
    taskid: b1ffe688-0e91-4b20-8b9e-1cd21192fedd
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 910,
          "y": 65
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: fea7e894-185e-4b0b-8d52-0d97a0939e4b
      iscommand: false
      name: Read The Text Attachment
      script: ReadFile
      type: regular
      version: -1
    taskid: fea7e894-185e-4b0b-8d52-0d97a0939e4b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 400
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TCSHostname
      value:
        complex:
          root: FileData
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: df62ff01-d063-43f9-8c29-7a3ca98fbc7f
      iscommand: false
      name: Set Data To Context
      script: Set
      type: regular
      version: -1
    taskid: df62ff01-d063-43f9-8c29-7a3ca98fbc7f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 585
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          root: TCSHostname
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: 3975eff9-3afc-410d-84c4-734992cc53d3
      iscommand: true
      name: Get Host Data From Crowdstrike
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: 3975eff9-3afc-410d-84c4-734992cc53d3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 1100
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        complex:
          accessor: Device
          root: CrowdStrike
      fileName:
        simple: Crowdstrike_Host_Contain_Removed.csv
      headers:
        simple: Hostname,ID,FirstSeen,LastSeen,OS,ExternalIP,LocalIP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: b5100576-30e2-4616-8dd5-1dea6f8546c9
      iscommand: false
      name: Create Excel Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: b5100576-30e2-4616-8dd5-1dea6f8546c9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2150
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: dfcd4aab-8eaa-44eb-89de-82996b18015d
      iscommand: false
      name: Set Report To New Context
      script: Set
      type: regular
      version: -1
    taskid: dfcd4aab-8eaa-44eb-89de-82996b18015d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2325
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        complex:
          root: TCSHostname
          transformers:
          - operator: toUpperCase
      right:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
          transformers:
          - operator: toUpperCase
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: ce46e7f4-4e41-4c31-85d3-bb463cb22fea
      iscommand: false
      name: Compare Submitted List With CS Results
      script: CompareLists
      type: regular
      version: -1
    taskid: ce46e7f4-4e41-4c31-85d3-bb463cb22fea
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2500
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a4fdf8aa-c849-4850-874d-82eb9eccf16a
      iscommand: false
      name: Are There Any Hosts Not Found in CrowdStrike ?
      type: condition
      version: -1
    taskid: a4fdf8aa-c849-4850-874d-82eb9eccf16a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2675
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Hostnotfound
      value:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4c50f4a6-8e83-4e35-86a7-5383f7c5580d
      iscommand: false
      name: Set The Host To Context
      script: Set
      type: regular
      version: -1
    taskid: 4c50f4a6-8e83-4e35-86a7-5383f7c5580d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2850
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ID
                root: CrowdStrike.Device
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ID
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1a53b161-8c64-4576-867f-7addd39d9840
      iscommand: false
      name: Host Found on CrowdStrike?
      type: condition
      version: -1
    taskid: 1a53b161-8c64-4576-867f-7addd39d9840
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 1275
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |
          Hello Human,

          None of the Hostname in this list - ${incident.attachment.name} were found in Crowdstrike.

          Regards,
          Cyber Autobot
          Automation task id : ${incident.id}
      cc:
        simple: v.ghule@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: None of The Hostname in this list - ${incident.attachment.name} Were
          Found in Crowdstrike
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 59e9a2c1-dacf-449a-8a24-2f41e63f4d71
      iscommand: true
      name: Send Notification 'No Hosts Found on Crowdstrike'
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 59e9a2c1-dacf-449a-8a24-2f41e63f4d71
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3550
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${Report}
      body:
        simple: |
          Hello Human,

          I have removed the host(s) in this list  ${incident.attachment.name} from network containment. Please refer attached report.


          Regards,
          Cyber Autobot
          Automation id : ${incident.id}
      cc:
        simple: v.ghule@tcs.com,kunal.krushev@tcs.com,internalis.cybersecurityops@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: ' Crowdstrike lift Host containment Report For Submitted File (Compliance
          Team)- ${incident.attachment.name}'
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 01df0315-f060-4903-815d-a4e4e33f448e
      iscommand: true
      name: Send Host Remove Containment Report (All Hosts)
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 01df0315-f060-4903-815d-a4e4e33f448e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3550
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${Report}
      body:
        simple: |-
          Hello Human,

          I have removed some of the host(s) in this list ${incident.attachment.name}  from containment, however there were some hosts I did not find in the CrowdStrike database. PFA report for reference.


          Regards,
          Cyber Autobot
          Automation id : ${incident.id}
      cc:
        simple: v.ghule@tcs.com,kunal.krushev@tcs.com,internalis.cybersecurityops@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: ' Crowdstrike lift Host containment Report For Submitted File (compliance
          Team)- ${incident.attachment.name}'
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 7f6a583c-075c-46d7-85f8-b7fe53977526
      iscommand: true
      name: Send Report of Hosts Found on Crowdstrike (Some Hosts)
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 7f6a583c-075c-46d7-85f8-b7fe53977526
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3550
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: Priyanka.chouhan2@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: shiva1.shankar@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: InternalIS.SecurityCompliance@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: pawan.pavanje@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: komala.kp@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: ramprakash1.r@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: sonali.teli@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: 'manoharan.g@tcs.com '
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: shreya.nayak@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: k.premanandhan@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: somraj.chakravarty@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: s.moharana@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: arunsastha.p@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: sala.e@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: vanita.gonjare@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: komal.lugade@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 94e21cb6-c86e-439c-81ca-7f10c889c269
      iscommand: false
      name: Is Email From Authorized Sender ?
      type: condition
      version: -1
    taskid: 94e21cb6-c86e-439c-81ca-7f10c889c269
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 910,
          "y": 225
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello Human,

          You are not on my authorized list of senders. Please contact Your XSOAR Support team.

          Regards,
          CSOC Cyber AutoBot
          Automation task id : ${incident.id}
      cc:
        simple: kunal.krushev@tcs.com,v.ghule@tcs.com,sonam.bhandari@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: Not Authorized For This Task
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: e99cee4e-c3c0-4f2f-8875-2f8db6739084
      iscommand: true
      name: Send Notification 'Not Authorized Sender'
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: e99cee4e-c3c0-4f2f-8875-2f8db6739084
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3550
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 3cafd216-a2c5-4831-8ce4-c301e67e9bf0
      iscommand: true
      name: Close Playbook
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 3cafd216-a2c5-4831-8ce4-c301e67e9bf0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3865
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6211645d-2923-426c-8936-6e8f0b0a1aa9
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 6211645d-2923-426c-8936-6e8f0b0a1aa9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4100
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      context_key:
        simple: Hostnotfoundarray
      file_name:
        simple: Host_Not_Found.csv
      header:
        simple: Hostname
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dc4adc25-f774-4eec-8a00-ccfacb8ae88a
      iscommand: false
      name: Create Excel Report of Hosts Not Found
      script: 98fd7176-124d-4739-8f9d-2f1edb20aa55
      type: regular
      version: -1
    taskid: dc4adc25-f774-4eec-8a00-ccfacb8ae88a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3200
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e93ac66f-6f3f-4084-8591-327ffdd50cb7
      iscommand: false
      name: Set Report To New Context
      script: Set
      type: regular
      version: -1
    taskid: e93ac66f-6f3f-4084-8591-327ffdd50cb7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3375
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        complex:
          root: Hostnotfound
      contextKey:
        simple: Hostnotfoundarray
      separator:
        simple: ','
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: d79290a7-ecf2-44d1-8db1-25c0d895b539
      iscommand: false
      name: Create Array For Report
      script: CreateArray
      type: regular
      version: -1
    taskid: d79290a7-ecf2-44d1-8db1-25c0d895b539
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3025
        }
      }
  "21":
    continueonerror: true
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          root: CrowdStrike.Device
          transformers:
          - operator: uniq
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Lifts containment on the host, which returns its network communications
        to normal.
      id: ea96d6db-caf0-4a83-899e-9c685222b7dc
      iscommand: true
      name: Lift Host Containment
      script: '|||cs-falcon-lift-host-containment'
      type: regular
      version: -1
    taskid: ea96d6db-caf0-4a83-899e-9c685222b7dc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 1975
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${TCSHostname}
      contextKey:
        simple: TCSHostnameArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: 13384de2-df04-4a27-80a4-68161a9bfc5d
      iscommand: false
      name: Create Array of Input Data
      script: CreateArray
      type: regular
      version: -1
    taskid: 13384de2-df04-4a27-80a4-68161a9bfc5d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 750
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        simple: ${TCSHostnameArray}
      contextKey:
        simple: TCSHostnameArrayCount
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 8a2ca63a-5a50-4f59-89a4-a504d6237a54
      iscommand: false
      name: Count The Array Data And Set It To Context
      script: CountArraySize
      type: regular
      version: -1
    taskid: 8a2ca63a-5a50-4f59-89a4-a504d6237a54
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 925
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      array:
        simple: ${CrowdStrike.Device.ID}
      contextKey:
        simple: CrowdStrikeDeviceIDCount
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 6995d825-ec29-4c39-89da-c824edba391f
      iscommand: false
      name: Count The CS Host ID Array Count And Set It To Context
      script: CountArraySize
      type: regular
      version: -1
    taskid: 6995d825-ec29-4c39-89da-c824edba391f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -140,
          "y": 305
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      first:
        simple: ${CrowdStrikeDeviceIdArrayCount}
      second:
        simple: ${TCSHostnameArrayCount}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Checks if one number(float) as bigger than the other(float)
        Returns yes: if first > second
        Returns no: if first <= second
        Returns exception if one of the inputs is not a number
      id: dc710f99-3de3-4bde-83f8-5b4271073c85
      iscommand: false
      name: Compare The Count Value Of The CrowdStrike Output With The Original Input
      script: IsGreaterThan
      type: condition
      version: -1
    taskid: dc710f99-3de3-4bde-83f8-5b4271073c85
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1800
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |
          Hello Human,

          One of the Hostnames in this list - ${incident.attachment.name} is not unique, and resolves to multiple device IDs. Unfortunately I've not yet learnt to identify the hostname causing the issue. Request you to review this manually.

          Regards,
          Cyber Autobot
          Automation task id : ${incident.id}
      cc:
        simple: v.ghule@tcs.com, kunal.krushev@tcs.com,internalis.cybersecurityops@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: One of The CrowdStrike Host(s) Is Not Unique - ${incident.attachment.name}
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 129591ba-f29b-453c-8f10-d3d0cbc53494
      iscommand: true
      name: Send Notification 'One of The Host Inputs is Not Unique'
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 129591ba-f29b-453c-8f10-d3d0cbc53494
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 3550
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        complex:
          accessor: ID
          root: CrowdStrike.Device
      contextKey:
        simple: CrowdStrikeDeviceIdArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: 13caa1c9-d087-43fa-8748-61c7c3d32a27
      iscommand: false
      name: Create Array From CS Info
      script: CreateArray
      type: regular
      version: -1
    taskid: 13caa1c9-d087-43fa-8748-61c7c3d32a27
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1450
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        simple: ${CrowdStrikeDeviceIdArray}
      contextKey:
        simple: CrowdStrikeDeviceIdArrayCount
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: babd6f38-157a-4735-8eb9-fb9b0550b8b7
      iscommand: false
      name: Count CS Array Size
      script: CountArraySize
      type: regular
      version: -1
    taskid: babd6f38-157a-4735-8eb9-fb9b0550b8b7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1625
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4100,
        "width": 2290,
        "x": -140,
        "y": 65
      }
    }
  }
