contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
hidden: true
id: a2ca3394-3fc8-4efd-8516-84b426893c4f
inputs: []
name: TCS-Domain Assessment For WebOPs v1.1_copy
outputs: []
sourceplaybookid: 08c3b260-77a7-4316-8c5d-802cc55f4e22
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0e344a80-45e6-4234-8850-3cac99469ad9
      iscommand: false
      name: ""
      version: -1
    taskid: 0e344a80-45e6-4234-8850-3cac99469ad9
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 460,
          "y": -510
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c8717afa-67b4-48ac-8f64-43a4177f4285
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: c8717afa-67b4-48ac-8f64-43a4177f4285
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 570,
          "y": 1420
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name:
        simple: IOC Threat Intel
      type:
        simple: pdf
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: fd821228-520f-4bb6-8d63-883375f3d8b3
      iscommand: false
      name: Generate Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: fd821228-520f-4bb6-8d63-883375f3d8b3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 640
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${InfoFile.EntryID}
      body:
        simple: |-
          Hello Human,

          The Domain is found CLEAN and can be allowed in our environment.

          Listed URLs are ${ExtractedIndicators.Domain_Test_}.

          PFA  Investigation Summary Report for Incident ${incident.id}


          Regards,
          CSOC Cyber Bot
      cc:
        simple: internalis.cybersecurityops@tcs.com,yogesh.gholap@tcs.com,kunal.krushev@tcs.com
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: WebOps URL Investigation Summary - ${incident.id}-URL found CLEAN
      to:
        simple: InternalIS.SecOpsL2Support@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: b69e3935-97e5-4b07-86f0-3999244596db
      iscommand: true
      name: Email Report Summary For Clean URL
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: b69e3935-97e5-4b07-86f0-3999244596db
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 790,
          "y": 1240
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${InfoFile.EntryID}
      body:
        simple: |-
          Hello Human,

          The Domain found is SUSPICIOUS and cannot  be allowed in our environment.

          Submitted URL : ${ExtractedIndicators.Domain_Test_}

          Suspicious URL : ${SuspiciousDomainRF}

          PFA  Investigation Summary Report for Incident ${incident.id}


          Regards,
          CSOC Cyber Bot
      cc:
        simple: internalis.cybersecurityops@tcs.com,yogesh.gholap@tcs.com,kunal.krushev@tcs.com
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: WebOps URL Investigation Summary - ${incident.id} found Suspicious
      to:
        simple: InternalIS.SecOpsL2Support@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 0e1e8c1d-cde9-4475-8141-8898db0dd61e
      iscommand: true
      name: Email Report Summary For Malicious URL To Yogesh and Kunal
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 0e1e8c1d-cde9-4475-8141-8898db0dd61e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1240
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 503c93f1-47a6-4755-8447-13fad2d77b31
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 503c93f1-47a6-4755-8447-13fad2d77b31
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 570,
          "y": 1560
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 174d2df8-8b35-46ad-8e48-d99c247201e4
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 174d2df8-8b35-46ad-8e48-d99c247201e4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 570,
          "y": 1730
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: 3d879a6a-50cc-4ef1-8971-79b827be83b8
      iscommand: true
      name: Recorded Future Enrichment
      script: Recorded Future v2|||domain
      type: regular
      version: -1
    taskid: 3d879a6a-50cc-4ef1-8971-79b827be83b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 370
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Investigate
      description: Get Domain Reputation info using Cisco Umbrella Investigate. Domain
        reputation score is either true or false from the service and cannot be modified
        using a threshold.
      id: a2c1e1a8-dc18-4a41-8ccb-5fa5782e6387
      iscommand: true
      name: Cisco Umbrella Enrichment
      script: Cisco Umbrella Investigate|||domain
      type: regular
      version: -1
    taskid: a2c1e1a8-dc18-4a41-8ccb-5fa5782e6387
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 510
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 28796879-1294-4d24-8459-d454f6ffe039
      iscommand: true
      name: Extract indicator from file
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 28796879-1294-4d24-8459-d454f6ffe039
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": -170
        }
      }
  "76":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_}
          operator: containsString
          right:
            value:
              simple: quest
        - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_}
          operator: containsString
          right:
            value:
              simple: slack
      label: "yes"
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 109ae4ec-7862-4c15-8897-64fe416665a9
      iscommand: false
      name: Check if domain belongs to Quest or slack
      type: condition
      version: -1
    taskid: 109ae4ec-7862-4c15-8897-64fe416665a9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": 160
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: c9628911-960c-4f96-8fd3-b62162cd8a65
      iscommand: true
      name: Recorded Future Enrichment
      script: Recorded Future v2|||domain
      type: regular
      version: -1
    taskid: c9628911-960c-4f96-8fd3-b62162cd8a65
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 370
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Investigate
      description: Get Domain Reputation info using Cisco Umbrella Investigate. Domain
        reputation score is either true or false from the service and cannot be modified
        using a threshold.
      id: 285b1d31-5a5a-42f2-8080-77167299b4ec
      iscommand: true
      name: Cisco Umbrella Enrichment
      script: Cisco Umbrella Investigate|||domain
      type: regular
      version: -1
    taskid: 285b1d31-5a5a-42f2-8080-77167299b4ec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 520
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "80"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name:
        simple: IOC Threat Intel
      type:
        simple: pdf
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: bdd400f9-e15e-4b7e-843c-e306c03682b1
      iscommand: false
      name: Generate Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: bdd400f9-e15e-4b7e-843c-e306c03682b1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 700
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${InfoFile.EntryID}
      body:
        simple: "Hello Human,\n\nThe Domain found contain Slack or Quest domain. Please
          take necessary action.\n\nDomain is ${ExtractedIndicators.Domain_Test_}
          \n\nPFA  Investigation Summary Report for Incident ${incident.id}\n\n\nRegards,\nCSOC
          Cyber Bot"
      cc:
        simple: sonam.bhandari@tcs.com , InternalIS.SecOpsL2Support@tcs.com
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: WebOps URL Investigation Summary - ${incident.id} contain Slack or
          Quest
      to:
        simple: yogesh.gholap@tcs.com,kunal.krushev@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: ed1e2f05-4f22-427a-823e-4136cce000a1
      iscommand: true
      name: Email Report Summary For  URL contains Slack or Quest
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: ed1e2f05-4f22-427a-823e-4136cce000a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -160,
          "y": 1240
        }
      }
  "81":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_.}
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "82"
      "yes":
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: efd8bd62-e3fd-4c8c-8954-c25612ec42d5
      iscommand: false
      name: Are there domain
      type: condition
      version: -1
    taskid: efd8bd62-e3fd-4c8c-8954-c25612ec42d5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": -10
        }
      }
  "82":
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${.=val.File.filter(function(f){return f.EntryID;}).reduce(function(acc,
          f) {return f;}, null).EntryID}
      body:
        simple: |-
          Hello Human,

          I am unable to serve you as there is no attachment  in the email.


          Regards,
          CSOC Cyber Bot
      cc:
        simple: internalis.cybersecurityops@tcs.com,yogesh.gholap@tcs.com,kunal.krushev@tcs.com
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: WebOps URL Investigation Summary - ${incident.id} No URL present in
          email
      to:
        simple: InternalIS.SecOpsL2Support@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 090747af-22cf-4cb4-8e47-e2cc29bd0fef
      iscommand: true
      name: Email team no URL to investigate
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 090747af-22cf-4cb4-8e47-e2cc29bd0fef
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 1190
        }
      }
  "83":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: InternalIS.SecOpsL2Support@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: sonam.bhandari@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: v.ghule@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: kunal.krushev@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: yogesh.gholap@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: komal.lugade@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: internalis.cyberops@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "84"
      "yes":
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 83dc63a0-6beb-4a6b-8a2f-8a43a773b2ef
      iscommand: false
      name: Is the email from Authorized sender ?
      type: condition
      version: -1
    taskid: 83dc63a0-6beb-4a6b-8a2f-8a43a773b2ef
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": -380
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${.=val.File.filter(function(f){return f.EntryID;}).reduce(function(acc,
          f) {return f;}, null).EntryID}
      body:
        simple: |-
          Hello Human,

          You are not an authorized sender . Please send email from "InternalIS.SecOpsL2Support@tcs.com"


          Regards,
          CSOC Cyber Bot
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: Not an Authorized Sender
      to:
        simple: ${incident.labels.Email/from}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 23bc5541-f919-4203-81b0-1027c0d8a518
      iscommand: true
      name: Not an authorised sender
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 23bc5541-f919-4203-81b0-1027c0d8a518
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1650,
          "y": 1190
        }
      }
  "85":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${SuspiciousDomainRF}
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: ${SuspiciousDomainUmbrella}
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "31"
      "yes":
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 06ce7690-510c-428c-85a8-5e1c55fe99d0
      iscommand: false
      name: If Risk score is not Zero
      type: condition
      version: -1
    taskid: 06ce7690-510c-428c-85a8-5e1c55fe99d0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1065
        }
      }
  "86":
    continueonerror: true
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "87"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SuspiciousDomainRF
      value:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.Domain.riskScore
              operator: isNotEqualNumber
              right:
                value:
                  simple: "0"
          root: RecordedFuture.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: df63b437-f687-4bec-8c8b-ce7c34fcfb87
      iscommand: false
      name: Set SuspiciousDomainRF
      script: Set
      type: regular
      version: -1
    taskid: df63b437-f687-4bec-8c8b-ce7c34fcfb87
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 780
        }
      }
  "87":
    continueonerror: true
    continueonerrortype: ""
    id: "87"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "85"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SuspiciousDomainUmbrella
      value:
        complex:
          accessor: Name}
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ${Domain.Umbrella.RiskScore}
              operator: isNotEqualNumber
              right:
                value:
                  simple: "0"
          root: ${Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d2c7f845-fa57-47b2-86f8-fc4dfb0dad63
      iscommand: false
      name: Set SuspiciousDomainUmbrella
      script: Set
      type: regular
      version: -1
    taskid: d2c7f845-fa57-47b2-86f8-fc4dfb0dad63
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 920
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2305,
        "width": 2190,
        "x": -160,
        "y": -510
      }
    }
  }
