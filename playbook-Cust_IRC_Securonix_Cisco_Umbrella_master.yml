contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 5cd8aa24-830d-4fe6-8493-9e21fe178e98
inputs:
- description: Please input the list of unique users and domains
  key: Unique_events
  playbookInputQuery: null
  required: false
  value: {}
name: Cust_IRC_Securonix_Cisco_Umbrella_master
outputs: []
quiet: true
sourceplaybookid: 63d20f81-72f6-4c47-80b4-daec4560c43f
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c6087738-2279-4fc9-86c9-542ed851d1b3
      iscommand: false
      name: ""
      version: -1
    taskid: c6087738-2279-4fc9-86c9-542ed851d1b3
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 50
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0ccd5fca-ab15-4875-85c4-1476ae37bf17
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 0ccd5fca-ab15-4875-85c4-1476ae37bf17
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1770
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceusername
                root: incident
          operator: isNotEmpty
      label: Saved
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      Saved:
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: da329f0f-bf34-4ff4-8e11-81c4b3fbf462
      iscommand: false
      name: Check if source username is saved
      type: condition
      version: -1
    taskid: da329f0f-bf34-4ff4-8e11-81c4b3fbf462
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 895
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          accessor: sourcehostname
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This is a generic playbook which can be used across all other playbooks where the requirement is:
        * Resolving a hostname against EPO or ITAM (in the same order) and finding out the username associated with it
        * It adds the "internal.username" key to the context with enriched information
      id: 051ee41a-c262-400f-8ee0-6942282c6a59
      iscommand: false
      name: Cust_IRC_Generic_Find_User_Of_Host_master
      playbookId: 6afcc234-b2f6-4840-85a2-4a518288ffb9
      type: playbook
      version: -1
    taskid: 051ee41a-c262-400f-8ee0-6942282c6a59
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: username
                root: internal
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: username
                root: internal
          operator: isNotEmpty
      label: Resolved
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      Resolved:
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4e7e4c12-7451-4e73-8308-52ebaf6896e1
      iscommand: false
      name: Check if user resolved
      type: condition
      version: -1
    taskid: 4e7e4c12-7451-4e73-8308-52ebaf6896e1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      username:
        complex:
          accessor: sourceusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@wipro.com'
            operator: substringTo
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This is a generic playbook which can be used across all other playbooks where the requirement is:
        * Resolving a username against EPO or ITAM (in the same order) and finding out the hostname associated with it
        * It adds the "internal.hostname" key to the context with enriched information
      id: 8a5c465a-a724-42c7-8eea-bc887abeaf39
      iscommand: false
      name: Cust_IRC_Generic_Find_Host_Of_User_master
      playbookId: b3dbbaae-4e4b-47e2-815e-c0dedd468933
      type: playbook
      version: -1
    taskid: 8a5c465a-a724-42c7-8eea-bc887abeaf39
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1420
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: domainname
          root: incident
      hostname:
        complex:
          accessor: sourcehostname
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c16e4dad-86c0-4d5f-8c8c-0b603ae4a5e8
      iscommand: false
      name: Cust_IRC_Securonix_Cisco_Umbrella_Common_subplaybook_Compliance_Check
      playbookId: 4a00c6a4-93f4-4711-85c8-144874223704
      type: playbook
      version: -1
    taskid: c16e4dad-86c0-4d5f-8c8c-0b603ae4a5e8
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1420
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourcehostname
                root: incident
          operator: isNotEmpty
      label: Saved
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "31"
      Saved:
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 653e34e5-2a78-4f7f-81db-431261efbda5
      iscommand: false
      name: Check if source hostname is  saved
      type: condition
      version: -1
    taskid: 653e34e5-2a78-4f7f-81db-431261efbda5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 705,
          "y": 1245
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: domainname
          root: incident
      Event Threshold:
        complex:
          accessor: Wipro_IRC_Cisco_Umbrella_usecase_event_threshold
          root: lists
          transformers:
          - args:
              field:
                iscontext: true
                value:
                  simple: incident.securonixpolicy
            operator: getField
      Hostname:
        complex:
          accessor: sourcehostname
          root: incident
      Username:
        complex:
          accessor: username
          root: internal
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e25afd5-bdd0-48f2-8378-52ac70eef168
      iscommand: false
      name: Cust_IRC_Cisco_Umbrella_Playbook_enrichment_actions
      playbookId: 077565ac-0e28-487c-8d0f-6e43e5138da9
      type: playbook
      version: -1
    taskid: 1e25afd5-bdd0-48f2-8378-52ac70eef168
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: domainname
          root: incident
      Event Threshold:
        complex:
          accessor: Wipro_IRC_Cisco_Umbrella_usecase_event_threshold
          root: lists
          transformers:
          - args:
              field:
                iscontext: true
                value:
                  simple: incident.securonixpolicy
            operator: getField
      Hostname:
        complex:
          accessor: hostname
          root: internal
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: incident.sourcehostname
            operator: SetIfEmpty
      Username:
        complex:
          accessor: sourceusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@wipro.com'
            operator: substringTo
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2d02d03c-d593-447f-8e24-01162f77ce45
      iscommand: false
      name: Cust_IRC_Cisco_Umbrella_Playbook_enrichment_actions
      playbookId: 077565ac-0e28-487c-8d0f-6e43e5138da9
      type: playbook
      version: -1
    taskid: 2d02d03c-d593-447f-8e24-01162f77ce45
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 705,
          "y": 1595
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        This is a generic playbook which is used across all other Securonix playbooks. It start the following timers:
        * INC Ack SLA Timer
        * INC Triage SLA Timer
        * QI Ack SLA Timer
        * QI Containment SLA Timer
        * QI Resolution SLA Timer
        * QI Closure SLA Timer
        * MTTD
        * TTAA
        * TTQ
      id: 5af66128-9767-4379-8427-f5871dfba887
      iscommand: false
      name: Cust_IRC_Securonix_Generic_Start_SLAs
      playbookId: 825c0dae-5f1e-46fe-80e0-ac72996e8129
      type: playbook
      version: -1
    taskid: 5af66128-9767-4379-8427-f5871dfba887
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 370
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This is a Securonix initializer playbook which identifies the violator
        type, gets the associated policy violations, associates MITRE indicators,
        sets default priority and severity and assigns an analyst to the incident
      id: 9dfebbd8-f04c-435d-818c-888e90aee601
      iscommand: false
      name: Cust_IRC_Securonix_Initializer
      playbookId: 3217ac4e-38e5-4d81-8c38-faf7200efc22
      type: playbook
      version: -1
    taskid: 9dfebbd8-f04c-435d-818c-888e90aee601
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 545
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      deviceaction:
        complex:
          accessor: ViolationData
          root: Securonix
          transformers:
          - args:
              field:
                value:
                  simple: deviceaction
            operator: getField
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      domainname:
        complex:
          accessor: ViolationData
          root: Securonix
          transformers:
          - args:
              field:
                value:
                  simple: destinationdnsdomain
            operator: getField
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      sourceusername:
        complex:
          accessor: ViolationData
          root: Securonix
          transformers:
          - args:
              field:
                value:
                  simple: sourceusername
            operator: getField
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 69836a26-56b8-4710-83c3-4bfd906b7f4a
      iscommand: true
      name: Set the required usecase specific incident fields in the layout
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 69836a26-56b8-4710-83c3-4bfd906b7f4a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 720
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This is a generic subplaybook of Wipro_IRC_Generic_Assign_Analyst_Shift_Based_master
        which checks the input role and reads the list and assigns the analyst accordingly
      id: 8653519a-e0be-465d-858f-d61d5458c62d
      iscommand: false
      name: Cust_IRC_Generic_Assign_Analyst_Shift_Based_subplaybook
      playbookName: Wipro_IRC_Generic_Assign_Analyst_Shift_Based_subplaybook
      type: playbook
      version: -1
    taskid: 8653519a-e0be-465d-858f-d61d5458c62d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 195
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1785,
        "width": 1035,
        "x": 50,
        "y": 50
      }
    }
  }
