contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 0a817d90-d16c-4c56-84a9-34ec212aeff3
inputs:
- description: ""
  key: IP
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Temp Add New CSOC IP Indicator v1.0_KK
outputs: []
sourceplaybookid: e653e5ab-6658-4f7a-806d-6a79d92d5d98
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c20a2964-0eb4-4201-89bc-a3fd0ec94c88
      iscommand: false
      name: ""
      version: -1
    taskid: c20a2964-0eb4-4201-89bc-a3fd0ec94c88
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -560,
          "y": -1310
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 5496690d-3e64-4de8-8bc6-b8612bf2a85b
      iscommand: true
      name: Check If Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 5496690d-3e64-4de8-8bc6-b8612bf2a85b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -560,
          "y": -590
        }
      }
  "11":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b4e84ac7-e4b7-4cae-843c-aa33365775e1
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: b4e84ac7-e4b7-4cae-843c-aa33365775e1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -560,
          "y": -420
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 95dc17f3-286c-43a1-8b0f-0b643ae2b92d
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 95dc17f3-286c-43a1-8b0f-0b643ae2b92d
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    type: title
    view: |-
      {
        "position": {
          "x": -540,
          "y": 850
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      expirationdate:
        simple: ${expirydate}
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: QradarSuspiciousIP
      type:
        simple: IP
      value:
        simple: ${inputs.IP}
      verdict:
        simple: Suspicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: a3661757-1141-43b6-84f1-7e957eeeca18
      iscommand: true
      name: Tag The Indicator With 'QradarSuspiciousIP'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: a3661757-1141-43b6-84f1-7e957eeeca18
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 95
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      expirationdate:
        simple: ${expirydate}
      tags:
        simple: QradarSuspiciousIP
      value:
        simple: ${inputs.IP}
      verdict:
        simple: Suspicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 54b7ebb1-4c5e-4ce0-880f-4b4a86cd7e05
      iscommand: true
      name: Add New CSOC Tag - QradarSuspiciousIP
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 54b7ebb1-4c5e-4ce0-880f-4b4a86cd7e05
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 420
        }
      }
  "19":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a6e979fd-7c18-40a1-8524-bccfc1408d27
      iscommand: false
      name: Is Indicator Context Set ?
      type: condition
      version: -1
    taskid: a6e979fd-7c18-40a1-8524-bccfc1408d27
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -560,
          "y": -1120
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: indicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 006885ec-294d-4a95-8fcc-3d13c7131ff8
      iscommand: false
      name: Delete 'Indicator' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 006885ec-294d-4a95-8fcc-3d13c7131ff8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -560,
          "y": -900
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: expirydate
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: in 2 hours
            operator: ModifyDateTime
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c6425d29-099d-4fcf-806c-9b21f3b4f9c8
      iscommand: false
      name: Calculate Expiry Date
      script: Set
      type: regular
      version: -1
    taskid: c6425d29-099d-4fcf-806c-9b21f3b4f9c8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": -160
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 29507d00-e395-43e3-8b20-ed410fb661d6
      iscommand: false
      name: Is The Indicator Tagged ?
      type: condition
      version: -1
    taskid: 29507d00-e395-43e3-8b20-ed410fb661d6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -260,
          "y": -160
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: expirydate
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: in 2 hours
            operator: ModifyDateTime
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: fb829612-456d-4de6-8f02-3fe99ff20c56
      iscommand: false
      name: Calculate Expiry Date
      script: Set
      type: regular
      version: -1
    taskid: fb829612-456d-4de6-8f02-3fe99ff20c56
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 270
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      expirationdate:
        simple: ${expirydate}
      tags:
        simple: QradarSuspiciousIP
      value:
        simple: ${inputs.IP}
      verdict:
        simple: Suspicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 04a89ab0-9ad4-4491-8104-0458f2549f95
      iscommand: true
      name: Update Expiry Field
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 04a89ab0-9ad4-4491-8104-0458f2549f95
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 305
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: QradarSuspiciousIP
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fe44e3b1-8fcc-42ba-8954-51caedd565c5
      iscommand: false
      name: Is Indicator Tag QradarSuspiciousIP ?
      type: condition
      version: -1
    taskid: fe44e3b1-8fcc-42ba-8954-51caedd565c5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -260,
          "y": 95
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h1 style="text-align: center;"><span style="color: #0000ff;"><strong>IP
          ${incident.labels.offense_source} Has Been Temporarily Blocked on Firewall</strong></span></h1>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 895a59dc-e824-4fce-8314-0b4763450765
      iscommand: true
      name: Set 'Action Notification' Context - IP Temp Blocked
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 895a59dc-e824-4fce-8314-0b4763450765
    timertriggers:
    - action: stop
      fieldname: responsesla
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 485
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h1 style="text-align: center;"><span style="color: #ff00ff;"><strong>IP
          ${incident.labels.offense_source} Already Blocked With Tag ${indicator.tag}</strong></span></h1>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: faaf0a12-021c-47eb-8b21-482fcc410a3b
      iscommand: true
      name: 'Set ''Action Notification'' Context - IP Already Blocked '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: faaf0a12-021c-47eb-8b21-482fcc410a3b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -260,
          "y": 485
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h1 style="text-align: center;"><span style="color: #ff0000;"><strong>IP
          ${incident.labels.offense_source} Already Blocked - Extended Expiry Date
          By 2 Months</strong></span></h1>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 60aa3b4f-1db9-4793-8e0e-6d87bf30ebfc
      iscommand: true
      name: Set 'Action Notification' Context - IP Already Blocked Expiry Extended
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 60aa3b4f-1db9-4793-8e0e-6d87bf30ebfc
    timertriggers:
    - action: stop
      fieldname: responsesla
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 590
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "23_24_#default#": 0.43,
      "23_35_yes": 0.74,
      "35_24_yes": 0.37
    },
    "paper": {
      "dimensions": {
        "height": 2225,
        "width": 1490,
        "x": -900,
        "y": -1310
      }
    }
  }
