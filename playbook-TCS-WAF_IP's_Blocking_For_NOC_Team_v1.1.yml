contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: df2dbd62-f8c0-4dd1-8f96-d9fa7e79c5bb
inputs: []
name: TCS-WAF IP's Blocking For NOC Team_v1.1
outputs: []
quiet: true
sourceplaybookid: 8d9f6469-76aa-4588-854b-4aebbf2c0818
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e5dcacaa-f3bf-4bd1-865b-b793267d9600
      iscommand: false
      name: ""
      version: -1
    taskid: e5dcacaa-f3bf-4bd1-865b-b793267d9600
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 550,
          "y": -560
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      listName:
        simple: WAF_IP's_Needtobeblock
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.get
      id: d902f5b4-873c-4e01-8f68-07c8b42d1925
      iscommand: true
      name: Get the list for IP
      script: Builtin|||getList
      type: regular
      version: -1
    taskid: d902f5b4-873c-4e01-8f68-07c8b42d1925
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -320,
          "y": 340
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          root: File
      bcc:
        simple: porkodi.g@tcs.com,komal.lugade@tcs.com
      body:
        simple: |
          Hi Team,

          This is critical CSOC notification for blacklisting suspicious IP Address(s).

          Our investigation has concluded these IP Address(s) are suspicious with possible malicious intent. Kindly blacklist the IP Address(s) on priority.

          Note: Once blocking is done kindly revert to internalis.cybersecurityops@tcs.com

          Thanks and Regards,
          Cyberautobot
      cc:
        simple: internalis.cybersecurityops@tcs.com,yogesh.gholap@tcs.com,kunal.krushev@tcs.com,nimisha.prajapati@tcs.com
      subject:
        simple: IP need to be blocked based on Critical alerts
      to:
        simple: internalis.noc@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: e5af4868-c0a1-46a0-8c27-82407be74ccb
      iscommand: true
      name: 'send the mail to NOC team '
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: e5af4868-c0a1-46a0-8c27-82407be74ccb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -220,
          "y": 570
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${Value}
      listName:
        simple: WAF_IP's_Needtobeblock
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.remove
      id: dd69fdcd-f824-42d6-8c13-6ac3d9be1cfe
      iscommand: true
      name: Delete the data in WAF list
      script: Builtin|||removeFromList
      type: regular
      version: -1
    taskid: dd69fdcd-f824-42d6-8c13-6ac3d9be1cfe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 770,
          "y": 905
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Value
      value:
        complex:
          accessor: WAF_IP's_Needtobeblock
          root: lists
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 47ceee54-ed6a-40c8-8778-577bd93a40ee
      iscommand: false
      name: 'Get the list '
      script: Set
      type: regular
      version: -1
    taskid: 47ceee54-ed6a-40c8-8778-577bd93a40ee
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 550,
          "y": -425
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      context_key:
        simple: Value
      file_name:
        simple: IP's Needs to Block.csv
      header:
        simple: IP's
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2b38c671-7d8b-4ec3-8b22-e6b9474e30e5
      iscommand: false
      name: Convert into CSV
      script: 98fd7176-124d-4739-8f9d-2f1edb20aa55
      type: regular
      version: -1
    taskid: 2b38c671-7d8b-4ec3-8b22-e6b9474e30e5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 770,
          "y": 290
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Value
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 363f01ed-f79e-467a-860c-2504db1b09c5
      iscommand: false
      name: Check the value is define
      type: condition
      version: -1
    taskid: 363f01ed-f79e-467a-860c-2504db1b09c5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 550,
          "y": -240
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: cba93acb-b6ac-45f5-88b2-6a1a2e7048a4
      iscommand: true
      name: 'Close Investigation '
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: cba93acb-b6ac-45f5-88b2-6a1a2e7048a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 550,
          "y": 1150
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: db4108b6-b745-49e1-89a5-84cda6b94bb2
      iscommand: false
      name: END
      type: title
      version: -1
    taskid: db4108b6-b745-49e1-89a5-84cda6b94bb2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 550,
          "y": 1340
        }
      }
  "11":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Have you blocked IP's?
        options: []
        optionsarg:
        - {}
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: IP blocking Confirmation
      totalanswers: 0
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject:
        simple: WAF IP blocking
      timings:
        completeafterreplies: 0
        completeaftersla: true
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: {}
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    sla:
      days: 0
      hours: 12
      minutes: 0
      weeks: 0
    task:
      brand: ""
      id: f17c31f8-7bff-4c9a-8c6c-5fb75cc73113
      iscommand: false
      name: Data collection
      type: collection
      version: -1
    taskid: f17c31f8-7bff-4c9a-8c6c-5fb75cc73113
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1300,
          "y": 755
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sleep for X seconds.
      id: 013f8c22-d8f0-4047-84c7-090906fe2d35
      iscommand: false
      name: Sleep
      script: Sleep
      type: regular
      version: -1
    taskid: 013f8c22-d8f0-4047-84c7-090906fe2d35
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1300,
          "y": 310
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        complex:
          root: Value
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 0f698321-182f-46ef-89a3-abcd61fa6557
      iscommand: false
      name: count the array size
      script: CountArraySize
      type: regular
      version: -1
    taskid: 0f698321-182f-46ef-89a3-abcd61fa6557
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 990,
          "y": -70
        }
      }
  "15":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ArraySize
          operator: greaterThan
          right:
            value:
              simple: "1"
      label: "yes"
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      - "12"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f6225a9b-b8d1-4de8-83e5-32b8fa23aea5
      iscommand: false
      name: Check for size
      type: condition
      version: -1
    taskid: f6225a9b-b8d1-4de8-83e5-32b8fa23aea5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 990,
          "y": 110
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Value
      value:
        complex:
          accessor: WAF_IP's_Needtobeblock
          root: lists
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9bac0a5d-20e9-40c0-85fd-20fb20bf9a8f
      iscommand: false
      name: 'Get the list '
      script: Set
      type: regular
      version: -1
    taskid: 9bac0a5d-20e9-40c0-85fd-20fb20bf9a8f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -60,
          "y": -400
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${Value}
      listName:
        simple: WAF_IP's_Needtobeblock
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.remove
      id: 62a64373-bd65-4c3b-8119-bc8deb938d8f
      iscommand: true
      name: Delete the data in WAF list
      script: Builtin|||removeFromList
      type: regular
      version: -1
    taskid: 62a64373-bd65-4c3b-8119-bc8deb938d8f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": 810
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sleep for X seconds.
      id: 1c34f27d-2b67-4598-86ea-72d5291c6dc0
      iscommand: false
      name: Sleep
      script: Sleep
      type: regular
      version: -1
    taskid: 1c34f27d-2b67-4598-86ea-72d5291c6dc0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 770,
          "y": 490
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: IP blocking Confirmation.Answers
          operator: isExists
      label: "yes"
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: IP blocking Confirmation.Answers
          operator: isNotExists
      label: Expired
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Expired:
      - "21"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bc45c3eb-5780-4b2b-8fdc-dce0f517426e
      iscommand: false
      name: Check the response
      type: condition
      version: -1
    taskid: bc45c3eb-5780-4b2b-8fdc-dce0f517426e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 905
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: a40b4b93-29d6-4952-8d4d-3c8b85053203
      iscommand: true
      name: closeInvestigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: a40b4b93-29d6-4952-8d4d-3c8b85053203
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1300,
          "y": 1150
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          root: File
      bcc:
        simple: jyoti.pawar1@tcs.com,komal.lugade@tcs.com,porkodi.g@tcs.com,keerthana.ramesh@tcs.com
      body:
        simple: |
          Hi Team,

          This is critical CSOC notification for blacklisting suspicious IP Address(s).

          Our investigation has concluded these IP Address(s) are suspicious with possible malicious intent. Kindly blacklist the IP Address(s) on priority.

          Note: Kindly confirm the IP blocking on the below link. This link will expire after 12 Hour

          ${IP blocking Confirmation.Links.0.link}

          Thanks and Regards,
          Cyberautobot
      cc:
        simple: internalis.cybersecurityops@tcs.com,yogesh.gholap@tcs.com,kunal.krushev@tcs.com,nimisha.prajapati@tcs.com
      subject:
        simple: IP need to be blocked based on Critical alerts
      to:
        simple: internalis.noc@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 9e3594d5-4f01-4705-8230-8b031debcee1
      iscommand: true
      name: 'send the mail to NOC team '
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 9e3594d5-4f01-4705-8230-8b031debcee1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 770,
          "y": 685
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      bcc:
        simple: jyoti.pawar1@tcs.com,komal.lugade@tcs.com,porkodi.g@tcs.com,keerthana.ramesh@tcs.com
      body:
        simple: |
          Hi Team,

          This is critical CSOC notification for blacklisting suspicious IP Address(s).

          Our investigation has concluded these IP Address(s) are suspicious with possible malicious intent. Kindly blacklist the IP Address(s) on priority.

          IP : ${Value}

          Note: Kindly confirm the IP blocking on the below link.

          ${IP blocking Confirmation.Links.0.link}

          Thanks and Regards,
          Cyberautobot
      cc:
        simple: internalis.cybersecurityops@tcs.com,yogesh.gholap@tcs.com,kunal.krushev@tcs.com,nimisha.prajapati@tcs.com
      subject:
        simple: IP need to be blocked based on Critical alerts
      to:
        simple: internalis.noc@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: b777290d-870f-4a49-83b3-8f7a2a3ca9af
      iscommand: true
      name: 'send the mail to NOC team '
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: b777290d-870f-4a49-83b3-8f7a2a3ca9af
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1300,
          "y": 550
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1965,
        "width": 2000,
        "x": -320,
        "y": -560
      }
    }
  }
