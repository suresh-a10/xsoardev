contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: bcaddc7b-d2e8-46c5-8761-d197e5d28e19
inputs:
- description: ""
  key: EmailedFileData
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: File
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Generic EDL Upload IP BlockList handler v1.0_KK
outputs:
- contextPath: EmailedDomainsURLsUnique
  description: Global Context Key for emailed Domains/URL's joined and deduped
  type: unknown
- contextPath: JoinedFilesUnique
  description: Global Context Key for emailed IP's joined with IP Blocklist EDL and
    deduped
  type: unknown
- contextPath: EmailedHashs-SHA256
  description: Global Context Key for SHA256 Hashs received by Email
  type: unknown
- contextPath: EmailedHashs-SHA1
  description: Global Context Key for SHA1 Hashs received by Email
  type: unknown
- contextPath: EmailedHashs-MD5
  description: Global Context Key for MD5 Hashs received by Email
  type: unknown
- contextPath: EmailedIPs
  description: Global Context Key for IPs received by Email
  type: unknown
- contextPath: EmailedDomains
  description: Global Context Key for Domains received by Email
  type: unknown
sourceplaybookid: 3a37bf98-d8e9-4ab9-8889-dba63691e69c
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 18d292cb-83fb-446e-8efb-bf984e3c50d2
      iscommand: false
      name: ""
      version: -1
    taskid: 18d292cb-83fb-446e-8efb-bf984e3c50d2
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 600,
          "y": -370
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c9f8e308-1f91-43e0-81ef-c3deea4a1dc6
      iscommand: false
      name: 'IP Block PLaybook: Update existing Recorded Blocklists'
      type: title
      version: -1
    taskid: c9f8e308-1f91-43e0-81ef-c3deea4a1dc6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 100,
          "y": -240
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dde85326-8260-4492-850e-bd510026fd5b
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: dde85326-8260-4492-850e-bd510026fd5b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 110,
          "y": 70
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 49cd7fc4-946b-4746-88be-451784b17e5f
      iscommand: false
      name: Add URL IOC's to ZScaler Blocklist
      type: title
      version: -1
    taskid: 49cd7fc4-946b-4746-88be-451784b17e5f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1020,
          "y": -250
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      url:
        complex:
          root: ${EmailedDomainsURLsUnique}
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds URL to the blacklist.
      id: ed67ff96-b562-4d73-8d16-d9dac8489ad5
      iscommand: true
      name: Upload URL Block List to ZScaler
      script: '|||zscaler-blacklist-url'
      type: regular
      version: -1
    taskid: ed67ff96-b562-4d73-8d16-d9dac8489ad5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1020,
          "y": -130
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 396e5a39-c19d-403c-89c1-45e42233a8c7
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 396e5a39-c19d-403c-89c1-45e42233a8c7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 20
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dcf1334a-cdcb-4fb4-89d8-37c11cf245d2
      iscommand: false
      name: Add Hash to Crowdstrike
      type: title
      version: -1
    taskid: dcf1334a-cdcb-4fb4-89d8-37c11cf245d2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1440,
          "y": -250
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4d27a0b3-af81-4c35-82ad-418a7a029073
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 4d27a0b3-af81-4c35-82ad-418a7a029073
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 20
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4dd33de7-7e44-4dde-801b-645c39308ea6
      iscommand: false
      name: Add Domain to Bluecoat Proxy
      type: title
      version: -1
    taskid: 4dd33de7-7e44-4dde-801b-645c39308ea6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1860,
          "y": -250
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a3fe75c9-cda1-4487-8cf2-ddf46ae3e5db
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: a3fe75c9-cda1-4487-8cf2-ddf46ae3e5db
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1860,
          "y": 20
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      EmailedFileData:
        simple: ${inputs.FileData}
      File:
        simple: ${inputs.File}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 199129ca-245f-4557-81ef-72d9feeb95ae
      iscommand: false
      name: TCS-Upload BlockList to Webserver
      playbookId: dbc273f1-c131-4e07-80e6-4babc78a9e03
      type: playbook
      version: -1
    taskid: 199129ca-245f-4557-81ef-72d9feeb95ae
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 100,
          "y": -90
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 505,
        "width": 2140,
        "x": 100,
        "y": -370
      }
    }
  }
