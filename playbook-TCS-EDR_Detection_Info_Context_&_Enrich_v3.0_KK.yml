contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 7fc59798-8aed-40aa-8d42-eb7b85340cd0
inputs: []
name: TCS-EDR Detection Info Context & Enrich v3.0_KK
outputs: []
quiet: true
sourceplaybookid: 58a33f37-14f8-4fae-8ec5-ee4d39f9ff19
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
      - "53"
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3d12dd09-6c92-43b5-8a78-68cc99bd3f09
      iscommand: false
      name: ""
      version: -1
    taskid: 3d12dd09-6c92-43b5-8a78-68cc99bd3f09
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 410,
          "y": -1505
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ParentProcessID
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ParentProcessID
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f71dde33-e0b0-43fe-80a9-53d2b8de5abf
      iscommand: false
      name: Is There Context ParentProcessID ?
      type: condition
      version: -1
    taskid: f71dde33-e0b0-43fe-80a9-53d2b8de5abf
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": 190
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeparentprocessid:
        complex:
          accessor: ParentProcessID
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: ce7304ab-9d20-45e3-89e2-0e2295b55d30
      iscommand: true
      name: Set Context ParentProcessID
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ce7304ab-9d20-45e3-89e2-0e2295b55d30
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 400
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: FileName
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: FileName
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2a5cc788-dd8f-4d62-83f6-1b92ca68f4a2
      iscommand: false
      name: Is There Context FileName ?
      type: condition
      version: -1
    taskid: 2a5cc788-dd8f-4d62-83f6-1b92ca68f4a2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 190
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikefilename:
        complex:
          accessor: FileName
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8184a6c1-a9b5-4fdc-843b-e939ee927716
      iscommand: true
      name: Set Context FileName
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8184a6c1-a9b5-4fdc-843b-e939ee927716
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 400
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 19a618f6-9d61-439c-8b48-ae3a0946d231
      iscommand: false
      name: Check If There Are Any Reports
      type: title
      version: -1
    taskid: 19a618f6-9d61-439c-8b48-ae3a0946d231
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1195
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: SHA256
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: SHA256
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0626dd32-165b-4662-85cd-d280b2a7f304
      iscommand: false
      name: Is There Context SHA256?
      type: condition
      version: -1
    taskid: 0626dd32-165b-4662-85cd-d280b2a7f304
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 190
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      crowdstrikefilehash:
        complex:
          accessor: SHA256
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: '"'
            operator: split
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 0da887ac-8846-41f8-85de-a0a740191d16
      iscommand: true
      name: Set Context SHA256
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 0da887ac-8846-41f8-85de-a0a740191d16
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 400
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: UserName
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: UserName
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 852e6cb3-b786-46a6-8311-7bb958ff4d9c
      iscommand: false
      name: Is There Context UserName?
      type: condition
      version: -1
    taskid: 852e6cb3-b786-46a6-8311-7bb958ff4d9c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 190
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeusername:
        complex:
          accessor: UserName
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 4d6aca91-34be-486b-8fc2-08dab4c73dd9
      iscommand: true
      name: Set Context UserName
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 4d6aca91-34be-486b-8fc2-08dab4c73dd9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 400
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LocalIP
                root: CrowdStrike.Device
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LocalIP
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 57157082-293f-4ea0-839b-a0890060d21e
      iscommand: false
      name: Is There Context LocalIP ?
      type: condition
      version: -1
    taskid: 57157082-293f-4ea0-839b-a0890060d21e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2640,
          "y": 190
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeinternalipaddress:
        complex:
          accessor: LocalIP
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 09c4e6eb-4aa4-4217-8e5e-b401ec71f133
      iscommand: true
      name: Set Context LocalIP
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 09c4e6eb-4aa4-4217-8e5e-b401ec71f133
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2640,
          "y": 390
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ExternalIP
                root: CrowdStrike.Device
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ExternalIP
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fad1a32c-f3fd-47b2-84fb-6041893a01d3
      iscommand: false
      name: Is There Context ExternalIP ?
      type: condition
      version: -1
    taskid: fad1a32c-f3fd-47b2-84fb-6041893a01d3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3090,
          "y": 190
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeexternalipaddress:
        complex:
          accessor: ExternalIP
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8f2e2dfa-7247-4941-8c3a-ae14c38a4198
      iscommand: true
      name: Set Context ExternalIP
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8f2e2dfa-7247-4941-8c3a-ae14c38a4198
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3090,
          "y": 390
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: CommandLine
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: CommandLine
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 53e7997d-a234-4ede-82cb-f85f30f1fd9f
      iscommand: false
      name: Is There Context CommandLine ?
      type: condition
      version: -1
    taskid: 53e7997d-a234-4ede-82cb-f85f30f1fd9f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3540,
          "y": 190
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikecmdline:
        complex:
          accessor: CommandLine
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 57ca0308-fdf8-4d80-8c99-92398d01637e
      iscommand: true
      name: 'Set Context CommandLine '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 57ca0308-fdf8-4d80-8c99-92398d01637e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3540,
          "y": 390
        }
      }
  "16":
    continueonerror: true
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        complex:
          accessor: crowdstrikeusername
          root: incident
      retry-count:
        simple: "1"
      using:
        simple: Active Directory Query v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a user account. The user can
        be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filter is specified, all users are returned.
      id: 3a7d278a-f658-4851-83f4-6dcaf949824d
      iscommand: true
      name: Get User Information From AD
      script: Active Directory Query v2|||ad-get-user
      tags:
      - ADRESULT
      type: regular
      version: -1
    taskid: 3a7d278a-f658-4851-83f4-6dcaf949824d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 780
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: System
                root: CrowdStrike.Detection
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: System
                root: CrowdStrike.Detection
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 44984885-ef4e-4b05-8f0b-e3eb12359811
      iscommand: false
      name: Is There Context System ?
      type: condition
      version: -1
    taskid: 44984885-ef4e-4b05-8f0b-e3eb12359811
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3980,
          "y": 190
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikehostname:
        complex:
          accessor: System
          root: CrowdStrike.Detection
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fe4556e1-886a-447a-884d-0288da1d535b
      iscommand: true
      name: Set Context System
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: fe4556e1-886a-447a-884d-0288da1d535b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3980,
          "y": 400
        }
      }
  "19":
    continueonerror: true
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        complex:
          accessor: crowdstrikehostname
          root: incident
      retry-count:
        simple: "1"
      using:
        simple: Active Directory Query v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a computer account. The computer
        can be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filters are provided, all computers are returned.
      id: c470efb5-1938-4701-87de-38cef9651182
      iscommand: true
      name: Get Computer Info From AD
      script: Active Directory Query v2|||ad-get-computer
      tags:
      - ADRESULT
      type: regular
      version: -1
    taskid: c470efb5-1938-4701-87de-38cef9651182
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": -180
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOCValue
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOCValue
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cd8cc2f1-cdb5-46a6-8043-0ae23441bac9
      iscommand: false
      name: Is There Context IOCValue
      type: condition
      version: -1
    taskid: cd8cc2f1-cdb5-46a6-8043-0ae23441bac9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4440,
          "y": 190
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Scenario
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Scenario
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d13d3c79-ed07-4af2-8c15-532a413078ca
      iscommand: false
      name: Is There Context Scenario
      type: condition
      version: -1
    taskid: d13d3c79-ed07-4af2-8c15-532a413078ca
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4870,
          "y": 190
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
      - "69"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      csiocvalue:
        complex:
          accessor: IOCValue
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: InnerServicesModule
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 157ab687-c950-4165-887c-85edba363695
      iscommand: true
      name: Set Context IOCValue
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 157ab687-c950-4165-887c-85edba363695
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4440,
          "y": 380
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: csiocvalue
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 55bf959f-de42-4abc-8407-42551e1e3649
      iscommand: true
      name: Enrich IOC
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 55bf959f-de42-4abc-8407-42551e1e3649
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4440,
          "y": 570
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: SHA256
          root: CrowdStrike.Detection.Behavior
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: c53a9dab-a7be-4987-8dda-f2ee1ef6267c
      iscommand: true
      name: Enrich IOC
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: c53a9dab-a7be-4987-8dda-f2ee1ef6267c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 570
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      csscenario:
        complex:
          accessor: Scenario
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: InnerServicesModule
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8feb5bc2-331e-48b0-868a-2033df2eb907
      iscommand: true
      name: Set Context Scenario
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8feb5bc2-331e-48b0-868a-2033df2eb907
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4870,
          "y": 380
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: description
                root: CrowdStrike.Detections.behaviors
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: description
                root: CrowdStrike.Detections.behaviors
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1801a87a-dd06-4070-8043-8ae393955b9a
      iscommand: false
      name: Is There description ?
      type: condition
      version: -1
    taskid: 1801a87a-dd06-4070-8043-8ae393955b9a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 0,
          "y": 190
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      descriptionoffense:
        complex:
          accessor: description
          root: CrowdStrike.Detections.behaviors
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: c3dbfb16-24e8-4f6b-87d0-19a9d6d92291
      iscommand: true
      name: Set Context Description
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: c3dbfb16-24e8-4f6b-87d0-19a9d6d92291
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 0,
          "y": 400
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tactic
                root: CrowdStrike.Detections.behaviors
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tactic
                root: CrowdStrike.Detections.behaviors
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a9190f65-3e96-4a68-8bae-83e9d9095569
      iscommand: false
      name: Is There tactic?
      type: condition
      version: -1
    taskid: a9190f65-3e96-4a68-8bae-83e9d9095569
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -440,
          "y": 190
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstriketactic:
        complex:
          accessor: tactic
          root: CrowdStrike.Detections.behaviors
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      descriptionoffense:
        complex:
          accessor: description
          root: CrowdStrike.Detections.behaviors
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f325062c-b715-4f00-8bc9-faed3c8d3976
      iscommand: true
      name: Set Context tactic
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f325062c-b715-4f00-8bc9-faed3c8d3976
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -440,
          "y": 400
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: technique
                root: CrowdStrike.Detections.behaviors
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: technique
                root: CrowdStrike.Detections.behaviors
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ca9c8eca-0dd5-48bf-84e3-ebf0245db8d6
      iscommand: false
      name: Is There technique?
      type: condition
      version: -1
    taskid: ca9c8eca-0dd5-48bf-84e3-ebf0245db8d6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -880,
          "y": 190
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstriketechnique:
        complex:
          accessor: technique
          root: CrowdStrike.Detections.behaviors
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 7b61ef67-71de-4101-8542-be243afe0084
      iscommand: true
      name: Set Context technique
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 7b61ef67-71de-4101-8542-be243afe0084
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -880,
          "y": 400
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: parent_cmdline
                root: CrowdStrike.Detections.behaviors.parent_details
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: parent_cmdline
                root: CrowdStrike.Detections.behaviors.parent_details
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4b1efc8c-6eb3-44f4-81bc-888f63548954
      iscommand: false
      name: Is There parent_cmdline?
      type: condition
      version: -1
    taskid: 4b1efc8c-6eb3-44f4-81bc-888f63548954
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1320,
          "y": 190
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      csparentcmdline:
        complex:
          accessor: parent_cmdline
          root: CrowdStrike.Detections.behaviors.parent_details
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 34557fe9-f25e-4157-887c-63eaf7a54b87
      iscommand: true
      name: Set Context parent_cmdline
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 34557fe9-f25e-4157-887c-63eaf7a54b87
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1320,
          "y": 400
        }
      }
  "36":
    continueonerror: true
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      retry-count:
        simple: "3"
      using:
        simple: Active Directory Query v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a user account. The user can
        be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filter is specified, all users are returned.
      id: 0a32508c-22dd-45d3-8938-d688851037a7
      iscommand: true
      name: Get User Information From AD
      script: Active Directory Query v2|||ad-get-user
      tags:
      - ADRESULT
      type: regular
      version: -1
    taskid: 0a32508c-22dd-45d3-8938-d688851037a7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 780
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikeusername
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: '@'
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      - "59"
      - "63"
      - "67"
      "yes":
      - "36"
      - "58"
      - "62"
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ef0f3df1-e39f-4111-8450-ff2df4ba189e
      iscommand: false
      name: Does The Username Contain @ ?
      type: condition
      version: -1
    taskid: ef0f3df1-e39f-4111-8450-ff2df4ba189e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 570
        }
      }
  "38":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Status
                root: WildFire.Report
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Status
                root: WildFire.Report
          operator: isEqualString
          right:
            value:
              simple: Success
      label: "yes"
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 160ebe88-2318-407f-86d9-e525c0b3da2d
      iscommand: false
      name: Is There Context WildFire ?
      type: condition
      version: -1
    taskid: 160ebe88-2318-407f-86d9-e525c0b3da2d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1320
        }
      }
  "39":
    continueonerror: true
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Wild Fire Report
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 2
    scriptarguments:
      sha256:
        complex:
          accessor: SHA256
          root: WildFire.Report
      using:
        simple: WildFire-v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: WildFire-v2
      description: Retrieves results for a file hash using WildFire.
      id: 321cd6fe-e2e6-4d93-8568-c3e46696fb7a
      iscommand: true
      name: Get Wild Fire Report
      script: WildFire-v2|||wildfire-report
      tags:
      - sandboxreport
      type: regular
      version: -1
    taskid: 321cd6fe-e2e6-4d93-8568-c3e46696fb7a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1550
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cb566c03-8b50-41d9-80fc-b1b95c35075b
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: cb566c03-8b50-41d9-80fc-b1b95c35075b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1770
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        simple: ${incident.crowdstrikedetectionid}
      retry-count:
        simple: "3"
      using:
        simple: ${incident.sourceInstance}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Search for details of specific detections, either using a filter
        query, or by providing the IDs of the detections.
      id: 1c8637d0-6680-4a6e-812e-2aba9c7398ac
      iscommand: true
      name: Fetch Detection Details CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-search-detection
      type: regular
      version: -1
    taskid: 1c8637d0-6680-4a6e-812e-2aba9c7398ac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": -1150
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        simple: ${incident.crowdstrikedetectionid}
      retry-count:
        simple: "3"
      using:
        simple: ${incident.sourceInstance}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Lists detection summaries.
      id: 148e3be4-6651-48f5-8ae9-5d21a6bef153
      iscommand: true
      name: Fetch Detection Summary CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-list-detection-summaries
      type: regular
      version: -1
    taskid: 148e3be4-6651-48f5-8ae9-5d21a6bef153
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": -950
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
      - "33"
      - "31"
      - "29"
      - "27"
      - "3"
      - "6"
      - "8"
      - "10"
      - "12"
      - "14"
      - "19"
      - "20"
      - "22"
      - "50"
      - "48"
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          accessor: crowdstrikehostname
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: ${incident.sourceInstance}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: 5a870684-6717-4b6d-8d00-8de33b78b56e
      iscommand: true
      name: Fetch Host Details
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: 5a870684-6717-4b6d-8d00-8de33b78b56e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": -640
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikedetectionid
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ad6fd768-d64b-421f-84f1-3cfe90bebd45
      iscommand: false
      name: Is There A CrowdStrike Detection ?
      type: condition
      version: -1
    taskid: ad6fd768-d64b-421f-84f1-3cfe90bebd45
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": -1330
        }
      }
  "48":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketacticid
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9c23c1c8-528b-4ea6-8e9e-bb0e057d4f5e
      iscommand: false
      name: Is There Tactic id ?
      type: condition
      version: -1
    taskid: 9c23c1c8-528b-4ea6-8e9e-bb0e057d4f5e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1760,
          "y": 190
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: crowdstriketacticid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 2346155c-5f83-43a6-80f7-a1e5f7296897
      iscommand: true
      name: Enrich MITRE Id
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 2346155c-5f83-43a6-80f7-a1e5f7296897
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1760,
          "y": 400
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketechniqueid
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5d36f6ce-4a6c-45c9-890e-e4218f8313c3
      iscommand: false
      name: Is There Technique id ?
      type: condition
      version: -1
    taskid: 5d36f6ce-4a6c-45c9-890e-e4218f8313c3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2170,
          "y": 190
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: crowdstriketechniqueid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 1610e83f-8f39-4324-8fc6-a76b4ca5f771
      iscommand: true
      name: Enrich MITRE Id
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 1610e83f-8f39-4324-8fc6-a76b4ca5f771
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2170,
          "y": 400
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      playbookrepository:
        simple: https://tcscomprod.sharepoint.com/sites/CSOC/Shared%20Documents/Forms/AllItems.aspx?csf=1&web=1&e=KYjw1j&cid=921a35a0%2D0000%2D4c6c%2D8408%2Dba87b58b62ce&RootFolder=%2Fsites%2FCSOC%2FShared%20Documents%2FGeneral%2FInvestigation%20Steps&FolderCTID=0x0120000CB0DB63BA83C14C9572FB2178E87F0B
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 70c8c61b-cc70-4c00-832b-90c091886405
      iscommand: true
      name: 'Set Playbook Repository Link '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 70c8c61b-cc70-4c00-832b-90c091886405
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2600,
          "y": 400
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      prioritymatrix:
        simple: |-
          <table style="height: 212px; border-style: solid; width: 658px; background-color: #ffffff;" width="658">
          <tbody>
          <tr style="height: 46px;">
          <td style="height: 92px; width: 199.688px; border-style: solid;" colspan="2" rowspan="2">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Priority</span><span style="color: #0000ff;"> Matrix</span></strong></h3>
          </td>
          <td style="height: 46px; width: 442.312px; border-style: solid;" colspan="3">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Impact</span></strong></h3>
          </td>
          </tr>
          <tr style="height: 46px;">
          <td style="height: 46px; width: 124.094px; border-style: solid;">
          <h3><strong>&nbsp;1 - High</strong></h3>
          </td>
          <td style="height: 46px; width: 120.297px; border-style: solid;">
          <h3><strong>&nbsp;2 - Medium</strong></h3>
          </td>
          <td style="height: 46px; width: 185.922px; border-style: solid;">
          <h3><strong>&nbsp;3 - Low</strong></h3>
          </td>
          </tr>
          <tr style="height: 46px;">
          <td style="height: 120px; width: 93.25px; border-style: solid;" rowspan="3">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Urgency</span></strong></h3>
          </td>
          <td style="height: 46px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;1 - High</strong></h3>
          </td>
          <td style="height: 46px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff0000;">0- Critical</span></strong></h3>
          </td>
          <td style="height: 46px; width: 120.297px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff9900;">1 - High</span></strong></h3>
          </td>
          <td style="height: 46px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #00ccff;">2 - Medium</span></strong></h3>
          </td>
          </tr>
          <tr style="height: 64px;">
          <td style="height: 64px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;2 - Medium</strong></h3>
          </td>
          <td style="height: 64px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff9900;">1 - High</span></strong></h3>
          </td>
          <td style="height: 64px; width: 120.297px; border-style: solid;">
          <h3><strong><span style="color: #00ccff;">&nbsp;2 - Medium</span></strong></h3>
          </td>
          <td style="height: 64px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<span style="color: #ff00ff;"><strong>3 - Low</strong></span></h3>
          </td>
          </tr>
          <tr style="height: 10px;">
          <td style="height: 10px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;3 - Low</strong></h3>
          </td>
          <td style="height: 10px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<span style="color: #00ccff;"><strong>2 - Medium</strong></span></h3>
          </td>
          <td style="height: 10px; width: 120.297px; border-style: solid;">
          <h3><span style="color: #ff00ff;">&nbsp;<strong>3 - Low</strong></span></h3>
          </td>
          <td style="height: 10px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #339966;">4 - Informational</span></strong></h3>
          </td>
          </tr>
          </tbody>
          </table>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: bd3fdfb8-a18c-487a-878e-d5d31264dea9
      iscommand: true
      name: Set Priority Matrix Table
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: bd3fdfb8-a18c-487a-878e-d5d31264dea9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -3030,
          "y": 400
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: true
    quietmode: 0
    scriptarguments:
      fieldExactMatch:
        simple: incident.crowdstrikehostname
      fromDate:
        simple: 12 months ago
      similarTextField:
        simple: incident.crowdstrikehostname
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Find past similar incidents based on incident fields' similarity.
        Includes an option to also display indicators similarity.
      id: 48261004-ffb3-4223-81a6-34b00f808efc
      iscommand: false
      name: Find Past Detection For Same Host
      script: DBotFindSimilarIncidents
      tags:
      - Note
      - pastevents
      type: regular
      version: -1
    taskid: 48261004-ffb3-4223-81a6-34b00f808efc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 5310,
          "y": 190
        }
      }
  "57":
    continueonerror: true
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      hostname:
        complex:
          accessor: crowdstrikehostname
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: 206badf0-f47c-490c-8903-677e685ba955
      iscommand: true
      name: Get Computer Info From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: 206badf0-f47c-490c-8903-677e685ba955
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": 10
        }
      }
  "58":
    continueonerror: true
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      empid:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: bc0fdf58-b9bb-4b87-8050-4fb8bd1368b7
      iscommand: true
      name: Get User Information From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: bc0fdf58-b9bb-4b87-8050-4fb8bd1368b7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2570,
          "y": 780
        }
      }
  "59":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikeusername
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsGeneral
          right:
            value:
              simple: ad.
      label: "yes"
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 827b7bc6-197a-4faf-87ad-f6d5e02d6a10
      iscommand: false
      name: Does The Username Contain "ad."?
      type: condition
      version: -1
    taskid: 827b7bc6-197a-4faf-87ad-f6d5e02d6a10
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 780
        }
      }
  "60":
    continueonerror: true
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      empid:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              from:
                value:
                  simple: .
            operator: substringFrom
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: 4c1187fe-757f-4025-8879-9c32cc9a362f
      iscommand: true
      name: Get User Information From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: 4c1187fe-757f-4025-8879-9c32cc9a362f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": 960
        }
      }
  "61":
    continueonerror: true
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      empid:
        complex:
          accessor: crowdstrikeusername
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: c274176a-ff9d-43d2-8ad9-8f79e9a4889c
      iscommand: true
      name: Get User Information From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: c274176a-ff9d-43d2-8ad9-8f79e9a4889c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 960
        }
      }
  "62":
    continueonerror: true
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      employee_id:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      retry-count:
        simple: "3"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Gurucul-GRA
      description: Get details of the user
      id: abc7a9c3-069c-4e21-810a-ab6a653a1d7a
      iscommand: true
      name: Get User From UEBA
      script: Gurucul-GRA|||gra-fetch-users-details
      tags:
      - userueba
      type: regular
      version: -1
    taskid: abc7a9c3-069c-4e21-810a-ab6a653a1d7a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2980,
          "y": 780
        }
      }
  "63":
    continueonerror: true
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      employee_id:
        complex:
          accessor: crowdstrikeusername
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Gurucul-GRA
      description: Get details of the user
      id: 4273fe2c-ecca-494d-8928-d60f2908067c
      iscommand: true
      name: Get User From UEBA
      script: Gurucul-GRA|||gra-fetch-users-details
      tags:
      - userueba
      type: regular
      version: -1
    taskid: 4273fe2c-ecca-494d-8928-d60f2908067c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 780
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      emp:
        complex:
          accessor: crowdstrikeusername
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 05cafa4c-d4d4-416b-8635-4169cf01fc04
      iscommand: false
      name: TCS-Create User Indicator & Relate To Incident v1.0
      playbookId: a8f14eae-50f0-476d-84bb-1c0d7fb01027
      type: playbook
      version: -1
    taskid: 05cafa4c-d4d4-416b-8635-4169cf01fc04
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 960
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      emp:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e871a74c-e21a-4e7d-8395-38b14b73a9f2
      iscommand: false
      name: TCS-Create User Indicator & Relate To Incident v1.0
      playbookId: a8f14eae-50f0-476d-84bb-1c0d7fb01027
      type: playbook
      version: -1
    taskid: e871a74c-e21a-4e7d-8395-38b14b73a9f2
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 960
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      enrichiocs:
        complex:
          accessor: csiocvalue
          root: incident
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook is designed to enrich IoCs with Gen AI Intelligence
        using Recorded Future Services
      id: ee1449d9-f141-4fcb-88f4-5ede3282478f
      iscommand: false
      name: 'Sub-Playbook: Gen AI Threat Intel Enrichment'
      playbookId: 381d8605-be6e-4715-816e-8f6f2f3c9d2a
      type: playbook
      version: -1
    taskid: ee1449d9-f141-4fcb-88f4-5ede3282478f
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 4020,
          "y": 570
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "37_36_yes": 0.47,
      "44_40_#default#": 0.1,
      "59_60_yes": 0.53
    },
    "paper": {
      "dimensions": {
        "height": 3340,
        "width": 8720,
        "x": -3030,
        "y": -1505
      }
    }
  }
