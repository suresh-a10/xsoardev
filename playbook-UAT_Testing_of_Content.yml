contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 4fc581bd-5b16-4b7d-82e7-5f8860f63d64
inputs:
- description: Provide the name of list where all inputs are added
  key: ListName
  playbookInputQuery: null
  required: false
  value: {}
name: UAT Testing of Content
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eed8d20e-78df-4f85-80ff-18f5ed4c90b2
      iscommand: false
      name: ""
      version: -1
    taskid: eed8d20e-78df-4f85-80ff-18f5ed4c90b2
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 480,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      name:
        simple: ${lists.inputs.name}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: c46bd2cb-3e15-4d7e-8955-e43ea52b1b63
      iscommand: true
      name: setIncident
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: c46bd2cb-3e15-4d7e-8955-e43ea52b1b63
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: testkey
      value:
        simple: testvaluewithuppercasetransformer
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9f2030d2-e55d-4a14-8ddb-79ea5e26a4bc
      iscommand: false
      name: Set
      script: Set
      type: regular
      version: -1
    taskid: 9f2030d2-e55d-4a14-8ddb-79ea5e26a4bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: testingcommentstocontext
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      id: 793600d4-a0c6-4161-88b9-98a919713fd3
      iscommand: false
      name: Comments To Context
      script: commentsToContext
      type: regular
      version: -1
    taskid: 793600d4-a0c6-4161-88b9-98a919713fd3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
  "4":
    continueonerror: true
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        simple: input.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script will parse a CSV file and place the unique IPs, Domains
        and Hashes into the context.
      id: 7124e974-7ad8-4e33-81fb-dfc4574cef94
      iscommand: false
      name: ParseCSV
      script: ParseCSV
      type: regular
      version: -1
    taskid: 7124e974-7ad8-4e33-81fb-dfc4574cef94
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
  "5":
    continueonerror: true
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${incident}
      fileName:
        simple: export.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 8288ea6c-79aa-4aae-8474-fea2d3144712
      iscommand: false
      name: ExporttoCSV
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 8288ea6c-79aa-4aae-8474-fea2d3144712
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
  "6":
    continueonerror: true
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ${ParseCSV.ParsedCSV}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 61a708a5-c331-4bf8-857a-09bc158c5951
      iscommand: false
      name: DeleteContext
      script: DeleteContext
      type: regular
      version: -1
    taskid: 61a708a5-c331-4bf8-857a-09bc158c5951
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1255
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sleep for X seconds
      id: 0820e337-8674-4b00-81be-b952e3c19228
      iscommand: false
      name: Sleep
      script: Sleep
      type: regular
      version: -1
    taskid: 0820e337-8674-4b00-81be-b952e3c19228
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1420
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        simple: ${lists.input.hash}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve results for a file hash using WildFire.
      id: 29ccc464-1c56-4da4-8233-45310b2a4e66
      iscommand: true
      name: file
      script: '|||file'
      type: regular
      version: -1
    taskid: 29ccc464-1c56-4da4-8233-45310b2a4e66
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1595
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        simple: ${lists.input.url}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Submits a URL to scan.
      id: 925b1357-d2e1-4ef4-8d10-d7c7ebc169d3
      iscommand: true
      name: url
      script: '|||url'
      type: regular
      version: -1
    taskid: 925b1357-d2e1-4ef4-8d10-d7c7ebc169d3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1770
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "12"
      "yes":
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 681a8ef3-4bb9-46e5-861a-55eba63e6995
      iscommand: false
      name: Exists
      script: Exists
      type: condition
      version: -1
    taskid: 681a8ef3-4bb9-46e5-861a-55eba63e6995
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1945
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${ParseCSV}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: f30b2c38-b473-4b02-8ba2-04c86dde1cae
      iscommand: true
      name: extractIndicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: f30b2c38-b473-4b02-8ba2-04c86dde1cae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4354ebf5-fd0c-4b96-8743-804056d992cb
      iscommand: false
      name: Untitled Task
      type: regular
      version: -1
    taskid: 4354ebf5-fd0c-4b96-8743-804056d992cb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2120
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      roles:
        simple: administrator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Assign analyst to incident.
        By default,  the analyst is picked randomly from the available users, according to the provided roles (if no roles provided, will fetch all users).
        Otherwise, the analyst will be picked according to the 'assignBy' arguments.
        machine-learning: DBot will calculated and decide who is the best analyst for the job.
        top-user: The user that is most commonly owns this type of incident
        less-busy-user: The less busy analyst will be picked to be the incident owner.
        online: The analyst is picked randomly from all online analysts, according to the provided roles (if no roles provided, will fetch all users).
        current: The user that executed the command
      id: 5be45bd5-fe64-4c89-8950-32c47fbd9405
      iscommand: false
      name: Assign Analyst to Incident
      script: AssignAnalystToIncident
      type: regular
      version: -1
    taskid: 5be45bd5-fe64-4c89-8950-32c47fbd9405
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${lists.input.array}
      contextKey:
        simple: arraytest
      separator:
        simple: ','
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: c9aadb8a-f3f1-49c7-892a-53f79cd8c29a
      iscommand: false
      name: create Array
      script: CreateArray
      type: regular
      version: -1
    taskid: c9aadb8a-f3f1-49c7-892a-53f79cd8c29a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "17"
      "yes":
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the investigation found any malicious indicators (file,
        URL, IP address, domain, or email). Returns "yes" if at least one malicious
        indicator is found.
      id: b41d77fb-4e17-44ea-8bb0-0ba8659f588b
      iscommand: false
      name: Is Malicious Indicator Found
      script: IsMaliciousIndicatorFound
      type: condition
      version: -1
    taskid: b41d77fb-4e17-44ea-8bb0-0ba8659f588b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: empty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 33177349-251d-4f15-8b4a-5f361c66aa9c
      iscommand: false
      name: Set and handle empty - empty
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 33177349-251d-4f15-8b4a-5f361c66aa9c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: empty
      value:
        simple: abc
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 309991b8-6ddc-40fa-870d-0e2e34daf871
      iscommand: false
      name: Set and handle empty - non empty
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 309991b8-6ddc-40fa-870d-0e2e34daf871
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2820
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: This value has to goto Context
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: 924ad298-1a7d-49d6-86b6-4b88fa800087
      iscommand: false
      name: Print
      script: Print
      type: regular
      version: -1
    taskid: 924ad298-1a7d-49d6-86b6-4b88fa800087
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Identify whether the incident includes an email message attached
        as an eml or msg file and return the answer to playbook. Also saves the identified
        entry ID to context for use for later. Commonly used in automated playbooks
        that handle phishing reports sent to a special phishing mailbox set up by
        the security team.
      id: c4735f2b-a838-4caa-88ef-e7fcdc05d589
      iscommand: false
      name: Identify Attached email
      script: IdentifyAttachedEmail
      type: condition
      version: -1
    taskid: c4735f2b-a838-4caa-88ef-e7fcdc05d589
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2995
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      id: cc6e9bb9-7444-40e1-8028-8b2981a2294a
      iscommand: false
      name: Is Error
      script: isError
      type: condition
      version: -1
    taskid: cc6e9bb9-7444-40e1-8028-8b2981a2294a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Finds similar incidents by common incident keys, labels, custom fields or context keys.
        It's highly recommended to use incident keys if possible (e.g., "type" for the same incident type).
        For best performance, it's recommended to avoid using context keys if possible (for example, if the value also appears in a label key, use label).

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 6d0dfa54-9fed-4272-8ee7-866a049ebc87
      iscommand: false
      name: FindSimilarIncidents
      script: FindSimilarIncidents
      type: regular
      version: -1
    taskid: 6d0dfa54-9fed-4272-8ee7-866a049ebc87
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3345
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      page:
        simple: "1"
      query:
        simple: -category:job
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Searches Demisto incidents.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 109e2730-3ab1-4efd-84cd-265721154830
      iscommand: false
      name: SearchIncidents
      script: SearchIncidentsV2
      type: regular
      version: -1
    taskid: 109e2730-3ab1-4efd-84cd-265721154830
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3520
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      command:
        simple: '!Print value="Testing schedule command"'
      cron:
        simple: '* * * * *'
      times:
        simple: "20"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Schedule a command to run inside the war room at a future time
        (once or reoccurring)
      id: f115c433-d64d-4c8e-8b7c-77aacaa14508
      iscommand: false
      name: schedulecommand
      script: ScheduleCommand
      type: regular
      version: -1
    taskid: f115c433-d64d-4c8e-8b7c-77aacaa14508
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 3670
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Show all scheduled entries for specific incident.
      id: c0dcf831-18f3-459d-85b6-09e92f75dd03
      iscommand: false
      name: Show Scheduled entries
      script: ShowScheduledEntries
      type: regular
      version: -1
    taskid: c0dcf831-18f3-459d-85b6-09e92f75dd03
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 3830
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      taskID:
        simple: ${ScheduledEntries.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This stops the scheduled task whose ID is given in the taskID argument.
      id: 0b00d7dc-c587-4cfe-8b88-3c546d9046a1
      iscommand: false
      name: Stop scheduled command
      script: StopScheduledTask
      type: regular
      version: -1
    taskid: 0b00d7dc-c587-4cfe-8b88-3c546d9046a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 3980
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "20_21_no": 0.48
    },
    "paper": {
      "dimensions": {
        "height": 4025,
        "width": 1025,
        "x": 50,
        "y": 50
      }
    }
  }
