contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 4fc581bd-5b16-4b7d-82e7-5f8860f63d64
inputs:
- description: Provide the name of list where all inputs are added
  key: ListName
  playbookInputQuery: null
  required: false
  value: {}
name: UAT Testing of Content
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e7174951-8b21-42d3-8be3-9d7d85e0268f
      iscommand: false
      name: ""
      version: -1
    taskid: e7174951-8b21-42d3-8be3-9d7d85e0268f
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 480,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      name:
        simple: ${lists.inputs.name}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 7fb18624-5e65-4020-888f-de555784e90c
      iscommand: true
      name: setIncident
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 7fb18624-5e65-4020-888f-de555784e90c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: testkey
      value:
        simple: testvaluewithuppercasetransformer
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d2e2e64c-6c6e-470d-85e9-b0046496b43b
      iscommand: false
      name: Set
      script: Set
      type: regular
      version: -1
    taskid: d2e2e64c-6c6e-470d-85e9-b0046496b43b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: testingcommentstocontext
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      id: 9cd09628-6b26-4696-89a8-1678d5d4a378
      iscommand: false
      name: Comments To Context
      script: commentsToContext
      type: regular
      version: -1
    taskid: 9cd09628-6b26-4696-89a8-1678d5d4a378
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
  "4":
    continueonerror: true
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        simple: input.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script will parse a CSV file and place the unique IPs, Domains
        and Hashes into the context.
      id: d386a0ee-8851-4e84-84ff-c313443cac2f
      iscommand: false
      name: ParseCSV
      script: ParseCSV
      type: regular
      version: -1
    taskid: d386a0ee-8851-4e84-84ff-c313443cac2f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
  "5":
    continueonerror: true
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${incident}
      fileName:
        simple: export.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 1d8236cb-5096-4a65-8040-4a62b7694d29
      iscommand: false
      name: ExporttoCSV
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 1d8236cb-5096-4a65-8040-4a62b7694d29
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
  "6":
    continueonerror: true
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ${ParseCSV.ParsedCSV}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 29201f9d-8c88-47f6-8da5-f8637c90fc32
      iscommand: false
      name: DeleteContext
      script: DeleteContext
      type: regular
      version: -1
    taskid: 29201f9d-8c88-47f6-8da5-f8637c90fc32
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1255
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sleep for X seconds
      id: 1aaf25e9-1256-448a-85e0-dcbdc91f39d7
      iscommand: false
      name: Sleep
      script: Sleep
      type: regular
      version: -1
    taskid: 1aaf25e9-1256-448a-85e0-dcbdc91f39d7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1420
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        simple: ${lists.input.hash}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve results for a file hash using WildFire.
      id: e338685f-70b1-4517-87ee-d4776a38331f
      iscommand: true
      name: file
      script: '|||file'
      type: regular
      version: -1
    taskid: e338685f-70b1-4517-87ee-d4776a38331f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1595
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        simple: ${lists.input.url}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Submits a URL to scan.
      id: ee1dc6cf-92ee-4ad4-83fd-46fce4d75e58
      iscommand: true
      name: url
      script: '|||url'
      type: regular
      version: -1
    taskid: ee1dc6cf-92ee-4ad4-83fd-46fce4d75e58
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1770
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "12"
      "yes":
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 32bb3b23-b8d2-4c76-878d-35e5fd692816
      iscommand: false
      name: Exists
      script: Exists
      type: condition
      version: -1
    taskid: 32bb3b23-b8d2-4c76-878d-35e5fd692816
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1945
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${ParseCSV}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 69981db3-0e93-453c-8878-f8f15ce65858
      iscommand: true
      name: extractIndicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 69981db3-0e93-453c-8878-f8f15ce65858
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bb335b7e-97d0-45d4-844f-0cf51bdf6194
      iscommand: false
      name: Untitled Task
      type: regular
      version: -1
    taskid: bb335b7e-97d0-45d4-844f-0cf51bdf6194
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2120
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      roles:
        simple: administrator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Assign analyst to incident.
        By default,  the analyst is picked randomly from the available users, according to the provided roles (if no roles provided, will fetch all users).
        Otherwise, the analyst will be picked according to the 'assignBy' arguments.
        machine-learning: DBot will calculated and decide who is the best analyst for the job.
        top-user: The user that is most commonly owns this type of incident
        less-busy-user: The less busy analyst will be picked to be the incident owner.
        online: The analyst is picked randomly from all online analysts, according to the provided roles (if no roles provided, will fetch all users).
        current: The user that executed the command
      id: d71bf633-9150-4245-8346-c6aa6436147c
      iscommand: false
      name: Assign Analyst to Incident
      script: AssignAnalystToIncident
      type: regular
      version: -1
    taskid: d71bf633-9150-4245-8346-c6aa6436147c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${lists.input.array}
      contextKey:
        simple: arraytest
      separator:
        simple: ','
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: ca9f65cf-1cc8-4e67-88ae-7b411abb06ba
      iscommand: false
      name: create Array
      script: CreateArray
      type: regular
      version: -1
    taskid: ca9f65cf-1cc8-4e67-88ae-7b411abb06ba
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "17"
      "yes":
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the investigation found any malicious indicators (file,
        URL, IP address, domain, or email). Returns "yes" if at least one malicious
        indicator is found.
      id: 2f483de3-9f54-4311-800a-68ef9bcea37b
      iscommand: false
      name: Is Malicious Indicator Found
      script: IsMaliciousIndicatorFound
      type: condition
      version: -1
    taskid: 2f483de3-9f54-4311-800a-68ef9bcea37b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: empty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 2c4649f8-82a0-4412-8c20-55d92fbe237c
      iscommand: false
      name: Set and handle empty - empty
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 2c4649f8-82a0-4412-8c20-55d92fbe237c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: empty
      value:
        simple: abc
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: dcbd8b99-6522-4b9c-80ec-07b7187ad21a
      iscommand: false
      name: Set and handle empty - non empty
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: dcbd8b99-6522-4b9c-80ec-07b7187ad21a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2820
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: This value has to goto Context
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: 9d180dd1-5364-4bbd-8f22-7bf63266667a
      iscommand: false
      name: Print
      script: Print
      type: regular
      version: -1
    taskid: 9d180dd1-5364-4bbd-8f22-7bf63266667a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Identify whether the incident includes an email message attached
        as an eml or msg file and return the answer to playbook. Also saves the identified
        entry ID to context for use for later. Commonly used in automated playbooks
        that handle phishing reports sent to a special phishing mailbox set up by
        the security team.
      id: 94eea69e-bb62-4001-871a-bf4f255bbabb
      iscommand: false
      name: Identify Attached email
      script: IdentifyAttachedEmail
      type: condition
      version: -1
    taskid: 94eea69e-bb62-4001-871a-bf4f255bbabb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2995
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      id: 8a89c5c4-7f27-49ce-84ec-e0ed146d2d71
      iscommand: false
      name: Is Error
      script: isError
      type: condition
      version: -1
    taskid: 8a89c5c4-7f27-49ce-84ec-e0ed146d2d71
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Finds similar incidents by common incident keys, labels, custom fields or context keys.
        It's highly recommended to use incident keys if possible (e.g., "type" for the same incident type).
        For best performance, it's recommended to avoid using context keys if possible (for example, if the value also appears in a label key, use label).

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 515c4e26-a4e8-42d8-8eb6-b4b1c33cc6cd
      iscommand: false
      name: FindSimilarIncidents
      script: FindSimilarIncidents
      type: regular
      version: -1
    taskid: 515c4e26-a4e8-42d8-8eb6-b4b1c33cc6cd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3345
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      page:
        simple: "1"
      query:
        simple: -category:job
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Searches Demisto incidents.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: fe1bbae8-3ba6-4336-8592-557a43846897
      iscommand: false
      name: SearchIncidents
      script: SearchIncidentsV2
      type: regular
      version: -1
    taskid: fe1bbae8-3ba6-4336-8592-557a43846897
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3520
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      command:
        simple: '!Print value="Testing schedule command"'
      cron:
        simple: '* * * * *'
      times:
        simple: "20"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Schedule a command to run inside the war room at a future time
        (once or reoccurring)
      id: 2e690ff8-69d4-4f55-8e43-1a0b5fd84fc0
      iscommand: false
      name: schedulecommand
      script: ScheduleCommand
      type: regular
      version: -1
    taskid: 2e690ff8-69d4-4f55-8e43-1a0b5fd84fc0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 3670
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Show all scheduled entries for specific incident.
      id: 84bfb301-325a-4748-8cf0-b23fac41d404
      iscommand: false
      name: Show Scheduled entries
      script: ShowScheduledEntries
      type: regular
      version: -1
    taskid: 84bfb301-325a-4748-8cf0-b23fac41d404
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 3830
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      taskID:
        simple: ${ScheduledEntries.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This stops the scheduled task whose ID is given in the taskID argument.
      id: e29be4a5-5070-4cb9-871b-0ad079eefb0e
      iscommand: false
      name: Stop scheduled command
      script: StopScheduledTask
      type: regular
      version: -1
    taskid: e29be4a5-5070-4cb9-871b-0ad079eefb0e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 3980
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "20_21_no": 0.48
    },
    "paper": {
      "dimensions": {
        "height": 4025,
        "width": 1025,
        "x": 50,
        "y": 50
      }
    }
  }
