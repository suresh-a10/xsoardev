contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
hidden: true
id: 809190a0-6b98-4592-88b8-35ef9275ef93
inputs: []
name: TCS-OnDemand FireEye Sandbox v1.0_WIP
outputs: []
sourceplaybookid: 59c34b62-e11e-4b22-8844-c1d11e5d7a0a
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ebc96cf2-30bb-4ee4-8d67-79d8d38ffc36
      iscommand: false
      name: ""
      version: -1
    taskid: ebc96cf2-30bb-4ee4-8d67-79d8d38ffc36
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 50,
          "y": -650
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: inList
              right:
                value:
                  simple: zip,7z
          root: File
      nonsensitive_password:
        simple: ${incident.unzippassword}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Unzip a file using fileName or entryID to specify a file. Unzipped
        files will be loaded to the War Room and names will be put into the context.
      id: e7752f17-5f55-4289-8c92-0f6ba767e6a1
      iscommand: false
      name: Unzip File
      script: UnzipFile
      type: regular
      version: -1
    taskid: e7752f17-5f55-4289-8c92-0f6ba767e6a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -580,
          "y": 565
        }
      }
  "2":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: artifacts
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Upload File For Sandbox Analysis
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: attachments
      sender: Your SOC team
      title: Upload File For Sandboxing
      totalanswers: 0
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c4d9035e-c1f2-4b91-8568-92e00b5c80e2
      iscommand: false
      name: Upload File For Sandboxing (the password protected file in standard format)
      type: collection
      version: -1
    taskid: c4d9035e-c1f2-4b91-8568-92e00b5c80e2
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 420,
          "y": -100
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Type
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                  - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Info
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                  - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Extension
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                root: File
          operator: isExists
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: File.Extension
          operator: notEndWith
          right:
            value:
              simple: eml
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Asserts the file type is supported
      id: 1741904b-aa7d-4c03-8e0e-4c3dd86d7633
      iscommand: false
      name: Is the file type supported in FireEye?
      type: condition
      version: -1
    taskid: 1741904b-aa7d-4c03-8e0e-4c3dd86d7633
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 645
        }
      }
  "4":
    continueonerrortype: ""
    form:
      description: Enter the required inputs for Sandboxing on FireEye
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Select analysis mode - live or sandbox '
        options: []
        optionsarg:
        - {}
        - simple: 1—Live
        - simple: 2—Sandbox
        placeholder: ""
        readonly: false
        required: true
        tooltip: 'Specify live or sandbox analysis mode. 1—Live: analyze suspected
          URLs live within the Malware Analysis Multi-Vector Virtual Execution (MVX)
          analysis engine. 2—Sandbox: analyze suspected URLs in a closed, protected
          environment.'
        type: singleSelect
      - defaultrows: []
        fieldassociated: fireeyeapplication
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Select the application to be used for the analysis.
        options: []
        optionsarg:
        - simple: 0— Allows the Malware Analysis appliance to choose the application
            for you
        placeholder: ""
        readonly: false
        required: true
        tooltip: Specifies the application to be used for the analysis.
        type: singleSelect
      - defaultrows: []
        fieldassociated: fireeyeprofiles
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Select Malware Analysis Profile to use for analysis
        options: []
        optionsarg:
        - {}
        - simple: 30 — centos-7.2
        - simple: 43 — winxp-sp3m
        - simple: 66 — win7x64-sp1m
        - simple: 68 — win10x64m
        - simple: 65 — win7-sp1m
        - simple: 90 — osx-10.8.2
        - simple: 93 — osx-10.11.3
        placeholder: ""
        readonly: false
        required: true
        tooltip: Selects the Malware Analysis profile to use for analysis
        type: singleSelect
      sender: ""
      title: Enter details for Sandboxing
      totalanswers: 0
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6fdc32f5-6814-43da-80e6-bd2d25eab19c
      iscommand: false
      name: Enter details for File Sandboxing
      type: collection
      version: -1
    taskid: 6fdc32f5-6814-43da-80e6-bd2d25eab19c
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 50,
          "y": 825
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: true
    quietmode: 0
    scriptarguments:
      value:
        simple: The File Type is not supported by Fire Eye
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Prints text to war room (Markdown supported)
      id: a7a0f2a2-2de7-462b-8855-e571a807e707
      iscommand: false
      name: Notify -File Type Not Supported
      script: Print
      type: regular
      version: -1
    taskid: a7a0f2a2-2de7-462b-8855-e571a807e707
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -590,
          "y": 1755
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File.EntryID
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 28e7eec7-aa82-4bf9-86eb-ef019ff577e3
      iscommand: false
      name: Is File Uploaded?
      type: condition
      version: -1
    taskid: 28e7eec7-aa82-4bf9-86eb-ef019ff577e3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": -480
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        complex:
          accessor: "0"
          root: Enter details for Sandboxing.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      application:
        complex:
          accessor: fireeyeapplication
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      force:
        simple: "false"
      prefetch:
        simple: "1"
      priority:
        simple: "0"
      profiles:
        simple: ${incident.fireeyeprofiles}
      timeout:
        simple: "10000"
      urls:
        simple: ${Enter the URL to Sandbox.Answers.0}
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: Submit a url for analysis by FireEye
      id: 3452ae14-b81c-45e8-86c2-c20cec67665b
      iscommand: true
      name: Automated Task - Uploading the URL on Fire Eye for analysis
      script: fireeye|||fe-submit-url
      type: regular
      version: -1
    taskid: 3452ae14-b81c-45e8-86c2-c20cec67665b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1120,
          "y": 680
        }
      }
  "9":
    continueonerrortype: ""
    form:
      description: Enter Password to unzip File
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: unzippassword
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter Password to unzip File
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: Enter Password to unzip File
        type: shortText
      sender: ""
      title: Enter Password to unzip File
      totalanswers: 0
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6450a74f-46e9-4e46-8041-c5d1056f8714
      iscommand: false
      name: Enter the Password
      type: collection
      version: -1
    taskid: 6450a74f-46e9-4e46-8041-c5d1056f8714
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -580,
          "y": 420
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Enter details for Sandboxing.Answers
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: —
                    fields:
                      value:
                        simple: "1"
                  operator: Cut
          operator: isEqualString
          right:
            value:
              simple: "1"
      label: Live
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Enter details for Sandboxing.Answers
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: —
                    fields:
                      value:
                        simple: "1"
                  operator: Cut
          operator: isEqualString
          right:
            value:
              simple: "2"
      label: Sandbox
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Live:
      - "14"
      Sandbox:
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eedb8cbe-85d2-4e98-8c2f-5dde5423a991
      iscommand: false
      name: Check mode of Sandbox.
      type: condition
      version: -1
    taskid: eedb8cbe-85d2-4e98-8c2f-5dde5423a991
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 360
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Select the type of analysis
      cc: null
      format: ""
      methods: []
      replyOptions:
      - File Analysis
      - URL Analysis
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      File Analysis:
      - "2"
      URL Analysis:
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f805e82f-9d4e-49b8-898e-e0510b579bf4
      iscommand: false
      name: Select the type of analysis
      type: condition
      version: -1
    taskid: f805e82f-9d4e-49b8-898e-e0510b579bf4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 620,
          "y": -290
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        complex:
          accessor: "0"
          root: Enter details for Sandboxing.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      application:
        complex:
          accessor: fireeyeapplication
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      force:
        simple: "false"
      prefetch:
        simple: "0"
      priority:
        simple: "0"
      profiles:
        simple: ${incident.fireeyeprofiles}
      timeout:
        simple: "10000"
      urls:
        simple: ${Enter the URL to Sandbox.Answers.0}
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: Submit a url for analysis by FireEye
      id: 35dca8ac-5d2d-4c75-87ab-c56263298dc3
      iscommand: true
      name: Automated Task - Uploading the URL on Fire Eye for analysis
      script: fireeye|||fe-submit-url
      type: regular
      version: -1
    taskid: 35dca8ac-5d2d-4c75-87ab-c56263298dc3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 620,
          "y": 660
        }
      }
  "15":
    continueonerrortype: ""
    form:
      description: Enter the required inputs for Sandboxing on FireEye
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Select analysis mode - live or sandbox '
        options: []
        optionsarg:
        - {}
        - simple: 1—Live
        - simple: 2—Sandbox
        placeholder: ""
        readonly: false
        required: true
        tooltip: 'Specify live or sandbox analysis mode. 1—Live: analyze suspected
          URLs live within the Malware Analysis Multi-Vector Virtual Execution (MVX)
          analysis engine. 2—Sandbox: analyze suspected URLs in a closed, protected
          environment.'
        type: singleSelect
      - defaultrows: []
        fieldassociated: fireeyeapplication
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Select the application to be used for the analysis.
        options: []
        optionsarg:
        - simple: 0— Allows the Malware Analysis appliance to choose the application
            for you
        placeholder: ""
        readonly: false
        required: true
        tooltip: Specifies the application to be used for the analysis.
        type: singleSelect
      - defaultrows: []
        fieldassociated: fireeyeprofiles
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Select Malware Analysis Profile to use for analysis
        options: []
        optionsarg:
        - {}
        - simple: 30 — centos-7.2
        - simple: 43 — winxp-sp3m
        - simple: 66 — win7x64-sp1m
        - simple: 68 — win10x64m
        - simple: 65 — win7-sp1m
        - simple: 90 — osx-10.8.2
        - simple: 93 — osx-10.11.3
        placeholder: ""
        readonly: false
        required: true
        tooltip: Selects the Malware Analysis profile to use for analysis
        type: singleSelect
      sender: ""
      title: Enter details for Sandboxing
      totalanswers: 0
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cde676cd-142c-47fb-859b-10e785498b33
      iscommand: false
      name: Enter details for URL Sandboxing
      type: collection
      version: -1
    taskid: cde676cd-142c-47fb-859b-10e785498b33
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 900,
          "y": 150
        }
      }
  "16":
    continueonerrortype: ""
    form:
      description: Enter the URL to Sandbox
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter the URL to Sandbox. If there are more than one url, add them
            as a parameter using a comma to separate them. For example, "www.demisto.com,www.google.com"
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: Enter the URL to Sandbox
        type: shortText
      sender: ""
      title: Enter the URL to Sandbox
      totalanswers: 0
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aad23ce7-4f7c-407f-8665-9cd68d6f9687
      iscommand: false
      name: Enter the URL to Sandbox
      type: collection
      version: -1
    taskid: aad23ce7-4f7c-407f-8665-9cd68d6f9687
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 900,
          "y": -40
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea423b03-f558-4ea1-8b0b-726985b37561
      iscommand: false
      name: Polling
      type: title
      version: -1
    taskid: ea423b03-f558-4ea1-8b0b-726985b37561
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 880,
          "y": 920
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        complex:
          accessor: "0"
          root: Enter details for Sandboxing.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      application:
        complex:
          accessor: fireeyeapplication
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      force:
        simple: "false"
      prefetch:
        simple: ${prefetch}
      priority:
        simple: "0"
      profiles:
        simple: ${incident.fireeyeprofiles}
      timeout:
        simple: "10000"
      uploadFile:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: inList
              right:
                iscontext: true
                value:
                  simple: ExtractedFiles
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: commands.server.feSubmit.description
      id: 652bfc3e-fcc8-4a2e-8f8a-6a04fb90f5dd
      iscommand: true
      name: Automated Task - Uploading the Extracted Files on Fire Eye for analysis
      script: fireeye|||fe-submit
      type: regular
      version: -1
    taskid: 652bfc3e-fcc8-4a2e-8f8a-6a04fb90f5dd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1580
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      Ids:
        complex:
          accessor: Key
          root: FireEyeAX.Submissions.URL
      Interval:
        simple: "7"
      PollingCommandArgName:
        simple: submission_Key
      PollingCommandName:
        simple: fe-submit-url-status
      Timeout:
        simple: "360"
      dt:
        simple: FireEyeAX.Submissions.URL(val.Status != 'Submission Done').Key
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      id: d17258db-fd0f-4846-81f4-fb243e904fdc
      iscommand: false
      name: GenericPolling
      playbookId: GenericPolling
      type: playbook
      version: -1
    taskid: d17258db-fd0f-4846-81f4-fb243e904fdc
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1080
        }
      }
  "20":
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Sand Box Result Files
      tags:
        simple: results
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: true
    quietmode: 0
    scriptarguments:
      submissionID:
        simple: ${subplaybook-19.FireEyeAX.Submissions.URL.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      id: f7fc182b-9a47-4216-802b-7062a0575075
      iscommand: false
      name: AX-result
      script: ca07fab8-8b93-431f-8946-ad2b007a145e
      type: regular
      version: -1
    taskid: f7fc182b-9a47-4216-802b-7062a0575075
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1380
        }
      }
  "21":
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Sand Box Result Files
      tags:
        simple: results
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: true
    quietmode: 0
    scriptarguments:
      submissionKey:
        simple: ${FireEyeAX.Submissions.Key}
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      id: 92b94080-a02c-4e84-8663-2ccfb75484b0
      iscommand: false
      name: AX-result
      script: d0b78a46-7bb0-4776-8cbf-cbbda56f892e
      type: regular
      version: -1
    taskid: 92b94080-a02c-4e84-8663-2ccfb75484b0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -50,
          "y": 1895
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      Ids:
        complex:
          accessor: Submissions.Key
          root: FireEyeAX
      Interval:
        simple: "7"
      PollingCommandArgName:
        simple: submission_Key
      PollingCommandName:
        simple: fe-submit-status
      Timeout:
        simple: "360"
      dt:
        simple: FireEyeAX.Submissions(val.Status != 'Done').Key
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      id: 015627a6-e9e3-45c3-85d6-6ba1fb3b32be
      iscommand: false
      name: GenericPolling
      playbookId: GenericPolling
      type: playbook
      version: -1
    taskid: 015627a6-e9e3-45c3-85d6-6ba1fb3b32be
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -50,
          "y": 1755
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 92170287-6373-4100-8cc7-1b2581d41e48
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
    taskid: 92170287-6373-4100-8cc7-1b2581d41e48
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2210
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 3552a63c-0628-4618-8d9c-e1812bf1769f
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 3552a63c-0628-4618-8d9c-e1812bf1769f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2330
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4abf353a-beab-4412-8bce-21114ad47bca
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 4abf353a-beab-4412-8bce-21114ad47bca
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2480
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File.Extension
          operator: isEqualString
          right:
            value:
              simple: zip
        - left:
            iscontext: true
            value:
              simple: File.Extension
          operator: isEqualString
          right:
            value:
              simple: 7z
      label: "yes"
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2cf6acbd-0a31-48e3-8b4f-74f643d8d4c6
      iscommand: false
      name: Check If File is a ZIP File
      type: condition
      version: -1
    taskid: 2cf6acbd-0a31-48e3-8b4f-74f643d8d4c6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 70
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: "Malicious: ${FireEyeAXReport.alerts.alert.-malicious} \nSeverity:
          ${FireEyeAXReport.alerts.alert.-severity}"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: c59ef55e-0744-4d39-8a54-b8f3256a37ab
      iscommand: false
      name: Display Malicious and Severity Status
      script: Print
      type: regular
      version: -1
    taskid: c59ef55e-0744-4d39-8a54-b8f3256a37ab
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -50,
          "y": 2030
        }
      }
  "28":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedFiles
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 43225c27-398e-4e0b-8002-4e514e9d1fe2
      iscommand: false
      name: Checking if there are any extracted files
      type: condition
      version: -1
    taskid: 43225c27-398e-4e0b-8002-4e514e9d1fe2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -60,
          "y": 1400
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        complex:
          accessor: "0"
          root: Enter details for Sandboxing.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      application:
        complex:
          accessor: fireeyeapplication
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      force:
        simple: "false"
      prefetch:
        simple: ${prefetch}
      priority:
        simple: "0"
      profiles:
        simple: ${incident.fireeyeprofiles}
      timeout:
        simple: "10000"
      uploadFile:
        complex:
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: commands.server.feSubmit.description
      id: 28bdaa5f-ae4c-4aeb-8165-2cf510bd79b4
      iscommand: true
      name: Automated Task - Uploading the File on Fire Eye for analysis
      script: fireeye|||fe-submit
      type: regular
      version: -1
    taskid: 28bdaa5f-ae4c-4aeb-8165-2cf510bd79b4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 160,
          "y": 1570
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: "Malicious: ${FireEyeAXReport.alerts.alert.-malicious} \nSeverity:
          ${FireEyeAXReport.alerts.alert.-severity}"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: cafcca4c-20cd-4f8d-8256-e378a8cd998c
      iscommand: false
      name: Display Malicious and Severity Status
      script: Print
      type: regular
      version: -1
    taskid: cafcca4c-20cd-4f8d-8256-e378a8cd998c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1580
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: How would you like to proceed?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Submit Zip File as it is
      - Unzip the file first and then submit
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Submit Zip File:
      - "3"
      Unzip the file:
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 55c82e61-6299-4c1d-86b6-fc53c07695e2
      iscommand: false
      name: How would you like to proceed?
      type: condition
      version: -1
    taskid: 55c82e61-6299-4c1d-86b6-fc53c07695e2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -270,
          "y": 245
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Enter details for Sandboxing.Answers
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: —
                    fields:
                      value:
                        simple: "1"
                  operator: Cut
          operator: isEqualString
          right:
            value:
              simple: "1"
      label: Live
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Enter details for Sandboxing.Answers
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: —
                    fields:
                      value:
                        simple: "1"
                  operator: Cut
          operator: isEqualString
          right:
            value:
              simple: "2"
      label: Sandbox
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Live:
      - "33"
      Sandbox:
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8d7ff406-b513-47d2-8f4c-ddb4fd698f97
      iscommand: false
      name: Check mode of Sandbox.
      type: condition
      version: -1
    taskid: 8d7ff406-b513-47d2-8f4c-ddb4fd698f97
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 985
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: prefetch
      value:
        simple: "0"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: cde5b6b2-cf9c-417f-81aa-951c07c44523
      iscommand: false
      name: Set Prefetch 0
      script: Set
      type: regular
      version: -1
    taskid: cde5b6b2-cf9c-417f-81aa-951c07c44523
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 1175
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: prefetch
      value:
        simple: "1"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 61dbc652-779d-4ea8-8ea0-305dd626c064
      iscommand: false
      name: Set Prefetch 1
      script: Set
      type: regular
      version: -1
    taskid: 61dbc652-779d-4ea8-8ea0-305dd626c064
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1165
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "10_14_Live": 0.56,
      "10_8_Sandbox": 0.44,
      "13_2_File Analysis": 0.57,
      "28_18_yes": 0.55,
      "31_3_Submit Zip File": 0.23,
      "3_4_yes": 0.57,
      "6_26_yes": 0.41
    },
    "paper": {
      "dimensions": {
        "height": 3195,
        "width": 2090,
        "x": -590,
        "y": -650
      }
    }
  }
