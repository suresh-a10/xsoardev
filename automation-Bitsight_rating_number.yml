args:
- name: to
- name: from
commonfields:
  id: 6ec79fa4-6c4f-485e-8bdf-03417456cfcd
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.9.7.24076
enabled: true
engineinfo: {}
mainengineinfo: {}
name: Bitsight_rating_number
pswd: ""
runas: DBotWeakRole
runonce: false
script: |2-

  from datetime import date,timedelta
  #p=str(date.today()-timedelta(days=2))
  #k=str(date.today()-timedelta(days=4))
  #k_formatted=datetime.strptime(k, '%Y-%m-%d').strftime('%d %b %Y')
  #timeline= {'2022-04-14': {'name': '2022-04-14', 'data': [810]}, '2022-04-13': {'name': '2022-04-13', 'data': [810]}, '2022-04-12': {'name': '2022-04-12', 'data': [810]}, '2022-04-11': {'name': '2022-04-11', 'data': [810]}, '2022-04-10': {'name': '2022-04-10', 'data': [810]}, '2022-04-09': {'name': '2022-04-09', 'data': [810]}, '2022-04-08': {'name': '2022-04-08', 'data': [810]}, '2022-04-07': {'name': '2022-04-07', 'data': [810]}, '2022-04-06': {'name': '2022-04-06', 'data': [810]}, '2022-04-05': {'name': '2022-04-05', 'data': [810]}, '2022-04-04': {'name': '2022-04-04', 'data': [810]}, '2022-04-03': {'name': '2022-04-03', 'data': [810]}, '2022-04-02': {'name': '2022-04-02', 'data': [810]}, '2022-04-01': {'name': '2022-04-01', 'data': [810]}, '2022-03-31': {'name': '2022-03-31', 'data': [810]}, '2022-03-30': {'name': '2022-03-30', 'data': [810]}, '2022-03-29': {'name': '2022-03-29', 'data': [810]}, '2022-03-28': {'name': '2022-03-28', 'data': [810]}, '2022-03-27': {'name': '2022-03-27', 'data': [750]}, '2022-03-26': {'name': '2022-03-26', 'data': [750]}, '2022-03-25': {'name': '2022-03-25', 'data': [750]}, '2022-03-24': {'name': '2022-03-24', 'data': [810]}, '2022-03-23': {'name': '2022-03-23', 'data': [810]}, '2022-03-22': {'name': '2022-03-22', 'data': [810]}, '2022-03-21': {'name': '2022-03-21', 'data': [810]}, '2022-03-20': {'name': '2022-03-20', 'data': [810]}, '2022-03-19': {'name': '2022-03-19', 'data': [810]}, '2022-03-18': {'name': '2022-03-18', 'data': [810]}, '2022-03-17': {'name': '2022-03-17', 'data': [810]}, '2022-03-16': {'name': '2022-03-16', 'data': [810]}, '2022-03-15': {'name': '2022-03-15', 'data': [810]}, '2022-03-14': {'name': '2022-03-14', 'data': [810]}, '2022-03-13': {'name': '2022-03-13', 'data': [810]}, '2022-03-12': {'name': '2022-03-12', 'data': [810]}, '2022-03-11': {'name': '2022-03-11', 'data': [810]}, '2022-03-10': {'name': '2022-03-10', 'data': [810]}, '2022-03-09': {'name': '2022-03-09', 'data': [810]}, '2022-03-08': {'name': '2022-03-08', 'data': [810]}, '2022-03-07': {'name': '2022-03-07', 'data': [810]}, '2022-03-06': {'name': '2022-03-06', 'data': [810]}, '2022-03-05': {'name': '2022-03-05', 'data': [810]}, '2022-03-04': {'name': '2022-03-04', 'data': [810]}, '2022-03-03': {'name': '2022-03-03', 'data': [810]}, '2022-03-02': {'name': '2022-03-02', 'data': [810]}, '2022-03-01': {'name': '2022-03-01', 'data': [810]}, '2022-02-28': {'name': '2022-02-28', 'data': [810]}, '2022-02-27': {'name': '2022-02-27', 'data': [810]}, '2022-02-26': {'name': '2022-02-26', 'data': [810]}, '2022-02-25': {'name': '2022-02-25', 'data': [810]}, '2022-02-24': {'name': '2022-02-24', 'data': [810]}, '2022-02-23': {'name': '2022-02-23', 'data': [810]}, '2022-02-22': {'name': '2022-02-22', 'data': [810]}, '2022-02-21': {'name': '2022-02-21', 'data': [810]}, '2022-02-20': {'name': '2022-02-20', 'data': [810]}, '2022-02-19': {'name': '2022-02-19', 'data': [810]}, '2022-02-18': {'name': '2022-02-18', 'data': [810]}, '2022-02-17': {'name': '2022-02-17', 'data': [810]}, '2022-02-16': {'name': '2022-02-16', 'data': [810]}, '2022-02-15': {'name': '2022-02-15', 'data': [810]}, '2022-02-14': {'name': '2022-02-14', 'data': [810]}, '2022-02-13': {'name': '2022-02-13', 'data': [810]}, '2022-02-12': {'name': '2022-02-12', 'data': [810]}, '2022-02-11': {'name': '2022-02-11', 'data': [810]}, '2022-02-10': {'name': '2022-02-10', 'data': [810]}, '2022-02-09': {'name': '2022-02-09', 'data': [810]}, '2022-02-08': {'name': '2022-02-08', 'data': [810]}, '2022-02-07': {'name': '2022-02-07', 'data': [810]}, '2022-02-06': {'name': '2022-02-06', 'data': [810]}, '2022-02-05': {'name': '2022-02-05', 'data': [810]}, '2022-02-04': {'name': '2022-02-04', 'data': [810]}, '2022-02-03': {'name': '2022-02-03', 'data': [810]}, '2022-02-02': {'name': '2022-02-02', 'data': [810]}, '2022-02-01': {'name': '2022-02-01', 'data': [810]}, '2022-01-31': {'name': '2022-01-31', 'data': [810]}, '2022-01-30': {'name': '2022-01-30', 'data': [810]}, '2022-01-29': {'name': '2022-01-29', 'data': [810]}, '2022-01-28': {'name': '2022-01-28', 'data': [810]}, '2022-01-27': {'name': '2022-01-27', 'data': [810]}, '2022-01-26': {'name': '2022-01-26', 'data': [810]}, '2022-01-25': {'name': '2022-01-25', 'data': [810]}, '2022-01-24': {'name': '2022-01-24', 'data': [810]}, '2022-01-23': {'name': '2022-01-23', 'data': [810]}, '2022-01-22': {'name': '2022-01-22', 'data': [810]}, '2022-01-21': {'name': '2022-01-21', 'data': [810]}, '2022-01-20': {'name': '2022-01-20', 'data': [810]}, '2022-01-19': {'name': '2022-01-19', 'data': [810]}, '2022-01-18': {'name': '2022-01-18', 'data': [810]}, '2022-01-17': {'name': '2022-01-17', 'data': [810]}, '2022-01-16': {'name': '2022-01-16', 'data': [810]}, '2022-01-15': {'name': '2022-01-15', 'data': [810]}, '2022-01-14': {'name': '2022-01-14', 'data': [810]}, '2022-01-13': {'name': '2022-01-13', 'data': [810]}, '2022-01-12': {'name': '2022-01-12', 'data': [810]}, '2022-01-11': {'name': '2022-01-11', 'data': [810]}, '2022-01-10': {'name': '2022-01-10', 'data': [810]}, '2022-01-09': {'name': '2022-01-09', 'data': [810]}, '2022-01-08': {'name': '2022-01-08', 'data': [810]}, '2022-01-07': {'name': '2022-01-07', 'data': [810]}, '2022-01-06': {'name': '2022-01-06', 'data': [810]}, '2022-01-05': {'name': '2022-01-05', 'data': [810]}, '2022-01-04': {'name': '2022-01-04', 'data': [810]}, '2022-01-03': {'name': '2022-01-03', 'data': [810]}, '2022-01-02': {'name': '2022-01-02', 'data': [810]}, '2022-01-01': {'name': '2022-01-01', 'data': [810]}, '2021-12-31': {'name': '2021-12-31', 'data': [810]}, '2021-12-30': {'name': '2021-12-30', 'data': [810]}, '2021-12-29': {'name': '2021-12-29', 'data': [810]}, '2021-12-28': {'name': '2021-12-28', 'data': [810]}, '2021-12-27': {'name': '2021-12-27', 'data': [810]}, '2021-12-26': {'name': '2021-12-26', 'data': [810]}, '2021-12-25': {'name': '2021-12-25', 'data': [810]}, '2021-12-24': {'name': '2021-12-24', 'data': [810]}, '2021-12-23': {'name': '2021-12-23', 'data': [810]}, '2021-12-22': {'name': '2021-12-22', 'data': [810]}, '2021-12-21': {'name': '2021-12-21', 'data': [810]}, '2021-12-20': {'name': '2021-12-20', 'data': [810]}, '2021-12-19': {'name': '2021-12-19', 'data': [810]}, '2021-12-18': {'name': '2021-12-18', 'data': [810]}, '2021-12-17': {'name': '2021-12-17', 'data': [810]}, '2021-12-16': {'name': '2021-12-16', 'data': [810]}, '2021-12-15': {'name': '2021-12-15', 'data': [810]}, '2021-12-14': {'name': '2021-12-14', 'data': [810]}, '2021-12-13': {'name': '2021-12-13', 'data': [810]}, '2021-12-12': {'name': '2021-12-12', 'data': [810]}, '2021-12-11': {'name': '2021-12-11', 'data': [810]}, '2021-12-10': {'name': '2021-12-10', 'data': [810]}, '2021-12-09': {'name': '2021-12-09', 'data': [810]}, '2021-12-08': {'name': '2021-12-08', 'data': [810]}, '2021-12-07': {'name': '2021-12-07', 'data': [810]}, '2021-12-06': {'name': '2021-12-06', 'data': [810]}, '2021-12-05': {'name': '2021-12-05', 'data': [810]}, '2021-12-04': {'name': '2021-12-04', 'data': [810]}, '2021-12-03': {'name': '2021-12-03', 'data': [810]}, '2021-12-02': {'name': '2021-12-02', 'data': [810]}, '2021-12-01': {'name': '2021-12-01', 'data': [810]}, '2021-11-30': {'name': '2021-11-30', 'data': [810]}, '2021-11-29': {'name': '2021-11-29', 'data': [810]}, '2021-11-28': {'name': '2021-11-28', 'data': [810]}, '2021-11-27': {'name': '2021-11-27', 'data': [810]}, '2021-11-26': {'name': '2021-11-26', 'data': [810]}, '2021-11-25': {'name': '2021-11-25', 'data': [810]}, '2021-11-24': {'name': '2021-11-24', 'data': [810]}, '2021-11-23': {'name': '2021-11-23', 'data': [810]}, '2021-11-22': {'name': '2021-11-22', 'data': [810]}, '2021-11-21': {'name': '2021-11-21', 'data': [810]}, '2021-11-20': {'name': '2021-11-20', 'data': [810]}, '2021-11-19': {'name': '2021-11-19', 'data': [810]}, '2021-11-18': {'name': '2021-11-18', 'data': [810]}, '2021-11-17': {'name': '2021-11-17', 'data': [810]}, '2021-11-16': {'name': '2021-11-16', 'data': [810]}, '2021-11-15': {'name': '2021-11-15', 'data': [810]}, '2021-11-14': {'name': '2021-11-14', 'data': [810]}, '2021-11-13': {'name': '2021-11-13', 'data': [810]}, '2021-11-12': {'name': '2021-11-12', 'data': [810]}, '2021-11-11': {'name': '2021-11-11', 'data': [810]}, '2021-11-10': {'name': '2021-11-10', 'data': [810]}, '2021-11-09': {'name': '2021-11-09', 'data': [810]}, '2021-11-08': {'name': '2021-11-08', 'data': [810]}, '2021-11-07': {'name': '2021-11-07', 'data': [810]}, '2021-11-06': {'name': '2021-11-06', 'data': [810]}, '2021-11-05': {'name': '2021-11-05', 'data': [810]}, '2021-11-04': {'name': '2021-11-04', 'data': [810]}, '2021-11-03': {'name': '2021-11-03', 'data': [810]}, '2021-11-02': {'name': '2021-11-02', 'data': [810]}, '2021-11-01': {'name': '2021-11-01', 'data': [810]}, '2021-10-31': {'name': '2021-10-31', 'data': [810]}, '2021-10-30': {'name': '2021-10-30', 'data': [810]}, '2021-10-29': {'name': '2021-10-29', 'data': [810]}, '2021-10-28': {'name': '2021-10-28', 'data': [810]}, '2021-10-27': {'name': '2021-10-27', 'data': [810]}, '2021-10-26': {'name': '2021-10-26', 'data': [810]}, '2021-10-25': {'name': '2021-10-25', 'data': [810]}, '2021-10-24': {'name': '2021-10-24', 'data': [810]}, '2021-10-23': {'name': '2021-10-23', 'data': [810]}, '2021-10-22': {'name': '2021-10-22', 'data': [810]}, '2021-10-21': {'name': '2021-10-21', 'data': [810]}, '2021-10-20': {'name': '2021-10-20', 'data': [810]}, '2021-10-19': {'name': '2021-10-19', 'data': [810]}, '2021-10-18': {'name': '2021-10-18', 'data': [810]}, '2021-10-17': {'name': '2021-10-17', 'data': [800]}, '2021-10-16': {'name': '2021-10-16', 'data': [800]}, '2021-10-15': {'name': '2021-10-15', 'data': [800]}, '2021-10-14': {'name': '2021-10-14', 'data': [800]}, '2021-10-13': {'name': '2021-10-13', 'data': [800]}, '2021-10-12': {'name': '2021-10-12', 'data': [800]}, '2021-10-11': {'name': '2021-10-11', 'data': [800]}, '2021-10-10': {'name': '2021-10-10', 'data': [800]}, '2021-10-09': {'name': '2021-10-09', 'data': [800]}, '2021-10-08': {'name': '2021-10-08', 'data': [800]}, '2021-10-07': {'name': '2021-10-07', 'data': [800]}, '2021-10-06': {'name': '2021-10-06', 'data': [800]}, '2021-10-05': {'name': '2021-10-05', 'data': [800]}, '2021-10-04': {'name': '2021-10-04', 'data': [800]}, '2021-10-03': {'name': '2021-10-03', 'data': [800]}, '2021-10-02': {'name': '2021-10-02', 'data': [800]}, '2021-10-01': {'name': '2021-10-01', 'data': [800]}, '2021-09-30': {'name': '2021-09-30', 'data': [800]}, '2021-09-29': {'name': '2021-09-29', 'data': [800]}, '2021-09-28': {'name': '2021-09-28', 'data': [800]}, '2021-09-27': {'name': '2021-09-27', 'data': [800]}, '2021-09-26': {'name': '2021-09-26', 'data': [800]}, '2021-09-25': {'name': '2021-09-25', 'data': [800]}, '2021-09-24': {'name': '2021-09-24', 'data': [800]}, '2021-09-23': {'name': '2021-09-23', 'data': [800]}, '2021-09-22': {'name': '2021-09-22', 'data': [800]}, '2021-09-21': {'name': '2021-09-21', 'data': [800]}, '2021-09-20': {'name': '2021-09-20', 'data': [800]}, '2021-09-19': {'name': '2021-09-19', 'data': [800]}, '2021-09-18': {'name': '2021-09-18', 'data': [800]}, '2021-09-17': {'name': '2021-09-17', 'data': [800]}, '2021-09-16': {'name': '2021-09-16', 'data': [800]}, '2021-09-15': {'name': '2021-09-15', 'data': [800]}, '2021-09-14': {'name': '2021-09-14', 'data': [800]}, '2021-09-13': {'name': '2021-09-13', 'data': [800]}, '2021-09-12': {'name': '2021-09-12', 'data': [800]}, '2021-09-11': {'name': '2021-09-11', 'data': [800]}, '2021-09-10': {'name': '2021-09-10', 'data': [800]}, '2021-09-09': {'name': '2021-09-09', 'data': [800]}, '2021-09-08': {'name': '2021-09-08', 'data': [800]}, '2021-09-07': {'name': '2021-09-07', 'data': [800]}, '2021-09-06': {'name': '2021-09-06', 'data': [800]}, '2021-09-05': {'name': '2021-09-05', 'data': [800]}, '2021-09-04': {'name': '2021-09-04', 'data': [800]}, '2021-09-03': {'name': '2021-09-03', 'data': [800]}, '2021-09-02': {'name': '2021-09-02', 'data': [800]}, '2021-09-01': {'name': '2021-09-01', 'data': [800]}, '2021-08-31': {'name': '2021-08-31', 'data': [800]}, '2021-08-30': {'name': '2021-08-30', 'data': [800]}, '2021-08-29': {'name': '2021-08-29', 'data': [800]}, '2021-08-28': {'name': '2021-08-28', 'data': [800]}, '2021-08-27': {'name': '2021-08-27', 'data': [800]}, '2021-08-26': {'name': '2021-08-26', 'data': [800]}, '2021-08-25': {'name': '2021-08-25', 'data': [800]}, '2021-08-24': {'name': '2021-08-24', 'data': [800]}, '2021-08-23': {'name': '2021-08-23', 'data': [800]}, '2021-08-22': {'name': '2021-08-22', 'data': [800]}, '2021-08-21': {'name': '2021-08-21', 'data': [800]}, '2021-08-20': {'name': '2021-08-20', 'data': [800]}, '2021-08-19': {'name': '2021-08-19', 'data': [800]}, '2021-08-18': {'name': '2021-08-18', 'data': [800]}, '2021-08-17': {'name': '2021-08-17', 'data': [800]}, '2021-08-16': {'name': '2021-08-16', 'data': [800]}, '2021-08-15': {'name': '2021-08-15', 'data': [800]}, '2021-08-14': {'name': '2021-08-14', 'data': [800]}, '2021-08-13': {'name': '2021-08-13', 'data': [800]}, '2021-08-12': {'name': '2021-08-12', 'data': [800]}, '2021-08-11': {'name': '2021-08-11', 'data': [800]}, '2021-08-10': {'name': '2021-08-10', 'data': [800]}, '2021-08-09': {'name': '2021-08-09', 'data': [800]}, '2021-08-08': {'name': '2021-08-08', 'data': [800]}, '2021-08-07': {'name': '2021-08-07', 'data': [800]}, '2021-08-06': {'name': '2021-08-06', 'data': [810]}, '2021-08-05': {'name': '2021-08-05', 'data': [810]}, '2021-08-04': {'name': '2021-08-04', 'data': [810]}, '2021-08-03': {'name': '2021-08-03', 'data': [810]}, '2021-08-02': {'name': '2021-08-02', 'data': [810]}, '2021-08-01': {'name': '2021-08-01', 'data': [810]}, '2021-07-31': {'name': '2021-07-31', 'data': [800]}, '2021-07-30': {'name': '2021-07-30', 'data': [800]}, '2021-07-29': {'name': '2021-07-29', 'data': [800]}, '2021-07-28': {'name': '2021-07-28', 'data': [800]}, '2021-07-27': {'name': '2021-07-27', 'data': [800]}, '2021-07-26': {'name': '2021-07-26', 'data': [800]}, '2021-07-25': {'name': '2021-07-25', 'data': [800]}, '2021-07-24': {'name': '2021-07-24', 'data': [800]}, '2021-07-23': {'name': '2021-07-23', 'data': [800]}, '2021-07-22': {'name': '2021-07-22', 'data': [800]}, '2021-07-21': {'name': '2021-07-21', 'data': [800]}, '2021-07-20': {'name': '2021-07-20', 'data': [800]}, '2021-07-19': {'name': '2021-07-19', 'data': [800]}, '2021-07-18': {'name': '2021-07-18', 'data': [800]}, '2021-07-17': {'name': '2021-07-17', 'data': [800]}, '2021-07-16': {'name': '2021-07-16', 'data': [800]}, '2021-07-15': {'name': '2021-07-15', 'data': [800]}, '2021-07-14': {'name': '2021-07-14', 'data': [800]}, '2021-07-13': {'name': '2021-07-13', 'data': [800]}, '2021-07-12': {'name': '2021-07-12', 'data': [800]}, '2021-07-11': {'name': '2021-07-11', 'data': [800]}, '2021-07-10': {'name': '2021-07-10', 'data': [800]}, '2021-07-09': {'name': '2021-07-09', 'data': [800]}, '2021-07-08': {'name': '2021-07-08', 'data': [800]}, '2021-07-07': {'name': '2021-07-07', 'data': [800]}, '2021-07-06': {'name': '2021-07-06', 'data': [800]}, '2021-07-05': {'name': '2021-07-05', 'data': [800]}, '2021-07-04': {'name': '2021-07-04', 'data': [800]}, '2021-07-03': {'name': '2021-07-03', 'data': [800]}, '2021-07-02': {'name': '2021-07-02', 'data': [800]}, '2021-07-01': {'name': '2021-07-01', 'data': [800]}, '2021-06-30': {'name': '2021-06-30', 'data': [800]}, '2021-06-29': {'name': '2021-06-29', 'data': [800]}, '2021-06-28': {'name': '2021-06-28', 'data': [800]}, '2021-06-27': {'name': '2021-06-27', 'data': [800]}, '2021-06-26': {'name': '2021-06-26', 'data': [800]}, '2021-06-25': {'name': '2021-06-25', 'data': [800]}, '2021-06-24': {'name': '2021-06-24', 'data': [800]}, '2021-06-23': {'name': '2021-06-23', 'data': [800]}, '2021-06-22': {'name': '2021-06-22', 'data': [800]}, '2021-06-21': {'name': '2021-06-21', 'data': [800]}, '2021-06-20': {'name': '2021-06-20', 'data': [800]}, '2021-06-19': {'name': '2021-06-19', 'data': [800]}, '2021-06-18': {'name': '2021-06-18', 'data': [800]}, '2021-06-17': {'name': '2021-06-17', 'data': [800]}, '2021-06-16': {'name': '2021-06-16', 'data': [800]}, '2021-06-15': {'name': '2021-06-15', 'data': [800]}, '2021-06-14': {'name': '2021-06-14', 'data': [800]}, '2021-06-13': {'name': '2021-06-13', 'data': [800]}, '2021-06-12': {'name': '2021-06-12', 'data': [800]}, '2021-06-11': {'name': '2021-06-11', 'data': [800]}, '2021-06-10': {'name': '2021-06-10', 'data': [800]}, '2021-06-09': {'name': '2021-06-09', 'data': [800]}, '2021-06-08': {'name': '2021-06-08', 'data': [800]}, '2021-06-07': {'name': '2021-06-07', 'data': [800]}, '2021-06-06': {'name': '2021-06-06', 'data': [800]}, '2021-06-05': {'name': '2021-06-05', 'data': [800]}, '2021-06-04': {'name': '2021-06-04', 'data': [800]}, '2021-06-03': {'name': '2021-06-03', 'data': [800]}, '2021-06-02': {'name': '2021-06-02', 'data': [800]}, '2021-06-01': {'name': '2021-06-01', 'data': [800]}, '2021-05-31': {'name': '2021-05-31', 'data': [800]}, '2021-05-30': {'name': '2021-05-30', 'data': [800]}, '2021-05-29': {'name': '2021-05-29', 'data': [800]}, '2021-05-28': {'name': '2021-05-28', 'data': [800]}, '2021-05-27': {'name': '2021-05-27', 'data': [800]}, '2021-05-26': {'name': '2021-05-26', 'data': [800]}, '2021-05-25': {'name': '2021-05-25', 'data': [800]}, '2021-05-24': {'name': '2021-05-24', 'data': [800]}, '2021-05-23': {'name': '2021-05-23', 'data': [800]}, '2021-05-22': {'name': '2021-05-22', 'data': [800]}, '2021-05-21': {'name': '2021-05-21', 'data': [800]}, '2021-05-20': {'name': '2021-05-20', 'data': [800]}, '2021-05-19': {'name': '2021-05-19', 'data': [800]}, '2021-05-18': {'name': '2021-05-18', 'data': [800]}, '2021-05-17': {'name': '2021-05-17', 'data': [800]}, '2021-05-16': {'name': '2021-05-16', 'data': [800]}, '2021-05-15': {'name': '2021-05-15', 'data': [800]}, '2021-05-14': {'name': '2021-05-14', 'data': [800]}, '2021-05-13': {'name': '2021-05-13', 'data': [800]}, '2021-05-12': {'name': '2021-05-12', 'data': [800]}, '2021-05-11': {'name': '2021-05-11', 'data': [800]}, '2021-05-10': {'name': '2021-05-10', 'data': [800]}, '2021-05-09': {'name': '2021-05-09', 'data': [800]}, '2021-05-08': {'name': '2021-05-08', 'data': [800]}, '2021-05-07': {'name': '2021-05-07', 'data': [800]}, '2021-05-06': {'name': '2021-05-06', 'data': [800]}, '2021-05-05': {'name': '2021-05-05', 'data': [800]}, '2021-05-04': {'name': '2021-05-04', 'data': [800]}, '2021-05-03': {'name': '2021-05-03', 'data': [800]}, '2021-05-02': {'name': '2021-05-02', 'data': [800]}, '2021-05-01': {'name': '2021-05-01', 'data': [800]}, '2021-04-30': {'name': '2021-04-30', 'data': [800]}, '2021-04-29': {'name': '2021-04-29', 'data': [800]}, '2021-04-28': {'name': '2021-04-28', 'data': [800]}, '2021-04-27': {'name': '2021-04-27', 'data': [800]}, '2021-04-26': {'name': '2021-04-26', 'data': [800]}, '2021-04-25': {'name': '2021-04-25', 'data': [800]}, '2021-04-24': {'name': '2021-04-24', 'data': [800]}, '2021-04-23': {'name': '2021-04-23', 'data': [800]}, '2021-04-22': {'name': '2021-04-22', 'data': [800]}, '2021-04-21': {'name': '2021-04-21', 'data': [800]}, '2021-04-20': {'name': '2021-04-20', 'data': [800]}, '2021-04-19': {'name': '2021-04-19', 'data': [800]}, '2021-04-18': {'name': '2021-04-18', 'data': [800]}, '2021-04-17': {'name': '2021-04-17', 'data': [800]}, '2021-04-16': {'name': '2021-04-16', 'data': [800]}, '2021-04-15': {'name': '2021-04-15', 'data': [800]}, '2021-04-14': {'name': '2021-04-14', 'data': [800]}, '2021-04-13': {'name': '2021-04-13', 'data': [800]}, '2021-04-12': {'name': '2021-04-12', 'data': [800]}, '2021-04-11': {'name': '2021-04-11', 'data': [800]}, '2021-04-10': {'name': '2021-04-10', 'data': [800]}, '2021-04-09': {'name': '2021-04-09', 'data': [800]}, '2021-04-08': {'name': '2021-04-08', 'data': [800]}, '2021-04-07': {'name': '2021-04-07', 'data': [800]}, '2021-04-06': {'name': '2021-04-06', 'data': [800]}, '2021-04-05': {'name': '2021-04-05', 'data': [800]}, '2021-04-04': {'name': '2021-04-04', 'data': [800]}, '2021-04-03': {'name': '2021-04-03', 'data': [800]}, '2021-04-02': {'name': '2021-04-02', 'data': [800]}, '2021-04-01': {'name': '2021-04-01', 'data': [800]}}



  to_arg = demisto.args().get('to')
  from_arg = demisto.args().get('from')
  # to_arg=2022-04-14
  # from_arg=2022-04-11
  timeline = json.loads(demisto.executeCommand('getList', {'listName':'BitSight_Score'})[0]['Contents'])

  widget=[]
  ress=0
  count=0
  for k,v in timeline.items():
      k_formatted=datetime.strptime(k, '%Y-%m-%d').strftime('%d %b %Y')
      # Checking if 'To' is not set in the widget
      if to_arg == '0001-01-01T00:00:00Z':
          if k >= from_arg[0:10]:
              count+=1
              ress+=timeline[k].get('data')[0]
      else:

          if k > from_arg[0:10] and k <= to_arg[0:10]:
              count+=1
              ress+=timeline[k].get('data')[0]

  # prev=int(ress/count)

  # da=str(date.today()-timedelta(days=2))
  # curr=timeline[da].get('data')[0]
  if count!=0:
      prev=int(ress/count)
      da=str(date.today()-timedelta(days=2))
      curr=timeline[da].get('data')[0]
  else:
      curr=None
      prev=None

  widget.append(timeline[k].get('data'))

  # demisto.results(timeline[k].get('data'))
  demisto.results({"currSum": curr, "prevSum": prev})
  #demisto.results({"currSum": 810, "prevSum": 800})
scripttarget: 0
subtype: python3
tags:
- widget
type: python
