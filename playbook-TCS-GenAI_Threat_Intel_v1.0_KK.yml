contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: This playbook is designed to enrich IoCs with Gen AI Intelligence using
  Recorded Future Services
id: 381d8605-be6e-4715-816e-8f6f2f3c9d2a
inputs:
- description: ""
  key: enrichiocs
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-GenAI Threat Intel v1.0_KK
outputs: []
quiet: true
sourceplaybookid: 7e0105f5-2558-456a-85df-77c9558ebba6
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a9fa99da-da49-45ed-8b33-b9fb4e6015aa
      iscommand: false
      name: ""
      version: -1
    taskid: a9fa99da-da49-45ed-8b33-b9fb4e6015aa
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 670,
          "y": -550
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.enrichiocs
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 35ae10b4-327b-42c7-8a11-1f630cb93ce0
      iscommand: false
      name: Are There IoC(s) For Enrichment?
      type: condition
      version: -1
    taskid: 35ae10b4-327b-42c7-8a11-1f630cb93ce0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 670,
          "y": -390
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
      - "52"
      - "53"
      - "54"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: EnrichIOC
      value:
        complex:
          root: inputs.enrichiocs
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8326ebb2-61f3-49b8-8ab9-9a63143f3742
      iscommand: false
      name: Set IoC(s) In Contest
      script: Set
      type: regular
      version: -1
    taskid: 8326ebb2-61f3-49b8-8ab9-9a63143f3742
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 410
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Enrich.URL
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: EnrichIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.URL
          root: EnrichIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9fd2b239-1230-400e-84fc-8bf574544be1
      iscommand: false
      name: Set URL in 'Enrich.URL' Context
      script: Set
      type: regular
      version: -1
    taskid: 9fd2b239-1230-400e-84fc-8bf574544be1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 870
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Enrich.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: EnrichIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain_Test_
            - left:
                iscontext: true
                value:
                  simple: EnrichIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
          root: EnrichIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b59c4359-0317-41f1-855d-2eaa25dfce42
      iscommand: false
      name: Set Domain in 'Enrich.Domain' Context
      script: Set
      type: regular
      version: -1
    taskid: b59c4359-0317-41f1-855d-2eaa25dfce42
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 870
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Enrich.IPV4
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: EnrichIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
          root: EnrichIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 366fbba2-eaad-4acd-8958-9ea71d21c04f
      iscommand: false
      name: Set IPv4 IP Address in 'Enrich.IPV4' Context
      script: Set
      type: regular
      version: -1
    taskid: 366fbba2-eaad-4acd-8958-9ea71d21c04f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 870
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "73"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Enrich.File
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: EnrichIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.File
          root: EnrichIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c7344fd2-1b5b-4824-8eb1-5cd1f5bad77a
      iscommand: false
      name: Set File in 'Enrich.File' Context
      script: Set
      type: regular
      version: -1
    taskid: c7344fd2-1b5b-4824-8eb1-5cd1f5bad77a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 870
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 92a3c01d-d033-42a2-885e-bed576cffdc2
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 92a3c01d-d033-42a2-885e-bed576cffdc2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 2160
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      text:
        simple: ${inputs.enrichiocs}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 332ee972-7c07-461b-8d97-c999fd4fcfe3
      iscommand: true
      name: Extract & Enrich Indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 332ee972-7c07-461b-8d97-c999fd4fcfe3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 210
        }
      }
  "51":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d94b6217-8a4d-4a8d-83ec-324aa8a6b273
      iscommand: false
      name: Is There an IPv4 IP Address in The Submitted Request ?
      type: condition
      version: -1
    taskid: d94b6217-8a4d-4a8d-83ec-324aa8a6b273
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 20,
          "y": 620
        }
      }
  "52":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 91cc4bbb-c83e-4799-8966-75fa23cd3833
      iscommand: false
      name: Is There a URL in The Submitted IoC Request ?
      type: condition
      version: -1
    taskid: 91cc4bbb-c83e-4799-8966-75fa23cd3833
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 620
        }
      }
  "53":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExtractedIndicators.Domain
                    operator: in
                    right:
                      iscontext: true
                      value:
                        simple: EnrichIOC
                root: ExtractedIndicators.Domain
          operator: isExists
          right:
            value: {}
        - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExtractedIndicators.Domain_Test_
                    operator: in
                    right:
                      iscontext: true
                      value:
                        simple: EnrichIOC
                root: ExtractedIndicators.Domain_Test_
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 43e5c05c-bc4f-4f63-8987-eda64c8911b5
      iscommand: false
      name: Is There a Domain in The Submitted IoC Request ?
      type: condition
      version: -1
    taskid: 43e5c05c-bc4f-4f63-8987-eda64c8911b5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 620
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExtractedIndicators.File
                    operator: in
                    right:
                      iscontext: true
                      value:
                        simple: EnrichIOC
                root: ExtractedIndicators.File
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ad6aa074-8a7d-411e-8553-e411a0295233
      iscommand: false
      name: Is There a Hash in The Submitted IoC Request ?
      type: condition
      version: -1
    taskid: ad6aa074-8a7d-411e-8553-e411a0295233
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 620
        }
      }
  "56":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      "yes":
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8d4dfedd-bfe5-4362-843c-ff9282f578a0
      iscommand: false
      name: Is 'ExtractedIndicators' Context Set ?
      type: condition
      version: -1
    taskid: 8d4dfedd-bfe5-4362-843c-ff9282f578a0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 670,
          "y": -180
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: b6a74b75-e3e3-4c81-854d-1d85e293f63c
      iscommand: false
      name: Detele 'ExtractedIndicators' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: b6a74b75-e3e3-4c81-854d-1d85e293f63c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 20
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 33425e2e-b488-46ad-8492-b5cb059c0f8c
      iscommand: false
      name: Get GenAI Intel using Recorded Future
      type: title
      version: -1
    taskid: 33425e2e-b488-46ad-8492-b5cb059c0f8c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 20,
          "y": 1090
        }
      }
  "62":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: containsString
                    right:
                      value:
                        simple: Recorded Future
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is an active instance of the Recorded Future API
        integration enabled.
      id: 91936551-81d5-4788-8e45-2dd97b07618c
      iscommand: false
      name: Is Recorded Future API enabled?
      type: condition
      version: -1
    taskid: 91936551-81d5-4788-8e45-2dd97b07618c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 20,
          "y": 1225
        }
      }
  "63":
    continueonerror: true
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "77"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        simple: ${Enrich.IPV4}
      entity_type:
        simple: ip
      using:
        simple: Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL, File or Malware.
      id: 820e8425-57f2-480a-840d-cf2bf29c8c76
      iscommand: true
      name: Get IP Intelligence From Recorded Future
      script: Recorded Future v2|||recordedfuture-intelligence
      type: regular
      version: -1
    taskid: 820e8425-57f2-480a-840d-cf2bf29c8c76
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 1460
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      genaiinsights:
        simple: ${RecordedFuture.IP.aiInsights.text}
      recordedfutureaiinsights:
        simple: ${RecordedFuture.IP.aiInsights.text}
      recordedfutureriskrule:
        simple: ${RecordedFuture.IP.concatRules}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fc144170-1832-4aa0-849e-ce7d7321d1ff
      iscommand: true
      name: Set Incident Field
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: fc144170-1832-4aa0-849e-ce7d7321d1ff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 1840
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 270b856c-188c-4802-83fb-d72018963dc2
      iscommand: false
      name: Get GenAI Intel using Recorded Future
      type: title
      version: -1
    taskid: 270b856c-188c-4802-83fb-d72018963dc2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1090
        }
      }
  "66":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: containsString
                    right:
                      value:
                        simple: Recorded Future
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is an active instance of the Recorded Future API
        integration enabled.
      id: 49edb31e-3879-4fc8-8544-f96ba21d198a
      iscommand: false
      name: Is Recorded Future API enabled?
      type: condition
      version: -1
    taskid: 49edb31e-3879-4fc8-8544-f96ba21d198a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1225
        }
      }
  "67":
    continueonerror: true
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        simple: ${Enrich.URL}
      entity_type:
        simple: url
      using:
        simple: Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL, File or Malware.
      id: fd1d1608-937b-429f-8243-383e2c2b4f45
      iscommand: true
      name: Get URL Intelligence From Recorded Future
      script: Recorded Future v2|||recordedfuture-intelligence
      type: regular
      version: -1
    taskid: fd1d1608-937b-429f-8243-383e2c2b4f45
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1460
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      genaiinsights:
        simple: ${RecordedFuture.URL.aiInsights.text}
      recordedfutureaiinsights:
        simple: ${RecordedFuture.URL.aiInsights.text}
      recordedfutureriskrule:
        simple: ${RecordedFuture.URL.concatRules}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 817f35f7-c202-41e8-83fd-3109c4092432
      iscommand: true
      name: Set Incident Field
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 817f35f7-c202-41e8-83fd-3109c4092432
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1840
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4def19b9-4140-405a-86cb-cbed6f0889b1
      iscommand: false
      name: Get GenAI Intel using Recorded Future
      type: title
      version: -1
    taskid: 4def19b9-4140-405a-86cb-cbed6f0889b1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1090
        }
      }
  "70":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: containsString
                    right:
                      value:
                        simple: Recorded Future
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "71"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is an active instance of the Recorded Future API
        integration enabled.
      id: 401d7990-5d4d-404f-87a0-050be7220b8c
      iscommand: false
      name: Is Recorded Future API enabled?
      type: condition
      version: -1
    taskid: 401d7990-5d4d-404f-87a0-050be7220b8c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1225
        }
      }
  "71":
    continueonerror: true
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        simple: ${Enrich.Domain}
      entity_type:
        simple: domain
      using:
        simple: Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL, File or Malware.
      id: f05b303b-5df2-411f-88a2-6ba97da96e9d
      iscommand: true
      name: Get Domain Intelligence From Recorded Future
      script: Recorded Future v2|||recordedfuture-intelligence
      type: regular
      version: -1
    taskid: f05b303b-5df2-411f-88a2-6ba97da96e9d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1460
        }
      }
  "72":
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      genaiinsights:
        simple: ${RecordedFuture.Domain.aiInsights.text}
      recordedfutureaiinsights:
        simple: ${RecordedFuture.Domain.aiInsights.text}
      recordedfutureriskrule:
        simple: ${RecordedFuture.Domain.concatRules}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 257d3354-9c70-4c01-8d53-7bf93edf2f93
      iscommand: true
      name: Set Incident Field
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 257d3354-9c70-4c01-8d53-7bf93edf2f93
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1840
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fff1ddfa-3730-42ef-8077-bbc7bb9ba834
      iscommand: false
      name: Get GenAI Intel using Recorded Future
      type: title
      version: -1
    taskid: fff1ddfa-3730-42ef-8077-bbc7bb9ba834
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 1090
        }
      }
  "74":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: containsString
                    right:
                      value:
                        simple: Recorded Future
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is an active instance of the Recorded Future API
        integration enabled.
      id: 4fef9294-7537-4a2d-8a73-11bd8e45323d
      iscommand: false
      name: Is Recorded Future API enabled?
      type: condition
      version: -1
    taskid: 4fef9294-7537-4a2d-8a73-11bd8e45323d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 1225
        }
      }
  "75":
    continueonerror: true
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "80"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        simple: ${Enrich.File}
      entity_type:
        simple: file
      using:
        simple: Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL, File or Malware.
      id: 0c1ba84a-1e8f-4c8b-8919-3ba176e7eda7
      iscommand: true
      name: Get File Intelligence From Recorded Future
      script: Recorded Future v2|||recordedfuture-intelligence
      type: regular
      version: -1
    taskid: 0c1ba84a-1e8f-4c8b-8919-3ba176e7eda7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 1460
        }
      }
  "76":
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      genaiinsights:
        simple: ${RecordedFuture.File.aiInsights.text}
      recordedfutureaiinsights:
        simple: ${RecordedFuture.File.aiInsights.text}
      recordedfutureriskrule:
        simple: ${RecordedFuture.File.concatRules}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 07fbf7b3-a416-4215-86df-72fcd5de771d
      iscommand: true
      name: Set Incident Field
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 07fbf7b3-a416-4215-86df-72fcd5de771d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 1840
        }
      }
  "77":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: text
                root: RecordedFuture.IP.aiInsights
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "81"
      "yes":
      - "64"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f601ef76-da1f-4afd-8c38-cde23f84ad4c
      iscommand: false
      name: Is there GenAI Intel For This Indicator?
      type: condition
      version: -1
    taskid: f601ef76-da1f-4afd-8c38-cde23f84ad4c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 20,
          "y": 1640
        }
      }
  "78":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: text
                root: RecordedFuture.URL.aiInsights
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "81"
      "yes":
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eef957a6-7510-4d0e-84f9-a6ae61f1a772
      iscommand: false
      name: Is there GenAI Intel For This Indicator?
      type: condition
      version: -1
    taskid: eef957a6-7510-4d0e-84f9-a6ae61f1a772
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1640
        }
      }
  "79":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: text
                root: RecordedFuture.Domain.aiInsights
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "81"
      "yes":
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f9d83d76-8eea-46c3-8c06-fb32f6b5032c
      iscommand: false
      name: Is there GenAI Intel For This Indicator?
      type: condition
      version: -1
    taskid: f9d83d76-8eea-46c3-8c06-fb32f6b5032c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1640
        }
      }
  "80":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: text
                root: RecordedFuture.File.aiInsights
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "81"
      "yes":
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 42a5302a-dcab-4fe7-84e5-1b21b48916e6
      iscommand: false
      name: Is there GenAI Intel For This Indicator?
      type: condition
      version: -1
    taskid: 42a5302a-dcab-4fe7-84e5-1b21b48916e6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 1640
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      genaiinsights:
        simple: Gen AI has no intel on this IoC. Human ️‍♀️ intel gathering is necessary.
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 640d6c27-4e02-4676-834a-a2b6e830ec65
      iscommand: true
      name: Set Msg 'Gen AI has no intel on this IoC. Human ️‍♀️ intel gathering is
        necessary.'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 640d6c27-4e02-4676-834a-a2b6e830ec65
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 1840
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "1_36_#default#": 0.1,
      "1_56_yes": 0.46,
      "51_36_#default#": 0.1,
      "51_9_yes": 0.5,
      "52_36_#default#": 0.1,
      "52_5_yes": 0.45,
      "53_36_#default#": 0.11,
      "53_7_yes": 0.47,
      "54_15_yes": 0.44,
      "54_36_#default#": 0.11,
      "56_57_yes": 0.42,
      "62_36_#default#": 0.1,
      "62_63_yes": 0.41,
      "66_36_#default#": 0.13,
      "66_67_yes": 0.43,
      "70_36_#default#": 0.14,
      "70_71_yes": 0.51,
      "74_36_#default#": 0.23,
      "74_75_yes": 0.61,
      "77_64_yes": 0.49,
      "77_81_#default#": 0.1,
      "78_68_yes": 0.45,
      "78_81_#default#": 0.1,
      "79_72_yes": 0.53,
      "79_81_#default#": 0.7,
      "80_76_yes": 0.47
    },
    "paper": {
      "dimensions": {
        "height": 2775,
        "width": 2520,
        "x": 20,
        "y": -550
      }
    }
  }
