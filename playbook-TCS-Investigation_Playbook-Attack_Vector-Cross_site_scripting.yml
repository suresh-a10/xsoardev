contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 6279f151-9f6e-46e4-8baf-2d3e1babac94
inputs: []
name: TCS-Investigation Playbook-Attack Vector-Cross site scripting
outputs: []
sourceplaybookid: 6746e62f-12b0-42bf-8292-bb8efdac16bc
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ca0d7302-43f7-4c45-8aeb-ad82185ded77
      iscommand: false
      name: ""
      version: -1
    taskid: ca0d7302-43f7-4c45-8aeb-ad82185ded77
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 680,
          "y": -910
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3edaad54-f64e-4f7f-8287-7cb9378810ad
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 3edaad54-f64e-4f7f-8287-7cb9378810ad
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 680,
          "y": 6035
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 85dc940d-ffb3-4ce3-82e7-72e33cf211a6
      iscommand: false
      name: 'Sub Playbook: Document & Close Section'
      playbookId: 4a46e3dc-82da-4b3a-86ca-eb2f9dfd589f
      type: playbook
      version: -1
    taskid: 85dc940d-ffb3-4ce3-82e7-72e33cf211a6
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 680,
          "y": 5870
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Is This a True Positive Alert ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No, Its a Confirmed - False Positive
      - No, Its a Benign-True Positive
      - Yes, it is True Positive
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      No, Its a Benign-True Positive:
      - "36"
      No, Its a Confirmed - False Positive:
      - "35"
      Yes, it is True Positive:
      - "94"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b9dea51e-349c-4b1c-869e-16aa2689035b
      iscommand: false
      name: Is This a True Positive Alert ?
      type: condition
      version: -1
    taskid: b9dea51e-349c-4b1c-869e-16aa2689035b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 2270
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "117"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b4ecc6e1-01d0-462c-8689-66920b8c37b2
      iscommand: false
      name: Document & Close - False Positive
      type: title
      version: -1
    taskid: b4ecc6e1-01d0-462c-8689-66920b8c37b2
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 880,
          "y": 2940
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 59604383-0b69-4de0-8e2f-911a475192ea
      iscommand: false
      name: Document & Close - Benign True Positive
      type: title
      version: -1
    taskid: 59604383-0b69-4de0-8e2f-911a475192ea
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": 2930
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 809a0914-a6f7-4d7d-8fc9-f9bf37287fef
      iscommand: false
      name: Document & Close Investigation
      type: title
      version: -1
    taskid: 809a0914-a6f7-4d7d-8fc9-f9bf37287fef
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 680,
          "y": 5735
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Check hits on web servers and other network traffic for  source IP
          and check the response code on webservers
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes, Proceed to next task
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Yes, Proceed to next task:
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fd4b7c32-1b39-4208-8517-d2deb2280100
      iscommand: false
      name: Check hits on web servers and other network traffic for  source IP and
        check the response code on webservers
      type: condition
      version: -1
    taskid: fd4b7c32-1b39-4208-8517-d2deb2280100
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 1860
        }
      }
  "53":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Check application logs and timeline logs for any execution.
        options: []
        optionsarg:
        - {}
        - simple: Done. Move to the next task.
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Check application logs and timeline logs for any execution.
      totalanswers: 0
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: {}
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Done
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 02588f00-d171-46bf-83c1-a843bbc948d2
      iscommand: false
      name: ' Check application logs and timeline logs for any execution.'
      type: collection
      version: -1
    taskid: 02588f00-d171-46bf-83c1-a843bbc948d2
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 2065
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "92"
    note: false
    quietmode: 0
    scriptarguments:
      attackvectors:
        simple: Cross-Site Scripting (XSS)
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 11aaaa01-8c9f-42f2-89f8-666b9687e70e
      iscommand: true
      name: Set Attack Vector Context Field To 'Cross site scripting'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 11aaaa01-8c9f-42f2-89f8-666b9687e70e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 680,
          "y": -735
        }
      }
  "90":
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "118"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5cffe26a-11a9-412e-8ce8-6f7f77c103ff
      iscommand: false
      name: Investigate - Not Sure To Be Determined
      type: title
      version: -1
    taskid: 5cffe26a-11a9-412e-8ce8-6f7f77c103ff
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1060,
          "y": -260
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Is This a True Positive Alert ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No, Its a Confirmed - False Positive
      - Not Sure - To Be Determined
      - No, Its a Benign-True Positive
      - Yes, it is True Positive
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      No, Its a Benign-True Positive:
      - "36"
      No, Its a Confirmed - False Positive:
      - "35"
      Not Sure - To Be Determined:
      - "90"
      Yes, it is True Positive:
      - "94"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a69428e9-16a8-4a11-864a-c323797add13
      iscommand: false
      name: Is This a True Positive Alert ?
      tags:
      - report
      type: condition
      version: -1
    taskid: a69428e9-16a8-4a11-864a-c323797add13
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 680,
          "y": -510
        }
      }
  "94":
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3ddbd3be-cfa9-481b-88c5-65ec2379c381
      iscommand: false
      name: Stop Detection SLA - True Positive
      type: title
      version: -1
    taskid: 3ddbd3be-cfa9-481b-88c5-65ec2379c381
    timertriggers:
    - action: stop
      fieldname: detectionsla
    - action: start
      fieldname: threatresponsesla
    type: title
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 2920
        }
      }
  "95":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtnumber
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Number
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: ""
      title: Enter The IMT Number
      totalanswers: 0
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d85ddc76-9ff8-4cd2-8770-c32e717e4ebb
      iscommand: false
      name: Enter The IMT Number
      type: collection
      version: -1
    taskid: d85ddc76-9ff8-4cd2-8770-c32e717e4ebb
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 940,
          "y": 5440
        }
      }
  "96":
    continueonerrortype: ""
    id: "96"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "95"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "Yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: a2093069-bff1-4202-82b7-eef036e3372b
      iscommand: true
      name: Update IMT Context To - Yes
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: a2093069-bff1-4202-82b7-eef036e3372b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 940,
          "y": 5280
        }
      }
  "97":
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: ff4b2488-6223-4978-8855-b8613ec96bea
      iscommand: true
      name: Update IMT Context To - No
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ff4b2488-6223-4978-8855-b8613ec96bea
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 5520
        }
      }
  "98":
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Review The Alert - Check If You Need To Raise an IMT ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No -  IMT Not Required
      - Yes - I Have Raised an IMT
      - I'm Not Sure - Will Do It later
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      I'm Not Sure - Will Do It later:
      - "42"
      No -  IMT Not Required:
      - "97"
      Yes - I Have Raised an IMT:
      - "96"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 05944b82-2e5a-42a0-80ad-eea9c7ae10ce
      iscommand: false
      name: Review The Alert - Check If You Need To Raise an IMT ?
      type: condition
      version: -1
    taskid: 05944b82-2e5a-42a0-80ad-eea9c7ae10ce
    timertriggers:
    - action: stop
      fieldname: threatresponsesla
    type: condition
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 5230
        }
      }
  "100":
    continueonerrortype: ""
    id: "100"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "128"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 900ddc0b-1583-4266-818c-6ecd3bf11c0d
      iscommand: false
      name: TCS-Select IOC To Block_CM Playbook v1_KK
      playbookId: 9dacaaf8-64e7-4758-822e-694b991ee19c
      type: playbook
      version: -1
    taskid: 900ddc0b-1583-4266-818c-6ecd3bf11c0d
    timertriggers:
    - action: start
      fieldname: mitigationsla
    type: playbook
    view: |-
      {
        "position": {
          "x": 950,
          "y": 4405
        }
      }
  "101":
    continueonerrortype: ""
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: "Any IoCs You'd Like To Block on Palo Alto FW \\ ZScaler \\ CrowdStrike
          ? \n(NOTE: for IP address blocking other than Palo Alto FW, pls connect
          with location FW owner)"
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - No - They Are Already Blocked
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      No - They Are Already Blocked:
      - "121"
      "Yes":
      - "100"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bc70a61c-188a-4cc6-83b4-b019f58ada90
      iscommand: false
      name: 'Any IoCs You''d Like To Block on Palo Alto FW \ ZScaler \ CrowdStrike
        ? (NOTE: for IP address blocking other than Palo Alto FW, pls connect with
        location FW owner)'
      tags:
      - report
      type: condition
      version: -1
    taskid: bc70a61c-188a-4cc6-83b4-b019f58ada90
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 4260
        }
      }
  "102":
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "101"
    note: false
    quietmode: 2
    scriptarguments:
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          ${incident.emailbody}

          Investigation Link --> https://soar.tcsapps.com/#/Custom/caseinfoid/${incident.id}
      cc:
        simple: ${UserByUsername.email}
      subject:
        simple: '*True Positive Notification* SIEM Investigation - Severity - ${incident.mailerseverity}'
      to:
        simple: nimisha.prajapati@tcs.com,yogesh.gholap@tcs.com,csocsenioroperator@tcscomprod.onmicrosoft.com,csocanalyst@tcscomprod.onmicrosoft.com
      using:
        simple: Mail Sender_instance_CSOC_Mail
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 7ff854ff-eb1d-4af0-881d-99137235a300
      iscommand: true
      name: Notify CSOC Manager & Necessary Stakeholders
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 7ff854ff-eb1d-4af0-881d-99137235a300
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 4090
        }
      }
  "103":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: emailbody
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter Notification Message To CSOC Manager (give a brief about the
            true positive alert and the impact)
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: ""
      title: Enter Notification Message To CSOC Manager
      totalanswers: 0
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "102"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: da6e5b30-bea7-4a16-897b-f7746b32725c
      iscommand: false
      name: Enter Notification Message To CSOC Manager (give a brief about the true
        positive alert and the impact)
      type: collection
      version: -1
    taskid: da6e5b30-bea7-4a16-897b-f7746b32725c
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 960,
          "y": 3930
        }
      }
  "104":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Was there any Impact ? .Answers
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "101"
      "yes":
      - "103"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bc6a85fd-a771-4c88-82d5-2bed995c2845
      iscommand: false
      name: Does The CSOC Manager Need To Be Notified ? (auto select if impact is
        'Yes')
      tags:
      - report
      type: condition
      version: -1
    taskid: bc6a85fd-a771-4c88-82d5-2bed995c2845
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 3780
        }
      }
  "105":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: anyimpact
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Was there any Impact ? (service disruption, malware installed,
            successful exploit ..etc) '
        options: []
        optionsarg:
        - {}
        - simple: "No"
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Was there any Impact ? (service disruption, malware installed, successful
        C&C communication..etc)
      totalanswers: 0
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "107"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2287a382-255a-482c-8250-70ef94a4822f
      iscommand: false
      name: 'Was there any Impact ? (service disruption, malware installed, successful
        C&C communication..etc) '
      type: collection
      version: -1
    taskid: 2287a382-255a-482c-8250-70ef94a4822f
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 3220
        }
      }
  "106":
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "105"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: True Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: d6135cf4-4c17-46cd-8073-f4f013d0d38b
      iscommand: true
      name: Set 'Investigation Conclusion' To True Positive
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: d6135cf4-4c17-46cd-8073-f4f013d0d38b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 3050
        }
      }
  "107":
    continueonerrortype: ""
    id: "107"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Based on The IoC Intel, Do You Need To Change The Alert Severity ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "104"
      "Yes":
      - "108"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ae4b6210-d1b8-49c1-8c44-a3f7c01e7250
      iscommand: false
      name: Based on The IoC Intel, Do You Need To Change The Alert Severity ?
      tags:
      - report
      type: condition
      version: -1
    taskid: ae4b6210-d1b8-49c1-8c44-a3f7c01e7250
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 3395
        }
      }
  "108":
    continueonerrortype: ""
    id: "108"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "104"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 15ad7930-59f1-4e1a-8d4c-acca6cd409e5
      iscommand: false
      name: 'Sub Playbook: Re-Assess - Triage The Alert Severity'
      playbookId: b82a6df1-9a17-4fae-889e-c6f7bde37df1
      type: playbook
      version: -1
    taskid: 15ad7930-59f1-4e1a-8d4c-acca6cd409e5
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 3580
        }
      }
  "111":
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Check with the application team to verify  if any unwarranted changes
          have occurred in the application or not?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Found changes
      - Not found changes
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Found changes:
      - "113"
      Not found changes:
      - "114"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 83d05ea2-0ccd-4477-8d7e-bc1f0f5ba55b
      iscommand: false
      name: Check with the application team to verify  if any unwarranted changes
        have occurred in the application or not?
      type: condition
      version: -1
    taskid: 83d05ea2-0ccd-4477-8d7e-bc1f0f5ba55b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 620
        }
      }
  "113":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Check if user agent is genuine and belongs to any application(Chrome/Mozilla/safari)
            and verify the payload URI request if that is benign and belongs to TCS
            application URL. If benign, check if it can be whitelisted. '
        options: []
        optionsarg:
        - {}
        - simple: Cannot be whitelisted
        - simple: Can be whitelisted
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Check if user agent is genuine and belongs to any application(Chrome/Mozilla/safari)
        and verify the payload URI request if that is benign and belongs to TCS application
        URL. If benign, check if it can be whitelisted.
      totalanswers: 0
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: {}
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Can be whitelisted
      - Cannot be whitelisted
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "114"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d5ef8565-79c3-4b0e-86a9-d7890573562d
      iscommand: false
      name: Check the payload.(for any URL,file,script,etc)
      type: collection
      version: -1
    taskid: d5ef8565-79c3-4b0e-86a9-d7890573562d
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 970
        }
      }
  "114":
    continueonerrortype: ""
    id: "114"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Is There Any File You'd Like To Sandbox ? (make sure the .zip file
          is protected with password 'infected')
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "48"
      "Yes":
      - "115"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c87d328c-45a4-45c7-8ea6-1e4eb0952834
      iscommand: false
      name: Is There Any File You'd Like To Sandbox ? (make sure the .zip file is
        protected with password 'infected')
      tags:
      - report
      type: condition
      version: -1
    taskid: c87d328c-45a4-45c7-8ea6-1e4eb0952834
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 1190
        }
      }
  "115":
    continueonerrortype: ""
    id: "115"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "116"
    note: false
    quietmode: 1
    scriptarguments:
      File:
        complex:
          root: File
      Interval:
        simple: "1"
      Timeout:
        simple: "15"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Detonate one or more files using the Wildfire integration. This playbook
        returns relevant reports to the War Room and file reputations to the context data.
        The detonation supports the following file types -
        APK, JAR, DOC, DOCX, RTF, XLS, XLSX, PPT, PPTX, OOXML, PE32, PDF, DMG, PKG, RAR, 7Z
      id: e603d83a-d220-444a-8d23-6ed683c51322
      iscommand: false
      name: TCS-OnDemand-WildFire-Detonate File v3_KK
      playbookId: f6c63e73-b7a8-4dec-813b-cca83d83f590
      type: playbook
      version: -1
    taskid: e603d83a-d220-444a-8d23-6ed683c51322
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 1395
        }
      }
  "116":
    continueonerrortype: ""
    id: "116"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Review The Sandbox Report
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Report Reviewed - Move To Next Step
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Report Reviewed - Move To Next Step:
      - "48"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e268e665-6f7b-432d-8c4b-b8592c3073f1
      iscommand: false
      name: Go To The 'Evidence Dashboard' And Review The Sandbox Report
      tags:
      - report
      type: condition
      version: -1
    taskid: e268e665-6f7b-432d-8c4b-b8592c3073f1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 1560
        }
      }
  "117":
    continueonerrortype: ""
    id: "117"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Have you informed team for finetuning
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "Yes":
      - "42"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 38e8ae71-ffd4-446c-881e-9b547bfcb3f1
      iscommand: false
      name: Have you informed team for finetuning
      tags:
      - report
      type: condition
      version: -1
    taskid: 38e8ae71-ffd4-446c-881e-9b547bfcb3f1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 890,
          "y": 3250
        }
      }
  "118":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: description
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsGeneral
          right:
            value:
              simple: waf
      label: WAF
    continueonerrortype: ""
    id: "118"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "113"
      WAF:
      - "119"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2769dd8a-fb2d-4016-8732-8488c32653e8
      iscommand: false
      name: Check if Alert is for Use case of WAF or Application Gateway
      type: condition
      version: -1
    taskid: 2769dd8a-fb2d-4016-8732-8488c32653e8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 0
        }
      }
  "119":
    continueonerrortype: ""
    id: "119"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Check if any attempts have been allowed or not?(response code 200)
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Allowed
      - Blocked
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Allowed:
      - "111"
      Blocked:
      - "113"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eebec0ac-4f80-4fc5-8c7e-e17ea1c4998a
      iscommand: false
      name: Check if any attempts have been allowed or not?
      type: condition
      version: -1
    taskid: eebec0ac-4f80-4fc5-8c7e-e17ea1c4998a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 250
        }
      }
  "120":
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Check the response code
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Allowed
      - Blocked
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5b08c076-909c-4a6b-8dba-407956ea2b25
      iscommand: false
      name: Check the response code
      type: condition
      version: -1
    taskid: 5b08c076-909c-4a6b-8dba-407956ea2b25
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -260,
          "y": 500
        }
      }
  "121":
    continueonerrortype: ""
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "98"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 213ad536-f6c0-4bd4-84b4-d2df5d455830
      iscommand: false
      name: Stop Threat Response SLA
      type: title
      version: -1
    taskid: 213ad536-f6c0-4bd4-84b4-d2df5d455830
    timertriggers:
    - action: stop
      fieldname: threatresponsesla
    type: title
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 5055
        }
      }
  "122":
    continueonerrortype: ""
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7e1991ca-5f2a-48cb-88c2-0c8675303d8a
      iscommand: false
      name: 'Sub Playbook: CSOC Submitted IOC Block Process'
      playbookId: f3a2d756-c0d5-4b32-83a4-0de75ea3765a
      type: playbook
      version: -1
    taskid: 7e1991ca-5f2a-48cb-88c2-0c8675303d8a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 340,
          "y": 4370
        }
      }
  "123":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtlocation
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Location
        options: []
        optionsarg: []
        placeholder: 'Enter Branch and Location.  Eg: TCS-Mumbai-Olympus'
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: Your SOC team
      title: Enter The IMT Location
      totalanswers: 0
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: ""
      headerfontcolor: ""
      isexternalrtl: false
      sender: ""
      submitbuttonbackgroundcolor: ""
      submitbuttonfontcolor: ""
      submittext: ""
    id: "123"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 75df489b-b9d4-4601-8239-ac6cc94f55ac
      iscommand: false
      name: Enter The IMT Location
      type: collection
      version: -1
    taskid: 75df489b-b9d4-4601-8239-ac6cc94f55ac
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 930,
          "y": 5560
        }
      }
  "125":
    continueonerrortype: ""
    id: "125"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 85ae5aa7-74ee-42fe-8f33-71c065c6fe89
      iscommand: false
      name: TCS-Block-CyberSOC Shared IOC v2.1_KK
      playbookId: 08d910d3-8abe-48de-8e69-0ab4027205b5
      type: playbook
      version: -1
    taskid: 85ae5aa7-74ee-42fe-8f33-71c065c6fe89
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1730,
          "y": 4600
        }
      }
  "126":
    continueonerrortype: ""
    id: "126"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "127"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6dba8f72-42a7-422c-8689-8b1395308934
      iscommand: false
      name: 'Sub Playbook: Select IOC To Block'
      playbookId: 3a55bd64-9e7f-40bc-88f8-d2ac28c0e4b0
      type: playbook
      version: -1
    taskid: 6dba8f72-42a7-422c-8689-8b1395308934
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2270,
          "y": 4310
        }
      }
  "127":
    continueonerrortype: ""
    id: "127"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      suspiciousiocs:
        complex:
          accessor: "0"
          root: Which IOC.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 038f8a3d-8eb1-4f77-85f7-806e4391f64e
      iscommand: false
      name: 'Sub Playbook: CSOC Submitted IOC Block Process'
      playbookId: 7e0105f5-2558-456a-85df-77c9558ebba6
      type: playbook
      version: -1
    taskid: 038f8a3d-8eb1-4f77-85f7-806e4391f64e
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2270,
          "y": 4450
        }
      }
  "128":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "1"
                root: Which IOC.Answers
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "128"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "132"
      "yes":
      - "129"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bed0c3c7-9032-4e1d-84f2-b3dfe3a5e47b
      iscommand: false
      name: Check condition if extra IOC are selected
      type: condition
      version: -1
    taskid: bed0c3c7-9032-4e1d-84f2-b3dfe3a5e47b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 960,
          "y": 4555
        }
      }
  "129":
    continueonerrortype: ""
    id: "129"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "130"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${Which IOC.Answers.1},${Which IOC.Answers.0}
      contextKey:
        simple: SelectedIOCAnswer
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: 96d0469d-bf74-44c3-80b1-8dd18508dc29
      iscommand: false
      name: Set in array for context value
      script: CreateArray
      type: regular
      version: -1
    taskid: 96d0469d-bf74-44c3-80b1-8dd18508dc29
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 4720
        }
      }
  "130":
    continueonerrortype: ""
    id: "130"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "131"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalselectedIOC
      value:
        complex:
          root: SelectedIOCAnswer
          transformers:
          - args:
              chars:
                value:
                  simple: '[]'
            operator: StripChars
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3619a47c-da97-4f82-8c49-0ac645dd5b7e
      iscommand: false
      name: Set Final Selected IOC in context
      script: Set
      type: regular
      version: -1
    taskid: 3619a47c-da97-4f82-8c49-0ac645dd5b7e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 4860
        }
      }
  "131":
    continueonerrortype: ""
    id: "131"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2b5e1146-ab4d-40ee-8e80-1b65696ae500
      iscommand: false
      name: TCS-Blacklist IOC v3.0_PG
      playbookId: 72dda1e2-ca72-42c4-8232-4592b180eb04
      type: playbook
      version: -1
    taskid: 2b5e1146-ab4d-40ee-8e80-1b65696ae500
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 960,
          "y": 5025
        }
      }
  "132":
    continueonerrortype: ""
    id: "132"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "131"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalselectedIOC
      value:
        complex:
          accessor: "0"
          root: Which IOC.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f8c6587b-b02f-450e-8c9b-30cc319cb2de
      iscommand: false
      name: Set Context Value
      script: Set
      type: regular
      version: -1
    taskid: f8c6587b-b02f-450e-8c9b-30cc319cb2de
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 4790
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "34_35_No, Its a Confirmed - False Positive": 0.67,
      "34_36_No, Its a Benign-True Positive": 0.69,
      "92_35_No, Its a Confirmed - False Positive": 0.1,
      "92_36_No, Its a Benign-True Positive": 0.1,
      "92_90_Not Sure - To Be Determined": 0.85,
      "98_42_I'm Not Sure - Will Do It later": 0.29,
      "98_96_Yes - I Have Raised an IMT": 0.51,
      "98_97_No -  IMT Not Required": 0.59
    },
    "paper": {
      "dimensions": {
        "height": 7010,
        "width": 2910,
        "x": -260,
        "y": -910
      }
    }
  }
