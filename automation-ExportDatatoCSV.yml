commonfields:
  id: e7b7f82a-ed1e-42f8-8ac6-61aa9dba1d5f
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.10.11.54132
enabled: true
engineinfo: {}
mainengineinfo: {}
name: ExportDatatoCSV
pswd: ""
runas: DBotWeakRole
runonce: false
script: |2+

  ''' MAIN FUNCTION '''

  import csv


  def create_csv_file(file_name,result_data):
      with open(file_name, 'w', encoding='utf8', newline='') as output_file:
          fc = csv.DictWriter(output_file, fieldnames=result_data[0].keys())
          fc.writeheader()
          fc.writerows(result_data)

      return_results(file_result_existing_file(file_name))



  def main():
      #try:
      result_data=[{'Key': 'DEL-414209', 'OS Version': '6.6.0.81015', 'Created': '20/Oct/22 5:26 PM', 'Updated': '20/Oct/22 5:29 PM', 'OS Name': 'ClearPass', 'Hostname': 'AAASRV001',
                  'FQDN': 'N/A', 'System Name': 'IPTV Platform', 'Device Brand': 'Aruba', 'Device Make and Model': 'Clearpaas CP-HW-500', 'Asset Type': 'Physical Server', 'CII': 'No',
                  'CAT Status': 'CAT 4', 'Status of Asset': 'Active', 'IPv4': '10.239.93.73', 'End of Support Date': '31/Mar/24', 'Remediation Option': 'None',
                  'Business Unit': 'IPTVE', 'Owner Name': 'Yeo Kian Ann', 'Owner Key': 'IPNTVE-270956', 'Planner Name': 'IPTV Ops', 'Planner Key': 'IPNTVE-270913',
                  'Operator Name': 'IPTV Ops', 'Operations Key': 'IPNTVE-270884', 'Service Supported': 'RADIUS server for network devices-RADIUS server for network devices',
                  'Location': 'TP', 'PIAM': 'Yes', 'IPnTVE Owners': 'Yeo Kian Ann', 'IPnTVE Planners': 'IPTV Ops', 'IPnTVE Operations': 'IPTV Ops'},
                  {'Key': 'IPNTVE-295158', 'OS Version': '6.6.0.81015', 'Created': '13/Oct/22 5:00 PM', 'Updated': '14/Oct/22 5:45 PM', 'OS Name': 'ClearPass', 'Hostname': 'TP-AAASRV001',
                  'FQDN': 'N/A', 'System Name': 'IPTV Platform', 'Device Brand': 'Aruba', 'Device Make and Model': 'Clearpaas CP-HW-500', 'Asset Type': 'Physical Server', 'CII': 'No',
                  'CAT Status': 'CAT 4', 'Status of Asset': 'Active', 'IPv4': '10.239.93.75 (VIP)', 'End of Support Date': '31/Mar/23', 'Remediation Option': 'None',
                  'Business Unit': 'IPTVE', 'Owner Name': 'Yeo Kian Ann', 'Owner Key': 'IPNTVE-270956', 'Planner Name': 'IPTV Ops', 'Planner Key': 'IPNTVE-270913',
                  'Operator Name': 'IPTV Ops', 'Operations Key': 'IPNTVE-270884', 'Service Supported': 'RADIUS server for network devices', 'Location': 'TP', 'PIAM': 'Yes',
                  'IPnTVE Owners': 'Yeo Kian Ann', 'IPnTVE Planners': 'IPTV Ops', 'IPnTVE Operations': 'IPTV Ops'}]
      file_name="Data.csv"
      create_csv_file(file_name,result_data)

      # except Exception as ex:
      #     demisto.error(traceback.format_exc())  # print the traceback
      #     return_error(f'Failed to execute BaseScript. Error: {str(ex)}')


  ''' ENTRY POINT '''


  if __name__ in ('__main__', '__builtin__', 'builtins'):
      main()

scripttarget: 0
subtype: python3
tags: []
type: python
