commonfields:
  id: d49df9d9-0fcd-4b9a-8870-08a3fdfd62b9
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.10.13.77674
enabled: true
engineinfo: {}
mainengineinfo: {}
name: TestGetUserLogins
pswd: ""
runas: DBotWeakRole
runonce: false
script: |2+

  from typing import Dict, Any
  import traceback
  import json

  UserData=[]

  def compare_login_time(list_item,user_data):
      for i in range(len(list_item)):
          if user_data[i]['lastLogin'] == list_item[i]['login']:
              UserData.append({'id':user_data[i]['id'],'name':user_data[i]['name'],'email':user_data[i]['email'],'login':user_data[i]['lastLogin'],'logout':"Not Available"})
          else:
              UserData.append({'id':user_data[i]['id'],'name':user_data[i]['name'],'email':user_data[i]['email'],'login':user_data[i]['lastLogin'],'logout':list_item[i]['login']})

      print(UserData)
  ''' MAIN FUNCTION '''


  def main():

      list_data = demisto.executeCommand("getList", {"listName":"UserLogin"})[0]['Contents']
      data= json.loads(list_data)
      res = demisto.executeCommand("getUsers", {})[0]['Contents']

      compare_login_time(data,res)

      #print(users_data)

      #demisto.executeCommand("setList", {"listName":"UserLogin","listData":users_data})

  ''' ENTRY POINT '''


  if __name__ in ('__main__', '__builtin__', 'builtins'):
      main()

scripttarget: 0
subtype: python3
tags: []
type: python
