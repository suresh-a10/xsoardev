contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 21ce8491-ba19-4813-8f99-f3764238e54d
inputs:
- description: ""
  key: ArcSight_ActiveListResourceID
  playbookInputQuery: null
  required: true
  value:
    simple: HpLsmQosBABD2dHC4lamu4Q==
- description: ""
  key: Arcsight_IP_AddressFieldName
  playbookInputQuery: null
  required: true
  value:
    simple: IPAddress
- description: ""
  key: Arcsight_IOC_VerdictFieldName
  playbookInputQuery: null
  required: true
  value:
    simple: Verdict
- description: ""
  key: Arcsight_Entry-ID_FieldName
  playbookInputQuery: null
  required: true
  value:
    simple: ID
- description: ""
  key: ArcSight_ExpirationStatusFieldName
  playbookInputQuery: null
  required: true
  value:
    simple: ExpirationStatus
- description: ""
  key: Arcsight_GeoCountryField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: GeoCountry
- description: ""
  key: Arcsight_GeoLocationField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: GeoLocation
- description: ""
  key: Arcsight_CountryNameField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: CountryName
- description: ""
  key: Arcsight_CountryCodeField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: CountryCode
- description: ""
  key: Arcsight_FirstSeenField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: FirstSeen
- description: ""
  key: Arcsight_LastSeenField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: LastSeen
- description: ""
  key: Arcsight_SourceBrandField_Name
  playbookInputQuery: null
  required: true
  value:
    simple: SourceBrands
- description: ""
  key: Arcsight_SourceInstanceField_Name
  playbookInputQuery: null
  required: true
  value:
    simple: SourceInstances
- description: ""
  key: Arcsight_MscoreField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: Mscore
- description: ""
  key: Arcsight_CVSS_Score_Field_Name
  playbookInputQuery: null
  required: false
  value:
    simple: CVSSScore
- description: ""
  key: Arcsight_CVSS3Field_Name
  playbookInputQuery: null
  required: false
  value:
    simple: CVSS3
- description: ""
  key: Arcsight_MITRE_ID_Field_Name
  playbookInputQuery: null
  required: false
  value:
    simple: MitreID
- description: ""
  key: Arcsight_MITRE_Tactics_Field_Name
  playbookInputQuery: null
  required: false
  value:
    simple: MitreTactics
- description: ""
  key: Arcsight_KillChainPhases_Field_Name
  playbookInputQuery: null
  required: false
  value:
    simple: KillChainPhases
name: TIM - UBI Sub Playbook Add IP Indicators to Arcsight SIEM
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0e8f0773-b721-4565-8146-ed33bbb5254c
      iscommand: false
      name: ""
      version: -1
    taskid: 0e8f0773-b721-4565-8146-ed33bbb5254c
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 705,
          "y": 65
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: ArcSight ESM v2
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "2"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6923b0d7-d181-4f11-8bc2-d42e8e47d30e
      iscommand: false
      name: Is ArcSight Enabled?
      type: condition
      version: -1
    taskid: 6923b0d7-d181-4f11-8bc2-d42e8e47d30e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 705,
          "y": 400
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.Arcsight_IP_AddressFieldName
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: inputs.Arcsight_IOC_VerdictFieldName
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: inputs.Arcsight_Entry-ID_FieldName
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: inputs.Arcsight_GeoCountryField_Name
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "3"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3a760f5d-6fb4-49c8-8da5-c31f3c501b7c
      iscommand: false
      name: Is there an ArcSight fields name and values?
      type: condition
      version: -1
    taskid: 3a760f5d-6fb4-49c8-8da5-c31f3c501b7c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 2380
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 2
    scriptarguments:
      entries:
        simple: '[${Value}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
      retry-count:
        simple: "50"
      retry-interval:
        simple: "30"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ArcSight ESM v2
      description: Adds new entries to the Active List.
      id: dfc791d7-91b9-4ebe-8395-18ea3a72f739
      iscommand: true
      name: Add IP to ArcSight Active list block list
      script: ArcSight ESM v2|||as-add-entries
      type: regular
      version: -1
    taskid: dfc791d7-91b9-4ebe-8395-18ea3a72f739
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2190,
          "y": 2600
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 1
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: IOC Added to ArcSight SIEM
      indicatorsValues:
        simple: ${Value.IPAddress}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Adds the SIEM tag to the indicator.
      id: da345eb2-7e6d-4a59-8711-935e8b4eff08
      iscommand: true
      name: Add SIEM tag
      script: Builtin|||appendIndicatorField
      type: regular
      version: -1
    taskid: da345eb2-7e6d-4a59-8711-935e8b4eff08
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2190,
          "y": 2780
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 26e1647b-4418-4a8c-82d7-fbc8e5a9cf6c
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 26e1647b-4418-4a8c-82d7-fbc8e5a9cf6c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 765,
          "y": 2885
        }
      }
  "13":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ArcSight_ActiveListResourceID
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "1"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 696fc24b-7c26-44d6-8ce6-5555a0383563
      iscommand: false
      name: Are there Resource ID Present?
      type: condition
      version: -1
    taskid: 696fc24b-7c26-44d6-8ce6-5555a0383563
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 705,
          "y": 225
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 1
    scriptarguments:
      entryFilter:
        simple: ${inputs.Arcsight_IP_AddressFieldName}:${Value.IPAddress},${inputs.Arcsight_Entry-ID_FieldName}:${Value.ID}
      ignore-outputs:
        simple: "false"
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
      retry-count:
        simple: "50"
      retry-interval:
        simple: "200"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns all entries in the Active List
      id: 2a8694ac-6006-4738-8d8f-b2cc4c9f2613
      iscommand: true
      name: Get Entry from ArcSight
      script: '|||as-get-entries'
      type: regular
      version: -1
    taskid: 2a8694ac-6006-4738-8d8f-b2cc4c9f2613
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1032.5,
          "y": 575
        }
      }
  "16":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].IPAddress}
          operator: isEqualString
          right:
            value:
              simple: ${Value.IP}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].FirstSeen}
          operator: isEqualString
          right:
            value:
              simple: ${FirstSeen_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].LastSeen}
          operator: isEqualString
          right:
            value:
              simple: ${LastSeen_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceBrands}
          operator: isEqualString
          right:
            value:
              simple: ${SourceBrand_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceInstances}
          operator: isEqualString
          right:
            value:
              simple: ${Source_Instance_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.ExpirationStatus_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CountryCode}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.code}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].GeoLocation}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.location}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CountryName}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.name}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Mscore}
          operator: isEqualNumber
          right:
            value:
              simple: ${raw.mscore}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Verdict}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.IOC_VerdictFieldValue}
      - - left:
            value:
              simple: ${Arcsight_ID}
          operator: isEqualNumber
          right:
            value:
              simple: ${inputs.Entry-ID_FieldValue}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].GeoCountry}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.code}
      label: Value Alerady Present
    - condition:
      - - left:
            value:
              simple: ${Arcsight_ID}
          operator: isEqualString
          right:
            value:
              simple: ${Value.id}
      label: For Fresh Entry
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 36e429ee-a2c6-468a-8a8b-8d6b554023bd
      iscommand: false
      name: Check all Data is Present?
      type: condition
      version: -1
    taskid: 36e429ee-a2c6-468a-8a8b-8d6b554023bd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 50
        }
      }
  "17":
    continueonerror: true
    continueonerrortype: errorPath
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "21"
      '#none#':
      - "19"
    note: false
    quietmode: 1
    scriptarguments:
      entries:
        simple: '[${ArcsightValue}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
      retry-count:
        simple: "50"
      retry-interval:
        simple: "200"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete entries from the Active List.
      id: cee21e9a-7d15-49bd-8763-4a60ed3c4a44
      iscommand: true
      name: Delete Old Entry
      script: '|||as-delete-entries'
      type: regular
      version: -1
    taskid: cee21e9a-7d15-49bd-8763-4a60ed3c4a44
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1600
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: Delete_Count
      value:
        simple: ${Delete_Count=val+1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: db1535f7-1624-4f76-87e8-19587fe4a285
      iscommand: false
      name: Update delete count
      script: Set
      type: regular
      version: -1
    taskid: db1535f7-1624-4f76-87e8-19587fe4a285
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1135,
          "y": 2115
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: Delete_Count_Error
      value:
        simple: ${Delete_Count_Error=val+1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a220a306-992d-45ca-8745-a7b1be142d91
      iscommand: false
      name: Update Delete_Count_Error
      script: Set
      type: regular
      version: -1
    taskid: a220a306-992d-45ca-8745-a7b1be142d91
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -440,
          "y": 2020
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceBrands}
          operator: containsGeneral
          right:
            value:
              simple: ${SourceBrand_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceInstances}
          operator: containsGeneral
          right:
            value:
              simple: ${Source_Instance_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Verdict}
          operator: containsGeneral
          right:
            value:
              simple: ${inputs.IOC_VerdictFieldValue}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].FirstSeen}
          operator: containsGeneral
          right:
            value:
              simple: ${FirstSeen_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].LastSeen}
          operator: containsGeneral
          right:
            value:
              simple: ${LastSeen_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}
          operator: containsGeneral
          right:
            value:
              simple: ${inputs.ExpirationStatus_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CountryCode}
          operator: containsGeneral
          right:
            value:
              simple: ${GeoCountry.code}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].GeoLocation}
          operator: containsGeneral
          right:
            value:
              simple: ${GeoCountry.location}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Mscore}
          operator: containsGeneral
          right:
            value:
              simple: ${raw.mscore}
      label: Value Alerady Present
    - condition:
      - - left:
            value:
              simple: ${Result.[19]}
          operator: isEqualString
          right:
            value:
              simple: Active List has no entries
      label: Entry Not Present
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a75e5d2e-a021-4de5-802e-e7c9732a8c60
      iscommand: false
      name: Check all Data is Present?
      type: condition
      version: -1
    taskid: a75e5d2e-a021-4de5-802e-e7c9732a8c60
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 50
        }
      }
  "23":
    continueonerror: true
    continueonerrortype: errorPath
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 1
    scriptarguments:
      entries:
        simple: '[{"${inputs.Arcsight_IP_AddressFieldName}":"${ArcSightESM.ActiveList.Entries.[0].IPAddress}","${inputs.Arcsight_IOC_VerdictFieldName}":"${ArcSightESM.ActiveList.Entries.[0].Verdict}","${inputs.Arcsight_SourceBrandField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceBrands}","${inputs.Arcsight_SourceInstanceField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceInstances}","${inputs.Arcsight_FirstSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].FirstSeen}","${inputs.Arcsight_LastSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].LastSeen}","${inputs.ArcSight_ExpirationStatusFieldName}":"${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}","${inputs.Arcsight_Entry-ID_FieldName}":"${ArcSightESM.ActiveList.Entries.[0].ID}","${inputs.Arcsight_GeoCountryField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_GeoLocationField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoLocation}","${inputs.Arcsight_CountryNameField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryName}","${inputs.Arcsight_CountryCodeField_Name}":"${{ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_MscoreField_Name}":"${ArcSightESM.ActiveList.Entries.[0].Mscore}"}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
      retry-count:
        simple: "50"
      retry-interval:
        simple: "300"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete entries from the Active List.
      id: 08cc9513-e9d1-4a2e-8920-0e4d5deb35cf
      iscommand: true
      name: Delete Old Entry
      script: '|||as-delete-entries'
      type: regular
      version: -1
    taskid: 08cc9513-e9d1-4a2e-8920-0e4d5deb35cf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2425,
          "y": 50
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].IPAddress}
          operator: isEqualString
          right:
            value:
              simple: ${Value.IP}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].FirstSeen}
          operator: isEqualString
          right:
            value:
              simple: ${FirstSeen_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].LastSeen}
          operator: isEqualString
          right:
            value:
              simple: ${LastSeen_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceBrands}
          operator: isEqualString
          right:
            value:
              simple: ${SourceBrand_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceInstances}
          operator: isEqualString
          right:
            value:
              simple: ${Source_Instance_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.ExpirationStatus_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CountryCode}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.code}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].GeoLocation}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.location}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CountryName}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.name}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Mscore}
          operator: isEqualNumber
          right:
            value:
              simple: ${raw.mscore}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Verdict}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.IOC_VerdictFieldValue}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ID}
          operator: isEqualNumber
          right:
            value:
              simple: ${inputs.Entry-ID_FieldValue}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].GeoCountry}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.code}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CVSSScore}
          operator: isEqualNumber
          right:
            value:
              simple: ${CVSSScore}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CVSS3}
          operator: isEqualNumber
          right:
            value:
              simple: ${CVSS3 Score}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].MitreID}
          operator: isEqualString
          right:
            value:
              simple: ${Mitre Id}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].MitreTactics}
          operator: isEqualString
          right:
            value:
              simple: ${MitreTactics}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].KillChainPhases}
          operator: isEqualString
          right:
            value:
              simple: ${KillchainPhase}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ThreatTypes}
          operator: isEqualString
          right:
            value:
              simple: ${ThreatTypes}
      label: Value Alerady Present
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Result.[19]}
          operator: isEqualString
          right:
            value:
              simple: Active List has no entries
      label: Entry Not Present
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6d842b16-9563-4287-853a-fadc76832c02
      iscommand: false
      name: Check all Data is Present?
      type: condition
      version: -1
    taskid: 6d842b16-9563-4287-853a-fadc76832c02
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 50
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].IPAddress}
          operator: isEqualString
          right:
            value:
              simple: ${Value.IP}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].ID}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.Entry-ID_FieldValue}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].SourceBrands}
          operator: isEqualString
          right:
            value:
              simple: ${SourceBrand_Value}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].SourceInstances}
          operator: isEqualString
          right:
            value:
              simple: ${Source_Instance_Value}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].Verdict}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.IOC_VerdictFieldValue}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].ExpirationStatus}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.ExpirationStatus_Value}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].FirstSeen}
          operator: isEqualString
          right:
            value:
              simple: ${FirstSeen_Value}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].LastSeen}
          operator: isEqualString
          right:
            value:
              simple: ${LastSeen_Value}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].Mscore}
          operator: isEqualString
          right:
            value:
              simple: ${raw.mscore}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].GeoCountry}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.code}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].GeoLocation}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.location}
      label: Entry Present
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: caabc682-650a-4472-84c3-7a0a8115169e
      iscommand: false
      name: Check all Data is Present?
      type: condition
      version: -1
    taskid: caabc682-650a-4472-84c3-7a0a8115169e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3285,
          "y": 50
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].IPAddress}
          operator: isEqualString
          right:
            value:
              simple: ${Value.IP}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].EntryID}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.Entry-ID_FieldValue}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceBrands}
          operator: isEqualString
          right:
            value:
              simple: ${SourceBrand_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceInstances}
          operator: isEqualString
          right:
            value:
              simple: ${Source_Instance_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Verdict}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.IOC_VerdictFieldValue}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.ExpirationStatus_Value}
      label: Data Found
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ee53b413-d3ea-452c-8e1f-79a0aa24765e
      iscommand: false
      name: Check all Data is Present?
      type: condition
      version: -1
    taskid: ee53b413-d3ea-452c-8e1f-79a0aa24765e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3715,
          "y": 50
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: Fresh-Add_Count
      value:
        simple: ${Fresh-Add_Count=val+1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e97e1458-77a3-4fbe-807a-06372f9dd747
      iscommand: false
      name: Update Fresh Add Count
      script: Set
      type: regular
      version: -1
    taskid: e97e1458-77a3-4fbe-807a-06372f9dd747
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2045,
          "y": 2115
        }
      }
  "28":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ID}
          operator: in
          right:
            value:
              simple: ${Value.ID}
      label: ' For Fresh Entry'
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f2f1c4f9-3a3d-48e0-8398-c51cb134f7a8
      iscommand: false
      name: Condition For Fresh Entry
      type: condition
      version: -1
    taskid: f2f1c4f9-3a3d-48e0-8398-c51cb134f7a8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4145,
          "y": 50
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 2
    scriptarguments:
      key:
        simple: Set Data For Deletion
      value:
        simple: ${Value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5b828445-9ae0-4dbf-81c2-375dc45a0d7a
      iscommand: false
      name: Set Data For Deletion
      script: Set
      type: regular
      version: -1
    taskid: 5b828445-9ae0-4dbf-81c2-375dc45a0d7a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4575,
          "y": 50
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      key:
        simple: setxy
      value:
        complex:
          root: ${Set Data For Deletion}
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '["'
            operator: replace
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"]'
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 62578f87-3cf7-4549-8bd8-e1752e41318c
      iscommand: false
      name: Set
      script: Set
      type: regular
      version: -1
    taskid: 62578f87-3cf7-4549-8bd8-e1752e41318c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4575,
          "y": 225
        }
      }
  "31":
    continueonerror: true
    continueonerrortype: errorPath
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      entries:
        simple: '[{"${inputs.Arcsight_IP_AddressFieldName}":"${ArcSightESM.ActiveList.Entries.[0].IPAddress}","${inputs.Arcsight_IOC_VerdictFieldName}":"${ArcSightESM.ActiveList.Entries.[0].Verdict}","${inputs.Arcsight_SourceBrandField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceBrands}","${inputs.Arcsight_SourceInstanceField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceInstances}","${inputs.Arcsight_FirstSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].FirstSeen}","${inputs.Arcsight_LastSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].LastSeen}","${inputs.ArcSight_ExpirationStatusFieldName}":"${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}","${inputs.Arcsight_Entry-ID_FieldName}":"${ArcSightESM.ActiveList.Entries.[0].ID}","${inputs.Arcsight_GeoCountryField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_GeoLocationField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoLocation}","${inputs.Arcsight_CountryNameField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryName}","${inputs.Arcsight_CountryCodeField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryCode}","${inputs.Arcsight_MscoreField_Name}":"${ArcSightESM.ActiveList.Entries.[0].Mscore}"}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete entries from the Active List.
      id: a3969987-26dd-4d6c-8f47-a731c64b713a
      iscommand: true
      name: Delete Old Entry
      script: '|||as-delete-entries'
      type: regular
      version: -1
    taskid: a3969987-26dd-4d6c-8f47-a731c64b713a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 5005,
          "y": 50
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 1
    scriptarguments:
      key:
        simple: RawArcsightVal
      value:
        simple: '{"${inputs.Arcsight_IP_AddressFieldName}":"${ArcSightESM.ActiveList.Entries.[0].IPAddress}","${inputs.Arcsight_IOC_VerdictFieldName}":"${ArcSightESM.ActiveList.Entries.[0].Verdict}","${inputs.Arcsight_SourceBrandField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceBrands}","${inputs.Arcsight_SourceInstanceField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceInstances}","${inputs.Arcsight_FirstSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].FirstSeen}","${inputs.Arcsight_LastSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].LastSeen}","${inputs.ArcSight_ExpirationStatusFieldName}":"${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}","${inputs.Arcsight_Entry-ID_FieldName}":"${ArcSightESM.ActiveList.Entries.[0].ID}","${inputs.Arcsight_GeoCountryField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_GeoLocationField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoLocation}","${inputs.Arcsight_CountryNameField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryName}","${inputs.Arcsight_CountryCodeField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryCode}","${inputs.Arcsight_MscoreField_Name}":"${ArcSightESM.ActiveList.Entries.[0].Mscore}"}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6e534370-6b1c-4c11-8c47-6a35a8b8483a
      iscommand: false
      name: Set Get Arcsight Data
      script: Set
      type: regular
      version: -1
    taskid: 6e534370-6b1c-4c11-8c47-6a35a8b8483a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1145,
          "y": 1100
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${ArcsightValue}
          operator: in
          right:
            value:
              simple: ${Value}
      label: Value Alerady Present
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      Value Alerady Present:
      - "6"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 342bf444-86f6-43a5-81ee-bed6d818a613
      iscommand: false
      name: Is Arcsight Val and Current val is same?
      type: condition
      version: -1
    taskid: 342bf444-86f6-43a5-81ee-bed6d818a613
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 1550
        }
      }
  "36":
    continueonerror: true
    continueonerrortype: errorPath
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "40"
      '#none#':
      - "34"
    note: false
    quietmode: 1
    scriptarguments:
      key:
        simple: ArcsightValue
      value:
        complex:
          root: ${RawArcsightVal}
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '["'
            operator: replace
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"]'
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3a2f5172-2e4f-4b08-8085-207ac789f1ac
      iscommand: false
      name: Format Value
      script: Set
      type: regular
      version: -1
    taskid: 3a2f5172-2e4f-4b08-8085-207ac789f1ac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1145,
          "y": 1275
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Mscore}
          operator: isNotEmpty
          right:
            value: {}
      label: Mscore Present
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "43"
      Mscore Present:
      - "33"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8a66f857-38cc-4990-8797-32461302ffd2
      iscommand: false
      name: Is Mscore Field is Present
      type: condition
      version: -1
    taskid: 8a66f857-38cc-4990-8797-32461302ffd2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1360,
          "y": 925
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      entries:
        simple: '[{"${inputs.Arcsight_IP_AddressFieldName}":"${Value.IP}","${inputs.Arcsight_IOC_VerdictFieldName}":"${inputs.IOC_VerdictFieldValue}","${inputs.Arcsight_SourceBrandField_Name}":"${SourceBrand_Value}","${inputs.Arcsight_SourceInstanceField_Name}":"${Source_Instance_Value}","${inputs.Arcsight_FirstSeenField_Name}":"${FirstSeen_Value}","${inputs.Arcsight_LastSeenField_Name}":"${LastSeen_Value}","${inputs.ArcSight_ExpirationStatusFieldName}":"${inputs.ExpirationStatus_Value}","${inputs.Arcsight_Entry-ID_FieldName}":"${inputs.Entry-ID_FieldValue}","${inputs.Arcsight_GeoCountryField_Name}":"${GeoCountry.code}","${inputs.Arcsight_GeoLocationField_Name}":"${GeoCountry.location}","${inputs.Arcsight_CountryNameField_Name}":"${GeoCountry.name}","${inputs.Arcsight_CountryCodeField_Name}":"${GeoCountry.code}","${inputs.Arcsight_MscoreField_Name}":"${raw.mscore}"}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ArcSight ESM v2
      description: Adds new entries to the Active List.
      id: 4fb00a65-9c0c-442b-8aa7-5de81ec3bfe8
      iscommand: true
      name: Add IP to ArcSight Active list block list
      script: ArcSight ESM v2|||as-add-entries
      type: regular
      version: -1
    taskid: 4fb00a65-9c0c-442b-8aa7-5de81ec3bfe8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 5435,
          "y": 50
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      key:
        simple: Set Data For Deletion
      value:
        simple: '[{"${inputs.Arcsight_IP_AddressFieldName}":"${ArcSightESM.ActiveList.Entries.[0].IPAddress}","${inputs.Arcsight_IOC_VerdictFieldName}":"${ArcSightESM.ActiveList.Entries.[0].Verdict}","${inputs.Arcsight_SourceBrandField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceBrands}","${inputs.Arcsight_SourceInstanceField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceInstances}","${inputs.Arcsight_FirstSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].FirstSeen}","${inputs.Arcsight_LastSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].LastSeen}","${inputs.ArcSight_ExpirationStatusFieldName}":"${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}","${inputs.Arcsight_Entry-ID_FieldName}":"${ArcSightESM.ActiveList.Entries.[0].ID}","${inputs.Arcsight_GeoCountryField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_GeoLocationField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoLocation}","${inputs.Arcsight_CountryNameField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryName}","${inputs.Arcsight_CountryCodeField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryCode}","${inputs.Arcsight_MscoreField_Name}":"${ArcSightESM.ActiveList.Entries.[0].Mscore}"}]'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6179fa7e-3528-4dd2-8727-5604f7b208ce
      iscommand: false
      name: Set Data For Deletion
      script: Set
      type: regular
      version: -1
    taskid: 6179fa7e-3528-4dd2-8727-5604f7b208ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 5865,
          "y": 50
        }
      }
  "40":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${RawArcsightVal}
          operator: in
          right:
            value:
              simple: ${Value}
      label: Value Alerady Present
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "41"
      Value Alerady Present:
      - "6"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 33055801-2f5d-4982-8789-3943b10005ab
      iscommand: false
      name: Is Arcsight Val and Current val is same?
      type: condition
      version: -1
    taskid: 33055801-2f5d-4982-8789-3943b10005ab
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1600
        }
      }
  "41":
    continueonerror: true
    continueonerrortype: errorPath
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "21"
      '#none#':
      - "19"
    note: false
    quietmode: 1
    scriptarguments:
      entries:
        simple: '[${RawArcsightVal}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
      retry-count:
        simple: "50"
      retry-interval:
        simple: "200"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete entries from the Active List.
      id: a5b72ff3-6f9f-43b8-81fc-f9b2a4bf14d4
      iscommand: true
      name: Delete Old Entry
      script: '|||as-delete-entries'
      type: regular
      version: -1
    taskid: a5b72ff3-6f9f-43b8-81fc-f9b2a4bf14d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1820
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RawArcsightVal
      value:
        simple: '{"${inputs.Arcsight_IP_AddressFieldName}":"${ArcSightESM.ActiveList.Entries.[0].IPAddress}","${inputs.Arcsight_IOC_VerdictFieldName}":"${ArcSightESM.ActiveList.Entries.[0].Verdict}","${inputs.Arcsight_SourceBrandField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceBrands}","${inputs.Arcsight_SourceInstanceField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceInstances}","${inputs.Arcsight_FirstSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].FirstSeen}","${inputs.Arcsight_LastSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].LastSeen}","${inputs.ArcSight_ExpirationStatusFieldName}":"${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}","${inputs.Arcsight_Entry-ID_FieldName}":"${ArcSightESM.ActiveList.Entries.[0].ID}","${inputs.Arcsight_GeoCountryField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_GeoLocationField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoLocation}","${inputs.Arcsight_CountryNameField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryName}","${inputs.Arcsight_CountryCodeField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryCode}","${inputs.Arcsight_MscoreField_Name}":"${ArcSightESM.ActiveList.Entries.[0].Mscore}","${inputs.Arcsight_CVSS_Score_Field_Name}":"${ArcSightESM.ActiveList.Entries.[0].CVSSScore}","${inputs.Arcsight_CVSS3Field_Name}":"${ArcSightESM.ActiveList.Entries.[0].CVSS3}","${inputs.Arcsight_MITRE_ID_Field_Name}":"${ArcSightESM.ActiveList.Entries.[0].MitreID}","${inputs.Arcsight_MITRE_Tactics_Field_Name}":"${ArcSightESM.ActiveList.Entries.[0].MitreTactics}","${inputs.Arcsight_KillChainPhases_Field_Name}":"${ArcSightESM.ActiveList.Entries.[0].KillChainPhases}","${inputs.Arcsight_ThreatType_Field_Name}":"${ArcSightESM.ActiveList.Entries.[0].ThreatTypes}"}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6749d3a3-3e20-4678-834a-77112c6ba8ea
      iscommand: false
      name: Set Get Arcsight Data
      script: Set
      type: regular
      version: -1
    taskid: 6749d3a3-3e20-4678-834a-77112c6ba8ea
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 6295,
          "y": 50
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 1
    scriptarguments:
      key:
        simple: RawArcsightVal
      value:
        simple: '{"${inputs.Arcsight_IP_AddressFieldName}":"${ArcSightESM.ActiveList.Entries.[0].IPAddress}","${inputs.Arcsight_IOC_VerdictFieldName}":"${ArcSightESM.ActiveList.Entries.[0].Verdict}","${inputs.Arcsight_SourceBrandField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceBrands}","${inputs.Arcsight_SourceInstanceField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceInstances}","${inputs.Arcsight_FirstSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].FirstSeen}","${inputs.Arcsight_LastSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].LastSeen}","${inputs.ArcSight_ExpirationStatusFieldName}":"${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}","${inputs.Arcsight_Entry-ID_FieldName}":"${ArcSightESM.ActiveList.Entries.[0].ID}","${inputs.Arcsight_GeoCountryField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_GeoLocationField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoLocation}","${inputs.Arcsight_CountryNameField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryName}","${inputs.Arcsight_CountryCodeField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryCode}"}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 863be32e-fab0-496e-876d-917adb3caf41
      iscommand: false
      name: Set Get Arcsight Data
      script: Set
      type: regular
      version: -1
    taskid: 863be32e-fab0-496e-876d-917adb3caf41
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1575,
          "y": 1100
        }
      }
  "44":
    continueonerror: true
    continueonerrortype: errorPath
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "45"
      '#none#':
      - "34"
    note: false
    quietmode: 1
    scriptarguments:
      key:
        simple: ArcsightValue
      value:
        complex:
          root: ${RawArcsightVal}
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '["'
            operator: replace
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"]'
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 7e4024df-839f-42de-8ca3-0a3a79d6163e
      iscommand: false
      name: Format Value
      script: Set
      type: regular
      version: -1
    taskid: 7e4024df-839f-42de-8ca3-0a3a79d6163e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1575,
          "y": 1275
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${RawArcsightVal}
          operator: in
          right:
            value:
              simple: ${Value}
      label: Value Alerady Present
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "46"
      Value Alerady Present:
      - "6"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bad348d6-2d63-4ff8-8a9c-8fcac933bcda
      iscommand: false
      name: Is Arcsight Val and Current val is same?
      type: condition
      version: -1
    taskid: bad348d6-2d63-4ff8-8a9c-8fcac933bcda
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 1655
        }
      }
  "46":
    continueonerror: true
    continueonerrortype: errorPath
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "21"
      '#none#':
      - "19"
    note: false
    quietmode: 1
    scriptarguments:
      entries:
        simple: '[${RawArcsightVal}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
      retry-count:
        simple: "50"
      retry-interval:
        simple: "200"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete entries from the Active List.
      id: fc14f2c3-c3c2-42de-889e-a42e4a04a2a8
      iscommand: true
      name: Delete Old Entry
      script: '|||as-delete-entries'
      type: regular
      version: -1
    taskid: fc14f2c3-c3c2-42de-889e-a42e4a04a2a8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 1820
        }
      }
  "47":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].IPAddress}
          operator: isEqualString
          right:
            value:
              simple: ${Value.IPAddress}
      label: Entry Present
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      Entry Present:
      - "37"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 67593198-74ac-47f4-8aad-0f4174bdac27
      iscommand: false
      name: Is Entry Already Present?
      type: condition
      version: -1
    taskid: 67593198-74ac-47f4-8aad-0f4174bdac27
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1032.5,
          "y": 750
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: Fresh-Add_Count
      value:
        simple: ${Fresh-Add_Count=val+1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6f04f14c-b99e-49f8-8b1c-2bfdc881cb1e
      iscommand: false
      name: Update Fresh Add Count
      script: Set
      type: regular
      version: -1
    taskid: 6f04f14c-b99e-49f8-8b1c-2bfdc881cb1e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2690,
          "y": 2660
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2900,
        "width": 7115,
        "x": -440,
        "y": 50
      }
    }
  }
