contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 21ce8491-ba19-4813-8f99-f3764238e54d
inputs:
- description: ""
  key: ArcSight_ActiveListResourceID
  playbookInputQuery: null
  required: true
  value:
    simple: HpLsmQosBABD2dHC4lamu4Q==
- description: ""
  key: Arcsight_IP_AddressFieldName
  playbookInputQuery: null
  required: true
  value:
    simple: IPAddress
- description: ""
  key: Arcsight_IOC_VerdictFieldName
  playbookInputQuery: null
  required: true
  value:
    simple: Verdict
- description: ""
  key: Arcsight_Entry-ID_FieldName
  playbookInputQuery: null
  required: true
  value:
    simple: ID
- description: ""
  key: ArcSight_ExpirationStatusFieldName
  playbookInputQuery: null
  required: true
  value:
    simple: ExpirationStatus
- description: ""
  key: Arcsight_GeoCountryField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: GeoCountry
- description: ""
  key: Arcsight_GeoLocationField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: GeoLocation
- description: ""
  key: Arcsight_CountryNameField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: CountryName
- description: ""
  key: Arcsight_CountryCodeField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: CountryCode
- description: ""
  key: Arcsight_FirstSeenField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: FirstSeen
- description: ""
  key: Arcsight_LastSeenField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: LastSeen
- description: ""
  key: Arcsight_SourceBrandField_Name
  playbookInputQuery: null
  required: true
  value:
    simple: SourceBrands
- description: ""
  key: Arcsight_SourceInstanceField_Name
  playbookInputQuery: null
  required: true
  value:
    simple: SourceInstances
- description: ""
  key: Arcsight_MscoreField_Name
  playbookInputQuery: null
  required: false
  value:
    simple: Mscore
- description: ""
  key: Arcsight_CVSS_Score_Field_Name
  playbookInputQuery: null
  required: false
  value:
    simple: CVSSScore
- description: ""
  key: Arcsight_CVSS3Field_Name
  playbookInputQuery: null
  required: false
  value:
    simple: CVSS3
- description: ""
  key: Arcsight_MITRE_ID_Field_Name
  playbookInputQuery: null
  required: false
  value:
    simple: MitreID
- description: ""
  key: Arcsight_MITRE_Tactics_Field_Name
  playbookInputQuery: null
  required: false
  value:
    simple: MitreTactics
- description: ""
  key: Arcsight_KillChainPhases_Field_Name
  playbookInputQuery: null
  required: false
  value:
    simple: KillChainPhases
name: TIM - UBI Sub Playbook Add IP Indicators to Arcsight SIEM
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0eeac55b-3b93-4269-8547-9eb1e1fafb85
      iscommand: false
      name: ""
      version: -1
    taskid: 0eeac55b-3b93-4269-8547-9eb1e1fafb85
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 705,
          "y": 65
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: ArcSight ESM v2
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "2"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 12c9efa5-3f73-4c6d-88e6-ecd2d6279bcd
      iscommand: false
      name: Is ArcSight Enabled?
      type: condition
      version: -1
    taskid: 12c9efa5-3f73-4c6d-88e6-ecd2d6279bcd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 705,
          "y": 400
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.Arcsight_IP_AddressFieldName
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: inputs.Arcsight_IOC_VerdictFieldName
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: inputs.Arcsight_Entry-ID_FieldName
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: inputs.Arcsight_GeoCountryField_Name
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "3"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ef45f982-acae-47e0-81b8-acf75aebcff4
      iscommand: false
      name: Is there an ArcSight fields name and values?
      type: condition
      version: -1
    taskid: ef45f982-acae-47e0-81b8-acf75aebcff4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 2380
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 2
    scriptarguments:
      entries:
        simple: '[${Value}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
      retry-count:
        simple: "50"
      retry-interval:
        simple: "30"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ArcSight ESM v2
      description: Adds new entries to the Active List.
      id: b5624c72-cf2d-4cdc-8f1c-b58fa11863ba
      iscommand: true
      name: Add IP to ArcSight Active list block list
      script: ArcSight ESM v2|||as-add-entries
      type: regular
      version: -1
    taskid: b5624c72-cf2d-4cdc-8f1c-b58fa11863ba
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2190,
          "y": 2600
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 1
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: IOC Added to ArcSight SIEM
      indicatorsValues:
        simple: ${Value.IPAddress}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Adds the SIEM tag to the indicator.
      id: 2d65750d-65bf-450b-8cb1-7ab0e227b9d6
      iscommand: true
      name: Add SIEM tag
      script: Builtin|||appendIndicatorField
      type: regular
      version: -1
    taskid: 2d65750d-65bf-450b-8cb1-7ab0e227b9d6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2190,
          "y": 2780
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0ace0b55-bf08-4cb2-8fc8-6cd9dc2c4f85
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 0ace0b55-bf08-4cb2-8fc8-6cd9dc2c4f85
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 765,
          "y": 2885
        }
      }
  "13":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ArcSight_ActiveListResourceID
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "1"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 236bd767-6251-415e-8018-405844086858
      iscommand: false
      name: Are there Resource ID Present?
      type: condition
      version: -1
    taskid: 236bd767-6251-415e-8018-405844086858
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 705,
          "y": 225
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 1
    scriptarguments:
      entryFilter:
        simple: ${inputs.Arcsight_IP_AddressFieldName}:${Value.IPAddress},${inputs.Arcsight_Entry-ID_FieldName}:${Value.ID}
      ignore-outputs:
        simple: "false"
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
      retry-count:
        simple: "50"
      retry-interval:
        simple: "200"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns all entries in the Active List
      id: 78b1ce6a-fcee-4685-884a-533f3456e637
      iscommand: true
      name: Get Entry from ArcSight
      script: '|||as-get-entries'
      type: regular
      version: -1
    taskid: 78b1ce6a-fcee-4685-884a-533f3456e637
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1032.5,
          "y": 575
        }
      }
  "16":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].IPAddress}
          operator: isEqualString
          right:
            value:
              simple: ${Value.IP}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].FirstSeen}
          operator: isEqualString
          right:
            value:
              simple: ${FirstSeen_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].LastSeen}
          operator: isEqualString
          right:
            value:
              simple: ${LastSeen_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceBrands}
          operator: isEqualString
          right:
            value:
              simple: ${SourceBrand_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceInstances}
          operator: isEqualString
          right:
            value:
              simple: ${Source_Instance_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.ExpirationStatus_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CountryCode}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.code}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].GeoLocation}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.location}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CountryName}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.name}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Mscore}
          operator: isEqualNumber
          right:
            value:
              simple: ${raw.mscore}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Verdict}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.IOC_VerdictFieldValue}
      - - left:
            value:
              simple: ${Arcsight_ID}
          operator: isEqualNumber
          right:
            value:
              simple: ${inputs.Entry-ID_FieldValue}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].GeoCountry}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.code}
      label: Value Alerady Present
    - condition:
      - - left:
            value:
              simple: ${Arcsight_ID}
          operator: isEqualString
          right:
            value:
              simple: ${Value.id}
      label: For Fresh Entry
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ecfbd277-f208-4511-8536-b447f8e113f6
      iscommand: false
      name: Check all Data is Present?
      type: condition
      version: -1
    taskid: ecfbd277-f208-4511-8536-b447f8e113f6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 50
        }
      }
  "17":
    continueonerror: true
    continueonerrortype: errorPath
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "21"
      '#none#':
      - "19"
    note: false
    quietmode: 1
    scriptarguments:
      entries:
        simple: '[${ArcsightValue}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
      retry-count:
        simple: "50"
      retry-interval:
        simple: "200"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete entries from the Active List.
      id: dc83e06f-c4d2-4149-803e-2701f77ae8a3
      iscommand: true
      name: Delete Old Entry
      script: '|||as-delete-entries'
      type: regular
      version: -1
    taskid: dc83e06f-c4d2-4149-803e-2701f77ae8a3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1600
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: Delete_Count
      value:
        simple: ${Delete_Count=val+1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 644dfb8e-9c66-4439-8d2b-a72d69c97a25
      iscommand: false
      name: Update delete count
      script: Set
      type: regular
      version: -1
    taskid: 644dfb8e-9c66-4439-8d2b-a72d69c97a25
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1135,
          "y": 2115
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: Delete_Count_Error
      value:
        simple: ${Delete_Count_Error=val+1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f7b6c4ab-c37c-4346-88d3-230acc7f5c6d
      iscommand: false
      name: Update Delete_Count_Error
      script: Set
      type: regular
      version: -1
    taskid: f7b6c4ab-c37c-4346-88d3-230acc7f5c6d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -440,
          "y": 2020
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceBrands}
          operator: containsGeneral
          right:
            value:
              simple: ${SourceBrand_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceInstances}
          operator: containsGeneral
          right:
            value:
              simple: ${Source_Instance_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Verdict}
          operator: containsGeneral
          right:
            value:
              simple: ${inputs.IOC_VerdictFieldValue}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].FirstSeen}
          operator: containsGeneral
          right:
            value:
              simple: ${FirstSeen_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].LastSeen}
          operator: containsGeneral
          right:
            value:
              simple: ${LastSeen_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}
          operator: containsGeneral
          right:
            value:
              simple: ${inputs.ExpirationStatus_Value}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CountryCode}
          operator: containsGeneral
          right:
            value:
              simple: ${GeoCountry.code}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].GeoLocation}
          operator: containsGeneral
          right:
            value:
              simple: ${GeoCountry.location}
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Mscore}
          operator: containsGeneral
          right:
            value:
              simple: ${raw.mscore}
      label: Value Alerady Present
    - condition:
      - - left:
            value:
              simple: ${Result.[19]}
          operator: isEqualString
          right:
            value:
              simple: Active List has no entries
      label: Entry Not Present
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 37dcca73-51ba-4576-8f36-bc748fc57ccb
      iscommand: false
      name: Check all Data is Present?
      type: condition
      version: -1
    taskid: 37dcca73-51ba-4576-8f36-bc748fc57ccb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 50
        }
      }
  "23":
    continueonerror: true
    continueonerrortype: errorPath
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 1
    scriptarguments:
      entries:
        simple: '[{"${inputs.Arcsight_IP_AddressFieldName}":"${ArcSightESM.ActiveList.Entries.[0].IPAddress}","${inputs.Arcsight_IOC_VerdictFieldName}":"${ArcSightESM.ActiveList.Entries.[0].Verdict}","${inputs.Arcsight_SourceBrandField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceBrands}","${inputs.Arcsight_SourceInstanceField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceInstances}","${inputs.Arcsight_FirstSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].FirstSeen}","${inputs.Arcsight_LastSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].LastSeen}","${inputs.ArcSight_ExpirationStatusFieldName}":"${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}","${inputs.Arcsight_Entry-ID_FieldName}":"${ArcSightESM.ActiveList.Entries.[0].ID}","${inputs.Arcsight_GeoCountryField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_GeoLocationField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoLocation}","${inputs.Arcsight_CountryNameField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryName}","${inputs.Arcsight_CountryCodeField_Name}":"${{ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_MscoreField_Name}":"${ArcSightESM.ActiveList.Entries.[0].Mscore}"}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
      retry-count:
        simple: "50"
      retry-interval:
        simple: "300"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete entries from the Active List.
      id: 9a7af75a-202f-4448-8090-1539bfed57bf
      iscommand: true
      name: Delete Old Entry
      script: '|||as-delete-entries'
      type: regular
      version: -1
    taskid: 9a7af75a-202f-4448-8090-1539bfed57bf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2425,
          "y": 50
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].IPAddress}
          operator: isEqualString
          right:
            value:
              simple: ${Value.IP}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].FirstSeen}
          operator: isEqualString
          right:
            value:
              simple: ${FirstSeen_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].LastSeen}
          operator: isEqualString
          right:
            value:
              simple: ${LastSeen_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceBrands}
          operator: isEqualString
          right:
            value:
              simple: ${SourceBrand_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceInstances}
          operator: isEqualString
          right:
            value:
              simple: ${Source_Instance_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.ExpirationStatus_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CountryCode}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.code}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].GeoLocation}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.location}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CountryName}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.name}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Mscore}
          operator: isEqualNumber
          right:
            value:
              simple: ${raw.mscore}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Verdict}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.IOC_VerdictFieldValue}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ID}
          operator: isEqualNumber
          right:
            value:
              simple: ${inputs.Entry-ID_FieldValue}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].GeoCountry}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.code}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CVSSScore}
          operator: isEqualNumber
          right:
            value:
              simple: ${CVSSScore}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].CVSS3}
          operator: isEqualNumber
          right:
            value:
              simple: ${CVSS3 Score}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].MitreID}
          operator: isEqualString
          right:
            value:
              simple: ${Mitre Id}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].MitreTactics}
          operator: isEqualString
          right:
            value:
              simple: ${MitreTactics}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].KillChainPhases}
          operator: isEqualString
          right:
            value:
              simple: ${KillchainPhase}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ThreatTypes}
          operator: isEqualString
          right:
            value:
              simple: ${ThreatTypes}
      label: Value Alerady Present
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Result.[19]}
          operator: isEqualString
          right:
            value:
              simple: Active List has no entries
      label: Entry Not Present
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5a8ea11f-3315-4240-8e7a-e4c704aa29e3
      iscommand: false
      name: Check all Data is Present?
      type: condition
      version: -1
    taskid: 5a8ea11f-3315-4240-8e7a-e4c704aa29e3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 50
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].IPAddress}
          operator: isEqualString
          right:
            value:
              simple: ${Value.IP}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].ID}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.Entry-ID_FieldValue}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].SourceBrands}
          operator: isEqualString
          right:
            value:
              simple: ${SourceBrand_Value}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].SourceInstances}
          operator: isEqualString
          right:
            value:
              simple: ${Source_Instance_Value}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].Verdict}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.IOC_VerdictFieldValue}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].ExpirationStatus}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.ExpirationStatus_Value}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].FirstSeen}
          operator: isEqualString
          right:
            value:
              simple: ${FirstSeen_Value}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].LastSeen}
          operator: isEqualString
          right:
            value:
              simple: ${LastSeen_Value}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].Mscore}
          operator: isEqualString
          right:
            value:
              simple: ${raw.mscore}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].GeoCountry}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.code}
      - - left:
            value:
              simple: ${Arcsight_Get-Result.[19].GeoLocation}
          operator: isEqualString
          right:
            value:
              simple: ${GeoCountry.location}
      label: Entry Present
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e1d6ffa0-1810-4ce2-8b66-0d2b34d0859a
      iscommand: false
      name: Check all Data is Present?
      type: condition
      version: -1
    taskid: e1d6ffa0-1810-4ce2-8b66-0d2b34d0859a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3285,
          "y": 50
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].IPAddress}
          operator: isEqualString
          right:
            value:
              simple: ${Value.IP}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].EntryID}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.Entry-ID_FieldValue}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceBrands}
          operator: isEqualString
          right:
            value:
              simple: ${SourceBrand_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].SourceInstances}
          operator: isEqualString
          right:
            value:
              simple: ${Source_Instance_Value}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Verdict}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.IOC_VerdictFieldValue}
      - - left:
            iscontext: true
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}
          operator: isEqualString
          right:
            value:
              simple: ${inputs.ExpirationStatus_Value}
      label: Data Found
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b20789cb-47b2-4105-8d3d-3cba4f022d46
      iscommand: false
      name: Check all Data is Present?
      type: condition
      version: -1
    taskid: b20789cb-47b2-4105-8d3d-3cba4f022d46
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3715,
          "y": 50
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: Fresh-Add_Count
      value:
        simple: ${Fresh-Add_Count=val+1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d502c5c7-8086-4ad5-8500-d79e0b911140
      iscommand: false
      name: Update Fresh Add Count
      script: Set
      type: regular
      version: -1
    taskid: d502c5c7-8086-4ad5-8500-d79e0b911140
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2045,
          "y": 2115
        }
      }
  "28":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].ID}
          operator: in
          right:
            value:
              simple: ${Value.ID}
      label: ' For Fresh Entry'
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c5d566e0-3e8c-43d2-87ea-0376f86722ab
      iscommand: false
      name: Condition For Fresh Entry
      type: condition
      version: -1
    taskid: c5d566e0-3e8c-43d2-87ea-0376f86722ab
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4145,
          "y": 50
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 2
    scriptarguments:
      key:
        simple: Set Data For Deletion
      value:
        simple: ${Value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e153b93f-5563-4781-8f3c-22440bd357b3
      iscommand: false
      name: Set Data For Deletion
      script: Set
      type: regular
      version: -1
    taskid: e153b93f-5563-4781-8f3c-22440bd357b3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4575,
          "y": 50
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      key:
        simple: setxy
      value:
        complex:
          root: ${Set Data For Deletion}
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '["'
            operator: replace
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"]'
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4163d86d-3846-4bda-844a-c611df9ab347
      iscommand: false
      name: Set
      script: Set
      type: regular
      version: -1
    taskid: 4163d86d-3846-4bda-844a-c611df9ab347
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4575,
          "y": 225
        }
      }
  "31":
    continueonerror: true
    continueonerrortype: errorPath
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      entries:
        simple: '[{"${inputs.Arcsight_IP_AddressFieldName}":"${ArcSightESM.ActiveList.Entries.[0].IPAddress}","${inputs.Arcsight_IOC_VerdictFieldName}":"${ArcSightESM.ActiveList.Entries.[0].Verdict}","${inputs.Arcsight_SourceBrandField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceBrands}","${inputs.Arcsight_SourceInstanceField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceInstances}","${inputs.Arcsight_FirstSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].FirstSeen}","${inputs.Arcsight_LastSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].LastSeen}","${inputs.ArcSight_ExpirationStatusFieldName}":"${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}","${inputs.Arcsight_Entry-ID_FieldName}":"${ArcSightESM.ActiveList.Entries.[0].ID}","${inputs.Arcsight_GeoCountryField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_GeoLocationField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoLocation}","${inputs.Arcsight_CountryNameField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryName}","${inputs.Arcsight_CountryCodeField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryCode}","${inputs.Arcsight_MscoreField_Name}":"${ArcSightESM.ActiveList.Entries.[0].Mscore}"}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete entries from the Active List.
      id: f137ee4a-ac78-4586-8918-c6c32bca0295
      iscommand: true
      name: Delete Old Entry
      script: '|||as-delete-entries'
      type: regular
      version: -1
    taskid: f137ee4a-ac78-4586-8918-c6c32bca0295
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 5005,
          "y": 50
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 1
    scriptarguments:
      key:
        simple: RawArcsightVal
      value:
        simple: '{"${inputs.Arcsight_IP_AddressFieldName}":"${ArcSightESM.ActiveList.Entries.[0].IPAddress}","${inputs.Arcsight_IOC_VerdictFieldName}":"${ArcSightESM.ActiveList.Entries.[0].Verdict}","${inputs.Arcsight_SourceBrandField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceBrands}","${inputs.Arcsight_SourceInstanceField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceInstances}","${inputs.Arcsight_FirstSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].FirstSeen}","${inputs.Arcsight_LastSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].LastSeen}","${inputs.ArcSight_ExpirationStatusFieldName}":"${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}","${inputs.Arcsight_Entry-ID_FieldName}":"${ArcSightESM.ActiveList.Entries.[0].ID}","${inputs.Arcsight_GeoCountryField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_GeoLocationField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoLocation}","${inputs.Arcsight_CountryNameField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryName}","${inputs.Arcsight_CountryCodeField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryCode}","${inputs.Arcsight_MscoreField_Name}":"${ArcSightESM.ActiveList.Entries.[0].Mscore}"}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: fa8dc15f-6aa0-4881-8643-5255290aa5ff
      iscommand: false
      name: Set Get Arcsight Data
      script: Set
      type: regular
      version: -1
    taskid: fa8dc15f-6aa0-4881-8643-5255290aa5ff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1145,
          "y": 1100
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${ArcsightValue}
          operator: in
          right:
            value:
              simple: ${Value}
      label: Value Alerady Present
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      Value Alerady Present:
      - "6"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 173103a5-5a3b-42d8-84ae-7343bf6deafe
      iscommand: false
      name: Is Arcsight Val and Current val is same?
      type: condition
      version: -1
    taskid: 173103a5-5a3b-42d8-84ae-7343bf6deafe
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 1550
        }
      }
  "36":
    continueonerror: true
    continueonerrortype: errorPath
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "40"
      '#none#':
      - "34"
    note: false
    quietmode: 1
    scriptarguments:
      key:
        simple: ArcsightValue
      value:
        complex:
          root: ${RawArcsightVal}
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '["'
            operator: replace
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"]'
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 52666e49-9009-4e69-80cf-42b1630524ac
      iscommand: false
      name: Format Value
      script: Set
      type: regular
      version: -1
    taskid: 52666e49-9009-4e69-80cf-42b1630524ac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1145,
          "y": 1275
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].Mscore}
          operator: isNotEmpty
          right:
            value: {}
      label: Mscore Present
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "43"
      Mscore Present:
      - "33"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d1f554fb-3fcc-43fe-89d8-b8173d82f103
      iscommand: false
      name: Is Mscore Field is Present
      type: condition
      version: -1
    taskid: d1f554fb-3fcc-43fe-89d8-b8173d82f103
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1360,
          "y": 925
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      entries:
        simple: '[{"${inputs.Arcsight_IP_AddressFieldName}":"${Value.IP}","${inputs.Arcsight_IOC_VerdictFieldName}":"${inputs.IOC_VerdictFieldValue}","${inputs.Arcsight_SourceBrandField_Name}":"${SourceBrand_Value}","${inputs.Arcsight_SourceInstanceField_Name}":"${Source_Instance_Value}","${inputs.Arcsight_FirstSeenField_Name}":"${FirstSeen_Value}","${inputs.Arcsight_LastSeenField_Name}":"${LastSeen_Value}","${inputs.ArcSight_ExpirationStatusFieldName}":"${inputs.ExpirationStatus_Value}","${inputs.Arcsight_Entry-ID_FieldName}":"${inputs.Entry-ID_FieldValue}","${inputs.Arcsight_GeoCountryField_Name}":"${GeoCountry.code}","${inputs.Arcsight_GeoLocationField_Name}":"${GeoCountry.location}","${inputs.Arcsight_CountryNameField_Name}":"${GeoCountry.name}","${inputs.Arcsight_CountryCodeField_Name}":"${GeoCountry.code}","${inputs.Arcsight_MscoreField_Name}":"${raw.mscore}"}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ArcSight ESM v2
      description: Adds new entries to the Active List.
      id: edd45c15-e246-4c31-8ee0-356bc08090c8
      iscommand: true
      name: Add IP to ArcSight Active list block list
      script: ArcSight ESM v2|||as-add-entries
      type: regular
      version: -1
    taskid: edd45c15-e246-4c31-8ee0-356bc08090c8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 5435,
          "y": 50
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      key:
        simple: Set Data For Deletion
      value:
        simple: '[{"${inputs.Arcsight_IP_AddressFieldName}":"${ArcSightESM.ActiveList.Entries.[0].IPAddress}","${inputs.Arcsight_IOC_VerdictFieldName}":"${ArcSightESM.ActiveList.Entries.[0].Verdict}","${inputs.Arcsight_SourceBrandField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceBrands}","${inputs.Arcsight_SourceInstanceField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceInstances}","${inputs.Arcsight_FirstSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].FirstSeen}","${inputs.Arcsight_LastSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].LastSeen}","${inputs.ArcSight_ExpirationStatusFieldName}":"${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}","${inputs.Arcsight_Entry-ID_FieldName}":"${ArcSightESM.ActiveList.Entries.[0].ID}","${inputs.Arcsight_GeoCountryField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_GeoLocationField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoLocation}","${inputs.Arcsight_CountryNameField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryName}","${inputs.Arcsight_CountryCodeField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryCode}","${inputs.Arcsight_MscoreField_Name}":"${ArcSightESM.ActiveList.Entries.[0].Mscore}"}]'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 71b43168-574a-4053-8cc2-5c6d7f7ab478
      iscommand: false
      name: Set Data For Deletion
      script: Set
      type: regular
      version: -1
    taskid: 71b43168-574a-4053-8cc2-5c6d7f7ab478
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 5865,
          "y": 50
        }
      }
  "40":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${RawArcsightVal}
          operator: in
          right:
            value:
              simple: ${Value}
      label: Value Alerady Present
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "41"
      Value Alerady Present:
      - "6"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f7e00eb4-e812-4a9d-8ee5-3305bbce66cb
      iscommand: false
      name: Is Arcsight Val and Current val is same?
      type: condition
      version: -1
    taskid: f7e00eb4-e812-4a9d-8ee5-3305bbce66cb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1600
        }
      }
  "41":
    continueonerror: true
    continueonerrortype: errorPath
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "21"
      '#none#':
      - "19"
    note: false
    quietmode: 1
    scriptarguments:
      entries:
        simple: '[${RawArcsightVal}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
      retry-count:
        simple: "50"
      retry-interval:
        simple: "200"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete entries from the Active List.
      id: 8a3df6f9-f0f4-41a0-8a07-bd31e4972aec
      iscommand: true
      name: Delete Old Entry
      script: '|||as-delete-entries'
      type: regular
      version: -1
    taskid: 8a3df6f9-f0f4-41a0-8a07-bd31e4972aec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1820
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RawArcsightVal
      value:
        simple: '{"${inputs.Arcsight_IP_AddressFieldName}":"${ArcSightESM.ActiveList.Entries.[0].IPAddress}","${inputs.Arcsight_IOC_VerdictFieldName}":"${ArcSightESM.ActiveList.Entries.[0].Verdict}","${inputs.Arcsight_SourceBrandField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceBrands}","${inputs.Arcsight_SourceInstanceField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceInstances}","${inputs.Arcsight_FirstSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].FirstSeen}","${inputs.Arcsight_LastSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].LastSeen}","${inputs.ArcSight_ExpirationStatusFieldName}":"${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}","${inputs.Arcsight_Entry-ID_FieldName}":"${ArcSightESM.ActiveList.Entries.[0].ID}","${inputs.Arcsight_GeoCountryField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_GeoLocationField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoLocation}","${inputs.Arcsight_CountryNameField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryName}","${inputs.Arcsight_CountryCodeField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryCode}","${inputs.Arcsight_MscoreField_Name}":"${ArcSightESM.ActiveList.Entries.[0].Mscore}","${inputs.Arcsight_CVSS_Score_Field_Name}":"${ArcSightESM.ActiveList.Entries.[0].CVSSScore}","${inputs.Arcsight_CVSS3Field_Name}":"${ArcSightESM.ActiveList.Entries.[0].CVSS3}","${inputs.Arcsight_MITRE_ID_Field_Name}":"${ArcSightESM.ActiveList.Entries.[0].MitreID}","${inputs.Arcsight_MITRE_Tactics_Field_Name}":"${ArcSightESM.ActiveList.Entries.[0].MitreTactics}","${inputs.Arcsight_KillChainPhases_Field_Name}":"${ArcSightESM.ActiveList.Entries.[0].KillChainPhases}","${inputs.Arcsight_ThreatType_Field_Name}":"${ArcSightESM.ActiveList.Entries.[0].ThreatTypes}"}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 72f4e5c7-001b-4db2-8166-07d2169fba04
      iscommand: false
      name: Set Get Arcsight Data
      script: Set
      type: regular
      version: -1
    taskid: 72f4e5c7-001b-4db2-8166-07d2169fba04
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 6295,
          "y": 50
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 1
    scriptarguments:
      key:
        simple: RawArcsightVal
      value:
        simple: '{"${inputs.Arcsight_IP_AddressFieldName}":"${ArcSightESM.ActiveList.Entries.[0].IPAddress}","${inputs.Arcsight_IOC_VerdictFieldName}":"${ArcSightESM.ActiveList.Entries.[0].Verdict}","${inputs.Arcsight_SourceBrandField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceBrands}","${inputs.Arcsight_SourceInstanceField_Name}":"${ArcSightESM.ActiveList.Entries.[0].SourceInstances}","${inputs.Arcsight_FirstSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].FirstSeen}","${inputs.Arcsight_LastSeenField_Name}":"${ArcSightESM.ActiveList.Entries.[0].LastSeen}","${inputs.ArcSight_ExpirationStatusFieldName}":"${ArcSightESM.ActiveList.Entries.[0].ExpirationStatus}","${inputs.Arcsight_Entry-ID_FieldName}":"${ArcSightESM.ActiveList.Entries.[0].ID}","${inputs.Arcsight_GeoCountryField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoCountry}","${inputs.Arcsight_GeoLocationField_Name}":"${ArcSightESM.ActiveList.Entries.[0].GeoLocation}","${inputs.Arcsight_CountryNameField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryName}","${inputs.Arcsight_CountryCodeField_Name}":"${ArcSightESM.ActiveList.Entries.[0].CountryCode}"}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6e8a3bcc-0a57-4fe2-8d1f-afdb34af0a7f
      iscommand: false
      name: Set Get Arcsight Data
      script: Set
      type: regular
      version: -1
    taskid: 6e8a3bcc-0a57-4fe2-8d1f-afdb34af0a7f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1575,
          "y": 1100
        }
      }
  "44":
    continueonerror: true
    continueonerrortype: errorPath
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "45"
      '#none#':
      - "34"
    note: false
    quietmode: 1
    scriptarguments:
      key:
        simple: ArcsightValue
      value:
        complex:
          root: ${RawArcsightVal}
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '["'
            operator: replace
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"]'
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 11f5e7a8-812a-44cd-8822-8df117c3610d
      iscommand: false
      name: Format Value
      script: Set
      type: regular
      version: -1
    taskid: 11f5e7a8-812a-44cd-8822-8df117c3610d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1575,
          "y": 1275
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${RawArcsightVal}
          operator: in
          right:
            value:
              simple: ${Value}
      label: Value Alerady Present
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "46"
      Value Alerady Present:
      - "6"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8d04634c-fbf5-43e2-8c6f-87c88a5b2497
      iscommand: false
      name: Is Arcsight Val and Current val is same?
      type: condition
      version: -1
    taskid: 8d04634c-fbf5-43e2-8c6f-87c88a5b2497
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 1655
        }
      }
  "46":
    continueonerror: true
    continueonerrortype: errorPath
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "21"
      '#none#':
      - "19"
    note: false
    quietmode: 1
    scriptarguments:
      entries:
        simple: '[${RawArcsightVal}]'
      resourceId:
        simple: ${inputs.ArcSight_ActiveListResourceID}
      retry-count:
        simple: "50"
      retry-interval:
        simple: "200"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete entries from the Active List.
      id: b6fdade5-4e69-47ec-83a8-90ed7da5de44
      iscommand: true
      name: Delete Old Entry
      script: '|||as-delete-entries'
      type: regular
      version: -1
    taskid: b6fdade5-4e69-47ec-83a8-90ed7da5de44
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 1820
        }
      }
  "47":
    conditions:
    - condition:
      - - left:
            value:
              simple: ${ArcSightESM.ActiveList.Entries.[0].IPAddress}
          operator: isEqualString
          right:
            value:
              simple: ${Value.IPAddress}
      label: Entry Present
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      Entry Present:
      - "37"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 08b045b8-8ea5-4009-84e6-69f1e9af36b1
      iscommand: false
      name: Is Entry Already Present?
      type: condition
      version: -1
    taskid: 08b045b8-8ea5-4009-84e6-69f1e9af36b1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1032.5,
          "y": 750
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: Fresh-Add_Count
      value:
        simple: ${Fresh-Add_Count=val+1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: ab0a70d5-946f-4091-8e4c-ecb8eea2fb39
      iscommand: false
      name: Update Fresh Add Count
      script: Set
      type: regular
      version: -1
    taskid: ab0a70d5-946f-4091-8e4c-ecb8eea2fb39
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2690,
          "y": 2660
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2900,
        "width": 7115,
        "x": -440,
        "y": 50
      }
    }
  }
