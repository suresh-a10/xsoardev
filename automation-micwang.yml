commonfields:
  id: 3d5b20e0-b65c-4325-8276-ce762c7dbc15
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.10.13.89873
enabled: true
engineinfo: {}
mainengineinfo: {}
name: micwang
pswd: ""
runas: DBotWeakRole
runonce: false
script: |-
  import requests
  import urllib3
  import json
  urllib3.disable_warnings()

  api_key = "5A73CF291A11684143514E13F6A1E6E0"
  incident_id = demisto.incidents()[0]['id']
  demisto_urls = demisto.demistoUrls()
  server_url = demisto_urls['server']

  headers = {
      'Authorization': api_key,
      'Content-Type': 'application/json'
  }

  data = {
      "pageSize":100,
      "lastId":"",
      "categories":["attachments"],
      "tags":[],
      "users":[]
  }

  r = requests.post(f'{server_url}/investigation/{incident_id}', data=json.dumps(data), headers=headers, verify=False)
  response_json = r.json()
  users = response_json['users']
  demisto.results(response_json)
scripttarget: 0
subtype: python3
tags: []
type: python
