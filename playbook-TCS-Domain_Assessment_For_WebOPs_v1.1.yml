contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
hidden: true
id: b5b2da76-077d-4d7b-846b-01a7704ccc79
inputs: []
name: TCS-Domain Assessment For WebOPs v1.1
outputs: []
sourceplaybookid: 08c3b260-77a7-4316-8c5d-802cc55f4e22
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 487b5493-9017-4a66-8e6a-d2a40450cfc9
      iscommand: false
      name: ""
      version: -1
    taskid: 487b5493-9017-4a66-8e6a-d2a40450cfc9
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 460,
          "y": -510
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3e2dd4d5-eea1-47a8-8ec6-2fd291e244f2
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 3e2dd4d5-eea1-47a8-8ec6-2fd291e244f2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 570,
          "y": 1420
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name:
        simple: IOC Threat Intel
      type:
        simple: pdf
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: a370cf94-0e49-4d85-847d-b4baba1d2ced
      iscommand: false
      name: Generate Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: a370cf94-0e49-4d85-847d-b4baba1d2ced
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 640
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${InfoFile.EntryID}
      body:
        simple: |-
          Hello Human,

          The Domain is found CLEAN and can be allowed in our environment.

          Listed URLs are ${ExtractedIndicators.Domain_Test_}.

          PFA  Investigation Summary Report for Incident ${incident.id}


          Regards,
          CSOC Cyber Bot
      cc:
        simple: internalis.cybersecurityops@tcs.com,yogesh.gholap@tcs.com,kunal.krushev@tcs.com
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: WebOps URL Investigation Summary - ${incident.id}-URL found CLEAN
      to:
        simple: InternalIS.SecOpsL2Support@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 6c8e88fa-93a4-4264-88c3-518430e986cb
      iscommand: true
      name: Email Report Summary For Clean URL
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 6c8e88fa-93a4-4264-88c3-518430e986cb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 790,
          "y": 1240
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${InfoFile.EntryID}
      body:
        simple: |-
          Hello Human,

          The Domain found is SUSPICIOUS and cannot  be allowed in our environment.

          Submitted URL : ${ExtractedIndicators.Domain_Test_}

          Suspicious URL : ${SuspiciousDomainRF}

          PFA  Investigation Summary Report for Incident ${incident.id}


          Regards,
          CSOC Cyber Bot
      cc:
        simple: internalis.cybersecurityops@tcs.com,yogesh.gholap@tcs.com,kunal.krushev@tcs.com
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: WebOps URL Investigation Summary - ${incident.id} found Suspicious
      to:
        simple: InternalIS.SecOpsL2Support@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: f56abb37-0776-43c8-8fa6-8f5094d5b2d0
      iscommand: true
      name: Email Report Summary For Malicious URL To Yogesh and Kunal
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: f56abb37-0776-43c8-8fa6-8f5094d5b2d0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1240
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 52d2bc5d-a5d3-4654-8fae-86eebb8fd9d6
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 52d2bc5d-a5d3-4654-8fae-86eebb8fd9d6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 570,
          "y": 1560
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 03688f03-4b23-4fd3-8512-bb784bf2ad3f
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 03688f03-4b23-4fd3-8512-bb784bf2ad3f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 570,
          "y": 1730
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: fe9fc41d-f566-4200-8799-3664b84c155c
      iscommand: true
      name: Recorded Future Enrichment
      script: Recorded Future v2|||domain
      type: regular
      version: -1
    taskid: fe9fc41d-f566-4200-8799-3664b84c155c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 370
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Investigate
      description: Get Domain Reputation info using Cisco Umbrella Investigate. Domain
        reputation score is either true or false from the service and cannot be modified
        using a threshold.
      id: 3d722742-4be0-453d-8295-cb0abfed8ebc
      iscommand: true
      name: Cisco Umbrella Enrichment
      script: Cisco Umbrella Investigate|||domain
      type: regular
      version: -1
    taskid: 3d722742-4be0-453d-8295-cb0abfed8ebc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 510
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: fc21be9f-88ac-48a9-84c2-85a4f1739484
      iscommand: true
      name: Extract indicator from file
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: fc21be9f-88ac-48a9-84c2-85a4f1739484
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": -170
        }
      }
  "76":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_}
          operator: containsString
          right:
            value:
              simple: quest
        - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_}
          operator: containsString
          right:
            value:
              simple: slack
      label: "yes"
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eb8ec880-8ae1-4be3-8cb0-309e9e6915ab
      iscommand: false
      name: Check if domain belongs to Quest or slack
      type: condition
      version: -1
    taskid: eb8ec880-8ae1-4be3-8cb0-309e9e6915ab
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": 160
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: 4c3ae19b-3b00-46a4-8e9e-eeb5a65854da
      iscommand: true
      name: Recorded Future Enrichment
      script: Recorded Future v2|||domain
      type: regular
      version: -1
    taskid: 4c3ae19b-3b00-46a4-8e9e-eeb5a65854da
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 370
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Investigate
      description: Get Domain Reputation info using Cisco Umbrella Investigate. Domain
        reputation score is either true or false from the service and cannot be modified
        using a threshold.
      id: a3e8f462-965a-47df-8b0e-9ba7bb12d209
      iscommand: true
      name: Cisco Umbrella Enrichment
      script: Cisco Umbrella Investigate|||domain
      type: regular
      version: -1
    taskid: a3e8f462-965a-47df-8b0e-9ba7bb12d209
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 520
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "80"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name:
        simple: IOC Threat Intel
      type:
        simple: pdf
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: c5d02f64-94d0-44f5-82ce-f0ee6f0490b9
      iscommand: false
      name: Generate Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: c5d02f64-94d0-44f5-82ce-f0ee6f0490b9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 700
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${InfoFile.EntryID}
      body:
        simple: "Hello Human,\n\nThe Domain found contain Slack or Quest domain. Please
          take necessary action.\n\nDomain is ${ExtractedIndicators.Domain_Test_}
          \n\nPFA  Investigation Summary Report for Incident ${incident.id}\n\n\nRegards,\nCSOC
          Cyber Bot"
      cc:
        simple: sonam.bhandari@tcs.com , InternalIS.SecOpsL2Support@tcs.com
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: WebOps URL Investigation Summary - ${incident.id} contain Slack or
          Quest
      to:
        simple: yogesh.gholap@tcs.com,kunal.krushev@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 53c265bb-cd21-41b4-8499-5c52cd3e5c2f
      iscommand: true
      name: Email Report Summary For  URL contains Slack or Quest
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 53c265bb-cd21-41b4-8499-5c52cd3e5c2f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -160,
          "y": 1240
        }
      }
  "81":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_.}
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "82"
      "yes":
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d2192bbb-4f11-49f8-8812-446acdd5da00
      iscommand: false
      name: Are there domain
      type: condition
      version: -1
    taskid: d2192bbb-4f11-49f8-8812-446acdd5da00
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": -10
        }
      }
  "82":
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${.=val.File.filter(function(f){return f.EntryID;}).reduce(function(acc,
          f) {return f;}, null).EntryID}
      body:
        simple: |-
          Hello Human,

          I am unable to serve you as there is no attachment  in the email.


          Regards,
          CSOC Cyber Bot
      cc:
        simple: internalis.cybersecurityops@tcs.com,yogesh.gholap@tcs.com,kunal.krushev@tcs.com
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: WebOps URL Investigation Summary - ${incident.id} No URL present in
          email
      to:
        simple: InternalIS.SecOpsL2Support@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 484f676a-b5dd-4d4d-8fe7-0be8d6120e3f
      iscommand: true
      name: Email team no URL to investigate
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 484f676a-b5dd-4d4d-8fe7-0be8d6120e3f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 1190
        }
      }
  "83":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: InternalIS.SecOpsL2Support@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: sonam.bhandari@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: v.ghule@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: kunal.krushev@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: yogesh.gholap@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: komal.lugade@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: internalis.cyberops@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "84"
      "yes":
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 4925af29-e005-4884-84c9-aea19905b15e
      iscommand: false
      name: Is the email from Authorized sender ?
      type: condition
      version: -1
    taskid: 4925af29-e005-4884-84c9-aea19905b15e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": -380
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${.=val.File.filter(function(f){return f.EntryID;}).reduce(function(acc,
          f) {return f;}, null).EntryID}
      body:
        simple: |-
          Hello Human,

          You are not an authorized sender . Please send email from "InternalIS.SecOpsL2Support@tcs.com"


          Regards,
          CSOC Cyber Bot
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: Not an Authorized Sender
      to:
        simple: ${incident.labels.Email/from}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: b6d49ef8-5154-4409-813c-46542bcb5062
      iscommand: true
      name: Not an authorised sender
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: b6d49ef8-5154-4409-813c-46542bcb5062
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1650,
          "y": 1190
        }
      }
  "85":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${SuspiciousDomainRF}
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: ${SuspiciousDomainUmbrella}
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "31"
      "yes":
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 59567aa3-9756-4ec9-819f-0eaf220c840d
      iscommand: false
      name: If Risk score is not Zero
      type: condition
      version: -1
    taskid: 59567aa3-9756-4ec9-819f-0eaf220c840d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1065
        }
      }
  "86":
    continueonerror: true
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "87"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SuspiciousDomainRF
      value:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.Domain.riskScore
              operator: isNotEqualNumber
              right:
                value:
                  simple: "0"
          root: RecordedFuture.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: adf0e4b9-048f-4583-878c-8e68452365ae
      iscommand: false
      name: Set SuspiciousDomainRF
      script: Set
      type: regular
      version: -1
    taskid: adf0e4b9-048f-4583-878c-8e68452365ae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 780
        }
      }
  "87":
    continueonerror: true
    continueonerrortype: ""
    id: "87"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "85"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SuspiciousDomainUmbrella
      value:
        complex:
          accessor: Name}
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ${Domain.Umbrella.RiskScore}
              operator: isNotEqualNumber
              right:
                value:
                  simple: "0"
          root: ${Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: cf993a2f-732b-4428-8ca3-fd29b47cdf50
      iscommand: false
      name: Set SuspiciousDomainUmbrella
      script: Set
      type: regular
      version: -1
    taskid: cf993a2f-732b-4428-8ca3-fd29b47cdf50
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 920
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2305,
        "width": 2190,
        "x": -160,
        "y": -510
      }
    }
  }
