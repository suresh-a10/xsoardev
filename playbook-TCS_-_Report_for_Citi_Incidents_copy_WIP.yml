contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 043ec0ed-813b-4b7d-8cfa-b8d636f634c4
inputs: []
name: TCS - Report for Citi Incidents_copy WIP
outputs: []
sourceplaybookid: 3cbf011e-2688-4e25-8aa0-ef51e8124dd9
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d9aa19ed-7c6b-4502-8325-5dd67a9e9e2f
      iscommand: false
      name: ""
      version: -1
    taskid: d9aa19ed-7c6b-4502-8325-5dd67a9e9e2f
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 670,
          "y": -150
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: csv
          root: File
      body:
        simple: "Hi All , \n\nThe list of incidents triggered for Citi Project is
          as follows : ${lists.List of Citi Offences Triggered}. \n\nNote: Severity
          is represented as numbers in the sheet. \n1-Low \n2-Medium \n3-High \n4-Critical\n\nRegards\nCyberBot"
      subject:
        simple: List of Citi Offences Triggered
      to:
        simple: nimisha.prajapati@tcs.com,internalis.cybersecurity@tcs.com,TCSCiti.MIS@tcs.com
      using:
        simple: EWS Mail Sender_Autobot
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: a6b5cf18-bea2-4860-8a72-8b5d09f31f42
      iscommand: true
      name: Email report for citi offences triggered
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: a6b5cf18-bea2-4860-8a72-8b5d09f31f42
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: eb102a70-c9b0-4e20-8497-58d85be7ffef
      iscommand: true
      name: Close investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: eb102a70-c9b0-4e20-8497-58d85be7ffef
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a7f2ae1e-33e9-49d4-8e86-e62ca0e1e8e8
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: a7f2ae1e-33e9-49d4-8e86-e62ca0e1e8e8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 670,
          "y": 720
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      entryid:
        simple: ${File.EntryID}
      filename:
        simple: CitiIncidentDetails.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Script to convert a War Room output JSON File to a CSV file.
      id: 323fb316-a98d-4674-8ae2-1b31ea0ba4c7
      iscommand: false
      name: convert to CSV
      script: JSONFileToCSV
      type: regular
      version: -1
    taskid: 323fb316-a98d-4674-8ae2-1b31ea0ba4c7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: CitiID
      value:
        complex:
          accessor: List of Citi Offences Triggered
          root: lists
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' or id:'
              toReplace:
                value:
                  simple: ','
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f1ae5e1f-5029-4fd5-8a53-8da16e48d1a0
      iscommand: false
      name: CitiID Format
      script: Set
      type: regular
      version: -1
    taskid: f1ae5e1f-5029-4fd5-8a53-8da16e48d1a0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 20
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      outputFormat:
        simple: json
      populateFields:
        simple: id,name,type,owner,status,severity,occurred,closed,investigationconclusion,investigationanalysis
      query:
        simple: id:${CitiID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a list of incident objects and the associated incident outputs
        that match the specified query and filters. The results are returned in a
        structured data file.
      id: 12d6bb88-92f1-48d1-80c0-cbfa19782cb6
      iscommand: false
      name: Generate Report
      script: 49d7a09e-d349-4c1a-8eb1-67ef241b3cd1
      type: regular
      version: -1
    taskid: 12d6bb88-92f1-48d1-80c0-cbfa19782cb6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 210
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: csv
          root: File
      body:
        simple: "Hi All , \n\nThe list of incidents triggered for Citi Project is
          as follows : ${lists.List of Citi Offences Triggered}. \n\nNote: Severity
          and Status of the incidents are represented as numbers in the sheet.\nSeverity:
          1-Low, 2-Medium, 3-High, 4-Critical\nStatus: 1-Active, 2-Closed\n\nRegards\nCyberBot"
      subject:
        simple: List of Citi Offences Triggered
      to:
        simple: porkodi.g@tcs.com
      using:
        simple: EWS Mail Sender_Autobot
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 2d6ddc83-e551-440c-8134-8687b7ca2529
      iscommand: true
      name: Email report for citi offences triggered
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 2d6ddc83-e551-440c-8134-8687b7ca2529
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 360
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      add_fields_to_context:
        simple: id,name,type,severity,status,owner
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Searches Cortex XSOAR Incidents and returnrs the most relevant
        fields. Default search range is the last 30 days, if you want to change this,
        use the fromDate argument. \n\nReturns the id, name, type, severity, status,
        owner, and created/closed times to context.  You can add additional fields
        using the add_field_to_context argument.\n\nThis automation runs using the
        default Limited User role, unless you explicitly change the permissions.  Based
        on the SearchIncidentsV2 from the Common Scripts pack, but more efficient."
      id: 678f26a7-5f2f-4649-80da-afc1895ee8f0
      iscommand: false
      name: Get Report of Citi Incidents
      script: SearchIncidentsSummary
      type: regular
      version: -1
    taskid: 678f26a7-5f2f-4649-80da-afc1895ee8f0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 10
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${foundIncidents}
      fileName:
        simple: sample.csv
      headers:
        simple: id,name,type,severity,status,owner
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 9a1fe3d5-1270-4e36-8032-34bec9a9b5df
      iscommand: false
      name: Export Required Fields To CSV
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 9a1fe3d5-1270-4e36-8032-34bec9a9b5df
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 180
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: aa5537c3-f834-453c-8694-994662d21ca8
      iscommand: true
      name: Close investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: aa5537c3-f834-453c-8694-994662d21ca8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 545
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 965,
        "width": 1000,
        "x": 50,
        "y": -150
      }
    }
  }
