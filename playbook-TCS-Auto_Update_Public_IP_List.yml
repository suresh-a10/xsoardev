contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
hidden: true
id: ed98db31-3731-4562-8f7d-076aa58c0223
inputs: []
name: 'TCS-Auto Update Public IP List '
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7a565f7b-6ce9-41a3-8b64-3906683ccaac
      iscommand: false
      name: ""
      version: -1
    taskid: 7a565f7b-6ce9-41a3-8b64-3906683ccaac
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 50,
          "y": -120
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f4b74ec9-7aa1-45a7-8491-83791063e1b7
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: f4b74ec9-7aa1-45a7-8491-83791063e1b7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${PublicIPList}
      listName:
        simple: TCS Public IP Addresses
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: d1931c6c-1942-482d-8e19-d0c23f444219
      iscommand: true
      name: Update Public IP address list  in Demisto
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: d1931c6c-1942-482d-8e19-d0c23f444219
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 715
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      entryId:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: xls
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: The automation takes Excel file (entryID) as an input and parses
        its content to the war room and context
      id: c35d3a07-0f41-4bdf-8f1f-ab3f1d863e1b
      iscommand: false
      name: Parse excel
      script: ParseExcel
      type: regular
      version: -1
    taskid: c35d3a07-0f41-4bdf-8f1f-ab3f1d863e1b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 190
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${ParseExcel.Public_ip}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: bff88a17-3760-4684-86a1-0a6131c1b224
      iscommand: false
      name: Are there Private IP Addresses
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: bff88a17-3760-4684-86a1-0a6131c1b224
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 355
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: "Hi All ,\n\nThis is to confirm you that the Public IP inventory received
          today was successfully updated in XSOAR  and Qradar\n\nThanks \nCSOC CyberAutoBot"
      subject:
        simple: ' TCS Public  IP Inventory  Updated Successfully'
      to:
        simple: sonam.bhandari@tcs.com , gayathri.pulla@tcs.com, v.ghule@tcs.com,Kunal.krushev@tcs.com,vaitheki.s@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 58777b1f-c137-48a2-8735-0e809219830d
      iscommand: true
      name: Send confirmation
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 58777b1f-c137-48a2-8735-0e809219830d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1240
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: PublicIPList
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 55c6a9da-eefa-45a4-818b-ba7992cf0466
      iscommand: false
      name: Set Public IP  to Context
      script: Set
      type: regular
      version: -1
    taskid: 55c6a9da-eefa-45a4-818b-ba7992cf0466
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 540
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: TCS_Public IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Information about the reference set that had data added or updated.
        This returns the information set, but not the contained data. This feature
        is supported from version 8.1 and upward.
      id: 6655353e-8242-41bf-827c-15994bdc811e
      iscommand: true
      name: ' Qradar Fetch Reference Set details for TCS Public IP'
      script: QRadar_v2_copy|||qradar-get-reference-by-name
      type: regular
      version: -1
    taskid: 6655353e-8242-41bf-827c-15994bdc811e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 910
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: TCS_Public IP
      value:
        simple: ${PublicIPList}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Add or update a value in a reference set.
      id: 4d8a6d08-54aa-44b8-84cc-f93378d772e8
      iscommand: true
      name: Update the Latest IP  addresses
      script: QRadar_v2_copy|||qradar-create-reference-set-value
      type: regular
      version: -1
    taskid: 4d8a6d08-54aa-44b8-84cc-f93378d772e8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1080
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: vaitheki.s@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: sonam.bhandari@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: da30d105-41f2-4538-8050-d07ed467ca80
      iscommand: false
      name: Is email from Authorized Sender?
      type: condition
      version: -1
    taskid: da30d105-41f2-4538-8050-d07ed467ca80
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 30
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 5dec9858-a82f-41f3-81b1-905860dd2e90
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 5dec9858-a82f-41f3-81b1-905860dd2e90
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1570
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d6d0723a-7834-4259-88b9-d656769c98b9
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: d6d0723a-7834-4259-88b9-d656769c98b9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1740
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1925,
        "width": 380,
        "x": 50,
        "y": -120
      }
    }
  }
