contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 8fd8fc49-89cf-4fba-857e-a4d9bfd0b697
inputs: []
name: TCS-Block-CyberSOC Shared IOC v2_KK_copy
outputs: []
sourceplaybookid: 0a608f75-4154-430b-81e0-3a7bc08ad2e0
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "113"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6d8b49cb-4738-4e86-8ad6-e9c2c62106a2
      iscommand: false
      name: ""
      version: -1
    taskid: 6d8b49cb-4738-4e86-8ad6-e9c2c62106a2
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 900,
          "y": -1545
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "120"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3a2b6fd0-7708-4b66-81d1-091671a10066
      iscommand: false
      name: Report & Notify
      type: title
      version: -1
    taskid: 3a2b6fd0-7708-4b66-81d1-091671a10066
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": 2250
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: SIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8c220727-23e9-4211-8839-2dd9a4deb9ec
      iscommand: false
      name: Is There IP Address For Blocking?
      type: condition
      version: -1
    taskid: 8c220727-23e9-4211-8839-2dd9a4deb9ec
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -720,
          "y": 260
        }
      }
  "11":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: SIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "91"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: efbce7fe-dfb7-4376-8de1-3cdbdf526e63
      iscommand: false
      name: Are There Domains For Blocking?
      type: condition
      version: -1
    taskid: efbce7fe-dfb7-4376-8de1-3cdbdf526e63
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 260
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: a52b1648-1554-4f1b-84a5-27da5a5effd2
      iscommand: false
      name: Delete IP Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: a52b1648-1554-4f1b-84a5-27da5a5effd2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 900,
          "y": -500
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: COSCBlockDomain,emailblock
      type:
        simple: Domain
      value:
        simple: ${SIXFIVE.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 857abcbd-9c28-4913-8036-a75c699a1430
      iscommand: true
      name: Tag 'CSOC' and 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 857abcbd-9c28-4913-8036-a75c699a1430
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1770
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: SIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9b3bc74b-df1b-4cf1-8aa5-c32cf89a6966
      iscommand: false
      name: Is There URL For Blocking?
      type: condition
      version: -1
    taskid: 9b3bc74b-df1b-4cf1-8aa5-c32cf89a6966
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1790,
          "y": 280
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "84"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: COSCBlockURL
      type:
        simple: URL
      value:
        simple: ${SIXFIVE.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: feba321c-6f5a-4ad1-8f55-5cc620d719c9
      iscommand: true
      name: Tag 'CSOC' Bad URL Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: feba321c-6f5a-4ad1-8f55-5cc620d719c9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1990,
          "y": 1030
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: Domain
          root: SIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: cfb2e7a5-7880-4fd2-8f7b-75c6dc22c547
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: cfb2e7a5-7880-4fd2-8f7b-75c6dc22c547
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 755
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "105"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: URL
          root: SIXFIVE
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: d5a82ad5-3ed2-47bb-807e-f0f093de5176
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: d5a82ad5-3ed2-47bb-807e-f0f093de5176
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1990,
          "y": 650
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3d16bbf0-0f56-4be7-875f-d54a6c9b58f4
      iscommand: false
      name: TCS-Domain Verification_IOC Blockingv1.0_Kunal
      playbookId: edaf9cc5-214c-458f-8615-f243c7b5b17c
      type: playbook
      version: -1
    taskid: 3d16bbf0-0f56-4be7-875f-d54a6c9b58f4
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 900,
          "y": -320
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${SIXFIVE.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f7b7c4ca-63c2-45ff-8220-80a70f6216b7
      iscommand: false
      name: TCS-Add New CSOC IP Indicator v1.0_Kunal
      playbookId: e653e5ab-6658-4f7a-806d-6a79d92d5d98
      type: playbook
      version: -1
    taskid: f7b7c4ca-63c2-45ff-8220-80a70f6216b7
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: playbook
    view: |-
      {
        "position": {
          "x": -720,
          "y": 440
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: File
                root: SIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 657d45f8-3a94-4ea2-8abd-413ee866d58e
      iscommand: false
      name: Is There Hash For Blocking ?
      type: condition
      version: -1
    taskid: 657d45f8-3a94-4ea2-8abd-413ee866d58e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2490,
          "y": 290
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 5
    nexttasks:
      '#none#':
      - "85"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        complex:
          accessor: File
          root: SIXFIVE
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3ee7404e-68f1-49bf-8ca2-bdd77e0b331c
      iscommand: false
      name: TCS-CSOC Block Malicious Hash on CS v1.0_Kunal
      playbookId: 9d6b9cb3-059d-4b12-865c-f73bed1daa8a
      type: playbook
      version: -1
    taskid: 3ee7404e-68f1-49bf-8ca2-bdd77e0b331c
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: playbook
    view: |-
      {
        "position": {
          "x": 2490,
          "y": 640
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: Domain
          root: SIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 0469cc96-2903-47f8-86d6-c5e3af8be557
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 0469cc96-2903-47f8-86d6-c5e3af8be557
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 905
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: URL
          root: SIXFIVE
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 4667075a-b640-4022-8563-df956742254c
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 4667075a-b640-4022-8563-df956742254c
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1990,
          "y": 460
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "11"
      - "10"
      - "32"
      - "45"
      - "99"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      File:
        complex:
          accessor: File
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      MD5:
        complex:
          accessor: MD5
          root: File
          transformers:
          - operator: uniq
      SHA1:
        complex:
          accessor: SHA1
          root: File
          transformers:
          - operator: uniq
      SHA256:
        complex:
          accessor: SHA256
          root: File
          transformers:
          - operator: uniq
      URL:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Entity Reputation using sub-playbooks
      id: 903d1d9b-ebe8-41ae-80d6-20fec01f6ebb
      iscommand: false
      name: TCS-Recorded Future IOC Reputation_v2_KK
      playbookId: 03487cba-86c9-4b9b-8a78-3805d1df14e3
      type: playbook
      version: -1
    taskid: 903d1d9b-ebe8-41ae-80d6-20fec01f6ebb
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 900,
          "y": 50
        }
      }
  "72":
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "103"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #ff00ff;">IoCs
          With Risk Score Below 65 Have Been Submitted For L2 Review</span><br /></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 6cad5486-e618-47df-8155-4ed75c8ac615
      iscommand: true
      name: IoCs With Risk Score Below 65 Have Been Submitted For L2 Review
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6cad5486-e618-47df-8155-4ed75c8ac615
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": 440
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: ISO
      dateFormat:
        simple: ISO
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: 6bd47b5a-55b7-4988-8c34-426f1e53cf32
      iscommand: false
      name: Set Current Time In Context
      script: GetTime
      type: regular
      version: -1
    taskid: 6bd47b5a-55b7-4988-8c34-426f1e53cf32
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 900,
          "y": -140
        }
      }
  "80":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: manual
      label: Manual
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isNotEqualString
          right:
            value:
              simple: manual
      label: Tool
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d570f7e9-4993-4ce9-823f-79fd3154f074
      iscommand: false
      name: Is This Email Triggered ?
      type: condition
      version: -1
    taskid: d570f7e9-4993-4ce9-823f-79fd3154f074
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 2050
        }
      }
  "82":
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_StandardRiskScore_IP
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        simple: ${SIXFIVE.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: ad4479ee-2612-4bd0-8ba1-6b1356ffd226
      iscommand: true
      name: Update IP address Reference set "TCS_IOC_StandardRiskScore_IP"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: ad4479ee-2612-4bd0-8ba1-6b1356ffd226
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -720,
          "y": 1195
        }
      }
  "83":
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_StandardRiskScore_Domain
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        simple: ${SIXFIVE.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: 5850c226-11fc-4315-8e50-debc9ee89057
      iscommand: true
      name: Update IP address Reference set "TCS_StandardRiskScore_Domain"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: 5850c226-11fc-4315-8e50-debc9ee89057
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 2050
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_StandardRiskScore_Domain
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        simple: ${SIXFIVE.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: 90d9a8b5-c0d7-40ca-89e4-bfa69347c208
      iscommand: true
      name: Update IP address Reference set "TCS_StandardRiskScore_Domain"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: 90d9a8b5-c0d7-40ca-89e4-bfa69347c208
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1990,
          "y": 1205
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_StandardRiskScore_Hash
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        simple: ${SIXFIVE.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: 1ab8bbd9-781b-4947-8e0d-836e01ba12d3
      iscommand: true
      name: Update IP address Reference set "TCS_StandardRiskScore_Hash"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: 1ab8bbd9-781b-4947-8e0d-836e01ba12d3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2490,
          "y": 880
        }
      }
  "86":
    continueonerror: true
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "87"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_132
      ip:
        simple: ${SIXFIVE.IP}
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 9eb343df-8da2-4c42-8171-df837bbf8d15
      iscommand: true
      name: block IP on Zscaler Corporate tenant
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 9eb343df-8da2-4c42-8171-df837bbf8d15
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -720,
          "y": 620
        }
      }
  "87":
    continueonerror: true
    continueonerrortype: ""
    id: "87"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "104"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_241
      ip:
        simple: ${SIXFIVE.IP}
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: f48b42b0-1916-4e87-8ac0-aa5bf9f66986
      iscommand: true
      name: Block IP on Zscaler BPS tenant
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: f48b42b0-1916-4e87-8ac0-aa5bf9f66986
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -720,
          "y": 795
        }
      }
  "88":
    continueonerrortype: ""
    id: "88"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "95"
    note: false
    quietmode: 0
    scriptarguments:
      alert_time:
        complex:
          accessor: created
          root: incident
          transformers:
          - operator: 8726aa62-638b-41b0-8fd7-8d8892145289
          - args:
              delimiter:
                value:
                  simple: .
              fields:
                value:
                  simple: "1"
            operator: Cut
          - args:
              prefix: {}
              suffix:
                value:
                  simple: .0Z
            operator: concat
      destination_domain:
        complex:
          accessor: Domain
          root: SIXFIVE
      destination_url:
        simple: http://abc.com
      device_id:
        simple: abcdefghij
      device_version:
        simple: "1.0"
      using:
        simple: Cisco Umbrella Enforcement Block Domain_instance,Cisco Umbrella Enforcement
          Block Domain GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Enforcement Block Domain
      description: Posts a malware event to the API for processing and optionally
        adding to a customer's domain lists.
      id: d0c0a708-99fa-4fb7-817e-ddd3341d5345
      iscommand: true
      name: Block Domain on Cisco Umbrella (opendns)
      script: Cisco Umbrella Enforcement Block Domain|||umbrella-domain-event-add
      type: regular
      version: -1
    taskid: d0c0a708-99fa-4fb7-817e-ddd3341d5345
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 1215
        }
      }
  "89":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: email
      label: Email
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      Email:
      - "92"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 87c25ab5-b6c5-4f05-8702-26ffa9d72bb7
      iscommand: false
      name: Does the subject line include 'Email'?
      type: condition
      version: -1
    taskid: 87c25ab5-b6c5-4f05-8702-26ffa9d72bb7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 750,
          "y": 610
        }
      }
  "90":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csp
      label: Email
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 70228ef5-32f3-4191-87e3-c4a83bb1d088
      iscommand: false
      name: Does the subject line include 'CSP'?
      type: condition
      version: -1
    taskid: 70228ef5-32f3-4191-87e3-c4a83bb1d088
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -390,
          "y": -800
        }
      }
  "91":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
          operator: isEqualString
          right:
            value:
              simple: EWS v2
      label: "yes"
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "97"
      "yes":
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8b8f2cc7-ac9a-485f-892b-8830172795f9
      iscommand: false
      name: Triggered From Email ?
      type: condition
      version: -1
    taskid: 8b8f2cc7-ac9a-485f-892b-8830172795f9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 430
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: emailblock
      type:
        simple: Domain
      value:
        simple: ${SIXFIVE.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: c5dae83d-a3bd-4fc9-8a68-c190ef3f6812
      iscommand: true
      name: Tag 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: c5dae83d-a3bd-4fc9-8a68-c190ef3f6812
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1340
        }
      }
  "93":
    continueonerrortype: ""
    id: "93"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: COSCBlockDomain
      type:
        simple: Domain
      value:
        simple: ${SIXFIVE.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 4e09399f-3dad-41f1-8b32-aa8ac9a1bb31
      iscommand: true
      name: Tag 'CSOC' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 4e09399f-3dad-41f1-8b32-aa8ac9a1bb31
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 1845
        }
      }
  "94":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: internet
      label: Internet
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      Internet:
      - "93"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4b67fb4b-5fd2-488c-8f8b-9b0436c6b200
      iscommand: false
      name: Does the subject line include 'Internet'?
      type: condition
      version: -1
    taskid: 4b67fb4b-5fd2-488c-8f8b-9b0436c6b200
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 1550
        }
      }
  "95":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
          operator: isEqualString
          right:
            value:
              simple: EWS v2
      label: "yes"
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "98"
      "yes":
      - "94"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 70520c4d-7bc7-43b3-80f5-7deebf2c4d6d
      iscommand: false
      name: Triggered From Email ?
      type: condition
      version: -1
    taskid: 70520c4d-7bc7-43b3-80f5-7deebf2c4d6d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 1360
        }
      }
  "96":
    continueonerrortype: ""
    id: "96"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: a39bcb49-0080-4e38-85b2-8e8153b1c410
      iscommand: false
      name: TCS-IP Address Owner Verification_Playbook  v3.3
      playbookId: d0467e0b-cffe-40cd-883c-dd52a89e5833
      type: playbook
      version: -1
    taskid: a39bcb49-0080-4e38-85b2-8e8153b1c410
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 900,
          "y": -660
        }
      }
  "97":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: email only
      label: Email Only
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      Email Only:
      - "92"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1ece1be5-58cf-456e-8c04-0d54e684647b
      iscommand: false
      name: ' ''Block IOC On'' Email?'
      type: condition
      version: -1
    taskid: 1ece1be5-58cf-456e-8c04-0d54e684647b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 620
        }
      }
  "98":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: internet only
      label: Internet Only
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      Internet Only:
      - "93"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e65f7ceb-62a4-4513-8994-9724c7209f0e
      iscommand: false
      name: Check 'Block IOC On' Internet?
      type: condition
      version: -1
    taskid: e65f7ceb-62a4-4513-8994-9724c7209f0e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1540
        }
      }
  "99":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: BELOWSIXFIVE
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0f553f02-5688-4ddf-848a-b944d7642ff4
      iscommand: false
      name: Are There IoCs Below Sixty Five
      type: condition
      version: -1
    taskid: 0f553f02-5688-4ddf-848a-b944d7642ff4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -250,
          "y": 260
        }
      }
  "103":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
          operator: isEqualString
          right:
            value:
              simple: EWS v2
        - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: manual
      label: "yes"
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ed9bc50c-f471-463f-8534-ebca102ac5a0
      iscommand: false
      name: Triggered From Email ?
      type: condition
      version: -1
    taskid: ed9bc50c-f471-463f-8534-ebca102ac5a0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -250,
          "y": 620
        }
      }
  "104":
    continueonerror: true
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "82"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_57
      ip:
        simple: ${SIXFIVE.IP}
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: eebd9b40-96a7-4257-8fbd-1a6ad8b3288b
      iscommand: true
      name: Block IP on Zscaler GNDM tenant
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: eebd9b40-96a7-4257-8fbd-1a6ad8b3288b
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": -720,
          "y": 1000
        }
      }
  "105":
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: URL
          root: SIXFIVE
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: a401d96d-3c72-4359-89e6-e0ce29f7cd71
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: a401d96d-3c72-4359-89e6-e0ce29f7cd71
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1990,
          "y": 830
        }
      }
  "106":
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "88"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: Domain
          root: SIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 3788f934-3872-4506-8c61-519ffdc166c6
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 3788f934-3872-4506-8c61-519ffdc166c6
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 1050
        }
      }
  "107":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Extension
                root: File
          operator: isEqualString
          right:
            value:
              simple: doc
      label: "yes"
    continueonerrortype: ""
    id: "107"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "110"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6e2075e8-a343-491f-868f-4a49cceea699
      iscommand: false
      name: Is There a Word File ?
      type: condition
      version: -1
    taskid: 6e2075e8-a343-491f-868f-4a49cceea699
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": -1230
        }
      }
  "108":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Extension
                root: File
          operator: isEqualString
          right:
            value:
              simple: txt
      label: "yes"
    continueonerrortype: ""
    id: "108"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "111"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 58b986ce-2c47-4e67-8f20-565892178f4e
      iscommand: false
      name: Is There a Text File ?
      type: condition
      version: -1
    taskid: 58b986ce-2c47-4e67-8f20-565892178f4e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 910,
          "y": -1230
        }
      }
  "109":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Extension
                root: File
          operator: isEqualString
          right:
            value:
              simple: pdf
      label: "yes"
    continueonerrortype: ""
    id: "109"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "112"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c35a1e87-0799-4235-8937-5ae1da4f5375
      iscommand: false
      name: Is There a PDF File ?
      type: condition
      version: -1
    taskid: c35a1e87-0799-4235-8937-5ae1da4f5375
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1410,
          "y": -1230
        }
      }
  "110":
    continueonerrortype: ""
    id: "110"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "96"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: doc
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 1328d3ca-d92f-4e59-8455-a511380b94d6
      iscommand: true
      name: Extract Indicators From Word File
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 1328d3ca-d92f-4e59-8455-a511380b94d6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": -1000
        }
      }
  "111":
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "96"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: b1680aec-de9d-4ca4-8c35-26aa18ff9fa3
      iscommand: true
      name: Extract Indicators From Text File
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: b1680aec-de9d-4ca4-8c35-26aa18ff9fa3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 900,
          "y": -1000
        }
      }
  "112":
    continueonerrortype: ""
    id: "112"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "96"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: pdf
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 52944201-a4c4-4117-8c9e-e0df17dcb2d9
      iscommand: true
      name: Extract Indicators From pdf File
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 52944201-a4c4-4117-8c9e-e0df17dcb2d9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1410,
          "y": -1000
        }
      }
  "113":
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "107"
      - "108"
      - "109"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: be0647e0-0982-4344-8ba3-1bbffb857acf
      iscommand: false
      name: Extract Indicators From File
      type: title
      version: -1
    taskid: be0647e0-0982-4344-8ba3-1bbffb857acf
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 900,
          "y": -1405
        }
      }
  "120":
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${RiskScore.Result}
      fileName:
        simple: IOC_RiskScore.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: bb00a550-4599-4183-860e-448970ddd520
      iscommand: false
      name: Create Risk Score Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: bb00a550-4599-4183-860e-448970ddd520
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 2400
        }
      }
  "121":
    continueonerrortype: ""
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "122"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9775536b-7d73-4268-8ec6-1918f26abbaf
      iscommand: false
      name: Set IOC Report To Context
      script: Set
      type: regular
      version: -1
    taskid: 9775536b-7d73-4268-8ec6-1918f26abbaf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 220,
          "y": 2570
        }
      }
  "122":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RiskScore.Result
          operator: greaterThan
          right:
            value:
              simple: "64"
      label: "yes"
    continueonerrortype: ""
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "126"
      "yes":
      - "123"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0b9a2a83-9504-4b39-80da-b5799375dc12
      iscommand: false
      name: Are There Any IOC Above Risk Score 65 ?
      type: condition
      version: -1
    taskid: 0b9a2a83-9504-4b39-80da-b5799375dc12
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 220,
          "y": 2760
        }
      }
  "123":
    continueonerrortype: ""
    id: "123"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "124"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RiskScore65
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RiskScore.Result.riskScore
              operator: greaterThan
              right:
                value:
                  simple: "64"
          root: RiskScore.Result
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2170dfcb-356e-462a-8e5e-94d1ad8b7f95
      iscommand: false
      name: Set IOC Greater Than 64 To Context
      script: Set
      type: regular
      version: -1
    taskid: 2170dfcb-356e-462a-8e5e-94d1ad8b7f95
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 220,
          "y": 2950
        }
      }
  "124":
    continueonerrortype: ""
    id: "124"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "125"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${RiskScore65}
      fileName:
        simple: Above_64_IOC_RiskScore.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: f44ea34a-c780-4d38-864d-e7c3ff5a3403
      iscommand: false
      name: Create Risk Score Report Above 64
      script: ExportToCSV
      type: regular
      version: -1
    taskid: f44ea34a-c780-4d38-864d-e7c3ff5a3403
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 220,
          "y": 3130
        }
      }
  "125":
    continueonerrortype: ""
    id: "125"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "126"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 79644f60-1601-486d-8f26-0e42bc0a4290
      iscommand: false
      name: Set 64 Above Report To Context
      script: Set
      type: regular
      version: -1
    taskid: 79644f60-1601-486d-8f26-0e42bc0a4290
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 220,
          "y": 3310
        }
      }
  "126":
    continueonerrortype: ""
    id: "126"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "131"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2917adb1-994b-402d-8265-98bb0e916909
      iscommand: false
      name: Email Report / Notify
      type: title
      version: -1
    taskid: 2917adb1-994b-402d-8265-98bb0e916909
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 220,
          "y": 3550
        }
      }
  "131":
    continueonerrortype: ""
    id: "131"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "135"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          root: Report
      body:
        simple: "Hello Human,\n\nPFA the Risk Score report for the IoCs shared in
          this file - ${incident.attachment.name} \n\n(Please note if I find any IoCs
          in the file that belong to Microsoft, Google, TCS, Master IOC or other customers
          I will create an additional  risk report with an appropriate file name)\n\n\nRegards,\nCSOC
          Cyber Bot\nAutomation  Id - ${incident.id}"
      cc:
        simple: kunal.krushev@tcs.com
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: Notify IOC Blocking Done for Above 64 Risk score - ${incident.attachment.name}
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 6ad02a68-1d5c-4d6e-8937-33773f870f43
      iscommand: true
      name: Email Report Summary
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 6ad02a68-1d5c-4d6e-8937-33773f870f43
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 230,
          "y": 3720
        }
      }
  "135":
    continueonerrortype: ""
    id: "135"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3dff966b-18a0-4038-89bf-09a70fa8e9c3
      iscommand: false
      name: ' End'
      type: title
      version: -1
    taskid: 3dff966b-18a0-4038-89bf-09a70fa8e9c3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 230,
          "y": 3925
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "10_3_#default#": 0.17,
      "10_43_yes": 0.54,
      "32_3_#default#": 0.16,
      "89_92_Email": 0.51,
      "91_89_yes": 0.46,
      "94_27_#default#": 0.11,
      "94_93_Internet": 0.66,
      "95_94_yes": 0.6,
      "97_39_#default#": 0.49,
      "97_92_Email Only": 0.39,
      "98_27_#default#": 0.49,
      "98_93_Internet Only": 0.7
    },
    "paper": {
      "dimensions": {
        "height": 5535,
        "width": 3590,
        "x": -720,
        "y": -1545
      }
    }
  }
