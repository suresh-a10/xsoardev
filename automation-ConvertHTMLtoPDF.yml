args:
- name: html
  required: true
- defaultValue: file.pdf
  description: FIlename to return as output
  name: filename
comment: This automation is developed to convert HTML file to PDF using pdfkit and
  wkhtmltopdf. This is used to generate playbook documentation.
commonfields:
  id: ConvertHTMLtoPDF
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: pdfkit-with-wkhtmltopdf:0.0.1
enabled: true
engineinfo: {}
mainengineinfo: {}
name: ConvertHTMLtoPDF
outputs:
- contextPath: File.Name
  description: The name of the output file.
  type: string
- contextPath: File.Extension
  description: The extension of the file.
  type: string
- contextPath: File.EntryID
  description: The entry ID of the file.
  type: string
- contextPath: File.Info
  description: Additional information about the file.
  type: string
- contextPath: File.Type
  description: The file type.
  type: string
pswd: ""
runas: DBotWeakRole
runonce: false
script: |-
  import pdfkit
  import tempfile
  import shutil


  def main():
      args = demisto.args()
      html = args.get("html")
      filename = str(args.get("filename"))
      if (not (filename.endswith(".pdf"))) and (not (filename.endswith(".PDF"))) :
          filename = f"{filename}.pdf"
      file = pdfkit.from_string(html, False)
      if not file:
          return_error('No file result returned for convert format: pdf')
          return
      return_results(fileResult(filename, file))

  main()
scripttarget: 0
subtype: python3
tags: []
timeout: 180ns
type: python
