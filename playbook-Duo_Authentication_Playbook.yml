contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: fb22f349-33a5-4c2c-8a78-1639c242dc0e
inputs: []
name: Duo Authentication Playbook
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7b221afb-43e5-4242-802a-0b8b0e35275f
      iscommand: false
      name: ""
      version: -1
    taskid: 7b221afb-43e5-4242-802a-0b8b0e35275f
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 320,
          "y": 20
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      offense_id:
        complex:
          accessor: ID}
          root: ${QRadar.Offense
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar
      description: Gets offense with matching offense ID from qradar
      id: 4ff6bd26-2e8f-4348-8a73-20bacc74ec72
      iscommand: true
      name: Check for QRadar offense id
      script: QRadar|||qradar-offense-by-id
      type: regular
      version: -1
    taskid: 4ff6bd26-2e8f-4348-8a73-20bacc74ec72
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 320,
          "y": 160
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: c8e8bbb2-c849-4fbd-83f3-3b0d2465e913
      iscommand: true
      name: 'Close Incident '
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: c8e8bbb2-c849-4fbd-83f3-3b0d2465e913
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 300,
          "y": 980
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2bdb8a80-94da-452c-8992-75ee1e421a8a
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 2bdb8a80-94da-452c-8992-75ee1e421a8a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 300,
          "y": 1130
        }
      }
  "11":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Were the Duo failed login attempts made by you?
        options: []
        optionsarg:
        - {}
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: Your SOC team
      title: DUO Multiple Failed login attempts
      totalanswers: 0
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: ""
      headerfontcolor: ""
      isexternalrtl: false
      sender: 'SOC Team '
      submitbuttonbackgroundcolor: ""
      submitbuttonfontcolor: ""
      submittext: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: |-
          Dear Associate, Multiple Duo failed login attempts were observed on your user ID. Kindly let us know if you are aware of these attempts. You can do that by clicking on the link below and selecting a response.

          Register Your Response Here -
      cc:
        simple: v.ghule@tcs.com
      format: ""
      methods:
      - email
      subject:
        simple: 'DUO Multiple Failed login attempts from_${QRadar.Offense.OffenseSource} '
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to:
        simple: '${QRadar.Offense.OffenseSource} '
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: "Dear ${DuoAdmin.UserDetails.username},\n\nWe have received multiple
          failed login attempts from your id .Kindly conform have you tried multiple
          wrong password "
      subject:
        simple: Observed Duo Multiple login failed from_${DuoAdmin.UserDetails.user_id}
      to:
        simple: ${DuoAdmin.UserDetails.user_id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 42f112bc-68ad-4ea2-8fca-ec04bce36d5e
      iscommand: false
      name: Ask user to confirm login attempts
      type: collection
      version: -1
    taskid: 42f112bc-68ad-4ea2-8fca-ec04bce36d5e
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 320,
          "y": 320
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello,

          Your Duo account is locked out due to multiple times wrong password. Please try after 30 min .

          Thanks & Regards,
          CSOC Cyber AutoBot
      cc:
        simple: v.ghule@tcs.com
      subject:
        simple: 'DUO Multiple login failed attempts '
      to:
        simple: '${QRadar.Offense.OffenseSource} '
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: ef5dcad5-beb3-461d-8c0b-584a230a771d
      iscommand: true
      name: Notify to user
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: ef5dcad5-beb3-461d-8c0b-584a230a771d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 795
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello,

          If you haven't tried for wrong password on Duo then Please reset your domain password.

          Thanks & Regards,
          CSOC Cyber AutoBot
      cc:
        simple: v.ghule@tcs.com
      subject:
        simple: DUO Multiple login failed attempts  from _${QRadar.Offense.OffenseSource}
      to:
        simple: '${QRadar.Offense.OffenseSource} '
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 34be2931-5b56-4d25-8bbd-c7b9f6d8b19d
      iscommand: true
      name: Notify User and reset password
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 34be2931-5b56-4d25-8bbd-c7b9f6d8b19d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 590,
          "y": 795
        }
      }
  "15":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: DUO Multiple Failed login attempts.Answers
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 509ed973-5808-4376-8a7b-ac281d023454
      iscommand: false
      name: Check for users reply
      type: condition
      version: -1
    taskid: 509ed973-5808-4376-8a7b-ac281d023454
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 320,
          "y": 480
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0313d8f2-c393-4f20-857b-6a9c209ec50d
      iscommand: false
      name: False Positive
      type: title
      version: -1
    taskid: 0313d8f2-c393-4f20-857b-6a9c209ec50d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 20,
          "y": 660
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8aab81f0-4aee-40fd-8b75-83e599affc66
      iscommand: false
      name: True Positive
      type: title
      version: -1
    taskid: 8aab81f0-4aee-40fd-8b75-83e599affc66
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 590,
          "y": 660
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1175,
        "width": 950,
        "x": 20,
        "y": 20
      }
    }
  }
