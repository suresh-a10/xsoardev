contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 1.3.11
    packID: ""
    packName: Integrations & Incidents Health Check
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: You should run this playbook as a scheduled job.  The playbook checks
  the health of all enabled integrations and open incidents.
id: de540331-d97b-42c2-8f1e-9dc36e2541af
inputs:
- description: |-
    This input determines if the health check report should be sent automatically after running the playbook.
    True - Yes.
  key: SendHealthCheckReport
  playbookInputQuery: null
  required: false
  value: {}
- description: In case the 'SendHealthCheckReport' input equals to 'True', the email
    address the report will be sent to.
  key: EmailReportTo
  playbookInputQuery: null
  required: false
  value: {}
- description: Comma separated list of playbook names to exclude from restarting their
    failed tasks.
  key: playbookExclusion
  playbookInputQuery: null
  required: false
  value: {}
- description: Whether to automatically run the RestartFailedTasks automation.
  key: AutoRestartFailedTasks
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: "List of instances to ignore when setting the grid for the Failed Instances.
    \ \n\nThis can be used to ignore instances for which the test button doesn't work
    due to the integration itself. "
  key: failedInstancesExclusion
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: FailedInstancesIgnore
      root: lists
name: JOB - Integrations and Incidents Health Check (Mike Version)
outputs: []
quiet: true
sourceplaybookid: JOB - Integrations and Playbooks Health Check
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5b572b5b-5a02-4869-8266-fea03bfde26b
      iscommand: false
      name: ""
      version: -1
    taskid: 5b572b5b-5a02-4869-8266-fea03bfde26b
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 50
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fcf6bbd2-48a3-4e29-837e-9dd058c31feb
      iscommand: false
      name: Run Health Check Scripts
      type: title
      version: -1
    taskid: fcf6bbd2-48a3-4e29-837e-9dd058c31feb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 195
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7cb1639b-a644-4486-8c71-f6d700802eed
      iscommand: false
      name: Create Lists for Dashboard
      type: title
      version: -1
    taskid: 7cb1639b-a644-4486-8c71-f6d700802eed
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 515
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This playbook is triggered by a 'JOB - Integrations and Incidents
        Health' playbook and is responsible for creating or updating related XSOAR
        lists.
      id: ab744b1e-1807-4a12-8264-eac9a7ede6ce
      iscommand: false
      name: JOB - Integrations and Incidents Health Check - Lists handling
      playbookId: JOB - Integrations and Playbooks Health Check - Lists handling
      type: playbook
      version: -1
    taskid: ab744b1e-1807-4a12-8264-eac9a7ede6ce
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 660
        }
      }
  "16":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.SendHealthCheckReport
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Checks the input to see if there is what to send the health check report ("SendHealthCheckReport") equal 'True'.
      id: ec80b9d6-8497-44bb-8f1e-6773aaaa1928
      iscommand: false
      name: Should send the health check report?
      type: condition
      version: -1
    taskid: ec80b9d6-8497-44bb-8f1e-6773aaaa1928
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 980
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      name:
        simple: Integrations and Incidents Health Check
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Generates a general health check report.
      id: 0de3b98a-6754-4dfb-801d-ef4c2afa4e72
      iscommand: true
      name: Generate Health Check report
      script: Builtin|||generateGeneralReport
      type: regular
      version: -1
    taskid: 0de3b98a-6754-4dfb-801d-ef4c2afa4e72
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 1330
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.EmailReportTo
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is an input of the email address to send the report
        to.
      id: f601d462-6a39-4a31-8d07-ed7e9c78438a
      iscommand: false
      name: Is there an email address to send the report?
      type: condition
      version: -1
    taskid: f601d462-6a39-4a31-8d07-ed7e9c78438a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1155
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          root: InfoFile
      body:
        simple: Please find attached Integrations and Incidents Health Check report
          for enabled integrations and open incidents.
      subject:
        simple: Integrations and Incidents Health Check Report
      to:
        complex:
          root: inputs.EmailReportTo
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends the Health Check report.
      id: 5683ca78-5a64-4fc2-8ebd-e4f73ccee3fd
      iscommand: true
      name: Send Health Check report
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 5683ca78-5a64-4fc2-8ebd-e4f73ccee3fd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 1505
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 97d48f08-3c8a-46e1-887b-ecf0691ed8c7
      iscommand: false
      name: Send Health Check Report
      type: title
      version: -1
    taskid: 97d48f08-3c8a-46e1-887b-ecf0691ed8c7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 835
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4d8724b5-82e9-4809-8b8e-2c185d2b9f6e
      iscommand: false
      name: Restart Failed Tasks
      type: title
      version: -1
    taskid: 4d8724b5-82e9-4809-8b8e-2c185d2b9f6e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1680
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4ca32934-bc54-4dd9-855e-ade7981f5e72
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 4ca32934-bc54-4dd9-855e-ade7981f5e72
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2495
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 7fc8fb6b-5400-4c5d-85b0-66481cafb3e6
      iscommand: true
      name: Close investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 7fc8fb6b-5400-4c5d-85b0-66481cafb3e6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2320
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      playbook_exclusion:
        complex:
          root: inputs.playbookExclusion
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Use this Script to re-run failed tasks. Run in the same incident
        after running `GetFailedTasks` for restarting all of the failed tasks or some
        of them.
      id: 4231b3b6-427a-49c7-862d-bd6e508578b1
      iscommand: false
      name: Restart failed tasks
      script: RestartFailedTasks
      type: regular
      version: -1
    taskid: 4231b3b6-427a-49c7-862d-bd6e508578b1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2000
        }
      }
  "41":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.AutoRestartFailedTasks
          operator: isEqualString
          right:
            value:
              simple: "true"
      - - left:
            iscontext: true
            value:
              simple: GetFailedTasks
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "45"
      "yes":
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to restart the failed tasks identified automatically.
      id: d6e9fb4e-e8b8-4b0f-8a70-080f71254440
      iscommand: false
      name: Should restart failed tasks?
      type: condition
      version: -1
    taskid: d6e9fb4e-e8b8-4b0f-8a70-080f71254440
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1825
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      IgnoreFailedInstances:
        complex:
          root: inputs.failedInstancesExclusion
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook is triggered by a 'JOB - Integrations and Playbooks
        Health' playbook and is responsible for running failed integrations and failed
        incidents scripts. The playbook may run separately from the main playbook
        to run health tests on enabled integrations and open incidents.
      id: 43c44f17-8734-4d17-8113-068bac3114cf
      iscommand: false
      name: Integrations and Incidents Health Check - Running Scripts (Mike Version)
      playbookId: c5e79b1e-142e-4997-8fcb-da31d6ab14ca
      type: playbook
      version: -1
    taskid: 43c44f17-8734-4d17-8113-068bac3114cf
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 340
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3050b7d6-96c7-4890-8f75-41c73dba6edd
      iscommand: false
      name: This is the End
      type: title
      version: -1
    taskid: 3050b7d6-96c7-4890-8f75-41c73dba6edd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2175
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "16_18_yes": 0.43,
      "16_21_#default#": 0.16,
      "18_17_yes": 0.47,
      "18_21_#default#": 0.18,
      "41_40_yes": 0.36
    },
    "paper": {
      "dimensions": {
        "height": 2510,
        "width": 717.5,
        "x": 50,
        "y": 50
      }
    }
  }
