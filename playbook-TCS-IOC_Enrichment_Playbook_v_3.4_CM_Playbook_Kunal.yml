contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: f84f792c-f23a-4710-80f4-c2705600e27a
inputs: []
name: TCS-IOC Enrichment Playbook v 3.4_CM Playbook_Kunal
outputs: []
sourceplaybookid: 08c3b260-77a7-4316-8c5d-802cc55f4e22
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 895382bf-8edb-41b5-8c0c-a51da4bd6b0c
      iscommand: false
      name: ""
      version: -1
    taskid: 895382bf-8edb-41b5-8c0c-a51da4bd6b0c
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": -420
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 50caffd4-87ad-4917-8e5e-19ba24f7de50
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 50caffd4-87ad-4917-8e5e-19ba24f7de50
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1470
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: f0fa34cb-d3c0-4710-888b-5759ab1cc1a1
      iscommand: false
      name: Generate Investigation Summary Report
      type: title
      version: -1
    taskid: f0fa34cb-d3c0-4710-888b-5759ab1cc1a1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 870
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name:
        simple: IOC Threat Intel
      type:
        simple: pdf
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: 5d3ba78e-daf2-4193-8c5a-9b70c4b2e785
      iscommand: false
      name: Generate Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: 5d3ba78e-daf2-4193-8c5a-9b70c4b2e785
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1190
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      Hash:
        complex:
          accessor: File
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      IP Address:
        complex:
          accessor: IP
          root: Address2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 84763954-15a1-4a23-8317-2661f5507bc4
      iscommand: false
      name: TCS-Recorded Future IOC Enrichment Playbook v 1.0
      playbookId: 1328b1fc-695e-4f06-8272-d3223a7640c2
      type: playbook
      version: -1
    taskid: 84763954-15a1-4a23-8317-2661f5507bc4
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -940,
          "y": 580
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: daa3d3d0-e8c5-4271-8c45-4cf262e7af26
      iscommand: false
      name: TCS-Cisco Umbrella  IOC Enrichment Playbook v 1.0
      playbookId: 801a53c2-3def-4a8d-811e-97ddfb6d0f99
      type: playbook
      version: -1
    taskid: daa3d3d0-e8c5-4271-8c45-4cf262e7af26
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -480,
          "y": 580
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      Hash:
        complex:
          accessor: File
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 52200deb-f490-40ab-8c6f-0536560f678f
      iscommand: false
      name: TCS-Auto Focus IOC Enrichment Playbook v 1.0
      playbookId: ff9792aa-d59f-4a0d-8cf4-d23be764eed7
      type: playbook
      version: -1
    taskid: 52200deb-f490-40ab-8c6f-0536560f678f
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -10,
          "y": 580
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      Hash:
        complex:
          accessor: File
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 05d09007-b24a-4133-86b4-4378cf09de2d
      iscommand: false
      name: TCS-VirusTotal IOC Enrichment Playbook v 1.0
      playbookId: 514f1d8a-3612-45f6-851e-3b68f7a748ec
      type: playbook
      version: -1
    taskid: 05d09007-b24a-4133-86b4-4378cf09de2d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 450,
          "y": 580
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 212b5128-1eb8-4703-8f48-9d8f1bc728c8
      iscommand: false
      name: TCS-AbuseIODB IOC Enrichment Playbook v 1.0
      playbookId: 3814a004-f94f-4f0a-8586-a0e453056f44
      type: playbook
      version: -1
    taskid: 212b5128-1eb8-4703-8f48-9d8f1bc728c8
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 910,
          "y": 580
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b73330b4-19f2-4c9f-8787-ae6ee2710d2b
      iscommand: false
      name: TCS-Shodan IOC Enrichment Playbook v 1.0
      playbookId: 781f8111-fc1a-462a-8213-0906ea056f0d
      type: playbook
      version: -1
    taskid: b73330b4-19f2-4c9f-8787-ae6ee2710d2b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 580
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
      using:
        simple: InnerServicesModule
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 664dd1df-f88f-42a6-833f-6c7d982328c4
      iscommand: true
      name: Extract Indicator From File
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 664dd1df-f88f-42a6-833f-6c7d982328c4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": -30
        }
      }
  "55":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain_Test_
                root: ExtractedIndicators
          operator: isExists
        - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 04bc4c43-997a-432b-86e7-4b543ba38745
      iscommand: false
      name: Are There Domains?
      type: condition
      version: -1
    taskid: 04bc4c43-997a-432b-86e7-4b543ba38745
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 140
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Domain2
      value:
        complex:
          accessor: Domain
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a4e30f6c-1de4-4f1b-8d37-69bdc250499a
      iscommand: false
      name: Set Domain In New Context For DeDup
      script: Set
      type: regular
      version: -1
    taskid: a4e30f6c-1de4-4f1b-8d37-69bdc250499a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 330
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Domain2
      value:
        complex:
          accessor: Domain_Test_
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e6143bc0-8d33-4a1d-8a5a-9f3403b9cbd2
      iscommand: false
      name: Set Unique Domain In New Context
      script: Set
      type: regular
      version: -1
    taskid: e6143bc0-8d33-4a1d-8a5a-9f3403b9cbd2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 900,
          "y": 330
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: af4e7d28-5ab1-423b-8e84-3ae8b6bdfbe2
      iscommand: false
      name: Delete Extracted Indicators Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: af4e7d28-5ab1-423b-8e84-3ae8b6bdfbe2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 330
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain2
              operator: notContainsGeneral
              right:
                value:
                  simple: www.
          - - left:
                iscontext: true
                value:
                  simple: Domain2
              operator: notContainsGeneral
              right:
                value:
                  simple: /
          root: Domain2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f34cba9f-96da-4483-8917-5c91aa5c94d9
      iscommand: false
      name: Set New DeDup Domains
      script: Set
      type: regular
      version: -1
    taskid: f34cba9f-96da-4483-8917-5c91aa5c94d9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1810,
          "y": 330
        }
      }
  "60":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "57"
      "yes":
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e7fc2c6a-caa6-4d30-8707-6b8e3231fbe4
      iscommand: false
      name: Is There Extracted Indicator Context ?
      type: condition
      version: -1
    taskid: e7fc2c6a-caa6-4d30-8707-6b8e3231fbe4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 140
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      Interval:
        simple: "1"
      Timeout:
        simple: "60"
      URL:
        complex:
          accessor: Data
          root: URL
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Detonate a webpage or remote file using the WildFire integration. This playbook returns relevant reports to the War Room and file reputations to the context data.
        The detonation supports the following file types:
        APK, JAR, DOC, DOCX, RTF, OOXLS, XLSX, PPT, PPTX, XML, PE32, PDF, DMG, PKG, RAR, 7Z, JS.
      id: 90829231-4168-4a10-8c6c-2570759f6bb3
      iscommand: false
      name: TCS-Detonate URL - WildFire v2.1
      playbookId: 7e410874-9d18-4545-86cf-aca9c6e144fd
      type: playbook
      version: -1
    taskid: 90829231-4168-4a10-8c6c-2570759f6bb3
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1790,
          "y": 580
        }
      }
  "62":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain_Test_
                root: ExtractedIndicators
          operator: isExists
        - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: ExtractedIndicators
          operator: isExists
        - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "54"
      "yes":
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5d1eaafd-ea65-42d8-806a-b980c32945a9
      iscommand: false
      name: Have Indicators Been Submitted ?
      type: condition
      version: -1
    taskid: 5d1eaafd-ea65-42d8-806a-b980c32945a9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": -250
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1955,
        "width": 3130,
        "x": -940,
        "y": -420
      }
    }
  }
