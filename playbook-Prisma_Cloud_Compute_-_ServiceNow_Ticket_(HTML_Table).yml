contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.10.0
    itemVersion: 1.7.8
    packID: PrismaCloudCompute
    packName: Prisma Cloud Compute by Palo Alto Networks
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: |-
  This playbook is a sub-playbook of the "Prisma Cloud Compute - ServiceNow Compliance Ticket" playbook.
  It creates a new ServiceNow ticket or updates an existing ServiceNow ticket with an HTML table for the given compliance ID retrieved from the parent playbook, with enriched data for each resource (host, image or container).
id: Prisma Cloud Compute - ServiceNow Ticket (HTML Table)
inputs:
- description: Existing ticket ID. Used to determine whether to create a new ticket
    or update an existing one.
  key: TicketID
  playbookInputQuery: null
  required: false
  value: {}
- description: A filter to use for extracting affected resources with a specific compliance
    issue ID.
  key: Filter
  playbookInputQuery: null
  required: false
  value: {}
- description: The compliance issue ID to open a ServiceNow ticket for.
  key: ComplianceIssueID
  playbookInputQuery: null
  required: false
  value: {}
- description: The compliance issue description.
  key: ComplianceIssueDescription
  playbookInputQuery: null
  required: false
  value: {}
- description: The compliance issue severity.
  key: ComplianceIssueSeverity
  playbookInputQuery: null
  required: false
  value: {}
name: Prisma Cloud Compute - ServiceNow Ticket (HTML Table)
outputs:
- contextPath: TicketAction
  description: The ticket action - create or update.
  type: string
- contextPath: Ticket
  description: The ticket object which was created or updated.
  type: string
quiet: true
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c381f14b-89f1-46b2-88c1-50b48ff58061
      iscommand: false
      name: ""
      version: -1
    taskid: c381f14b-89f1-46b2-88c1-50b48ff58061
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 650,
          "y": -280
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      short_description:
        simple: 'Prisma Cloud Compute - compliance issues ID: ${inputs.ComplianceIssueID}'
      work_notes:
        complex:
          root: HTMLTable
          transformers:
          - args:
              regex:
                value:
                  simple: \n
              replaceWith:
                value:
                  simple: <br />
            operator: replaceMatch
          - args:
              prefix:
                iscontext: true
                value:
                  simple: SNOWPrefix
              suffix: {}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates new ServiceNow ticket.
      id: c283a9d2-0ba6-4cf9-8c3c-341d71d7fee0
      iscommand: true
      name: Create a ServiceNow ticket with compliance issues table
      script: '|||servicenow-create-ticket'
      type: regular
      version: -1
    taskid: c283a9d2-0ba6-4cf9-8c3c-341d71d7fee0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 860,
          "y": 1890
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SNOWPrefix
      value:
        simple: '[code]<u>Compliance Issue ID</u>: ${inputs.ComplianceIssueID}<br
          /><u>Compliance Issue Description</u>: ${inputs.ComplianceIssueDescription}<br
          /><u>Compliance Issue Severity</u>: ${inputs.ComplianceIssueSeverity}<br
          /><u>Total Resources</u>: ${TotalResources}<br /><br />'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: a5b5aad6-9919-4a4f-83e7-41c54b8da3ad
      iscommand: false
      name: Prepare ServiceNow work notes prefix
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: a5b5aad6-9919-4a4f-83e7-41c54b8da3ad
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": 580
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6aab71dc-ffc7-4308-8c42-cb26f8e15c94
      iscommand: false
      name: Create a new ticket (with HTML table)
      type: title
      version: -1
    taskid: 6aab71dc-ffc7-4308-8c42-cb26f8e15c94
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 860,
          "y": 1135
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b487a6da-518e-426e-83b2-c8802fcbf5ae
      iscommand: false
      name: Update an existing ticket (with HTML table)
      type: title
      version: -1
    taskid: b487a6da-518e-426e-83b2-c8802fcbf5ae
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 440,
          "y": 1135
        }
      }
  "16":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ID
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: ServiceNow.Record.file_name
                    operator: startWith
                    right:
                      value:
                        simple: PCC_
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: ServiceNow.Record.file_name
                    operator: endWith
                    right:
                      value:
                        simple: .xlsx
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: ServiceNow.Record.file_name
                    operator: containsString
                    right:
                      value:
                        simple: _ComplianceIssues_ID_
                root: ServiceNow.Record
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "18"
      "yes":
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Jira V3
      description: Creates a new issue in Jira.
      id: 31637529-518b-4888-833b-230981605aa5
      iscommand: false
      name: Is there an attachment?
      type: condition
      version: -1
    taskid: 31637529-518b-4888-833b-230981605aa5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 440,
          "y": 1490
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      file_sys_id:
        complex:
          accessor: ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ServiceNow.Record.file_name
              operator: startWith
              right:
                value:
                  simple: PCC_
          - - left:
                iscontext: true
                value:
                  simple: ServiceNow.Record.file_name
              operator: endWith
              right:
                value:
                  simple: xlsx
          root: ServiceNow.Record
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete an attachment from a ticket.
      id: 2619dc50-da78-4464-8517-115142e6fa55
      iscommand: true
      name: Delete attachment from existing ticket
      script: '|||servicenow-delete-file'
      tags:
      - TicketInfo
      type: regular
      version: -1
    taskid: 2619dc50-da78-4464-8517-115142e6fa55
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": 1700
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      id:
        complex:
          root: inputs.TicketID
      work_notes:
        complex:
          root: HTMLTable
          transformers:
          - args:
              regex:
                value:
                  simple: \n
              replaceWith:
                value:
                  simple: <br />
            operator: replaceMatch
          - args:
              prefix:
                iscontext: true
                value:
                  simple: SNOWPrefix
              suffix: {}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Updates the specified ticket.
      id: fe99e30c-3aa1-4943-812e-36042643ec95
      iscommand: true
      name: Add a work note to existing ticket
      script: '|||servicenow-update-ticket'
      type: regular
      version: -1
    taskid: fe99e30c-3aa1-4943-812e-36042643ec95
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": 1890
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TicketAction
      value:
        simple: Create
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: The action of the the ticket (create or update) will be displayed
        in the layout under the “Ticketing Information” tab.
      id: c4b105b3-220f-42d1-8198-157294d19140
      iscommand: false
      name: Set "TicketAction" as "Create"
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: c4b105b3-220f-42d1-8198-157294d19140
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 860,
          "y": 2070
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TicketAction
      value:
        simple: Update
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: The action of the the ticket (create or update) will be displayed
        in the layout under the “Ticketing Information” tab.
      id: 794b6ce1-6b38-47bc-80e6-d998b234b7c5
      iscommand: false
      name: Set "TicketAction" as "Update"
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 794b6ce1-6b38-47bc-80e6-d998b234b7c5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": 2070
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TotalResources
      value:
        complex:
          accessor: containerid
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputecontainercomplianceissues.complianceissues
              operator: match
              right:
                iscontext: true
                value:
                  simple: inputs.Filter
          root: incident.prismacloudcomputecontainercomplianceissues
          transformers:
          - operator: count
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 6c83e9df-d2c4-4c62-8b5d-cd492e5e4097
      iscommand: false
      name: Count containers (to show in ServiceNow ticket)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 6c83e9df-d2c4-4c62-8b5d-cd492e5e4097
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": 405
        }
      }
  "25":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: alertcategory
                root: incident
          operator: isEqualString
          right:
            value:
              simple: host
      label: Host
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: alertcategory
                root: incident
          operator: isEqualString
          right:
            value:
              simple: container
      label: Container
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: alertcategory
                root: incident
          operator: isEqualString
          right:
            value:
              simple: image
      label: Image
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Container:
      - "32"
      Host:
      - "30"
      Image:
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2490a922-6d5a-45c1-86fa-418a5f2f9cd8
      iscommand: false
      name: What is the resource type?
      type: condition
      version: -1
    taskid: 2490a922-6d5a-45c1-86fa-418a5f2f9cd8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 650,
          "y": 80
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TotalResources
      value:
        complex:
          accessor: imageid
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputeimagecomplianceissues.complianceissues
              operator: match
              right:
                iscontext: true
                value:
                  simple: inputs.Filter
          root: incident.prismacloudcomputeimagecomplianceissues
          transformers:
          - operator: count
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 2cc4dd03-bdb0-4015-823e-d9db00cef411
      iscommand: false
      name: Count images (to show in ServiceNow ticket)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 2cc4dd03-bdb0-4015-823e-d9db00cef411
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 405
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SNOWResources
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputehostcomplianceissues.complianceissues
              operator: match
              right:
                iscontext: true
                value:
                  simple: inputs.Filter
          root: incident.prismacloudcomputehostcomplianceissues
          transformers:
          - args:
              fields:
                value:
                  simple: complianceissues
              json_object:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputehostcomplianceissues
            operator: IgnoreFieldsFromJson
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 89ddaf31-3f5a-4dcd-86da-9d54c1e0a893
      iscommand: false
      name: Prepare hosts compliance table for ServiceNow (HTML table)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 89ddaf31-3f5a-4dcd-86da-9d54c1e0a893
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 10,
          "y": 405
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TotalResources
      value:
        complex:
          accessor: hostname
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputehostcomplianceissues.complianceissues
              operator: match
              right:
                iscontext: true
                value:
                  simple: inputs.Filter
          root: incident.prismacloudcomputehostcomplianceissues
          transformers:
          - operator: count
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 070b6b1d-284c-47bd-851b-b6cf44fb1ddf
      iscommand: false
      name: Count hosts (to show in ServiceNow ticket)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 070b6b1d-284c-47bd-851b-b6cf44fb1ddf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -410,
          "y": 405
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7147d822-ea22-444a-8f3f-ee4f3b513eae
      iscommand: false
      name: Host
      type: title
      version: -1
    taskid: 7147d822-ea22-444a-8f3f-ee4f3b513eae
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -190,
          "y": 250
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2a7287f4-1ca5-4139-8004-06ee0e1c937f
      iscommand: false
      name: Image
      type: title
      version: -1
    taskid: 2a7287f4-1ca5-4139-8004-06ee0e1c937f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 250
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e9c691a7-45a0-4ef8-81f3-4d9229d117af
      iscommand: false
      name: Container
      type: title
      version: -1
    taskid: e9c691a7-45a0-4ef8-81f3-4d9229d117af
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 650,
          "y": 250
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.TicketID
          operator: isNotEmpty
          right:
            value: {}
      label: Existing
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      Existing:
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d6ee3444-2047-44ed-87ed-b99cd128305f
      iscommand: false
      name: Create a new ticket or update an existing one?
      type: condition
      version: -1
    taskid: d6ee3444-2047-44ed-87ed-b99cd128305f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 650,
          "y": 950
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      table:
        complex:
          root: SNOWResources
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Converts a given array to an HTML table
      id: cc7b8cb8-99bb-47a0-85c8-b21e4a48d289
      iscommand: false
      name: Create HTML Table
      script: ConvertTableToHTML
      type: regular
      version: -1
    taskid: cc7b8cb8-99bb-47a0-85c8-b21e4a48d289
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": 760
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      fields:
        simple: file_name
      query:
        simple: table_sys_id=${inputs.TicketID}
      table_name:
        simple: sys_attachment
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Queries the specified table in ServiceNow.
      id: 7a4a339e-ba0c-4e63-8132-38fb282437f2
      iscommand: true
      name: Search for attachments in existing ticket
      script: '|||servicenow-query-table'
      type: regular
      version: -1
    taskid: 7a4a339e-ba0c-4e63-8132-38fb282437f2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": 1290
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c2bdafb8-a156-4f76-8d8a-178759a4a6b6
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: c2bdafb8-a156-4f76-8d8a-178759a4a6b6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 670,
          "y": 2240
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SNOWResources
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputeimagecomplianceissues.complianceissues
              operator: match
              right:
                iscontext: true
                value:
                  simple: inputs.Filter
          root: incident.prismacloudcomputeimagecomplianceissues
          transformers:
          - args:
              fields:
                value:
                  simple: complianceissues
              json_object:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputeimagecomplianceissues
            operator: IgnoreFieldsFromJson
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: b2d15671-ca79-40af-89ca-287750014beb
      iscommand: false
      name: Prepare images compliance table for ServiceNow (HTML table)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: b2d15671-ca79-40af-89ca-287750014beb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 405
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SNOWResources
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputecontainercomplianceissues.complianceissues
              operator: match
              right:
                iscontext: true
                value:
                  simple: inputs.Filter
          root: incident.prismacloudcomputecontainercomplianceissues
          transformers:
          - args:
              fields:
                value:
                  simple: complianceissues
              json_object:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputecontainercomplianceissues
            operator: IgnoreFieldsFromJson
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 9ef26484-483f-4d3c-8c70-d3d656ea950a
      iscommand: false
      name: Prepare containers compliance table for ServiceNow (HTML table)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 9ef26484-483f-4d3c-8c70-d3d656ea950a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": 405
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
      subplaybook:
        simple: auto
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 3a576336-8dac-4b71-8668-d9c83a1ff91b
      iscommand: false
      name: Delete Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 3a576336-8dac-4b71-8668-d9c83a1ff91b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": -110
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2585,
        "width": 2500,
        "x": -410,
        "y": -280
      }
    }
  }
