contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 906f828d-b270-4a41-88d8-4175cf8df546
inputs: []
name: RF Entity Check_v1
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e97b40dd-5009-4776-87a5-c94188eab473
      iscommand: false
      name: ""
      version: -1
    taskid: e97b40dd-5009-4776-87a5-c94188eab473
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 430,
          "y": 90
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: b14475d7-b8b1-4bef-8a7a-6bb190f46fcf
      iscommand: false
      name: Read The Text Attachment
      script: ReadFile
      type: regular
      version: -1
    taskid: b14475d7-b8b1-4bef-8a7a-6bb190f46fcf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 245
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: username
      value:
        complex:
          root: FileData
          transformers:
          - operator: trim
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5faddcb2-22f7-4513-8826-f996599409f9
      iscommand: false
      name: Set Data To Context
      script: Set
      type: regular
      version: -1
    taskid: 5faddcb2-22f7-4513-8826-f996599409f9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 415
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${username}
      contextKey:
        simple: usernameArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: 691b344a-491a-4bd2-8f31-a25aa92f38f9
      iscommand: false
      name: Create Array of Input Data
      script: CreateArray
      type: regular
      version: -1
    taskid: 691b344a-491a-4bd2-8f31-a25aa92f38f9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 590
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      usernameArray:
        complex:
          root: usernameArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e61af907-65db-4824-87f6-f370296919a7
      iscommand: false
      name: RF Entity search_WIP
      playbookId: c3278d1c-6aee-4db0-8ef7-a264834d5662
      type: playbook
      version: -1
    taskid: e61af907-65db-4824-87f6-f370296919a7
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 430,
          "y": 790
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cbea24fe-dc85-44a8-855a-4ebc7b5ffa52
      iscommand: false
      name: end
      type: title
      version: -1
    taskid: cbea24fe-dc85-44a8-855a-4ebc7b5ffa52
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 430,
          "y": 1240
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: true
    quietmode: 2
    scriptarguments:
      extend-context:
        simple: 'IncidentsWithIndicator=.={"name": val.name}'
      ignore-outputs:
        simple: "false"
      indicator:
        simple: 1773892@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Lookup incidents with specified indicator. Use currentIncidentId to omit the existing incident from output.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: fd7bf807-b27b-434a-83c2-f86acdba81e1
      iscommand: false
      name: find indicators
      script: findIncidentsWithIndicator
      tags:
      - Indicators
      type: regular
      version: -1
    taskid: fd7bf807-b27b-434a-83c2-f86acdba81e1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1050,
          "y": 200
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 2
    scriptarguments:
      context_key:
        simple: entitynotfound
      file_name:
        simple: usernotfoundreport.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d97fff6f-949f-4b2e-8378-60c77342e9f1
      iscommand: false
      name: Create report for entity not found
      script: 98fd7176-124d-4739-8f9d-2f1edb20aa55
      type: regular
      version: -1
    taskid: d97fff6f-949f-4b2e-8378-60c77342e9f1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 1030
        }
      }
  "9":
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: report
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: true
    quietmode: 2
    scriptarguments:
      context_key:
        simple: FoundIndicatorsReport
      file_name:
        simple: report.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cf6c0743-8944-4c6c-8f85-1a019ada2015
      iscommand: false
      name: Untitled Task
      script: 98fd7176-124d-4739-8f9d-2f1edb20aa55
      type: regular
      version: -1
    taskid: cf6c0743-8944-4c6c-8f85-1a019ada2015
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -30,
          "y": 1030
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1215,
        "width": 1460,
        "x": -30,
        "y": 90
      }
    }
  }
