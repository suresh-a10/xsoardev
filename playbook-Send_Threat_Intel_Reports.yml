contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: Automating Threat Intel Reports - Demo Pack
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: This playbook sends emails to end users with the report - a URL to internal
  users, and the actual report data in an email to external users.
id: 5c79ecce-b31a-438d-8c52-0658176e00d9
inputs:
- description: ""
  key: ShouldSendToInternalUsers
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: ShouldSendToExternalUsers
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: ThreatIntelReport
  playbookInputQuery: null
  required: false
  value: {}
name: Send Threat Intel Reports
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 032e95ee-48c9-43a9-891c-bc01dc86fe22
      iscommand: false
      name: ""
      version: -1
    taskid: 032e95ee-48c9-43a9-891c-bc01dc86fe22
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 50
        }
      }
  "1":
    continueonerror: true
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      htmlBody:
        simple: ${inputs.ThreatIntelReport.EmailReportTemplate}
      subject:
        simple: Threat intel report created for ${inputs.ThreatIntelReport.value}
      to:
        simple: nkazinets@paloaltonetworks.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends an email using Gmail.
      id: ab18cd63-4815-4bca-8da8-0499e3bd3d18
      iscommand: true
      name: Send an email containing the report data
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: ab18cd63-4815-4bca-8da8-0499e3bd3d18
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
  "2":
    continueonerror: true
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      htmlBody:
        complex:
          accessor: url
          root: inputs.ThreatIntelReport
          transformers:
          - args:
              prefix:
                value:
                  simple: |-
                    This email is to inform you that a threat intel report on the following indicator has been created.
                    Click here to view the report: <a href="
              suffix: {}
            operator: concat
          - args:
              prefix: {}
              suffix:
                value:
                  simple: '">'
            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: inputs.ThreatIntelReport.value
            operator: concat
          - args:
              prefix: {}
              suffix:
                value:
                  simple: </a>
            operator: concat
      subject:
        simple: Threat intel report created for ${inputs.ThreatIntelReport.value}
      to:
        simple: nkazinets@paloaltonetworks.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends an email using Gmail.
      id: 3020e0af-e826-426a-8637-af3be2209fc7
      iscommand: true
      name: Send an email with the report's URL to XSOAR users
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 3020e0af-e826-426a-8637-af3be2209fc7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 370
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ShouldSendToExternalUsers
          operator: isTrue
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 02179a21-f3c6-48e7-8201-a61bd5f5cde1
      iscommand: false
      name: Should we send a report to external stakeholders?
      type: condition
      version: -1
    taskid: 02179a21-f3c6-48e7-8201-a61bd5f5cde1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 195
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ShouldSendToInternalUsers
          operator: isTrue
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 588b8c53-43d0-4b08-8ff4-d022d72dbba9
      iscommand: false
      name: Should we send a report to internal users?
      type: condition
      version: -1
    taskid: 588b8c53-43d0-4b08-8ff4-d022d72dbba9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 195
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 45f45a94-2ee2-4d1d-8f66-63a7cd5413c2
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: 45f45a94-2ee2-4d1d-8f66-63a7cd5413c2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 545
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 560,
        "width": 942.5,
        "x": 50,
        "y": 50
      }
    }
  }
