contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 30d01b09-2ba8-4ff0-8414-21aedd5fc20e
inputs: []
name: TCS-URL Enrich & Contextualize  v1.0_KK
outputs: []
sourceplaybookid: 08c3b260-77a7-4316-8c5d-802cc55f4e22
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9c87e3e0-23fa-4785-851b-5375340f2c1d
      iscommand: false
      name: ""
      version: -1
    taskid: 9c87e3e0-23fa-4785-851b-5375340f2c1d
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -1160,
          "y": -1660
        }
      }
  "99":
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "105"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets a quick indicator of the risk associated with a URL.
      id: 52edb773-c645-4f6c-82e1-6ef1c77aa5f5
      iscommand: true
      name: Enrich URL - RF
      script: Recorded Future v2.1|||url
      type: regular
      version: -1
    taskid: 52edb773-c645-4f6c-82e1-6ef1c77aa5f5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1160,
          "y": -1370
        }
      }
  "100":
    continueonerrortype: ""
    id: "100"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Looks up the classification for the each of the specified URLs.
      id: 9451b9a1-9691-4b95-854e-94b5ef33d631
      iscommand: true
      name: Enrich URL - Zscaler
      script: Zscaler|||url
      type: regular
      version: -1
    taskid: 9451b9a1-9691-4b95-854e-94b5ef33d631
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -720,
          "y": -1370
        }
      }
  "101":
    continueonerrortype: ""
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "107"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the reputation of a URL.
      id: e3e797c6-0221-4b88-8cbc-78e8b0698bc4
      iscommand: true
      name: Enrich URL - VirusTotal
      script: VirusTotal|||url
      type: regular
      version: -1
    taskid: e3e797c6-0221-4b88-8cbc-78e8b0698bc4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": -1370
        }
      }
  "103":
    continueonerror: true
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: VTURL
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: URL.PositiveDetections
              operator: greaterThan
              right:
                value:
                  simple: "0"
          root: URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: ea248011-c052-4560-83eb-bdd7cecbeb91
      iscommand: false
      name: Set VirusTotal Malicious Context
      script: Set
      type: regular
      version: -1
    taskid: ea248011-c052-4560-83eb-bdd7cecbeb91
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": -990
        }
      }
  "104":
    continueonerror: true
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "120"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ZSURL.URL.Address
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: URL.urlClassificationsWithSecurityAlert
              operator: isExists
          root: URL
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: '[.]'
              toReplace:
                value:
                  simple: .
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4157274d-ce1c-44fc-8f7d-eb36bc485259
      iscommand: false
      name: Set Zscaler Malicious Context
      script: Set
      type: regular
      version: -1
    taskid: 4157274d-ce1c-44fc-8f7d-eb36bc485259
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -720,
          "y": -990
        }
      }
  "105":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.URL
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: "yes"
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "100"
      "yes":
      - "108"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d562c9d8-ede1-4638-8821-b4aa4cd1accd
      iscommand: false
      name: RF Found URL Malicious ?
      type: condition
      version: -1
    taskid: d562c9d8-ede1-4638-8821-b4aa4cd1accd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1160,
          "y": -1190
        }
      }
  "106":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: urlClassificationsWithSecurityAlert
                root: URL
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "109"
      "yes":
      - "104"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ec11d6cd-bd42-4637-8024-c1ebeaceac7e
      iscommand: false
      name: Zscaler Found URL Malicious ?
      type: condition
      version: -1
    taskid: ec11d6cd-bd42-4637-8024-c1ebeaceac7e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -720,
          "y": -1190
        }
      }
  "107":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: PositiveDetections
                root: URL
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: "yes"
    continueonerrortype: ""
    id: "107"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "113"
      "yes":
      - "103"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bb772501-35f9-4cf9-8202-7ceb3c5434b7
      iscommand: false
      name: VirusTotal Found URL Malicious ?
      type: condition
      version: -1
    taskid: bb772501-35f9-4cf9-8202-7ceb3c5434b7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 650,
          "y": -1190
        }
      }
  "108":
    continueonerror: true
    continueonerrortype: ""
    id: "108"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "119"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: RFURL.URL.Address
      value:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.URL.riskScore
              operator: isNotEqualNumber
              right:
                value:
                  simple: "0"
          root: RecordedFuture.URL
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: '[.]'
              toReplace:
                value:
                  simple: .
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 387ab9ca-5031-4e03-8108-d6497169752d
      iscommand: false
      name: Set RF Malicious Context
      script: Set
      type: regular
      version: -1
    taskid: 387ab9ca-5031-4e03-8108-d6497169752d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1160,
          "y": -990
        }
      }
  "109":
    continueonerror: true
    continueonerrortype: ""
    id: "109"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "110"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: AutoFocus V2
      description: Checks the reputation of a URL in AutoFocus.
      id: 98281f70-8982-445a-8ac3-b2a4f46e32fa
      iscommand: true
      name: Enrich URL - AutoFocus
      script: AutoFocus V2|||url
      type: regular
      version: -1
    taskid: 98281f70-8982-445a-8ac3-b2a4f46e32fa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": -1370
        }
      }
  "110":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: PAN_DB
                root: AutoFocus.URL.LatestPanVerdicts
                transformers:
                - operator: toLowerCase
          operator: isNotEqualString
          right:
            value:
              simple: benign
      label: "yes"
    continueonerrortype: ""
    id: "110"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "113"
      "yes":
      - "111"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 22a20df7-2eb1-4202-87eb-5b7967ce2c87
      iscommand: false
      name: AutoFocus Found URL Malicious ?
      type: condition
      version: -1
    taskid: 22a20df7-2eb1-4202-87eb-5b7967ce2c87
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -210,
          "y": -1190
        }
      }
  "111":
    continueonerror: true
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "122"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: AFURL.URL.Address
      value:
        complex:
          accessor: IndicatorValue
          filters:
          - - left:
                iscontext: true
                value:
                  simple: AutoFocus.URL.LatestPanVerdicts.PAN_DB
              operator: isNotEqualString
              right:
                value:
                  simple: BENIGN
          root: AutoFocus.URL
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: '[.]'
              toReplace:
                value:
                  simple: .
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 854fff03-3681-4e55-8007-9e9ddd3612f2
      iscommand: false
      name: Set AutoFocus Malicious Context
      script: Set
      type: regular
      version: -1
    taskid: 854fff03-3681-4e55-8007-9e9ddd3612f2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": -990
        }
      }
  "113":
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9e5326aa-345a-484a-81e8-98660005facc
      iscommand: false
      name: Access & Notify
      type: title
      version: -1
    taskid: 9e5326aa-345a-484a-81e8-98660005facc
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -210,
          "y": -210
        }
      }
  "119":
    continueonerror: true
    continueonerrortype: ""
    id: "119"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "125"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: RFURL.URL.RiskScore
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.URL.riskScore
              operator: greaterThan
              right:
                value:
                  simple: "0"
          root: RecordedFuture.URL.riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9f56f860-bca6-4688-8b73-60c4b2124072
      iscommand: false
      name: Set RF Malicious Context Verdict
      script: Set
      type: regular
      version: -1
    taskid: 9f56f860-bca6-4688-8b73-60c4b2124072
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1160,
          "y": -810
        }
      }
  "120":
    continueonerror: true
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "126"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ZSURL.URL.Verdict
      value:
        complex:
          accessor: urlClassificationsWithSecurityAlert
          root: URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 95fb3af4-1f11-4955-8a6b-436b7492b834
      iscommand: false
      name: Set Zscaler Malicious Context Verdict
      script: Set
      type: regular
      version: -1
    taskid: 95fb3af4-1f11-4955-8a6b-436b7492b834
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -720,
          "y": -810
        }
      }
  "121":
    continueonerror: true
    continueonerrortype: ""
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "113"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: VTURL.Title
      value:
        simple: 'VirusTotal:'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f725f48b-04ae-4821-8f24-656395174df9
      iscommand: false
      name: Set VirusTotal Malicious Context Verdict
      script: Set
      type: regular
      version: -1
    taskid: f725f48b-04ae-4821-8f24-656395174df9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": -810
        }
      }
  "122":
    continueonerror: true
    continueonerrortype: ""
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "127"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: AFURL.URL.Verdict
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: AutoFocus.URL.LatestPanVerdicts.PAN_DB
              operator: isNotEqualString
              right:
                value:
                  simple: BENIGN
          root: AutoFocus.URL.LatestPanVerdicts.PAN_DB
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1952d2b5-1de7-49c8-8575-53de1234ba61
      iscommand: false
      name: Set AutoFocus Malicious Context Verdict
      script: Set
      type: regular
      version: -1
    taskid: 1952d2b5-1de7-49c8-8575-53de1234ba61
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": -810
        }
      }
  "123":
    continueonerrortype: ""
    id: "123"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 686681c8-d40b-4636-8d78-740502c84569
      iscommand: false
      name: Delete Context URL
      script: DeleteContext
      type: regular
      version: -1
    taskid: 686681c8-d40b-4636-8d78-740502c84569
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1160,
          "y": -500
        }
      }
  "124":
    continueonerrortype: ""
    id: "124"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "109"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 8595e5c7-668b-4057-8ae4-0ab9780c7cde
      iscommand: false
      name: Delete Context URL
      script: DeleteContext
      type: regular
      version: -1
    taskid: 8595e5c7-668b-4057-8ae4-0ab9780c7cde
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -720,
          "y": -500
        }
      }
  "125":
    continueonerrortype: ""
    id: "125"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    scriptarguments:
      table:
        simple: ${RFURL.URL}
      title:
        simple: Recorded Future - URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Converts a given array to an HTML table
      id: 4d5164b5-97e8-4dcd-8ee9-059981afad14
      iscommand: false
      name: Create HTML Table
      script: ConvertTableToHTML
      type: regular
      version: -1
    taskid: 4d5164b5-97e8-4dcd-8ee9-059981afad14
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1160,
          "y": -660
        }
      }
  "126":
    continueonerrortype: ""
    id: "126"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "124"
    note: false
    quietmode: 0
    scriptarguments:
      table:
        simple: ${ZSURL.URL}
      title:
        simple: Zscaler - URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Converts a given array to an HTML table
      id: d3f3fa64-799d-49ca-8cec-d77992072b69
      iscommand: false
      name: Create HTML Table
      script: ConvertTableToHTML
      type: regular
      version: -1
    taskid: d3f3fa64-799d-49ca-8cec-d77992072b69
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -720,
          "y": -660
        }
      }
  "127":
    continueonerrortype: ""
    id: "127"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "113"
    note: false
    quietmode: 0
    scriptarguments:
      table:
        simple: ${AFURL.URL}
      title:
        simple: AutoFocus - URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Converts a given array to an HTML table
      id: 3e7a9105-c68c-4cb5-8f9a-5cd4689b98aa
      iscommand: false
      name: Create HTML Table
      script: ConvertTableToHTML
      type: regular
      version: -1
    taskid: 3e7a9105-c68c-4cb5-8f9a-5cd4689b98aa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": -660
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1515,
        "width": 2190,
        "x": -1160,
        "y": -1660
      }
    }
  }
