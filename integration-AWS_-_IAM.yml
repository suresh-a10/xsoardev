category: IT Services
commonfields:
  id: AWS - IAM
  version: -1
configuration:
- display: Role Arn
  name: roleArn
  required: false
  section: Connect
  type: 0
- display: Role Session Name
  name: roleSessionName
  required: false
  section: Connect
  type: 0
- advanced: true
  display: AWS Default Region
  name: defaultRegion
  options:
  - us-east-1
  - us-east-2
  - us-west-1
  - us-west-2
  - ca-central-1
  - eu-west-1
  - eu-central-1
  - eu-west-2
  - ap-northeast-1
  - ap-northeast-2
  - ap-southeast-1
  - ap-southeast-2
  - ap-south-1
  - sa-east-1
  - eu-north-1
  - eu-west-3
  - us-gov-east-1
  - us-gov-west-1
  required: true
  section: Collect
  type: 15
- advanced: true
  display: Role Session Duration
  name: sessionDuration
  required: false
  section: Connect
  type: 0
- display: Access Key
  displaypassword: Secret Key
  name: credentials
  required: false
  section: Connect
  type: 9
- display: Access Key
  hidden: true
  name: access_key
  required: false
  section: Connect
  type: 0
- display: Secret Key
  hidden: true
  name: secret_key
  required: false
  section: Connect
  type: 4
- additionalinfo: The time in seconds till a timeout exception is reached. You can
    specify just the read timeout (for example 60) or also the connect timeout followed
    after a comma (for example 60,10). If a connect timeout is not specified, a default
    of 10 second will be used.
  advanced: true
  defaultvalue: 60,10
  display: Timeout
  name: timeout
  required: false
  section: Connect
  type: 0
- additionalinfo: 'The maximum number of retry attempts when connection or throttling
    errors are encountered. Set to 0 to disable retries. The default value is 5 and
    the limit is 10. Note: Increasing the number of retries will increase the execution
    time.'
  advanced: true
  defaultvalue: "5"
  display: Retries
  name: retries
  required: false
  section: Connect
  type: 0
- additionalinfo: Sets the AWS_STS_REGIONAL_ENDPOINTS environment variable to specify
    the AWS STS endpoint resolution logic. By default, this option is set to “legacy”
    in AWS. Leave empty if the environment variable is already set using server configuration.
  display: AWS STS Regional Endpoints
  name: sts_regional_endpoint
  options:
  - legacy
  - regional
  required: false
  section: Connect
  type: 15
- advanced: true
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  section: Connect
  type: 8
- advanced: true
  display: Use system proxy settings
  name: proxy
  required: false
  section: Connect
  type: 8
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: 1.1.64
    packID: AWS-IAM
    packName: AWS - IAM
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: Amazon Web Services Identity and Access Management (IAM).
detaileddescription: '[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/aws---iam)'
display: AWS - Identity and Access Management
image: data:image/png;base64,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
name: AWS - IAM
script:
  commands:
  - arguments:
    - description: The name of the user to create.
      name: userName
      required: true
    - description: The path for the user name. This parameter is optional. If it is
        not included, it defaults to a slash (/).
      name: path
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Creates a new IAM user for your AWS account.
    name: aws-iam-create-user
    outputs:
    - contextPath: AWS.IAM.Users.UserName
      description: The friendly name identifying the user.
      type: string
    - contextPath: AWS.IAM.Users.UserId
      description: The stable and unique string identifying the user.
      type: string
    - contextPath: AWS.IAM.Users.Arn
      description: The Amazon Resource Name (ARN) that identifies the user.
      type: string
    - contextPath: AWS.IAM.Users.CreateDate
      description: The date and time, when the user was created.
      type: date
    - contextPath: AWS.IAM.Users.Path
      description: The path to the user.
      type: string
  - arguments:
    - description: The name of the user to get information about.
      name: userName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Retrieves information about the specified IAM user, including the
      user's creation date, path, unique ID, and ARN.
    name: aws-iam-get-user
    outputs:
    - contextPath: AWS.IAM.Users.UserName
      description: The friendly name identifying the user.
      type: string
    - contextPath: AWS.IAM.Users.UserId
      description: The stable and unique string identifying the user.
      type: string
    - contextPath: AWS.IAM.Users.Arn
      description: The Amazon Resource Name (ARN) that identifies the user.
      type: string
    - contextPath: AWS.IAM.Users.CreateDate
      description: The date and time when the user was created.
      type: date
    - contextPath: AWS.IAM.Users.Path
      description: The path to the user.
      type: string
    - contextPath: AWS.IAM.Users.PasswordLastUsed
      description: The date and time,  when the user's password was last used to sign
        in to an AWS website.
      type: date
  - arguments:
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Lists the IAM users, returns all users in the AWS account.
    name: aws-iam-list-users
    outputs:
    - contextPath: AWS.IAM.Users.UserName
      description: The friendly name identifying the user.
      type: string
    - contextPath: AWS.IAM.Users.UserId
      description: The stable and unique string identifying the user.
      type: string
    - contextPath: AWS.IAM.Users.Arn
      description: The Amazon Resource Name (ARN) that identifies the user.
      type: string
    - contextPath: AWS.IAM.Users.CreateDate
      description: The date and time when the user was created.
      type: date
    - contextPath: AWS.IAM.Users.Path
      description: The path to the user.
      type: string
    - contextPath: AWS.IAM.Users.PasswordLastUsed
      description: The date and time when the password was last used.
      type: date
  - arguments:
    - description: Name of the user to update.
      name: oldUserName
      required: true
    - description: New name for the user. Include this parameter only if you're changing
        the user's name.
      name: newUserName
    - description: New path for the IAM user. Include this parameter only if you're
        changing the user's path.
      name: newPath
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Updates the name and/or the path of the specified IAM user.
    name: aws-iam-update-user
  - arguments:
    - description: The name of the user to delete.
      name: userName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deletes the specified IAM user. The user must not belong to any groups
      or have any access keys, signing certificates, or attached policies.
    name: aws-iam-delete-user
  - arguments:
    - description: The name of the user whose password you want to update.
      name: userName
      required: true
    - description: The new password for the specified IAM user.
      name: newPassword
      required: true
    - auto: PREDEFINED
      description: Allows this new password to be used only once by requiring the
        specified IAM user to set a new password on next sign-in.
      name: passwordResetRequired
      predefined:
      - "True"
      - "False"
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Changes the password for the specified IAM user.
    name: aws-iam-update-login-profile
  - arguments:
    - description: The name of the group to create. Do not include the path in this
        value.
      name: groupName
    - description: The path to the group.
      name: path
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Creates a new iam group.
    name: aws-iam-create-group
    outputs:
    - contextPath: AWS.IAM.Groups.GroupName
      description: The friendly name that identifies the group.
      type: string
    - contextPath: AWS.IAM.Groups.GroupId
      description: The stable and unique string identifying the group.
      type: string
    - contextPath: AWS.IAM.Groups.Arn
      description: The Amazon Resource Name (ARN) specifying the group.
      type: string
    - contextPath: AWS.IAM.Groups.CreateDate
      description: The date and time when the group was created.
      type: date
    - contextPath: AWS.IAM.Groups.Path
      description: The path to the group.
      type: string
  - arguments:
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Lists all the IAM groups in the AWS account.
    name: aws-iam-list-groups
    outputs:
    - contextPath: AWS.IAM.Groups.GroupName
      description: The friendly name that identifies the group.
      type: string
    - contextPath: AWS.IAM.Groups.GroupId
      description: The stable and unique string identifying the group.
      type: string
    - contextPath: AWS.IAM.Groups.Arn
      description: The Amazon Resource Name (ARN) specifying the group.
      type: string
    - contextPath: AWS.IAM.Groups.CreateDate
      description: The date and time when the group was created.
      type: date
    - contextPath: AWS.IAM.Groups.Path
      description: The path to the group.
      type: string
  - arguments:
    - description: The name of the user to list groups for.
      name: userName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Lists the IAM groups that the specified IAM user belongs to.
    name: aws-iam-list-groups-for-user
    outputs:
    - contextPath: AWS.IAM.Users.Groups.GroupName
      description: The friendly name that identifies the group.
      type: string
    - contextPath: AWS.IAM.Users.Groups.GroupId
      description: The stable and unique string identifying the group.
      type: string
    - contextPath: AWS.IAM.Users.Groups.Arn
      description: The Amazon Resource Name (ARN) specifying the group.
      type: string
    - contextPath: AWS.IAM.Users.Groups.CreateDate
      description: The date and time when the group was created.
      type: date
    - contextPath: AWS.IAM.Users.Groups.Path
      description: The path to the group.
      type: string
  - arguments:
    - description: The name of the user to add.
      name: userName
      required: true
    - description: The name of the group to update.
      name: groupName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Adds the specified user to the specified group.
    name: aws-iam-add-user-to-group
  - arguments:
    - description: The name of the IAM user that the new key will belong to. If username
        is not provided, the account name configured in your integration will be used.
      name: userName
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Creates a new AWS secret access key and corresponding AWS access
      key ID for the specified user. The default status for new keys is Active .
    name: aws-iam-create-access-key
    outputs:
    - contextPath: AWS.IAM.Users.AccessKeys.AccessKeyId
      description: The ID for this access key.
      type: string
    - contextPath: AWS.IAM.Users.AccessKeys.SecretAccessKey
      description: The secret key used to sign requests.
      type: string
    - contextPath: AWS.IAM.Users.AccessKeys.Status
      description: The status of the access key. Active means that the key is valid
        for API calls, while Inactive means it is not.
      type: string
    - contextPath: AWS.IAM.Users.AccessKeys.CreateDate
      description: The date when the access key was created.
      type: date
  - arguments:
    - description: The name of the user whose key you want to update. If username
        is not provided, the account name configured in your integration will be used.
      name: userName
    - description: The access key ID of the secret access key you want to update.
      name: accessKeyId
      required: true
    - auto: PREDEFINED
      description: The status you want to assign to the secret access key. Active
        means that the key can be used for API calls to AWS, while Inactive means
        that the key cannot be used.
      name: status
      predefined:
      - Active
      - Inactive
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Changes the status of the specified access key from Active to Inactive,
      or vice versa. This operation can be used to disable a user's key as part of
      a key rotation workflow.
    name: aws-iam-update-access-key
  - arguments:
    - description: The name of the user.
      name: userName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Returns information about the access key IDs associated with the
      specified IAM user.
    name: aws-iam-list-access-keys-for-user
    outputs:
    - contextPath: AWS.IAM.Users.AccessKeys.AccessKeyId
      description: The ID for this access key.
      type: string
    - contextPath: AWS.IAM.Users.AccessKeys.Status
      description: The status of the access key. Active means the key is valid for
        API calls; Inactive means it is not.
      type: string
    - contextPath: AWS.IAM.Users.AccessKeys.CreateDate
      description: The date when the access key was created.
      type: date
    - contextPath: AWS.IAM.Users.AccessKeys.UserName
      description: The name of the IAM user that the key is associated with.
      type: string
  - arguments:
    - auto: PREDEFINED
      defaultValue: All
      description: The scope to use for filtering the results. To list only AWS managed
        policies, set Scope to AWS. To list only the customer managed policies in
        your AWS account, set Scope to Local.
      name: scope
      predefined:
      - All
      - AWS
      - Local
    - auto: PREDEFINED
      defaultValue: "False"
      description: A flag to filter the results to only the attached policies.  When
        OnlyAttached is true , the returned list contains only the policies that are
        attached to an IAM user, group, or role. When OnlyAttached is false , or when
        the parameter is not included, all policies are returned.
      name: onlyAttached
      predefined:
      - "True"
      - "False"
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Lists all the managed policies that are available in your AWS account,
      including your own customer-defined managed policies and all AWS managed policies.
    name: aws-iam-list-policies
    outputs:
    - contextPath: AWS.IAM.Policies.PolicyName
      description: The friendly name (not ARN) identifying the policy.
      type: string
    - contextPath: AWS.IAM.Policies.PolicyId
      description: The stable and unique string identifying the policy.
      type: string
    - contextPath: AWS.IAM.Policies.Arn
      description: The Amazon Resource Name (ARN).
      type: string
    - contextPath: AWS.IAM.Policies.Path
      description: The path to the policy.
      type: string
    - contextPath: AWS.IAM.Policies.DefaultVersionId
      description: The identifier for the version of the policy that is set as the
        default version.
      type: string
    - contextPath: AWS.IAM.Policies.IsAttachable
      description: Specifies whether the policy can be attached to an IAM user, group,
        or role.
      type: string
    - contextPath: AWS.IAM.Policies.CreateDate
      description: when the policy was created.
      type: date
    - contextPath: AWS.IAM.Policies.UpdateDate
      description: when the policy was last updated.
      type: date
    - contextPath: AWS.IAM.Policies.AttachmentCount
      description: The number of entities (users, groups, and roles) that the policy
        is attached to.
      type: number
  - arguments:
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Lists all IAM roles.
    name: aws-iam-list-roles
    outputs:
    - contextPath: AWS.IAM.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.Roles.CreateDate
      description: The date and time when the role was created.
      type: date
    - contextPath: AWS.IAM.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
        Anyone who uses the AWS CLI or API to assume the role can specify the duration
        using the optional DurationSeconds API parameter or duration-seconds CLI parameter.
      type: number
  - arguments:
    - auto: PREDEFINED
      description: The Type of IAM Entity.
      name: type
      predefined:
      - User
      - Group
      - Role
      required: true
    - description: The name (friendly name, not ARN) of the IAM Entity to attach the
        policy to.
      name: entityName
    - description: The Amazon Resource Name (ARN) of the IAM policy you want to attach.
      name: policyArn
    description: Attaches the specified managed policy to the specified IAM Entity.
    name: aws-iam-attach-policy
  - arguments:
    - auto: PREDEFINED
      description: IAM Entity Type.
      name: type
      predefined:
      - User
      - Group
      - Role
      required: true
    - description: The name (friendly name, not ARN) of the IAM Entity to detach the
        policy from.
      name: entityName
    - description: The Amazon Resource Name (ARN) of the IAM policy you want to detach.
      name: policyArn
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Removes the specified managed policy from the specified IAM Entity.
    name: aws-iam-detach-policy
  - arguments:
    - description: The name of the user whose password you want to delete.
      name: userName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deletes the password for the specified IAM user, which terminates
      the user's ability to access AWS services through the AWS Management Console.
    name: aws-iam-delete-login-profile
  - arguments:
    - description: The name of the IAM group to delete.
      name: groupName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deletes the specified IAM group. The group must not contain any users
      or have any attached policies.
    name: aws-iam-delete-group
  - arguments:
    - description: The name of the user to remove.
      name: userName
      required: true
    - description: The name of the group to update.
      name: groupName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Removes the specified user from the specified group.
    name: aws-iam-remove-user-from-group
  - arguments:
    - description: The name of the IAM user to create a password for. The user must
        already exist.
      name: userName
      required: true
    - description: The new password for the user.
      name: password
      required: true
    - auto: PREDEFINED
      description: Specifies whether the user is required to set a new password on
        next sign-in.
      name: passwordResetRequired
      predefined:
      - "True"
      - "False"
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Creates a password for the specified user, giving the user the ability
      to access AWS services through the AWS Management Console.
    name: aws-iam-create-login-profile
  - arguments:
    - description: The name of the user whose access key pair you want to delete.
        If username is not provided, the account name configured in your integration
        will be used.
      name: userName
    - description: The access key ID for the access key ID and secret access key you
        want to delete.
      name: AccessKeyId
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deletes the access key pair associated with the specified IAM user.
    name: aws-iam-delete-access-key
  - arguments:
    - description: The name of the instance profile to create.
      name: instanceProfileName
      required: true
    - description: The path to the instance profile.
      name: path
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Creates a new instance profile.
    name: aws-iam-create-instance-profile
    outputs:
    - contextPath: AWS.IAM.InstanceProfiles.Path
      description: The path to the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileName
      description: The name identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileId
      description: The stable and unique string identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Arn
      description: The Amazon Resource Name (ARN) specifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.CreateDate
      description: The date when the instance profile was created.
      type: date
  - arguments:
    - description: The name of the instance profile to delete.
      name: instanceProfileName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deletes the specified instance profile. The instance profile must
      not have an associated role.
    name: aws-iam-delete-instance-profile
  - arguments:
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Lists all the instance profiles tin your AWS account.
    name: aws-iam-list-instance-profiles
    outputs:
    - contextPath: AWS.IAM.InstanceProfiles.Path
      description: The path to the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileName
      description: The name identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileId
      description: The stable and unique string identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Arn
      description: The Amazon Resource Name (ARN) specifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.CreateDate
      description: The date when the instance profile was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
  - arguments:
    - description: The name of the instance profile to update.
      name: instanceProfileName
      required: true
    - description: The name of the role to add.
      name: roleName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Adds the specified IAM role to the specified instance profile. An
      instance profile can contain only one role, and this limit cannot be increased.
      You can remove the existing role and then add a different role to an instance
      profile.
    name: aws-iam-add-role-to-instance-profile
    outputs:
    - contextPath: AWS.IAM.InstanceProfiles.Path
      description: The path to the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileName
      description: The name identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileId
      description: The stable and unique string identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Arn
      description: The Amazon Resource Name (ARN) specifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.CreateDate
      description: The date when the instance profile was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
  - arguments:
    - description: The name of the instance profile to update.
      name: instanceProfileName
      required: true
    - description: The name of the role to remove.
      name: roleName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Removes the specified IAM role from the specified EC2 instance profile.
    name: aws-iam-remove-role-from-instance-profile
    outputs:
    - contextPath: AWS.IAM.InstanceProfiles.Path
      description: The path to the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileName
      description: The name identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileId
      description: The stable and unique string identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Arn
      description: The Amazon Resource Name (ARN) specifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.CreateDate
      description: The date when the instance profile was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
  - arguments:
    - description: The name of the role to list instance profiles for.
      name: roleName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Lists the instance profiles that have the specified associated IAM
      role.
    name: aws-iam-list-instance-profiles-for-role
    outputs:
    - contextPath: AWS.IAM.InstanceProfiles.Path
      description: The path to the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileName
      description: The name identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileId
      description: The stable and unique string identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Arn
      description: The Amazon Resource Name (ARN) specifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.CreateDate
      description: The date when the instance profile was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
  - arguments:
    - description: The name of the instance profile to get information about.
      name: instanceProfileName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Retrieves information about the specified instance profile.
    name: aws-iam-get-instance-profile
    outputs:
    - contextPath: AWS.IAM.InstanceProfiles.Path
      description: The path to the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileName
      description: The name identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileId
      description: The stable and unique string identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Arn
      description: The Amazon Resource Name (ARN) specifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.CreateDate
      description: The date when the instance profile was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles. MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
  - arguments:
    - description: The name of the IAM role to get information about.
      name: roleName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Retrieves information about the specified role.
    name: aws-iam-get-role
    outputs:
    - contextPath: AWS.IAM.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
    - contextPath: AWS.IAM.Roles.Tags.Key
      description: The tag key.
      type: string
    - contextPath: AWS.IAM.Roles.Tags.Value
      description: The tag value.
      type: string
  - arguments:
    - description: The name of the role to delete.
      name: roleName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deletes the specified role. The role must not have any policies attached.
    name: aws-iam-delete-role
  - arguments:
    - description: The name of the role to create.
      name: roleName
      required: true
    - description: The trust relationship policy document that grants an entity permission
        to assume the role.
      name: assumeRolePolicyDocument
      required: true
    - description: The path to the role.
      name: path
    - description: A description of the role.
      name: description
    - description: The maximum session duration (in seconds) that you want to set
        for the specified role. If you do not specify a value for this setting, the
        default maximum of one hour is applied. This setting can have a value from
        1 hour to 12 hours.
      name: maxSessionDuration
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Creates a new role for your AWS account.
    name: aws-iam-create-role
    outputs:
    - contextPath: AWS.IAM.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.Roles.AssumeRolePolicyDocument
      description: he policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
  - arguments:
    - description: The friendly name of the policy.
      name: policyName
      required: true
    - description: The JSON policy document that you want to use as the content for
        the new policy.
      name: policyDocument
      required: true
    - description: The path for the policy.
      name: path
    - description: A friendly description of the policy.
      name: description
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Creates a new managed policy for your AWS account.  This operation
      creates a policy version with a version identifier of v1 and sets v1 as the
      policy's default version.
    execution: true
    name: aws-iam-create-policy
    outputs:
    - contextPath: AWS.IAM.Policies.PolicyName
      description: The friendly name (not ARN) identifying the policy.
      type: string
    - contextPath: AWS.IAM.Policies.PolicyId
      description: The stable and unique string identifying the policy.
      type: string
    - contextPath: AWS.IAM.Policies.Arn
      description: The Amazon Resource Name (ARN). ARNs are unique identifiers for
        AWS resources.
      type: string
    - contextPath: AWS.IAM.Policies.Path
      description: The path to the policy.
      type: string
    - contextPath: AWS.IAM.Policies.DefaultVersionId
      description: The identifier for the version of the policy that is set as the
        default version.
      type: string
    - contextPath: AWS.IAM.Policies.AttachmentCount
      description: The number of entities (users, groups, and roles) that the policy
        is attached to.
      type: number
    - contextPath: AWS.IAM.Policies.PermissionsBoundaryUsageCount
      description: The number of entities (users and roles) for which the policy is
        used to set the permissions boundary.
      type: number
    - contextPath: AWS.IAM.Policies.IsAttachable
      description: Specifies whether the policy can be attached to an IAM user, group,
        or role.
      type: boolean
    - contextPath: AWS.IAM.Policies.Description
      description: A friendly description of the policy.
      type: string
    - contextPath: AWS.IAM.Policies.CreateDate
      description: The date and time, in ISO 8601 date-time format , when the policy
        was created.
      type: date
    - contextPath: AWS.IAM.Policies.UpdateDate
      description: The date and time, in ISO 8601 date-time format , when the policy
        was last updated.
      type: date
  - arguments:
    - description: The Amazon Resource Name (ARN) of the IAM policy you want to delete.
      name: policyArn
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deletes the specified managed policy.  Before you can delete a managed
      policy, you must first detach the policy from all users, groups, and roles that
      it is attached to. In addition you must delete all the policy's versions.
    execution: true
    name: aws-iam-delete-policy
  - arguments:
    - description: The Amazon Resource Name (ARN) of the IAM policy to which you want
        to add a new version.
      name: policyArn
      required: true
    - description: The JSON policy document that you want to use as the content for
        this new version of the policy.
      name: policyDocument
      required: true
    - auto: PREDEFINED
      description: Specifies whether to set this version as the policy's default version.
      name: setAsDefault
      predefined:
      - "True"
      - "False"
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Creates a new version of the specified managed policy. To update
      a managed policy, you create a new policy version. A managed policy can have
      up to five versions. If the policy has five versions, you must delete an existing
      version using DeletePolicyVersion before you create a new version.  Optionally,
      you can set the new version as the policy's default version. The default version
      is the version that is in effect for the IAM users, groups, and roles to which
      the policy is attached.
    execution: true
    name: aws-iam-create-policy-version
    outputs:
    - contextPath: AWS.IAM.Policies.Versions.Document
      description: The policy document.
      type: string
    - contextPath: AWS.IAM.Policies.Versions.VersionId
      description: The identifier for the policy version.
      type: string
    - contextPath: AWS.IAM.Policies.Versions.IsDefaultVersion
      description: The identifier for the policy version.
      type: string
    - contextPath: AWS.IAM.Policies.Versions.CreateDate
      description: The date and time, in ISO 8601 date-time format , when the policy
        version was created.
      type: string
  - arguments:
    - description: The Amazon Resource Name (ARN) of the IAM policy from which you
        want to delete a version.
      name: policyArn
      required: true
    - description: The policy version to delete.
      name: versionId
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deletes the specified version from the specified managed policy.  You
      cannot delete the default version from a policy using this API. To delete the
      default version from a policy, use DeletePolicy . To find out which version
      of a policy is marked as the default version, use ListPolicyVersions .
    execution: true
    name: aws-iam-delete-policy-version
  - arguments:
    - description: The Amazon Resource Name (ARN) of the IAM policy for which you
        want the versions.
      name: policyArn
      required: true
    description: Lists information about the versions of the specified managed policy,
      including the version that is currently set as the policy's default version.
    name: aws-iam-list-policy-versions
    outputs:
    - contextPath: AWS.IAM.Policies.Versions.Document
      description: The policy document.
      type: string
    - contextPath: AWS.IAM.Policies.Versions.VersionId
      description: The identifier for the policy version.
      type: string
    - contextPath: AWS.IAM.Policies.Versions.IsDefaultVersion
      description: Specifies whether the policy version is set as the policy's default
        version.
      type: boolean
    - contextPath: AWS.IAM.Policies.Versions.CreateDate
      description: The date and time, in ISO 8601 date-time format , when the policy
        version was created.
      type: date
  - arguments:
    - description: The Amazon Resource Name (ARN) of the managed policy that you want
        information about.
      name: policyArn
      required: true
    - description: Identifies the policy version to retrieve.
      name: versionId
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Retrieves information about the specified version of the specified
      managed policy, including the policy document.
    name: aws-iam-get-policy-version
    outputs:
    - contextPath: AWS.IAM.Policies.Versions.Document
      description: The policy document.
      type: Unknown
    - contextPath: AWS.IAM.Policies.Versions.VersionId
      description: The identifier for the policy version.
      type: Unknown
    - contextPath: AWS.IAM.Policies.Versions.IsDefaultVersion
      description: Specifies whether the policy version is set as the policy's default
        version.
      type: Unknown
    - contextPath: AWS.IAM.Policies.Versions.CreateDate
      description: The date and time, in ISO 8601 date-time format , when the policy
        version was created.
      type: Unknown
  - arguments:
    - description: The Amazon Resource Name (ARN) of the IAM policy whose default
        version you want to set.
      name: policyArn
      required: true
    - description: The version of the policy to set as the default (operative) version.
      name: versionId
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Sets the specified version of the specified policy as the policy's
      default (operative) version.  This operation affects all users, groups, and
      roles that the policy is attached to.
    execution: true
    name: aws-iam-set-default-policy-version
  - arguments:
    - description: The account alias to create.
      name: accountAlias
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Creates an alias for your AWS account.
    execution: true
    name: aws-iam-create-account-alias
  - arguments:
    - description: The name of the account alias to delete.
      name: accountAlias
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deletes the specified AWS account alias.
    execution: true
    name: aws-iam-delete-account-alias
  - arguments: []
    description: Get AWS account's password policy.
    name: aws-iam-get-account-password-policy
    outputs:
    - contextPath: AWS.IAM.PasswordPolicy
      description: Account's password policy.
      type: Unknown
  - arguments:
    - description: The minimum number of characters allowed in an IAM user password.
      name: minimumPasswordLength
      predefined:
      - ""
    - auto: PREDEFINED
      description: Specifies whether IAM user passwords must contain at least one
        of the non-alphanumeric characters. Can be "True" or "False".
      name: requireSymbols
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      description: Specifies whether IAM user passwords must contain at least one
        numeric character (0 to 9). Can be "True" or "False".
      name: requireNumbers
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      description: Specifies whether IAM user passwords must contain at least one
        uppercase character from the ISO basic Latin alphabet (A to Z). Can be "True"
        or "False".
      name: requireUppercaseCharacters
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      description: Specifies whether IAM user passwords must contain at least one
        lowercase character from the ISO basic Latin alphabet (a to z). Can be "True"
        or "False".
      name: requireLowercaseCharacters
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      description: Allows all IAM users in your account to use the AWS Management
        Console to change their own passwords. Can be "True" or "False".
      name: allowUsersToChangePassword
      predefined:
      - "True"
      - "False"
    - description: The number of days that an IAM user password is valid.
      name: maxPasswordAge
      predefined:
      - ""
    - description: Specifies the number of previous passwords that IAM users are prevented
        from reusing.
      name: passwordReusePrevention
      predefined:
      - ""
    - auto: PREDEFINED
      description: Prevents IAM users from setting a new password after their password
        has expired. Can be "True" or "False".
      name: hardExpiry
      predefined:
      - "True"
      - "False"
    description: Create/update password policy.
    execution: true
    name: aws-iam-update-account-password-policy
  - arguments:
    - description: The name of the role to list policies for.
      name: roleName
      required: true
    description: Lists the names of the inline policies that are embedded in the specified
      IAM role.
    name: aws-iam-list-role-policies
    outputs:
    - contextPath: AWS.IAM.Roles.RoleName.Policies
      description: A list of policy names.
      type: Unknown
  - arguments:
    - description: The name of the role associated with the policy.
      name: roleName
      required: true
    - description: The name of the policy document to get.
      name: policyName
      required: true
    description: Retrieves the specified inline policy document that is embedded with
      the specified IAM role.
    name: aws-iam-get-role-policy
    outputs:
    - contextPath: AWS.IAM.Roles.PolicyDocument
      description: The policy document.
      type: string
  - arguments:
    - description: The Amazon Resource Name (ARN) of the managed policy that you want
        information about.
      name: policyArn
      required: true
    description: Retrieves information about the specified managed policy, including
      the policy's default version and the total number of IAM users, groups, and
      roles to which the policy is attached.
    name: aws-iam-get-policy
    outputs:
    - contextPath: AWS.IAM.Policy.PolicyName
      description: The friendly name (not ARN) identifying the policy.
      type: string
    - contextPath: AWS.IAM.Policy.PolicyId
      description: The stable and unique string identifying the policy.
      type: string
    - contextPath: AWS.IAM.Policy.Arn
      description: The Amazon Resource Name (ARN). ARNs are unique identifiers for
        Amazon Web Services resources.
      type: string
    - contextPath: AWS.IAM.Policy.Path
      description: The path to the policy.
      type: string
    - contextPath: AWS.IAM.Policy.Description
      description: A friendly description of the policy.
      type: string
  - arguments:
    - description: The name (friendly name, not ARN) of the user to list attached
        policies for.
      name: userName
      required: true
    - defaultValue: "50"
      description: Number of results to display.
      name: limit
    - description: Page number you would like to view. Each page contains page_size
        values. Must be used along with page_size.
      name: page
    - description: Number of results per page to display.
      name: page_size
    - description: Starting item of the next page to view. Retrieved from a previous
        run of the command (InlinePoliciesMarker).
      name: marker
    description: Lists the names of the inline policies embedded in the specified
      IAM user.
    name: aws-iam-list-user-policies
    outputs:
    - contextPath: AWS.IAM.UserPolicies.UserName
      description: The name (friendly name, not ARN) of the user to list attached
        policies for.
      type: String
    - contextPath: AWS.IAM.UserPolicies.PolicyName
      description: The name of the policy.
      type: String
    - contextPath: AWS.IAM.Users.InlinePoliciesMarker
      description: First element of next page of items.
      type: String
  - arguments:
    - description: The name (friendly name, not ARN) of the user to list attached
        policies for.
      name: userName
      required: true
    - defaultValue: "50"
      description: Number of results to display.
      name: limit
    - description: Page number you would like to view. Each page contains page_size
        values. Must be used along with page_size.
      name: page
    - description: Number of results per page to display.
      name: page_size
    - description: Starting item of the next page to view. Can be retrieved from context
        (AttachedPoliciesMarker).
      name: marker
    description: Lists all managed policies that are attached to the specified IAM
      user.
    name: aws-iam-list-attached-user-policies
    outputs:
    - contextPath: AWS.IAM.AttachedUserPolicies.UserName
      description: The name (friendly name, not ARN) of the user to list attached
        policies for.
      type: String
    - contextPath: AWS.IAM.AttachedUserPolicies.PolicyName
      description: The name of the attached policy.
      type: String
    - contextPath: AWS.IAM.AttachedUserPolicies.PolicyArn
      description: The Amazon Resource Name (ARN) of the attached policy.
      type: String
    - contextPath: AWS.IAM.Users.AttachedPoliciesMarker
      description: First element of next page of items.
      type: String
  - arguments:
    - description: The name (friendly name, not ARN) of the group to list attached
        policies for.
      name: groupName
      required: true
    - defaultValue: "50"
      description: Number of results to display.
      name: limit
    - description: Page number you would like to view. Each page contains page_size
        values. Must be used along with page_size.
      name: page
    - description: Number of results per page to display.
      name: page_size
    - description: Starting item of the next page to view. Can be retrieved from context
        (AttachedPoliciesMarker).
      name: marker
    description: Lists all managed policies that are attached to the specified IAM
      group.
    name: aws-iam-list-attached-group-policies
    outputs:
    - contextPath: AWS.IAM.AttachedGroupPolicies.GroupName
      description: The name (friendly name, not ARN) of the group to list attached
        policies for.
      type: String
    - contextPath: AWS.IAM.AttachedGroupPolicies.PolicyName
      description: The name of the attached policy.
      type: String
    - contextPath: AWS.IAM.AttachedGroupPolicies.PolicyArn
      description: The Amazon Resource Name (ARN) of the attached policy.
      type: String
    - contextPath: AWS.IAM.Groups.AttachedPoliciesMarker
      description: First element of next page of items.
      type: String
  - arguments:
    - description: The name (friendly name, not ARN) of the user to list attached
        policies for.
      name: userName
      required: true
    description: Retrieves the user login profile information for AWS management consle.
    name: aws-iam-get-user-login-profile
    outputs:
    - contextPath: AWS.IAM.Users.LoginProfile.CreateDate
      description: The date when the password for the user was created.
      type: Date
    - contextPath: AWS.IAM.Users.LoginProfile.PasswordResetRequired
      description: Specifies whether the user is required to set a new password on
        next sign-in.
      type: Boolean
  - arguments:
    - description: The policy document. You must provide policies in JSON format in
        IAM.
      name: policyDocument
      required: true
    - description: The name of the policy document.
      name: policyName
      required: true
    - description: The name of the role to associate the policy with.
      name: roleName
      required: true
    description: Adds or updates an inline policy document that is embedded in the
      specified IAM role.
    name: aws-iam-put-role-policy
  - arguments:
    - description: The policy document. You must provide policies in JSON format in
        IAM.
      name: policyDocument
      required: true
    - description: The name of the policy document.
      name: policyName
      required: true
    - description: The name of the user to associate the policy with.
      name: userName
      required: true
    description: Adds or updates an inline policy document that is embedded in the
      specified IAM user.
    name: aws-iam-put-user-policy
  - arguments:
    - description: The policy document. You must provide policies in JSON format in
        IAM.
      name: policyDocument
      required: true
    - description: The name of the policy document.
      name: policyName
      required: true
    - description: The name of the group to associate the policy with.
      name: groupName
      required: true
    description: Adds or updates an inline policy document that is embedded in the
      specified IAM group.
    name: aws-iam-put-group-policy
  - arguments:
    - description: The name of the IAM role to which you want to add tags.
      name: roleName
      required: true
    - description: A comma-separated list of Key:Value tag objects. I.e., Key1:Value1,Key2:Value2.
      isArray: true
      name: tags
      required: true
    description: Adds one or more tags to an IAM role. The role can be a regular role
      or a service-linked role. If a tag with the same key name already exists, then
      that tag is overwritten with the new value.
    name: aws-iam-tag-role
  - arguments:
    - description: The name of the IAM user to which you want to add tags.
      name: userName
      required: true
    - description: A comma-separated list of Key:Value tag objects. I.e., Key1:Value1,Key2:Value2.
      isArray: true
      name: tags
      required: true
    description: Adds one or more tags to an IAM user. If a tag with the same key
      name already exists, then that tag is overwritten with the new value.
    name: aws-iam-tag-user
  - arguments:
    - description: The name of the IAM role to which you want to untag.
      name: userName
      required: true
    - description: A comma-separated list of tag keys.
      isArray: true
      name: tagKeys
      required: true
    description: Removes the specified tags from the user.
    name: aws-iam-untag-user
  - arguments:
    - description: The name of the IAM role to which you want to untag.
      name: roleName
      required: true
    - description: A comma-separated list of tag keys.
      isArray: true
      name: tagKeys
      required: true
    description: Removes the specified tags from the role.
    name: aws-iam-untag-role
  - arguments:
    - description: The identifier of an access key.
      name: accessKeyId
      required: true
    description: Retrieves information about when the specified access key was last
      used. The information includes the date and time of last use, along with the
      AWS service and region that were specified in the last request made with that
      key.
    name: aws-iam-get-access-key-last-used
    outputs:
    - contextPath: AWS.IAM.AccessKey.ID
      description: The access key ID.
      type: string
    - contextPath: AWS.IAM.AccessKey.UserName
      description: The username owning the given access key.
      type: string
    - contextPath: AWS.IAM.AccessKey.LastUsedServiceName
      description: The name of the service that last used the given access key.
      type: string
    - contextPath: AWS.IAM.AccessKey.LastUsedRegion
      description: The name of the region where the given access key was last used
        in.
      type: string
    - contextPath: AWS.IAM.AccessKey.LastUsedDate
      description: The date when the given access key was last used.
      type: string
  - arguments:
    - description: The name (friendly name, not ARN) of the role to list attached
        policies for.
      name: roleName
      required: true
    - description: The path prefix for filtering the results. This parameter is optional.
        If it is not included, it defaults to a slash (/), listing all policies.
      name: pathPrefix
    - description: The maximum number of items to return in the command's output.
      name: maxItems
    - description: Use this parameter only when paginating results and only after
        you receive a response indicating that the results are truncated. Set it to
        the value of the Marker element in the response that you received to indicate
        where the next call should start.
      name: marker
    description: List all managed policies that are attached to the specified IAM
      role.
    name: aws-iam-list-attached-role-policies
    outputs:
    - contextPath: AWS.IAM.Roles.AttachedPolicies.Policies.RoleName
      description: The role name.
      type: string
    - contextPath: AWS.IAM.Roles.AttachedPolicies.Policies.PolicyName
      description: The policy name.
      type: string
    - contextPath: AWS.IAM.Roles.AttachedPolicies.Policies.PolicyArn
      description: The policy ARN.
      type: string
    - contextPath: AWS.IAM.Roles.AttachedPolicies.Query.IsTruncated
      description: Whether there are more items to return. If the results were truncated,
        make a subsequent pagination request using the Marker request parameter to
        retrieve more items. Note that IAM might return fewer than the MaxItems number
        of results even when there are more results available. AWS recommends checking
        IsTruncated after every call to ensure that all results are received.
      type: boolean
    - contextPath: AWS.IAM.Roles.AttachedPolicies.Query.Marker
      description: When IsTruncated is true, this element is present and contains
        the value to use for the Marker parameter in a subsequent pagination request.
      type: string
  - arguments:
    - description: The name of the user whose MFA devices you want to list.
      name: userName
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: Use this parameter only when paginating results and only after
        you receive a response indicating that the results are truncated. Set it to
        the value of the Marker element in the response that you received to indicate
        where the next call should start.
      name: marker
    description: Lists the MFA devices for an IAM user.
    name: aws-iam-list-mfa-devices
    outputs:
    - contextPath: AWS.IAM.MFADevices.Devices.UserName
      description: The user with whom the MFA device is associated.
      type: string
    - contextPath: AWS.IAM.MFADevices.Devices.SerialNumber
      description: The serial number that uniquely identifies the MFA device. For
        virtual MFA devices, the serial number is the device ARN.
      type: string
    - contextPath: AWS.IAM.MFADevices.Devices.EnableDate
      description: The date when the MFA device was enabled for the user.
      type: date
    - contextPath: MFADevices.Devices.Marker
      description: First element of next page of items.
      type: string
  - arguments:
    - description: The name of the user whose MFA devices you want to list.
      name: userName
      required: true
    - description: The serial number that uniquely identifies the MFA device. For
        virtual MFA devices, the serial number is the same as the ARN.
      name: serialNumber
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deactivates the specified MFA device and removes it from association
      with the user name for which it was originally enabled.
    name: aws-iam-deactivate-mfa-devices
  - arguments:
    - description: The serial number that uniquely identifies the MFA device. For
        virtual MFA devices, the serial number is the same as the ARN.
      name: serialNumber
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deletes a virtual MFA device.
    name: aws-iam-delete-mfa-devices
  dockerimage: demisto/boto3py3:1.0.0.101103
  runonce: false
  script: |
    register_module_line('AWS - IAM', 'start', __line__())
    ### pack version: 1.1.64




    import botocore.exceptions
    from datetime import datetime, date


    SERVICE = 'iam'


    class DatetimeEncoder(json.JSONEncoder):
        # pylint: disable=method-hidden
        def default(self, obj):
            if isinstance(obj, datetime):
                return obj.strftime('%Y-%m-%dT%H:%M:%S')
            elif isinstance(obj, date):
                return obj.strftime('%Y-%m-%d')
            # Let the base class default method raise the TypeError
            return json.JSONEncoder.default(self, obj)


    def get_limit(args):
        """
        Args:
            args: Args input for command, this function uses limit, page and page_size

        Returns:
            - limit - how many items to request from AWS - IAM API.
            - is_manual - whether manual pagination is active (using page and page_size)
            - page_size - used when manual pagination is active, to bring the relevant number of results from the data.

        """
        limit = arg_to_number(str(args.get("limit"))) if "limit" in args else None
        page = arg_to_number(str(args.get("page"))) if "page" in args else None
        page_size = arg_to_number(str(args.get("page_size"))) if "page_size" in args else None

        if limit is None:
            if page is not None and page_size is not None:
                if page <= 0:
                    raise Exception('Chosen page number must be greater than 0')
                limit = page_size * page
                return limit, True, page_size
            else:
                limit = 50
        return limit, False, page_size


    def create_user(args, client):  # pragma: no cover
        kwargs = {'UserName': args.get('userName')}
        if args.get('path'):
            kwargs.update({'Path': args.get('path')})

        response = client.create_user(**kwargs)
        user = response['User']
        data = ({
            'UserName': user['UserName'],
            'UserId': user['UserId'],
            'Arn': user['Arn'],
            'CreateDate': datetime.strftime(user['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
            'Path': user['Path'],
        })
        ec = {'AWS.IAM.Users': data}
        human_readable = tableToMarkdown('AWS IAM Users', data)
        return_outputs(human_readable, ec)


    def create_login_profile(args, client):  # pragma: no cover
        kwargs = {
            'UserName': args.get('userName'),
            'Password': args.get('password')
        }
        if args.get('passwordResetRequired'):
            kwargs.update({'PasswordResetRequired': True if args.get(
                'passwordResetRequired') == 'True' else False})

        response = client.create_login_profile(**kwargs)
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("Login Profile Was Created For user {0} ".format(args.get('userName')))


    def get_user(args, client):  # pragma: no cover
        try:
            response = client.get_user(UserName=args.get('userName'))
        except Exception as e:
            if 'NoSuchEntity' in str(e):
                return_outputs(f'User {args.get("userName")} was not found.')
                return
            else:
                raise e

        user = response['User']
        data = ({
            'UserName': user['UserName'],
            'UserId': user['UserId'],
            'Arn': user['Arn'],
            'CreateDate': datetime.strftime(user['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
            'Path': user['Path'],
        })
        ec = {'AWS.IAM.Users': data}
        human_readable = tableToMarkdown('AWS IAM Users', data)
        return_outputs(human_readable, ec)


    def list_users(args, client):  # pragma: no cover
        data = []
        paginator = client.get_paginator('list_users')
        for response in paginator.paginate():
            for user in response['Users']:
                user_details = {
                    'UserName': user['UserName'],
                    'UserId': user['UserId'],
                    'Arn': user['Arn'],
                    'CreateDate': datetime.strftime(user['CreateDate'], '%Y-%m-%d %H:%M:%S'),
                    'Path': user['Path'],
                }
                if user.get('PasswordLastUsed'):
                    user_details['PasswordLastUsed'] = datetime.strftime(user['PasswordLastUsed'], '%Y-%m-%d %H:%M:%S')
                data.append(user_details)
        ec = {'AWS.IAM.Users': data}
        human_readable = tableToMarkdown('AWS IAM Users', data, removeNull=True)
        return_outputs(human_readable, ec)


    def update_user(args, client):  # pragma: no cover
        kwargs = {'UserName': args.get('oldUserName')}
        if args.get('newUserName'):
            kwargs.update({'NewUserName': args.get('newUserName')})
        if args.get('newPath'):
            kwargs.update({'NewPath': args.get('newPath')})

        response = client.update_user(**kwargs)
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results(
                "Changed UserName {0} To: {1}".format(args.get('oldUserName'), args.get('newUserName')))


    def delete_user(args, client):  # pragma: no cover
        response = client.delete_user(UserName=args.get('userName'))
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results('The User {0} has been deleted'.format(args.get('userName')))


    def update_login_profile(args, client):  # pragma: no cover
        response = client.update_login_profile(
            Password=args.get('newPassword'),
            UserName=args.get('userName'),
            PasswordResetRequired=True if args.get('passwordResetRequired') == 'True' else False
        )
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("The user {0} Password was changed".format(args.get('userName')))


    def create_group(args, client):  # pragma: no cover
        kwargs = {'GroupName': args.get('groupName')}
        if args.get('path') is not None:
            kwargs.update({'Path': args.get('path')})

        response = client.create_group(**kwargs)
        group = response['Group']
        data = ({
            'GroupName': group['GroupName'],
            'GroupId': group['GroupId'],
            'Arn': group['Arn'],
            'CreateDate': datetime.strftime(group['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
            'Path': group['Path'],
        })
        ec = {'AWS.IAM.Groups': data}
        human_readable = tableToMarkdown('AWS IAM Groups', data)
        return_outputs(human_readable, ec)


    def list_groups(args, client):  # pragma: no cover
        data = []
        paginator = client.get_paginator('list_groups')
        for response in paginator.paginate():
            for group in response['Groups']:
                data.append({
                    'GroupName': group['GroupName'],
                    'GroupId': group['GroupId'],
                    'Arn': group['Arn'],
                    'CreateDate': datetime.strftime(group['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                    'Path': group['Path'],
                })
        ec = {'AWS.IAM.Groups': data}
        human_readable = tableToMarkdown('AWS IAM Groups', data)
        return_outputs(human_readable, ec)


    def list_groups_for_user(args, client):  # pragma: no cover
        data = []
        response = client.list_groups_for_user(UserName=args.get('userName'))
        for group in response['Groups']:
            data.append({
                'UserName': args.get('userName'),
                'GroupName': group['GroupName'],
                'GroupId': group['GroupId'],
                'Arn': group['Arn'],
                'CreateDate': datetime.strftime(group['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                'Path': group['Path'],
            })

        ec = {'AWS.IAM.Users(val.UserName === obj.UserName).Groups': data}
        human_readable = tableToMarkdown('AWS IAM User Groups', data)
        return_outputs(human_readable, ec)


    def add_user_to_group(args, client):  # pragma: no cover
        response = client.add_user_to_group(
            GroupName=args.get('groupName'),
            UserName=args.get('userName')
        )
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("The user {0} was added to the IAM group: {1}".format(args.get('userName'),
                                                                                  args.get(
                                                                                      'groupName')))


    def create_access_key(args, client):  # pragma: no cover
        kwargs = {}
        if user_name := args.get('userName'):
            kwargs["UserName"] = user_name
        response = client.create_access_key(**kwargs)
        AccessKey = response['AccessKey']
        data = ({
            'UserName': AccessKey['UserName'],
            'AccessKeyId': AccessKey['AccessKeyId'],
            'SecretAccessKey': AccessKey['SecretAccessKey'],
            'Status': AccessKey['Status'],
            'CreateDate': datetime.strftime(AccessKey['CreateDate'], '%Y-%m-%dT%H:%M:%S')
        })
        ec = {'AWS.IAM.Users(val.UserName === obj.UserName).AccessKeys': data}
        human_readable = tableToMarkdown('AWS IAM Users', data)
        return_outputs(human_readable, ec)


    def update_access_key(args, client):  # pragma: no cover
        kwargs = {
            "AccessKeyId": args.get('accessKeyId'),
            "Status": args.get('status')
        }
        if user_name := args.get('userName'):
            kwargs["UserName"] = user_name

        response = client.update_access_key(**kwargs)
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results(
                "Access Key with ID {0} was set to status: {1}".format(args.get('accessKeyId'),
                                                                       args.get('status')))


    def list_access_key_for_user(args, client):  # pragma: no cover
        data = []
        response = client.list_access_keys(UserName=args.get('userName'))
        for accesskey in response['AccessKeyMetadata']:
            data.append({
                'UserName': accesskey['UserName'],
                'AccessKeyId': accesskey['AccessKeyId'],
                'Status': accesskey['Status'],
                'CreateDate': datetime.strftime(accesskey['CreateDate'], '%Y-%m-%dT%H:%M:%S')
            })

        ec = {'AWS.IAM.Users(val.UserName === obj.UserName).AccessKeys': data}
        human_readable = tableToMarkdown('AWS IAM Users Access Keys', data)
        return_outputs(human_readable, ec)


    def list_policies(args, client):  # pragma: no cover
        data = []
        response = client.list_policies(
            Scope=args.get('scope'),
            OnlyAttached=True if args.get('onlyAttached') == 'True' else False
        )
        for policy in response['Policies']:
            data.append({
                'PolicyName': policy['PolicyName'],
                'PolicyId': policy['PolicyId'],
                'Arn': policy['Arn'],
                'Path': policy['Path'],
                'DefaultVersionId': policy['DefaultVersionId'],
                'IsAttachable': policy['IsAttachable'],
                'AttachmentCount': policy['AttachmentCount'],
                'CreateDate': datetime.strftime(policy['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                'UpdateDate': datetime.strftime(policy['UpdateDate'], '%Y-%m-%dT%H:%M:%S'),
            })
        ec = {'AWS.IAM.Policies': data}
        human_readable = tableToMarkdown('AWS IAM Policies', data)
        return_outputs(human_readable, ec)


    def list_roles(args, client):  # pragma: no cover
        data = []
        output = []
        paginator = client.get_paginator('list_roles')
        for response in paginator.paginate():
            for role in response['Roles']:
                data.append({
                    'RoleName': role['RoleName'],
                    'RoleId': role['RoleId'],
                    'Arn': role['Arn'],
                    'CreateDate': datetime.strftime(role['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                    'Path': role['Path'],
                })
                output.append(role)

        raw = json.loads(json.dumps(output, cls=DatetimeEncoder))
        ec = {'AWS.IAM.Roles': raw}
        human_readable = tableToMarkdown('AWS IAM Roles', data)
        return_outputs(human_readable, ec)


    def attach_policy(args, client):  # pragma: no cover
        if args.get('type') == 'User':
            response = client.attach_user_policy(
                UserName=args.get('entityName'),
                PolicyArn=args.get('policyArn')
            )
        if args.get('type') == 'Group':
            response = client.attach_group_policy(
                GroupName=args.get('entityName'),
                PolicyArn=args.get('policyArn')
            )
        if args.get('type') == 'Role':
            response = client.attach_role_policy(
                RoleName=args.get('entityName'),
                PolicyArn=args.get('policyArn')
            )

        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results(
                "Policy was attached to {0}: {1} ".format(args.get('type'), args.get('entityName')))


    def detach_policy(args, client):  # pragma: no cover
        if args.get('type') == 'User':
            response = client.detach_user_policy(
                UserName=args.get('entityName'),
                PolicyArn=args.get('policyArn')
            )
        if args.get('type') == 'Group':
            response = client.detach_group_policy(
                GroupName=args.get('entityName'),
                PolicyArn=args.get('policyArn')
            )
        if args.get('type') == 'Role':
            response = client.detach_role_policy(
                RoleName=args.get('entityName'),
                PolicyArn=args.get('policyArn')
            )
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results(
                "Policy was detached from {0}: {1} ".format(args.get('type'), args.get('entityName')))


    def delete_login_profile(args, client):  # pragma: no cover
        response = client.delete_login_profile(UserName=args.get('userName'))
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("The user {0} login profile has been deleted".format(args.get('userName')))


    def delete_group(args, client):  # pragma: no cover
        response = client.delete_group(GroupName=args.get('groupName'))
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("The Group {0} has been deleted".format(args.get('groupName')))


    def remove_user_from_group(args, client):  # pragma: no cover
        response = client.remove_user_from_group(
            GroupName=args.get('groupName'),
            UserName=args.get('userName')
        )
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results(
                "The User {0} has been removed from the group {1}".format(args.get('userName'),
                                                                          args.get('groupName')))


    def delete_access_key(args, client):  # pragma: no cover
        kwargs = {
            'AccessKeyId': args.get('AccessKeyId')
        }
        if user_name := args.get('userName'):
            kwargs['UserName'] = user_name

        response = client.delete_access_key(**kwargs)
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("The Access Key was deleted")


    def list_mfa_devices(args, client):
        user_name = args.get('userName', "")
        marker = args.get('marker', None)
        limit, is_manual, page_size = get_limit(args)

        kwargs = {
            'UserName': user_name,
            'MaxItems': limit
        }
        if marker:
            kwargs.update({'Marker': marker})
        response = client.list_mfa_devices(**kwargs)

        mfa_devices = response['MFADevices']
        data = []

        for mfa_device in mfa_devices:
            data.append({
                'UserName': mfa_device['UserName'],
                'SerialNumber': mfa_device['SerialNumber'],
                'EnableDate': datetime.strftime(mfa_device['EnableDate'], '%Y-%m-%d %H:%M:%S'),
            })
        if is_manual and page_size and len(data) > page_size:
            data = data[-1 * page_size:]
        human_readable = tableToMarkdown('AWS IAM Users MFA Devices', data)
        return CommandResults(
            readable_output=human_readable,
            outputs_key_field="UserName",
            outputs_prefix="AWS.IAM.MFADevices",
            outputs={"Devices": data, "Marker": response["Marker"]},
        )


    def deactivate_mfa_device(args, client):
        response = client.deactivate_mfa_device(
            UserName=args['userName'],
            SerialNumber=args['serialNumber']
        )
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results('The User {} mfa device has been deactivated'.format(args.get('userName')))


    def delete_virtual_mfa_device(args, client):
        response = client.delete_virtual_mfa_device(
            SerialNumber=args['serialNumber']
        )
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results('The User {} mfa device has been deleted'.format(args.get('serialNumber')))


    def create_instance_profile(args, client):  # pragma: no cover
        kwargs = {'InstanceProfileName': args.get('instanceProfileName')}
        if args.get('path') is not None:
            kwargs.update({'Path': args.get('path')})

        response = client.create_instance_profile(**kwargs)
        instanceProfile = response['InstanceProfile']
        data = ({
            'Path': instanceProfile['Path'],
            'InstanceProfileName': instanceProfile['InstanceProfileName'],
            'InstanceProfileId': instanceProfile['Path'],
            'Arn': instanceProfile['Arn'],
            'CreateDate': datetime.strftime(instanceProfile['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
        })

        ec = {'AWS.IAM.InstanceProfiles': data}
        human_readable = tableToMarkdown('AWS IAM InstanceProfile', data)
        return_outputs(human_readable, ec)


    def delete_instance_profile(args, client):  # pragma: no cover
        response = client.delete_instance_profile(InstanceProfileName=args.get('instanceProfileName'))
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results(
                "The InstanceProfile: {0} was deleted".format(args.get('instanceProfileName')))


    def list_instance_profiles(args, client):  # pragma: no cover
        output = []
        data = []
        paginator = client.get_paginator('list_instance_profiles')
        for response in paginator.paginate():
            for instanceProfile in response['InstanceProfiles']:
                data.append({
                    'Path': instanceProfile['Path'],
                    'InstanceProfileName': instanceProfile['InstanceProfileName'],
                    'InstanceProfileId': instanceProfile['InstanceProfileId'],
                    'CreateDate': datetime.strftime(instanceProfile['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                })
                output.append(instanceProfile)

        raw = json.loads(json.dumps(output, cls=DatetimeEncoder))
        ec = {'AWS.IAM.InstanceProfiles': raw}
        human_readable = tableToMarkdown('AWS IAM Instance Profiles', data)
        return_outputs(human_readable, ec)


    def add_role_to_instance_profile(args, client):  # pragma: no cover
        kwargs = {
            'InstanceProfileName': args.get('instanceProfileName'),
            'RoleName': args.get('roleName')
        }

        response = client.add_role_to_instance_profile(**kwargs)
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results(
                "The Role: {0} was added to the Instance Profile: {1}".format(args.get('roleName'),
                                                                              args.get('instanceProfileName'))
            )


    def remove_role_from_instance_profile(args, client):  # pragma: no cover
        kwargs = {
            'InstanceProfileName': args.get('instanceProfileName'),
            'RoleName': args.get('roleName')
        }

        response = client.remove_role_from_instance_profile(**kwargs)
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results(
                "The Role: {0} was removed from the Instance Profile: {1}".format(args.get('roleName'),
                                                                                  args.get(
                                                                                      'instanceProfileName')))


    def list_instance_profiles_for_role(args, client):  # pragma: no cover
        output = []
        data = []
        paginator = client.get_paginator('list_instance_profiles_for_role')
        for response in paginator.paginate(RoleName=args.get('roleName')):
            for instanceProfile in response['InstanceProfiles']:
                data.append({
                    'Path': instanceProfile['Path'],
                    'InstanceProfileName': instanceProfile['InstanceProfileName'],
                    'InstanceProfileId': instanceProfile['InstanceProfileId'],
                    'CreateDate': datetime.strftime(instanceProfile['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                    'Arn': instanceProfile['Arn'],
                })
                output.append(instanceProfile)

        raw = json.loads(json.dumps(instanceProfile, cls=DatetimeEncoder))
        ec = {'AWS.IAM.InstanceProfiles': raw}
        human_readable = tableToMarkdown('AWS IAM Instance Profiles', data)
        return_outputs(human_readable, ec)


    def get_instance_profile(args, client):  # pragma: no cover
        response = client.get_instance_profile(InstanceProfileName=args.get('instanceProfileName'))
        instanceProfile = response['InstanceProfile']
        data = ({
            'Path': instanceProfile['Path'],
            'InstanceProfileName': instanceProfile['InstanceProfileName'],
            'InstanceProfileId': instanceProfile['InstanceProfileId'],
            'CreateDate': datetime.strftime(instanceProfile['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
        })

        raw = json.loads(json.dumps(instanceProfile, cls=DatetimeEncoder))
        ec = {'AWS.IAM.InstanceProfiles': raw}
        human_readable = tableToMarkdown('AWS IAM Instance Profiles', data)
        return_outputs(human_readable, ec)


    def get_role(args, client):  # pragma: no cover
        response = client.get_role(RoleName=args.get('roleName'))
        role = response['Role']
        data = ({
            'RoleName': role['RoleName'],
            'RoleId': role['RoleId'],
            'Arn': role['Arn'],
            'CreateDate': datetime.strftime(role['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
            'Path': role['Path'],
        })

        raw = json.loads(json.dumps(response['Role'], cls=DatetimeEncoder))
        raw["Tags"] = raw.get("Tags", [])
        human_readable = tableToMarkdown('AWS IAM Roles', data)
        return CommandResults(
            outputs=createContext(raw),
            outputs_prefix='AWS.IAM.Roles',
            outputs_key_field='RoleName',
            readable_output=human_readable
        )


    def delete_role(args, client):  # pragma: no cover
        response = client.delete_role(RoleName=args.get('roleName'))

        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("The Role: {0} was deleted".format(args.get('roleName')))


    def create_role(args, client):  # pragma: no cover
        kwargs = {
            'RoleName': args.get('roleName'),
            'AssumeRolePolicyDocument': json.dumps(json.loads(args.get('assumeRolePolicyDocument')))
        }
        if args.get('path') is not None:
            kwargs.update({'Path': args.get('path')})
        if args.get('description') is not None:
            kwargs.update({'Description': args.get('description')})
        if args.get('maxSessionDuration') is not None:
            kwargs.update({'MaxSessionDuration': int(args.get('maxSessionDuration'))})
        # return kwargs
        response = client.create_role(**kwargs)
        role = response['Role']
        data = ({
            'RoleName': role['RoleName'],
            'RoleId': role['RoleId'],
            'Arn': role['Arn'],
            'Path': role['Path'],
        })

        raw = json.loads(json.dumps(response['Role'], cls=DatetimeEncoder))
        ec = {'AWS.IAM.Roles': raw}
        human_readable = tableToMarkdown('AWS IAM Roles', data)
        return_outputs(human_readable, ec)


    def create_policy(args, client):  # pragma: no cover
        kwargs = {
            'PolicyName': args.get('policyName'),
            'PolicyDocument': json.dumps(json.loads(args.get('policyDocument')))
        }
        if args.get('path') is not None:
            kwargs.update({'Path': args.get('path')})
        if args.get('description') is not None:
            kwargs.update({'Description': args.get('description')})

        response = client.create_policy(**kwargs)
        policy = response['Policy']
        data = ({
            'PolicyName': policy['PolicyName'],
            'PolicyId': policy['PolicyId'],
            'Arn': policy['Arn'],
            'Path': policy['Path'],
            'CreateDate': datetime.strftime(policy['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
        })

        raw = json.loads(json.dumps(response['Policy'], cls=DatetimeEncoder))
        ec = {'AWS.IAM.Policies': raw}
        human_readable = tableToMarkdown('AWS IAM Policies', data)
        return_outputs(human_readable, ec)


    def delete_policy(args, client):  # pragma: no cover
        response = client.delete_policy(PolicyArn=args.get('policyArn'))

        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("The Policy: {0} was deleted".format(args.get('policyArn')))


    def create_policy_version(args, client):  # pragma: no cover
        kwargs = {
            'PolicyArn': args.get('policyArn'),
            'PolicyDocument': json.dumps(json.loads(args.get('policyDocument')))
        }
        if args.get('setAsDefault') is not None:
            kwargs.update({'SetAsDefault': True if args.get('setAsDefault') == 'True' else False})

        response = client.create_policy_version(**kwargs)
        policy = response['PolicyVersion']
        data = ({
            'PolicyArn': args.get('policyArn'),
            'VersionId': policy['VersionId'],
            'IsDefaultVersion': policy['IsDefaultVersion'],
            'CreateDate': datetime.strftime(policy['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
        })

        ec = {'AWS.IAM.Policies(val.PolicyArn === obj.PolicyArn).Versions': data}
        human_readable = tableToMarkdown('New AWS IAM Policy Version', data)
        return_outputs(human_readable, ec)


    def delete_policy_version(args, client):  # pragma: no cover
        kwargs = {
            'PolicyArn': args.get('policyArn'),
            'VersionId': args.get('versionId')
        }
        response = client.delete_policy_version(**kwargs)

        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("The Policy Version was deleted")


    def list_policy_versions(args, client):  # pragma: no cover
        data = []
        response = client.list_policy_versions(PolicyArn=args.get('policyArn'))
        for version in response['Versions']:
            data.append({
                'PolicyArn': args.get('policyArn'),
                'VersionId': version['VersionId'],
                'IsDefaultVersion': version['IsDefaultVersion'],
                'CreateDate': datetime.strftime(version['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
            })
        ec = {'AWS.IAM.Policies(val.PolicyArn === obj.PolicyArn).Versions': data}
        human_readable = tableToMarkdown('AWS IAM Policy Versions', data)
        return_outputs(human_readable, ec)


    def get_policy_version(args, client):  # pragma: no cover
        data = []
        kwargs = {
            'PolicyArn': args.get('policyArn'),
            'VersionId': args.get('versionId')
        }
        response = client.get_policy_version(**kwargs)
        version = response['PolicyVersion']
        data.append({
            'PolicyArn': args.get('policyArn'),
            'Document': version['Document'],
            'VersionId': version['VersionId'],
            'IsDefaultVersion': version['IsDefaultVersion'],
            'CreateDate': datetime.strftime(version['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
        })
        ec = {'AWS.IAM.Policies(val.PolicyArn === obj.PolicyArn).Versions': data}
        human_readable = tableToMarkdown('AWS IAM Policy Version', data)
        return_outputs(human_readable, ec)


    def set_default_policy_version(args, client):  # pragma: no cover
        kwargs = {
            'PolicyArn': args.get('policyArn'),
            'VersionId': args.get('versionId')
        }
        response = client.set_default_policy_version(**kwargs)
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("The Default Policy Version was set to {0}".format(args.get('versionId')))


    def create_account_alias(args, client):  # pragma: no cover
        kwargs = {'AccountAlias': args.get('accountAlias')}
        response = client.create_account_alias(**kwargs)
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("The Account Alias was created")


    def delete_account_alias(args, client):  # pragma: no cover
        kwargs = {'AccountAlias': args.get('accountAlias')}
        response = client.delete_account_alias(**kwargs)
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("The Account Alias was deleted")


    def get_account_password_policy(args, client):  # pragma: no cover
        response = client.get_account_password_policy()
        data = response['PasswordPolicy']
        raw = json.loads(json.dumps(response['PasswordPolicy'], cls=DatetimeEncoder))
        ec = {'AWS.IAM.PasswordPolicy': raw}
        human_readable = tableToMarkdown('AWS IAM Account Password Policy', data)
        return_outputs(human_readable, ec)


    def update_account_password_policy(args, client):  # pragma: no cover
        try:
            response = client.get_account_password_policy()
            kwargs = response['PasswordPolicy']
        except client.exceptions.NoSuchEntityException:
            kwargs = {}
        # ExpirePasswords is part of the response but cannot be included
        # in the request
        if 'ExpirePasswords' in kwargs:
            kwargs.pop('ExpirePasswords')
        if args.get('minimumPasswordLength'):
            kwargs.update({'MinimumPasswordLength': int(args.get('minimumPasswordLength'))})
        if args.get('requireSymbols'):
            kwargs.update({'RequireSymbols': True if args.get('requireSymbols') == 'True' else False})
        if args.get('requireNumbers'):
            kwargs.update({'RequireNumbers': True if args.get('requireNumbers') == 'True' else False})
        if args.get('requireUppercaseCharacters'):
            kwargs.update(
                {'RequireUppercaseCharacters': True if args.get('requireUppercaseCharacters') == 'True' else False})
        if args.get('requireLowercaseCharacters'):
            kwargs.update(
                {'RequireLowercaseCharacters': True if args.get('requireLowercaseCharacters') == 'True' else False})
        if args.get('allowUsersToChangePassword'):
            kwargs.update(
                {'AllowUsersToChangePassword': True if args.get('allowUsersToChangePassword') == 'True' else False})
        if args.get('maxPasswordAge'):
            kwargs.update({'MaxPasswordAge': int(args.get('maxPasswordAge'))})
        if args.get('passwordReusePrevention'):
            kwargs.update({'PasswordReusePrevention': int(args.get('passwordReusePrevention'))})
        if args.get('hardExpiry'):
            kwargs.update({'HardExpiry': True if args.get('hardExpiry') == 'True' else False})
        response = client.update_account_password_policy(**kwargs)
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results("The Account Password Policy was updated")


    def list_role_policies(args, client):  # pragma: no cover
        kwargs = {'RoleName': args.get('roleName')}
        response = client.list_role_policies(**kwargs)
        response = json.dumps(response, default=datetime_to_string)
        response = json.loads(response)
        outputs = {
            'AWS.IAM.Roles(val.RoleName && val.RoleName === obj.RoleName).Policies':
                response.get('PolicyNames')}
        del response['ResponseMetadata']
        table_header = 'AWS IAM Role Policies for {}'.format(args.get('roleName'))
        human_readable = aws_table_to_markdown(response, table_header)
        return_outputs(human_readable, outputs, response)


    def get_role_policy(args, client):  # pragma: no cover
        kwargs = {
            'RoleName': args.get('roleName'),
            'PolicyName': args.get('policyName')
        }
        response = client.get_role_policy(**kwargs)
        response = json.dumps(response, default=datetime_to_string)
        response = json.loads(response)
        outputs = {
            'AWS.IAM.Roles(val.RoleName && val.RoleName === obj.RoleName)':
                response}
        del response['ResponseMetadata']
        table_header = 'AWS IAM Role Policy for {}'.format(args.get('roleName'))
        human_readable = aws_table_to_markdown(response, table_header)
        return_outputs(human_readable, outputs, response)


    def get_policy(args, client):   # pragma: no cover
        kwargs = {
            'PolicyArn': args.get('policyArn')
        }
        response = client.get_policy(**kwargs)
        response = json.dumps(response, default=datetime_to_string)
        response = json.loads(response)
        outputs = {
            'AWS.IAM.Policy(val.PolicyName && val.PolicyName === obj.PolicyName)':
                response.get('Policy')}
        del response['ResponseMetadata']
        table_header = 'AWS IAM Policy for {}'.format(args.get('policyArn'))
        human_readable = aws_table_to_markdown(response, table_header)
        return_outputs(human_readable, outputs, response)


    def list_user_policies(args, client):
        user_name = args.get('userName', "")
        marker = args.get('marker', None)
        limit, is_manual, page_size = get_limit(args)

        kwargs = {
            'UserName': user_name,
            'MaxItems': limit
        }
        if marker:
            kwargs.update({'Marker': marker})

        response = client.list_user_policies(**kwargs)
        data = response.get('PolicyNames', [])
        marker = response.get('Marker', None)

        if is_manual and page_size and len(data) > page_size:
            data = data[-1 * page_size:]

        policy_data = [{
            'UserName': user_name,
            'PolicyName': policy,
        } for policy in data]

        ec = {}
        if policy_data:
            ec = {'AWS.IAM.UserPolicies(val.PolicyName && val.UserName && val.PolicyName === obj.PolicyName && '
                  'val.UserName === obj.UserName)': policy_data,
                  'AWS.IAM.Users(val.UserName === \'{}\').InlinePoliciesMarker'.format(user_name): marker}

        human_readable = tableToMarkdown('AWS IAM Policies for user {}'.format(user_name),
                                         headers=["PolicyNames"],
                                         headerTransform=pascalToSpace,
                                         t=data)
        return_outputs(human_readable, ec, response)


    def list_attached_user_policies(args, client):
        user_name = args.get('userName')
        marker = args.get('marker')
        limit, is_manual, page_size = get_limit(args)

        kwargs = {
            'UserName': user_name,
            'MaxItems': limit
        }
        if marker:
            kwargs.update({'Marker': marker})

        response = client.list_attached_user_policies(**kwargs)
        data = response.get('AttachedPolicies', [])
        marker = response.get('Marker', None)

        if is_manual and page_size is not None and len(data) > page_size:
            data = data[-1 * page_size:]

        policy_data = [{
            'UserName': user_name,
            'PolicyArn': policy.get('PolicyArn'),
            'PolicyName': policy.get('PolicyName')
        } for policy in data]

        ec = {}
        if policy_data:
            ec = {'AWS.IAM.AttachedUserPolicies(val.PolicyArn && val.UserName && val.PolicyArn === obj.PolicyArn && '
                  'val.UserName === obj.UserName)': policy_data,
                  'AWS.IAM.Users(val.UserName === \'{}\').AttachedPoliciesMarker'.format(user_name): marker}

        human_readable = tableToMarkdown('AWS IAM Attached Policies for user {}'.format(user_name),
                                         headers=['PolicyName', 'PolicyArn'],
                                         headerTransform=pascalToSpace,
                                         t=data)

        return_outputs(human_readable, ec, response)


    def list_attached_group_policies(args, client):
        group_name = args.get('groupName')
        marker = args.get('marker')
        limit, is_manual, page_size = get_limit(args)

        kwargs = {
            'GroupName': group_name,
            'MaxItems': limit
        }
        if marker:
            kwargs.update({'Marker': marker})

        response = client.list_attached_group_policies(**kwargs)
        data = response.get('AttachedPolicies', [])
        marker = response.get('Marker')

        if is_manual and page_size and len(data) > page_size:
            data = data[-1 * args.get('page_size'):]

        policy_data = [{
            'GroupName': group_name,
            'PolicyArn': policy.get('PolicyArn'),
            'PolicyName': policy.get('PolicyName')
        } for policy in data]

        ec = {}
        if policy_data:
            ec = {'AWS.IAM.AttachedGroupPolicies(val.PolicyArn && val.GroupName && val.PolicyArn === obj.PolicyArn && '
                  'val.GroupName === obj.GroupName)': policy_data,
                  'AWS.IAM.Groups(val.GroupName === \'{}\').AttachedPoliciesMarker'.format(group_name): marker}

        human_readable = tableToMarkdown('AWS IAM Attached Policies for group {}'.format(group_name),
                                         headers=['PolicyName', 'PolicyArn'],
                                         headerTransform=pascalToSpace,
                                         t=data)

        return_outputs(human_readable, ec, response)


    def get_user_login_profile(args, client):
        user_name = args.get('userName')
        kwargs = {
            'UserName': user_name
        }

        try:
            response = client.get_login_profile(**kwargs)
            user_profile = response['LoginProfile']
            create_date = datetime_to_string(user_profile.get('CreateDate')) or user_profile.get('CreateDate')
            data = {
                'UserName': user_profile.get('UserName'),
                'LoginProfile': {
                    'CreateDate': create_date,
                    'PasswordResetRequired': user_profile.get('PasswordResetRequired')
                }
            }

            ec = {'AWS.IAM.Users(val.UserName && val.UserName === obj.UserName)': data}

            human_readable = tableToMarkdown('AWS IAM Login Profile for user {}'.format(user_name),
                                             t=data.get('LoginProfile'),
                                             headers=['CreateDate', 'PasswordResetRequired'],
                                             removeNull=True,
                                             headerTransform=pascalToSpace)

            response['LoginProfile'].update({'CreateDate': create_date})
            return_outputs(human_readable, ec, response)
        except botocore.exceptions.ClientError as error:
            if error.response.get('ResponseMetadata', {}).get('HTTPStatusCode') == 404:
                return_outputs(tableToMarkdown('AWS IAM Login Profile for user {}'.format(user_name), t={}))
            else:
                raise error


    def put_role_policy_command(args, client):
        """
        Add or change a policy entry for a given role.
        Args:
            client (boto3.client): The boto3.client client object.
            args (Dict): demisto.args() object.
        Returns:
            CommandResults: command results object with the response, and the human readable section.
        """
        policy_document = args.get('policyDocument')
        policy_name = args.get('policyName')
        role_name = args.get('roleName')

        kwargs = {
            'PolicyDocument': policy_document,
            'PolicyName': policy_name,
            'RoleName': role_name
        }

        try:
            response = client.put_role_policy(**kwargs)
            human_readable = f"Policy {policy_name} was added to role {role_name}"
            return CommandResults(
                raw_response=response,
                readable_output=human_readable
            )
        except Exception as e:
            raise DemistoException(f"Couldn't add policy {policy_name} to role {role_name}"
                                   f"\nencountered the following exception: {str(e)}")


    def put_user_policy_command(args, client):
        """
        Add or change a policy entry for a given user.
        Args:
            client (boto3.client): The boto3.client client object.
            args (Dict): demisto.args() object.
        Returns:
            CommandResults: command results object with the response, and the human readable section.
        """
        policy_document = args.get('policyDocument')
        policy_name = args.get('policyName')
        user_name = args.get('userName')

        kwargs = {
            'PolicyDocument': policy_document,
            'PolicyName': policy_name,
            'UserName': user_name
        }

        try:
            response = client.put_user_policy(**kwargs)
            human_readable = f"Policy {policy_name} was added to user {user_name}"
            return CommandResults(
                raw_response=response,
                readable_output=human_readable
            )
        except Exception as e:
            raise DemistoException(f"Couldn't add policy {policy_name} to user {user_name}"
                                   f"\nencountered the following exception: {str(e)}")


    def put_group_policy_command(args, client):
        """
        Add or change a policy entry for a given group.
        Args:
            client (boto3.client): The boto3.client client object.
            args (Dict): demisto.args() object.
        Returns:
            CommandResults: command results object with the response, and the human readable section.
        """
        policy_document = args.get('policyDocument')
        policy_name = args.get('policyName')
        group_name = args.get('groupName')

        kwargs = {
            'PolicyDocument': policy_document,
            'PolicyName': policy_name,
            'GroupName': group_name
        }

        try:
            response = client.put_group_policy(**kwargs)
            human_readable = f"Policy {policy_name} was added to group {group_name}"
            return CommandResults(
                raw_response=response,
                readable_output=human_readable
            )
        except Exception as e:
            raise DemistoException(f"Couldn't add policy {policy_name} to group {group_name}"
                                   f"\nencountered the following exception: {str(e)}")


    def tag_role_command(args, client):
        """
        Add the given tags to the given role.
        Args:
            client (boto3.client): The boto3.client client object.
            args (Dict): demisto.args() object.
        Returns:
            CommandResults: command results object with the response, and the human readable section.
        """
        tags = create_tag_dicts_list(argToList(args.get('tags')))
        role_name = args.get('roleName')

        kwargs = {
            'RoleName': role_name,
            'Tags': tags
        }

        try:
            response = client.tag_role(**kwargs)
            human_readable = tableToMarkdown(f"Added the following tags to role {role_name}", tags)
            return CommandResults(
                raw_response=response,
                readable_output=human_readable
            )
        except Exception as e:
            raise DemistoException(f"Couldn't add the following tags {tags} to role {role_name}"
                                   f"\nencountered the following exception: {str(e)}")


    def list_attached_role_policies_command(args: dict, client) -> list[CommandResults]:
        aws_args = {"RoleName": (role_name := args["roleName"])}

        for demisto_key, aws_key in (
            ("pathPrefix", "PathPrefix"),
            ("marker", "Marker"),
            ("maxItems", "MaxItems")
        ):  # optional keys, renaming to match AWS API
            if (value := args.get(demisto_key)) is not None:
                aws_args[aws_key] = value

        if (max_itmes := aws_args.get("MaxItems")) is not None:
            aws_args["MaxItems"] = int(max_itmes)
        try:
            raw_response = client.list_attached_role_policies(**aws_args)
        except Exception as e:
            raise DemistoException(f"Couldn't list role policies with {args}\n"
                                   f"encountered the following exception: {str(e)}") from e

        policies = [
            policy | {"RoleName": role_name}
            for policy in raw_response["AttachedPolicies"]
        ]

        query_outputs = {k: v for k, v in raw_response.items() if k in ("IsTruncated", "Marker")}
        return [
            CommandResults(
                # Main result - here be policies
                raw_response=raw_response,
                outputs=policies,
                outputs_prefix='AWS.IAM.Roles.AttachedPolicies.Policies',
                readable_output=tableToMarkdown(
                    name=f"Attached Policies for Role {role_name}",
                    t=policies,
                )),
            CommandResults(
                # Secondary result object, for querying the next ones (if necessary)
                raw_response=raw_response,
                outputs=query_outputs,
                outputs_prefix="AWS.IAM.Roles.AttachedPolicies.Query",
                readable_output=f"Listed {len(policies)} attached policies for role {role_name}"
                if not raw_response.get("IsTruncated")
                else (f"Listed {len(policies)} role policies but more are available. "
                      "Either increase the `maxItems` argument, or use `marker` argument with the value from context.")
            )
        ]


    def tag_user_command(args, client):
        """
        Add the given tags to the given user.
        Args:
            client (boto3.client): The boto3.client client object.
            args (Dict): demisto.args() object.
        Returns:
            CommandResults: command results object with the response, and the human readable section.
        """
        tags = create_tag_dicts_list(argToList(args.get('tags')))
        user_name = args.get('userName')

        kwargs = {
            'UserName': user_name,
            'Tags': tags
        }

        try:
            response = client.tag_user(**kwargs)
            human_readable = tableToMarkdown(f"Added the following tags to user {user_name}", tags)
            return CommandResults(
                raw_response=response,
                readable_output=human_readable
            )
        except Exception as e:
            raise DemistoException(f"Couldn't add the following tags {tags} to role {user_name}"
                                   f"\nencountered the following exception: {str(e)}")


    def untag_user_command(args, client):
        """
        Remove the given tags from the given user.
        Args:
            client (boto3.client): The boto3.client client object.
            args (Dict): demisto.args() object.
        Returns:
            CommandResults: command results object with the response, and the human readable section.
        """
        tags = argToList(args.get('tagKeys'))
        user_name = args.get('userName')

        kwargs = {
            'UserName': user_name,
            'TagKeys': tags
        }

        try:
            response = client.untag_user(**kwargs)
            human_readable = tableToMarkdown(f"Untagged the following tags from user {user_name}", tags, headers=["Removed keys"])
            return CommandResults(
                raw_response=response,
                readable_output=human_readable
            )
        except Exception as e:
            raise DemistoException(f"Couldn't untag the following tags {', '.join(tags)} from user {user_name}"
                                   f"\nencountered the following exception: {str(e)}")


    def untag_role_command(args, client):
        """
        Remove the given tags from the given role.
        Args:
            client (boto3.client): The boto3.client client object.
            args (Dict): demisto.args() object.
        Returns:
            CommandResults: command results object with the response, and the human readable section.
        """
        tags = argToList(args.get('tagKeys'))
        role_name = args.get('roleName')

        kwargs = {
            'RoleName': role_name,
            'TagKeys': tags
        }

        try:
            response = client.untag_role(**kwargs)
            human_readable = tableToMarkdown(f"Untagged the following tags from role {role_name}", tags, headers=["Removed keys"])
            return CommandResults(
                raw_response=response,
                readable_output=human_readable
            )
        except Exception as e:
            raise DemistoException(f"Couldn't untag the following tags {', '.join(tags)} from role {role_name}"
                                   f"\nencountered the following exception: {str(e)}")


    def create_tag_dicts_list(tags):
        """
        Transform the given tags list to a list of dicts.
        Args:
            tags (list): The tags list where each entry is in the form of Key:value
        Returns:
            list: The transformed list.
        """
        try:
            dict_tags = []
            for tag in tags:
                temp = tag.split(':')
                dict_tags.append({"Key": temp[0], "Value": temp[1]})
            return dict_tags
        except Exception as e:
            demisto.debug(f"encountered the following error in create_tag_dicts_list: {str(e)}")
            raise DemistoException("Please make sure the tags argument is in the form of Key1:Value1,Key2:Value2.")


    def get_access_key_last_used_command(args, client):
        """
        Retrieve information about the last used occasion of the given access key.
        Args:
            client (boto3.client): The boto3.client client object.
            args (Dict): demisto.args() object.
        Returns:
            CommandResults: command results object with the response, the ec, and the human readable section.
        """
        access_key_id = args.get('accessKeyId')
        kwargs = {
            'AccessKeyId': access_key_id
        }

        try:
            response = client.get_access_key_last_used(**kwargs)
            access_key_last_used = response.get("AccessKeyLastUsed", {})
            last_used = ""
            if last_used := access_key_last_used.get("LastUsedDate", ""):
                last_used = datetime.strftime(last_used, '%Y-%m-%dT%H:%M:%S')
                response["AccessKeyLastUsed"]["LastUsedDate"] = last_used
            data = {
                "ID": access_key_id,
                "UserName": response.get("UserName", ""),
                "LastUsedServiceName": access_key_last_used.get("ServiceName", ""),
                "LastUsedRegion": access_key_last_used.get("Region", ""),
                "LastUsedDate": last_used
            }
            headers = ["ID", "UserName", "LastUsedDate", "LastUsedServiceName", "LastUsedRegion"]
            human_readable = tableToMarkdown(f"Found the following information about access key {access_key_id}", data,
                                             headers, removeNull=True)
            return CommandResults(
                outputs=createContext(data, removeNull=True),
                outputs_prefix='AWS.IAM.AccessKey',
                raw_response=response,
                outputs_key_field='ID',
                readable_output=human_readable
            )
        except Exception as e:
            raise DemistoException(f"Couldn't get information about access key {access_key_id}"
                                   f"\nencountered the following exception: {str(e)}")


    def test_function(client):
        response = client.list_users()
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results('ok')


    def main():     # pragma: no cover
        params = demisto.params()
        aws_default_region = params.get('defaultRegion')
        aws_role_arn = params.get('roleArn')
        aws_role_session_name = params.get('roleSessionName')
        aws_role_session_duration = params.get('sessionDuration')
        aws_role_policy = None
        aws_access_key_id = params.get('credentials', {}).get('identifier') or params.get('access_key')
        aws_secret_access_key = params.get('credentials', {}).get('password') or params.get('secret_key')
        verify_certificate = not params.get('insecure', True)
        timeout = params.get('timeout')
        retries = params.get('retries') or 5

        validate_params(aws_default_region, aws_role_arn, aws_role_session_name, aws_access_key_id,
                        aws_secret_access_key)

        aws_client = AWSClient(aws_default_region, aws_role_arn, aws_role_session_name, aws_role_session_duration,
                               aws_role_policy, aws_access_key_id, aws_secret_access_key, verify_certificate, timeout,
                               retries)
        command = demisto.command()
        args = demisto.args()
        client = aws_client.aws_session(
            service=SERVICE,
            role_arn=args.get('roleArn'),
            role_session_name=args.get('roleSessionName'),
            role_session_duration=args.get('roleSessionDuration'),
        )

        try:
            LOG('Command being called is {command}'.format(command=command))
            if command == 'test-module':
                test_function(client)
            elif command == 'aws-iam-create-user':
                create_user(args, client)
            elif command == 'aws-iam-create-login-profile':
                create_login_profile(args, client)
            elif command == 'aws-iam-get-user':
                get_user(args, client)
            elif command == 'aws-iam-list-users':
                list_users(args, client)
            elif command == 'aws-iam-update-user':
                update_user(args, client)
            elif command == 'aws-iam-delete-user':
                delete_user(args, client)
            elif command == 'aws-iam-update-login-profile':
                update_login_profile(args, client)
            elif command == 'aws-iam-create-group':
                create_group(args, client)
            elif command == 'aws-iam-list-groups':
                list_groups(args, client)
            elif command == 'aws-iam-list-groups-for-user':
                list_groups_for_user(args, client)
            elif command == 'aws-iam-create-access-key':
                create_access_key(args, client)
            elif command == 'aws-iam-update-access-key':
                update_access_key(args, client)
            elif command == 'aws-iam-list-access-keys-for-user':
                list_access_key_for_user(args, client)
            elif command == 'aws-iam-list-policies':
                list_policies(args, client)
            elif command == 'aws-iam-list-roles':
                list_roles(args, client)
            elif command == 'aws-iam-attach-policy':
                attach_policy(args, client)
            elif command == 'aws-iam-detach-policy':
                detach_policy(args, client)
            elif command == 'aws-iam-delete-login-profile':
                delete_login_profile(args, client)
            elif command == 'aws-iam-add-user-to-group':
                add_user_to_group(args, client)
            elif command == 'aws-iam-delete-group':
                delete_group(args, client)
            elif command == 'aws-iam-remove-user-from-group':
                remove_user_from_group(args, client)
            elif command == 'aws-iam-delete-access-key':
                delete_access_key(args, client)
            elif command == 'aws-iam-list-mfa-devices':
                list_mfa_devices(args, client)
            elif command == 'aws-iam-deactivate-mfa-devices':
                deactivate_mfa_device(args, client)
            elif command == 'aws-iam-delete-mfa-devices':
                delete_virtual_mfa_device(args, client)
            elif command == 'aws-iam-create-instance-profile':
                create_instance_profile(args, client)
            elif command == 'aws-iam-delete-instance-profile':
                delete_instance_profile(args, client)
            elif command == 'aws-iam-list-instance-profiles':
                list_instance_profiles(args, client)
            elif command == 'aws-iam-add-role-to-instance-profile':
                add_role_to_instance_profile(args, client)
            elif command == 'aws-iam-remove-role-from-instance-profile':
                remove_role_from_instance_profile(args, client)
            elif command == 'aws-iam-list-instance-profiles-for-role':
                list_instance_profiles_for_role(args, client)
            elif command == 'aws-iam-get-instance-profile':
                get_instance_profile(args, client)
            elif command == 'aws-iam-get-role':
                return_results(get_role(args, client))
            elif command == 'aws-iam-delete-role':
                delete_role(args, client)
            elif command == 'aws-iam-create-role':
                create_role(args, client)
            elif command == 'aws-iam-create-policy':
                create_policy(args, client)
            elif command == 'aws-iam-delete-policy':
                delete_policy(args, client)
            elif command == 'aws-iam-create-policy-version':
                create_policy_version(args, client)
            elif command == 'aws-iam-delete-policy-version':
                delete_policy_version(args, client)
            elif command == 'aws-iam-list-policy-versions':
                list_policy_versions(args, client)
            elif command == 'aws-iam-get-policy-version':
                get_policy_version(args, client)
            elif command == 'aws-iam-set-default-policy-version':
                set_default_policy_version(args, client)
            elif command == 'aws-iam-create-account-alias':
                create_account_alias(args, client)
            elif command == 'aws-iam-delete-account-alias':
                delete_account_alias(args, client)
            elif command == 'aws-iam-get-account-password-policy':
                get_account_password_policy(args, client)
            elif command == 'aws-iam-update-account-password-policy':
                update_account_password_policy(args, client)
            elif command == 'aws-iam-list-role-policies':
                list_role_policies(args, client)
            elif command == 'aws-iam-get-role-policy':
                get_role_policy(args, client)
            elif command == 'aws-iam-get-policy':
                get_policy(args, client)
            elif command == 'aws-iam-list-user-policies':
                list_user_policies(args, client)
            elif command == 'aws-iam-list-attached-user-policies':
                list_attached_user_policies(args, client)
            elif command == 'aws-iam-list-attached-group-policies':
                list_attached_group_policies(args, client)
            elif command == 'aws-iam-get-user-login-profile':
                get_user_login_profile(args, client)
            elif command == 'aws-iam-put-role-policy':
                return_results(put_role_policy_command(args, client))
            elif command == 'aws-iam-put-user-policy':
                return_results(put_user_policy_command(args, client))
            elif command == 'aws-iam-put-group-policy':
                return_results(put_group_policy_command(args, client))
            elif command == 'aws-iam-tag-role':
                return_results(tag_role_command(args, client))
            elif command == 'aws-iam-tag-user':
                return_results(tag_user_command(args, client))
            elif command == 'aws-iam-untag-user':
                return_results(untag_user_command(args, client))
            elif command == 'aws-iam-untag-role':
                return_results(untag_role_command(args, client))
            elif command == 'aws-iam-get-access-key-last-used':
                return_results(get_access_key_last_used_command(args, client))
            elif command == 'aws-iam-list-attached-role-policies':
                return_results(list_attached_role_policies_command(args, client))
        except Exception as e:
            LOG(str(e))
            return_error('Error has occurred in the AWS IAM Integration: {code}\n {message}'.format(
                code=type(e), message=str(e)))



    ### GENERATED CODE ###: from AWSApiModule import *  # noqa: E402
    # This code was inserted in place of an API module.
    register_module_line('AWSApiModule', 'start', __line__(), wrapper=-3)


    import boto3
    from botocore.config import Config


    def validate_params(aws_default_region, aws_role_arn, aws_role_session_name, aws_access_key_id, aws_secret_access_key):
        """
        Validates that the provided parameters are compatible with the appropriate authentication method.
        """
        if not aws_default_region:
            raise DemistoException('You must specify AWS default region.')

        if bool(aws_access_key_id) != bool(aws_secret_access_key):
            raise DemistoException('You must provide Access Key id and Secret key id to configure the instance with '
                                   'credentials.')
        if bool(aws_role_arn) != bool(aws_role_session_name):
            raise DemistoException('Role session name is required when using role ARN.')


    def extract_session_from_secret(secret_key, session_token):
        """
        Extract the session token from the secret_key field.
        """
        if secret_key and '@@@' in secret_key and not session_token:
            return secret_key.split('@@@')[0], secret_key.split('@@@')[1]
        else:
            return secret_key, session_token


    class AWSClient:

        def __init__(self, aws_default_region, aws_role_arn, aws_role_session_name, aws_role_session_duration,
                     aws_role_policy, aws_access_key_id, aws_secret_access_key, verify_certificate, timeout, retries,
                     aws_session_token=None, sts_endpoint_url=None, endpoint_url=None):

            self.sts_endpoint_url = sts_endpoint_url
            self.endpoint_url = endpoint_url
            self.aws_default_region = aws_default_region
            self.aws_role_arn = aws_role_arn
            self.aws_role_session_name = aws_role_session_name
            # handle cases where aws_role_session_duration can be also empty string
            self.aws_role_session_duration = aws_role_session_duration if aws_role_session_duration else None
            self.aws_role_policy = aws_role_policy
            self.aws_access_key_id = aws_access_key_id
            self.aws_secret_access_key, self.aws_session_token = extract_session_from_secret(aws_secret_access_key, aws_session_token)
            self.verify_certificate = verify_certificate

            sts_regional_endpoint = demisto.params().get("sts_regional_endpoint") or None
            if sts_regional_endpoint:
                demisto.debug(f"Sets the environment variable AWS_STS_REGIONAL_ENDPOINTS={sts_regional_endpoint}")
                os.environ["AWS_STS_REGIONAL_ENDPOINTS"] = sts_regional_endpoint.lower()

            proxies = handle_proxy(proxy_param_name='proxy', checkbox_default_value=False)
            (read_timeout, connect_timeout) = AWSClient.get_timeout(timeout)
            if int(retries) > 10:
                retries = 10
            self.config = Config(
                connect_timeout=connect_timeout,
                read_timeout=read_timeout,
                retries=dict(
                    max_attempts=int(retries)
                ),
                proxies=proxies
            )

        def update_config(self):
            command_config = {}
            retries = demisto.getArg('retries')  # Supports retries and timeout parameters on the command execution level
            if retries is not None:
                command_config['retries'] = dict(max_attempts=int(retries))
            timeout = demisto.getArg('timeout')
            if timeout is not None:
                (read_timeout, connect_timeout) = AWSClient.get_timeout(timeout)
                command_config['read_timeout'] = read_timeout
                command_config['connect_timeout'] = connect_timeout
            if retries or timeout:
                demisto.debug('Merging client config settings: {}'.format(command_config))
                self.config = self.config.merge(Config(**command_config))  # type: ignore[arg-type]

        def aws_session(self, service, region=None, role_arn=None, role_session_name=None, role_session_duration=None,
                        role_policy=None):
            kwargs = {}

            self.update_config()

            if role_arn and role_session_name is not None:
                kwargs.update({
                    'RoleArn': role_arn,
                    'RoleSessionName': role_session_name,
                })
            elif self.aws_role_arn and self.aws_role_session_name is not None:
                kwargs.update({
                    'RoleArn': self.aws_role_arn,
                    'RoleSessionName': self.aws_role_session_name,
                })

            if role_session_duration is not None:
                kwargs.update({'DurationSeconds': int(role_session_duration)})
            elif self.aws_role_session_duration is not None:
                kwargs.update({'DurationSeconds': int(self.aws_role_session_duration)})

            if role_policy is not None:
                kwargs.update({'Policy': role_policy})
            elif self.aws_role_policy is not None:
                kwargs.update({'Policy': self.aws_role_policy})

            demisto.debug('{kwargs}='.format(kwargs=kwargs))

            if kwargs and not self.aws_access_key_id:  # login with Role ARN
                if not self.aws_access_key_id:
                    sts_client = boto3.client('sts', config=self.config, verify=self.verify_certificate,
                                              region_name=region if region else self.aws_default_region,
                                              endpoint_url=self.sts_endpoint_url)
                    sts_response = sts_client.assume_role(**kwargs)
                    client = boto3.client(
                        service_name=service,
                        region_name=region if region else self.aws_default_region,
                        aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                        aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                        aws_session_token=sts_response['Credentials']['SessionToken'],
                        verify=self.verify_certificate,
                        config=self.config,
                        endpoint_url=self.endpoint_url
                    )
            elif self.aws_access_key_id and (role_arn or self.aws_role_arn):  # login with Access Key ID and Role ARN
                sts_client = boto3.client(
                    service_name='sts',
                    aws_access_key_id=self.aws_access_key_id,
                    aws_secret_access_key=self.aws_secret_access_key,
                    verify=self.verify_certificate,
                    config=self.config,
                    endpoint_url=self.sts_endpoint_url
                )
                kwargs.update({
                    'RoleArn': role_arn or self.aws_role_arn,
                    'RoleSessionName': role_session_name or self.aws_role_session_name,
                })
                sts_response = sts_client.assume_role(**kwargs)
                client = boto3.client(
                    service_name=service,
                    region_name=region if region else self.aws_default_region,
                    aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                    aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                    aws_session_token=sts_response['Credentials']['SessionToken'],
                    verify=self.verify_certificate,
                    config=self.config,
                    endpoint_url=self.endpoint_url
                )
            elif self.aws_session_token and not self.aws_role_arn:  # login with session token
                client = boto3.client(
                    service_name=service,
                    region_name=region if region else self.aws_default_region,
                    aws_access_key_id=self.aws_access_key_id,
                    aws_secret_access_key=self.aws_secret_access_key,
                    aws_session_token=self.aws_session_token,
                    verify=self.verify_certificate,
                    config=self.config,
                    endpoint_url=self.endpoint_url
                )
            elif self.aws_access_key_id and not self.aws_role_arn:  # login with access key id
                client = boto3.client(
                    service_name=service,
                    region_name=region if region else self.aws_default_region,
                    aws_access_key_id=self.aws_access_key_id,
                    aws_secret_access_key=self.aws_secret_access_key,
                    verify=self.verify_certificate,
                    config=self.config,
                    endpoint_url=self.endpoint_url
                )
            else:  # login with default permissions, permissions pulled from the ec2 metadata
                client = boto3.client(service_name=service,
                                      region_name=region if region else self.aws_default_region,
                                      endpoint_url=self.endpoint_url)

            return client

        @staticmethod
        def get_timeout(timeout):
            if not timeout:
                timeout = "60,10"  # default values
            try:

                if isinstance(timeout, int):
                    read_timeout = timeout
                    connect_timeout = 10

                else:
                    timeout_vals = timeout.split(',')
                    read_timeout = int(timeout_vals[0])
                    # the default connect timeout is 10
                    connect_timeout = 10 if len(timeout_vals) == 1 else int(timeout_vals[1])

            except ValueError:
                raise DemistoException("You can specify just the read timeout (for example 60) or also the connect "
                                       "timeout followed after a comma (for example 60,10). If a connect timeout is not "
                                       "specified, a default of 10 second will be used.")
            return read_timeout, connect_timeout

    register_module_line('AWSApiModule', 'end', __line__(), wrapper=1)
    ### END GENERATED CODE ###

    if __name__ in ('__builtin__', 'builtins', '__main__'):
        main()

    register_module_line('AWS - IAM', 'end', __line__())
  subtype: python3
  type: python
system: true
