category: Vulnerability Management
commonfields:
  id: QualysV2
  version: -1
configuration:
- additionalinfo: 'When using asset-tag commands, the official documentation recommends
    that the SERVER URL parameter should be in the following format: `https://qualysapi.<tenant>.apps.qualys.com/<end-point>`.
    For more details see the integration documentation.'
  defaultvalue: https://qualysguard.qg2.apps.qualys.com
  display: Server URL
  name: url
  required: true
  section: Connect
  type: 0
- display: Username
  name: credentials
  required: true
  section: Connect
  type: 9
- advanced: true
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  section: Connect
  type: 8
- advanced: true
  display: Use system proxy settings
  name: proxy
  required: false
  section: Connect
  type: 8
- additionalinfo: If "First event fetch time" is set for a long time ago, it may cause
    performance issues.
  advanced: true
  defaultvalue: 3 days
  display: Event first fetch time
  name: first_fetch
  required: false
  section: Collect
  type: 0
- additionalinfo: Maximum number of events to fetch per fetch iteration.
  advanced: true
  defaultvalue: "10000"
  display: Event Fetch Limit
  name: max_fetch_activity_logs
  required: false
  section: Collect
  type: 0
- additionalinfo: The fetch interval. It is recommended to set it to 24 hours, and
    the minimum interval is 1 hour.
  advanced: true
  defaultvalue: "1440"
  display: Assets and Vulnerabilities Fetch Interval
  name: assetsFetchInterval
  required: false
  section: Collect
  type: 19
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.5.0
    itemVersion: 3.0.2
    packID: qualys
    packName: Qualys
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: Qualys Vulnerability Management lets you create, run, manage reports
  and to fetch Activity Logs, Assets and Vulnerabilities, launch and manage vulnerability
  and compliance scans, and manage the host assets you want to scan for vulnerabilities
  and compliance.
detaileddescription: "## Qualys Vulnerability Management Help\n\n-You need a Qualys
  user account to use the Qualys integration. If a subscription has multiple users,
  all users with any user role (except Contact) can use the Qualys integration. Each
  user’s permissions correspond to their assigned user role.\n  \n- Qualys Vulnerability
  Management uses basic authentication. You'll need your Qualys login credentials
  in order to use this integration.\n  \n- You can get your server URL by identifying
  your platform in this link: <https://www.qualys.com/platform-identification/>\n
  \ \n- Qualys user accounts that have been enabled with VIP two-factor authentication
  can be used with the Qualys API, however two-factor authentication will not be used
  when making API requests. Two-factor authentication is only supported when logging
  into the Qualys GUI.\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/qualys-v2)"
display: Qualys VMDR
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAYAAACXpx/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAA14SURBVHgB7VsLeFTFFT5zdze7eQcSCQ/BAEl4GQgE+LQqREUtiq2oqB8oWJVQpFTspyIWK6JoFWhLrQhqQYvKJ5GCRWgVhBDwVQxCIOTJU4goScA8Nsm+rv/Z3N3sLneTuzEBPr3/901m7pn3nJlzzpzZEOnQoUOHDh06dOjQoUOHDh0/HwgKEfI8kirXp2ZILhpDMg2UBQ0BNRFZ8WjOgODAd5VM8gmSxVGJxGcuSc7ZmlqSd0c2OUnHOYUmBssZGaZTtpoxEtE0SdBomSiOQoUsV5Mktjpd8l+77CvNJR3nBK0yuOLSlOskg/SELMuZ1E5wEX1iJpoTk1+yg3R0KIIy+OTgvl1MZFiJ5I3UMYAUl9fKjWJWQknJCdLRIVBlcEVaan/k5CLzohYrm80UduPNZBxxGRl69yERHk5ybQ05vz5Gjp3byfbpTpJPn26pCXCZiowm17i4vLKDpKPdocrgyrTUzcgZE7RSfAJFPj6XTFdfS8IUFqwYyXY72Tb+h6yLXyC5+nsKPgp5c/ze0utJR7tDUifLQU+uceTlFLvqXQq7fmyLzGUIk4nMt9xGsWs3kCE5JXhBl7iYdHQIVBksC5GgRjcOG07Ri5eQ1MOfH3JNNdlztlLjB++TfWcuyd/7n1apSyJF/+M1Ml1xFan21xarXIcmqOvgwanVyIj2pUndulNs9vskomO8NPnMGapbMI/sWzeT7HA0FzYYyIwTHv67WSRd3NNLdlVUUPW9d5Hr668Du6yJzy+JoR85l4EDB5oOHDhgJ/ee0cFQ18GDU22ITL60mLffI+Olad5v2+b/uZnbkhElIiIpcv7zFHbdDc31PtxEtY89HFjUAQabKET07t27n8lkmoHkOIQeCKwzmMFssK2x2WyvHDly5CSdJ2DDdXU4HIVIWpxO500HDx7cSucYQXSwP3MN/Qf6MZet5Lqn57ZuIVvrqPaPj5LzUJmXFnbDjST1vCSwqJFCg5SamvowmLsL6ZkIvamJuZ6x90f4U1hY2C6Uu4fOLywchBChzrFdIGkpZB5/m9+39ZmnoHdrSBMaG6nuyTnsyfKSLJMmn1UMbhStCyBSUlJeg+NlEdLRiK0Iy5G+C2GMy+W6E4u5FmnWGWwsrExOTr6PfqZQXVSZ7Swf8R02KtOb5yw8QPYvPqVQ4NifT449u8k4NKOpvct+QVZqG3Ai70bkYdgug8FwR1FR0ZGAYmsgHofa7fb1YHYvSZKW9+/fH8WKQhv4TwCqDBZNu98tpkVMDAysHt48245t1BY4S0u8DJYuSULP6NpjmOEIUk7rDxHQufyo8YLyuQc6dhR0bINaWRhbX/Xr1y8TTbPeS8LJXoU4mXvr1atXp/DwcLcYaWhoWHP06NFvfOsOGDBgGMqzyV9TXFz8Brm9q01ISkqKg2q4E8mrsHkiEVejj7dKS0s3Y/NNBq0T9O2OsrKy3SrDMvAGRZk4lNmDMtsD8yFtpmDTRiN/L/JzmNi3b99k0B5EP52xWbdXVVVlnzp1qpY0QP2aBD560iI8An+abTHn8ePUFji/9bF1JImkTp2b+xOiUWiwfLGwrCu6YaJYf9eDwZjrAZhzGJHHouuDhRrGCaPRyKL9bxygp3sF1oNhdKWS/3RmZqZ3jcD4QazXwaBlCJNAugWBmfoRGPcq0tO5Hr6vCTIk3sRXcxkwanVgJqRMOuivK/kRTEO7I5HeyfNAu1OQtyIuLo43hqaHIlUGC5nqPGm5wX8NBa5AbYEUFeX3Lbucvv1pktiY3HglmYvd/ZmWOmDmJkRugwELNZbaiJ49e3bHqcqhJilgx1jeQfwI4iUIx5CeijC0tXZQ9hVqOkDdwLyxAXn8zYwrwbi38JBB+ycYm4g4F2E2aEX4dmRkZISTBgQ7wV4Lil2MMgwlb4Wu3aktMKT0a26/3ooX4yqfXKFF3GBewuMO20UaAVHNi5mvNDCQ2oiIiIinESVgkZ2QHqMgkieVlJQsRjwL7WYgsEg2t9ZOjx498hB9yWm0NcEnS0K7U5Vx/pfHDXGNN3bqwzTYE4+hrxchQTK7d+9+RV5enqZDIakT5WZPBNSjc/8+72fYqNEUKgzQucbhI7zfjr17/KxqQXKrch+ikkWHR3w0UGjwLEYEtQGJiYmRYAbrXV78ZyA9PvfNB6MroCNZurSqZnJyctjwWK20NZbtAU5DfVzPBiGSjWDmy0yDfVALGksHVk9rcHu4F7QzShuaEMRVSXt9v22f7/SmDQMGkbF/CAcBxlTEH2aTsDRLlMb1a/37I7m0tWaUSVW6y8vyJaQR2BgceazE76gNiI6OTiLFswf9vEmtDE4cM6KINMBqtbJ4583QFcae+zkWG2Smkr3t0KFD7vU4fvx4PdTCA5jvcWY+wkqEL3Gyr1bm1SpUGexyCr8dalub7aeLI+Y8SSKs5YcGDyz3ZZEps9nmcB4sI/t2f4eOQcgfaGkLE81zD1qSxvfp0ydWSx1YyEmIBiifO1TaVDNW/GhYVO/JBCPsKuUJOpHb0vSTJDCuCmXfU/r/LU5vCuJrlL4W+paF9+sTNvqQZCPOjvxLMf+N5eXlV2npS5XBCQbLBnTo5airsoLs27Z4843pw8gy46Gmq04wwPIOnz6TIricD+qXvwwPl6/6kOtjGw0fkgZAR/Gi8GJHwwh5ihc1GObNm0dpaWnYh2ELqIlhDlwv1ivteG8JYFiib70JEybwonf1pUFkHkLU2DQtcS1OEAXWqamp6YukZtGGdl5SkiMwF9bjFvR7EJZ/DhP55ggjTAwdOhR2reEo1MC0xsbGIaDz6WZxuNh3rsGgbkXn59dhBFt8afym6/tIED7lfop6fhGJTp1UWpUoatESCp82w4/MzGVftF9fJLJFcbEmt1h9fT1fDzyn8P7a2trZvAhwargXhMExi68VK1ZEoPyz+J6olF9UUVHh7gfXKxbV1ZwGsyfHx8dLzLT09HTatWtXN5yQX/v2q1zHPNeaR8GQ4bzwXIc30e7duxPBILZ2NXkGGWAY672vEMwY43T3WgjBG9h95x4+fLgJ9Nfr6upWg3457vQUGxvLfu1/KU2wAUY8hqVLl0ZxvhqCDshlkBfKPkaD69R3VPPQNJJrFYMXJ5TfhGPfykb8SzdTmyu7qO65+W4/dOO6bHIeKKD6pX93hwDIQnatII2AWLJi8edQ07hisAB/RrwSJ2xgVlYWOxHYjWk5efJkpsViyUbZJ5Sq27FIz/lOj5SFAv3WhISEdSg7E7pxntlszqFmkd48UFl+EhFPPhGb4hOUfZPrwNkyHwzfgfxQrU+ewyolzRKGxe9KTyasZP5mkc+u141ofypO8B1IP6AU+YL/4HSPiImJyYKuVnXHihZ6F1WDU99CcqIv3XTlKIpa8CKJOP+T6yjcT7aNG8j28WZyfVPuZyUHAzpf3Sm/ZJIWJ4cvsFvZocAiztA8XDoB2hlqelvurpwmpu9gz1NBQYHfqxJ2fgzKfKpcnYT/1IldmlegvX24mqSTcqpQ52YWrYq161cHeBv04Tw8PpGot5xfk7D52NkSBkakw1W6z3cM2JD8KMJXvij2n0M83+6bzxY2Nuo6JEcF9MfG5khIgUPY0G7rG31Gos8lFIAWvSHWQYN6NRjsJXLA/Y7feKOXLGO/2tmV+FpVVAiX5nb4n/PIgbRcVXkWw/F1utZuGJRUWPgNtQFY7LtxgthpEKWWz84HTPxZLNprQqhPEwvMP2zgRwp2MPB7dCFO51qcBis2BYvN+VhEP8sYBlEX5E1GudFotzP6KUN4H4v7b7S3EOlvkWb9KMOt2RUSgTfEu2Dueypz6Iu8YgTeqGPQ18eBZXDnjYiMjLwHZfhVLArtb8O8F2Je5ZwPBl+EzZOMMdej3z2B9Vt1d1WmpU5FqVfPqggftXn87WS55zckXdQleANgrOtkOdm2fETWv7zoFt+gueCevC8hv+RN+hHAAl2OiS9AyCT/uWwFA5ZhMb6AY6E8NzdX873xXEExol7A2B8jt0ou4dPc7j9U0OTPrEhLWYKB/F61AbggzbdOIMuEiXjn7ennt/bAVX6CqrOm+BhpYmHn/OLZon0mxHr3JmV8mdT0gOIZRCNfQ7Cz36ALDDjdFlj4LLKTsRkXw3nyCHUANP/rSsWQ1A24DY4L2pDZTIbBQ8k0YqT7GmVMG+L+Ga0jfw/Vzn2cXMeOeDp8p1OV9QGBSzy1M8DoAfwKBBE2UnEfroQoY119wf2EB9JnEsa5ChuwAPfccYcPHz5KHQDNDD6dnh7nclpXoMZ4TRWY4XBROstKm8QyucXSR/HxpTeJHLrgROa5BsTzEOhOQ2FhIV+VOmwDhvTPZ5WwPOUI6SVUmhxKPR69kOVlnfeVPiguwNP0U4bmizkjvqysGobRFHCIvUPaGCVTA5g7v6penqUz99wj5H8f9aAyPTWLXPJcNNEzWBlw8zuDkKbH7S1apzP3/KDNDGZU4Z7skhxvwhc/ms52Fmwy2uqmxBadqCQd5w0hiehAdC4oOBa/r3gMrKgsWFBsBeJ2J+8XLjGj860Tf6Uz9/zjR51gXzT9u6kYZbQYt8X+v0hnrA4dOnTo0KFDhw4dOnTouBDxA1WvifqIKmpHAAAAAElFTkSuQmCC
name: QualysV2
script:
  commands:
  - arguments:
    - description: Show only certain IP addresses/ranges.
      name: ips
    - description: Restrict the request to a certain custom network ID.
      name: network_id
    - auto: PREDEFINED
      description: Show only IP addresses/ranges which have a certain tracking method.
      name: tracking_method
      predefined:
      - IP
      - DNS
      - NETBIOS
    - auto: PREDEFINED
      description: Specify 1 to list compliance IP addresses in the user’s account.
        These hosts are assigned to the policy compliance module. Specify 0 to get
        host that are not assigned to the policy compliance module.
      name: compliance_enabled
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: (Optional) Specify 1 to list IP addresses in the user’s account
        assigned to the Certificate View module. Specify 0 to list IP addresses that
        are not assigned to the Certificate View module. Note - This option will be
        supported when Certificate View GA is released and is enabled for your account.
      name: certview_enabled
      predefined:
      - "0"
      - "1"
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: View a list of IP addresses in the user account.
    name: qualys-ip-list
    outputs:
    - contextPath: Qualys.IP.Address
      description: IP addresses.
    - contextPath: Qualys.IP.Range
      description: IP range.
  - arguments:
    - description: Specify a report ID of a report that is saved in the Report Share
        storage space.
      name: id
    - auto: PREDEFINED
      description: Specify reports with a certain state.
      name: state
      predefined:
      - Running
      - Finished
      - Canceled
      - Errors
    - description: Specify a user login ID to get reports launched by the specified
        user login ID.
      name: user_login
    - description: Specify the date and time to get only reports that expire before
        it. use YYYY-MM-DD[THH:MM:SSZ] like “2007-07-01” or “2007-01-25T23:12:00Z”
        or today, yesterday, 24hr ago, 3 days ago, last week.
      name: expires_before_datetime
    - description: (Optional) Id assigned to the client (Consultant type subscriptions).
      name: client_id
    - description: (Optional) Name of the client (Consultant type subscriptions).
        Note, The client_id and client_name parameters are mutually exclusive and
        cannot be specified together in the same request.
      name: client_name
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: Get a list of generated reports in the system.
    name: qualys-report-list
    outputs:
    - contextPath: Qualys.Report.ID
      description: Report ID.
      type: String
    - contextPath: Qualys.Report.TITLE
      description: Report title.
    - contextPath: Qualys.Report.TYPE
      description: Report type.
    - contextPath: Qualys.Report.LAUNCH_DATETIME
      description: Date and time the report launched.
    - contextPath: Qualys.Report.OUTPUT_FORMAT
      description: Report output format.
    - contextPath: Qualys.Report.SIZE
      description: Report size.
    - contextPath: Qualys.Report.STATUS.STATE
      description: Report state status.
    - contextPath: Qualys.Report.STATUS.MESSAGE
      description: Report status message.
    - contextPath: Qualys.Report.STATUS.PERCENT
      description: Report status percent.
    - contextPath: Qualys.Report.EXPIRATION_DATETIME
      description: Report expiration datetime.
  - arguments:
    - description: Show only a scan with a certain scan reference code.
      name: scan_ref
    - description: Show only one or more scan states.
      name: state
    - auto: PREDEFINED
      description: Specify 0 to show only scans that are not processed. Specify 1
        to show only scans that have been processed.
      name: processed
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: Show only a certain scan type.
      name: type
      predefined:
      - On-Demand
      - Scheduled
      - API
    - description: Show only one or more target IP addresses.
      name: target
    - description: Show only a certain user login.
      name: user_login
    - description: Show only scans launched after a certain date and time. use YYYY-MM-DD[THH:MM:SSZ]
        like “2007-07-01” or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago,
        3 days ago, last week.'
      name: launched_after_datetime
    - description: Show only scans launched before a certain date and time. use YYYY-MM-DD[THH:MM:SSZ]
        like “2007-07-01” or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago,
        3 days ago, last week.'
      name: launched_before_datetime
    - auto: PREDEFINED
      description: Specify 1 to show asset group information for each scan in the
        output.
      name: show_ags
      predefined:
      - "1"
    - auto: PREDEFINED
      description: Specify 1 to show option profile information for each scan in the
        output.
      name: show_op
      predefined:
      - "1"
    - auto: PREDEFINED
      description: Specify 0 to not show scan status for each scan in the output.
      name: show_status
      predefined:
      - "0"
    - auto: PREDEFINED
      description: Specify 1 to show only the most recent scan (which meets all other
        search filters in the request) in the output.
      name: show_last
      predefined:
      - "1"
    - description: (Optional) Show only a scan with a certain compliance scan ID.
      name: scan_id
    - description: (Optional) Id assigned to the client (Consultant type subscription
        only). Parameter client_id or client_name may be specified for the same request.
      name: client_id
    - description: (Optional) Name of the client (Consultant type subscription only).
        Parameter client_id or client_name may be specified for the same request.
      name: client_name
    - auto: PREDEFINED
      description: (Optional) Specify 1 to show only external PCI scans in the XML
        output. External PCI scans are vulnerability scans run with the option profile
        "Payment Card Industry (PCI) Options". When pci_only=1 is specified, the XML
        output will not include other types of scans run with other option profiles.
      name: pci_only
      predefined:
      - "1"
    - auto: PREDEFINED
      description: (Optional) Specify 1 to hide target information from the scan list.
        Specify 0 to display the target information.
      name: ignore_target
      predefined:
      - "1"
      - "0"
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: Lists vulnerability scans in the user’s account.
    name: qualys-vm-scan-list
    outputs:
    - contextPath: Qualys.Scan.REF
      description: Scan REF.
    - contextPath: Qualys.Scan.TYPE
      description: Scan type.
    - contextPath: Qualys.Scan.TITLE
      description: Scan title.
    - contextPath: Qualys.Scan.LAUNCH_DATETIME
      description: Date and time the scan launched.
    - contextPath: Qualys.Scan.DURATION
      description: Scan Duration.
    - contextPath: Qualys.Scan.PROCESSING_PRIORITY
      description: Scan Processing Priority.
    - contextPath: Qualys.Scan.PROCESSED
      description: Scan Processed.
    - contextPath: Qualys.Scan.STATUS.STATE
      description: Scan status state.
    - contextPath: Qualys.Scan.STATUS.SUB_STATE
      description: Scan status sub state.
    - contextPath: Qualys.Scan.SCHEDULE
      description: Scan Schedule.
    - contextPath: Qualys.Scan.TARGET
      description: Scan Target.
    - contextPath: Qualys.Scan.ASSET_GROUP_TITLE
      description: Target Asset Group Title.
    - contextPath: Qualys.Scan.DEFAULT_FLAG
      description: Scan Default Flag.
    - contextPath: Qualys.Scan.USER_LOGIN
      description: The user that created the scan.
  - arguments:
    - description: Show only a scan with a certain scan reference code.
      name: scan_ref
    - description: Show only one or more scan states.
      name: state
    - auto: PREDEFINED
      description: Specify 0 to show only scans that are not processed. Specify 1
        to show only scans that have been processed.
      name: processed
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: Show only a certain scan type.
      name: type
      predefined:
      - On-Demand
      - Scheduled
      - API
    - description: Show only one or more target IP addresses.
      name: target
    - description: Show only a certain user login.
      name: user_login
    - description: Show only scans launched after a certain date and time. use YYYY-MM-DD[THH:MM:SSZ]
        like “2007-07-01” or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago,
        3 days ago, last week.'
      name: launched_after_datetime
    - description: Show only scans launched before a certain date and time. use YYYY-MM-DD[THH:MM:SSZ]
        like “2007-07-01” or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago,
        3 days ago, last week.'
      name: launched_before_datetime
    - auto: PREDEFINED
      description: Specify 1 to show asset group information for each scan in the
        output.
      name: show_ags
      predefined:
      - "1"
    - auto: PREDEFINED
      description: Specify 1 to show option profile information for each scan in the
        output.
      name: show_op
      predefined:
      - "1"
    - auto: PREDEFINED
      description: Specify 0 to not show scan status for each scan in the output.
      name: show_status
      predefined:
      - "0"
    - auto: PREDEFINED
      description: Specify 1 to show only the most recent scan (which meets all other
        search filters in the request) in the output.
      name: show_last
      predefined:
      - "1"
    - description: (Optional) Show only a scan with a certain compliance scan ID.
      name: scan_id
    - description: (Optional) Id assigned to the client (Consultant type subscription
        only). Parameter client_id or client_name may be specified for the same request.
      name: client_id
    - description: (Optional) Name of the client (Consultant type subscription only).
        Parameter client_id or client_name may be specified for the same request.
      name: client_name
    - auto: PREDEFINED
      description: (Optional) Specify 1 to show only external PCI scans in the XML
        output. External PCI scans are vulnerability scans run with the option profile
        "Payment Card Industry (PCI) Options". When pci_only=1 is specified, the XML
        output will not include other types of scans run with other option profiles.
      name: pci_only
      predefined:
      - "1"
    - auto: PREDEFINED
      description: (Optional) Specify 1 to hide target information from the scan list.
        Specify 0 to display the target information.
      name: ignore_target
      predefined:
      - "1"
      - "0"
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: Gives you a list of SCAP scans in your account.
    name: qualys-scap-scan-list
    outputs:
    - contextPath: Qualys.SCAP.Scan.ID
      description: Scan ID.
    - contextPath: Qualys.SCAP.Scan.Reference
      description: Scan ref.
    - contextPath: Qualys.SCAP.Scan.REF
      description: Scan REF.
    - contextPath: Qualys.SCAP.Scan.Type
      description: Scan type.
    - contextPath: Qualys.SCAP.Scan.Title
      description: Scan title.
    - contextPath: Qualys.SCAP.Scan.LaunchDatetime
      description: Date and time the scan launched.
    - contextPath: Qualys.SCAP.Scan.Duration
      description: Scan Duration.
    - contextPath: Qualys.SCAP.Scan.ProcessingPriority
      description: Scan Processing Priority.
    - contextPath: Qualys.SCAP.Scan.Processed
      description: Scan Processed.
    - contextPath: Qualys.SCAP.Scan.Status.State
      description: Scan status state.
    - contextPath: Qualys.SCAP.Scan.Status.SubState
      description: Scan status sub state.
    - contextPath: Qualys.SCAP.Scan.Schedule
      description: Scan Schedule.
    - contextPath: Qualys.SCAP.Scan.Target
      description: Scan Target.
    - contextPath: Qualys.SCAP.Scan.AssetGroupTitle
      description: Target Asset Group Title.
    - contextPath: Qualys.SCAP.Scan.DeafualtFlag
      description: Scan Default Flag.
    - contextPath: Qualys.SCAP.Scan.UserLogin
      description: The user that created the scan.
  - arguments:
    - description: Scan id.
      name: scan_id
    - description: Scan reference.
      name: scan_ref
    - description: Show only one or more scan states.
      name: state
    - auto: PREDEFINED
      description: Specify 0 to show only scans that are not processed. Specify 1
        to show only scans that have been processed.
      name: processed
      predefined:
      - "0"
      - "1"
    - description: Show only a certain scan type.
      name: type
    - description: Show only one or more target IP addresses.
      name: target
    - description: Show only a certain user login.
      name: user_login
    - description: Show only scans launched after a certain date and time. use YYYY-MM-DD[THH:MM:SSZ]
        like “2007-07-01” or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago,
        3 days ago, last week.'
      name: launched_after_datetime
    - description: Show only scans launched before a certain date and time. use YYYY-MM-DD[THH:MM:SSZ]
        like “2007-07-01” or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago,
        3 days ago, last week.'
      name: launched_before_datetime
    - auto: PREDEFINED
      description: Specify 1 to show asset group information for each scan in the
        output.
      name: show_ags
      predefined:
      - "1"
    - auto: PREDEFINED
      description: Specify 1 to show option profile information for each scan in the
        output.
      name: show_op
      predefined:
      - "1"
    - auto: PREDEFINED
      description: Specify 0 to not show scan status for each scan in the output.
      name: show_status
      predefined:
      - "0"
    - auto: PREDEFINED
      description: Specify 1 to show only the most recent scan (which meets all other
        search filters in the request) in the output.
      name: show_last
      predefined:
      - "1"
    - auto: PREDEFINED
      description: Specify 1 to show only external PCI scans in the XML output. External
        PCI scans are vulnerability scans run with the option profile "Payment Card
        Industry (PCI) Options". When pci_only=1 is specified, the XML output will
        not include other types of scans run with other option profiles.
      name: pci_only
      predefined:
      - "1"
      - "0"
    - auto: PREDEFINED
      description: Specify 1 to hide target information from the scan list. Specify
        0 to display the target information.
      name: ignore_target
      predefined:
      - "1"
      - "0"
    - description: (Optional) Id assigned to the client (Consultant type subscriptions).
      name: client_id
    - description: (Optional) Name of the client (Consultant type subscriptions).
        Note, The client_id and client_name parameters are mutually exclusive and
        cannot be specified together in the same request.
      name: client_name
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: Get a list of compliance scans in your account.
    name: qualys-pc-scan-list
    outputs:
    - contextPath: Qualys.Scan.REF
      description: Scan REF.
    - contextPath: Qualys.Scan.TYPE
      description: Scan type.
    - contextPath: Qualys.Scan.TITLE
      description: Scan title.
    - contextPath: Qualys.Scan.LAUNCH_DATETIME
      description: Date and time the scan launched.
    - contextPath: Qualys.Scan.DURATION
      description: Scan Duration.
    - contextPath: Qualys.Scan.PROCESSING_PRIORITY
      description: Scan Processing Priority.
    - contextPath: Qualys.Scan.PROCESSED
      description: Scan Processed.
    - contextPath: Qualys.Scan.STATUS.STATE
      description: Scan status state.
    - contextPath: Qualys.Scan.STATUS.SUB_STATE
      description: Scan status sub state.
    - contextPath: Qualys.Scan.SCHEDULE
      description: Scan Schedule.
    - contextPath: Qualys.Scan.TARGET
      description: Scan Target.
    - contextPath: Qualys.Scan.ASSET_GROUP_TITLE
      description: Target Asset Group Title.
    - contextPath: Qualys.Scan.DEFAULT_FLAG
      description: Scan Default Flag.
    - contextPath: Qualys.Scan.USER_LOGIN
      description: The user that created the scan.
  - arguments:
    - description: The ID of the scan schedule you want to display.
      name: id
    - auto: PREDEFINED
      description: Specify 1 for active schedules only, or 0 for deactivated schedules
        only.
      name: active
      predefined:
      - "0"
      - "1"
    - description: (Optional) Specify 1 to include the notification settings for each
        schedule in the XML output.
      name: show_notifications
    - auto: PREDEFINED
      description: (Optional) Launch a scan with a certain type.
      name: scan_type
      predefined:
      - certview
      - perimeter
    - description: (Optional) The target FQDN for a vulnerability scan. You must specify
        at least one target i.e. IPs, asset groups or FQDNs. Multiple values are comma
        separated.
      name: fqdn
    - description: (Optional) Set to 1 to display the cloud details (Provider, Connector,
        Scan Type and Cloud Target) in the XML output. Otherwise the details are not
        displayed in the output. The cloud details will show scan type "Cloud Perimeter"
        for cloud perimeter scans.
      name: show_cloud_details
    - description: (Optional) Id assigned to the client (Consultant type subscription
        only). Parameter client_id or client_name may be specified for the same request.
      name: client_id
    - description: (Optional) Name of the client (Consultant type subscription only).
        Parameter client_id or client_name may be specified for the same request.
      name: client_name
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: Shows schedule scans.
    name: qualys-schedule-scan-list
    outputs:
    - contextPath: Qualys.Scan.ID
      description: Scan ID.
    - contextPath: Qualys.Scan.REF
      description: Scan REF.
    - contextPath: Qualys.Scan.TYPE
      description: Scan type.
    - contextPath: Qualys.Scan.TITLE
      description: Scan title.
    - contextPath: Qualys.Scan.LAUNCH_DATETIME
      description: Date and time the scan launched.
    - contextPath: Qualys.Scan.DURATION
      description: Scan Duration.
    - contextPath: Qualys.Scan.PROCESSING_PRIORITY
      description: Scan Processing Priority.
    - contextPath: Qualys.Scan.PROCESSED
      description: Scan Processed.
    - contextPath: Qualys.Scan.STATUS.STATE
      description: Scan status state.
    - contextPath: Qualys.Scan.STATUS.SUB_STATE
      description: Scan status sub state.
    - contextPath: Qualys.Scan.TARGET
      description: Scan Target.
    - contextPath: Qualys.Scan.ASSET_GROUP_TITLE
      description: Target Asset Group Title.
    - contextPath: Qualys.Scan.DEFAULT_FLAG
      description: Scan Deafualt Flag.
    - contextPath: Qualys.Scan.USER_LOGIN
      description: The user that created the scan.
    - contextPath: Qualys.Scan.ACTIVE
      description: Scheduled scan active.
    - contextPath: Qualys.Scan.USER_ENTERED_IPS.RANGE.START
      description: IP range requested start.
    - contextPath: Qualys.Scan.USER_ENTERED_IPS.RANGE.END
      description: IP range requested end.
    - contextPath: Qualys.Scan.ISCANNER_NAME
      description: Iscanner name used in the scan.
    - contextPath: Qualys.Scan.SCHEDULE.DAILY.@frequency_days
      description: Frequency of usage of the scan.
    - contextPath: Qualys.Scan.SCHEDULE.START_DATE_UTC
      description: Start date of the scheduled scan in UTC format.
    - contextPath: Qualys.Scan.SCHEDULE.START_HOUR
      description: Start hour of the scheduled scan.
    - contextPath: Qualys.Scan.SCHEDULE.START_MINUTE
      description: Start minute of the scheduled scan.
    - contextPath: Qualys.Scan.SCHEDULE.TIME_ZONE.TIME_ZONE_CODE
      description: Time zone code of the time for the scheduled scan.
    - contextPath: Qualys.Scan.SCHEDULE.TIME_ZONE.TIME_ZONE_DETAILS
      description: Time zone details of the time for the scheduled scan.
    - contextPath: Qualys.Scan.OPTION_PROFILE.DEFAULT_FLAG
      description: Default flag of the option profile.
    - contextPath: Qualys.Scan.OPTION_PROFILE.TITLE
      description: Title of the option profile.
    - contextPath: Qualys.Scan.EC2_INSTANCE.CONNECTOR_UUID
      description: Connector UUID of EC2 instance.
    - contextPath: Qualys.Scan.EC2_INSTANCE.EC2_ENDPOINT
      description: Endpoint of EC2 instance.
    - contextPath: Qualys.Scan.EC2_INSTANCE.EC2_ONLY_CLASSIC
      description: EC2 only classic.
  - arguments:
    - description: Show only hosts which have an operating system matching a certain
        regular expression. An empty value cannot be specified. Use “%5E%24” to match
        empty string.
      name: os_pattern
    - description: Specify the maximum number of host records processed per request.
        When not specified, the truncation limit is set to 1000 host records. You
        may specify a value less than the default (1-999) or greater than the default
        (1001-1000000).
      name: truncation_limit
    - description: Show only certain IP addresses/ranges. One or more IPs/ranges may
        be specified. Multiple entries are comma separated. An IP range is specified
        with a hyphen (for example, 10.10.10.1-10.10.10.100).
      name: ips
    - description: Show only hosts belonging to asset groups with certain strings
        in the asset group title. One or more asset group titles may be specified.
        Multiple entries are comma separated (for example, My+First+Asset+Group,Another+Asset+Group).
      name: ag_titles
    - description: Show only certain host IDs/ranges. One or more host IDs/ranges
        may be specified. Multiple entries are comma separated. A host ID range is
        specified with a hyphen (for example, 190-400).Valid host IDs are required.
      name: ids
    - description: (Optional, and valid only when the Network Support feature is enabled
        for the user’s account) Restrict the request to certain custom network IDs.
        Multiple network IDs are comma separated.
      name: network_ids
    - description: 'Show hosts not scanned since a certain date and time (optional).
        use YYYY-MM-DD[THH:MM:SSZ] like “2007-07-01” or “2007-01-25T23:12:00Z” or
        today, yesterday, 24hr ago, 3 days ago, last week. Permissions: An Auditor
        cannot specify this parameter.'
      name: no_vm_scan_since
    - description: 'Show hosts that were last scanned for vulnerabilities since a
        certain date and time (optional). Hosts that were the target of a vulnerability
        scan since the date/time will be shown. use YYYY-MM-DD[THH:MM:SSZ] like “2007-07-01”
        or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago, 3 days ago, last
        week. Permissions: An Auditor cannot specify this parameter.'
      name: vm_scan_since
    - description: (Optional) Show compliance hosts not scanned since a certain date
        and time (optional). This parameter is invalid for an Express Lite user. use
        YYYY-MM-DD[THH:MM:SSZ] like “2007-07-01” or “2007-01-25T23:12:00Z” or today,
        yesterday, 24hr ago, 3 days ago, last week.
      name: no_compliance_scan_since
    - auto: PREDEFINED
      description: Specify 0 (the default) if you want to select hosts based on IP
        addresses/ranges and/or asset groups. Specify 1 if you want to select hosts
        based on asset tags.
      name: use_tags
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: (Optional when use_tags=1) Specify “id” (the default) to select
        a tag set by providing tag IDs. Specify “name” to select a tag set by providing
        tag names.
      name: tag_set_by
      predefined:
      - id
      - name
    - auto: PREDEFINED
      description: (Optional when use_tags=1) Select “any” (the default) to include
        hosts that match at least one of the selected tags. Select “all” to include
        hosts that match all of the selected tags.
      name: tag_include_selector
      predefined:
      - any
      - all
    - auto: PREDEFINED
      description: (Optional when use_tags=1) Select “any” (the default) to exclude
        hosts that match at least one of the selected tags. Select “all” to exclude
        hosts that match all of the selected tags.
      name: tag_exclude_selector
      predefined:
      - any
      - all
    - description: (Optional when use_tags=1) Specify a tag set to include. Hosts
        that match these tags will be included. You identify the tag set by providing
        tag names or IDs. Multiple entries are comma separated.
      name: tag_set_include
    - description: (Optional when use_tags=1) Specify a tag set to exclude. Hosts
        that match these tags will be excluded. You identify the tag set by providing
        tag names or IDs. Multiple entries are comma separated.
      name: tag_set_exclude
    - auto: PREDEFINED
      description: (Optional) Specify 1 to display asset tags associated with each
        host in the XML output.
      name: show_tags
      predefined:
      - "0"
      - "1"
    - description: 'Specify the name of the cloud provider to show the assets managed
        by the cloud provider. Valid values: ec2, google, azure.'
      name: host_metadata
    - description: (Optional when host_metadata is specified) Specify metadata fields
        to only return data for certain attributes.
      name: host_metadata_fields
    - auto: PREDEFINED
      description: (Optional) Specify 1 to display cloud provider tags for each scanned
        host asset in the output. The default value of the parameter is set to 0.
        When set to 0, we will not show the cloud provider tags for the scanned assets.
      name: show_cloud_tags
      predefined:
      - "0"
      - "1"
    - description: (Optional when show_cloud_tags is specified) Specify cloud tags
        or cloud tag and name combinations to only return information for specified
        cloud tags. A cloud tag name and value combination is specified with a colon
        (for example:SomeTag6:AY_ec2). For each cloud tag, we show the cloud tag’s
        name, its value, and last success date (the tag last success date/time, fetched
        from instance). If this parameter is not specified and "show_cloud_tags" is
        set to 1, we will show all the cloud provider tags for the assets.
      name: cloud_tag_fields
    - auto: PREDEFINED
      description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    - auto: PREDEFINED
      defaultValue: Basic
      description: '(Optional) Show the requested amount of host information for each
        host. A valid value is: Basic, Basic/AGs, All, All/AGs, or None. AGs is equal
        to Asset Groups.'
      name: details
      predefined:
      - Basic
      - Basic/AGs
      - All
      - All/AGs
      - None
    description: View a list of scanned hosts in the user account.
    name: qualys-host-list
    outputs:
    - contextPath: Qualys.Endpoint.ID
      description: Endpoint ID.
    - contextPath: Qualys.Endpoint.IP
      description: IP.
    - contextPath: Qualys.Endpoint.CLOUD_PROVIDER
      description: Host's cloud provider.
    - contextPath: Qualys.Endpoint.DNS
      description: DNS.
    - contextPath: Qualys.Endpoint.EC2_INSTANCE_ID
      description: EC2 instance ID.
    - contextPath: Qualys.Endpoint.QG_HOSTID
      description: QG host ID.
    - contextPath: Qualys.Endpoint.CLOUD_SERVICE
      description: Cloud service of the endpoint.
    - contextPath: Qualys.Endpoint.TRACKING_METHOD
      description: Tracking method of the endpoint.
    - contextPath: Qualys.Endpoint.CLOUD_RESOURCE_ID
      description: Cloud resource ID of the endpoint.
    - contextPath: Qualys.Endpoint.DNS_DATA.DOMAIN
      description: Domain of the endpoint.
    - contextPath: Qualys.Endpoint.DNS_DATA.HOSTNAME
      description: Host name of the endpoint.
    - contextPath: Qualys.Endpoint.NETBIOS
      description: NETBIOS.
    - contextPath: Qualys.Endpoint.OS
      description: Endpoint operating system.
  - arguments:
    - description: Show only virtual hosts that have a certain IP address.
      name: ip
    - description: Show only virtual hosts that have a certain port.
      name: port
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: View a list of virtual hosts in the user account.
    name: qualys-virtual-host-list
    outputs:
    - contextPath: Qualys.VirtualEndpoint.IP
      description: IP.
    - contextPath: Qualys.VirtualEndpoint.PORT
      description: Port.
    - contextPath: Qualys.VirtualEndpoint.FQDN
      description: Fully qualified domain name.
  - arguments:
    - auto: PREDEFINED
      description: Virtual host action to perform.
      name: action
      predefined:
      - create
      - update
      - delete
      - add_fqdn
      - delete_fqdn
      required: true
    - description: An IP address for the virtual host configuration.
      name: ip
      required: true
    - description: A port number for the virtual host configuration.
      name: port
      required: true
    - description: Network support must be enabled to specify the network_id. If network
        support is enabled and you do not provide a network_id, then the Default Global
        Network is considered. You can specify only one network_id.
      name: network_id
    - description: (Required for all actions except “delete”. Invalid for “delete”.)
        One or more fully-qualified domain names (FQDNs) for the virtual host configuration.
        Multiple entries are comma separated.
      name: fqdn
    description: View a list of virtual hosts in the user account.
    name: qualys-virtual-host-manage
    outputs:
    - contextPath: Qualys.VirtualEndpoint.DATETIME
      description: Date and time of the executed manage action.
    - contextPath: Qualys.VirtualEndpoint.TEXT
      description: Result message of the executed action.
  - arguments:
    - description: Get list of excluded hosts or addresses range.
      name: ips
    - description: (Optional, and valid only when the Network Support feature is enabled
        for the user’s account) Restrict the request to a certain custom network ID.
      name: network_id
    - description: (Optional) Show excluded hosts belonging to asset groups with certain
        IDs. One or more asset group IDs and/or ranges may be specified. Multiple
        entries are comma separated. A range is specified with a dash (for example,
        386941-386945). Valid asset group IDs are required.
      name: ag_ids
    - description: (Optional) Show excluded hosts belonging to asset groups with certain
        strings in the asset group title. One or more asset group titles may be specified.
        Multiple entries are comma separated (for example, My+First+Asset+Group,Another+Asset+Group).
      name: ag_titles
    - auto: PREDEFINED
      description: (Optional) Specify 0 (the default) if you want to select hosts
        based on IP addresses/ranges and/or asset groups. Specify 1 if you want to
        select hosts based on asset tags.
      name: use_tags
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: (Optional when use_tags=1) Specify "any" (the default) to include
        excluded hosts that match at least one of the selected tags. Specify "all"
        to include excluded hosts that match all of the selected tags.
      name: tag_include_selector
      predefined:
      - any
      - all
    - auto: PREDEFINED
      description: (Optional when use_tags=1) Specify "any" (the default) to ignore
        excluded hosts that match at least one of the selected tags. Specify "all"
        to ignore excluded hosts that match all of the selected tags.
      name: tag_exclude_selector
      predefined:
      - any
      - all
    - auto: PREDEFINED
      description: (Optional when use_tags=1) Specify "id" (the default) to select
        a tag set by providing tag IDs. Specify "name" to select a tag set by providing
        tag names.
      name: tag_set_by
      predefined:
      - id
      - name
    - description: (Optional when use_tags=1) Specify a tag set to include. Excluded
        hosts that match these tags will be included. You identify the tag set by
        providing tag names or IDs. Multiple entries are comma separated.
      name: tag_set_include
    - description: (Optional when use_tags=1) Specify a tag set to exclude. Excluded
        hosts that match these tags will be ignored. You identify the tag set by providing
        tag names or IDs. Multiple entries are comma separated.
      name: tag_set_exclude
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: Show the excluded host list for the user's account. Hosts in your
      excluded host list will not be scanned.
    name: qualys-host-excluded-list
    outputs:
    - contextPath: Qualys.Excluded.Host.Address
      description: IP Address.
    - contextPath: Qualys.Excluded.Host.Address.#text
      description: IP of excluded host with expiration date.
    - contextPath: Qualys.Excluded.Host.Address.@expiration_date
      description: Expiration date of excluded host address.
    - contextPath: Qualys.Excluded.Host.Range.#text
      description: Range of excluded hosts with expiration date.
    - contextPath: Qualys.Excluded.Host.Range.@expiration_date
      description: Expiration date of excluded hosts ranges.
    - contextPath: Qualys.Excluded.Host.Range
      description: Range of IP addresses.
  - arguments:
    - description: Scheduled report ID.
      name: id
    - auto: PREDEFINED
      description: Select is_active=1 for active or is_active=0 for inactive scheduled
        reports to view.
      name: is_active
      predefined:
      - "1"
      - "0"
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: Get list of scheduled reports.
    name: qualys-scheduled-report-list
    outputs:
    - contextPath: Qualys.Report.ID
      description: Report ID.
      type: String
    - contextPath: Qualys.Report.TITLE
      description: Report title.
    - contextPath: Qualys.Report.TYPE
      description: Report type.
    - contextPath: Qualys.Report.LAUNCH_DATETIME
      description: Date and time the report launched.
    - contextPath: Qualys.Report.OUTPUT_FORMAT
      description: Report output format.
    - contextPath: Qualys.Report.SIZE
      description: Report size.
    - contextPath: Qualys.Report.STATUS.STATE
      description: Report state status.
    - contextPath: Qualys.Report.STATUS.MESSAGE
      description: Report status message.
    - contextPath: Qualys.Report.STATUS.PERCENT
      description: Report status percent.
    - contextPath: Qualys.Report.EXPIRATION_DATETIME
      description: Report expiration datetime.
    - contextPath: Qualys.Report.ACTIVE
      description: Report active.
    - contextPath: Qualys.Report.TEMPLATE_TITLE
      description: Title of the template.
    - contextPath: Qualys.Report.SCHEDULE.START_DATE_UTC
      description: Start date of the scheduled report in UTC format.
    - contextPath: Qualys.Report.SCHEDULE.START_HOUR
      description: Start hour of the scheduled report.
    - contextPath: Qualys.Report.SCHEDULE.START_MINUTE
      description: Start minute of the scheduled report.
    - contextPath: Qualys.Report.SCHEDULE.DAILY.@frequency_days
      description: Frequency of the scheduled report.
    - contextPath: Qualys.Report.SCHEDULE.TIME_ZONE.TIME_ZONE_CODE
      description: Timezone of the scheduled report.
    - contextPath: Qualys.Report.SCHEDULE.TIME_ZONE.TIME_ZONE_DETAILS
      description: Timezone details of the scheduled report.
  - arguments:
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: get list of report template for user.
    name: qualys-report-template-list
    outputs:
    - contextPath: Qualys.ReportTemplate.ID
      description: Report template ID.
    - contextPath: Qualys.ReportTemplate.TYPE
      description: Report type.
    - contextPath: Qualys.ReportTemplate.TITLE
      description: Report template title.
    - contextPath: Qualys.ReportTemplate.LAST_UPDATE
      description: Last update time.
    - contextPath: Qualys.ReportTemplate.GLOBAL
      description: Report template global.
    - contextPath: Qualys.ReportTemplate.DEFAULT
      description: Report template default.
    - contextPath: Qualys.ReportTemplate.USER.LOGIN
      description: Last updated user login.
    - contextPath: Qualys.ReportTemplate.USER.FIRSTNAME
      description: Last updated user login first name.
    - contextPath: Qualys.ReportTemplate.USER.LASTNAME
      description: Last updated user login last name.
    - contextPath: Qualys.ReportTemplate.TEMPLATE_TYPE
      description: Type of report template.
  - arguments:
    - auto: PREDEFINED
      description: 'Show the requested amount of information for each vulnerability
        in the XML output. A valid value is: Basic (default), All, or None. Basic
        includes basic elements plus CVSS Base and Temporal scores. All includes all
        vulnerability details, including the Basic details.'
      name: details
      predefined:
      - Basic
      - All
      - None
    - description: Used to filter the XML output to include only vulnerabilities that
        have QID numbers matching the QID numbers you specify.
      name: ids
    - description: Used to filter the XML output to show only vulnerabilities that
        have a QID number greater than or equal to a QID number you specify.
      name: id_min
    - description: Used to filter the XML output to show only vulnerabilities that
        have a QID number less than or equal to a QID number you specify.
      name: id_max
    - auto: PREDEFINED
      description: Used to filter the XML output to show only vulnerabilities that
        are patchable or not patchable. A vulnerability is considered patchable when
        a patch exists for it. When 1 is specified, only vulnerabilities that are
        patchable will be included in the output. When 0 is specified, only vulnerabilities
        that are not patchable will be included in the output. When unspecified, patchable
        and unpatchable vulnerabilities will be included in the output.
      name: is_patchable
      predefined:
      - "0"
      - "1"
    - description: Used to filter the XML output to show only vulnerabilities last
        modified after a certain date and time. When specified vulnerabilities last
        modified by a user or by the service will be shown. use YYYY-MM-DD[THH:MM:SSZ]
        like “2007-07-01” or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago,
        3 days ago, last week.
      name: last_modified_after
    - description: Used to filter the XML output to show only vulnerabilities last
        modified before a certain date and time. When specified vulnerabilities last
        modified by a user or by the service will be shown. use YYYY-MM-DD[THH:MM:SSZ]
        like “2007-07-01” or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago,
        3 days ago, last week.
      name: last_modified_before
    - description: Used to filter the XML output to show only vulnerabilities last
        modified by a user after a certain date and time. use YYYY-MM-DD[THH:MM:SSZ]
        like “2007-07-01” or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago,
        3 days ago, last week.
      name: last_modified_by_user_after
    - description: Used to filter the XML output to show only vulnerabilities last
        modified by a user before a certain date and time. use YYYY-MM-DD[THH:MM:SSZ]
        like “2007-07-01” or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago,
        3 days ago, last week.
      name: last_modified_by_user_before
    - description: Used to filter the XML output to show only vulnerabilities last
        modified by the service after a certain date and time. use YYYY-MM-DD[THH:MM:SSZ]
        like “2007-07-01” or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago,
        3 days ago, last week.
      name: last_modified_by_service_after
    - description: Used to filter the XML output to show only vulnerabilities last
        modified by the service before a certain date and time. use YYYY-MM-DD[THH:MM:SSZ]
        like “2007-07-01” or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago,
        3 days ago, last week.
      name: last_modified_by_service_before
    - description: Used to filter the XML output to show only vulnerabilities published
        after a certain date and time. use YYYY-MM-DD[THH:MM:SSZ] like “2007-07-01”
        or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago, 3 days ago, last
        week.
      name: published_after
    - description: Used to filter the XML output to show only vulnerabilities published
        before a certain date and time. use YYYY-MM-DD[THH:MM:SSZ] like “2007-07-01”
        or “2007-01-25T23:12:00Z” or today, yesterday, 24hr ago, 3 days ago, last
        week.
      name: published_before
    - auto: PREDEFINED
      description: ' (Optional) Used to filter the XML output to show only vulnerabilities
        assigned a certain discovery method. A valid value is: Remote, Authenticated,
        RemoteOnly, AuthenticatedOnly, or RemoteAndAuthenticated.'
      name: discovery_method
      predefined:
      - Remote
      - Authenticated
      - RemoteOnly
      - AuthenticatedOnly
      - RemoteAndAuthenticated
    - description: 'Used to filter the XML output to show only vulnerabilities having
        one or more authentication types. A valid value is: Windows, Oracle, Unix
        or SNMP. Multiple values are entered as a comma-separated list.'
      name: discovery_auth_types
    - auto: PREDEFINED
      description: Used to filter the XML output to show reasons for passing or failing
        PCI compliance (when the CVSS Scoring feature is turned on in the user’s subscription).
        Specify 1 to view the reasons in the XML output. When unspecified, the reasons
        are not included in the XML output.
      name: show_pci_reasons
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: Used to filter the XML output to show Qualys modules that can be
        used to detect each vulnerability. Specify 1 to view supported modules in
        the XML output. When unspecified, supported modules are not included in the
        XML output.
      name: show_supported_modules_info
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: Specify 1 to include the disabled flag for each vulnerability in
        the XML output.
      name: show_disabled_flag
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: Specify 1 to include QID changes for each vulnerability in the
        XML output.
      name: show_qid_change_log
      predefined:
      - "0"
      - "1"
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: download a list of vulnerabilities from Qualys’ KnowledgeBase.
    name: qualys-vulnerability-list
    outputs:
    - contextPath: Qualys.Vulnerability.List.QID
      description: Vulnerability QID.
    - contextPath: Qualys.Vulnerability.List.PATCHABLE
      description: Is Vulnerability patchable.
    - contextPath: Qualys.Vulnerability.List.SEVERITY_LEVEL
      description: Severity level of the Vulnerability.
    - contextPath: Qualys.Vulnerability.List.CONSEQUENCE
      description: Consequence of the Vulnerability.
    - contextPath: Qualys.Vulnerability.List.VENDOR_REFERENCE_LIST.VENDOR_REFERENCE.ID
      description: ID of the vendor.
    - contextPath: Qualys.Vulnerability.List.VENDOR_REFERENCE_LIST.VENDOR_REFERENCE.URL
      description: URL of the vendor.
    - contextPath: Qualys.Vulnerability.List.LAST_SERVICE_MODIFICATION_DATETIME
      description: Date of the last service modification.
    - contextPath: Qualys.Vulnerability.List.CVE_LIST.CVE.ID
      description: CVE ID.
    - contextPath: Qualys.Vulnerability.List.CVE_LIST.CVE.URL
      description: CVE URL.
    - contextPath: Qualys.Vulnerability.List.PUBLISHED_DATETIME
      description: Published date.
    - contextPath: Qualys.Vulnerability.List.DISCOVERY.ADDITIONAL_INFO
      description: Additional info.
    - contextPath: Qualys.Vulnerability.List.DISCOVERY.AUTH_TYPE_LIST.AUTH_TYPE
      description: Discovery Authentication type.
    - contextPath: Qualys.Vulnerability.List.DISCOVERY.REMOTE
      description: Is discovery remote.
    - contextPath: Qualys.Vulnerability.List.DIAGNOSIS
      description: Diagnosis of vulnerability.
    - contextPath: Qualys.Vulnerability.List.PCI_FLAG
      description: PCI flag.
    - contextPath: Qualys.Vulnerability.List.SOFTWARE_LIST.SOFTWARE.PRODUCT
      description: Product name.
    - contextPath: Qualys.Vulnerability.List.SOFTWARE_LIST.SOFTWARE.VENDOR
      description: Vendor of the product.
    - contextPath: Qualys.Vulnerability.List.VULN_TYPE
      description: Type of the vulnerability.
    - contextPath: Qualys.Vulnerability.List.TITLE
      description: Title of the vulnerability.
    - contextPath: Qualys.Vulnerability.List.SOLUTION
      description: Solution for the vulnerability.
    - contextPath: Qualys.Vulnerability.List.CATEGORY
      description: Category of the vulnerability.
  - arguments:
    - description: Show only asset groups with certain IDs. Multiple IDs are comma
        separated.
      name: ids
    - description: Show only asset groups with certain IDs. Multiple IDs are comma
        separated.
      name: id_min
    - description: Show only asset groups that have an ID less than or equal to the
        specified ID.
      name: id_max
    - description: Specify the maximum number of asset group records to output. By
        default this is set to 1000 records. If you specify truncation_limit=0, the
        output is not paginated and all records are returned in a single output.
      name: truncation_limit
    - description: Optional and valid only when the Networks feature is enabled in
        your account) Restrict the request to certain network IDs. Multiple IDs are
        comma separated.
      name: network_ids
    - description: Show only asset groups that have a business unit ID equal to the
        specified ID.
      name: unit_id
    - description: Show only asset groups that have a user ID equal to the specified
        ID.
      name: user_id
    - description: ' Show only the asset group that has a title equal to the specified
        string - this must be an exact match.'
      name: title
    - description: 'Show attributes for each asset group along with the ID. Your options
        are: None, All or a comma-separated list of attribute names: ID, TITLE, OWNER_USER_NAME,
        OWNER_USER_ID, OWNER_UNIT_ID, NETWORK_IDS, LAST_UPDATE, IP_SET, APPLIANCE_LIST,
        DOMAIN_LIST, DNS_LIST, NETBIOS_LIST, EC2_ID_LIST, HOST_IDS, ASSIGNED_USER_IDS,
        ASSIGNED_UNIT_IDS, BUSINESS_IMPACT, CVSS, COMMENTS.'
      name: show_attributes
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: Get account asset groups.
    name: qualys-group-list
    outputs:
    - contextPath: Qualys.AssetGroup.ID
      description: Asset Group ID.
    - contextPath: Qualys.AssetGroup.TITLE
      description: Asset Group title.
    - contextPath: Qualys.AssetGroup.OWNER_ID
      description: Asset Group owner ID.
    - contextPath: Qualys.AssetGroup.UNIT_ID
      description: Asset Group unit ID.
    - contextPath: Qualys.AssetGroup.NETWORK_ID
      description: Asset Group network ID.
    - contextPath: Qualys.AssetGroup.IP_SET.IP
      description: IP in the asset group.
    - contextPath: Qualys.AssetGroup.IP_SET.IP_RANGE
      description: Asset Group IP range.
    - contextPath: Qualys.AssetGroup.APPLIANCE_IDS
      description: Appliance IDs of the asset group.
    - contextPath: Qualys.AssetGroup.DEFAULT_APPLIANCE_ID
      description: Default appliance IDs of the asset group.
  - arguments:
    - description: Report ID of a saved report that you want to download.
      name: id
      required: true
    - auto: PREDEFINED
      description: Type of the file of the report. Can be checked by calling the qualys-report-list
        command.
      name: file_format
      predefined:
      - pdf
      - html
      - mht
      - xml
      - csv
      - docx
      - online
      required: true
    description: Download report.
    name: qualys-report-fetch
    outputs:
    - contextPath: InfoFile.Name
      description: The file name.
    - contextPath: InfoFile.EntryID
      description: The ID for locating the file in the War Room.
    - contextPath: InfoFile.Size
      description: The size of the file (in bytes).
    - contextPath: InfoFile.Type
      description: The file type, as determined by libmagic (same as displayed in
        file entries).
    - contextPath: InfoFile.Extension
      description: The file extension.
    - contextPath: InfoFile.Info
      description: Basic information about the file.
  - arguments:
    - description: 'The scan reference for a vulnerability scan. This will have the
        format: scan/nnnnnnnnnn.nnnnn'
      name: scan_ref
      required: true
    - description: 'Show only certain IP addresses/ranges in the scan results. One
        or more IPs/ranges may be specified. A range entry is specified using a hyphen
        (for example, 10.10.10.1-10.10.10.20). Multiple entries are comma separated.    '
      name: ips
    - auto: PREDEFINED
      description: 'The verbosity of the scan results details. One verbosity mode
        may be specified: brief (the default) or extended. The brief output includes
        this information: IP address, DNS hostname, NetBIOS hostname, QID and scan
        test results if applicable. The extended output includes the brief output
        plus this extended information: protocol, port, an SSL flag (“yes” is returned
        when SSL was used for the detection, “no” is returned when SSL was not used),
        and FQDN if applicable.'
      name: mode
      predefined:
      - brief
      - extended
    - description: Id assigned to the client (Consultant type subscription only).
        Parameter client_id or client_name may be specified for the same request.
      name: client_id
    - description: Name of the client (Consultant type subscription only). Parameter
        client_id or client_name may be specified for the same request.
      name: client_name
    description: Download scan results when scan has status Finished, Canceled, Paused
      or Error.
    name: qualys-vm-scan-fetch
    outputs:
    - contextPath: Qualys.VM.Dns
      description: Scanned device DNS.
    - contextPath: Qualys.VM.Instance
      description: Scanned device instance.
    - contextPath: Qualys.VM.IP
      description: Scanned device IP address.
    - contextPath: Qualys.VM.Netbios
      description: Scanned device Netbios.
    - contextPath: Qualys.VM.QID
      description: Qualys ID for vulnerabilities.
    - contextPath: Qualys.VM.Result
      description: Scan result.
  - arguments:
    - description: 'The scan reference for a compliance scan. This will have the format:
        compliance/nnnnnnnnnn.nnnnn'
      name: scan_ref
      required: true
    description: fetch scan results for a scan.
    name: qualys-pc-scan-fetch
    outputs:
    - contextPath: Qualys.PC.USERNAME
      description: The user who executed the scan.
    - contextPath: Qualys.PC.COMPANY
      description: The company of the user who executed the scan.
    - contextPath: Qualys.PC.USERNAME
      description: The user who executed the scan.
    - contextPath: Qualys.PC.DATE
      description: The date of the scan.
    - contextPath: Qualys.PC.TITLE
      description: The scan title.
    - contextPath: Qualys.PC.TARGET
      description: IP’s which were scanned.
    - contextPath: Qualys.PC.EXCLUDED_TARGET
      description: IP’s which were excluded from the scan.
    - contextPath: Qualys.PC.DURATION
      description: The duration of the scan.
    - contextPath: Qualys.PC.NBHOST_ALIVE
      description: Number of hosts that are available during the scan.
    - contextPath: Qualys.PC.NBHOST_TOTAL
      description: Total number of hosts that were submitted to scan.
    - contextPath: Qualys.PC.REPORT_TYPE
      description: Type of the report.
    - contextPath: Qualys.PC.OPTIONS
      description: Scan option profile.
    - contextPath: Qualys.PC.STATUS
      description: Status of the scan.
  - arguments:
    - description: Report ID.
      name: id
      required: true
    description: Cancel the running report.
    execution: true
    name: qualys-report-cancel
    outputs:
    - contextPath: Qualys.Report.ID
      description: ID of the canceled report.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for report cancellation.
      type: String
  - arguments:
    - description: (Required) The report ID you want to take action on.
      name: id
      required: true
    description: Delete a saved report in the user’s Report Share.
    execution: true
    name: qualys-report-delete
    outputs:
    - contextPath: Qualys.Report.ID
      description: Deleted report ID.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for the report deletion.
      type: String
  - arguments:
    - description: Scorecard name for the vulnerability scorecard report.
      name: name
      required: true
    - description: User-defined report title.
      name: report_title
    - auto: PREDEFINED
      defaultValue: xml
      description: Output format of the report. One output format may be specified.
      name: output_format
      predefined:
      - pdf
      - html
      - mht
      - xml
      - csv
      required: true
    - description: The source asset groups for the report.
      name: source
      required: true
    - auto: PREDEFINED
      description: (Valid for CSV format report only). Specify hide_header=1 to omit
        the header information from the report.
      name: hide_header
      predefined:
      - "1"
      - "0"
    - description: The password to be used for encryption.
      name: pdf_password
    - description: The report recipients in the form of one or more distribution groups.
      name: recipient_group
    - description: Specify users who will receive the email notification when the
        report is complete.
      name: recipient_group_id
    - description: The titles of asset groups to be used as source asset groups for
        the scorecard report.
      name: asset_groups
    - auto: PREDEFINED
      description: et to 1 to select all asset groups available in your account as
        the source asset groups for the scorecard report.
      name: all_asset_groups
      predefined:
      - "1"
    - description: The title of a business unit containing the source asset groups.
      name: business_unit
    - description: A business info tag identifying a division that asset group(s)
        belong to.
      name: division
    - description: A business info tag identifying a business function for asset group(s).
      name: function
    - description: A business info tag identifying a location where asset group(s)
        are located.
      name: location
    - description: Up to 10 QIDs for vulnerabilities or potential vulnerabilities
        with available patches. Multiple QIDs are comma separated.
      name: patch_qids
    - description: One or two QIDs for missing software. Two QIDs are comma separated.
      name: missing_qids
    description: Launch a vulnerability scorecard report.
    execution: true
    name: qualys-scorecard-launch
    outputs:
    - contextPath: Qualys.Report.ID
      description: Report ID.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for the scorecard launch.
      type: String
  - arguments:
    - description: The scan title. This can be a maximum of 2000 characters (ascii).
      name: scan_title
    - auto: PREDEFINED
      defaultValue: assets
      description: Specify “assets” (the default) when your scan target will include
        IP addresses/ranges and/or asset groups. Specify “tags” when your scan target
        will include asset tags.
      name: target_from
      predefined:
      - assets
      - tags
    - description: 'The IP addresses to be scanned. You may enter individual IP addresses
        and/or ranges. Multiple entries are comma separated. One of these parameters
        is required: ip, asset_groups or asset_group_ids.'
      name: ip
    - description: 'The titles of asset groups containing the hosts to be scanned.
        Multiple titles are comma separated. One of these parameters is required:
        ip, asset_groups or asset_group_ids.'
      name: asset_groups
    - description: 'The IDs of asset groups containing the hosts to be scanned. Multiple
        IDs are comma separated. One of these parameters is required: ip, asset_groups
        or asset_group_ids.'
      name: asset_group_ids
    - description: The IP addresses to be excluded from the scan when the scan target
        is specified as IP addresses (not asset tags). You may enter individual IP
        addresses and/or ranges. Multiple entries are comma separated.
      name: exclude_ip_per_scan
    - auto: PREDEFINED
      description: ' Select “any” (the default) to include hosts that match at least
        one of the selected tags. Select “all” to include hosts that match all of
        the selected tags.'
      name: tag_include_selector
      predefined:
      - all
      - any
    - auto: PREDEFINED
      description: Select “any” (the default) to exclude hosts that match at least
        one of the selected tags. Select “all” to exclude hosts that match all of
        the selected tags.
      name: tag_exclude_selector
      predefined:
      - all
      - any
    - auto: PREDEFINED
      description: Specify “id” (the default) to select a tag set by providing tag
        IDs. Specify “name” to select a tag set by providing tag names.
      name: tag_set_by
      predefined:
      - id
      - name
    - description: Specify a tag set to include. Hosts that match these tags will
        be included. You identify the tag set by providing tag names or IDs. Multiple
        entries are comma separated.
      name: tag_set_include
    - description: Specify a tag set to exclude. Hosts that match these tags will
        be excluded. You identify the tag set by providing tag names or IDs. Multiple
        entries are comma separated.
      name: tag_set_exclude
    - auto: PREDEFINED
      description: Specify “0” (the default) to select from all tags (tags with any
        tag rule). Specify “1” to scan all IP addresses defined in the tag selection.
        When this is specified, only tags with the dynamic IP address rule called
        “IP address in Network Range(s)” can be selected. valid only when target_from=tags
        is specified.
      name: use_ip_nt_range_tags_include
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: Specify “0” (the default) to select from all tags (tags with any
        tag rule). Specify “1” to exclude all IP addresses defined in the tag selection.
        When this is specified, only tags with the dynamic IP address rule called
        “IP address in Network Range(s)” can be selected.  valid only when target_from=tags
        is specified.
      name: use_ip_nt_range_tags_exclude
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: Specify “0” (the default) to select from all tags (tags with any
        tag rule). Specify “1” to scan all IP addresses defined in tags. When this
        is specified, only tags with the dynamic IP address rule called “IP address
        in Network Range(s)” can be selected.
      name: use_ip_nt_range_tags
      predefined:
      - "0"
      - "1"
    - description: 'The IDs of the scanner appliances to be used. Multiple entries
        are comma separated. For an Express Lite user, Internal Scanning must be enabled
        in the user''s account. One of these parameters must also be specified in
        a request: iscanner_name, iscanner_id, default_scanner, scanners_in_ag, scanners_in_tagset.
        When none of these are specified, External scanners are used. These parameters
        are mutually exclusive and cannot be specified in the same request: iscanner_id
        and iscanner_name.'
      name: iscanner_id
    - description: Specifies the name of the Scanner Appliance for the map, when the
        map target has private use internal IPs. Using Express Lite, Internal Scanning
        must be enabled in your account.
      name: iscanner_name
    - auto: PREDEFINED
      description: Specify 1 to use the default scanner in each target asset group.
        For an Express Lite user, Internal Scanning must be enabled in the user’s
        account.
      name: default_scanner
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: Specify 1 to distribute the scan to the target asset groups’ scanner
        appliances. Appliances in each asset group are tasked with scanning the IPs
        in the group. By default up to 5 appliances per group will be used and this
        can be configured for your account (please contact your Account Manager or
        Support). For an Express Lite user, Internal Scanning must be enabled in the
        user’s account.
      name: scanners_in_ag
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: 'Specify 1 to distribute the scan to scanner appliances that match
        the asset tags specified for the scan target. One of these parameters must
        be specified in a request for an internal scan: iscanner_name, iscanner_id,
        default_scanner, scanners_in_ag, scanners_in_tagset. When none of these are
        specified, external scanners are used. Only valid when the target_from=tags
        is specified.'
      name: scanners_in_tagset
      predefined:
      - "0"
      - "1"
    - description: Specify 1 to distribute the scan to all scanner appliances in the
        network.
      name: scanners_in_network
    - description: 'The title of the compliance option profile to be used. One of
        these parameters must be specified in a request: option_title or option_id.
        These are mutually exclusive and cannot be specified in the same request.'
      name: option_title
    - description: 'The ID of the compliance option profile to be used. One of these
        parameters must be specified in a request: option_title or option_id. These
        are mutually exclusive and cannot be specified in the same request.'
      name: option_id
    - auto: PREDEFINED
      description: Specify a value of 0 - 9 to set a processing priority level for
        the scan. When not specified, a value of 0 (no priority) is used. 0 = No Priority
        (the default), 1 = Emergency, 2 = Ultimate, 3 = Critical, 4 = Major, 5 = High,
        6 = Standard, 7 = Medium, 8 = Minor, 9 = Low.
      name: priority
      predefined:
      - "0"
      - "1"
      - "2"
      - "3"
      - "4"
      - "5"
      - "6"
      - "7"
      - "8"
      - "9"
    - description: (Required for EC2 scan) The name of the EC2 connector for the AWS
        integration you want to run the scan on.
      name: connector_name
    - description: (Required for EC2 scan) The EC2 region code or the ID of the Virtual
        Private Cloud (VPC) zone.
      name: ec2_endpoint
    - description: The ID of the EC2 instance on which you want to launch the VM or
        compliance scan. Multiple ec2 instance ids are comma separated. You can add
        up to maximum 10 instance Ids.
      name: ec2_instance_ids
    - description: The ID of a network used to filter the IPs/ranges specified in
        the“ip” parameter. Set to a custom network ID (note this does not filter IPs/ranges
        specified in “asset_groups” or “asset_group_ids”). Or set to “0” (the default)
        for the Global Default Network - this is used to scan hosts outside of your
        custom networks.
      name: ip_network_id
    - description: Set a custom value in order to drop defenses (such as logging,
        IPs, etc) when an authorized scan is being run. The value you enter will be
        used in the “Qualys-Scan:” header that will be set for many CGI and web application
        fingerprinting checks. Some discovery and web server fingerprinting checks
        will not use this header.
      name: runtime_http_header
    - auto: PREDEFINED
      description: Launch a CertView type scan. This option will be supported when
        CertView GA is released and enabled for your account.
      name: scan_type
      predefined:
      - certview
    - description: The target FQDN for a vulnerability scan. You must specify at least
        one target i.e. IPs, asset groups or FQDNs. Multiple values are comma separated.
      name: fqdn
    - description: Id assigned to the client (Consultant type subscription only).
        Parameter client_id or client_name may be specified for the same request.
      name: client_id
    - description: Name of the client (Consultant type subscriptions  only). Parameter
        client_id or client_name may be specified for the same request.
      name: client_name
    - auto: PREDEFINED
      description: Specify 1 when your scan target includes agent hosts. This lets
        you scan private IPs where agents are installed when these IPs are not in
        your VM/PC license.
      name: include_agent_targets
      predefined:
      - "0"
      - "1"
    description: ' launch vulnerability scans in the user’s account.'
    name: qualys-vm-scan-launch
    outputs:
    - contextPath: Qualys.Report.VM.Launched.KEY
      description: Key name of launched VM scan, either ID or a REFERENCE.
    - contextPath: Qualys.Report.VM.Launched.VALUE
      description: Value of the key.
  - arguments:
    - auto: PREDEFINED
      description: One action required for the request.
      name: action
      predefined:
      - cancel
      - pause
      - resume
      - delete
      required: true
    - description: 'The scan reference for a vulnerability scan. This will have the
        format: scan/nnnnnnnnnn.nnnnn'
      name: scan_ref
      required: true
    description: allows users to take actions on vulnerability scans in their account,
      like cancel, pause, resume, delete and fetch completed scan results.
    execution: true
    name: qualys-vm-scan-action
  - arguments:
    - auto: PREDEFINED
      description: One action required for the request.
      name: action
      predefined:
      - cancel
      - pause
      - resume
      - delete
      required: true
    - description: ' The scan reference for a compliance scan. This will have the
        format: compliance/nnnnnnnnnn.nnnnn'
      name: scan_ref
      required: true
    description: Allows users to take actions on compliance scans in their account,
      like cancel, pause, resume, delete and fetch completed scan results.
    name: qualys-pc-scan-manage
    outputs:
    - contextPath: Qualys.Scan.KEY
      description: Key name, either ID or REFERENCE.
    - contextPath: Qualys.Scan.VALUE
      description: Value of either ID or REFERENCE.
  - arguments:
    - description: The scan title. This can be a maximum of 2000 characters (ascii).
      name: scan_title
    - description: ' The ID of the compliance option profile to be used. One of these
        parameters must be specified in a request: option_title or option_id. These
        are mutually exclusive and cannot be specified in the same request.'
      name: option_id
    - description: 'The title of the compliance option profile to be used. One of
        these parameters must be specified in a request: option_title or option_id.
        These are mutually exclusive and cannot be specified in the same request.'
      name: option_title
    - description: ' The IP addresses to be scanned. You may enter individual IP addresses
        and/or ranges. Multiple entries are comma separated. One of these parameters
        is required: ip, asset_groups or asset_group_ids.'
      name: ip
    - description: 'The IDs of asset groups containing the hosts to be scanned. Multiple
        IDs are comma separated. One of these parameters is required: ip, asset_groups
        or asset_group_ids.'
      name: asset_group_ids
    - description: 'The titles of asset groups containing the hosts to be scanned.
        Multiple titles are comma separated. One of these parameters is required:
        ip, asset_groups or asset_group_ids.'
      name: asset_groups
    - description: The IP addresses to be excluded from the scan when the scan target
        is specified as IP addresses (not asset tags). You may enter individual IP
        addresses and/or ranges. Multiple entries are comma separated.
      name: exclude_ip_per_scan
    - auto: PREDEFINED
      description: Specify 1 to use the default scanner in each target asset group.
        For an Express Lite user, Internal Scanning must be enabled in the user’s
        account.
      name: default_scanner
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: Specify 1 to distribute the scan to the target asset groups’ scanner
        appliances. Appliances in each asset group are tasked with scanning the IPs
        in the group. By default up to 5 appliances per group will be used and this
        can be configured for your account (please contact your Account Manager or
        Support). For an Express Lite user, Internal Scanning must be enabled in the
        user’s account.
      name: scanners_in_ag
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      defaultValue: assets
      description: Specify “assets” (the default) when your scan target will include
        IP addresses/ranges and/or asset groups. Specify “tags” when your scan target
        will include asset tags.
      name: target_from
      predefined:
      - assets
      - tags
    - auto: PREDEFINED
      description: ' Select “any” (the default) to include hosts that match at least
        one of the selected tags. Select “all” to include hosts that match all of
        the selected tags.'
      name: tag_include_selector
      predefined:
      - all
      - any
    - auto: PREDEFINED
      description: Select “any” (the default) to exclude hosts that match at least
        one of the selected tags. Select “all” to exclude hosts that match all of
        the selected tags.
      name: tag_exclude_selector
      predefined:
      - all
      - any
    - auto: PREDEFINED
      description: Specify “id” (the default) to select a tag set by providing tag
        IDs. Specify “name” to select a tag set by providing tag names.
      name: tag_set_by
      predefined:
      - id
      - name
    - description: Specify a tag set to include. Hosts that match these tags will
        be included. You identify the tag set by providing tag names or IDs. Multiple
        entries are comma separated.
      name: tag_set_include
    - description: Specify a tag set to exclude. Hosts that match these tags will
        be excluded. You identify the tag set by providing tag names or IDs. Multiple
        entries are comma separated.
      name: tag_set_exclude
    - auto: PREDEFINED
      description: Specify “0” (the default) to select from all tags (tags with any
        tag rule). Specify “1” to scan all IP addresses defined in tags. When this
        is specified, only tags with the dynamic IP address rule called “IP address
        in Network Range(s)” can be selected.
      name: use_ip_nt_range_tags
      predefined:
      - "0"
      - "1"
    - description: The ID of a network used to filter the IPs/ranges specified in
        the“ip” parameter. Set to a custom network ID (note this does not filter IPs/ranges
        specified in “asset_groups” or “asset_group_ids”). Or set to “0” (the default)
        for the Global Default Network - this is used to scan hosts outside of your
        custom networks.
      name: ip_network_id
    - description: Set a custom value in order to drop defenses (such as logging,
        IPs, etc) when an authorized scan is being run. The value you enter will be
        used in the “Qualys-Scan:” header that will be set for many CGI and web application
        fingerprinting checks. Some discovery and web server fingerprinting checks
        will not use this header.
      name: runtime_http_header
    - description: Specifies the name of the Scanner Appliance for the map, when the
        map target has private use internal IPs. Using Express Lite, Internal Scanning
        must be enabled in your account.
      name: iscanner_name
    description: launch compliance scans.
    execution: true
    name: qualys-pc-scan-launch
    outputs:
    - contextPath: Qualys.Scan.KEY
      description: Scan key, either ID or Reference.
    - contextPath: Qualys.Scan.VALUE
      description: Scan value, either value of ID or Reference.
  - arguments:
    - description: 'The hosts you want to add to the subscription. '
      name: ips
      required: true
    - auto: PREDEFINED
      description: The tracking method is set to IP for IP address by default. To
        use another tracking method specify DNS or NETBIOS.
      name: tracking_method
      predefined:
      - IP
      - DNS
      - NETBIOS
    - auto: PREDEFINED
      defaultValue: "0"
      description: You must enable the hosts for the VM application (enable_vm=1)
        or the PC application (enable_pc=1) or both VM and PC.
      name: enable_vm
      predefined:
      - "0"
      - "1"
      required: true
    - auto: PREDEFINED
      defaultValue: "0"
      description: You must enable the hosts for the VM application (enable_vm=1)
        or the PC application (enable_pc=1) or both VM and PC.
      name: enable_pc
      predefined:
      - "0"
      - "1"
      required: true
    - description: The owner of the host asset(s). The owner must be a Manager or
        a Unit Manager.
      name: owner
    - description: Values for user-defined fields 1, 2 and 3. You can specify a maximum
        of 128 characters.
      name: ud1
    - description: Values for user-defined fields 1, 2 and 3. You can specify a maximum
        of 128 characters.
      name: ud2
    - description: Values for user-defined fields 1, 2 and 3. You can specify a maximum
        of 128 characters.
      name: ud3
    - description: User-defined comments.
      name: comment
    - description: (Required if the request is being made by a Unit Manager; otherwise
        invalid) The title of an asset group in the Unit Manager’s business unit that
        the host(s) will be added to.
      name: ag_title
    - auto: PREDEFINED
      description: Set to 1 to add IPs to your CertView license. By default IPs are
        not added to your CertView license. This option will be supported when CertView
        GA is released and is enabled for your account.
      name: enable_certview
      predefined:
      - "0"
      - "1"
    description: Add IP addresses to the subscription.
    execution: true
    name: qualys-ip-add
    outputs:
    - contextPath: Qualys.IP.Add.TEXT
      description: Action result message.
      type: String
    - contextPath: Qualys.IP.Add.DATETIME
      description: Date & time of the action.
      type: Date
  - arguments:
    - description: ' The hosts within the subscription that you want to update.'
      name: ips
      required: true
    - description: (valid only when the Network Support feature is enabled for the
        user's account) Restrict the request to a certain custom network by specifying
        the network ID. When unspecified, we default to "0" for Global Default Network.
      name: network_id
    - description: (Optional) The DNS hostname for the IP you want to update. A single
        IP must be specified in the same request and the IP will only be updated if
        it matches the hostname specified.
      name: host_dns
    - description: (Optional) The NetBIOS hostname for the IP you want to update.
        A single IP must be specified in the same request and the IP will only be
        updated if it matches the hostname specified.
      name: host_netbios
    - auto: PREDEFINED
      description: The tracking method is set to IP for IP address by default. To
        use another tracking method specify DNS or NETBIOS.
      name: tracking_method
      predefined:
      - IP
      - DNS
      - NETBIOS
    - description: The owner of the host asset(s). The owner must be a Manager or
        a Unit Manager.
      name: owner
    - description: Values for user-defined fields 1, 2 and 3. You can specify a maximum
        of 128 characters.
      name: ud1
    - description: Values for user-defined fields 1, 2 and 3. You can specify a maximum
        of 128 characters.
      name: ud2
    - description: Values for user-defined fields 1, 2 and 3. You can specify a maximum
        of 128 characters.
      name: ud3
    - description: User-defined comments.
      name: comment
    description: gives you the ability to update IP addresses within the subscription.
    execution: true
    name: qualys-ip-update
    outputs:
    - contextPath: Qualys.IP.Update.TEXT
      description: Action result message.
    - contextPath: Qualys.IP.Update.DATETIME
      description: Date & time of the action.
  - arguments:
    - auto: PREDEFINED
      description: Select add/remove/remove_all ips.
      name: action
      predefined:
      - add
      - remove
      - remove_all
      required: true
    - description: User-defined notes (up to 1024 characters).
      name: comment
      required: true
    - description: 'The IP addresses to be added to the excluded IPs list. Enter a
        comma-separated list of IPv4 singletons or ranges. For example: 10.10.10.13,10.10.10.25-10.10.10.29.'
      name: ips
    - description: (Optional when action=add) The number of days the IPs being added
        to the excluded IPs list will be considered valid for exclusion. When the
        expiration is reached, the IPs are removed from the list and made available
        again for scanning. When unspecified, the IPs being added have no expiration
        and will remain on the list until removed by a user.
      name: expiry_days
    - description: (Optional when action=add) Specify users who will be notified 7
        days before hosts are removed from the excluded hosts list (i.e. supply distribution
        group names as defined in the Qualys UI).
      name: dg_names
    - description: Assign a network ID to the IPs being added to the excluded IPs
        list. By default, the user’s default network ID is assigned.
      name: network_id
    description: Manage your excluded IPs list using the Excluded IP. The IPs in your
      excluded IPs list will not be scanned.
    execution: true
    name: qualys-host-excluded-manage
    outputs:
    - contextPath: Qualys.Endpoint.KEY
      description: Result of action requested.
    - contextPath: Qualys.Endpoint
      description: IPs action was made on.
  - arguments:
    - description: Scheduled report ID. Can be found by running the command qualys-scheduled-report-list.
      name: id
      required: true
    description: Launch a scheduled report now.
    execution: true
    name: qualys-scheduled-report-launch
    outputs:
    - contextPath: Qualys.Report.ID
      description: Launched report ID.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for the scheduled report launch.
      type: String
  - arguments:
    - description: The template ID of the report you want to launch. Can be found
        by running the command qualys-report-template-list.
      name: template_id
      required: true
    - description: Specifies the map references (1 or 2) to include. A map reference
        starts with the string "map/" followed by a reference ID number. When two
        map references are given, the report compares map results. Two map references
        are comma separated.
      name: report_refs
      required: true
    - auto: PREDEFINED
      description: One output format may be specified.
      name: output_format
      predefined:
      - pdf
      - html
      - mht
      - xml
      - csv
      required: true
    - description: Specifies the target domain for the map report. Include the domain
        name only; do not enter "www." at the start of the domain name. When the special
        “none” domain is specified as a parameter value, the ip_restriction parameter
        is required.
      name: domain
      required: true
    - description: A user-defined report title. The title may have a maximum of 128
        characters. For a PCI compliance report, the report title is provided by Qualys
        and cannot be changed.
      name: report_title
    - auto: PREDEFINED
      description: (Valid for CSV format report only). Specify hide_header=1 to omit
        the header information from the report. By default this information is included.
      name: hide_header
      predefined:
      - "0"
      - "1"
    - description: (Required for secure PDF distribution, Manager or Unit Manager
        only) Used for secure PDF report distribution when this feature is enabled
        in the user's account (under Reports > Setup > Report Share). The password
        to be used for encryption. - the password must have a minimum of 8 characters
        (ascii), and a maximum of 32 characters - the password must contain alpha
        and numeric characters - the password cannot match the password for the user’s
        Qualys account. - the password must follow the password security guidelines
        defined for your subscription (under Users > Setup > Security).
      name: pdf_password
    - description: Used for secure PDF distribution. The report recipients in the
        form of one or more distribution group names, as defined using the Qualys
        UI. Multiple distribution groups are comma separated. A maximum of 50 distribution
        groups may be entered.
      name: recipient_group
    - description: The report recipients in the form of one or more distribution group
        IDs. Multiple distribution group IDs are comma separated. Where do I find
        this ID? Log in to your Qualys account, go to Users > Distribution Groups
        and select Info for a group in the list.
      name: recipient_group_id
    - description: For a map report, specifies certain IPs/ranges to include in the
        report. Multiple IPs and/or ranges are comma separated.
      name: ip_restriction
    description: Launches a map report.
    execution: true
    name: qualys-report-launch-map
    outputs:
    - contextPath: Qualys.Report.ID
      description: Launched map report ID.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for the report launch map.
      type: String
  - arguments:
    - description: The template ID of the report you want to launch. Can be found
        by running the command qualys-report-template-list.
      name: template_id
      required: true
    - auto: PREDEFINED
      description: output format may be specified. When output_format=pdf is specified,
        the Secure PDF Distribution may be used.
      name: output_format
      predefined:
      - pdf
      - html
      - mht
      - xml
      - csv
      required: true
    - description: A user-defined report title. The title may have a maximum of 128
        characters. For a PCI compliance report, the report title is provided by Qualys
        and cannot be changed.
      name: report_title
    - description: (Valid for CSV format report only). Specify hide_header=1 to omit
        the header information from the report. By default this information is included.
      name: hide_header
    - description: Specify users who will receive the email notification when the
        report is complete (i.e. supply a distribution group ID). Where do I find
        this ID? Log in to your Qualys account, go to Users > Distribution Groups
        and select Info for a group in the list.
      name: recipient_group_id
    - description: '(Optional; Required for secure PDF distribution) The password
        to be used for encryption. Requirements: - the password must have a minimum
        of 8 characters (ascii), and a maximum of 32 characters - the password must
        contain alpha and numeric characters - the password cannot match the password
        for the user’s Qualys account. - the password must follow the password security
        guidelines defined for your subscription (log in and go to Subscription Setup—>Security
        Options).'
      name: pdf_password
    - description: Optional; Optional for secure PDF distribution) The report recipients
        in the form of one or more distribution groups, as defined using the Qualys
        UI. Multiple distribution groups are comma separated. A maximum of 50 distribution
        groups may be entered. Chapter 4 — Report API Launch Report  recipient_group={value}.
      name: recipient_group
    - description: Specify IPs/ranges to change (override) the report target, as defined
        in the scan report template. Multiple IPs/ranges are comma separated. When
        specified, hosts defined in the report template are not included in the report.
        See also “Using Asset Tags.”.
      name: ips
    - description: Specify asset group IDs to change (override) the report target,
        as defined in the scan report template. When specified, hosts defined in the
        report template are not included in the report. Looking for asset group IDs?
        Use the asset_group_list.php function (see the API v1 User Guide).
      name: asset_group_ids
    - description: Optional, and valid only when the Network Support feature is enabled
        for the user’s account) The ID of a network that is used to restrict the report’s
        target to the IPs/ranges specified in the“ips” parameter. Set to a custom
        network ID (note this does not filter IPs/ranges specified in “asset_group_ids”).
        Or set to “0” (the default) for the Global Default Network - this is used
        to report on hosts outside of your custom networks.
      name: ips_network_id
    description: Run host based findings report.
    execution: true
    name: qualys-report-launch-host-based-findings
    outputs:
    - contextPath: Qualys.Report.ID
      description: Report ID.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for the scan based findings.
      type: String
  - arguments:
    - description: The template ID of the report you want to launch. Can be found
        by running qualys-report-template-list.
      name: template_id
      required: true
    - auto: PREDEFINED
      description: One output format may be specified. When output_format=pdf is specified,
        the Secure PDF Distribution may be used.
      name: output_format
      predefined:
      - pdf
      - html
      - mht
      - xml
      - csv
      - docx
      required: true
    - description: (Required) This parameter specifies the scan references to include.
        A scan reference starts with the string "scan/" followed by a reference ID
        number. Multiple scan references are comma separated. Reference can be found
        by running the command qualys-vm-scan-list.
      name: report_refs
      required: true
    - description: A user-defined report title. The title may have a maximum of 128
        characters. For a PCI compliance report, the report title is provided by Qualys
        and cannot be changed.
      name: report_title
    - description: (Valid for CSV format report only). Specify hide_header=1 to omit
        the header information from the report. By default this information is included.
      name: hide_header
    - description: Specify users who will receive the email notification when the
        report is complete (i.e. supply a distribution group ID). Where do I find
        this ID? Log in to your Qualys account, go to Users > Distribution Groups
        and select Info for a group in the list.
      name: recipient_group_id
    - description: '(Optional; Required for secure PDF distribution) The password
        to be used for encryption. Requirements: - the password must have a minimum
        of 8 characters (ascii), and a maximum of 32 characters - the password must
        contain alpha and numeric characters - the password cannot match the password
        for the user’s Qualys account. - the password must follow the password security
        guidelines defined for your subscription (log in and go to Subscription Setup—>Security
        Options).'
      name: pdf_password
    - description: Optional; Optional for secure PDF distribution) The report recipients
        in the form of one or more distribution groups, as defined using the Qualys
        UI. Multiple distribution groups are comma separated. A maximum of 50 distribution
        groups may be entered. Chapter 4 — Report API Launch Report  recipient_group={value}.
      name: recipient_group
    - description: (Optional)  For a scan report, the report content will be restricted
        to the specified IPs/ranges. Multiple IPs and/or ranges are comma separated.
      name: ip_restriction
    description: launches a scan report including scan based findings.
    name: qualys-report-launch-scan-based-findings
    outputs:
    - contextPath: Qualys.Report.ID
      description: Report ID.
      type: String
  - arguments:
    - description: The template ID of the report you want to launch. Can be found
        by running the command qualys-report-template-list.
      name: template_id
      required: true
    - auto: PREDEFINED
      description: One output format may be specified. When output_format=pdf is specified,
        the Secure PDF Distribution may be used.
      name: output_format
      predefined:
      - pdf
      - online
      - xml
      - csv
      required: true
    - description: A user-defined report title. The title may have a maximum of 128
        characters. For a PCI compliance report, the report title is provided by Qualys
        and cannot be changed.
      name: report_title
    - description: (Valid for CSV format report only). Specify hide_header=1 to omit
        the header information from the report. By default this information is included.
      name: hide_header
    - description: Specify users who will receive the email notification when the
        report is complete (i.e. supply a distribution group ID). Where do I find
        this ID? Log in to your Qualys account, go to Users > Distribution Groups
        and select Info for a group in the list.
      name: recipient_group_id
    - description: '(Optional; Required for secure PDF distribution) The password
        to be used for encryption. Requirements: - the password must have a minimum
        of 8 characters (ascii), and a maximum of 32 characters - the password must
        contain alpha and numeric characters - the password cannot match the password
        for the user’s Qualys account. - the password must follow the password security
        guidelines defined for your subscription (log in and go to Subscription Setup—>Security
        Options).'
      name: pdf_password
    - description: Optional; Optional for secure PDF distribution) The report recipients
        in the form of one or more distribution groups, as defined using the Qualys
        UI. Multiple distribution groups are comma separated. A maximum of 50 distribution
        groups may be entered. Chapter 4 — Report API Launch Report  recipient_group={value}.
      name: recipient_group
    - description: Specify IPs/ranges to change (override) the report target, as defined
        in the patch report template. Multiple IPs/ranges are comma separated. When
        specified, hosts defined in the report template are not included in the report.
        See also “Using Asset Tags.”.
      name: ips
    - description: Specify IPs/ranges to change (override) the report target, as defined
        in the patch report template. Multiple asset group IDs are comma separated.
        When specified, hosts defined in the report template are not included in the
        report. Looking for asset group IDs? Use the asset_group_list.php function
        (see the API v1 User Guide).
      name: asset_group_ids
    description: Run patch report.
    execution: true
    name: qualys-report-launch-patch
    outputs:
    - contextPath: Qualys.Report.ID
      description: Report ID.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for the launch patch.
      type: String
  - arguments:
    - description: The template ID of the report you want to launch. Can be found
        by running qualys-report-template-list.
      name: template_id
      required: true
    - auto: PREDEFINED
      description: One output format may be specified. When output_format=pdf is specified,
        the Secure PDF Distribution may be used.
      name: output_format
      predefined:
      - pdf
      - html
      - mht
      - csv
      required: true
    - description: A user-defined report title. The title may have a maximum of 128
        characters. For a PCI compliance report, the report title is provided by Qualys
        and cannot be changed.
      name: report_title
    - description: (Valid for CSV format report only). Specify hide_header=1 to omit
        the header information from the report. By default this information is included.
      name: hide_header
    - description: Specify users who will receive the email notification when the
        report is complete (i.e. supply a distribution group ID). Where do I find
        this ID? Log in to your Qualys account, go to Users > Distribution Groups
        and select Info for a group in the list.
      name: recipient_group_id
    - description: '(Optional; Required for secure PDF distribution) The password
        to be used for encryption. Requirements: - the password must have a minimum
        of 8 characters (ascii), and a maximum of 32 characters - the password must
        contain alpha and numeric characters - the password cannot match the password
        for the user’s Qualys account. - the password must follow the password security
        guidelines defined for your subscription (log in and go to Subscription Setup—>Security
        Options).'
      name: pdf_password
    - description: Optional; Optional for secure PDF distribution) The report recipients
        in the form of one or more distribution groups, as defined using the Qualys
        UI. Multiple distribution groups are comma separated. A maximum of 50 distribution
        groups may be entered. Chapter 4 — Report API Launch Report  recipient_group={value}.
      name: recipient_group
    - description: (Optional for remediation report) Specify IPs/ranges you want to
        include in the report. Multiple IPs and/or ranges are comma separated.
      name: ips
    - description: Specify asset group IDs that identify hosts you want to include
        in the report. Multiple asset group IDs are comma separated. Looking for asset
        group IDs? Use the asset_group_list.php function (in the API v1 User Guide).
      name: asset_group_ids
    - auto: PREDEFINED
      description: ' Specifies whether the report will include tickets assigned to
        the current user, or all tickets in the user account. By default tickets assigned
        to the current user are included. Valid values are: User (default) or All.'
      name: assignee_type
      predefined:
      - User
      - All
    description: Run remediation report.
    execution: true
    name: qualys-report-launch-remediation
    outputs:
    - contextPath: Qualys.Report.ID
      description: Remediation report ID.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for the launch remediation.
      type: String
  - arguments:
    - description: The template ID of the report you want to launch. Can be found
        by running the command qualys-report-template-list.
      name: template_id
      required: true
    - description: A user-defined report title. The title may have a maximum of 128
        characters. For a PCI compliance report, the report title is provided by Qualys
        and cannot be changed.
      name: report_title
    - description: (Valid for CSV format report only). Specify hide_header=1 to omit
        the header information from the report. By default this information is included.
      name: hide_header
    - description: Specify users who will receive the email notification when the
        report is complete (i.e. supply a distribution group ID). Where do I find
        this ID? Log in to your Qualys account, go to Users > Distribution Groups
        and select Info for a group in the list.
      name: recipient_group_id
    - description: '(Optional; Required for secure PDF distribution) The password
        to be used for encryption. Requirements: - the password must have a minimum
        of 8 characters (ascii), and a maximum of 32 characters - the password must
        contain alpha and numeric characters - the password cannot match the password
        for the user’s Qualys account. - the password must follow the password security
        guidelines defined for your subscription (log in and go to Subscription Setup—>Security
        Options).'
      name: pdf_password
    - description: Optional; Optional for secure PDF distribution) The report recipients
        in the form of one or more distribution groups, as defined using the Qualys
        UI. Multiple distribution groups are comma separated. A maximum of 50 distribution
        groups may be entered. Chapter 4 — Report API Launch Report  recipient_group={value}.
      name: recipient_group
    - auto: PREDEFINED
      description: 'One output format may be specified. When output_format=pdf is
        specified, the Secure PDF Distribution may be used. '
      name: output_format
      predefined:
      - pdf
      - html
      - mht
      required: true
    - description: (Optional for compliance report) For a compliance report (except
        a PCI report), specify the IPs/ranges you want to include in the report. Multiple
        IPs and/or ranges are comma separated.
      name: ips
    - description: (Optional for compliance report) For a compliance report (except
        a PCI report), specify asset groups IDs which identify hosts to include in
        the report. Multiple asset group IDs are comma separated. Looking for asset
        group IDs? Use the asset_group_list.php function (in the API v1 User Guide).
      name: asset_group_ids
    - description: For a PCI compliance report, either the technical or executive
        report, this parameter specifies the scan reference to include. A scan reference
        starts with the string “scan/” followed by a reference ID number. The scan
        reference must be for a scan that was run using the PCI Options profile. Only
        one scan reference may be specified. Reference can be found by running the
        command qualys-pc-scan-list.
      name: report_refs
    description: Run compliance report.
    execution: true
    name: qualys-report-launch-compliance
    outputs:
    - contextPath: Qualys.Report.ID
      description: Compliance report ID.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for the launch compliance.
      type: String
  - arguments:
    - description: The template ID of the report you want to launch. Can be found
        by running the command qualys-report-template-list.
      name: template_id
      required: true
    - description: A user-defined report title. The title may have a maximum of 128
        characters. For a PCI compliance report, the report title is provided by Qualys
        and cannot be changed.
      name: report_title
    - description: (Valid for CSV format report only). Specify hide_header=1 to omit
        the header information from the report. By default this information is included.
      name: hide_header
    - description: Specify users who will receive the email notification when the
        report is complete (i.e. supply a distribution group ID). Where do I find
        this ID? Log in to your Qualys account, go to Users > Distribution Groups
        and select Info for a group in the list.
      name: recipient_group_id
    - description: '(Optional; Required for secure PDF distribution) The password
        to be used for encryption. Requirements: - the password must have a minimum
        of 8 characters (ascii), and a maximum of 32 characters - the password must
        contain alpha and numeric characters - the password cannot match the password
        for the user’s Qualys account. - the password must follow the password security
        guidelines defined for your subscription (log in and go to Subscription Setup—>Security
        Options).'
      name: pdf_password
    - description: Optional; Optional for secure PDF distribution) The report recipients
        in the form of one or more distribution groups, as defined using the Qualys
        UI. Multiple distribution groups are comma separated. A maximum of 50 distribution
        groups may be entered. Chapter 4 — Report API Launch Report  recipient_group={value}.
      name: recipient_group
    - auto: PREDEFINED
      description: 'One output format may be specified. When output_format=pdf is
        specified, the Secure PDF Distribution may be used. '
      name: output_format
      predefined:
      - pdf
      - html
      - mht
      - xml
      - csv
      required: true
    - description: Specifies the policy to run the report on. A valid policy ID must
        be entered.
      name: policy_id
      required: true
    - description: Specify asset group IDS if you want to include only certain asset
        groups in your report. These asset groups must be assigned to the policy you
        are reporting on. Multiple asset group IDs are comma separated. Looking for
        asset group IDs? Use the asset_group_list.php function (in the API v1 User
        Guide).
      name: asset_group_ids
    - description: Specify IPs/ranges if you want to include only certain IP addresses
        in your report. These IPs must be assigned to the policy you’re reporting
        on. Multiple entries are comma separated.
      name: ips
    - description: ' In the policy report output, show only results for a single host
        instance. Specify the ID for the host to include in the report. A valid host
        ID must be entered.'
      name: host_id
    - description: Specifies a single instance on the selected host. The instance
        string may be “os” or a string like “oracle10:1:1521:ora10204u”.
      name: instance_string
    description: Run compliance policy report.
    execution: true
    name: qualys-report-launch-compliance-policy
    outputs:
    - contextPath: Qualys.Report.ID
      description: Policy report ID.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for the launch compliance policy.
      type: String
  - arguments:
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: Get the list of restricted IPs within the user's subscription.
    execution: true
    name: qualys-ip-restricted-list
    outputs:
    - contextPath: Qualys.Restricted.Address
      description: List of the restricted IPs.
    - contextPath: Qualys.Restricted.Range
      description: List of the restricted IPs.
  - arguments:
    - auto: PREDEFINED
      description: activate - enable or disable the restricted IPs feature. clear
        - clear all restricted IPs and de-active this feature. add - add restricted
        IPs. delete - delete restricted IPs. replace - replace restricted IPs.
      name: action
      predefined:
      - activate
      - clear
      - add
      - delete
      - replace
      required: true
    - auto: PREDEFINED
      description: Enable or disable the restricted IPs list. set enable=1 to enable
        the list; set enable=0 to clear any IPs in the list and disable the feature.
      name: enable
      predefined:
      - "0"
      - "1"
    - description: The hosts you want to add to, remove from or replace in the restricted
        IPs list. How to specify IP addresses. One or more IPs/ranges may be specified.
        Multiple IPs/ranges are comma separated. An IP range is specified with a hyphen
        (for example, 10.10.30.1-10.10.30.50).
      name: ips
    description: Get the list of restricted IPs within the user's subscription.
    execution: true
    name: qualys-ip-restricted-manage
    outputs:
    - contextPath: Qualys.Restricted.Manage.TEXT
      description: Action result message.
    - contextPath: Qualys.Restricted.Manage.DATETIME
      description: Date & time of the action.
    - contextPath: Qualys.Restricted.Manage.ITEM_LIST.ITEM.VALUE
      description: Status of the restricted ips feature.
  - arguments:
    - description: A comma-separated list of host IDs/ranges. A host ID range is specified
        with a hyphen (for example, 190-400). Valid host IDs are required.
      isArray: true
      name: ids
    - description: A comma-separated list of host IP addresses/ranges. An IP address
        range is specified with a hyphen (for example, 10.10.30.1-10.10.30.50).
      isArray: true
      name: ips
    - description: A comma-separated list of valid detection record QIDs. A range
        is specified with a dash (for example, 68518-68522).
      isArray: true
      name: qids
    - description: A comma-separated list of severity levels. A range is specified
        with a dash (for example, 1-5 where 1 is low and 5 is high)..
      isArray: true
      name: severities
    - auto: PREDEFINED
      description: Specify 0 (the default) to select hosts based on IP addresses/ranges
        and/or asset groups. Specify 1 to select hosts based on asset tags.
      name: use_tags
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: (Optional when use_tags=1) Specify “id” (the default) to select
        a tag set by providing tag IDs. Specify “name” to select a tag set by providing
        tag names.
      name: tag_set_by
      predefined:
      - id
      - name
    - auto: PREDEFINED
      description: (Optional when use_tags=1) Specify “any” (the default) to include
        hosts that match at least one of the selected tags. Specify “all” to include
        hosts that match all of the selected tags.
      name: tag_include_selector
      predefined:
      - any
      - all
    - auto: PREDEFINED
      description: (Optional when use_tags=1) Specify “any” (the default) to exclude
        hosts that match at least one of the selected tags. Specify “all” to exclude
        hosts that match all of the selected tags.
      name: tag_exclude_selector
      predefined:
      - any
      - all
    - description: (Optional when use_tags=1) Specify a comma-separated list of tag
        names or IDs to include hosts that match these tags.
      isArray: true
      name: tag_set_include
    - description: (Optional when use_tags=1) Specify a comma-separated list of tag
        names or IDs for which to exclude hosts that match the tags.
      isArray: true
      name: tag_set_exclude
    - description: Specify the date before which to retrieve detections vulnerability
        scan results that were processed. Specify the date in YYYY-MMDD[THH:MM:SSZ]
        format (UTC/GMT), for example, “2016-09-12” or “2016-09-12T23:15:00Z”.
      name: detection_processed_before
    - description: Specify the date after which to retrieve detections vulnerability
        scan results that were processed. Specify the date in YYYY-MMDD[THH:MM:SSZ]
        format (UTC/GMT), for example, “2016-09-12” or “2016-09-12T23:15:00Z”.
      name: detection_processed_after
    - description: 'Show hosts that were last scanned for vulnerabilities since the
        specified date and time (optional). Hosts that were the target of a vulnerability
        scan since the date/time will be shown. Date/time is specified in the following
        format: YYYY-MM-DD[THH:MM:SSZ] (UTC/GMT). Permissions: An Auditor cannot specify
        this parameter.'
      name: vm_scan_since
    - description: 'Show hosts not scanned since the specified date and time (optional).
        The date/time is specified in the following format: YYYY-MMDD[THH:MM:SSZ]
        format (UTC/GMT), for example, “2007-07-01” or “2007-01-25T23:12:00Z”. Permissions
        - An Auditor cannot specify this parameter.'
      name: no_vm_scan_since
    - description: Specify the maximum number of host records processed per request.
        When not specified, the truncation limit is set to 1000 host records. You
        may specify a value less than the default (1-999) or greater than the default
        (1001-1000000).
      name: truncation_limit
    description: Get a list of hosts with the hosts latest vulnerability data. The
      list is based on the host based scan data available in the user’s account.
    execution: true
    name: qualys-host-list-detection
    outputs:
    - contextPath: Qualys.HostDetections.ID
      description: Host detection ID.
      type: String
    - contextPath: Qualys.HostDetections.IP
      description: Host detection IP address.
      type: String
    - contextPath: Qualys.HostDetections.TRACKING_METHOD
      description: Tracking method.
      type: String
    - contextPath: Qualys.HostDetections.OS
      description: Host operating system.
      type: String
    - contextPath: Qualys.HostDetections.DNS
      description: Host DNS.
      type: String
    - contextPath: Qualys.HostDetections.DNS_DATA.HOSTNAME
      description: DNS data host name.
      type: String
    - contextPath: Qualys.HostDetections.DNS_DATA.DOMAIN
      description: DNS data domain.
      type: Unknown
    - contextPath: Qualys.HostDetections.DNS_DATA.FQDN
      description: DNS data FQDN.
      type: Unknown
    - contextPath: Qualys.HostDetections.NETBIOS
      description: Netbios.
      type: String
    - contextPath: Qualys.HostDetections.QG_HOSTID
      description: QG host ID.
      type: String
    - contextPath: Qualys.HostDetections.LAST_SCAN_DATETIME
      description: Last scan date.
      type: Date
    - contextPath: Qualys.HostDetections.LAST_VM_SCANNED_DATE
      description: Last VM scan date.
      type: Date
    - contextPath: Qualys.HostDetections.LAST_VM_SCANNED_DURATION
      description: Last VM scan duration.
      type: String
    - contextPath: Qualys.HostDetections.LAST_PC_SCANNED_DATE
      description: Last PC scan date.
      type: Date
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.QID
      description: Detection QID.
      type: String
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.TYPE
      description: Detection type.
      type: String
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.SEVERITY
      description: Detection severity.
      type: String
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.SSL
      description: Detection SSL.
      type: String
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.RESULTS
      description: Detection results.
      type: String
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.STATUS
      description: Detection status.
      type: String
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.FIRST_FOUND_DATETIME
      description: Date detection was first found.
      type: Date
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.LAST_FOUND_DATETIME
      description: Date detection was last found.
      type: Date
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.TIMES_FOUND
      description: Number of times detection was found.
      type: String
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.LAST_TEST_DATETIME
      description: Date detection was last tested.
      type: Date
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.LAST_UPDATE_DATETIME
      description: Date detection was last updated.
      type: Date
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.IS_IGNORED
      description: Whether detection is ignored.
      type: String
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.IS_DISABLED
      description: Whether detection is disabled.
      type: String
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.LAST_PROCESSED_DATETIME
      description: Date detection was last processed.
      type: Date
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.PORT
      description: Detection port.
      type: String
    - contextPath: Qualys.HostDetections.DETECTION_LIST.DETECTION.PROTOCOL
      description: Detection protocol.
      type: String
  - arguments:
    - description: A comma-separated list of host IDs/ranges to update. A host ID
        range is specified with a hyphen (for example, 190-400). Valid host IDs are
        required. Either the `ips` or `ids` parameter must be supplied. IDs or IPs
        can be retrieved via running the `qualys-host-list-detection` command, using
        the ID field or IPs field.
      isArray: true
      name: ids
    - description: A comma-separated list of host IP addresses/ranges to add to, remove
        from or replace in the restricted IPs list. An IP range is specified with
        a hyphen (for example, 10.10.30.1-10.10.30.50). Either the `ips` or `ids`
        parameter must be supplied.
      isArray: true
      name: ips
    - description: (Valid only when the Network Support feature is enabled for the
        user’s account.) The network ID of the custom network for which to restrict
        the request. When unspecified, defaults to Global Default Network.
      name: network_id
    - description: The DNS hostname for the IP you want to update. A single IP must
        be specified in the same request and the IP will only be updated if it matches
        the hostname specified.
      name: host_dns
    - description: The NetBIOS hostname for the IP you want to update. A single IP
        must be specified in the same request and the IP will only be updated if it
        matches the hostname specified.
      name: host_netbios
    - auto: PREDEFINED
      description: Show only IP addresses/ranges which have a certain tracking method.
      name: tracking_method
      predefined:
      - IP
      - DNS
      - NETBIOS
    - auto: PREDEFINED
      description: The new tracking method. Note - You cannot change the tracking
        method to EC2 or AGENT. If an IP is already tracked by EC2 or AGENT, you cannot
        change the tracking method to something else.
      name: new_tracking_method
      predefined:
      - IP
      - DNS
      - NETBIOS
    - description: The new owner of the host asset(s). The owner must be a Manager.
        Another user (Unit Manager, Scanner, Reader) can be the owner if the IP address
        is in the user’s account.
      isArray: true
      name: new_owner
    - description: The user-defined comments. Specify new comments for the host asset(s).
      name: new_comment
    - description: Change value for user-defined field 1. You can specify a maximum
        of 128 characters (ASCII) for each field value.
      name: new_ud1
    - description: Change value for user-defined field 2. You can specify a maximum
        of 128 characters (ASCII) for each field value.
      name: new_ud2
    - description: Change value for user-defined field 3. You can specify a maximum
        of 128 characters (ASCII) for each field value.
      name: new_ud3
    description: Update host attributes using new update parameters.
    execution: true
    name: qualys-host-update
    outputs:
    - contextPath: Qualys.Endpoint.Update.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.Endpoint.Update.TEXT
      description: Qualys response for the host update.
      type: String
  - arguments:
    - description: Specify 1 for active schedules only, or 0 for deactivated schedules
        only.
      name: active
    - description: Specify 1 to distribute the scan to all scanner appliances in the
        network.
      name: scanners_in_network
    - description: A comma-separated list of Fully Qualified Domain Names to be scanned.
      name: fqdn
    - description: The number of times the scan will be run before it is deactivated.
      name: recurrence
    - description: Specify 1 to distribute the scan to all scanner appliances in the
        network.
      name: end_after_mins
    - description: Specifies the name of the Scanner Appliance for the map, when the
        map target has private use internal IPs. When using Express Lite, Internal
        Scanning must be enabled in your account.
      name: iscanner_id
    - description: The scan title.
      name: scan_title
      required: true
    - description: 'A comma-separated list of IP addresses/ranges to be scanned. At
        most, one of these parameters can be supplied: ip, asset_groups or asset_group_ids.'
      isArray: true
      name: ip
    - description: 'A comma-separated list of IDs of asset groups containing the hosts
        to be scanned. At most, one of these parameters can be supplied: ip, asset_groups
        or asset_group_ids.'
      isArray: true
      name: asset_group_ids
    - description: 'A comma-separated list of titles of asset groups containing the
        hosts to be scanned. At most, one of these parameters can be supplied: ip,
        asset_groups or asset_group_ids.'
      isArray: true
      name: asset_groups
    - description: The title of the compliance option profile to be used.
      name: option_title
    - description: Filter IPs/ranges in “ip” parameter (valid when the networks feature
        is enabled).
      name: ip_network_id
    - description: The ID of the option profile to be used.
      name: option_id
    - description: End a scan after some number of hours. A valid value is from 0
        to 119.
      name: end_after
    - description: 'The frequency (days) in which the scan occurs. The value is between
        1-365. For example: ''1'' indicates that the schedule will occur every day.
        ''2'' indicates that the schedule will occur every 2 days. At most, one of
        these parameters can be supplied: ''frequency_days'', ''frequency_weeks'',
        ''frequency_months''.'
      name: frequency_days
    - description: 'The frequency (weeks) in which the scan occurs. The value is between
        1-52. For example: ''1'' indicates that the schedule will occur every week.
        ''2'' indicates that the schedule will occur every 2 weeks. The argument ''weekdays''
        is required when frequency_weeks is given. Scan will occur only on specified
        days given in the ''weekdays'' argument. At most, one of these parameters
        can be supplied: ''frequency_days'', ''frequency_weeks'', ''frequency_months''.'
      name: frequency_weeks
    - description: 'The frequency (months) in which the scan occurs. The value is
        between 1-12. For example: ''1'' indicates that the schedule will occur every
        month. ''2'' indicates that the schedule will occur every 2 months. Either
        the argument ''day_of_month'' or the arguments ''day_of_week'' and ''week_of_month''
        are required when frequency_months is given. The scan will occur only on specified
        days given in those arguments At most, one of these parameters can be supplied:
        ''frequency_days'', ''frequency_weeks'', ''frequency_months''.'
      name: frequency_months
    - auto: PREDEFINED
      description: 'A comma-separated list of the days when the scan will occur each
        week. Required when ''frequency_weeks'' is given. For example: weekdays=''sunday,tuesday''
        along with ''frequency_weeks=2'' means the scan will occur on Sunday and Tuesday
        every two weeks.'
      isArray: true
      name: weekdays
      predefined:
      - sunday
      - monday
      - tuesday
      - wednesday
      - thursday
      - friday
      - saturday
    - description: 'Day of the month the monthly schedule will run on. The value is
        between 1-31 depending on the month. Only relevant when ''frequency_months''
        value was given. For example: day_of_month=15 along with frequency_months=2
        will result in the scan running every 2 months on the 15th of the month.'
      name: day_of_month
    - auto: PREDEFINED
      description: 'Day of week that the schedule will run on. The value is between
        0-6, where 0 is Sunday, and 6 is Saturday depending on the month. Only relevant
        when ''frequency_months'' value was given. Must be used with ''week_of_month''
        as well. For example: day_of_week=2, week_of_month=second along with frequency_months=2
        will result in the scan running every 2 months on Tuesday in the second week
        of the month.'
      name: day_of_week
      predefined:
      - "0"
      - "1"
      - "2"
      - "3"
      - "4"
      - "5"
      - "6"
    - auto: PREDEFINED
      description: 'Comma-separated list of the days of the week that the schedule
        will run on. The value is between 0-6, where 0 is Sunday, and 6 is Saturday
        depending on the month. Only relevant when ''frequency_months'' value was
        given. Must be used with ''week_of_month'' as well. For example: day_of_week=2,
        week_of_month=second along with frequency_months=2 will result in the scan
        running every 2 months on Tuesday in the second week of the month.'
      isArray: true
      name: week_of_month
      predefined:
      - first
      - second
      - third
      - fourth
      - last
    - description: 'The start date of the schedule in the format of mm/dd/yyyy. For
        example: 12/15/2020.'
      name: start_date
      required: true
    - description: The start hour of the scheduled scan. Required when 'start_date'
        is given. The value is between 0-23.
      name: start_hour
      required: true
    - description: The start minute of the scheduled scan. Required when 'start_date'
        is given. The value is between 0-59.
      name: start_minute
      required: true
    - description: 'Time zone code of the given scheduled scan. For example: US-CA
        for California time zone in the US. Required when ''start_date'' is given.'
      name: time_zone_code
      required: true
    - auto: PREDEFINED
      description: Whether to observe Daylight Saving Time (DST). Required when start_date
        is given. This parameter is valid when the time zone code specified in time_zone_code
        supports DST. To get the list of time zones and their DST support, use the
        `qualys-time-zone-code` command.
      name: observe_dst
      predefined:
      - "yes"
      - "no"
    - description: 'A comma-separated list of IP addresses/ranges to be excluded from
        the scan when the scan target is specified as IP addresses (not asset tags).
        One of the following parameters must be set: ''scanners_in_ag'', ''default_scanner''.'
      isArray: true
      name: exclude_ip_per_scan
    - auto: PREDEFINED
      description: 'Specify 1 to use the default scanner in each target asset group.
        For an Express Lite user, Internal Scanning must be enabled in the user’s
        account. At most, one of these parameters can be supplied: ''scanners_in_ag'',
        ''default_scanner''.'
      name: default_scanner
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: 'Specify 1 to distribute the scan to the target asset groups’ scanner
        appliances. Appliances in each asset group are tasked with scanning the IPs
        in the group. By default, up to 5 appliances per group will be used and this
        can be configured for your account (contact your Account Manager or Support).
        For an Express Lite user, Internal Scanning must be enabled in the user’s
        account. At most, one of these parameters can be supplied: ''scanners_in_ag'',
        ''default_scanner''.'
      name: scanners_in_ag
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: (Optional) Specify "assets" (the default) when your scan target
        will include IP addresses/ranges and/or asset groups. Specify "tags" when
        your scan target will include asset tags.
      name: target_from
      predefined:
      - assets
      - tags
    - auto: PREDEFINED
      description: (Optional) Select "any" (the default) to include hosts that match
        at least one of the selected tags. Select "all" to include hosts that match
        all of the selected tags.
      name: tag_include_selector
      predefined:
      - all
      - any
    - auto: PREDEFINED
      description: (Optional) Select "any" (the default) to exclude hosts that match
        at least one of the selected tags. Select "all" to exclude hosts that match
        all of the selected tags.
      name: tag_exclude_selector
      predefined:
      - all
      - any
    - auto: PREDEFINED
      description: (Optional) Specify "id" (the default) to select a tag set by providing
        tag IDs. Specify "name" to select a tag set by providing tag names.
      name: tag_set_by
      predefined:
      - id
      - name
    - description: (Optional) Specify a tag set to include. Hosts that match these
        tags will be included. You identify the tag set by providing tag names or
        IDs. Multiple entries are comma separated.
      name: tag_set_include
    - description: (Optional) Specify a tag set to exclude. Hosts that match these
        tags will be excluded. You identify the tag set by providing a tag names or
        IDs. Multiple entries are comma separated.
      name: tag_set_exclude
    - auto: PREDEFINED
      description: (Optional) Specify “0” (the default) to select from all tags (tags
        with any tag rule). Specify “1” to scan all IP addresses defined in the tag
        selection. When this is specified, only tags with the dynamic IP address rule
        called “IP address in Network Range(s)” can be selected.
      name: use_ip_nt_range_tags_include
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: (Optional) Specify “0” (the default) to select from all tags (tags
        with any tag rule). Specify “1” to exclude all IP addresses defined in the
        tag selection. When this is specified, only tags with the dynamic IP address
        rule called “IP address in Network Range(s)” can be selected.
      name: use_ip_nt_range_tags_exclude
      predefined:
      - "0"
      - "1"
    description: Create a scan schedule in the user’s account.
    execution: true
    name: qualys-schedule-scan-create
    outputs:
    - contextPath: Qualys.ScheduleScan.ID
      description: ID of the new scheduled scan.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for the scheduled scan creation.
      type: String
  - arguments:
    - description: The scan ID to update. The ID can be retrieved by running the 'qualys-schedule-scan-list'
        command, and using the ID field.
      name: id
      required: true
    - description: The scan title.
      name: scan_title
    - description: 'A comma-separated list of IP addresses/ranges to be scanned. At
        most, one of these parameters can be supplied: ip, asset_groups or asset_group_ids.'
      isArray: true
      name: ip
    - description: 'A comma-separated list of IDs of asset groups containing the hosts
        to be scanned. At most, one of these parameters can be supplied: ip, asset_groups
        or asset_group_ids.'
      isArray: true
      name: asset_group_ids
    - description: 'A comma-separated list of titles of asset groups containing the
        hosts to be scanned. At most, one of these parameters can be supplied: ip,
        asset_groups or asset_group_ids.'
      isArray: true
      name: asset_groups
    - description: 'The frequency (days) in which the scan occurs. The value is between
        1-365. For example: ''1'' indicates that the schedule will occur every day.
        ''2'' indicates that the schedule will occur every 2 days. At most, one of
        these parameters can be supplied: ''frequency_days'', ''frequency_weeks'',
        ''frequency_months''.'
      name: frequency_days
    - description: 'The frequency (weeks) in which the scan occurs. The value is between
        1-52. For example: ''1'' indicates that the schedule will occur every week.
        ''2'' indicates that the schedule will occur every 2 weeks. The argument ''weekdays''
        is required when frequency_weeks is given. Scan will occur only on specified
        days given in the ''weekdays'' argument. At most, one of these parameters
        can be supplied: ''frequency_days'', ''frequency_weeks'', ''frequency_months''.'
      name: frequency_weeks
    - description: 'The frequency (months) in which the scan occurs. The value is
        between 1-12. For example: ''1'' indicates that the schedule will occur every
        month. ''2'' indicates that the schedule will occur every 2 months. Either
        the argument ''day_of_month'' or the arguments ''day_of_week'' and ''week_of_month''
        are required when frequency_months is given. The scan will occur only on specified
        days given in those arguments At most, one of these parameters can be supplied:
        ''frequency_days'', ''frequency_weeks'', ''frequency_months''.'
      name: frequency_months
    - auto: PREDEFINED
      description: 'A comma-separated list of the days when the scan will occur each
        week. Required when ''frequency_weeks'' is given. For example: weekdays=''sunday,tuesday''
        along with ''frequency_weeks=2'' means the scan will occur on Sunday and Tuesday
        every two weeks.'
      isArray: true
      name: weekdays
      predefined:
      - sunday
      - monday
      - tuesday
      - wednesday
      - thursday
      - friday
      - saturday
    - description: 'Day of the month the monthly schedule will run on. The value is
        between 1-31 depending on the month. Only relevant when ''frequency_months''
        value was given. For example: day_of_month=15 along with frequency_months=2
        will result in the scan running every 2 months on the 15th of the month.'
      name: day_of_month
    - auto: PREDEFINED
      description: 'Day of week that the schedule will run on. The value is between
        0-6, where 0 is Sunday, and 6 is Saturday depending on the month. Only relevant
        when ''frequency_months'' value was given. Must be used with ''week_of_month''
        as well. For example: day_of_week=2, week_of_month=second along with frequency_months=2
        will result in the scan running every 2 months on Tuesday in the second week
        of the month.'
      name: day_of_week
      predefined:
      - "0"
      - "1"
      - "2"
      - "3"
      - "4"
      - "5"
      - "6"
    - auto: PREDEFINED
      description: 'Comma-separated list of the days of the week that the schedule
        will run on. The value is between 0-6, where 0 is Sunday, and 6 is Saturday
        depending on the month. Only relevant when ''frequency_months'' value was
        given. Must be used with ''week_of_month'' as well. For example: day_of_week=2,
        week_of_month=second along with frequency_months=2 will result in the scan
        running every 2 months on Tuesday in the second week of the month.'
      isArray: true
      name: week_of_month
      predefined:
      - first
      - second
      - third
      - fourth
      - last
    - description: 'The start date of the schedule in the format of mm/dd/yyyy. For
        example: 12/15/2020.'
      name: start_date
    - description: The start hour of the scheduled scan. Required when 'start_date'
        is given. The value is between 0-23.
      name: start_hour
    - description: The start minute of the scheduled scan. Required when 'start_date'
        is given. The value is between 0-59.
      name: start_minute
    - description: 'Time zone code of the given scheduled scan. For example: US-CA
        for California time zone in the US. Required when ''start_date'' is given.'
      name: time_zone_code
    - auto: PREDEFINED
      description: Whether to observe Daylight Saving Time (DST). Required when start_date
        is given. This parameter is valid when the time zone code specified in time_zone_code
        supports DST. To get the list of time zones and their DST support, use the
        `qualys-time-zone-code` command.
      name: observe_dst
      predefined:
      - "yes"
      - "no"
    - description: 'A comma-separated list of IP addresses/ranges to be excluded from
        the scan when the scan target is specified as IP addresses (not asset tags).
        One of the following parameters must be set: ''scanners_in_ag'', ''default_scanner''.'
      isArray: true
      name: exclude_ip_per_scan
    - auto: PREDEFINED
      description: 'Specify 1 to use the default scanner in each target asset group.
        For an Express Lite user, Internal Scanning must be enabled in the user’s
        account. At most, one of these parameters can be supplied: ''scanners_in_ag'',
        ''default_scanner''.'
      name: default_scanner
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: 'Specify 1 to distribute the scan to the target asset groups’ scanner
        appliances. Appliances in each asset group are tasked with scanning the IPs
        in the group. By default, up to 5 appliances per group will be used and this
        can be configured for your account (contact your Account Manager or Support).
        For an Express Lite user, Internal Scanning must be enabled in the user’s
        account. At most, one of these parameters can be supplied: ''scanners_in_ag'',
        ''default_scanner''.'
      name: scanners_in_ag
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: Whether the scheduled scan is activated.
      name: active
      predefined:
      - "0"
      - "1"
    - description: Specifies the name of the Scanner Appliance for the map, when the
        map target has private use internal IPs. Using Express Lite, Internal Scanning
        must be enabled in your account.
      name: iscanner_name
    - description: Filter IPs/ranges in “ip” parameter (valid when the networks feature
        is enabled).
      name: ip_network_id
    - description: The ID of the option profile to be used.
      name: option_id
    - description: End a scan after some number of hours. A valid value is from 0
        to 119.
      name: end_after
    - auto: PREDEFINED
      description: (Optional) Specify "assets" (the default) when your scan target
        will include IP addresses/ranges and/or asset groups. Specify "tags" when
        your scan target will include asset tags.
      name: target_from
      predefined:
      - assets
      - tags
    - auto: PREDEFINED
      description: (Optional) Select "any" (the default) to include hosts that match
        at least one of the selected tags. Select "all" to include hosts that match
        all of the selected tags.
      name: tag_include_selector
      predefined:
      - all
      - any
    - auto: PREDEFINED
      description: (Optional) Select "any" (the default) to exclude hosts that match
        at least one of the selected tags. Select "all" to exclude hosts that match
        all of the selected tags.
      name: tag_exclude_selector
      predefined:
      - all
      - any
    - auto: PREDEFINED
      description: (Optional) Specify "id" (the default) to select a tag set by providing
        tag IDs. Specify "name" to select a tag set by providing tag names.
      name: tag_set_by
      predefined:
      - id
      - name
    - description: (Optional) Specify a tag set to include. Hosts that match these
        tags will be included. You identify the tag set by providing tag names or
        IDs. Multiple entries are comma separated.
      name: tag_set_include
    - description: (Optional) Specify a tag set to exclude. Hosts that match these
        tags will be excluded. You identify the tag set by providing tag names or
        IDs. Multiple entries are comma separated.
      name: tag_set_exclude
    - auto: PREDEFINED
      description: (Optional) Specify “0” (the default) to select from all tags (tags
        with any tag rule). Specify “1” to scan all IP addresses defined in the tag
        selection. When this is specified, only tags with the dynamic IP address rule
        called “IP address in Network Range(s)” can be selected.
      name: use_ip_nt_range_tags_include
      predefined:
      - "0"
      - "1"
    - auto: PREDEFINED
      description: (Optional) Specify “0” (the default) to select from all tags (tags
        with any tag rule). Specify “1” to exclude all IP addresses defined in the
        tag selection. When this is specified, only tags with the dynamic IP address
        rule called “IP address in Network Range(s)” can be selected.
      name: use_ip_nt_range_tags_exclude
      predefined:
      - "0"
      - "1"
    description: Updates a scan schedule in the user’s account.
    execution: true
    name: qualys-schedule-scan-update
    outputs:
    - contextPath: Qualys.ScheduleScan.ID
      description: ID of the scheduled scan to be updated.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for the scheduled scan update.
      type: String
  - arguments:
    - description: The asset group title to add.
      name: title
      required: true
    - description: Restrict the request to a certain custom network ID.
      name: network_id
    - description: A comma-separated list of IP address/ranges to add to an asset
        group. An IP range is specified with a hyphen (for example, 10.10.10.1-10.10.10.100).
      isArray: true
      name: ips
    - description: A comma-separated list of domains to add to an asset group. Do
        not enter "www." at the start of the domain name.
      isArray: true
      name: domains
    - description: A comma-separated list of DNS names to add to an asset group.
      isArray: true
      name: dns_names
    - description: A comma-separated list of NETBIOS names to add to an asset group.
      isArray: true
      name: netbios_names
    - auto: PREDEFINED
      description: The CVSS environment target distribution to add.
      name: cvss_enviro_td
      predefined:
      - high
      - medium
      - low
      - none
    - auto: PREDEFINED
      description: The CVSS environment confidentiality requirement to add.
      name: cvss_enviro_cr
      predefined:
      - high
      - medium
      - low
    - auto: PREDEFINED
      description: The CVSS environment integrity requirement to add.
      name: cvss_enviro_ir
      predefined:
      - high
      - medium
      - low
    - auto: PREDEFINED
      description: The CVSS environment availability requirement to add.
      name: cvss_enviro_ar
      predefined:
      - high
      - medium
      - low
    - description: A comma-separated list of appliance IDs to add to an asset group.
      isArray: true
      name: appliance_ids
    description: Create a new asset group.
    execution: true
    name: qualys-asset-group-add
    outputs:
    - contextPath: Qualys.AssetGroup.ID
      description: Asset group ID.
      type: String
    - contextPath: Qualys.AssetGroup.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.AssetGroup.TEXT
      description: Qualys response for the asset group creation.
      type: String
  - arguments:
    - description: The new asset group title.
      name: set_title
    - description: The ID of the asset group to edit. The ID of asset groups can be
        retrieved via running the `qualys-group-list` command and using its ID field.
      name: id
      required: true
    - description: A comma-separated list of IP address/ranges to add to an asset
        group. An IP range is specified with a hyphen (for example, 10.10.10.1-10.10.10.100).
      isArray: true
      name: add_ips
    - description: A comma-separated list of IP address/ranges of an asset group to
        set. An IP range is specified with a hyphen (for example, 10.10.10.1-10.10.10.100).
      isArray: true
      name: set_ips
    - description: A comma-separated list of IP addresses/ranges to remove from an
        asset group. An IP range is specified with a hyphen (for example, 10.10.10.1-10.10.10.100).
      isArray: true
      name: remove_ips
    - description: A comma-separated list of domains to add to an asset group. Do
        not enter "www." at the start of the domain name.
      isArray: true
      name: add_domains
    - description: A comma-separated list of domains of an asset group to set. Do
        not enter "www." at the start of the domain name.
      isArray: true
      name: set_domains
    - description: A comma-separated list of domains to remove from an asset group.
        Do not enter "www." at the start of the domain name.
      isArray: true
      name: remove_domains
    - description: A comma-separated list of DNS names to add to an asset group.
      isArray: true
      name: add_dns_names
    - description: A comma-separated list of DNS names of asset group to set.
      isArray: true
      name: set_dns_names
    - description: A comma-separated list of DNS names to remove from an asset group.
      isArray: true
      name: remove_dns_names
    - description: A comma-separated list of NETBIOS names to add to an asset group.
      isArray: true
      name: add_netbios_names
    - description: A comma-separated list of NETBIOS names of an asset group to set.
      isArray: true
      name: set_netbios_names
    - description: A comma-separated list of NETBIOS names to delete from an asset
        group.
      isArray: true
      name: remove_netbios_names
    - auto: PREDEFINED
      description: The CVSS environment target distribution to set.
      name: set_cvss_enviro_td
      predefined:
      - high
      - medium
      - low
      - none
    - auto: PREDEFINED
      description: The CVSS environment confidentiality requirement to set.
      name: set_cvss_enviro_cr
      predefined:
      - high
      - medium
      - low
    - auto: PREDEFINED
      description: The CVSS environment integrity requirement to set.
      name: set_cvss_enviro_ir
      predefined:
      - high
      - medium
      - low
    - auto: PREDEFINED
      description: The CVSS environment availability requirement to set.
      name: set_cvss_enviro_ar
      predefined:
      - high
      - medium
      - low
    - description: A comma-separated list of appliance IDs to add to an asset group.
      isArray: true
      name: add_appliance_ids
    - description: A comma-separated list of appliance IDs of an asset group to set.
      isArray: true
      name: set_appliance_ids
    - description: A comma-separated list of appliance IDs to remove from an asset
        group.
      isArray: true
      name: remove_appliance_ids
    description: Update an asset group.
    execution: true
    name: qualys-asset-group-edit
    outputs:
    - contextPath: Qualys.AssetGroup.ID
      description: Asset group ID.
      type: String
    - contextPath: Qualys.AssetGroup.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.AssetGroup.TEXT
      description: Qualys response for the asset group update.
      type: String
  - arguments:
    - description: Asset group ID to delete. ID of asset groups can be retrieved via
        running the `qualys-group-list` command and using its ID field.
      name: id
      required: true
    description: Delete an asset group.
    execution: true
    name: qualys-asset-group-delete
    outputs:
    - contextPath: Qualys.AssetGroup.ID
      description: Asset group ID.
      type: String
    - contextPath: Qualys.AssetGroup.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.AssetGroup.TEXT
      description: Qualys response for the asset group deletion.
      type: String
  - arguments:
    - description: Scheduled Scan ID to delete. The ID can be retrieved via running
        the `qualys-schedule-scan-list` command, and using the ID field.
      name: id
      required: true
    description: Delete a scheduled scan.
    execution: true
    name: qualys-schedule-scan-delete
    outputs:
    - contextPath: Qualys.ScheduleScan.ID
      description: ID of the scheduled scan to be deleted.
      type: String
    - contextPath: Qualys.ScheduleScan.DATETIME
      description: Date the command was executed.
      type: Date
    - contextPath: Qualys.ScheduleScan.TEXT
      description: Qualys response for the scheduled scan deletion.
      type: String
  - arguments: []
    description: Gets a list of the supported time zone codes.
    execution: true
    name: qualys-time-zone-code
    outputs:
    - contextPath: Qualys.TimeZone.DST_SUPPORTED
      description: Whether Daylight Saving Time (DST) is supported.
      type: String
    - contextPath: Qualys.TimeZone.TIME_ZONE_CODE
      description: Time zone code.
      type: String
    - contextPath: Qualys.TimeZone.TIME_ZONE_DETAILS
      description: Timezone code details.
      type: String
  - arguments:
    - description: Record IDs to update.
      name: ids
      required: true
    - description: IPs specified will overwrite existing IPs in the record, and existing
        IPs will be removed.
      name: add_ips
      required: true
    description: Update Unix records for authenticated scans of hosts running on Unix.
    name: qualys-update-unix-record
  - arguments:
    - auto: PREDEFINED
      description: Criteria field to search by predefined types.
      name: criteria
      predefined:
      - parent
      - provider
      - ruleType
      - name
      - id
      - criticalityScore
      required: true
    - description: |-
        Operator assigned to the search criteria.
        Acceptable values are:
        parent - EQUALS, NOT EQUALS, IN
        provider - EQUALS, NOT EQUALS, IN
        ruleType - EQUALS, NOT EQUALS, IN
        name - CONTAINS, EQUALS, NOT EQUALS
        id - EQUALS, NOT EQUALS, IN, GREATER, LESSER
        criticalityScore - EQUALS, NOT EQUALS, GREATER, LESSER.
      name: operator
      required: true
    - description: Content to search.
      name: search_data
      required: true
    - description: The total number of items to return (Automatic Pagination). The
        default is 100.
      name: limit
    description: List asset tags based on a search criteria.
    name: qualys-asset-tag-list
    outputs:
    - contextPath: Qualys.AssetTags.id
      description: Parent asset tag ID.
      type: Number
    - contextPath: Qualys.AssetTags.name
      description: Parent asset tag name.
      type: String
    - contextPath: Qualys.AssetTags.criticality_score
      description: Criticality score assigned to the asset tag.
      type: Number
    - contextPath: Qualys.AssetTags.chlid_id
      description: Child asset tags ID.
      type: Number
    - contextPath: Qualys.AssetTags.chlid_id.child_name
      description: Child asset tags name.
      type: String
    - contextPath: Qualys.AssetTags.tag_name.rule_type
      description: Created tag rule type.
      type: String
    - contextPath: Qualys.AssetTags.tag_name.rule_text
      description: Created tag rule text.
      type: String
  - arguments:
    - description: Name of the created tag.
      name: name
      required: true
    - description: Names of the created child tags.
      isArray: true
      name: child_name
    - auto: PREDEFINED
      description: |-
        Type of rule to dynamically tagging host.
        The Rule Type argument determines the type of the Rule Text argument that is acceptable.
      name: rule_type
      predefined:
      - INSTALLED_SOFTWARE
      - NETWORK_RANGE
      - NAME_CONTAINS
      - OPEN_PORTS
      - VULN_EXIST
      - STATIC
      required: true
    - description: "Criteria for the rule. \nOptional for STATIC rule type, required
        for the rest of the rule types. \nAcceptable formats for each Rule Type argument:
        \nNETWORK_RANGE - formats: 10.10.10.1-10.10.10.6 OR 10.10.10.0/24\nVULN_EXIST(QID)
        - format: 12345(int)\nOPEN_PORTS - format: 443,888,12034(int)\nNAME_CONTAINS
        - format: REGEX\nINSTALLED_SOFTWARE - format: REGEX\nSTATIC - *RULE TEXT OPTIONAL*."
      name: rule_text
    - description: Criticality score of the asset tag. Values between 1 (lowest) and
        5 (highest).
      name: criticality_score
    description: "Create a new asset tag. \nThe changes caused by this procedure do
      not take effect immediately. The procedure could take several hours, depending
      (among other things) on the the amount of assets in the system."
    name: qualys-asset-tag-create
    outputs:
    - contextPath: Qualys.AssetTags.id
      description: Parent asset tag ID.
      type: String
    - contextPath: Qualys.AssetTags.name
      description: Parent asset tag name.
      type: String
    - contextPath: Qualys.AssetTags.criticality_score
      description: Criticality score assigned to the asset tag.
      type: Number
    - contextPath: Qualys.AssetTags.chlid_id
      description: Child asset tags ID.
      type: Number
    - contextPath: Qualys.AssetTags.chlid_id.child_name
      description: Child asset tags name.
      type: String
    - contextPath: Qualys.AssetTags.tag_name.rule_type
      description: Created tag rule type.
      type: String
    - contextPath: Qualys.AssetTags.tag_name.rule_text
      description: Created tag rule text.
      type: String
  - arguments:
    - description: ID of the tag to update.
      name: id
      required: true
    - description: Name of the created tag.
      name: name
      required: true
    - auto: PREDEFINED
      description: |-
        Type of rule to dynamically tagging host.
        The Rule Type argument determines the type of the Rule Text argument that is acceptable.
      name: rule_type
      predefined:
      - INSTALLED_SOFTWARE
      - NETWORK_RANGE
      - NAME_CONTAINS
      - OPEN_PORTS
      - VULN_EXIST
      - STATIC
      required: true
    - description: "Criteria for the rule. \nOptional for STATIC rule type, required
        for the rest of the rule types. \nAcceptable formats for each Rule Type argument:
        \nNETWORK_RANGE - formats: 10.10.10.1-10.10.10.6 OR 10.10.10.0/24\nVULN_EXIST(QID)
        - format: 12345(int)\nOPEN_PORTS - format: 443,888,12034(int)\nNAME_CONTAINS
        - format: REGEX\nINSTALLED_SOFTWARE - format: REGEX\nSTATIC - *RULE TEXT OPTIONAL*."
      name: rule_text
    - description: Comma-separated list of child tag ID's to remove.
      name: child_to_remove
    - description: Criticality score of the asset tag. Values between 1 (lowest) and
        5 (highest).
      name: criticality_score
    description: "Update an existing asset tag. \nThe changes caused by this procedure
      do not take effect immediately. The procedure could take several hours, depending
      (among other things) on the the amount of assets in the system."
    name: qualys-asset-tag-update
  - arguments:
    - description: ID of the tag to delete.
      name: id
      required: true
    description: Delete an existing asset tag.
    name: qualys-asset-tag-delete
  - arguments:
    - auto: PREDEFINED
      defaultValue: "0"
      description: Specify 1 to view input parameters in the XML output.
      name: echo_request
      predefined:
      - "0"
      - "1"
    - description: Purge host information for the defined host IDs/ranges.
      name: ids
    - description: Purge host information for the defined IP addresses/ranges.
      name: ips
    - description: Purge hosts belonging to asset groups with the defined IDs,.
      name: ag_ids
    - description: Purge hosts belonging to asset groups with the defined strings
        in the asset group title.
      name: ag_titles
    - description: Restrict the request to the defined custom network IDs.
      name: network_ids
    - description: Purge hosts not scanned since the defined date and time.
      name: no_vm_scan_since
    - description: Purge compliance hosts not scanned since the defined date and time.
      name: no_compliance_scan_since
    - description: The type of data to purge. Specify “vm” to purge vulnerability
        data, specify “pc” to purge compliance data, or specify both as a comma-separated
        list to purge both types of data.
      name: data_scope
    - auto: PREDEFINED
      description: This parameter is valid only when the policy compliance module
        is enabled for the user account. Specify 1 to purge compliance hosts in the
        user's account. Specify 0 to purge hosts which are not assigned to the PC
        module.
      name: compliance_enabled
      predefined:
      - "0"
      - "1"
    - description: Purge only hosts that have an operating system matching the defined
        regular expression. Use “%5E%24” to match an empty string.
      name: os_pattern
    description: Purge hosts in your account to remove the assessment data associated
      with them.
    name: qualys-purge-scan-host-data
    outputs:
    - contextPath: Qualys.Purge.ID
      description: IDs of the hosts queued for purging.
  - arguments:
    - description: A comma-separated list of record IDs to update. Specify record
        IDs and/or ID ranges.
      name: ids
      required: true
    - description: A comma-separated list of IPs and/or ranges to add to the IPs list
        for this record.
      name: add_ips
      required: true
    description: Update Vmware records for authenticated scans of hosts running on
      Vmware.
    name: qualys-update-vmware-record
  - arguments:
    - description: A comma-separated list of record IDs to update. Specify record
        IDs and/or ID ranges.
      name: ids
      required: true
    - description: A comma-separated list of IPs and/or ranges to add to the IPs list
        for this record.
      name: add_ips
      required: true
    description: Update vCenter records for authenticated scans of hosts running on
      vCenter.
    name: qualys-update-vcenter-record
  - arguments:
    - description: Specify a positive numeric value to limit the amount of results
        in the requested list.
      name: limit
    description: List VCenter ESXi mapping records.
    name: qualys-vcenter-esxi-mapped-record-list
    outputs:
    - contextPath: Qualys.VcenterToEsxi.ESXI_IP
      description: The IP address of the ESXi server.
    - contextPath: Qualys.VcenterToEsxi.MAPPING_DATA_SOURCE
      description: The source of this mapping record.
    - contextPath: Qualys.VcenterToEsxi.VCENTER_IP
      description: The IP address of the vCenter.
  - arguments:
    - description: The CSV data file containing the vCenter - ESXi mapping records
        that you want to import.
      name: csv_data
      required: true
    description: Import vCenter - ESXi mapping records.
    name: qualys-vcenter-esxi-mapped-record-import
  - arguments:
    - description: The CSV data file containing the vCenter - ESXi mapping records
        that you want to purge.
      name: csv_data
      required: true
    description: Purge vCenter - ESXi mapping records.
    name: qualys-vcenter-esxi-mapped-record-purge
  - arguments:
    - auto: PREDEFINED
      defaultValue: "false"
      description: If true, the command will create events, otherwise it will only
        display them.
      name: should_push_events
      predefined:
      - "true"
      - "false"
      required: true
    - description: Maximum number of results to return.
      name: limit
    - description: Date to return results from.
      name: since_datetime
    - description: Offset which events to return.
      name: offset
    description: Gets activity logs from Qualys.
    name: qualys-get-events
  - arguments:
    - auto: PREDEFINED
      defaultValue: "false"
      description: If true, the command will create assets, otherwise it will only
        display the amount of available assets.
      name: should_push_assets
      predefined:
      - "true"
      - "false"
      required: true
    description: Gets assets from Qualys.
    name: qualys-get-assets
  dockerimage: demisto/python3:3.10.14.92207
  runonce: false
  script: |
    register_module_line('QualysV2', 'start', __line__())
    ### pack version: 3.0.2
    import copy


    from collections.abc import Callable
    from typing import Any
    import csv
    import io
    import requests

    from urllib3 import disable_warnings


    disable_warnings()  # pylint: disable=no-member
    """ CONSTANTS """

    VENDOR = 'qualys'
    PRODUCT = 'qualys'
    BEGIN_RESPONSE_LOGS_CSV = "----BEGIN_RESPONSE_BODY_CSV"
    END_RESPONSE_LOGS_CSV = "----END_RESPONSE_BODY_CSV"
    BEGIN_RESPONSE_FOOTER_CSV = "----BEGIN_RESPONSE_FOOTER_CSV"
    END_RESPONSE_FOOTER_CSV = "----END_RESPONSE_FOOTER_CSV"
    WARNING = 'WARNING'
    ACTIVITY_LOGS_NEWEST_EVENT_DATETIME = 'activity_logs_newest_event_datetime'
    ACTIVITY_LOGS_NEXT_PAGE = 'activity_logs_next_page'
    ACTIVITY_LOGS_SINCE_DATETIME_PREV_RUN = 'activity_logs_since_datetime_prev_run'
    HOST_DETECTIONS_NEWEST_EVENT_DATETIME = 'host_detections_newest_event_datetime'
    HOST_DETECTIONS_NEXT_PAGE = 'host_detections_next_page'
    HOST_DETECTIONS_SINCE_DATETIME_PREV_RUN = 'host_detections_since_datetime_prev_run'
    HOST_LAST_FETCH = 'host_last_fetch'
    ASSETS_FETCH_FROM = '90 days'
    MIN_ASSETS_INTERVAL = 59
    HOST_LIMIT = 1000
    TEST_FROM_DATE = 'one day'

    ASSETS_DATE_FORMAT = '%Y-%m-%d'
    DATE_FORMAT = "%Y-%m-%dT%H:%M:%SZ"  # ISO8601 format with UTC, default in XSOAR

    API_SUFFIX = "/api/2.0/fo/"
    TAG_API_SUFFIX = "/qps/rest/2.0/"

    # Arguments that need to be parsed as dates
    DATE_ARGUMENTS = {
        "launched_after_datetime": "%Y-%m-%d",
        "launched_before_datetime": "%Y-%m-%d",
        "expires_before_datetime": "%Y-%m-%d",
        "no_vm_scan_since": "%Y-%m-%d",
        "vm_scan_since": "%Y-%m-%d",
        "no_compliance_scan_since": "%Y-%m-%d",
        "last_modified_after": "%Y-%m-%d",
        "last_modified_before": "%Y-%m-%d",
        "last_modified_by_user_after": "%Y-%m-%d",
        "last_modified_by_user_before": "%Y-%m-%d",
        "last_modified_by_service_after": "%Y-%m-%d",
        "last_modified_by_service_before": "%Y-%m-%d",
        "published_after": "%Y-%m-%d",
        "published_before": "%Y-%m-%d",
        "start_date": "%m/%d/%Y",
    }

    # Data for parsing and creating output
    COMMANDS_PARSE_AND_OUTPUT_DATA: dict[str, dict[Any, Any]] = {
        "qualys-purge-scan-host-data": {
            "table_name": "Deleted report",
            "json_path": ["BATCH_RETURN", "RESPONSE", "BATCH_LIST", "BATCH"],
            "table_headers": ["ID"],
            "collection_name": "ITEM_LIST"
        },
        "qualys-report-list": {
            "collection_name": "REPORT_LIST",
            "table_name": "Report List",
            "table_headers": [
                "ID",
                "TITLE",
                "TYPE",
                "STATUS",
                "OUTPUT_FORMAT",
                "LAUNCH_DATETIME",
                "EXPIRATION_DATETIME",
                "SIZE",
                "USER_LOGIN",
            ],
            "json_path": ["REPORT_LIST_OUTPUT", "RESPONSE"],
        },
        "qualys-ip-list": {
            "collection_name": "IP_SET",
            "table_names": ["Range List", "Address List"],
            "json_path": ["IP_LIST_OUTPUT", "RESPONSE"],
            "new_names_dict": {"IP": "Address", "IP_RANGE": "Range"},
        },
        "qualys-vm-scan-list": {
            "collection_name": "SCAN_LIST",
            "table_name": "Scan List",
            "table_headers": [
                "REF",
                "TITLE",
                "STATUS",
                "PROCESSED",
                "TYPE",
                "TARGET",
                "PROCESSING_PRIORITY",
                "LAUNCH_DATETIME",
                "DURATION",
                "USER_LOGIN",
            ],
            "json_path": ["SCAN_LIST_OUTPUT", "RESPONSE"],
        },
        "qualys-scap-scan-list": {
            "collection_name": "SCAN_LIST",
            "table_name": "Scap Scan List",
            "json_path": ["SCAN_LIST_OUTPUT", "RESPONSE"],
        },
        "qualys-pc-scan-list": {
            "collection_name": "SCAN_LIST",
            "table_name": "PC Scan List",
            "json_path": ["SCAN_LIST_OUTPUT", "RESPONSE"],
        },
        "qualys-schedule-scan-list": {
            "collection_name": "SCHEDULE_SCAN_LIST",
            "table_name": "Schedule Scan List",
            "json_path": ["SCHEDULE_SCAN_LIST_OUTPUT", "RESPONSE"],
        },
        "qualys-ip-restricted-list": {
            "collection_name": "IP_SET",
            "table_names": ["Range List", "Address List"],
            "json_path": ["RESTRICTED_IPS_OUTPUT", "RESPONSE"],
            "new_names_dict": {"IP": "Address", "IP_RANGE": "Range"},
        },
        "qualys-ip-restricted-manage": {
            "collection_name": "",
            "table_name": "Restricted IPs",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
        },
        "qualys-host-list": {
            "collection_name": "HOST_LIST",
            "table_name": "Host List",
            "json_path": ["HOST_LIST_OUTPUT", "RESPONSE"],
        },
        "qualys-virtual-host-list": {
            "collection_name": "VIRTUAL_HOST_LIST",
            "table_name": "Virtual Host List",
            "json_path": ["VIRTUAL_HOST_LIST_OUTPUT", "RESPONSE"],
        },
        "qualys-host-excluded-list": {
            "collection_name": "IP_SET",
            "table_names": ["Range List", "Address List"],
            "json_path": ["IP_LIST_OUTPUT", "RESPONSE"],
            "new_names_dict": {"IP": "Address", "IP_RANGE": "Range"},
        },
        "qualys-scheduled-report-list": {
            "collection_name": "SCHEDULE_REPORT_LIST",
            "table_name": "Scheduled Report List",
            "json_path": ["SCHEDULE_REPORT_LIST_OUTPUT", "RESPONSE"],
        },
        "qualys-report-template-list": {
            "collection_name": "REPORT_TEMPLATE",
            "table_name": "Template Report List",
            "json_path": ["REPORT_TEMPLATE_LIST", "REPORT_TEMPLATE"],
        },
        "qualys-vulnerability-list": {
            "collection_name": "VULN_LIST",
            "table_name": "Scheduled Report List",
            "json_path": ["KNOWLEDGE_BASE_VULN_LIST_OUTPUT", "RESPONSE"],
        },
        "qualys-group-list": {
            "collection_name": "ASSET_GROUP_LIST",
            "table_name": "Group List",
            "json_path": ["ASSET_GROUP_LIST_OUTPUT", "RESPONSE"],
            "table_headers": ["APPLIANCE_IDS", "DEFAULT_APPLIANCE_ID", "ID", "IP_SET", "TITLE"],
        },
        "qualys-report-fetch": {"file_prefix": "report", "file_id": "id"},
        "qualys-vm-scan-fetch": {
            "table_name": "VM Scan Fetch",
            "json_path": [],
            "file_prefix": "vm_scan",
            "file_id": "scan_ref",
            "new_names_dict": {
                "dns": "Dns",
                "instance": "Instance",
                "ip": "IP",
                "netbios": "Netbios",
                "qid": "QID",
                "result": "Result",
            },
        },
        "qualys-pc-scan-fetch": {
            "table_name": "Policy Compliance Scan",
            "json_path": ["COMPLIANCE_SCAN_RESULT_OUTPUT", "RESPONSE", "COMPLIANCE_SCAN", "HEADER", "KEY"],
        },
        "qualys-report-cancel": {
            "table_name": "Canceled report",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-report-delete": {
            "table_name": "Deleted report",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "table_headers": ["Deleted", "ID"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-scorecard-launch": {
            "table_name": "New scorecard launched",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-vm-scan-launch": {
            "collection_name": "ITEM_LIST",
            "table_name": "New Vulnerability Scan launched",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
        },
        "qualys-vm-scan-action": {
            "json_path": ["SIMPLE_RETURN", "RESPONSE", "ITEM_LIST", "ITEM"],
            "output_texts": {
                "delete": "Deleting scan",
                "pause": "Pausing scan",
                "resume": "Resuming scan",
                "cancel": "Canceling scan",
            },
        },
        "qualys-pc-scan-launch": {
            "collection_name": "ITEM_LIST",
            "table_name": "New PC Scan launched",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
        },
        "qualys-pc-scan-manage": {
            "table_name": "PC Scan",
            "json_path": ["SIMPLE_RETURN", "RESPONSE", "ITEM_LIST", "ITEM"],
        },
        "qualys-ip-add": {
            "table_name": "IP Added",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
        },
        "qualys-ip-update": {
            "table_name": "IP updated",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
        },
        "qualys-host-excluded-manage": {
            "table_name": "Manage Excluded Hosts",
            "json_path": ["SIMPLE_RETURN", "RESPONSE", "ITEM_LIST", "ITEM"],
        },
        "qualys-scheduled-report-launch": {
            "table_name": "Launch Scheduled Report",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-report-launch-map": {
            "table_name": " New report launched",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-report-launch-scan-based-findings": {
            "table_name": "Scan Based Findings Report Launch",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-report-launch-host-based-findings": {
            "table_name": "Host Based Findings Report Launch",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-report-launch-patch": {
            "table_name": "Patch Report Launch",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-report-launch-remediation": {
            "table_name": "Remediation Report Launch",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-report-launch-compliance": {
            "table_name": "Compliance Report Launch",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-report-launch-compliance-policy": {
            "table_name": "Policy Report Launch",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-virtual-host-manage": {
            "table_name": "",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
        },
        "qualys-host-list-detection": {
            "json_path": ["HOST_LIST_VM_DETECTION_OUTPUT", "RESPONSE"],
            "collection_name": "HOST_LIST",
        },
        "qualys-host-update": {
            "table_name": "Host updated",
            "json_path": ["HOST_UPDATE_OUTPUT", "RESPONSE"],
        },
        "qualys-update-unix-record": {
            "table_name": "Update Unix Record",
            "json_path": ["BATCH_RETURN", "RESPONSE", "BATCH_LIST", "BATCH"],
        },
        "qualys-asset-group-add": {
            "table_name": "Asset Group Add",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-asset-group-delete": {
            "table_name": "Asset Group Delete",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-asset-group-edit": {
            "table_name": "Asset Group Edit",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-schedule-scan-create": {
            "table_name": "Schedule Scan Create",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-schedule-scan-update": {
            "table_name": "Schedule Scan Update",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-schedule-scan-delete": {
            "table_name": "Schedule Scan Delete",
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
            "collection_name": "ITEM_LIST",
        },
        "qualys-time-zone-code": {
            "table_name": "Time Zone Codes",
            "json_path": ["TIME_ZONES"],
        },
        "qualys-asset-tag-list": {
            "table_name": "Tags identified by the specified filter",
            "json_path": ["ServiceResponse", "data", "Tag"],
            "table_headers": ["id", "name", "criticalityScore", "ruleType", "ruleText", "childTags"],
        },
        "qualys-asset-tag-create": {
            "table_name": "Asset Tags Created",
            "json_path": ["ServiceResponse", "data", "Tag"],
            "table_headers": ["id", "name", "criticalityScore", "ruleType", "ruleText", "childTags"],
        },
        "qualys-asset-tag-update": {
            "human_readable_massage": "Asset tag updated.",
            "json_path": ["ServiceResponse", "data", "Tag"],
        },
        "qualys-asset-tag-delete": {
            "human_readable_massage": "Asset tag deleted.",
            "json_path": ["ServiceResponse", "data", "Tag"],
        },
        "qualys-update-vmware-record": {
            "json_path": ["BATCH_RETURN", "RESPONSE", "BATCH_LIST", "BATCH"],
        },
        "qualys-update-vcenter-record": {
            "json_path": ["BATCH_RETURN", "RESPONSE", "BATCH_LIST", "BATCH"],
        },
        "qualys-vcenter-esxi-mapped-record-list": {
            "collection_name": "VCENTER_ESXI_MAP",
            "table_name": "Vcenter ESXI IP List",
            "json_path": ["VCENTER_ESXI_MAP_LIST_OUTPUT", "RESPONSE", "VCENTER_ESXI_MAP_LIST", "VCENTER_ESXI_MAP"],
        },
        "qualys-vcenter-esxi-mapped-record-import": {
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
        },
        "qualys-vcenter-esxi-mapped-record-purge": {
            "json_path": ["SIMPLE_RETURN", "RESPONSE"],
        },
    }

    # Context prefix and key for each command
    COMMANDS_CONTEXT_DATA = {
        "qualys-purge-scan-host-data": {
            "context_prefix": "Qualys.Purge",
            "context_key": "ID"
        },
        "qualys-report-list": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-ip-list": {
            "context_prefix": "Qualys.IP",
            "context_key": "IP",
        },
        "qualys-vm-scan-list": {
            "context_prefix": "Qualys.Scan",
            "context_key": "REF",
        },
        "qualys-scap-scan-list": {
            "context_prefix": "Qualys.SCAP.Scan",
            "context_key": "ID",
        },
        "qualys-pc-scan-list": {
            "context_prefix": "Qualys.Scan",
            "context_key": "ID",
        },
        "qualys-schedule-scan-list": {
            "context_prefix": "Qualys.Scan",
            "context_key": "ID",
        },
        "qualys-ip-restricted-list": {
            "context_prefix": "Qualys.Restricted",
            "context_key": "DATETIME",
        },
        "qualys-ip-restricted-manage": {
            "context_prefix": "Qualys.Restricted.Manage",
            "context_key": "DATETIME",
        },
        "qualys-host-list": {
            "context_prefix": "Qualys.Endpoint",
            "context_key": "ID",
        },
        "qualys-virtual-host-list": {
            "context_prefix": "Qualys.VirtualEndpoint",
            "context_key": "IP",
        },
        "qualys-host-excluded-list": {
            "context_prefix": "Qualys.Excluded.Host",
            "context_key": "Host",
        },
        "qualys-scheduled-report-list": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-report-template-list": {
            "context_prefix": "Qualys.ReportTemplate",
            "context_key": "ID",
        },
        "qualys-vulnerability-list": {
            "context_prefix": "Qualys.Vulnerability.List",
            "context_key": "QID",
        },
        "qualys-group-list": {
            "context_prefix": "Qualys.AssetGroup",
            "context_key": "ID",
        },
        "qualys-vm-scan-fetch": {
            "context_prefix": "Qualys.VM",
            "context_key": "QID",
        },
        "qualys-pc-scan-fetch": {"context_prefix": "Qualys.PC", "context_key": "TITLE"},
        "qualys-report-cancel": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-report-delete": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-scorecard-launch": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-vm-scan-launch": {
            "context_prefix": "Qualys.Report.VM.Launched",
            "context_key": "KEY",
        },
        "qualys-vm-scan-action": {
            "context_prefix": "",
            "context_key": "ID",
        },
        "qualys-pc-scan-launch": {
            "context_prefix": "Qualys.Scan",
            "context_key": "ID",
        },
        "qualys-pc-scan-manage": {
            "context_prefix": "Qualys.Scan",
            "context_key": "scan_ref",
        },
        "qualys-ip-add": {
            "context_prefix": "Qualys.IP.Add",
            "context_key": "IP",
        },
        "qualys-ip-update": {
            "context_prefix": "Qualys.IP.Update",
            "context_key": "IP",
        },
        "qualys-host-excluded-manage": {
            "context_prefix": "Qualys.Endpoint",
            "context_key": "KEY",
        },
        "qualys-scheduled-report-launch": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-report-launch-map": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-report-launch-scan-based-findings": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-report-launch-host-based-findings": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-report-launch-patch": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-report-launch-remediation": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-report-launch-compliance": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-report-launch-compliance-policy": {
            "context_prefix": "Qualys.Report",
            "context_key": "ID",
        },
        "qualys-virtual-host-manage": {
            "context_prefix": "Qualys.VirtualEndpoint",
            "context_key": "DATETIME",
        },
        "qualys-host-list-detection": {
            "context_prefix": "Qualys.HostDetections",
            "context_key": "ID",
        },
        "qualys-host-update": {
            "context_prefix": "Qualys.Endpoint.Update",
            "context_key": "ID",
        },
        "qualys-update-unix-record": {
            "context_prefix": "Qualys.UnixRecord",
            "context_key": "ID",
        },
        "qualys-asset-group-add": {
            "context_prefix": "Qualys.AssetGroup",
            "context_key": "ID",
        },
        "qualys-asset-group-edit": {
            "context_prefix": "Qualys.AssetGroup",
            "context_key": "ID",
        },
        "qualys-asset-group-delete": {"context_prefix": "Qualys.AssetGroup", "context_key": "ID"},
        "qualys-schedule-scan-create": {
            "context_prefix": "Qualys.ScheduleScan",
            "context_key": "ID",
        },
        "qualys-schedule-scan-update": {
            "context_prefix": "Qualys.ScheduleScan",
            "context_key": "ID",
        },
        "qualys-schedule-scan-delete": {
            "context_prefix": "Qualys.ScheduleScan",
            "context_key": "ID",
        },
        "qualys-time-zone-code": {
            "context_prefix": "Qualys.TimeZone",
            "context_key": "TIME_ZONE_CODE",
        },
        "qualys-asset-tag-list": {
            "context_prefix": "Qualys.AssetTags",
            "context_key": "AssetTags",
        },
        "qualys-asset-tag-create": {
            "context_prefix": "Qualys.AssetTags",
            "context_key": "AssetTags",
        },
        "qualys-asset-tag-update": {
            "context_prefix": "",
            "context_key": "",
        },
        "qualys-asset-tag-delete": {
            "context_prefix": "",
            "context_key": "",
        },
        "qualys-update-vmware-record": {
            "context_prefix": "",
            "context_key": "",
        },
        "qualys-update-vcenter-record": {
            "context_prefix": "",
            "context_key": "",
        },
        "qualys-vcenter-esxi-mapped-record-list": {
            "context_prefix": "Qualys.VcenterToEsxi",
            "context_key": "VCENTER_IP",
        },
        "qualys-vcenter-esxi-mapped-record-import": {
            "context_prefix": "",
            "context_key": "",
        },
        "qualys-vcenter-esxi-mapped-record-purge": {
            "context_prefix": "",
            "context_key": "",
        },
    }

    # Information about the API request of the commands
    COMMANDS_API_DATA: dict[str, dict[str, str]] = {
        "qualys-purge-scan-host-data": {
            "api_route": API_SUFFIX + "asset/host/?action=purge",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-report-list": {
            "api_route": API_SUFFIX + "/report/?action=list",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-ip-list": {
            "api_route": API_SUFFIX + "/asset/ip/?action=list",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-vm-scan-list": {
            "api_route": API_SUFFIX + "/scan/?action=list",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-scap-scan-list": {
            "api_route": API_SUFFIX + "/scan/scap/?action=list",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-pc-scan-list": {
            "api_route": API_SUFFIX + "/scan/compliance/?action=list",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-schedule-scan-list": {
            "api_route": API_SUFFIX + "/schedule/scan/?action=list",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-ip-restricted-list": {
            "api_route": API_SUFFIX + "/setup/restricted_ips/?action=list&output_format=xml",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-ip-restricted-manage": {
            "api_route": API_SUFFIX + "/setup/restricted_ips/",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-host-list": {
            "api_route": API_SUFFIX + "/asset/host/?action=list",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-virtual-host-list": {
            "api_route": API_SUFFIX + "/asset/vhost/?action=list",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-host-excluded-list": {
            "api_route": API_SUFFIX + "/asset/excluded_ip/?action=list",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-scheduled-report-list": {
            "api_route": API_SUFFIX + "/schedule/report/?action=list",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-report-template-list": {
            "api_route": "/msp/report_template_list.php",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-vulnerability-list": {
            "api_route": API_SUFFIX + "/knowledge_base/vuln/?action=list",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-group-list": {
            "api_route": API_SUFFIX + "/asset/group/?action=list",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-report-fetch": {
            "api_route": API_SUFFIX + "/report/?action=fetch",
            "call_method": "POST",
            "resp_type": "content",
        },
        "qualys-vm-scan-fetch": {
            "api_route": API_SUFFIX + "scan/?action=fetch&output_format=json",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-pc-scan-fetch": {
            "api_route": API_SUFFIX + "scan/compliance/?action=fetch",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-report-cancel": {
            "api_route": API_SUFFIX + "report/?action=cancel",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-report-delete": {
            "api_route": API_SUFFIX + "report/?action=delete",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-scorecard-launch": {
            "api_route": API_SUFFIX + "/report/scorecard/?action=launch",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-vm-scan-launch": {
            "api_route": API_SUFFIX + "/scan/?action=launch",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-vm-scan-action": {
            "api_route": API_SUFFIX + "/scan/",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-pc-scan-launch": {
            "api_route": API_SUFFIX + "/scan/compliance/?action=launch",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-pc-scan-manage": {
            "api_route": API_SUFFIX + "/scan/compliance/?action=launch",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-ip-add": {
            "api_route": API_SUFFIX + "/asset/ip/?action=add",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-ip-update": {
            "api_route": API_SUFFIX + "/asset/ip/?action=update",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-host-excluded-manage": {
            "api_route": API_SUFFIX + "/asset/excluded_ip/",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-scheduled-report-launch": {
            "api_route": API_SUFFIX + "/schedule/report/?action=launch_now",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-report-launch-map": {
            "api_route": API_SUFFIX + "/report/?action=launch&report_type=Map",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-report-launch-scan-based-findings": {
            "api_route": API_SUFFIX + "/report/?action=launch&report_type=Scan",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-report-launch-host-based-findings": {
            "api_route": API_SUFFIX + "/report/?action=launch&report_type=Scan",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-report-launch-patch": {
            "api_route": API_SUFFIX + "/report/?action=launch&report_type=Patch",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-report-launch-remediation": {
            "api_route": API_SUFFIX + "/report/?action=launch&report_type=Remediation",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-report-launch-compliance": {
            "api_route": API_SUFFIX + "report/?action=launch&report_type=Compliance",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-report-launch-compliance-policy": {
            "api_route": API_SUFFIX + "/report/?action=launch&report_type=Policy",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-virtual-host-manage": {
            "api_route": API_SUFFIX + "asset/vhost/",
            "call_method": "POST",
            "resp_type": "text",
        },
        "test-module": {
            "api_route": API_SUFFIX + "/scan/?action=list",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-host-list-detection": {
            "api_route": API_SUFFIX + "asset/host/vm/detection/?action=list",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-host-update": {
            "api_route": API_SUFFIX + "asset/host/?action=update",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-update-unix-record": {
            "api_route": API_SUFFIX + "auth/unix/?action=update",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-asset-group-add": {
            "api_route": API_SUFFIX + "asset/group/?action=add",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-asset-group-edit": {
            "api_route": API_SUFFIX + "asset/group/?action=edit",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-asset-group-delete": {
            "api_route": API_SUFFIX + "asset/group/?action=delete",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-schedule-scan-create": {
            "api_route": API_SUFFIX + "schedule/scan/?action=create&active=1",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-schedule-scan-update": {
            "api_route": API_SUFFIX + "schedule/scan/?action=update",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-schedule-scan-delete": {
            "api_route": API_SUFFIX + "schedule/scan/?action=delete",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-time-zone-code": {
            "api_route": "/msp/time_zone_code_list.php",
            "call_method": "GET",
            "resp_type": "text",
        },
        "qualys-update-vmware-record": {
            "api_route": API_SUFFIX + "auth/vmware/?action=update",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-update-vcenter-record": {
            "api_route": API_SUFFIX + "auth/vcenter/?action=update",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-vcenter-esxi-mapped-record-list": {
            "api_route": API_SUFFIX + "auth/vcenter/vcenter_mapping/?action=list&output_format=xml",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-vcenter-esxi-mapped-record-import": {
            "api_route": API_SUFFIX + "auth/vcenter/vcenter_mapping/?action=import",
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-vcenter-esxi-mapped-record-purge": {
            "api_route": API_SUFFIX + "auth/vcenter/vcenter_mapping/?action=purge",
            "call_method": "POST",
            "resp_type": "text"
        },
    }

    # Information about the API tag asset request of the commands
    TAG_ASSET_COMMANDS_API_DATA: dict[str, dict[str, Any]] = {
        "qualys-asset-tag-create": {
            "api_route": urljoin(TAG_API_SUFFIX, "create/am/tag"),
            "call_method": "POST",
            "resp_type": "text",
            "request_body": {"ServiceRequest": {}},
            "Content-Type": "text/xml",
        },
        "qualys-asset-tag-update": {
            "api_route": urljoin(TAG_API_SUFFIX, "update/am/tag"),
            "call_method": "POST",
            "resp_type": "text",
            "request_body": {"ServiceRequest": {}},
            "Content-Type": "text/xml",
        },
        "qualys-asset-tag-delete": {
            "api_route": urljoin(TAG_API_SUFFIX, "delete/am/tag"),
            "call_method": "POST",
            "resp_type": "text",
        },
        "qualys-asset-tag-list": {
            "api_route": urljoin(TAG_API_SUFFIX, "search/am/tag"),
            "call_method": "POST",
            "resp_type": "text",
            "request_body": {"ServiceRequest": {}},
            "Content-Type": "text/xml",
        },
    }

    # Arguments' names of each command
    COMMANDS_ARGS_DATA: dict[str, Any] = {
        "qualys-purge-scan-host-data": {
            "args": [
                "action",
                "echo_request",
                "ids",
                "ips",
                "ag_ids",
                "ag_titles",
                "network_ids",
                "no_vm_scan_since",
                "no_compliance_scan_since",
                "data_scope",
                "compliance_enabled",
                "os_pattern",
            ]
        },
        "qualys-report-list": {
            "args": ["id", "state", "user_login", "expires_before_datetime", "client_id", "client_name"],
            "inner_args": ["limit"],
        },
        "qualys-ip-list": {
            "args": ["ips", "network_id", "tracking_method", "compliance_enabled"],
            "inner_args": ["limit"],
        },
        "qualys-vm-scan-list": {
            "args": [
                "scan_ref",
                "state",
                "processed",
                "type",
                "target",
                "user_login",
                "launched_after_datetime",
                "launched_before_datetime",
                "show_ags",
                "show_op",
                "show_status",
                "show_last",
                "scan_id",
                "client_id",
                "client_name",
                "pci_only",
                "ignore_target",
            ],
            "inner_args": ["limit"],
        },
        "qualys-scap-scan-list": {
            "args": [
                "scan_ref",
                "state",
                "processed",
                "type",
                "target",
                "user_login",
                "launched_after_datetime",
                "launched_before_datetime",
                "show_ags",
                "show_op",
                "show_status",
                "show_last",
                "scan_id",
                "client_id",
                "client_name",
                "pci_only",
                "ignore_target",
            ],
            "inner_args": ["limit"],
        },
        "qualys-pc-scan-list": {
            "args": [
                "scan_id",
                "scan_ref",
                "state",
                "processed",
                "type",
                "target",
                "user_login",
                "launched_after_datetime",
                "launched_before_datetime",
                "show_ags",
                "show_op",
                "show_status",
                "show_last",
                "client_id",
                "client_name",
                "pci_only",
                "ignore_target",
            ],
            "inner_args": ["limit"],
        },
        "qualys-schedule-scan-list": {
            "args": [
                "id",
                "active",
                "show_notifications",
                "scan_type",
                "fqdn",
                "show_cloud_details",
                "client_id",
                "client_name",
                "show_cloud_details",
            ],
            "inner_args": ["limit"],
        },
        "qualys-ip-restricted-list": {
            "args": [],
            "inner_args": ["limit"],
        },
        "qualys-ip-restricted-manage": {
            "args": ["action", "enable", "ips"],
        },
        "qualys-host-list": {
            "args": [
                "os_pattern",
                "truncation_limit",
                "ips",
                "ag_titles",
                "ids",
                "network_ids",
                "no_vm_scan_since",
                "vm_scan_since",
                "no_compliance_scan_since",
                "use_tags",
                "tag_set_by",
                "tag_include_selector",
                "tag_exclude_selector",
                "tag_set_include",
                "tag_set_exclude",
                "show_tags",
                "host_metadata",
                "host_metadata_fields",
                "show_cloud_tags",
                "cloud_tag_fields",
                "details"
            ],
            "inner_args": ["limit"],
        },
        "qualys-virtual-host-list": {
            "args": ["port", "ip"],
            "inner_args": ["limit"],
        },
        "qualys-host-excluded-list": {
            "args": [
                "ips",
                "network_id",
                "ag_ids",
                "ag_titles",
                "use_tags",
                "tag_include_selector",
                "tag_exclude_selector",
                "tag_set_by",
                "tag_set_include",
                "tag_set_exclude",
            ],
            "inner_args": ["limit"],
        },
        "qualys-scheduled-report-list": {
            "args": ["id", "is_active"],
            "inner_args": ["limit"],
        },
        "qualys-report-template-list": {
            "args": [],
            "inner_args": ["limit"],
        },
        "qualys-vulnerability-list": {
            "args": [
                "details",
                "ids",
                "id_min",
                "id_max",
                "is_patchable",
                "last_modified_after",
                "last_modified_before",
                "last_modified_by_user_after",
                "last_modified_by_user_before",
                "last_modified_by_service_after",
                "last_modified_by_service_before",
                "published_after",
                "published_before",
                "discovery_method",
                "discovery_auth_types",
                "show_pci_reasons",
                "show_supported_modules_info",
                "show_disabled_flag",
                "show_qid_change_log",
            ],
            "inner_args": ["limit"],
        },
        "qualys-group-list": {
            "args": ["ids", "id_min", "id_max", "truncation_limit", "network_ids", "unit_id", "user_id", "title", "show_attributes"],
            "inner_args": ["limit"],
        },
        "qualys-report-fetch": {
            "args": ["id"],
            "inner_args": ["file_format"],
        },
        "qualys-vm-scan-fetch": {
            "args": ["scan_ref", "ips", "mode", "client_id", "client_name"],
        },
        "qualys-pc-scan-fetch": {
            "args": ["scan_ref"],
        },
        "qualys-report-cancel": {
            "args": ["id"],
        },
        "qualys-report-delete": {
            "args": ["id"],
        },
        "qualys-scorecard-launch": {
            "args": [
                "name",
                "report_title",
                "output_format",
                "hide_header",
                "pdf_password",
                "recipient_group",
                "recipient_group_id",
                "source",
                "asset_groups",
                "all_asset_groups",
                "business_unit",
                "division",
                "function",
                "location",
                "patch_qids",
                "missing_qids",
            ],
        },
        "qualys-vm-scan-launch": {
            "args": [
                "scan_title",
                "target_from",
                "ip",
                "asset_groups",
                "asset_group_ids",
                "exclude_ip_per_scan",
                "tag_include_selector",
                "tag_exclude_selector",
                "tag_set_by",
                "tag_set_include",
                "tag_set_exclude",
                "use_ip_nt_range_tags_include",
                "use_ip_nt_range_tags_exclude",
                "use_ip_nt_range_tags",
                "iscanner_id",
                "iscanner_name",
                "default_scanner",
                "scanners_in_ag",
                "scanners_in_tagset",
                "scanners_in_network",
                "option_title",
                "option_id",
                "priority",
                "connector_name",
                "ec2_endpoint",
                "ec2_instance_ids",
                "ip_network_id",
                "runtime_http_header",
                "scan_type",
                "fqdn",
                "client_id",
                "client_name",
                "include_agent_targets",
            ],
            "required_groups": [
                ["option_id", "option_title"],
            ],
        },
        "qualys-vm-scan-action": {
            "args": ["action", "scan_ref"],
        },
        "qualys-pc-scan-launch": {
            "args": [
                "scan_title",
                "option_id",
                "option_title",
                "ip",
                "asset_group_ids",
                "asset_groups",
                "runtime_http_header",
                "exclude_ip_per_scan",
                "default_scanner",
                "scanners_in_ag",
                "target_from",
                "tag_include_selector",
                "tag_exclude_selector",
                "tag_set_by",
                "tag_set_include",
                "tag_set_exclude",
                "use_ip_nt_range_tags",
                "ip_network_id",
                "iscanner_name",
            ],
            "required_groups": [
                ["option_id", "option_title"],
            ],
        },
        "qualys-pc-scan-manage": {
            "args": ["action", "scan_ref"],
        },
        "qualys-ip-add": {
            "args": ["ips", "tracking_method", "enable_vm", "enable_pc", "owner", "ud1", "ud2", "ud3", "comment", "ag_title"],
        },
        "qualys-ip-update": {
            "args": ["ips", "network_id", "tracking_method", "host_dns", "host_netbios", "owner", "ud1", "ud2", "ud3", "comment"],
        },
        "qualys-host-excluded-manage": {
            "args": ["action", "ips", "expiry_days", "dg_names", "comment", "network_id"],
        },
        "qualys-scheduled-report-launch": {
            "args": ["id"],
        },
        "qualys-report-launch-map": {
            "args": [
                "domain",
                "ip_restriction",
                "report_refs",
                "template_id",
                "report_title",
                "output_format",
                "hide_header",
                "pdf_password",
                "recipient_group",
                "recipient_group_id",
            ],
        },
        "qualys-report-launch-scan-based-findings": {
            "args": [
                "template_id",
                "report_title",
                "output_format",
                "hide_header",
                "recipient_group_id",
                "pdf_password",
                "recipient_group",
                "ip_restriction",
                "report_refs",
            ],
        },
        "qualys-report-launch-host-based-findings": {
            "args": [
                "template_id",
                "report_title",
                "output_format",
                "hide_header",
                "recipient_group_id",
                "pdf_password",
                "recipient_group",
                "ips",
                "asset_group_ids",
                "ips_network_id",
            ],
        },
        "qualys-report-launch-patch": {
            "args": [
                "template_id",
                "report_title",
                "output_format",
                "hide_header",
                "recipient_group_id",
                "pdf_password",
                "recipient_group",
                "ips",
                "asset_group_ids",
            ],
        },
        "qualys-report-launch-remediation": {
            "args": [
                "template_id",
                "report_title",
                "output_format",
                "hide_header",
                "recipient_group_id",
                "pdf_password",
                "recipient_group",
                "ips",
                "asset_group_ids",
                "asignee_type",
            ],
        },
        "qualys-report-launch-compliance": {
            "args": [
                "template_id",
                "report_title",
                "output_format",
                "hide_header",
                "recipient_group_id",
                "pdf_password",
                "recipient_group",
                "ips",
                "asset_group_ids",
                "report_refs",
            ],
        },
        "qualys-report-launch-compliance-policy": {
            "args": [
                "template_id",
                "report_title",
                "output_format",
                "hide_header",
                "recipient_group_id",
                "pdf_password",
                "recipient_group",
                "ips",
                "asset_group_ids",
                "policy_id",
                "host_id",
                "instance_string",
            ],
        },
        "qualys-virtual-host-manage": {
            "args": ["action", "ip", "network_id", "port", "fqdn"],
        },
        "test-module": {"args": ["launched_after_datetime"]},
        "qualys-host-list-detection": {
            "args": [
                "ids",
                "ips",
                "qids",
                "severities",
                "use_tags",
                "tag_set_by",
                "tag_include_selector",
                "tag_exclude_selector",
                "tag_set_include",
                "tag_set_exclude",
                "detection_processed_before",
                "detection_processed_after",
                "vm_scan_since",
                "no_vm_scan_since",
                "truncation_limit",
            ]
        },
        "qualys-host-update": {
            "args": [
                "ids",
                "ips",
                "network_id",
                "host_dns",
                "host_netbios",
                "tracking_method",
                "new_tracking_method",
                "new_owner",
                "new_comment",
                "new_ud1",
                "new_ud2",
                "new_ud3",
            ],
            "required_groups": [
                [
                    "ids",
                    "ips",
                ]
            ],
        },
        "qualys-update-unix-record": {
            "args": ["ids", "add_ips"],
        },
        "qualys-update-vmware-record": {
            "args": ["ids", "add_ips"],
        },
        "qualys-update-vcenter-record": {
            "args": ["ids", "add_ips"],
        },
        "qualys-vcenter-esxi-mapped-record-list": {
            "args": [],
            "inner_args": ["limit"],
        },
        "qualys-vcenter-esxi-mapped-record-import": {
            "args": ["csv_data"],
        },
        "qualys-vcenter-esxi-mapped-record-purge": {
            "args": ["csv_data"],
        },
        "qualys-asset-group-add": {
            "args": [
                "title",
                "network_id",
                "ips",
                "domains",
                "dns_names",
                "netbios_names",
                "cvss_enviro_td",
                "cvss_enviro_cr",
                "cvss_enviro_ir",
                "cvss_enviro_ar",
                "appliance_ids",
            ]
        },
        "qualys-asset-group-edit": {
            "args": [
                "set_title",
                "id",
                "add_ips",
                "set_ips",
                "remove_ips",
                "add_domains",
                "remove_domains",
                "set_domains",
                "add_dns_names",
                "set_dns_names",
                "remove_dns_names",
                "add_netbios_names",
                "set_netbios_names",
                "remove_netbios_names",
                "set_cvss_enviro_td",
                "set_cvss_enviro_cr",
                "set_cvss_enviro_ir",
                "set_cvss_enviro_ar",
                "add_appliance_ids",
                "set_appliance_ids",
                "remove_appliance_ids",
            ]
        },
        "qualys-asset-group-delete": {"args": ["id"]},
        "qualys-schedule-scan-create": {
            "args": [
                "scan_title",
                "asset_group_ids",
                "asset_groups",
                "ip",
                "option_title",
                "frequency_days",
                "weekdays",
                "frequency_weeks",
                "frequency_months",
                "day_of_month",
                "day_of_week",
                "week_of_month",
                "start_date",
                "start_hour",
                "start_minute",
                "time_zone_code",
                "exclude_ip_per_scan",
                "default_scanner",
                "scanners_in_ag",
                "observe_dst",
                "ip_network_id",
                "option_id",
                "end_after",
                "target_from",
                "tag_include_selector", "tag_exclude_selector", "tag_set_by", "tag_set_include", "tag_set_exclude",
                "use_ip_nt_range_tags_include", "use_ip_nt_range_tags_exclude",
                "active",
                "scanners_in_network",
                "fqdn",
                "recurrence",
                "end_after_mins",
                "iscanner_id",
                "iscanner_name"
            ],
            "required_groups": [
                [
                    "asset_group_ids",
                    "asset_groups",
                    "ip",
                    "fqdn",
                ],
                [
                    "frequency_days",
                    "frequency_weeks",
                    "frequency_months",
                ],
                [
                    "scanners_in_ag",
                    "default_scanner",
                ],
            ],
            "required_depended_args": {
                "day_of_month": "frequency_months",
                "day_of_week": "frequency_months",
                "week_of_month": "frequency_months",
                "weekdays": "frequency_weeks",
            },
            "default_added_depended_args": {
                "frequency_days": {
                    "occurrence": "daily",
                },
                "frequency_weeks": {
                    "occurrence": "weekly",
                },
                "frequency_months": {
                    "occurrence": "monthly",
                },
            },
        },
        "qualys-schedule-scan-update": {
            "args": [
                "id",
                "scan_title",
                "asset_group_ids",
                "asset_groups",
                "ip",
                "frequency_days",
                "weekdays",
                "frequency_weeks",
                "frequency_months",
                "day_of_month",
                "day_of_week",
                "week_of_month",
                "start_date",
                "start_hour",
                "start_minute",
                "time_zone_code",
                "exclude_ip_per_scan",
                "default_scanner",
                "scanners_in_ag",
                "active",
                "observe_dst",
                "target_from",
                "iscanner_name",
                "ip_network_id",
                "option_id",
                "end_after",
                "tag_include_selector", "tag_exclude_selector", "tag_set_by", "tag_set_include",
                "tag_set_exclude", "use_ip_nt_range_tags_include", "use_ip_nt_range_tags_exclude"
            ],
            "default_added_depended_args": {
                "frequency_days": {
                    "occurrence": "daily",
                },
                "frequency_weeks": {
                    "occurrence": "weekly",
                },
                "frequency_months": {
                    "occurrence": "monthly",
                },
                "start_hour": {
                    "set_start_time": 1,
                },
                "start_minute": {
                    "set_start_time": 1,
                },
                "start_date": {
                    "set_start_time": 1,
                },
                "observe_dst": {
                    "set_start_time": 1,
                },
                "time_zone_code": {
                    "set_start_time": 1,
                },
            },
            "required_depended_args": {
                "day_of_month": "frequency_months",
                "day_of_week": "frequency_months",
                "week_of_month": "frequency_months",
                "weekdays": "frequency_weeks",
                "start_hour": "start_date",
                "start_minute": "start_date",
                "time_zone_code": "start_date",
                "observe_dst": "start_date",
            },
            "at_most_one_groups": [
                [
                    "asset_group_ids",
                    "asset_groups",
                    "ip",
                ],
                [
                    "frequency_days",
                    "frequency_weeks",
                    "frequency_months",
                ],
                [
                    "scanners_in_ag",
                    "default_scanner",
                ],
            ],
        },
        "qualys-schedule-scan-delete": {
            "args": [
                "id",
            ]
        },
        "qualys-time-zone-code": {"args": []},
        "qualys-asset-tag-create": {"args": ["name", "child_name", "rule_type", "rule_text", "criticality_score"]},
        "qualys-asset-tag-update": {"args": ["id", "name", "rule_type", "rule_text", "child_to_remove", "criticality_score"]},
        "qualys-asset-tag-delete": {"args": ["id"]},
        "qualys-asset-tag-list": {"args": ["criteria", "operator", "search_data", "limit"]},
    }

    # Dictionary for arguments used by Qualys API
    args_values: dict[str, Any] = {}

    # Dictionary for arguments used internally by this integration
    inner_args_values: dict[str, Any] = {}

    """ CLIENT CLASS """


    class Client(BaseClient):
        def __init__(self, base_url, username, password, verify=True, proxy=False, headers=None):
            super().__init__(base_url, verify=verify, proxy=proxy, headers=headers, auth=(username, password))

        @staticmethod
        def error_handler(res):
            err_msg = ""
            if res.status_code == 414 or res.status_code == 520:
                err_msg += ("If this error was produced by a schedule-scan-create, "
                            "please execute it again with IP list of less than 5000 characters\n\n")
            err_msg += f"Error in API call [{res.status_code}] - {res.reason}"
            try:
                simple_response = get_simple_response_from_raw(parse_raw_response(res.text))
                err_msg = f'{err_msg}\nError Code: {simple_response.get("CODE")}\nError Message: {simple_response.get("TEXT")}'
            except Exception:
                try:
                    # Try to parse json error response
                    error_entry = res.json()
                    err_msg += f"\n{json.dumps(error_entry)}"
                    raise DemistoException(err_msg, res=res)
                except (ValueError, TypeError):
                    err_msg += f"\n{res.text}"
                    raise DemistoException(err_msg, res=res)
            raise DemistoException(err_msg, res=res)

        @logger
        def command_http_request(self, command_api_data: dict[str, str]) -> Union[str, bytes]:
            """
            Make a http request to Qualys API
            Args:
                command_api_data: Information about the API request of the requested command
            Returns:
                response from Qualys API
            Raises:
                DemistoException: can be raised by the _http_request function
            """
            if content_type := command_api_data.get("Content-Type"):
                self._headers.update({"Content-Type": content_type})

            return self._http_request(
                method=command_api_data["call_method"],
                url_suffix=command_api_data["api_route"],
                params=args_values,
                resp_type=command_api_data["resp_type"],
                timeout=60,
                data=command_api_data.get("request_body", None),
                error_handler=self.error_handler,
            )

        def get_user_activity_logs(self, since_datetime: str, max_fetch: int = 0, next_page=None) -> Union[str, bytes]:
            """
            Make a http request to Qualys API to get user activities logs
            Args:
            Returns:
                response from Qualys API
            Raises:
                DemistoException: can be raised by the _http_request function
            """
            self._headers.update({"Content-Type": 'application/json'})
            params: dict[str, Any] = {
                "truncation_limit": max_fetch
            }
            if since_datetime:
                params["since_datetime"] = since_datetime
            if next_page:
                params["id_max"] = next_page

            response = self._http_request(
                method='GET',
                url_suffix=urljoin(API_SUFFIX, 'activity_log/?action=list'),
                resp_type='text/csv',
                params=params,
                timeout=60,
                error_handler=self.error_handler,
            )

            return response.text

        def get_host_list_detection(self, since_datetime, next_page=None) -> Union[str, bytes]:
            """
            Make a http request to Qualys API to get assets
            Args:
            Returns:
                response from Qualys API
            Raises:
                DemistoException: can be raised by the _http_request function
            """
            self._headers.update({"Content-Type": 'application/json'})
            params: dict[str, Any] = {
                "truncation_limit": HOST_LIMIT,
                "vm_scan_date_after": since_datetime
            }
            if next_page:
                params["id_min"] = next_page

            response = self._http_request(
                method='GET',
                url_suffix=urljoin(API_SUFFIX, 'asset/host/vm/detection/?action=list'),
                resp_type='text',
                params=params,
                timeout=60,
                error_handler=self.error_handler,
            )
            return response

        def get_vulnerabilities(self, since_datetime) -> Union[str, bytes]:
            """
            Make a http request to Qualys API to get vulnerabilities
            Args:
            Returns:
                response from Qualys API
            Raises:
                DemistoException: can be raised by the _http_request function
            """
            self._headers.update({"Content-Type": 'application/json'})
            params: dict[str, Any] = {"last_modified_after": since_datetime}

            response = self._http_request(
                method='POST',
                url_suffix=urljoin(API_SUFFIX, 'knowledge_base/vuln/?action=list'),
                resp_type='text',
                params=params,
                timeout=60,
                error_handler=self.error_handler,
            )

            return response


    """ HELPER FUNCTIONS """


    @logger
    def create_ip_list_dict(res_json: dict[str, Any], type_of_dict: str) -> dict[str, Any]:
        """
        Creates a dictionary of a range type of ips or single address type of ips
        Args:
            res_json: Dictionary received from ip list command with 'Address' or 'Range' keys
            type_of_dict: The wanted type of dictionary: 'Range' or 'Address'
        Returns:
            A dictionary with the specified type of ips values
        """
        ips_dict = {}

        if type_of_dict in res_json:
            ips = res_json[type_of_dict]
            # In case a single value returned it can be either a Dict or a str
            if isinstance(ips, dict | str):
                ips_dict = {"0": ips}
            else:
                for index, ip in enumerate(ips):
                    ips_dict[str(index)] = ip
            return ips_dict
        return {}


    @logger
    def build_ip_and_range_dicts(ips_and_ranges: List[str]) -> List[List[dict[str, str]]]:
        """
        Separates the list of ips and ranges to two lists, one of singles ips
        and the other of ranges of ips
        Args:
            ips_and_ranges: A list that might contain both ips and ranges of ips
        Returns: A list that has one list which consists of single value dictionaries of ips
                 and another list which consists of single values dictionaries of ranges
        """
        list_of_ips = []
        list_of_ranges = []
        for value in ips_and_ranges:
            if "-" in value:
                list_of_ranges.append({"range": value})
            else:
                list_of_ips.append({"ip": value})
        return [list_of_ips, list_of_ranges]


    @logger
    def create_single_host_list(ip_and_range_lists: dict[str, Union[str, List]]) -> List[str]:
        """
        Creates a single list containing both single ips and ranges of ips
        Args:
            ip_and_range_lists: A dictionary that can have either a single ip as a string or
            a list of single ips in the key 'Address' and/or a single range as a string or
            a list of range of ips in the key 'Range'
        Returns: A list that has both ips and ranges of ips
        """
        ip_and_range_list = []

        if "Address" in ip_and_range_lists:
            if isinstance(ip_and_range_lists["Address"], str):
                ip_and_range_list.extend([ip_and_range_lists["Address"]])
            else:
                for address in ip_and_range_lists["Address"]:
                    ip_and_range_list.append(address)
        if "Range" in ip_and_range_lists:
            if isinstance(ip_and_range_lists["Range"], str):
                ip_and_range_list.extend([ip_and_range_lists["Range"]])
            else:
                for ip_range in ip_and_range_lists["Range"]:
                    ip_and_range_list.append(ip_range)
        return ip_and_range_list


    @logger
    def create_ip_list_markdown_table(dicts_of_ranges_and_ips: List[List[dict[str, str]]]) -> str:
        """
        Creates two tables one describes a list of ips and the other a list of ranges
        Args:
            dicts_of_ranges_and_ips: A list which might contain one or two lists of dictionaries. One is a list of Ips
                                     and the other a list of ranges
        Returns: A string which is a markdown representation of the lists
        """
        readable_output = ""
        if dicts_of_ranges_and_ips[0]:
            readable_output += f"{tableToMarkdown(name='', t=dicts_of_ranges_and_ips[0])}\n"
        if dicts_of_ranges_and_ips[1]:
            readable_output += tableToMarkdown(name="", t=dicts_of_ranges_and_ips[1])
        return readable_output


    @logger
    def create_ip_list_dicts(res_json: dict[str, Any]) -> List[dict[str, Any]]:
        """
        Creates separate dictionaries of addresses and ranges
        Args:
            res_json: Dictionary received from ip list command with 'Address' or 'Range' keys
        Returns:
            List with address dictionary and ranges of addresses dictionary
        Raises:
            DemistoException: dictionary doesn't have any of the expected keys
            TypeError: res_json is not a dictionary
        """
        output_list = []

        address_dict = create_ip_list_dict(res_json, "Address")
        range_dict = create_ip_list_dict(res_json, "Range")
        if address_dict:
            output_list.append(address_dict)
        if range_dict:
            output_list.append(range_dict)

        if not output_list:
            raise DemistoException("IP list command is missing keys")

        return output_list


    @logger
    def generate_list_dicts(asset_dict: dict[str, Any]) -> Union[List[Any], dict]:
        """
            Takes a dictionary with a specific structure of a single key containing
            a list of dictionaries and returns the list of dictionaries
        Args:
            asset_dict: Dictionary that contains a single asset type returned from the API
        Returns:
            A list of assets of the asset type requested
        """
        return list(asset_dict.values())[0]


    @logger
    def build_args_dict(args: Optional[dict[str, str]], command_args_data: dict[str, Any], is_inner_args: bool) -> None:
        """
        Takes the arguments needed by the command that were received by the user
        and stores them in the general commands data dictionary
        Args:
            args: Dictionary of arguments received by the user
            command_args_data: names of the arguments used by the command
            is_inner_args: if True - will create dict for inner args otherwise will create dict args for the API
        Returns:
            None
        """
        global inner_args_values, args_values
        if is_inner_args and "inner_args" in command_args_data:
            type_of_args_name = "inner_args"
        else:
            type_of_args_name = "args"

        args_dict = {}
        if args:
            for arg in command_args_data[type_of_args_name]:
                if args.get(arg):
                    if arg in DATE_ARGUMENTS:
                        datetime_arg = arg_to_datetime(args.get(arg))
                        if datetime_arg:
                            args[arg] = datetime_arg.strftime(DATE_ARGUMENTS.get(arg, "%Y-%m-%d"))
                    args_dict[arg] = args.get(arg)

        # If some args are given, we want to add more args with default value.
        for arg_depending_on, depended_args_dict in command_args_data.get("default_added_depended_args", {}).items():
            if arg_depending_on in args_dict:
                args_dict.update(depended_args_dict)

        if type_of_args_name == "inner_args":
            inner_args_values = args_dict
        else:
            args_values = args_dict


    @logger
    def is_empty_result(json_response: dict[str, Any]) -> bool:
        """
        Checking whether the response object contains no object or only timestamp object,
        both are considered an empty result, otherwise it's not empty
        Args:
            json_response: Dictionary received by the request to the API

        Returns: True if the dictionary is empty, otherwise return False
        """
        if not json_response or len(json_response) == 1 and json_response.get("DATETIME"):
            return True
        return False


    @logger
    def limit_result(result: List[Any], limit: Union[int, str]) -> List[Any]:
        """
        Given the result and a limit amount,  the result will be limited to amount requested
        Args:
            result: A list of results received
            limit: either int or string representing how many entries should be shown
        Returns:
            returns result after applying slicing so only the wanted amount of entries will be shown.
        """
        limit = int(limit)
        limited_list = result[:limit]
        return limited_list


    @logger
    def calculate_ip_original_amount(result: dict[str, Any]) -> int:
        """
        Calculating the amount of ip addresses and ranges returned.
        Args:
            result: Parsed output, a dictionary that might contain a list of single ips and a list of ranges of ips.
            IP addresses and ranges are represented by a list of items, unless there's only a single item,
            then it's a string.
        Returns: An integer which is the amount of ip addresses and ranges
        """
        original_amount = 0
        if "Address" in result:
            if isinstance(result["Address"], str):
                original_amount += 1
            else:
                original_amount += len(result["Address"])
        if "Range" in result:
            if isinstance(result["Range"], str):
                original_amount += 1
            else:
                original_amount += len(result["Range"])
        return original_amount


    @logger
    def limit_ip_results(result: dict[str, Any], limit: int) -> dict[str, Any]:
        """
        Limiting the results of commands like qualys-ip-list and qualys-excluded-host-list.
        First will limit the single ips and if needed will also limit the ranges of ips list
        Args:
            result: Parsed output, a dictionary that might contain a list of single ips and a list of ranges of ips
            limit: The limit of the presented list, cannot be smaller than 1
        Returns:
            The given dictionary but after the limit was applied
        """
        if "Address" in result:
            if isinstance(result["Address"], list):
                if len(result["Address"]) > limit:
                    result["Address"] = limit_result(result["Address"], limit)
                limit = limit - len(result["Address"])
            else:
                # When there's a single IP it's not a list but a single string, therefore subtract 1 from the limit
                limit -= 1

        if "Range" in result:
            if isinstance(result["Range"], list):
                result["Range"] = limit_result(result["Range"], limit)
            else:
                if limit == 0:
                    # When there's a single IP it's not a list but a single string, the 'Range' key will be changed only if
                    # limit is 0
                    result["Range"] = []

        return result


    @logger
    def validate_required_group(command_data: dict) -> None:
        """
        Validates that if exactly one of each `required_group` have been given.
        Args:
            command_data (Dict): Command data.

        Returns:
            (None): Validates input.
        Raises:
            (DemistoException): If there exists a group in `required_group` whom arguments were given were not exactly one.
        """
        for group in command_data.get("required_groups", []):
            existing_args = [arg for arg in group if arg in inner_args_values or arg in args_values]
            if len(existing_args) != 1:
                raise DemistoException(f"Exactly one of the arguments {group} must be provided.")


    @logger
    def validate_depended_args(command_data: dict) -> None:
        """
        Validates that if one arg was given, and other arg is dependant on given arg, that it was given as well.
        Args:
            command_data (Dict): Command data.

        Returns:
            (None): Validates input.
        Raises:
            (DemistoException): If expected dependant arg is missing.
        """
        # Args that are required depending if other argument was given.
        for required_depended_arg, depended_on_arg in command_data.get("required_depended_args", {}).items():
            if depended_on_arg not in args_values and depended_on_arg not in inner_args_values:
                continue
            if required_depended_arg not in args_values and required_depended_arg not in inner_args_values:
                raise DemistoException(f"Argument {required_depended_arg} is required when argument {depended_on_arg} is given.")


    @logger
    def validate_at_most_one_group(command_data: dict) -> None:
        """
        Validates that for each group, at most one argument was given.
        Args:
            command_data (Dict): Command data.

        Returns:
            (None): Validates input.
        Raises:
            (DemistoException): If more than one arg in group was given.
        """
        #   At most one argument can be given
        for group in command_data.get("at_most_one_groups", []):
            existing_args = [arg for arg in group if arg in inner_args_values or arg in args_values]
            if len(existing_args) > 1:
                raise DemistoException(f"At most one of the following args can be given: {existing_args}")


    @logger
    def input_validation(command_name: str) -> None:
        """
        Takes the arguments received by the user and validates them.
        limit parameter - validates that it's a positive integer
        required groups - each command might have groups of parameters that only one argument from each group must be
                          provided. If there exists a group which none of the parameters in it were provided it's
                          considered an invalid input.
        A message will be printed explaining why the input is invalid.א
        Args:
            command_name: Name of the requested command
        Raises:
            DemistoException: Will be raised if input failed the validation
        """
        command_data = COMMANDS_ARGS_DATA[command_name]
        if limit := inner_args_values.get("limit"):
            try:
                if int(limit) < 1:
                    raise ValueError
            except ValueError as exc:
                raise DemistoException("Limit parameter must be an integer bigger than 0") from exc

        validate_required_group(command_data)
        validate_depended_args(command_data)
        validate_at_most_one_group(command_data)


    def generate_asset_tag_xml_request_body(args: dict[str, str], command_name: str):
        """generate asset tag xml request body according to passed command

        Args:
            args (Dict[str, str]): command arguments
            command_name (str): command name

        Returns:
            str: string representing xml
        """
        match command_name:
            case "qualys-asset-tag-list":
                ServiceRequest = ET.Element("ServiceRequest")
                if limit := args.get("limit"):
                    preferences = ET.SubElement(ServiceRequest, "preferences")
                    limit_results = ET.SubElement(preferences, "limitResults")
                    limit_results.text = limit
                filters = ET.SubElement(ServiceRequest, "filters")
                criteria = ET.SubElement(filters, "Criteria")
                criteria.set("field", args.get("criteria", ""))
                criteria.set("operator", args.get("operator", ""))
                criteria.text = args.get("search_data", "")

            case "qualys-asset-tag-create" | "qualys-asset-tag-update":
                rule_text_arg = args.get("rule_text", "")
                rule_type_arg = args.get("rule_type", "")
                if rule_type_arg != "STATIC" and not rule_text_arg:
                    raise DemistoException(message="Rule Type argument is passed but Rule Text argument is missing."
                                           + " Rule Text is optional only when Rule Type is 'STATIC'.")

                ServiceRequest = ET.Element("ServiceRequest")
                data = ET.SubElement(ServiceRequest, "data")
                tag = ET.SubElement(data, "Tag")
                name = ET.SubElement(tag, "name")
                name.text = args.get("name", "")
                rule_type = ET.SubElement(tag, "ruleType")
                rule_type.text = rule_type_arg
                if rule_text_arg:
                    rule_text = ET.SubElement(tag, "ruleText")
                    rule_text.text = rule_text_arg

                if criticality_score_arg := args.get("criticality_score"):
                    criticality_score = ET.SubElement(tag, "criticalityScore")
                    criticality_score.text = str(criticality_score_arg)

                if child_names := argToList(args.get("child_name")):
                    children = ET.SubElement(tag, "children")
                    action = ET.SubElement(children, "set")

                    for child in child_names:
                        tag_simple = ET.SubElement(action, "TagSimple")
                        child_name_tag = ET.SubElement(tag_simple, "name")
                        child_name_tag.text = str(child)

                elif child_ids := argToList(args.get("child_to_remove")):
                    children = ET.SubElement(tag, "children")
                    action = ET.SubElement(children, "remove")
                    for child in child_ids:
                        tag_simple = ET.SubElement(action, "TagSimple")
                        child_name_tag = ET.SubElement(tag_simple, "id")
                        child_name_tag.text = str(child)

        return ET.tostring(ServiceRequest)


    def handle_asset_tag_request_parameters(args: dict[str, str], command_name: str) -> None:
        """Handle 'asset tag' command parameters related to the HTTP request.
        Add 'id' argument to URL suffix if required by the command.
        Generate a request body if required by the command.

        Args:
            args (Dict[str, str]): command arguments
            command_name (str): command name

        Returns:
            None: the function will make the necessary changes (if required by the command) and will return None.
        """
        # add 'id' argument to URL suffix if exists
        if id := args.get("id"):
            api_route = TAG_ASSET_COMMANDS_API_DATA[command_name].get("api_route")
            TAG_ASSET_COMMANDS_API_DATA[command_name]["api_route"] = urljoin(api_route, str(id))

        # generate request body if required by the command
        if TAG_ASSET_COMMANDS_API_DATA[command_name].get("request_body"):
            TAG_ASSET_COMMANDS_API_DATA[command_name]["request_body"] = generate_asset_tag_xml_request_body(args, command_name)


    """ PARSERS """


    @logger
    def change_dict_keys(new_names_dict: dict[str, str], output_dict: dict[str, Any]) -> dict[str, Any]:
        """
        Takes a dictionary and changes the names of the keys
        Args:
            new_names_dict: a dictionary with the old names as keys and their new names as their values
            output_dict: Dictionary with string keys
        Returns:
            Same dictionary but with keys with the new names or the same dictionary if the old keys don't exist
        Raises:
            TypeError: output_dict is not a dictionary
        """
        for key, new_name in new_names_dict.items():
            if key in output_dict:
                output_dict[new_name] = output_dict.pop(key)
        return output_dict


    @logger
    def change_list_dicts_names(command_parse_and_output_data: dict[str, Any], output: List[dict[str, Any]]) -> List[dict[str, Any]]:
        """
        Changing keys names of a list of dicts
        Args:
            command_parse_and_output_data (Dict): Data for parsing and creating output for a specific command
            output: list of dictionaries. all the dictionaries must have the same keys
        Returns:
            Same list but with dicts that have keys with the new names
        Raises:
            KeyError: can be raised by change_dict_keys
            TypeError: can be raised by change_dict_keys
        """
        new_names_dict = command_parse_and_output_data["new_names_dict"]

        for item in output:
            change_dict_keys(new_names_dict, item)
        return output


    @logger
    def parse_two_keys_dict(json_res: dict[str, Any]) -> dict[str, Any]:
        """
        Takes a dictionary in a specific format creates a new dictionary
        Args:
            json_res: Dictionary with two keys 'VALUE' and 'KEY'

        Returns: new dictionary with the 'KEY' value being the key and the value of the
                 new key being the value of the key 'VALUE'
        Raises:
                KeyError: json_res doesn't have the expected keys
                TypeError: json_res is not a dictionary
        """
        res = {json_res["KEY"]: json_res["VALUE"]}
        return res


    @logger
    def parse_text_value_pairs_list(multiple_key_list: List[dict[str, Any]]) -> dict[str, Any]:
        """
        Creates a single dictionary from a list of dictionaries
        Args:
            multiple_key_list: List of dictionaries where each dictionary has the keys @value and #text
        Returns:
            A single dictionary where the keys are the '@value's and the values are the '#text's
        """
        parsed_dict = {}
        for obj in multiple_key_list:
            parsed_dict[obj["@value"]] = obj["#text"]
        return parsed_dict


    def parse_raw_response(response: Union[bytes, requests.Response]) -> dict:
        """
        Parses raw response from Qualys.
        Tries to load as JSON. If fails to do so, tries to load as XML.
        If both fails, returns an empty dict.
        Args:
            response (Union[bytes, requests.Response]): Response from Qualys service.

        Returns:
            (Dict): Dict representing the data returned by Qualys service.
        """
        try:
            return json.loads(str(response))
        except Exception:
            try:
                return json.loads(xml2json(response))
            except Exception:
                return {}


    @logger
    def get_simple_response_from_raw(raw_response: Any) -> Union[Any, dict]:
        """
        Gets the simple response from a given JSON dict structure returned by Qualys service
        If object is not a dict, returns the response as is.
        Args:
            raw_response (Any): Raw response from Qualys service.

        Returns:
            (Union[Any, Dict]): Simple response path if object is a dict, else response as is.
        """
        simple_response = None
        if raw_response and isinstance(raw_response, dict):
            simple_response = raw_response.get("SIMPLE_RETURN", {}).get("RESPONSE", {})
        return simple_response


    @logger
    def format_and_validate_response(response: Union[bytes, requests.Response]) -> dict[str, Any]:
        """
        first tries to load the response as json if possible, if not will
        try to convert from xml to json, then it validates the response
        Args:
            response: Response received from Qualys API
        Returns:
            Dict: If response can be parsed and valid will return the parsed dictionary
            None: If response cant be parsed to json it will return None
        Raises:
            DemistoException: if the response has an error code
        """
        raw_response = parse_raw_response(response)
        simple_response = get_simple_response_from_raw(raw_response)
        if simple_response and simple_response.get("CODE"):
            raise DemistoException(f"\n{simple_response.get('TEXT')} \nCode: {simple_response.get('CODE')}")
        return raw_response


    """ HANDLERS """


    @logger
    def handle_asset_tag_result(raw_response: requests.Response, command_name: str):
        """
        Handles asset tag commands. Parses, validates and finally returns the response parsed.
        Will raise an exception if needed.
        Args:
            raw_response (requests.Response): the raw result received from Qualys API command
            command_name (str): name of the command to handle
        Returns:
            CommandResults with data generated for the result given
        Raises:
            DemistoException: can be raised by parse_and_validate_response for bad input
        """

        formatted_response = format_and_validate_response(raw_response)

        if response_error_details := formatted_response.get("ServiceResponse", {}).get("responseErrorDetails"):
            raise DemistoException(response_error_details.get("errorMessage"))

        elif formatted_response.get("ServiceResponse", {}).get("count") == "0":
            return None

        elif path_list := COMMANDS_PARSE_AND_OUTPUT_DATA[command_name]["json_path"]:
            if len(path_list) == 0:
                return formatted_response
            response_requested_value = dict_safe_get(formatted_response, path_list)

            if not response_requested_value:
                raise ValueError
            return response_requested_value
        return None


    @logger
    def handle_general_result(raw_response: requests.Response, command_name: str) -> object:
        """
        Handles commands that don't return files, parses, validates and finally returns the response parsed .
        Args:
            raw_response (requests.Response): the raw result received from Qualys API command
            command_name (str): name of the command to handle
        Returns:
            CommandResults with data generated for the result given
        Raises:
            DemistoException: can be raised by parse_and_validate_response for bad input
        """
        path_list = COMMANDS_PARSE_AND_OUTPUT_DATA[command_name]["json_path"]
        formatted_response = format_and_validate_response(raw_response)

        if len(path_list) == 0:
            return formatted_response
        response_requested_value = dict_safe_get(formatted_response, path_list)

        if not response_requested_value:
            raise ValueError
        return response_requested_value


    @logger
    def handle_report_list_result(raw_response: requests.Response, command_name: str) -> object:
        """
        Handles report list command, parses, validates and finally returns the response parsed .
        Args:
            raw_response (requests.Response): the raw result received from Qualys API command
            command_name (str): name of the command to handle
        Returns:
            CommandResults with the report metadata
        Raises:
            DemistoException: can be raised if there is no report for given id
        """
        response_requested_value = handle_general_result(raw_response, command_name)

        if is_empty_result(response_requested_value) and (report_id := demisto.args().get('id')):
            raise DemistoException(f'No report exist for the id {report_id}')

        return response_requested_value


    @logger
    def handle_fetch_result(raw_response: Union[bytes, requests.Response], command_name: str) -> dict:
        """
        Handles fetch file commands
        Args:
            raw_response (requests.Response): response received from qualys
            command_name (str): name of the command to handle
        Returns:
            A Demisto war room entry
        """
        command_parse_and_output_data = COMMANDS_PARSE_AND_OUTPUT_DATA[command_name]

        format_and_validate_response(raw_response)
        file_id = args_values[command_parse_and_output_data["file_id"]]
        file_format = inner_args_values["file_format"]
        file_name = f"{command_parse_and_output_data['file_prefix']}_{file_id}.{file_format}"

        file_type = entryTypes["entryInfoFile"]
        entry = fileResult(file_name, raw_response, file_type)

        return entry


    """ OUTPUT BUILDERS """


    @logger
    def build_one_value_parsed_output(**kwargs) -> tuple[dict[str, Any], str]:
        """
        creates a dictionary with a single key for command_results outputs field
        and a markdown table with a single value
        Args:
            **kwargs:
                    command_parse_and_output_data (Dict): Data for parsing and creating output for a specific command
                    handled_result (Dict): response received from Qualys API
        Returns:
            Tuple containing a dictionary with a single key and a markdown table string
        Raises:
            KeyError: will be raised by parse_two_keys_dict if response has unexpected keys
            TypeError: will be raised by  parse_two_keys_dict response is not a dictionary
        """
        command_parse_and_output_data = kwargs["command_parse_and_output_data"]
        collection_name = command_parse_and_output_data.get("collection_name")
        response = kwargs["handled_result"]
        output = parse_two_keys_dict(generate_list_dicts(response[collection_name]))
        output["DATETIME"] = response.get("DATETIME")
        output["TEXT"] = response.get("TEXT")
        readable_output = tableToMarkdown(name=command_parse_and_output_data["table_name"], t=output)
        return output, readable_output


    @logger
    def build_single_text_output(**kwargs) -> tuple[dict[str, Any], str]:
        """
        creates output with the dictionary returned from the request and the text attached to it
        Args:
            **kwargs:
                    handled_result (Dict): response received from Qualys API
        Returns:
                Tuple containing a dictionary and the text returned in the response
        """
        output = kwargs["handled_result"]
        readable_output = output["TEXT"]
        return output, readable_output


    @logger
    def build_unparsed_output(**kwargs) -> tuple[dict[str, Any], str]:
        """
        creates output with the dictionary returned from the request and a markdown table generated
        from the unparsed response received
        Args:
            **kwargs:
                    handled_result (Dict): response received from Qualys API
                    command_parse_and_output_data (Dict): Data for parsing and creating output for a specific command
        Returns:
                Tuple containing a dictionary and a markdown table generated from the response
        """
        command_parse_and_output_data = kwargs["command_parse_and_output_data"]
        unparsed_output = kwargs["handled_result"]
        original_amount = None
        limit_msg = ""

        if "limit" in inner_args_values and isinstance(unparsed_output, list):
            original_amount = len(unparsed_output)
            unparsed_output = limit_result(unparsed_output, inner_args_values["limit"])
        if original_amount and original_amount > int(inner_args_values["limit"]):
            limit_msg = f"Currently displaying {inner_args_values['limit']} out of {original_amount} results."
        readable_output = tableToMarkdown(name=f"{command_parse_and_output_data['table_name']}\n{limit_msg}", t=unparsed_output)

        return unparsed_output, readable_output


    @logger
    def build_ip_list_output(**kwargs) -> tuple[dict[str, List[str]], str]:
        """
        creates output with a new dictionary parsed from the original response and two markdown tables, generated
        for commands which output is a dictionary containing two lists, one of single IPs and the other of ranges of ips.
        Args:
            **kwargs:
                    handled_result (Dict): response received from Qualys API
                    command_parse_and_output_data (Dict): Data for parsing and creating output for a specific command
        Returns:
                Tuple containing a dictionary created and a markdown table generated from the response
        Raises:
                KeyError: can be raised by either change_dict_keys or create_ip_list_dicts
                TypeError: can be raised by either change_dict_keys or create_ip_list_dicts
        """
        command_parse_and_output_data = kwargs["command_parse_and_output_data"]
        handled_result = kwargs["handled_result"]
        readable_output = ""
        original_amount = None
        limit_msg = ""

        if "STATUS" in handled_result:
            readable_output += f'### Current Status: {handled_result["STATUS"]}\n'

        if command_parse_and_output_data["collection_name"] in handled_result:
            asset_collection = handled_result[command_parse_and_output_data["collection_name"]]
            handled_result = change_dict_keys(command_parse_and_output_data["new_names_dict"], asset_collection)

            if "limit" in inner_args_values and inner_args_values["limit"]:
                original_amount = calculate_ip_original_amount(handled_result)
                handled_result = limit_ip_results(handled_result, int(inner_args_values["limit"]))

            if original_amount and original_amount > int(inner_args_values["limit"]):
                limit_msg = f"Currently displaying {inner_args_values['limit']} out of {original_amount} results."

            ip_and_range_list = create_single_host_list(handled_result)
            dicts_of_ranges_and_ips = build_ip_and_range_dicts(ip_and_range_list)
            readable_output = f"{limit_msg}\n"
            readable_output += create_ip_list_markdown_table(dicts_of_ranges_and_ips)

        return handled_result, readable_output


    @logger
    def build_multiple_values_parsed_output(**kwargs) -> tuple[List[Any], str]:
        """
        When the response from Qualys has a list of dictionaries this function will get this list and
        will generate a markdown table from it
        Args:
            **kwargs:
                    handled_result (Dict): response received from Qualys API
                    command_parse_and_output_data (Dict): Data for parsing and creating output for a specific command
        Returns:
                Tuple containing a List of dictionaries parsed from the original response and a markdown table
                generated from the parsed response
        """
        command_parse_and_output_data = kwargs["command_parse_and_output_data"]
        handled_result = kwargs["handled_result"]
        if collection_name := command_parse_and_output_data.get("collection_name"):
            asset_collection = handled_result[collection_name]
        else:
            asset_collection = handled_result
        original_amount = None
        limit_msg = ""
        parsed_output = generate_list_dicts(asset_collection)

        if "limit" in inner_args_values and inner_args_values["limit"] and isinstance(parsed_output, list):
            original_amount = len(parsed_output)
            parsed_output = limit_result(parsed_output, inner_args_values["limit"])

        if original_amount and original_amount > int(inner_args_values["limit"]):
            limit_msg = f"Currently displaying {inner_args_values['limit']} out of {original_amount} results."
        headers = command_parse_and_output_data.get("table_headers") if command_parse_and_output_data.get("table_headers") else None
        readable_output = tableToMarkdown(
            name=f"{command_parse_and_output_data['table_name']}\n{limit_msg}", t=parsed_output, headers=headers
        )
        return parsed_output, readable_output


    @logger
    def build_host_list_detection_outputs(**kwargs) -> tuple[List[Any], str]:
        """
        Builds the outputs and readable output for host list detection.
        Args:
            kwargs: Output builder args.

        Returns:
            (Tuple[List[Any], str]): Outputs and readable outputs.
        """
        command_parse_and_output_data = kwargs["command_parse_and_output_data"]
        handled_result = kwargs["handled_result"]
        if collection_name := command_parse_and_output_data.get("collection_name"):
            asset_collection = handled_result[collection_name]
        else:
            asset_collection = handled_result
        original_amount = None
        limit_msg = ""
        parsed_output = generate_list_dicts(asset_collection)
        parsed_output = parsed_output if isinstance(parsed_output, List) else [parsed_output]
        if "limit" in inner_args_values and inner_args_values["limit"] and isinstance(parsed_output, list):
            original_amount = len(parsed_output)
            parsed_output = limit_result(parsed_output, inner_args_values["limit"])

        if original_amount and original_amount > int(inner_args_values["limit"]):
            limit_msg = f"Currently displaying {inner_args_values['limit']} out of {original_amount} results."
        readable = ""
        for output in parsed_output:
            headers = ["ID", "IP", "DNS_DATA"]
            ip = output.get("IP")
            readable_output = {
                "ID": output.get("ID"),
                "IP": ip,
                "DNS_DATA": {k: v for k, v in output.get("DNS_DATA", {}).items() if v is not None},
            }
            if detections := output.get("DETECTION_LIST", {}).get("DETECTION", []):
                detections = detections if isinstance(detections, List) else [detections]
                for detection in detections:
                    qid = "QID: " + detection.get("QID")
                    headers.append(qid)
                    readable_output[qid] = detection.get("RESULTS")
            readable += tableToMarkdown(f"Host Detection List - {ip}\n{limit_msg}", readable_output, removeNull=True, headers=headers)
        return parsed_output, readable


    @logger
    def build_changed_names_output(**kwargs) -> tuple[List[Any], str]:
        """
        Takes the output and changes the output fields names as described in the command data
        Args:
            **kwargs:
                    handled_result (Dict): response received from Qualys API
                    command_parse_and_output_data (Dict): Data for parsing and creating output for a specific command
        Returns:
                Tuple containing a dictionary and a markdown table generated from the response
        """
        command_parse_and_output_data = kwargs["command_parse_and_output_data"]
        output = kwargs["handled_result"]

        output = change_list_dicts_names(command_parse_and_output_data, output)
        readable_output = tableToMarkdown(name=command_parse_and_output_data["table_name"], t=output)

        return output, readable_output


    @logger
    def build_multiple_text_options_output(**kwargs) -> tuple[None, str]:
        """
        When there's no need to build output from the response but output text is based on command's action requested
        this function will take the text based on the action and will return it
        Args:
            **kwargs:
                    command_parse_and_output_data (Dict): Data for parsing and creating output for a specific command
        Returns:
                Tuple containing None and text based on the action requested
        """
        command_parse_and_output_data = kwargs["command_parse_and_output_data"]
        action = args_values["action"]

        readable_output = command_parse_and_output_data["output_texts"][action]

        return None, readable_output


    @logger
    def build_text_value_pairs_parsed_output(**kwargs) -> tuple[dict[str, Any], str]:
        """
        A command might have multiple key value pairs. The data is returned as a list of dictionaries, each dictionary has
        a key named '@value' which holds the name of the field, and a key named '#text' which holds the
        value of the same field.
        Args:
            **kwargs:
                    handled_result (Dict): response received from Qualys API
                    command_parse_and_output_data (Dict): Data for parsing and creating output for a specific command
        Returns:
            Tuple containing a dictionary created from those key-value pairs and a markdown table as a string
        """
        command_parse_and_output_data = kwargs["command_parse_and_output_data"]
        output = kwargs["handled_result"]

        parsed_output = parse_text_value_pairs_list(output)
        readable_output = tableToMarkdown(name=command_parse_and_output_data["table_name"], t=parsed_output)

        return parsed_output, readable_output


    @logger
    def build_ip_list_from_single_value(**kwargs) -> tuple[dict[str, Any], str]:
        """
        Given a command response that has a value which contains a list of ips in the following format:
        '1.1.1.1','1.1.1.2'
        this function will add each ip separately to the dictionary of results
        Args:
            **kwargs:
                    handled_result (Dict): response received from Qualys API
        Returns:
            Tuple containing a dictionary created from those key-value pairs and a markdown table as a string
        """
        unparsed_output = kwargs["handled_result"]
        readable_output = f"### {unparsed_output['KEY']}\n"
        if unparsed_output["VALUE"]:
            list_of_hosts = unparsed_output["VALUE"].split(",")
            dicts_of_ranges_and_ips = build_ip_and_range_dicts(list_of_hosts)
            readable_output += create_ip_list_markdown_table(dicts_of_ranges_and_ips)
        else:
            readable_output = "No IPs were found"

        return unparsed_output, readable_output


    @logger
    def build_tag_asset_output(**kwargs) -> tuple[List[Any], str]:
        command_parse_and_output_data = kwargs["command_parse_and_output_data"]
        handled_result = kwargs["handled_result"]

        if human_readable_massage := command_parse_and_output_data.get("human_readable_massage"):
            readable_output = human_readable_massage
            return handled_result, readable_output

        if type(handled_result) == dict and (children_list := handled_result.get("children", {}).get("list", {}).get("TagSimple")):
            handled_result["childTags"] = children_list
            handled_result.pop("children")

        readable_output = tableToMarkdown(
            name=command_parse_and_output_data.get("table_name"),
            t=handled_result,
            headers=command_parse_and_output_data.get("table_headers"),
            is_auto_json_transform=True,
            removeNull=True,
            headerTransform=pascalToSpace,
        )
        return handled_result, readable_output


    def get_partial_response(response: str, start: str, end: str):
        """ Cut response string from start to end tokens.
        """
        if start not in response or end not in response:
            return None
        start_index = response.index(start) + len(start)
        end_index = response.index(end)
        result = response[start_index:end_index].strip()
        if result.startswith(WARNING):
            result = result.replace(WARNING, '').strip()
        return result


    def skip_fetch_assets(last_run):
        """ Checks if enough time has passed since the previous run.
        Args:
            last_run: Last run time.
        Returns:
            Returns true or false if enough time has passed since the previous run.
        """
        time_to_check = last_run.get("assets_last_fetch")
        if not time_to_check:
            return False
        passed_minutes = (time.time() - time_to_check) / 60
        if passed_minutes < MIN_ASSETS_INTERVAL:
            demisto.info(f"Skipping fetch-assets command. Only {passed_minutes} minutes have passed since the last fetch. "
                         f"It should be a minimum of 1 hour.")
            return True
        return False


    def csv2json(csv_data: str):
        """ Converts data from csv to json
        Args:
            csv_data: data in csv format
        Returns:
            the same data in json formal
        """
        reader = csv.DictReader(io.StringIO(csv_data))
        json_data = list(reader)
        return json_data


    def get_next_page_from_url(url, field):
        """
        Get the next page field from url.
        """
        match = re.search(rf"{field}=(\d+)", url)
        res = match.group(1) if match else None
        return res


    def get_next_page_activity_logs(footer):
        """
        Extracts the next token from activity logs response.
        """
        if isinstance(footer, list):
            footer = footer[0]
        next_url = footer.get('URL', '')
        max_id = get_next_page_from_url(next_url, 'id_max')
        return max_id


    def handle_host_list_detection_result(raw_response: requests.Response) -> tuple[list, Optional[str]]:
        """
        Handles Host list detection response - parses xml to json and gets the list
        Args:
            raw_response (requests.Response): the raw result received from Qualys API command
        Returns:
            List with data generated for the result given
        """
        formatted_response = parse_raw_response(raw_response)
        simple_response = get_simple_response_from_raw(formatted_response)
        if simple_response and simple_response.get("CODE"):
            raise DemistoException(f"\n{simple_response.get('TEXT')} \nCode: {simple_response.get('CODE')}")

        response_requested_value = dict_safe_get(formatted_response,
                                                 ["HOST_LIST_VM_DETECTION_OUTPUT", "RESPONSE", "HOST_LIST", "HOST"])
        response_next_url = dict_safe_get(formatted_response,
                                          ["HOST_LIST_VM_DETECTION_OUTPUT", "RESPONSE", "WARNING", "URL"], default_return_value='')
        if isinstance(response_requested_value, dict):
            response_requested_value = [response_requested_value]

        return response_requested_value, str(response_next_url)


    def handle_vulnerabilities_result(raw_response: requests.Response) -> list:
        """
        Handles vulnerabilities response - parses xml to json and gets the list
        Args:
            raw_response (requests.Response): the raw result received from Qualys API command
        Returns:
            List with data generated for the result given
        """
        formatted_response = parse_raw_response(raw_response)

        vulnerabilities = dict_safe_get(formatted_response, ['KNOWLEDGE_BASE_VULN_LIST_OUTPUT', 'RESPONSE', 'VULN_LIST', 'VULN'])
        if isinstance(vulnerabilities, dict):
            vulnerabilities = [vulnerabilities]

        return vulnerabilities


    def remove_last_events(events, time_to_remove, time_field):
        """ Removes events with certain time.
            Args:
                events: list of events to remove the time from
                time_to_remove: remove events with this time
                time_field: the field name where the time is
        """
        new_events = []
        for event in events:
            if event.get(time_field) == time_to_remove:
                demisto.debug(f'Removed activity log event with time: {time_to_remove}, log: {event}')
            else:
                new_events.append(event)
        return new_events


    def add_fields_to_events(events, time_field_path, event_type_field):
        """
        Adds the _time key to the events.
        Args:
            events: List[Dict] - list of events to add the _time key to.
            time_field_path: the list of fields to get _time from
            event_type_field: type field in order to distinguish between the API's
        Returns:
            list: The events with the _time key.
        """
        if events:
            for event in events:
                event['_time'] = dict_safe_get(event, time_field_path)
                event['event_type'] = event_type_field


    def get_detections_from_hosts(hosts):
        """
        Parses detections from hosts.
        Each host contains list of detections:
        {'ID':1,
        'IP': '1.1.1.1',
        'LAST_VM_SCANNED_DATE': '01-01-2020',
        'DETECTION_LIST': {'DETECTION': [first_detection_data, second_detection, ...]}
        'additional_fields': ...
        }

        The function parses the data in the following way:
        {''ID':1,
        'IP': '1.1.1.1',
        'LAST_VM_SCANNED_DATE': '01-01-2020',
        'DETECTION': first_detection_data
        'additional_fields': ...
        },
        {'ID':1,
        'IP': '1.1.1.1',
        'LAST_VM_SCANNED_DATE': '01-01-2020',
        'DETECTION': second_detection_data
        'additional_fields': ...
        }
        ....

        :param hosts: list of hosts that contains detections.
        :return: parsed events.
        """
        fetched_events = []
        for host in hosts:
            if detections_list := host.get('DETECTION_LIST', {}).get('DETECTION'):
                if isinstance(detections_list, list):
                    for detection in detections_list:
                        new_detection = copy.deepcopy(host)
                        del new_detection['DETECTION_LIST']
                        new_detection['DETECTION'] = detection
                        fetched_events.append(new_detection)
                elif isinstance(detections_list, dict):
                    new_detection = copy.deepcopy(host)
                    new_detection['DETECTION'] = detections_list
                    del new_detection['DETECTION_LIST']
                    fetched_events.append(new_detection)
            else:
                del host['DETECTION_LIST']
                host['DETECTION'] = {}
                fetched_events.append(host)
        return fetched_events


    def get_activity_logs_events(client, since_datetime, max_fetch, next_page=None) -> tuple[Optional[list], dict]:
        """ Get logs activity from qualys
        API response returns events sorted in descending order. We are saving the next_page param and
        sending next request with next_page arg if needed. Saving the newest event fetched.
        We are deleting the newest event each time to avoid duplication.
        Args:
            client: Qualys client
            since_datetime: datetime to get events from
            max_fetch: max number of events to return
            next_page: pagination marking
        Returns:
            Logs activity events, Next run datetime
        """
        demisto.debug(f'Starting to fetch activity logs events: since_datetime={since_datetime}, next_page={next_page}')
        activity_logs = client.get_user_activity_logs(since_datetime=since_datetime, max_fetch=max_fetch, next_page=next_page)
        activity_logs_events = csv2json(get_partial_response(activity_logs, BEGIN_RESPONSE_LOGS_CSV,
                                                             END_RESPONSE_LOGS_CSV) or activity_logs) or []
        footer_json = csv2json(get_partial_response(activity_logs, BEGIN_RESPONSE_FOOTER_CSV,
                                                    END_RESPONSE_FOOTER_CSV)) or {}
        new_next_page = get_next_page_activity_logs(footer_json)
        demisto.debug(f'Got activity logs events from server: {len(activity_logs_events)=}.')

        newest_event_time = activity_logs_events[0].get('Date') if activity_logs_events else since_datetime

        if not next_page:
            activity_logs_events = remove_last_events(activity_logs_events, newest_event_time, 'Date')
        add_fields_to_events(activity_logs_events, ['Date'], 'activity_log')

        next_run_dict = {
            ACTIVITY_LOGS_NEWEST_EVENT_DATETIME: newest_event_time,
            ACTIVITY_LOGS_NEXT_PAGE: new_next_page,
            ACTIVITY_LOGS_SINCE_DATETIME_PREV_RUN: since_datetime,
        }
        demisto.debug(f'Done to fetch activity logs events: {next_run_dict=}, sending {len(activity_logs_events)} events.')
        return activity_logs_events, next_run_dict


    def get_host_list_detections_events(client, since_datetime) -> list:
        """ Get host list detections from qualys
        Args:
            client: Qualys client
            since_datetime: The start fetch date.
        Returns:
            Host list detections assets
        """
        demisto.debug('Starting to fetch assets')
        assets = []  # type: ignore[var-annotated]
        next_page = ''

        while True:
            host_list_detections = client.get_host_list_detection(since_datetime, next_page=next_page)
            host_list_assets, next_url = handle_host_list_detection_result(host_list_detections) or []
            assets += host_list_assets
            next_page = get_next_page_from_url(next_url, 'id_min')
            if not next_page:
                break

        edited_host_detections = get_detections_from_hosts(assets)
        demisto.debug(f'Parsed detections from hosts, got {len(edited_host_detections)=} assets.')

        add_fields_to_events(edited_host_detections, ['DETECTION', 'FIRST_FOUND_DATETIME'], 'host_list_detection')

        return edited_host_detections


    def get_vulnerabilities(client, since_datetime) -> list:
        """ Get vulnerabilities list from qualys
        Args:
            client: Qualys client
            since_datetime: The start fetch date.
        Returns:
            list vulnerabilities
        """
        demisto.debug('Starting to fetch vulnerabilities')
        host_list_detections = client.get_vulnerabilities(since_datetime)
        vulnerabilities = handle_vulnerabilities_result(host_list_detections) or []

        demisto.debug(f'Parsed detections from hosts, got {len(vulnerabilities)=} vulnerabilities.')
        return vulnerabilities


    def fetch_assets(client, since_datetime=None):
        """ Fetches host list detections
        Args:
            client: command client
            since_datetime: The start fetch date.
        Return:
            assets: assets to push to xsiam
            vulnerabilities: vulnerabilities to push to xsiam
        """
        demisto.debug('Starting fetch for assets')
        if not since_datetime:
            since_datetime = arg_to_datetime(ASSETS_FETCH_FROM).strftime(ASSETS_DATE_FORMAT)  # type: ignore[union-attr]

        assets = get_host_list_detections_events(client, since_datetime)
        vulnerabilities = get_vulnerabilities(client, since_datetime)

        demisto.info(f"Pulled {len(assets)} assets, and {len(vulnerabilities)} vulnerabilities from API, sending them to XSIAM")
        return assets, vulnerabilities


    def fetch_events(client, last_run, first_fetch_time, fetch_function, newest_event_field, next_page_field,
                     previous_run_time_field, max_fetch: Optional[int] = 0):
        """ Fetches activity logs and host list detections
        Args:
            client: command client
            last_run: last fetch time
            first_fetch_time: when start to fetch from
            fetch_function: function that gets the events
            max_fetch: max number of items to return (0 to return all)
            newest_event_field
            next_page_field
            previous_run_time_field
        Return:
            next_last_run: where to fetch from next time
            event: events to push to xsiam
        """
        demisto.debug(f'Starting fetch for {fetch_function.__name__}, last run: {last_run}')
        newest_event_time = last_run.get(newest_event_field) if last_run else None
        next_page = last_run.get(next_page_field)
        previous_time_field = last_run.get(previous_run_time_field)

        if not newest_event_time:
            newest_event_time = first_fetch_time

        time_to_fetch = newest_event_time if not next_page else previous_time_field

        events, new_next_run = fetch_function(client, time_to_fetch, max_fetch, next_page)

        updated_next_run = {previous_run_time_field: time_to_fetch}
        new_next_page = new_next_run.get(next_page_field)

        # if the fetch is not during the pagination (fetched without next_page)
        if not next_page:
            # update the newest event
            updated_next_run[newest_event_field] = new_next_run.get(newest_event_field)

        # update if there is next page and this fetch is not over
        updated_next_run[next_page_field] = new_next_page

        if last_fetch_time := new_next_run.get(HOST_LAST_FETCH):
            updated_next_run[HOST_LAST_FETCH] = last_fetch_time

        demisto.info(f"Sending len{len(events)} to XSIAM. updated_next_run={updated_next_run}.")
        return updated_next_run, events


    def get_activity_logs_events_command(client, args, first_fetch_time):
        """
        Args:
            client: command client
            args: Demisto args for this command: limit and since_datetime
            first_fetch_time: first fetch time
        Retuns:
            Command results with activity logs

        """
        limit = arg_to_number(args.get('limit', 50))
        offset = arg_to_number(args.get('offset', 0))
        since_datetime = arg_to_datetime(args.get('since_datetime'))
        since_datetime = since_datetime.strftime(DATE_FORMAT) if since_datetime else first_fetch_time
        activity_logs_events, _ = get_activity_logs_events(
            client=client,
            since_datetime=since_datetime,
            max_fetch=0,
        )
        limited_activity_logs_events = activity_logs_events[offset:limit + offset]  # type: ignore[index,operator]
        activity_logs_hr = tableToMarkdown(name='Activity Logs', t=limited_activity_logs_events)
        results = CommandResults(
            readable_output=activity_logs_hr,
            raw_response=limited_activity_logs_events,
        )

        return limited_activity_logs_events, results


    def test_module(client: Client, params: dict[str, Any], first_fetch_time: str) -> str:
        """
        Tests API connectivity and authentication'
        When 'ok' is returned it indicates the integration works like it is supposed to and connection to the service is
        successful.
        Raises exceptions if something goes wrong.
        Args:
            client (Client): HelloWorld client to use.
            params (Dict): Integration parameters.
            first_fetch_time (int): The first fetch time as configured in the integration params.
        Returns:
            str: 'ok' if test passed, anything else will raise an exception and will fail the test.
        """
        is_fetch_events = params.get('isFetchEvents') or False
        is_fetch_assets = params.get('isFetchAssets') or False

        if is_fetch_assets or is_fetch_events:
            if is_fetch_events:
                fetch_events(
                    client=client,
                    last_run={},
                    first_fetch_time=first_fetch_time,
                    max_fetch=1,
                    fetch_function=get_activity_logs_events,
                    newest_event_field=ACTIVITY_LOGS_NEWEST_EVENT_DATETIME,
                    next_page_field=ACTIVITY_LOGS_NEXT_PAGE,
                    previous_run_time_field=ACTIVITY_LOGS_SINCE_DATETIME_PREV_RUN,
                )
            if is_fetch_assets:
                since_datetime = arg_to_datetime('3 days').strftime(ASSETS_DATE_FORMAT)  # type: ignore[union-attr]
                fetch_assets(client=client, since_datetime=since_datetime)
        else:
            build_args_dict({'launched_after_datetime': TEST_FROM_DATE}, COMMANDS_ARGS_DATA["test-module"], False)
            client.command_http_request(COMMANDS_API_DATA["test-module"])

        return 'ok'


    @logger
    def qualys_command_flow_manager(
        client: Client, args: dict[str, str], command_name: str, command_methods: dict[str, Callable]
    ) -> Optional[CommandResults]:
        """
        Args:
            client: Client object for making a http request
            args: Dictionary of the arguments entered by the user for the command
            command_name: string of the command name
            command_methods: Dictionary of handler and output builder of the specific command
        Returns:
            Results received by the command or None if it's a file download
        Raises:
            DemistoException: will be raised when request to Qualys API failed
        """

        # handle asset tag command parameters for HTTP request
        if command_name in TAG_ASSET_COMMANDS_API_DATA:

            handle_asset_tag_request_parameters(args, command_name)

            # args_values is passed in this code as 'params' in _http_request function (generated in build_args_dict function).
            # because asset tag requests pass their arguments through request body rather than parameters in the URL suffix,
            # args_values is Nulled in this case.
            result = client.command_http_request(TAG_ASSET_COMMANDS_API_DATA[command_name])
        else:
            # Build the API and internal arguments of the command
            build_args_dict(args, COMMANDS_ARGS_DATA[command_name], False)
            build_args_dict(args, COMMANDS_ARGS_DATA[command_name], True)

            # Validate input provided by the user
            input_validation(command_name)

            # Make an API request
            result = client.command_http_request(COMMANDS_API_DATA[command_name])

        # Call the command's handler
        handled_result = command_methods["result_handler"](result, command_name)

        if command_methods.get("output_builder"):
            if is_empty_result(handled_result):
                return CommandResults(raw_response=result, readable_output="No items found")

            # Call the command's output builder
            outputs, readable_output = command_methods["output_builder"](
                handled_result=handled_result, command_parse_and_output_data=COMMANDS_PARSE_AND_OUTPUT_DATA[command_name]
            )
            if not COMMANDS_CONTEXT_DATA[command_name]["context_prefix"]:
                outputs, result = None, None
            return CommandResults(
                outputs_prefix=COMMANDS_CONTEXT_DATA[command_name]["context_prefix"],
                outputs_key_field=COMMANDS_CONTEXT_DATA[command_name]["context_key"],
                outputs=outputs,
                raw_response=result,
                readable_output=readable_output,
            )
        else:
            # No need to build output
            return handled_result


    """ MAIN FUNCTION """


    def main():  # pragma: no cover
        params = demisto.params()
        args = demisto.args()
        command = demisto.command()

        base_url = params.get('url')
        verify_certificate = not params.get("insecure", False)
        proxy = params.get("proxy", False)
        username = params.get("credentials").get("identifier")
        password = params.get("credentials").get("password")

        commands_methods: dict[str, dict[str, Callable]] = {
            # *** Commands with unparsed response as output ***
            "qualys-purge-scan-host-data": {
                "result_handler": handle_general_result,
                "output_builder": build_unparsed_output,
            },
            "qualys-pc-scan-launch": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            "qualys-pc-scan-manage": {
                "result_handler": handle_general_result,
                "output_builder": build_unparsed_output,
            },
            "qualys-ip-restricted-list": {
                "result_handler": handle_general_result,
                "output_builder": build_ip_list_output,
            },
            "qualys-host-excluded-manage": {
                "result_handler": handle_general_result,
                "output_builder": build_ip_list_from_single_value,
            },
            "qualys-report-template-list": {
                "result_handler": handle_general_result,
                "output_builder": build_unparsed_output,
            },
            "qualys-virtual-host-manage": {
                "result_handler": handle_general_result,
                "output_builder": build_unparsed_output,
            },
            # *** Commands with key value pair as output ***
            "qualys-report-cancel": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-report-delete": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-scorecard-launch": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-scheduled-report-launch": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-report-launch-map": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-report-launch-scan-based-findings": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-report-launch-host-based-findings": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-report-launch-patch": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-report-launch-remediation": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-report-launch-compliance": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-report-launch-compliance-policy": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-asset-group-add": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-asset-group-edit": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-asset-group-delete": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-schedule-scan-create": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-schedule-scan-update": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            "qualys-schedule-scan-delete": {
                "result_handler": handle_general_result,
                "output_builder": build_one_value_parsed_output,
            },
            # *** Commands which need parsing with multiple values ***
            "qualys-report-list": {
                "result_handler": handle_report_list_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            "qualys-vm-scan-list": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            "qualys-vm-scan-launch": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            "qualys-scap-scan-list": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            "qualys-pc-scan-list": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            "qualys-schedule-scan-list": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            "qualys-host-list": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            "qualys-virtual-host-list": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            "qualys-vulnerability-list": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            "qualys-group-list": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            "qualys-scheduled-report-list": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            "qualys-time-zone-code": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_values_parsed_output,
            },
            # *** Commands with no output ***
            "qualys-report-fetch": {
                "result_handler": handle_fetch_result,
            },
            # *** Commands with a single text as output ***
            "qualys-ip-restricted-manage": {
                "result_handler": handle_general_result,
                "output_builder": build_single_text_output,
            },
            "qualys-ip-add": {
                "result_handler": handle_general_result,
                "output_builder": build_single_text_output,
            },
            "qualys-ip-update": {
                "result_handler": handle_general_result,
                "output_builder": build_single_text_output,
            },
            "qualys-host-update": {
                "result_handler": handle_general_result,
                "output_builder": build_single_text_output,
            },
            "qualys-update-unix-record": {
                "result_handler": handle_general_result,
                "output_builder": build_single_text_output,
            },
            # *** Commands that have lists of ips as outputs ***
            "qualys-ip-list": {
                "result_handler": handle_general_result,
                "output_builder": build_ip_list_output,
            },
            "qualys-host-excluded-list": {
                "result_handler": handle_general_result,
                "output_builder": build_ip_list_output,
            },
            # *** Commands with multiple @value and #text as output ***
            "qualys-pc-scan-fetch": {
                "result_handler": handle_general_result,
                "output_builder": build_text_value_pairs_parsed_output,
            },
            # *** Commands with multiple pre-made text options as output ***
            "qualys-vm-scan-action": {
                "result_handler": handle_general_result,
                "output_builder": build_multiple_text_options_output,
            },
            # *** Commands that need a change of the key names ***
            "qualys-vm-scan-fetch": {
                "result_handler": handle_general_result,
                "output_builder": build_changed_names_output,
            },
            # *** Host List Detection
            "qualys-host-list-detection": {
                "result_handler": handle_general_result,
                "output_builder": build_host_list_detection_outputs,
            },
            # *** Tag related commands ***
            "qualys-asset-tag-list": {
                "result_handler": handle_asset_tag_result,
                "output_builder": build_tag_asset_output,
            },
            "qualys-asset-tag-create": {
                "result_handler": handle_asset_tag_result,
                "output_builder": build_tag_asset_output,
            },
            "qualys-asset-tag-update": {
                "result_handler": handle_asset_tag_result,
                "output_builder": build_tag_asset_output,
            },
            "qualys-asset-tag-delete": {
                "result_handler": handle_asset_tag_result,
                "output_builder": build_tag_asset_output,
            },
            "qualys-update-vmware-record": {
                "result_handler": handle_asset_tag_result,
                "output_builder": build_single_text_output,
            },
            "qualys-update-vcenter-record": {
                "result_handler": handle_asset_tag_result,
                "output_builder": build_single_text_output,
            },
            "qualys-vcenter-esxi-mapped-record-list": {
                "result_handler": handle_general_result,
                "output_builder": build_unparsed_output,
            },
            "qualys-vcenter-esxi-mapped-record-import": {
                "result_handler": handle_asset_tag_result,
                "output_builder": build_single_text_output,
            },
            "qualys-vcenter-esxi-mapped-record-purge": {
                "result_handler": handle_asset_tag_result,
                "output_builder": build_single_text_output,
            },
        }

        demisto.debug(f"Command being called is {command}")
        try:
            headers: dict = {"X-Requested-With": "Cortex"}
            client = Client(
                base_url=base_url, username=username, password=password, verify=verify_certificate, headers=headers, proxy=proxy
            )

            first_fetch_datetime: datetime = arg_to_datetime(  # type: ignore[assignment]
                arg=params.get('first_fetch', '3 days'),
                arg_name='First fetch time',
                required=True
            )
            first_fetch_str = first_fetch_datetime.strftime(DATE_FORMAT)

            if command == "test-module":
                text_res = test_module(client, params, first_fetch_str)
                return_results(text_res)

            elif command == "qualys-get-events":
                should_push_events = argToBoolean(args.get('should_push_events', False))
                events, results = get_activity_logs_events_command(client, args, first_fetch_str)
                return_results(results)
                if should_push_events:
                    send_events_to_xsiam(events, vendor=VENDOR, product=PRODUCT)

            elif command == "qualys-get-assets":
                should_push_events = argToBoolean(args.get('should_push_assets', False))
                assets, vulnerabilities = fetch_assets(client=client)
                return_results(f'Pulled {len(assets)} assets, and {len(vulnerabilities)} vulnerabilities from API')
                if should_push_events:
                    send_data_to_xsiam(data=assets, vendor=VENDOR, product='host_detections', data_type='assets')
                    send_data_to_xsiam(data=vulnerabilities, vendor=VENDOR, product='vulnerabilities', data_type='assets')

            elif command == 'fetch-events':
                last_run = demisto.getLastRun()
                max_fetch_activity_logs = arg_to_number(params.get("max_fetch_activity_logs", 0))
                logs_next_run, activity_logs_events = fetch_events(
                    client=client,
                    last_run=last_run,
                    newest_event_field=ACTIVITY_LOGS_NEWEST_EVENT_DATETIME,
                    next_page_field=ACTIVITY_LOGS_NEXT_PAGE,
                    previous_run_time_field=ACTIVITY_LOGS_SINCE_DATETIME_PREV_RUN,
                    fetch_function=get_activity_logs_events,
                    first_fetch_time=first_fetch_str,
                    max_fetch=max_fetch_activity_logs,
                )
                send_events_to_xsiam(activity_logs_events, vendor=VENDOR, product=PRODUCT)

                # saves next_run for the time fetch-events is invoked
                demisto.setLastRun(logs_next_run)

            elif command == 'fetch-assets':
                assets_last_run = demisto.getAssetsLastRun()
                demisto.debug(f'saved lastrun assets: {assets_last_run}')
                if skip_fetch_assets(assets_last_run):
                    return
                execution_start_time = time.time()
                assets, vulnerabilities = fetch_assets(client=client)
                send_data_to_xsiam(data=assets, vendor=VENDOR, product='assets', data_type='assets')
                send_data_to_xsiam(data=vulnerabilities, vendor=VENDOR, product='vulnerabilities', data_type='assets')
                demisto.setAssetsLastRun({'assets_last_fetch': execution_start_time})

            else:
                return_results(
                    qualys_command_flow_manager(client, demisto.args(), command, commands_methods[command])
                )

        except Exception as e:
            demisto.error(traceback.format_exc())  # print the traceback
            return_error(f"Failed to execute {command} command.\nError:\n{str(e)}")


    if __name__ in ("__main__", "__builtin__", "builtins"):
        main()

    register_module_line('QualysV2', 'end', __line__())
  subtype: python3
  type: python
system: true
