contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 5aaa0bc6-781d-4216-8678-5830391bf6e2
inputs:
- description: ""
  key: IP
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: IP
      root: ExtractedIndicators
      transformers:
      - operator: uniq
- description: ""
  key: Domain
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Domain
      root: ExtractedIndicators
- description: ""
  key: Hash
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: File
      root: ExtractedIndicators
- description: ""
  key: IP Address
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: IP
      root: Address2
name: TCS-Recorded Future IOC Enrichment Playbook v 1.1_KK
outputs:
- contextPath: ExtractedIndicators.IP
  description: IP address
- contextPath: DBotScore
  description: DBot Score
  type: unknown
- contextPath: ExtractedIndicators.Domain
  description: Domain
- contextPath: ExtractedIndicators.File
  description: Hash
  type: unknown
- contextPath: Address2.IP
  description: Non Customer IP Address
  type: unknown
sourceplaybookid: 08c3b260-77a7-4316-8c5d-802cc55f4e22
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 21cdeec2-46bd-4231-8f09-6394b8a500e4
      iscommand: false
      name: ""
      version: -1
    taskid: 21cdeec2-46bd-4231-8f09-6394b8a500e4
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 028fa17b-0117-4055-8195-0e30551a1a2f
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 028fa17b-0117-4055-8195-0e30551a1a2f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2700
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address2.IP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether the playbook's input contains at least one IP
        address.
      id: ba690319-c3ee-46ab-8106-9518ac292044
      iscommand: false
      name: Are there any IP addresses ?
      type: condition
      version: -1
    taskid: ba690319-c3ee-46ab-8106-9518ac292044
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 180,
          "y": 390
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Recorded Future v2
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is an active instance of the ThreatCrowd integration
        enabled.
      id: 9f760171-82df-4e84-8494-584814ca3288
      iscommand: false
      name: Is Recorded Future enabled?
      type: condition
      version: -1
    taskid: 9f760171-82df-4e84-8494-584814ca3288
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
  "11":
    continueonerror: true
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: Address2
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets a quick indicator of the risk associated with an IP address.
      id: 0714a3d0-0fce-42b6-821a-dfe9463a1941
      iscommand: true
      name: Get IP Report From Recorded Future
      script: Recorded Future v2.1|||ip
      type: regular
      version: -1
    taskid: 0714a3d0-0fce-42b6-821a-dfe9463a1941
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 565
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether the playbook's input contains at least one IP
        address.
      id: 0ecf18fc-62f3-4f2f-84a6-f81768f546a2
      iscommand: false
      name: Are there any Domains ?
      type: condition
      version: -1
    taskid: 0ecf18fc-62f3-4f2f-84a6-f81768f546a2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1080
        }
      }
  "38":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.File
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether the playbook's input contains at least one IP
        address.
      id: daa7144d-1d56-45b1-8293-1386151c85f6
      iscommand: false
      name: Are there any Hash Values ?
      type: condition
      version: -1
    taskid: daa7144d-1d56-45b1-8293-1386151c85f6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1790
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      entity:
        complex:
          accessor: IP
          root: Address2
      entity_type:
        simple: ip
      fetch_related_entities:
        simple: "yes"
      fetch_riskyCIDRips:
        simple: "yes"
      using:
        simple: Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL or File.
      id: df0e76de-a065-415f-8bb8-a4ae2d18c545
      iscommand: true
      name: Get Intel Report
      script: Recorded Future v2|||recordedfuture-intelligence
      type: regular
      version: -1
    taskid: df0e76de-a065-415f-8bb8-a4ae2d18c545
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 895
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      entity:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      entity_type:
        simple: domain
      fetch_related_entities:
        simple: "yes"
      fetch_riskyCIDRips:
        simple: "yes"
      using:
        simple: Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL or File.
      id: 5693cc39-d5b9-414d-8696-be9dab812f55
      iscommand: true
      name: Get Intel Report
      script: Recorded Future v2|||recordedfuture-intelligence
      type: regular
      version: -1
    taskid: 5693cc39-d5b9-414d-8696-be9dab812f55
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1595
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      entity:
        complex:
          accessor: File
          root: ExtractedIndicators
      entity_type:
        simple: file
      fetch_related_entities:
        simple: "yes"
      fetch_riskyCIDRips:
        simple: "yes"
      using:
        simple: Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL or File.
      id: 809a22bf-b4a7-4988-8405-119f27bcb7b1
      iscommand: true
      name: Get Intel Report
      script: Recorded Future v2|||recordedfuture-intelligence
      type: regular
      version: -1
    taskid: 809a22bf-b4a7-4988-8405-119f27bcb7b1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2295
        }
      }
  "43":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: get ioc risk score
        - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: ioc risk score
        - left:
            iscontext: true
            value:
              complex:
                accessor: type
                root: incident
          operator: isEqualString
          right:
            value:
              simple: IOC Risk Score
        - left:
            iscontext: true
            value:
              complex:
                accessor: type
                root: incident
          operator: containsString
          right:
            value:
              simple: ioc risk score
      label: "yes"
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 51cbdbbb-61e9-4ce0-896e-4ae1ee879061
      iscommand: false
      name: Is This a Risk Score Request ?
      type: condition
      version: -1
    taskid: 51cbdbbb-61e9-4ce0-896e-4ae1ee879061
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 720
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: get ioc risk score
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9cb82d90-97e2-4d00-8e86-d3ea35ce9744
      iscommand: false
      name: Is This a Risk Score Request ?
      type: condition
      version: -1
    taskid: 9cb82d90-97e2-4d00-8e86-d3ea35ce9744
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 2120
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: get ioc risk score
      label: "yes"
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f3e774cc-528a-4bb4-8df0-f27e34103091
      iscommand: false
      name: Is This a Risk Score Request ?
      type: condition
      version: -1
    taskid: f3e774cc-528a-4bb4-8df0-f27e34103091
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1420
        }
      }
  "46":
    continueonerror: true
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        complex:
          accessor: File
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets a quick indicator of the risk associated with a file.
      id: 53f04ead-46ac-4b68-8cb4-27a377c90bf7
      iscommand: true
      name: Get Hash Report From Recorded Future
      script: Recorded Future v2.1|||file
      type: regular
      version: -1
    taskid: 53f04ead-46ac-4b68-8cb4-27a377c90bf7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1960
        }
      }
  "47":
    continueonerror: true
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      retry-count:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets a quick indicator of the risk associated with a domain.
      id: ceb550e7-0ec9-4e6e-88d6-da478c34123f
      iscommand: true
      name: Get Domain Report From Recorded Future
      script: Recorded Future v2.1|||domain
      type: regular
      version: -1
    taskid: ceb550e7-0ec9-4e6e-88d6-da478c34123f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1260
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "34_47_yes": 0.5,
      "38_46_yes": 0.48,
      "43_40_#default#": 0.39,
      "7_34_#default#": 0.22
    },
    "paper": {
      "dimensions": {
        "height": 2715,
        "width": 605,
        "x": 50,
        "y": 50
      }
    }
  }
