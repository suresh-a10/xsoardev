contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
hidden: true
id: 3b91bfd9-6532-497a-8520-15cfcba1656a
inputs:
- description: ""
  key: Domain
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Domain
      root: ExtractedIndicators
name: TCS-Domain Owner Verification  v3.2
outputs:
- contextPath: ExtractedIndicators.Domain
  description: Domain
  type: unknown
sourceplaybookid: 10a892d4-e4b5-4b5e-80ea-dcaccb53541a
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7ef5270c-8a1b-4c4e-84f4-c8cf99e18619
      iscommand: false
      name: ""
      version: -1
    taskid: 7ef5270c-8a1b-4c4e-84f4-c8cf99e18619
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -210,
          "y": -170
        }
      }
  "3":
    continueonerror: true
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
      "yes":
      - "7"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.TCS_Customer_Domain_List}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 02507349-0193-43a2-8760-040cb7bcf149
      iscommand: false
      name: Does Domain Belong To Customer ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 02507349-0193-43a2-8760-040cb7bcf149
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -670,
          "y": 320
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain4.Customer
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 626b60ac-af50-4f0e-87b2-9f7ec53d14e9
      iscommand: false
      name: Set Customer Domain into Context
      script: Set
      type: regular
      version: -1
    taskid: 626b60ac-af50-4f0e-87b2-9f7ec53d14e9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 550
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain3
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9d1b7e6c-071d-4353-8c4f-986374c1c3c6
      iscommand: false
      name: Set Output into Context
      script: Set
      type: regular
      version: -1
    taskid: 9d1b7e6c-071d-4353-8c4f-986374c1c3c6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": 550
        }
      }
  "11":
    continueonerror: true
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "no":
      - "10"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.TCS_Customer_Domain_List}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 2e1aaaa8-a71b-471d-83a2-b2ebf8d6bd8b
      iscommand: false
      name: Does Domain Belong To TCS or Customer ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 2e1aaaa8-a71b-471d-83a2-b2ebf8d6bd8b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -210,
          "y": 320
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      attachIDs:
        simple: ${.=val.File.filter(function(f){return f.EntryID;}).reduce(function(acc,
          f) {return f;}, null).EntryID}
      body:
        simple: "Hello Human,\n\nI found Internal/Customer Domain in this file ${incident.attachment.name}.
          \nPFA Risk Score report.\n\nInternal/Customer Domain:\n\n${Domain4.Customer}\n\n\nRegards,\nCSOC
          CyberAutoBot"
      subject:
        simple: Found Internal/Customer Domain In This File ${incident.attachment.name}
      to:
        complex:
          accessor: labels.Email/from
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: bc4aef42-30a9-452d-87e8-624ea1b1f0a8
      iscommand: true
      name: Send Email Notification That Internal/Customer Domain Found
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: bc4aef42-30a9-452d-87e8-624ea1b1f0a8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1500
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e985931c-ccaa-40dd-86a6-4a51cb296cef
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: e985931c-ccaa-40dd-86a6-4a51cb296cef
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1905
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6d55f93f-014d-4e6f-8031-5ea94ff92522
      iscommand: false
      name: Generate Report & Notify
      type: title
      version: -1
    taskid: 6d55f93f-014d-4e6f-8031-5ea94ff92522
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -200,
          "y": 930
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain4.Customer
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
          operator: isEqualString
          right:
            value:
              simple: Check For Trusted IOC
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d8ae6227-180b-490c-8a79-20c4182b9c88
      iscommand: false
      name: Verify There Are No Customer Domain In The List ?
      type: condition
      version: -1
    taskid: d8ae6227-180b-490c-8a79-20c4182b9c88
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 1290
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI did not find any customer domain in this file ${incident.attachment.name}\n\n\nRegards,\nCSOC
          CyberAutoBot "
      subject:
        simple: No Customer Domain Found In This File ${incident.attachment.name}
      to:
        complex:
          accessor: labels.Email/from
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 2ca941bc-9f56-4ecf-80a7-8c8f6981650c
      iscommand: true
      name: Send Email Notification That No Customer Domain Found
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 2ca941bc-9f56-4ecf-80a7-8c8f6981650c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 1500
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${Domain4.Customer}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: 0de565a7-b940-4bbd-8130-c1be1b84e236
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2|||domain
      type: regular
      version: -1
    taskid: 0de565a7-b940-4bbd-8130-c1be1b84e236
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 750
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${RecordedFuture.Domain}
      fileName:
        simple: Domain Risk Score.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: de787209-e25a-4e43-8e70-05557eed1e33
      iscommand: false
      name: Generate CSV Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: de787209-e25a-4e43-8e70-05557eed1e33
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1080
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: RecordedFuture
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "35"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 526e3a4a-47fa-4a4f-8378-120026432a1d
      iscommand: false
      name: Is There a Report To Generate
      type: condition
      version: -1
    taskid: 526e3a4a-47fa-4a4f-8378-120026432a1d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 1080
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: IOC,Risk Score
      context_path:
        simple: RecordedFuture.IP
      grid_id:
        simple: recordedfutureriskscore
      keys:
        simple: name,riskScore
      overwrite:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a Grid table from items or key-value pairs.
      id: 554e6924-34db-4a95-8a84-20868da649da
      iscommand: false
      name: Populate The Risk Grid
      script: SetGridField
      type: regular
      version: -1
    taskid: 554e6924-34db-4a95-8a84-20868da649da
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -640,
          "y": 1080
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Domain2
      value:
        complex:
          accessor: Domain
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e7d6498e-fee1-48e7-8495-1b46f47f5bc0
      iscommand: false
      name: Set Domain In New Context For DeDup
      script: Set
      type: regular
      version: -1
    taskid: e7d6498e-fee1-48e7-8495-1b46f47f5bc0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 240,
          "y": 120
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Domain2
      value:
        complex:
          accessor: Domain_Test_
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 22c155e7-91ad-4ab3-8978-bc7a149788e4
      iscommand: false
      name: Set Unique Domain In New Context
      script: Set
      type: regular
      version: -1
    taskid: 22c155e7-91ad-4ab3-8978-bc7a149788e4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 120
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators2.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain2
              operator: notContainsGeneral
              right:
                value:
                  simple: www.
          - - left:
                iscontext: true
                value:
                  simple: Domain2
              operator: notContainsGeneral
              right:
                value:
                  simple: /
          root: Domain2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5c27da8b-902e-4bc8-8a9c-e847d8fac206
      iscommand: false
      name: Set New Unique Domains Into Extracted Indicators
      script: Set
      type: regular
      version: -1
    taskid: 5c27da8b-902e-4bc8-8a9c-e847d8fac206
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 120
        }
      }
  "58":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "54"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e451ce4d-30f7-474e-8b75-b4f402024ae8
      iscommand: false
      name: Are there any Domains ?
      type: condition
      version: -1
    taskid: e451ce4d-30f7-474e-8b75-b4f402024ae8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -210,
          "y": 120
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: ce39fa52-5965-494d-83be-7c5f3e4c8027
      iscommand: false
      name: Delete Extracted Indicators Domain Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: ce39fa52-5965-494d-83be-7c5f3e4c8027
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 220,
          "y": 550
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          root: Domain3
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6b12bc46-9d30-48ff-8353-862c030314f5
      iscommand: false
      name: Set New Unique Domains Into Extracted Indicators
      script: Set
      type: regular
      version: -1
    taskid: 6b12bc46-9d30-48ff-8353-862c030314f5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": 750
        }
      }
  "61":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain4.Customer
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ada9f53c-5c26-44e4-83c2-1e5f5195eb16
      iscommand: false
      name: Is There a Internal/Customer Domain ?
      type: condition
      version: -1
    taskid: ada9f53c-5c26-44e4-83c2-1e5f5195eb16
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1290
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2140,
        "width": 2160,
        "x": -670,
        "y": -170
      }
    }
  }
