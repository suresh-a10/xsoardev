args:
- description: entryID for telemetry log
  name: entryID
comment: Read Telemtry log
commonfields:
  id: HealthCheckReadTemeletryLog
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 2.1.3
    packID: HealthCheck
    packName: System Diagnostics and Health Check
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
dockerimage: demisto/python3:3.10.14.100715
enabled: true
engineinfo: {}
mainengineinfo: {}
name: HealthCheckReadTemeletryLog
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  register_module_line('HealthCheckReadTemeletryLog', 'start', __line__())
  demisto.debug('pack name = System Diagnostics and Health Check, pack version = 2.1.3')




  res = demisto.executeCommand('getFilePath', {'id': demisto.args().get('entryID')})
  if res[0]['Type'] == entryTypes['error']:
      demisto.executeCommand("setIncident", {'xsoartelemetrystatus': 'Not Enabled'})
      demisto.results('File not found')
  else:
      try:
          with open(res[0]['Contents']['path'], 'r') as file:

              if 'notelemetry' in file.read():
                  demisto.executeCommand("setIncident", {'xsoartelemetrystatus': 'Not Enabled'})
              else:
                  demisto.executeCommand("setIncident", {'xsoartelemetrystatus': 'Enabled'})

      except ValueError:
          demisto.results('Unable to read file.')

  register_module_line('HealthCheckReadTemeletryLog', 'end', __line__())
scripttarget: 0
subtype: python3
system: true
tags: []
type: python
