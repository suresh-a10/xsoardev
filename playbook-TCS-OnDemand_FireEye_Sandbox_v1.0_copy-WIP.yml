contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
hidden: true
id: db1630c2-20c1-4b15-8df6-abe08ff5da1d
inputs: []
name: TCS-OnDemand FireEye Sandbox v1.0_copy-WIP
outputs: []
sourceplaybookid: 59c34b62-e11e-4b22-8844-c1d11e5d7a0a
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fad10c9b-aa01-4677-8cdb-44af07d618dd
      iscommand: false
      name: ""
      version: -1
    taskid: fad10c9b-aa01-4677-8cdb-44af07d618dd
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 50,
          "y": -650
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: inList
              right:
                value:
                  simple: zip,7z
          root: File
      nonsensitive_password:
        simple: ${incident.unzippassword}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Unzip a file using fileName or entryID to specify a file. Unzipped
        files will be loaded to the War Room and names will be put into the context.
      id: bacc5314-f59a-434f-834b-90b5cb70a428
      iscommand: false
      name: Unzip File
      script: UnzipFile
      type: regular
      version: -1
    taskid: bacc5314-f59a-434f-834b-90b5cb70a428
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -580,
          "y": 565
        }
      }
  "2":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: artifacts
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Upload File For Sandbox Analysis
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: attachments
      sender: Your SOC team
      title: Upload File For Sandboxing
      totalanswers: 0
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 89402c08-8eb9-4640-819b-f5f4ae540173
      iscommand: false
      name: Upload File For Sandboxing (the password protected file in standard format)
      type: collection
      version: -1
    taskid: 89402c08-8eb9-4640-819b-f5f4ae540173
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 420,
          "y": -100
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Type
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                  - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Info
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                  - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Extension
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                root: File
          operator: isExists
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: File.Extension
          operator: notEndWith
          right:
            value:
              simple: eml
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Asserts the file type is supported
      id: 14a70c7c-766f-493e-816b-ad34769bc7ce
      iscommand: false
      name: Is the file type supported in FireEye?
      type: condition
      version: -1
    taskid: 14a70c7c-766f-493e-816b-ad34769bc7ce
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 645
        }
      }
  "4":
    continueonerrortype: ""
    form:
      description: Enter the required inputs for Sandboxing on FireEye
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Select analysis mode - live or sandbox '
        options: []
        optionsarg:
        - {}
        - simple: 1—Live
        - simple: 2—Sandbox
        placeholder: ""
        readonly: false
        required: true
        tooltip: 'Specify live or sandbox analysis mode. 1—Live: analyze suspected
          URLs live within the Malware Analysis Multi-Vector Virtual Execution (MVX)
          analysis engine. 2—Sandbox: analyze suspected URLs in a closed, protected
          environment.'
        type: singleSelect
      - defaultrows: []
        fieldassociated: fireeyeapplication
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Select the application to be used for the analysis.
        options: []
        optionsarg:
        - simple: 0— Allows the Malware Analysis appliance to choose the application
            for you
        placeholder: ""
        readonly: false
        required: true
        tooltip: Specifies the application to be used for the analysis.
        type: singleSelect
      - defaultrows: []
        fieldassociated: fireeyeprofiles
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Select Malware Analysis Profile to use for analysis
        options: []
        optionsarg:
        - {}
        - simple: 30 — centos-7.2
        - simple: 43 — winxp-sp3m
        - simple: 66 — win7x64-sp1m
        - simple: 68 — win10x64m
        - simple: 65 — win7-sp1m
        - simple: 90 — osx-10.8.2
        - simple: 93 — osx-10.11.3
        placeholder: ""
        readonly: false
        required: true
        tooltip: Selects the Malware Analysis profile to use for analysis
        type: singleSelect
      sender: ""
      title: Enter details for Sandboxing
      totalanswers: 0
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e098eef0-2e81-42e9-8c5f-8d13274cda8f
      iscommand: false
      name: Enter details for File Sandboxing
      type: collection
      version: -1
    taskid: e098eef0-2e81-42e9-8c5f-8d13274cda8f
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 50,
          "y": 825
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: true
    quietmode: 0
    scriptarguments:
      value:
        simple: The File Type is not supported by Fire Eye
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Prints text to war room (Markdown supported)
      id: 57757a7f-726d-422c-85f7-295ff08b6f79
      iscommand: false
      name: Notify -File Type Not Supported
      script: Print
      type: regular
      version: -1
    taskid: 57757a7f-726d-422c-85f7-295ff08b6f79
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -590,
          "y": 1755
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File.EntryID
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 56ec57c2-dfaa-4eeb-87e7-839a61f24a6f
      iscommand: false
      name: Is File Uploaded?
      type: condition
      version: -1
    taskid: 56ec57c2-dfaa-4eeb-87e7-839a61f24a6f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": -480
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        complex:
          accessor: "0"
          root: Enter details for Sandboxing.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      application:
        complex:
          accessor: fireeyeapplication
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      force:
        simple: "false"
      prefetch:
        simple: "1"
      priority:
        simple: "0"
      profiles:
        simple: ${incident.fireeyeprofiles}
      timeout:
        simple: "10000"
      urls:
        simple: ${Enter the URL to Sandbox.Answers.0}
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: Submit a url for analysis by FireEye
      id: bd2946b3-f6b5-46f1-878d-94e3275e7eea
      iscommand: true
      name: Automated Task - Uploading the URL on Fire Eye for analysis
      script: fireeye|||fe-submit-url
      type: regular
      version: -1
    taskid: bd2946b3-f6b5-46f1-878d-94e3275e7eea
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1120,
          "y": 680
        }
      }
  "9":
    continueonerrortype: ""
    form:
      description: Enter Password to unzip File
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: unzippassword
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter Password to unzip File
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: Enter Password to unzip File
        type: shortText
      sender: ""
      title: Enter Password to unzip File
      totalanswers: 0
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3072be50-b32d-4096-8a62-d6c1bbab60aa
      iscommand: false
      name: Enter the Password
      type: collection
      version: -1
    taskid: 3072be50-b32d-4096-8a62-d6c1bbab60aa
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -580,
          "y": 420
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Enter details for Sandboxing.Answers
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: —
                    fields:
                      value:
                        simple: "1"
                  operator: Cut
          operator: isEqualString
          right:
            value:
              simple: "1"
      label: Live
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Enter details for Sandboxing.Answers
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: —
                    fields:
                      value:
                        simple: "1"
                  operator: Cut
          operator: isEqualString
          right:
            value:
              simple: "2"
      label: Sandbox
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Live:
      - "14"
      Sandbox:
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f30ff0c1-ff60-471d-83cd-498cef41c17a
      iscommand: false
      name: Check mode of Sandbox.
      type: condition
      version: -1
    taskid: f30ff0c1-ff60-471d-83cd-498cef41c17a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 360
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Select the type of analysis
      cc: null
      format: ""
      methods: []
      replyOptions:
      - File Analysis
      - URL Analysis
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      File Analysis:
      - "2"
      URL Analysis:
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 219eaaeb-f552-4524-8c16-dc12b2dae6e5
      iscommand: false
      name: Select the type of analysis
      type: condition
      version: -1
    taskid: 219eaaeb-f552-4524-8c16-dc12b2dae6e5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 620,
          "y": -290
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        complex:
          accessor: "0"
          root: Enter details for Sandboxing.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      application:
        complex:
          accessor: fireeyeapplication
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      force:
        simple: "false"
      prefetch:
        simple: "0"
      priority:
        simple: "0"
      profiles:
        simple: ${incident.fireeyeprofiles}
      timeout:
        simple: "10000"
      urls:
        simple: ${Enter the URL to Sandbox.Answers.0}
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: Submit a url for analysis by FireEye
      id: 9e2a7b6a-d58f-451e-8dce-de937fbc234f
      iscommand: true
      name: Automated Task - Uploading the URL on Fire Eye for analysis
      script: fireeye|||fe-submit-url
      type: regular
      version: -1
    taskid: 9e2a7b6a-d58f-451e-8dce-de937fbc234f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 620,
          "y": 660
        }
      }
  "15":
    continueonerrortype: ""
    form:
      description: Enter the required inputs for Sandboxing on FireEye
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Select analysis mode - live or sandbox '
        options: []
        optionsarg:
        - {}
        - simple: 1—Live
        - simple: 2—Sandbox
        placeholder: ""
        readonly: false
        required: true
        tooltip: 'Specify live or sandbox analysis mode. 1—Live: analyze suspected
          URLs live within the Malware Analysis Multi-Vector Virtual Execution (MVX)
          analysis engine. 2—Sandbox: analyze suspected URLs in a closed, protected
          environment.'
        type: singleSelect
      - defaultrows: []
        fieldassociated: fireeyeapplication
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Select the application to be used for the analysis.
        options: []
        optionsarg:
        - simple: 0— Allows the Malware Analysis appliance to choose the application
            for you
        placeholder: ""
        readonly: false
        required: true
        tooltip: Specifies the application to be used for the analysis.
        type: singleSelect
      - defaultrows: []
        fieldassociated: fireeyeprofiles
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Select Malware Analysis Profile to use for analysis
        options: []
        optionsarg:
        - {}
        - simple: 30 — centos-7.2
        - simple: 43 — winxp-sp3m
        - simple: 66 — win7x64-sp1m
        - simple: 68 — win10x64m
        - simple: 65 — win7-sp1m
        - simple: 90 — osx-10.8.2
        - simple: 93 — osx-10.11.3
        placeholder: ""
        readonly: false
        required: true
        tooltip: Selects the Malware Analysis profile to use for analysis
        type: singleSelect
      sender: ""
      title: Enter details for Sandboxing
      totalanswers: 0
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a064163f-de1d-4f13-8928-88d70f1fe515
      iscommand: false
      name: Enter details for URL Sandboxing
      type: collection
      version: -1
    taskid: a064163f-de1d-4f13-8928-88d70f1fe515
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 900,
          "y": 150
        }
      }
  "16":
    continueonerrortype: ""
    form:
      description: Enter the URL to Sandbox
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter the URL to Sandbox. If there are more than one url, add them
            as a parameter using a comma to separate them. For example, "www.demisto.com,www.google.com"
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: Enter the URL to Sandbox
        type: shortText
      sender: ""
      title: Enter the URL to Sandbox
      totalanswers: 0
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 34f24657-a3e7-4fb3-8959-1228980a1f00
      iscommand: false
      name: Enter the URL to Sandbox
      type: collection
      version: -1
    taskid: 34f24657-a3e7-4fb3-8959-1228980a1f00
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 900,
          "y": -40
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b8625e52-d83b-4d4e-8b7e-3a17b5df67e1
      iscommand: false
      name: Polling
      type: title
      version: -1
    taskid: b8625e52-d83b-4d4e-8b7e-3a17b5df67e1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 880,
          "y": 920
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        complex:
          accessor: "0"
          root: Enter details for Sandboxing.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      application:
        complex:
          accessor: fireeyeapplication
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      force:
        simple: "false"
      prefetch:
        simple: ${prefetch}
      priority:
        simple: "0"
      profiles:
        simple: ${incident.fireeyeprofiles}
      timeout:
        simple: "10000"
      uploadFile:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: inList
              right:
                iscontext: true
                value:
                  simple: ExtractedFiles
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: commands.server.feSubmit.description
      id: 28a5af13-cbe3-4a55-8d4d-be253e9bbe7e
      iscommand: true
      name: Automated Task - Uploading the Extracted Files on Fire Eye for analysis
      script: fireeye|||fe-submit
      type: regular
      version: -1
    taskid: 28a5af13-cbe3-4a55-8d4d-be253e9bbe7e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1580
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      Ids:
        complex:
          accessor: Key
          root: FireEyeAX.Submissions.URL
      Interval:
        simple: "7"
      PollingCommandArgName:
        simple: submission_Key
      PollingCommandName:
        simple: fe-submit-url-status
      Timeout:
        simple: "360"
      dt:
        simple: FireEyeAX.Submissions.URL(val.Status != 'Submission Done').Key
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      id: 1e2d6ebb-fe8c-4aa9-8bb5-01a9d63e98cf
      iscommand: false
      name: GenericPolling
      playbookId: GenericPolling
      type: playbook
      version: -1
    taskid: 1e2d6ebb-fe8c-4aa9-8bb5-01a9d63e98cf
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1080
        }
      }
  "20":
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Sand Box Result Files
      tags:
        simple: results
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: true
    quietmode: 0
    scriptarguments:
      submissionID:
        simple: ${subplaybook-19.FireEyeAX.Submissions.URL.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      id: 3623c5ba-02de-433f-87cd-060ee85de980
      iscommand: false
      name: AX-result
      script: ca07fab8-8b93-431f-8946-ad2b007a145e
      type: regular
      version: -1
    taskid: 3623c5ba-02de-433f-87cd-060ee85de980
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1380
        }
      }
  "21":
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Sand Box Result Files
      tags:
        simple: results
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: true
    quietmode: 0
    scriptarguments:
      info_level:
        simple: concise
      submission_Key:
        simple: ${FireEyeAX.Submissions.Key}
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: Results of the file submission
      id: 08c1dcfb-74c1-40d2-8bb5-9b4a08f3a730
      iscommand: true
      name: AX-result
      script: fireeye|||fe-submit-result
      type: regular
      version: -1
    taskid: 08c1dcfb-74c1-40d2-8bb5-9b4a08f3a730
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -50,
          "y": 1895
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      Ids:
        complex:
          accessor: Submissions.Key
          root: FireEyeAX
      Interval:
        simple: "7"
      PollingCommandArgName:
        simple: submission_Key
      PollingCommandName:
        simple: fe-submit-status
      Timeout:
        simple: "360"
      dt:
        simple: FireEyeAX.Submissions(val.Status != 'Done').Key
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      id: 005b9fa3-7dcc-4e65-8e45-b6c537c16047
      iscommand: false
      name: GenericPolling
      playbookId: GenericPolling
      type: playbook
      version: -1
    taskid: 005b9fa3-7dcc-4e65-8e45-b6c537c16047
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -50,
          "y": 1755
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b7312902-72b8-4986-809a-7956c4df1fed
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
    taskid: b7312902-72b8-4986-809a-7956c4df1fed
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2210
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 44e87b91-27f6-4870-8909-d86136711a4e
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 44e87b91-27f6-4870-8909-d86136711a4e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2330
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6e9ba190-30ac-4d02-8d22-762884490ff3
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 6e9ba190-30ac-4d02-8d22-762884490ff3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2480
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File.Extension
          operator: isEqualString
          right:
            value:
              simple: zip
        - left:
            iscontext: true
            value:
              simple: File.Extension
          operator: isEqualString
          right:
            value:
              simple: 7z
      label: "yes"
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6677d15e-8c6d-43b4-820a-80c6b15903fc
      iscommand: false
      name: Check If File is a ZIP File
      type: condition
      version: -1
    taskid: 6677d15e-8c6d-43b4-820a-80c6b15903fc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 70
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: "Malicious: ${FireEyeAXReport.alerts.alert.-malicious} \nSeverity:
          ${FireEyeAXReport.alerts.alert.-severity}"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: b904ac17-d502-49cd-8611-39d2b0a5f8b9
      iscommand: false
      name: Display Malicious and Severity Status
      script: Print
      type: regular
      version: -1
    taskid: b904ac17-d502-49cd-8611-39d2b0a5f8b9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -50,
          "y": 2030
        }
      }
  "28":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedFiles
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 08361f6c-e3b6-4e12-815f-55e7366604f5
      iscommand: false
      name: Checking if there are any extracted files
      type: condition
      version: -1
    taskid: 08361f6c-e3b6-4e12-815f-55e7366604f5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -60,
          "y": 1400
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        complex:
          accessor: "0"
          root: Enter details for Sandboxing.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      application:
        complex:
          accessor: fireeyeapplication
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      force:
        simple: "false"
      prefetch:
        simple: ${prefetch}
      priority:
        simple: "0"
      profiles:
        simple: ${incident.fireeyeprofiles}
      timeout:
        simple: "10000"
      uploadFile:
        complex:
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: commands.server.feSubmit.description
      id: dc51ac25-ace7-450d-863c-151b1eb64e8c
      iscommand: true
      name: Automated Task - Uploading the File on Fire Eye for analysis
      script: fireeye|||fe-submit
      type: regular
      version: -1
    taskid: dc51ac25-ace7-450d-863c-151b1eb64e8c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 160,
          "y": 1570
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: "Malicious: ${FireEyeAXReport.alerts.alert.-malicious} \nSeverity:
          ${FireEyeAXReport.alerts.alert.-severity}"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: 9616bf9a-dc1f-413f-8a2d-8b9304f38ef3
      iscommand: false
      name: Display Malicious and Severity Status
      script: Print
      type: regular
      version: -1
    taskid: 9616bf9a-dc1f-413f-8a2d-8b9304f38ef3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1580
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: How would you like to proceed?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Submit Zip File as it is
      - Unzip the file first and then submit
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Submit Zip File:
      - "3"
      Unzip the file:
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f1d760db-7bbf-44b5-8107-79768b48af2f
      iscommand: false
      name: How would you like to proceed?
      type: condition
      version: -1
    taskid: f1d760db-7bbf-44b5-8107-79768b48af2f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -270,
          "y": 245
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Enter details for Sandboxing.Answers
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: —
                    fields:
                      value:
                        simple: "1"
                  operator: Cut
          operator: isEqualString
          right:
            value:
              simple: "1"
      label: Live
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Enter details for Sandboxing.Answers
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: —
                    fields:
                      value:
                        simple: "1"
                  operator: Cut
          operator: isEqualString
          right:
            value:
              simple: "2"
      label: Sandbox
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Live:
      - "33"
      Sandbox:
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5ffd4f84-1fac-4ea5-8983-97c05f9ebb4c
      iscommand: false
      name: Check mode of Sandbox.
      type: condition
      version: -1
    taskid: 5ffd4f84-1fac-4ea5-8983-97c05f9ebb4c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 985
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: prefetch
      value:
        simple: "0"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 398e0eaa-e954-4854-8f2c-02a4a55548b6
      iscommand: false
      name: Set Prefetch 0
      script: Set
      type: regular
      version: -1
    taskid: 398e0eaa-e954-4854-8f2c-02a4a55548b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 1175
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: prefetch
      value:
        simple: "1"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: be9a8c9a-2296-4095-8d83-c01be7695ffe
      iscommand: false
      name: Set Prefetch 1
      script: Set
      type: regular
      version: -1
    taskid: be9a8c9a-2296-4095-8d83-c01be7695ffe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1165
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "10_14_Live": 0.56,
      "10_8_Sandbox": 0.44,
      "13_2_File Analysis": 0.57,
      "28_18_yes": 0.55,
      "31_3_Submit Zip File": 0.23,
      "3_4_yes": 0.57,
      "6_26_yes": 0.41
    },
    "paper": {
      "dimensions": {
        "height": 3195,
        "width": 2090,
        "x": -590,
        "y": -650
      }
    }
  }
