contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.10.0
    itemVersion: 1.7.4
    packID: PrismaCloudCompute
    packName: Prisma Cloud Compute by Palo Alto Networks
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: |-
  This playbook is a sub-playbook of the "Prisma Cloud Compute - Jira Compliance Issue" playbook.
  It creates a new Jira issue or updates an existing Jira issue with a markdown table for the given compliance ID retrieved from the parent playbook, with enriched data for each resource (host, image or container).
id: Prisma Cloud Compute - Jira Ticket (Markdown Table)
inputs:
- description: A filter to use for extracting affected resources with a specific compliance
    issue ID.
  key: Filter
  playbookInputQuery: null
  required: false
  value: {}
- description: The compliance issue ID to open a ServiceNow ticket for.
  key: ComplianceIssueID
  playbookInputQuery: null
  required: false
  value: {}
- description: The compliance issue description.
  key: ComplianceIssueDescription
  playbookInputQuery: null
  required: false
  value: {}
- description: The compliance issue severity.
  key: ComplianceIssueSeverity
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: JiraIssueTypeName
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: JiraProjectName
  playbookInputQuery: null
  required: false
  value: {}
name: Prisma Cloud Compute - Jira Ticket (Markdown Table)
outputs:
- contextPath: TicketAction
  description: The ticket action - create or update.
  type: string
- contextPath: Ticket
  description: The ticket object which was created or updated.
  type: string
quiet: true
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a393e315-2cb1-416e-8e7a-f91e1a0d5006
      iscommand: false
      name: ""
      version: -1
    taskid: a393e315-2cb1-416e-8e7a-f91e1a0d5006
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 850,
          "y": -60
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: JiraPrefix
      value:
        simple: |-
          **Compliance Issue ID**: ${inputs.ComplianceIssueID}
          **Compliance Issue Description**: ${inputs.ComplianceIssueDescription}
          **Compliance Issue Severity**: ${inputs.ComplianceIssueSeverity}
          **Total Resources**: ${TotalResources}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 23460c85-0584-4cc3-8177-85718dc3cd5c
      iscommand: false
      name: Prepare Jira description prefix
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 23460c85-0584-4cc3-8177-85718dc3cd5c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 850,
          "y": 780
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aadac1c0-2bad-4278-89f2-3c48ad000a78
      iscommand: false
      name: Create a new ticket (with HTML table)
      type: title
      version: -1
    taskid: aadac1c0-2bad-4278-89f2-3c48ad000a78
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 1335
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6c1f9ce2-1ebd-4e26-8405-a01ecaa29c94
      iscommand: false
      name: Update an existing ticket (with HTML table)
      type: title
      version: -1
    taskid: 6c1f9ce2-1ebd-4e26-8405-a01ecaa29c94
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 640,
          "y": 1335
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TicketAction
      value:
        simple: Create
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: The action of the the ticket (create or update) will be displayed
        in the layout under the "Ticketing Information".
      id: 8f744df6-4d85-4d68-8984-249d9894cc9f
      iscommand: false
      name: Set "TicketAction" as "Create"
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 8f744df6-4d85-4d68-8984-249d9894cc9f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 2060
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TicketAction
      value:
        simple: Update
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: The action of the the ticket (create or update) will be displayed
        in the layout under the "Ticketing Information".
      id: 8a4be7d7-5eaa-4ada-8fbd-677989826cf9
      iscommand: false
      name: Set "TicketAction" as "Update"
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 8a4be7d7-5eaa-4ada-8fbd-677989826cf9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 2060
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TotalResources
      value:
        complex:
          accessor: containerid
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputecontainercomplianceissues.complianceissues
              operator: match
              right:
                iscontext: true
                value:
                  simple: inputs.Filter
          root: incident.prismacloudcomputecontainercomplianceissues
          transformers:
          - operator: count
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 2e53afa9-8e5a-4781-8c90-92b3d8e2d289
      iscommand: false
      name: Count containers (to show in Jira ticket)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 2e53afa9-8e5a-4781-8c90-92b3d8e2d289
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 605
        }
      }
  "12":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: alertcategory
                root: incident
          operator: isEqualString
          right:
            value:
              simple: host
      label: Host
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: alertcategory
                root: incident
          operator: isEqualString
          right:
            value:
              simple: container
      label: Container
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: alertcategory
                root: incident
          operator: isEqualString
          right:
            value:
              simple: image
      label: Image
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Container:
      - "19"
      Host:
      - "17"
      Image:
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fdfd6f2d-30d9-43a7-8ada-56005d320618
      iscommand: false
      name: What is the resource type?
      type: condition
      version: -1
    taskid: fdfd6f2d-30d9-43a7-8ada-56005d320618
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 850,
          "y": 280
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TotalResources
      value:
        complex:
          accessor: imageid
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputeimagecomplianceissues.complianceissues
              operator: match
              right:
                iscontext: true
                value:
                  simple: inputs.Filter
          root: incident.prismacloudcomputeimagecomplianceissues
          transformers:
          - operator: count
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: addc0361-8323-41a3-8676-600037ce5780
      iscommand: false
      name: Count images (to show in Jira ticket)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: addc0361-8323-41a3-8676-600037ce5780
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 605
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: JiraResources
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputehostcomplianceissues.complianceissues
              operator: match
              right:
                iscontext: true
                value:
                  simple: inputs.Filter
          root: incident.prismacloudcomputehostcomplianceissues
          transformers:
          - args:
              fields:
                value:
                  simple: complianceissues
              json_object:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputehostcomplianceissues
            operator: IgnoreFieldsFromJson
          - args:
              headers: {}
              is_auto_json_transform: {}
              json_transform_properties: {}
              title: {}
            operator: JsonToTable
          - args:
              regex:
                value:
                  simple: <br>
              replaceWith:
                value:
                  simple: "\\\\ \n"
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: \|cloudmetadata
              replaceWith:
                value:
                  simple: '|Cloud Metadata'
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: \|compliancedistribution
              replaceWith:
                value:
                  simple: '|Compliance Distribution'
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: \|hostname
              replaceWith:
                value:
                  simple: '|Hostname'
            operator: replaceMatch
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 7ced5613-b22f-44f7-86d2-440f13fbdf1a
      iscommand: false
      name: Prepare hosts compliance table for Jira (MD table)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 7ced5613-b22f-44f7-86d2-440f13fbdf1a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 605
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TotalResources
      value:
        complex:
          accessor: hostname
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputehostcomplianceissues.complianceissues
              operator: match
              right:
                iscontext: true
                value:
                  simple: inputs.Filter
          root: incident.prismacloudcomputehostcomplianceissues
          transformers:
          - operator: count
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 1cb5e2b5-9753-4715-8f76-832d3c7b13b8
      iscommand: false
      name: Count hosts (to show in Jira ticket)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 1cb5e2b5-9753-4715-8f76-832d3c7b13b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": 605
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f1e7e920-293e-45bf-8dd2-7a979492ba71
      iscommand: false
      name: Host
      type: title
      version: -1
    taskid: f1e7e920-293e-45bf-8dd2-7a979492ba71
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 10,
          "y": 450
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7bf7d92c-4eea-4ea9-820a-7caaf1d1b112
      iscommand: false
      name: Image
      type: title
      version: -1
    taskid: 7bf7d92c-4eea-4ea9-820a-7caaf1d1b112
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1700,
          "y": 450
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 978c5090-f23e-4c99-8270-729c0b209f8b
      iscommand: false
      name: Container
      type: title
      version: -1
    taskid: 978c5090-f23e-4c99-8270-729c0b209f8b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 850,
          "y": 450
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Id
                root: Ticket
          operator: isNotEmpty
          right:
            value: {}
      label: Existing
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      Existing:
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b49eb2bb-747f-41bc-8104-2495d6733260
      iscommand: false
      name: Create a new ticket or update an existing one?
      type: condition
      version: -1
    taskid: b49eb2bb-747f-41bc-8104-2495d6733260
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 850,
          "y": 1150
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 30f68abd-b018-46f2-85e4-319a0578d5d3
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 30f68abd-b018-46f2-85e4-319a0578d5d3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 870,
          "y": 2230
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: JiraResources
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputecontainercomplianceissues.complianceissues
              operator: match
              right:
                iscontext: true
                value:
                  simple: inputs.Filter
          root: incident.prismacloudcomputecontainercomplianceissues
          transformers:
          - args:
              fields:
                value:
                  simple: complianceissues
              json_object:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputecontainercomplianceissues
            operator: IgnoreFieldsFromJson
          - args:
              headers: {}
              is_auto_json_transform: {}
              json_transform_properties: {}
              title: {}
            operator: JsonToTable
          - args:
              regex:
                value:
                  simple: <br>
              replaceWith:
                value:
                  simple: "\\\\ \n"
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: \|cloudmetadata
              replaceWith:
                value:
                  simple: '|Cloud Metadata'
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: \|compliancedistribution
              replaceWith:
                value:
                  simple: '|Compliance Distribution'
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: \|containerid
              replaceWith:
                value:
                  simple: '|Container ID'
            operator: replaceMatch
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: fc832c33-c0cf-45f4-85ed-f0284598ceee
      iscommand: false
      name: Prepare containers compliance table for Jira (MD table)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: fc832c33-c0cf-45f4-85ed-f0284598ceee
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1070,
          "y": 605
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: JiraResources
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputeimagecomplianceissues.complianceissues
              operator: match
              right:
                iscontext: true
                value:
                  simple: inputs.Filter
          root: incident.prismacloudcomputeimagecomplianceissues
          transformers:
          - args:
              fields:
                value:
                  simple: complianceissues
              json_object:
                iscontext: true
                value:
                  simple: incident.prismacloudcomputeimagecomplianceissues
            operator: IgnoreFieldsFromJson
          - args:
              headers: {}
              is_auto_json_transform: {}
              json_transform_properties: {}
              title: {}
            operator: JsonToTable
          - args:
              regex:
                value:
                  simple: <br>
              replaceWith:
                value:
                  simple: "\\\\ \n"
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: \|cloudmetadata
              replaceWith:
                value:
                  simple: '|Cloud Metadata'
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: \|compliancedistribution
              replaceWith:
                value:
                  simple: '|Compliance Distribution'
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: \|imageid
              replaceWith:
                value:
                  simple: '|Image ID'
            operator: replaceMatch
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: f43b15c2-5c8a-4a2a-8a6c-3561935885f7
      iscommand: false
      name: Prepare images compliance table for Jira (MD table)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: f43b15c2-5c8a-4a2a-8a6c-3561935885f7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1920,
          "y": 605
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: Ticket.Attachments.filename
                    operator: startWith
                    right:
                      value:
                        simple: PCC_
                - - left:
                      iscontext: true
                      value:
                        simple: Ticket.Attachments.filename
                    operator: endWith
                    right:
                      value:
                        simple: xlsx
                root: Ticket.Attachments.filename
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Jira V3
      description: Creates a new issue in Jira.
      id: b3607860-d43a-4a0f-8726-a71068bb96d5
      iscommand: false
      name: Is there an existing attachment?
      type: condition
      version: -1
    taskid: b3607860-d43a-4a0f-8726-a71068bb96d5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 640,
          "y": 1480
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      attachment_id:
        complex:
          accessor: id
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Ticket.Attachments.filename
              operator: startWith
              right:
                value:
                  simple: PCC_
          - - left:
                iscontext: true
                value:
                  simple: Ticket.Attachments.filename
              operator: endWith
              right:
                value:
                  simple: xlsx
          root: Ticket.Attachments
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Deletes an attachment from an issue.
      id: 221200eb-d066-4586-8e04-8411910c08ae
      iscommand: true
      name: Delete file from existing issue
      script: '|||jira-issue-delete-file'
      tags:
      - TicketInfo
      type: regular
      version: -1
    taskid: 221200eb-d066-4586-8e04-8411910c08ae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 1690
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      description:
        simple: |-
          ${JiraPrefix}

          ${JiraResources}
      issue_id:
        complex:
          accessor: Id
          root: Ticket
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Modifies an issue in Jira. If the status or transition fields are
        given, then the other supplied fields should appear on the transition screen.
      id: b04b562b-7b1f-4e7f-8764-486c3d75960e
      iscommand: true
      name: Update existing issue description
      script: '|||jira-edit-issue'
      type: regular
      version: -1
    taskid: b04b562b-7b1f-4e7f-8764-486c3d75960e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 1880
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      query:
        simple: 'project = "${inputs.JiraProjectName}" AND summary ~ ''"Prisma Cloud
          Compute - compliance issues ID: ${inputs.ComplianceIssueID}"'' AND resolution
          = Unresolved'
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: |-
        Queries Jira issues.
        This task is used in order to decide in later stages of the playbook whether it needs to create a new ticket or update an existing one.
      id: 40625a26-1fdf-4019-8b7a-04243bbf8cac
      iscommand: true
      name: Search for existing open Jira issues
      script: '|||jira-issue-query'
      type: regular
      version: -1
    taskid: 40625a26-1fdf-4019-8b7a-04243bbf8cac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 850,
          "y": 960
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      description:
        simple: |-
          ${JiraPrefix}

          ${JiraResources}
      issue_type_name:
        complex:
          root: inputs.JiraIssueTypeName
      project_name:
        complex:
          root: inputs.JiraProjectName
      summary:
        simple: 'Prisma Cloud Compute - compliance issues ID: ${inputs.ComplianceIssueID}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a new issue in Jira.
      id: 586392b1-1ff2-44a1-809e-380b1c65a70d
      iscommand: true
      name: Create a Jira ticket with compliance issues table
      script: '|||jira-create-issue'
      type: regular
      version: -1
    taskid: 586392b1-1ff2-44a1-809e-380b1c65a70d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 1880
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
      subplaybook:
        simple: auto
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: bfd4cf39-c9d8-4c76-866b-90f6ce11a852
      iscommand: false
      name: Delete Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: bfd4cf39-c9d8-4c76-866b-90f6ce11a852
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 850,
          "y": 90
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "26_27_yes": 0.52
    },
    "paper": {
      "dimensions": {
        "height": 2355,
        "width": 2510,
        "x": -210,
        "y": -60
      }
    }
  }
