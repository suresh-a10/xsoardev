category: IT Services
commonfields:
  id: GSuiteAdmin
  version: -1
configuration:
- display: User's Service Account JSON
  hidden: true
  name: user_service_account_json
  required: false
  type: 4
- display: Admin Email
  displaypassword: User's Service Account JSON
  name: admin_email_creds
  required: false
  type: 9
- additionalinfo: An admin email is required for the Test validation to run. If not
    configured, then each command can receive an optional admin_email argument.
  display: Admin Email
  hidden: true
  name: admin_email
  required: false
  type: 0
- additionalinfo: A unique identifier of the customer's Google account.
  display: Customer ID
  name: customer_id
  required: false
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: 1.2.4
    packID: GSuiteAdmin
    packName: G Suite Admin
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: G Suite or Google Workspace Admin is an integration to perform an action
  on IT infrastructure, create users, update settings, and more administrative tasks.
detaileddescription: "# Configure an API account on G Suite Admin\nConfigure a service
  account and retrieve its key in JSON format by following the steps mentioned here:
  [https://developers.google.com/identity/protocols/oauth2/service-account#creatinganaccount](https://developers.google.com/identity/protocols/oauth2/service-account#creatinganaccount)
  or in the integration README.\n \n\nProvide at least one of the scopes mentioned
  for each command.\n\n### Commands and its scopes\n| **Command Name** | **Scope**
  |\n|---|---|\n| gsuite-user-create, gsuite-user-update, and gsuite-user-delete,
  gsuite-user-get, gsuite-user-reset-password | https://www.googleapis.com/auth/admin.directory.user
  | \n| gsuite-mobile-update | https://www.googleapis.com/auth/admin.directory.device.mobile.action
  |\n| gsuite-mobile-delete | https://www.googleapis.com/auth/admin.directory.user.readonly,
  https://www.googleapis.com/auth/admin.directory.user, https://www.googleapis.com/auth/cloud-platform
  | \n| gsuite-role-assignment-list | https://www.googleapis.com/auth/admin.directory.rolemanagement.readonly,
  https://www.googleapis.com/auth/admin.directory.rolemanagement |\n| gsuite-role-assignment-create
  | https://www.googleapis.com/auth/admin.directory.rolemanagement | \n| gsuite-user-alias-add
  | https://www.googleapis.com/auth/admin.directory.user.alias, https://www.googleapis.com/auth/admin.directory.user
  |\n| gsuite-token-revoke | https://www.googleapis.com/auth/admin.directory.user.security
  | \n| gsuite-datatransfer-request-create | https://www.googleapis.com/auth/admin.datatransfer
  |\n| gsuite-datatransfer-list | https://www.googleapis.com/auth/admin.datatransfer,
  https://www.googleapis.com/auth/admin.datatransfer.readonly | \n| gsuite-group-create
  | https://www.googleapis.com/auth/admin.directory.group |\n| gsuite-group-get |
  https://www.googleapis.com/auth/admin.directory.group | \n| gsuite-role-create |
  https://www.googleapis.com/auth/admin.directory.rolemanagement |\n| gsuite-custom-user-schema-create,
  gsuite-custom-user-schema-update | https://www.googleapis.com/auth/admin.directory.userschema
  |\n| gsuite-mobiledevice-list | https://www.googleapis.com/auth/admin.directory.device.mobile.readonly
  | \n| gsuite-chromeosdevice-action | https://www.googleapis.com/auth/admin.directory.device.chromeos
  |\n| gsuite-chromeosdevice-list | https://www.googleapis.com/auth/admin.directory.device.chromeos.readonly
  |\n| gsuite-chromebrowserdevice-move-ou, gsuite-chromebrowserdevice-list | https://www.googleapis.com/auth/admin.directory.device.chromebrowsers
  | \n| gsuite-policy-modify, gsuite-policy-schemas-list, gsuite-policy-resolve and
  gsuite-policy-groups-delete | https://www.googleapis.com/auth/chrome.management.policy
  |\n\nTo execute the command either provide the value of the Admin email in the integration
  configuration or provide the value of the *admin_email* argument for the command
  or provide the admin role to the created service account's email by performing the
  following steps:\n\n1. You must be signed in as a super administrator for this task.\n2.
  Open your Google Admin console (at [https://admin.google.com](https://admin.google.com)).\n3.
  Go to Admin roles.\n4. Click the role you want to assign (the appropriate role).\n5.
  Click *Assign Admin*.\n6. On the opened page, click *Assign Service Accounts*.\n7.
  Append the email ID of the service account created and click *ASSIGN ROLE* to save.\n\nPrecedence
  of this will be admin_email in the command argument > admin email in the integration
  configuration > admin role provided to the service account.\n\n\n---\n[View Integration
  Documentation](https://xsoar.pan.dev/docs/reference/integrations/g-suite-admin)"
display: Google Workspace Admin
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAYAAACXpx/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAgQSURBVHgB7ZoPcBTVHcd/b3cv5N8RCiGgOIig0vKvQIESWuLlSAJNBW3hyjQ606mttlU709bqKIQxxGSAqdVp1RZ1rLWd/oPWf4UqGBID1QrhXyxN2jIqiEhCBMMluUvubt/z+7vLjZcYhqgzcTe+z8z37nbf27d7+31/fu/tEmk0Go1Go9FoNBqNRqPRaDRuQJDDWVTRkpfhGVkgSGYqUifa0rr2vXr7+C7SDArHGly0MTRRxuRmXOFX+iQoOmkosb5mXdajNITMfvyaUivd+oMyxMYDq/+6iVyCQQ7kqspgvrTlQbTYZUrQ8yTVzYrs62DuRgWLpanuW7Khaz4NJeFIGirbKCFlBrkIixzG4qq2i0xh/FEpGmkI44e71mQ9lJpeXNH1QMy059WuG9lAmgviOIM9KuPHaCmTDKHu3rU2+6H+6S9UZL2Nr2dJMygcZXAgoMyzRucqqUTU6Ij+4sMc21K4oMwQdAcJOQWBxQkpxANtb3c9NqOpKcLpqo7SY9K6W9l0vTBENirRQbLNSk9Jd32yDH9V+1zckntIqMUYCo5jeHjQlMaynlDrU510SzD1fB0ls/LCsRHVyHMtyooKRU+aacaaMc/tDZKDcJTB56Z3jkHcN04Iaq7ZNPpcapq/Ovh7ReblfQ4Q1B6MZK7cvvuLm9Dib4Upb2Kc/jtCi/mC1K/yLs5aoqYHVlPZVm/U9hyC8ZOEqepJqTbkKyTDfjH2QtpKqzjyZHFVZJ4tIjtQqoXhYScKz0GAslnBOdkTbsT+w8nTBn1fyA3HxMu4zktRdXYIJTpx7u/ZEXvRkWnTFiYrlRNwVJAVGmFHcaOiuPmj+qcpZYzHx4ykYOBCsqMLb2/8wWRTqO8jSyOp8IJxtfvLxhaUToX5L6GclWfOHpsrvZ4yNhd5fm75Y35PUSxgSzMfZbTCwEfVloBpi55fIj0Lwdw36sq9q+rKs4txzG8Gus5uQd8kIabYkirHLr56hU1qDa5pLyrFnLzx2deQg3CUwf+8K6ddkWiGORMLKzump6bxDYe8SSmljhqG1bE41DQLlcKKSfXEuNojrZxXVFRI7LsvfqCSfkliOX5Fray0n6HVSd6dXtJzVCmxBT9H7zHCy0mJBagQu+rW5uxInjOiRPlA1xkRIj51syzjWNue7fsNEq8JISbC9PJopr2dHITDpklCSWk/Ev9piXt5TB4oV+E9XaW4oVfAxHqPHY7xvqhiT98nFJNxI23uY1FqzKZId9DOTM3THaN4+TE7M00JYaNi9VkXSPecZ51AqXjZUspfo8IETUE3HLGzJufV7KuesO1AiByE4+bB9bb3CbSEp2HLsjNzQtv95a1Tkmm+CmUVVZ37KgKpzdgMm9KutGRsL6dlmObqN3yz4137ifxLMjIN41b+LQ2zATbVWyZlWZa8KVlWeAddluERX0M3fXLmiMbn4NqrqGBLCyq75iTzYC5+y0DXiMAl0coVbcmtaSgcU9Pw+OWy/bK2JQt/onw+R8U1jlzJKqnoyIt66C9oUD5cYAhN8IASxrsw40p0sDy+IqiRP6pbOzI+Rrb55z+CaPZG5GvGMbVoynNxXD4qybOtLV2B6VuaKNriacI+VBaxDflaDVKlGA7GIs93rOLo7/wb2ktIWuiyhQfn+TNa9CgYuAIuWt1nj68PTfnpYWt05lNoveufefj4gx7TeBmnvgJ5n8YQcBplL8X2BEWxgnG7Dv2LHIIjV7J2VnhP1631FkpSAWzuQ1Q7Ryi1AitauRz4oMednzSXGVvbcBPMug1jKv+fm2HaJBhRnlvbcC1HtGIGRTzpUaxn08Mw7CrkuQH5TwlDrmRzuYzau0btNElxgHQY5/sWjvehD67mNMNKQ2umICrOK0h7a8KLB96R4Z4vo6zHsO3Dtd2IinUacUGpk8x1Fdw9DybfYLpIzIk/kKdoo8rxVQXjEbDPlzhXUXXnUn91p8L+7563LA4cAgGTHIrjnyYNFTDyXnzdhhuyIULq/jR0DDBvK/ZdigWSmbvXZbxBLsSRXfQngsq6H5H5Pph6J4Ln1/HdiC5/KqZPVW41l9EtOAUeBoTR+XVhYBFFiCAmaVvr7vT+hzSOQVwgTdCnrFIPpz/7behKiKPi5pT9PAzdAeWk7ON17qPQMxAvlKyCPgMN6UsEQ4HjHhd+RPCQIm4ur2bxQkVzv3T+n9zVHundzoN8kBf6LSUqgWMj4Y/DcDF4HsTLhzVQAcRLkv2XDE9RyhMhSlSGEiibhjHDxeDPUaKF7of4QQC35sMXOOad3u/+wxRvl0JTKVFp/g/VQt3kQobDNAnPZGkC9ArUQfzYkGjRAPn4v1q9yoWWQGegzn75eFHj8xCvcR+EZkPLyaUMhxbM3XMbdLx3+99QGTQeaknJx0uU+b2/06Ew9CdKdNVJeBzm8ZnH6pdSylPkUtxu8AhoLiXGV3/vPn7rkVsrG78tJS9Hzck5Lb9X/T9KdMGp2NAeSnTRM6HXIDxlov+SS3G7wWyChxItclbKfu6qP0t9DX6LEmP0hdjdm3cadAl0PSVM/we5ELcbzKbyW5b8gl5qN8rPkPk1nsnQMRo8fD+45XN3n6wcV0NfIpca7OYgix/us5GH6INjJBvEUfI8+nDw/eBx+jpKVB4OtrglnyCX4ubJPd94Xqh4nvhFvb7w2MpmcXTNQRJH2mz6qfOUdTElpkFNlBinL6LEmM4Gn4T+RomgTDOM+NStW2s0Go1Go9FoNBqNRqPRaDSfHO8BwkzdS/BX534AAAAASUVORK5CYII=
name: GSuiteAdmin
script:
  commands:
  - arguments:
    - description: The unique ID of the customer's Google Workspace Admin account.
      name: customer_id
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    - auto: PREDEFINED
      description: Whether to show all metadata fields, or only the basic metadata
        fields (e.g., deviceId, model, type, and status). Default is FULL.
      name: projection
      predefined:
      - BASIC
      - FULL
    - description: Search string using the format given at https://developers.google.com/admin-sdk/directory/v1/search-operators.
      name: query
    - auto: PREDEFINED
      description: Device property to use for sorting results. Default is STATUS.
      name: order_by
      predefined:
      - DEVICE_ID
      - EMAIL
      - LAST_SYNC
      - MODEL
      - NAME
      - OS
      - STATUS
      - TYPE
    - auto: PREDEFINED
      description: Whether to return results in ascending or descending order. Must
        be used with the order_by parameter. Default is ASCENDING.
      name: sort_order
      predefined:
      - ASCENDING
      - DESCENDING
    - description: The maximum number of records to return from the collection. Default
        is 50.
      name: limit
    - description: The token of the page.
      name: page_token
    - description: The number of requested results per page. Default is 50. Maximum
        allowed value is 100.
      name: page_size
    description: Retrieves a paginated list that includes company-owned mobile devices.
    name: gsuite-mobiledevice-list
    outputs:
    - contextPath: GSuite.MobileDevices.PageToken.NextPageToken
      description: The token of the next page.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects
      description: A list of mobile device objects.
      type: Object
    - contextPath: GSuite.MobileDevices.MobileListObjects.kind
      description: The type of the API resource.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.etag
      description: ETag of the resource.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.resourceId
      description: The unique ID the API service uses to identify the mobile device.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.deviceId
      description: The serial number for a Google Sync mobile device. For Android
        and iOS devices, this is a software-generated unique identifier.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.name
      description: A list of the owner's usernames.
      type: List
    - contextPath: GSuite.MobileDevices.MobileListObjects.email
      description: A list of the owner's email addresses.
      type: List
    - contextPath: GSuite.MobileDevices.MobileListObjects.model
      description: The mobile device's model name.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.os
      description: The mobile device's operating system.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.type
      description: The type of mobile device.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.status
      description: The mobile device's status.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.hardwareId
      description: The IMEI/MEID unique identifier for Android hardware.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.firstSync
      description: The date and time the mobile device was initially synchronized
        with the policy settings in the Admin console.
      type: Date
    - contextPath: GSuite.MobileDevices.MobileListObjects.lastSync
      description: The date and time the mobile device was last synchronized with
        the policy settings in the Admin console.
      type: Date
    - contextPath: GSuite.MobileDevices.MobileListObjects.userAgent
      description: Gives information about the mobile device such as the operating
        system version.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.serialNumber
      description: The mobile device's serial number.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.imei
      description: The mobile device's IMEI number.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.meid
      description: The mobile device's MEID number.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.wifiMacAddress
      description: The mobile device's MAC address on Wi-Fi networks.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.networkOperator
      description: Mobile device mobile or network operator.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.defaultLanguage
      description: The default locale used on the mobile device.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.managedAccountIsOnOwnerProfile
      description: Boolean indicating if this account is on the owner/primary profile.
      type: Boolean
    - contextPath: GSuite.MobileDevices.MobileListObjects.deviceCompromisedStatus
      description: The compromised device status.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.buildNumber
      description: The mobile device's operating system build number.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.kernelVersion
      description: The mobile device's kernel version.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.basebandVersion
      description: The mobile device's baseband version.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.unknownSourcesStatus
      description: Unknown sources enabled or disabled on the mobile device.
      type: Boolean
    - contextPath: GSuite.MobileDevices.MobileListObjects.adbStatus
      description: Whether adb (USB debugging) is enabled on the mobile device.
      type: Boolean
    - contextPath: GSuite.MobileDevices.MobileListObjects.developerOptionsStatus
      description: Whether developer options are enabled on the mobile device.
      type: Boolean
    - contextPath: GSuite.MobileDevices.MobileListObjects.otherAccountsInfo
      description: A list of accounts added on the device.
      type: List
    - contextPath: GSuite.MobileDevices.MobileListObjects.supportsWorkProfile
      description: Work profile supported on the mobile device.
      type: Boolean
    - contextPath: GSuite.MobileDevices.MobileListObjects.manufacturer
      description: Mobile device manufacturer.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.releaseVersion
      description: Mobile device release version.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.securityPatchLevel
      description: Mobile device security patch level.
      type: Date
    - contextPath: GSuite.MobileDevices.MobileListObjects.brand
      description: Mobile device brand.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.bootloaderVersion
      description: Mobile device bootloader version.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.hardware
      description: Mobile device hardware.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.encryptionStatus
      description: Mobile device encryption status.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.devicePasswordStatus
      description: Mobile device password status.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.privilege
      description: DM agent permission.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.applications.packageName
      description: The application's package name.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.applications.displayName
      description: The application's display name.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.applications.versionName
      description: The application's version name.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.applications.versionCode
      description: The application's version code.
      type: String
    - contextPath: GSuite.MobileDevices.MobileListObjects.applications.permission
      description: The list of permissions of this application.
      type: List
  - arguments:
    - description: The unique ID of the customer's Google Workspace Admin account.
      name: customer_id
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    - auto: PREDEFINED
      description: Whether to show all metadata fields, or only the basic metadata
        fields (e.g., deviceId, serialNumber, status, and user).
      name: projection
      predefined:
      - BASIC
      - FULL
    - description: Search string in the format given at https://developers.google.com/admin-sdk/directory/v1/list-query-operators.
      name: query
    - auto: PREDEFINED
      description: Device property to use for sorting results.
      name: order_by
      predefined:
      - ANNOTATED_LOCATION
      - ANNOTATED_USER
      - LAST_SYNC
      - NOTES
      - SERIAL_NUMBER
      - STATUS
    - auto: PREDEFINED
      description: Whether to return results in ascending or descending order. Must
        be used with the order_by parameter.
      name: sort_order
      predefined:
      - ASCENDING
      - DESCENDING
    - description: The full path of the organizational unit (without the leading /)
        or its unique ID.
      name: org_unit_path
    - auto: PREDEFINED
      description: Whether to return devices from all child organizational units.
        If this is set to true, 'org_unit_path' must be provided.
      name: include_child_org_units
      predefined:
      - "yes"
      - "no"
    - description: The maximum number of records to return from the collection. Default
        is 50.
      name: limit
    - description: The page number.
      name: page
    - description: The number of requested results per page. Default is 50. Maximum
        allowed value is 100.
      name: page_size
    description: Retrieves a paginated list of company-owned ChromeOS devices.
    name: gsuite-chromeosdevice-list
    outputs:
    - contextPath: GSuite.ChromeOSDevices.PageToken.NextPageToken
      description: The token of the next page.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects
      description: A list of ChromeOS device objects.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.deviceId
      description: The unique ID of the ChromeOS device.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.serialNumber
      description: The ChromeOS device serial number entered when the device was enabled.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.status
      description: Status of the ChromeOS device.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.lastSync
      description: The date and time the ChromeOS device was last synchronized with
        the policy settings in the Admin console.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.supportEndDate
      description: The final date the ChromeOS device will be supported.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.annotatedUser
      description: The user of the ChromeOS device as noted by the administrator.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.annotatedLocation
      description: The address or location of the ChromeOS device as noted by the
        administrator.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.notes
      description: Notes about this ChromeOS device added by the administrator.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.model
      description: The ChromeOS device's model information.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.meid
      description: The Mobile Equipment Identifier (MEID) or the International Mobile
        Equipment Identity (IMEI) for the 3G mobile card in a ChromeOS device.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.orderNumber
      description: The ChromeOS device's order number.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.willAutoRenew
      description: Determines if the ChromeOS device will auto renew its support after
        the support end date.
      type: Boolean
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.osVersion
      description: The ChromeOS device's operating system version.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.platformVersion
      description: The ChromeOS device's platform version.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.firmwareVersion
      description: The ChromeOS device's firmware version.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.macAddress
      description: The ChromeOS device's wireless MAC address.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.bootMode
      description: The boot mode for the ChromeOS device.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.lastEnrollmentTime
      description: The date and time the ChromeOS device was last enrolled.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.kind
      description: The type of resource.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.recentUsers
      description: A list of recent ChromeOS device users, in descending order, by
        last login time.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.recentUsers.type
      description: The type of the user.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.recentUsers.email
      description: The user's email address.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.activeTimeRanges
      description: A list of active time ranges.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.activeTimeRanges.activeTime
      description: Duration of usage in milliseconds.
      type: Integer
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.activeTimeRanges.date
      description: Date of usage.
      type: Integer
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.ethernetMacAddress
      description: The ChromeOS device's MAC address on the ethernet network interface.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.annotatedAssetId
      description: The asset identifier as noted by an administrator or specified
        during enrollment.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.etag
      description: ETag of the resource.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.diskVolumeReports
      description: Reports of disk space and other info about mounted/connected volumes.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.diskVolumeReports.volumeInfo
      description: Disk volumes.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.diskVolumeReports.volumeInfo.volumeId
      description: Volume ID.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.diskVolumeReports.volumeInfo.storageTotal
      description: Total disk space [in bytes].
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.diskVolumeReports.volumeInfo.storageFree
      description: Free disk space [in bytes].
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.systemRamTotal
      description: Total RAM on the ChromeOS device in bytes.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuStatusReports
      description: Reports of CPU utilization and temperature.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuStatusReports.reportTime
      description: Date and time the report was received.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuStatusReports.cpuUtilizationPercentageInfo
      description: The CPU utilization percentage.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuStatusReports.cpuTemperatureInfo
      description: A list of CPU temperature samples.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuStatusReports.cpuTemperatureInfo.temperature
      description: Temperature in Celsius degrees.
      type: Integer
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuStatusReports.cpuTemperatureInfo.label
      description: CPU label.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuInfo
      description: Information regarding CPU specs in the device.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuInfo.model
      description: The CPU model name.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuInfo.architecture
      description: The CPU architecture.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuInfo.maxClockSpeedKhz
      description: The maximum CPU clock speed in kHz.
      type: Integer
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuInfo.logicalCpus
      description: Information for the logical CPUs.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuInfo.logicalCpus.maxScalingFrequencyKhz
      description: Maximum frequency the CPU is allowed to run at, by policy.
      type: Integer
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuInfo.logicalCpus.currentScalingFrequencyKhz
      description: Current frequency the CPU is running at.
      type: Integer
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuInfo.logicalCpus.idleDuration
      description: Idle time since last boot.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuInfo.logicalCpus.cStates
      description: The power consumption state of the CPU. For more information, see
        the documentation published by the CPU maker.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuInfo.logicalCpus.cStates.displayName
      description: Name of the state.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.cpuInfo.logicalCpus.cStates.sessionDuration
      description: Time spent in the state since the last reboot.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.deviceFiles
      description: A list of device files to download.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.deviceFiles.name
      description: File name.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.deviceFiles.type
      description: File type.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.deviceFiles.downloadUrl
      description: File download URL.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.deviceFiles.createTime
      description: Date and time the file was created.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.systemRamFreeReports
      description: Reports of amounts of available RAM memory.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.systemRamFreeReports.reportTime
      description: Date and time the report was received.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.systemRamFreeReports.systemRamFreeInfo
      description: Report of free RAM memory.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.lastKnownNetwork
      description: Contains last known network.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.lastKnownNetwork.ipAddress
      description: The IP address.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.lastKnownNetwork.wanIpAddress
      description: The WAN IP address.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.autoUpdateExpiration
      description: The timestamp after which the device will stop receiving Chrome
        updates or support.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.ethernetMacAddress0
      description: MAC address used by the Chromebook's internal ethernet port, and
        for onboard network (ethernet) interface. The format is twelve (12) hexadecimal
        digits without any delimiter (uppercase letters). This is only relevant for
        some devices.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.dockMacAddress
      description: Built-in MAC address for the docking station that the device connected
        to. Factory sets Media Access Control address (MAC address) assigned for use
        by a dock. It is reserved specifically for MAC pass through device policy.
        The format is twelve (12) hexadecimal digits without any delimiter (uppercase
        letters). This is only relevant for some devices.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.manufactureDate
      description: The date the device was manufactured in yyyy-mm-dd format.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.orgUnitPath
      description: The full parent path with the organizational unit's name associated
        with the device. Path names are case insensitive. If the parent organizational
        unit is the top-level organization, it is represented as a forward slash,
        /.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.tpmVersionInfo
      description: Trusted Platform Module (TPM).
      type: Object
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.tpmVersionInfo.family
      description: TPM family, using the TPM 2.0 style encoding.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.tpmVersionInfo.specLevel
      description: TPM specification level.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.tpmVersionInfo.manufacturer
      description: TPM manufacturer code.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.tpmVersionInfo.tpmModel
      description: TPM model number.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.tpmVersionInfo.firmwareVersion
      description: TPM firmware version.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.tpmVersionInfo.vendorSpecific
      description: Vendor-specific information such as vendor ID.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.screenshotFiles
      description: A list of screenshot files to download.
      type: List
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.screenshotFiles.name
      description: File name.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.screenshotFiles.type
      description: File type.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.screenshotFiles.downloadUrl
      description: File download URL.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.screenshotFiles.createTime
      description: Date and time the file was created.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.orgUnitId
      description: The unique ID of the organizational unit. orgUnitPath is the human
        readable version of orgUnitId. While orgUnitPath may change by renaming an
        organizational unit within the path, orgUnitId is unchangeable for one organizational
        unit.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.osUpdateStatus
      description: The status of the operating system updates for the device.
      type: Object
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.osUpdateStatus.state
      description: The update state of an operating system update.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.osUpdateStatus.targetOsVersion
      description: New platform version of the operating system image being downloaded
        and applied.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.osUpdateStatus.targetKioskAppVersion
      description: New required platform version from the pending updated kiosk app.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.osUpdateStatus.updateTime
      description: Date and time of the last successful operating system update.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.osUpdateStatus.updateCheckTime
      description: Date and time of the last update check.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.osUpdateStatus.rebootTime
      description: Date and time of the last reboot.
      type: String
    - contextPath: GSuite.ChromeOSDevices.ChromeOSListObjects.firstEnrollmentTime
      description: Date and time for the first time the device was enrolled.
      type: String
  - arguments:
    - description: The unique ID of the customer's Google Workspace Admin account.
      name: customer_id
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    - description: The unique ID of the device.
      name: resource_id
      required: true
    - auto: PREDEFINED
      description: The action to be performed on the ChromeOS device.
      name: action
      predefined:
      - deprovision
      - disable
      - reenable
      - pre_provisioned_disable
      - pre_provisioned_reenable
      required: true
    - auto: PREDEFINED
      description: Reason for deprovision. This field is required only when the action
        used is deprovision.
      name: deprovision_reason
      predefined:
      - different_model_replacement
      - retiring_device
      - same_model_replacement
      - upgrade_transfer
    description: Executes an action that affects a ChromeOS device. This includes
      de-provisioning, disabling, and re-enabling devices.
    name: gsuite-chromeosdevice-action
  - arguments:
    - description: The unique ID of the customer's G Suite account.
      name: customer_id
    - description: The unique ID used to identify the mobile device.
      name: resource_id
      required: true
    - auto: PREDEFINED
      description: |-
        The action to be performed on the device.

        Available Options:
        admin_account_wipe - Remotely wipes only G Suite data from the device.

        admin_remote_wipe - Remotely wipes all data on the device.

        approve - Approves the device.

        block - Blocks access to G Suite data on the device.

        cancel_remote_wipe_then_activate - Cancels a remote wipe of the device and then reactivates it.

        cancel_remote_wipe_then_block - Cancels a remote wipe of the device and then blocks it.
      name: action
      predefined:
      - admin_account_wipe
      - admin_remote_wipe
      - approve
      - block
      - cancel_remote_wipe_then_activate
      - cancel_remote_wipe_then_block
      required: true
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    description: Takes an action that affects a mobile device. For example, remotely
      wiping a device.
    name: gsuite-mobile-update
  - arguments:
    - description: The unique ID of the customer's G Suite account.
      name: customer_id
    - description: The unique ID used to identify the mobile device.
      name: resource_id
      required: true
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    description: Removes a mobile device. Note that this does not break the device's
      sync, it simply removes it from the list of devices connected to the domain.
      If the device still has a valid login/authentication, it will be added back
      on it's next successful sync.
    name: gsuite-mobile-delete
  - arguments:
    - description: Identifies the user in the API request. The value can be the user's
        primary email address, alias email address, or unique user ID.
      name: user_key
      required: true
    - description: The alias email address.
      name: alias
      required: true
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    description: Adds an alias.
    name: gsuite-user-alias-add
    outputs:
    - contextPath: GSuite.UserAlias.kind
      description: The type of the API resource.
      type: String
    - contextPath: GSuite.UserAlias.id
      description: The unique ID for the user.
      type: String
    - contextPath: GSuite.UserAlias.etag
      description: ETag of the resource.
      type: String
    - contextPath: GSuite.UserAlias.alias
      description: The alias email address.
      type: String
  - arguments:
    - description: The user's first name.
      name: first_name
      required: true
    - description: The user's last name.
      name: last_name
      required: true
    - description: Stores the password for the user account. A password can contain
        any combination of ASCII characters. A minimum of 8 characters is required.
        The maximum length is 100 characters. The password will be sent in MD5 hash
        format.
      name: password
      required: true
    - description: The user's primary email address. The primary_email must be unique
        and cannot be an alias of another user.
      name: primary_email
      required: true
    - description: User's Country.
      name: country
    - auto: PREDEFINED
      description: The address type.
      name: address_type
      predefined:
      - home
      - other
      - work
    - description: The ZIP or postal code, if applicable.
      name: postal_code
    - auto: PREDEFINED
      description: Set to true, If this is the user's primary address.
      name: is_address_primary
      predefined:
      - "true"
      - "false"
    - description: For extended addresses, such as an address that includes a sub-region.
      name: extended_address
    - description: The abbreviated province or state.
      name: region
    - description: The street address, such as 1600 Amphitheatre Parkway. Whitespace
        within the string is ignored; however, newlines are significant.
      name: street_address
    - description: The user's secondary email address.
      name: secondary_email_address
    - auto: PREDEFINED
      description: The type of the secondary email account.
      name: secondary_email_type
      predefined:
      - home
      - other
      - work
    - auto: PREDEFINED
      description: User's gender.
      name: gender
      predefined:
      - female
      - male
      - other
      - unknown
    - auto: PREDEFINED
      description: If true, the user's IP address is on allow list.
      name: is_ip_white_listed
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: Content type of note, either plain text or HTML. If not provided,
        considered as plain text.
      name: notes_content_type
      predefined:
      - text_plain
      - text_html
    - description: Contents of notes.
      name: notes_value
    - description: A human-readable phone number. It may be in any telephone number
        format.
      name: phone_number
    - auto: PREDEFINED
      description: The type of phone number.
      name: phone_number_type
      predefined:
      - assistant
      - callback
      - car
      - company_main
      - grand_central
      - home
      - home_fax
      - isdn
      - main
      - mobile
      - other
      - other_fax
      - pager
      - radio
      - telex
      - tty_tdd
      - work
      - work_fax
      - work_mobile
      - work_pager
    - auto: PREDEFINED
      description: Indicates if this is the user's primary phone number. A user may
        only have one primary phone number.
      name: is_phone_number_primary
      predefined:
      - "true"
      - "false"
    - description: Recovery email of the user.
      name: recovery_email
    - description: 'Recovery phone of the user. The phone number must be in the E.164
        format, starting with the plus sign (+). Example: +16506661212.'
      name: recovery_phone
    - auto: PREDEFINED
      description: Indicates if the user is suspended.
      name: suspended
      predefined:
      - "true"
      - "false"
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    description: Creates a user.
    name: gsuite-user-create
    outputs:
    - contextPath: GSuite.User.id
      description: The unique ID for the user.
      type: String
    - contextPath: GSuite.User.primaryEmail
      description: The user's primary email address.
      type: String
    - contextPath: GSuite.User.firstName
      description: The user's first name.
      type: String
    - contextPath: GSuite.User.lastName
      description: The user's last name.
      type: String
    - contextPath: GSuite.User.customerId
      description: The unique ID for the customer's G Suite account.
      type: String
    - contextPath: GSuite.User.gender
      description: Gender.
      type: String
    - contextPath: GSuite.User.suspended
      description: Indicates if the user is suspended.
      type: Boolean
    - contextPath: GSuite.User.notesValue
      description: Contents of notes.
      type: String
    - contextPath: GSuite.User.notesContentType
      description: Content type of notes.
      type: String
    - contextPath: GSuite.User.isAdmin
      description: Indicates a user with super administrator privileges.
      type: Boolean
    - contextPath: GSuite.User.creationTime
      description: The time the user's account was created.
      type: Date
    - contextPath: GSuite.User.phones.value
      description: A human-readable phone number. It may be in any telephone number
        format.
      type: String
    - contextPath: GSuite.User.phones.type
      description: The type of phone number.
      type: String
    - contextPath: GSuite.User.phones.primary
      description: Indicates if this is the user's primary phone number.
      type: Boolean
    - contextPath: GSuite.User.addresses.type
      description: The address type.
      type: String
    - contextPath: GSuite.User.addresses.country
      description: Country.
      type: String
    - contextPath: GSuite.User.addresses.postalCode
      description: The ZIP or postal code.
      type: String
    - contextPath: GSuite.User.addresses.region
      description: The abbreviated province or state.
      type: String
    - contextPath: GSuite.User.addresses.streetAddress
      description: The street address.
      type: String
    - contextPath: GSuite.User.addresses.extendedAddress
      description: For extended addresses, such as an  address that includes a sub-region.
      type: String
    - contextPath: GSuite.User.addresses.primary
      description: If this is the user's primary address.
      type: Boolean
    - contextPath: GSuite.User.emails.address
      description: The user's secondary email.
      type: String
    - contextPath: GSuite.User.emails.type
      description: The secondary email type.
      type: String
    - contextPath: GSuite.User.ipWhitelisted
      description: If true, the user's IP address is addded to allow list.
      type: Boolean
    - contextPath: GSuite.User.recoveryEmail
      description: Recovery email of the user.
      type: String
    - contextPath: GSuite.User.isDelegatedAdmin
      description: Indicates if the user is a delegated administrator.
      type: Boolean
    - contextPath: GSuite.User.recoveryPhone
      description: Recovery phone of the user.
      type: String
    - contextPath: GSuite.User.orgUnitPath
      description: The full path of the parent organization associated with the user.
        If the parent organization is the top-level, it is represented as a forward
        slash (/).
      type: String
    - contextPath: GSuite.User.isMailboxSetup
      description: Indicates if the user's Google mailbox is created.
      type: Boolean
    - contextPath: GSuite.User.kind
      description: The type of the API resource.
      type: Boolean
    - contextPath: GSuite.User.etag
      description: ETag of the resource.
      type: Boolean
    - contextPath: GSuite.User.hashFunction
      description: Stores the hash format of the password property.
      type: String
  - arguments:
    - description: The group's email address.
      name: group_email
      required: true
    - description: The group's display name.
      name: group_name
    - description: An extended description to help users determine the purpose of
        a group.
      name: group_description
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    description: Creates a group with a group name and its description.
    name: gsuite-group-create
    outputs:
    - contextPath: GSuite.Group.kind
      description: The type of the API resource.
      type: String
    - contextPath: GSuite.Group.id
      description: The unique ID of a group.
      type: String
    - contextPath: GSuite.Group.etag
      description: ETag of the resource.
      type: String
    - contextPath: GSuite.Group.email
      description: The group's email address.
      type: String
    - contextPath: GSuite.Group.name
      description: The group's display name.
      type: String
    - contextPath: GSuite.Group.directMembersCount
      description: The number of users that are direct members of the group.
      type: String
    - contextPath: GSuite.Group.description
      description: An extended description to help users determine the purpose of
        a group.
      type: String
    - contextPath: GSuite.Group.adminCreated
      description: Value is true if this group was created by an administrator rather
        than a user.
      type: Boolean
    - contextPath: GSuite.Group.aliases
      description: List of a group's alias email addresses.
      type: String
    - contextPath: GSuite.Group.nonEditableAliases
      description: List of the group's non-editable alias email addresses that are
        outside of the account's primary domain or subdomains.
      type: String
  - arguments:
    - description: Immutable ID of the G Suite account.
      name: customer_id
    - description: Immutable ID of a role. If included, it returns only role assignments
        containing this role ID.
      name: role_id
    - description: The user's primary email address, alias email address, or unique
        user ID. If included in the request, returns role assignments only for this
        user.
      name: user_key
    - description: Token to specify the next page in the list.
      name: page_token
    - description: Maximum number of results to return. Acceptable values are 1 to
        200, inclusive.
      name: max_results
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    description: Retrieves a paginated list of all role assignments.
    name: gsuite-role-assignment-list
    outputs:
    - contextPath: GSuite.RoleAssignment.kind
      description: The type of the API resource.
      type: String
    - contextPath: GSuite.RoleAssignment.etag
      description: ETag of the resource.
      type: String
    - contextPath: GSuite.RoleAssignment.roleAssignmentId
      description: ID of this role assignment.
      type: Number
    - contextPath: GSuite.RoleAssignment.roleId
      description: The ID of the role that is assigned.
      type: Number
    - contextPath: GSuite.RoleAssignment.assignedTo
      description: The unique ID of the user this role is assigned to.
      type: String
    - contextPath: GSuite.RoleAssignment.scopeType
      description: The scope in which this role is assigned.
      type: String
    - contextPath: GSuite.RoleAssignment.orgUnitId
      description: If the role is restricted to an organization unit, this contains
        the ID of the organization unit to which the exercise of this role is restricted
        to.
      type: String
    - contextPath: GSuite.PageToken.RoleAssignment.nextPageToken
      description: Token to specify the next page in the list.
      type: String
  - arguments:
    - description: Immutable ID of the G Suite account.
      name: customer_id
    - description: The ID of the role to be assigned to the user.
      name: role_id
      required: true
    - description: The unique ID of the user this role is assigned to.
      name: assigned_to
      required: true
    - auto: PREDEFINED
      description: The scope in which this role is assigned.
      name: scope_type
      predefined:
      - CUSTOMER
      - ORG_UNIT
      required: true
    - description: If the role is restricted to an organization unit, this contains
        the ID for the organization unit the exercise of this role is restricted to.
      name: org_unit_id
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    description: Creates a role assignment.
    name: gsuite-role-assignment-create
    outputs:
    - contextPath: GSuite.RoleAssignment.kind
      description: The type of the API resource.
      type: String
    - contextPath: GSuite.RoleAssignment.etag
      description: ETag of the resource.
      type: String
    - contextPath: GSuite.RoleAssignment.roleAssignmentId
      description: ID of this role assignment.
      type: Number
    - contextPath: GSuite.RoleAssignment.roleId
      description: The ID of the role that is assigned.
      type: Number
    - contextPath: GSuite.RoleAssignment.assignedTo
      description: The unique ID of the user this role is assigned to.
      type: String
    - contextPath: GSuite.RoleAssignment.scopeType
      description: The scope in which this role is assigned.
      type: String
    - contextPath: GSuite.RoleAssignment.orgUnitId
      description: If the role is restricted to an organization unit, this contains
        the ID of the organization unit to which the exercise of this role is restricted
        to.
      type: String
  - arguments:
    - description: Immutable ID of the G Suite account.
      name: customer_id
    - description: Name of the role.
      name: role_name
      required: true
    - description: The set of privileges that are granted to this role. Comma-separated
        list of privilege names and service ids of the form "PrivilegeName1:ServiceId1,PrivilegeName2:ServiceId2".
      name: role_privileges
      required: true
    - description: A short description of the role.
      name: role_description
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    description: Creates a new role.
    name: gsuite-role-create
    outputs:
    - contextPath: GSuite.Role.kind
      description: The type of the API resource. This is always admin#directory#role.
      type: String
    - contextPath: GSuite.Role.etag
      description: ETag of the resource.
      type: String
    - contextPath: GSuite.Role.roleId
      description: ID of the role.
      type: Number
    - contextPath: GSuite.Role.roleName
      description: Name of the role.
      type: String
    - contextPath: GSuite.Role.roleDescription
      description: A short description of the role.
      type: String
    - contextPath: GSuite.Role.rolePrivileges.privilegeName
      description: The name of the privilege.
      type: String
    - contextPath: GSuite.Role.rolePrivileges.serviceId
      description: The obfuscated ID of the service this privilege is for.
      type: String
    - contextPath: GSuite.Role.isSystemRole
      description: Whether this is a pre-defined system role.
      type: Boolean
    - contextPath: GSuite.Role.isSuperAdminRole
      description: Whether the role is a super admin role.
      type: Boolean
  - arguments:
    - description: The Client ID of the application the token is issued to.
      name: client_id
      required: true
    - description: Identifies the user in the API request. The value can be the user's
        primary email address, alias email address, or unique user ID.
      name: user_key
      required: true
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    description: Delete all access tokens issued by a user for an application.
    name: gsuite-token-revoke
  - arguments:
    - description: Identifies the user in the API request. The value can be the user's
        primary email address, alias email address, or unique user ID.
      name: user_key
      required: true
    description: Signs a user out of all web and device sessions and reset their sign-in
      cookies.
    name: gsuite-user-signout
  - arguments:
    - description: Immutable ID of the G Suite account.
      name: customer_id
    - description: Destination user's profile ID.
      name: new_owner_user_id
    - description: Source user's profile ID.
      name: old_owner_user_id
    - description: Status of the transfer.
      name: status
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    - description: Maximum number of results to return. Default is 100. Acceptable
        values are 1 to 500, inclusive.
      name: max_results
    - description: Token to specify the next page in the list.
      name: page_token
    description: Lists the transfers for a customer by source user, destination user,
      or status.
    name: gsuite-datatransfer-list
    outputs:
    - contextPath: GSuite.DataTransfer.kind
      description: Identifies the resource as a DataTransfer request.
      type: String
    - contextPath: GSuite.DataTransfer.etag
      description: ETag of the resource.
      type: String
    - contextPath: GSuite.DataTransfer.id
      description: The transfer's ID.
      type: String
    - contextPath: GSuite.DataTransfer.oldOwnerUserId
      description: ID of the user whose data is being transferred.
      type: String
    - contextPath: GSuite.DataTransfer.newOwnerUserId
      description: ID of the user to whom the data is being transferred.
      type: String
    - contextPath: GSuite.DataTransfer.overallTransferStatusCode
      description: Overall transfer status.
      type: String
    - contextPath: GSuite.DataTransfer.requestTime
      description: The time at which the data transfer was requested.
      type: Date
    - contextPath: GSuite.DataTransfer.applicationDataTransfers.applicationTransferStatus
      description: Current status of transfer for this application.
      type: String
    - contextPath: GSuite.DataTransfer.applicationDataTransfers.applicationId
      description: The application's ID.
      type: Number
    - contextPath: GSuite.DataTransfer.applicationDataTransfers.applicationTransferParams.key
      description: The type of the transfer parameter.
      type: String
    - contextPath: GSuite.DataTransfer.applicationDataTransfers.applicationTransferParams.value
      description: The value of the corresponding transfer parameter.
      type: Unknown
    - contextPath: GSuite.PageToken.DataTransfer.nextPageToken
      description: Continuation token which will be used to specify next page in list
        API.
      type: String
  - arguments:
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    - description: Immutable ID of the G Suite account.
      name: customer_id
    - description: The schema's name.
      name: schema_name
      required: true
    - description: Display name for the schema.
      name: schema_display_name
      required: true
    - description: |-
        Raw JSON containing fields of the schema. Acceptable values for
        fieldType are BOOL, DATE, DOUBLE, EMAIL, INT64, PHONE, and STRING. Acceptable
        values for readAccessType are ADMINS_AND_SELF- Only administrators and
        the associated user can see values, and ALL_DOMAIN_USERS- Any user in
        your domain can see values.
        E.g.
        {
          "fields": [
            {
              "fieldType": string,
              "fieldName": string,
              "displayName": string,
              "multiValued": boolean,
              "readAccessType": string,
              "indexed": boolean,
              "numericIndexingSpec": {
                "minValue": double,
                "maxValue": double
              }
            }
          ]
        }.
      name: field_raw_json
    - description: |-
        JSON file entry ID containing fields of the schema. Acceptable values for
        fieldType are BOOL, DATE, DOUBLE, EMAIL, INT64, PHONE, and STRING. Acceptable
        values for readAccessType are ADMINS_AND_SELF- Only administrators and
        the associated user can see values, and ALL_DOMAIN_USERS- Any user in
        your domain can see values.
        E.g.
        {
          "fields": [
            {
              "fieldType": string,
              "fieldName": string,
              "displayName": string,
              "multiValued": boolean,
              "readAccessType": string,
              "indexed": boolean,
              "numericIndexingSpec": {
                "minValue": double,
                "maxValue": double
              }
            }
          ]
        }.
      name: field_json_entry_id
    description: |-
      Creates a custom user schema to add custom fields to user profiles.
      Note: field_raw_json has higher precedence when both field_raw_json and field_json_entry_id are provided.
    name: gsuite-custom-user-schema-create
    outputs:
    - contextPath: GSuite.UserSchema.kind
      description: The type of the API resource.
      type: String
    - contextPath: GSuite.UserSchema.etag
      description: The ETag of the resource.
      type: String
    - contextPath: GSuite.UserSchema.schemaId
      description: The unique identifier of the schema.
      type: String
    - contextPath: GSuite.UserSchema.schemaName
      description: The schema's name.
      type: String
    - contextPath: GSuite.UserSchema.displayName
      description: Display Name for the schema.
      type: String
    - contextPath: GSuite.UserSchema.fields.kind
      description: The kind of resource this is.
      type: String
    - contextPath: GSuite.UserSchema.fields.fieldId
      description: The unique identifier of the field.
      type: String
    - contextPath: GSuite.UserSchema.fields.etag
      description: The ETag of the field.
      type: String
    - contextPath: GSuite.UserSchema.fields.fieldType
      description: The type of the field.
      type: String
    - contextPath: GSuite.UserSchema.fields.fieldName
      description: The name of the field.
      type: String
    - contextPath: GSuite.UserSchema.fields.displayName
      description: Display name of the field.
      type: String
    - contextPath: GSuite.UserSchema.fields.multiValued
      description: A boolean specifying whether this is a multi-valued field or not.
      type: Boolean
    - contextPath: GSuite.UserSchema.fields.readAccessType
      description: Specifies who can view values of this field.
      type: Boolean
    - contextPath: GSuite.UserSchema.fields.indexed
      description: Specifies whether the field is indexed or not.
      type: Boolean
    - contextPath: GSuite.UserSchema.fields.numericIndexingSpecMinValue
      description: Minimum value of this field.
      type: Number
    - contextPath: GSuite.UserSchema.fields.numericIndexingSpecMaxValue
      description: Maximum value of this field.
      type: Number
  - arguments:
    - description: Email ID of the G Suite domain admin who acts on behalf of an end-user.
      name: admin_email
    - description: Immutable ID of the G Suite account.
      name: customer_id
    - description: The schema's name.
      name: schema_name
    - description: Immutable ID of the schema.
      name: schema_id
    - description: Display name for the schema.
      name: schema_display_name
    - description: |-
        Raw JSON containing fields of the schema. Acceptable values for
        fieldType are BOOL, DATE, DOUBLE, EMAIL, INT64, PHONE, and STRING. Acceptable
        values for readAccessType are ADMINS_AND_SELF- Only administrators and
        the associated user can see values, and ALL_DOMAIN_USERS- Any user in
        your domain can see values.
        E.g.
        {
          "fields": [
            {
              "fieldType": string,
              "fieldName": string,
              "displayName": string,
              "multiValued": boolean,
              "readAccessType": string,
              "indexed": boolean,
              "numericIndexingSpec": {
                "minValue": double,
                "maxValue": double
              }
            }
          ]
        }.
      name: field_raw_json
    - description: |-
        JSON file entry ID containing fields of the schema. Acceptable values for
        fieldType are BOOL, DATE, DOUBLE, EMAIL, INT64, PHONE, and STRING. Acceptable
        values for readAccessType are ADMINS_AND_SELF- Only administrators and
        the associated user can see values, and ALL_DOMAIN_USERS- Any user in
        your domain can see values.
        E.g.
        {
          "fields": [
            {
              "fieldType": string,
              "fieldName": string,
              "displayName": string,
              "multiValued": boolean,
              "readAccessType": string,
              "indexed": boolean,
              "numericIndexingSpec": {
                "minValue": double,
                "maxValue": double
              }
            }
          ]
        }.
      name: field_json_entry_id
    description: |-
      Updates a custom user schema.
      Note: field_raw_json has higher precedence when both field_raw_json and field_json_entry_id are provided.
    name: gsuite-custom-user-schema-update
    outputs:
    - contextPath: GSuite.UserSchema.kind
      description: The type of the API resource.
      type: String
    - contextPath: GSuite.UserSchema.etag
      description: The ETag of the resource.
      type: String
    - contextPath: GSuite.UserSchema.schemaId
      description: The unique identifier of the schema.
      type: String
    - contextPath: GSuite.UserSchema.schemaName
      description: The schema's name.
      type: String
    - contextPath: GSuite.UserSchema.displayName
      description: Display Name for the schema.
      type: String
    - contextPath: GSuite.UserSchema.fields.kind
      description: The kind of resource this is.
      type: String
    - contextPath: GSuite.UserSchema.fields.fieldId
      description: The unique identifier of the field.
      type: String
    - contextPath: GSuite.UserSchema.fields.etag
      description: The ETag of the field.
      type: String
    - contextPath: GSuite.UserSchema.fields.fieldType
      description: The type of the field.
      type: String
    - contextPath: GSuite.UserSchema.fields.fieldName
      description: The name of the field.
      type: String
    - contextPath: GSuite.UserSchema.fields.displayName
      description: Display name of the field.
      type: String
    - contextPath: GSuite.UserSchema.fields.multiValued
      description: A boolean specifying whether this is a multi-valued field or not.
      type: Boolean
    - contextPath: GSuite.UserSchema.fields.readAccessType
      description: Specifies who can view values of this field.
      type: Boolean
    - contextPath: GSuite.UserSchema.fields.indexed
      description: Specifies whether the field is indexed or not.
      type: Boolean
    - contextPath: GSuite.UserSchema.fields.numericIndexingSpecMinValue
      description: Minimum value of this field.
      type: Number
    - contextPath: GSuite.UserSchema.fields.numericIndexingSpecMaxValue
      description: Maximum value of this field.
      type: Number
  - arguments:
    - description: Email ID of the G Suite domain admin acts on behalf of an end-user.
      name: admin_email
    - description: ID of the user whose data is being transferred.
      name: old_owner_id
      required: true
    - description: ID of the user to whom the data is being transferred.
      name: new_owner_id
      required: true
    - description: The application's ID.
      name: application_id
    - description: Key and value pair of application data transfer parameters. Key
        and value must be delimited by (:) colon. Multiple values must be delimited
        by (,) comma. Multiple key-value pairs must be delimited by (;) semi-colon.
        E.g. key1:val;key2:val1,val2.
      name: application_transfer_params
    - description: |-
        Raw JSON containing the whole body of the application data transfers.
        E.g.
        {
          "applicationDataTransfers": [
            {
              "applicationId": long,
              "applicationTransferParams": [
                {
                  "key": string,
                  "value": [
                    string
                  ]
                }
              ]
            }
          ]
        }.
      name: applications_raw_json
    - description: |-
        JSON file Entry ID containing the whole body of the application data transfers.
        E.g.
        {
          "applicationDataTransfers": [
            {
              "applicationId": long,
              "applicationTransferParams": [
                {
                  "key": string,
                  "value": [
                    string
                  ]
                }
              ]
            }
          ]
        }.
      name: applications_raw_json_entry_id
    description: |-
      Inserts a data transfer request.
      Note: If all three applications_raw_json, applications_raw_json_entry_id and application_id are provided
      the higher precedence will be in order of applications_raw_json, applications_raw_json_entry_id,
      and application_id respectively.
    name: gsuite-datatransfer-request-create
    outputs:
    - contextPath: GSuite.DataTransfer.kind
      description: Identifies the resource as a DataTransfer request.
      type: String
    - contextPath: GSuite.DataTransfer.etag
      description: ETag of the resource.
      type: String
    - contextPath: GSuite.DataTransfer.id
      description: The transfer's ID.
      type: String
    - contextPath: GSuite.DataTransfer.oldOwnerUserId
      description: ID of the user whose data is being transferred.
      type: String
    - contextPath: GSuite.DataTransfer.newOwnerUserId
      description: ID of the user to whom the data is being transferred.
      type: String
    - contextPath: GSuite.DataTransfer.applicationDataTransfers.applicationId
      description: The application's ID.
      type: Number
    - contextPath: GSuite.DataTransfer.applicationDataTransfers.applicationTransferParams.key
      description: The type of the transfer parameter.
      type: String
    - contextPath: GSuite.DataTransfer.applicationDataTransfers.applicationTransferParams.value
      description: The value of the corresponding transfer parameter.
      type: Unknown
    - contextPath: GSuite.DataTransfer.applicationDataTransfers.applicationTransferStatus
      description: Current status of transfer for this application.
      type: String
    - contextPath: GSuite.DataTransfer.overallTransferStatusCode
      description: Overall transfer status.
      type: String
    - contextPath: GSuite.DataTransfer.requestTime
      description: The time at which the data transfer was requested.
      type: Date
  - arguments:
    - description: Identifies the user in the API request. The value can be the user's
        primary email address, alias email address, or unique user ID.
      name: user_key
      required: true
    - description: Email ID of the G Suite domain admin acts on behalf of an end-user.
      name: admin_email
    description: Deletes a user.
    name: gsuite-user-delete
  - arguments:
    - description: The user's first name.
      name: first_name
    - description: The user's last name.
      name: last_name
    - description: Stores the password for the user account. A password can contain
        any combination of ASCII characters. A minimum of 8 characters is required.
        The maximum length is 100 characters. The password will be sent in MD5 hash
        format.
      name: password
    - description: The user's primary email address. The primary_email must be unique
        and cannot be an alias of another user.
      name: primary_email
    - description: User's Country.
      name: country
    - auto: PREDEFINED
      description: The address type.
      name: address_type
      predefined:
      - home
      - other
      - work
    - description: The ZIP or postal code, if applicable.
      name: postal_code
    - auto: PREDEFINED
      description: Set to true, If this is the user's primary address.
      name: is_address_primary
      predefined:
      - "true"
      - "false"
    - description: For extended addresses, such as an address that includes a sub-region.
      name: extended_address
    - description: The abbreviated province or state.
      name: region
    - description: The street address, such as 1600 Amphitheatre Parkway. Whitespace
        within the string is ignored; however, newlines are significant.
      name: street_address
    - description: The user's secondary email address.
      name: secondary_email_address
    - auto: PREDEFINED
      description: The type of the secondary email account.
      name: secondary_email_type
      predefined:
      - home
      - other
      - work
    - auto: PREDEFINED
      description: User's gender.
      name: gender
      predefined:
      - female
      - male
      - other
      - unknown
    - auto: PREDEFINED
      description: If true, the user's IP address is on allow list.
      name: is_ip_white_listed
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: Content type of note, either plain text or HTML. If not provided,
        considered as plain text.
      name: notes_content_type
      predefined:
      - text_plain
      - text_html
    - description: Contents of notes.
      name: notes_value
    - description: A human-readable phone number. It may be in any telephone number
        format.
      name: phone_number
    - auto: PREDEFINED
      description: The type of phone number.
      name: phone_number_type
      predefined:
      - assistant
      - callback
      - car
      - company_main
      - grand_central
      - home
      - home_fax
      - isdn
      - main
      - mobile
      - other
      - other_fax
      - pager
      - radio
      - telex
      - tty_tdd
      - work
      - work_fax
      - work_mobile
      - work_pager
    - auto: PREDEFINED
      description: Indicates if this is the user's primary phone number. A user may
        only have one primary phone number.
      name: is_phone_number_primary
      predefined:
      - "true"
      - "false"
    - description: Recovery email of the user.
      name: recovery_email
    - description: 'Recovery phone of the user. The phone number must be in the E.164
        format, starting with the plus sign (+). Example: +16506661212.'
      name: recovery_phone
    - auto: PREDEFINED
      description: Indicates if the user is suspended.
      name: suspended
      predefined:
      - "true"
      - "false"
    - description: Email ID of the G Suite domain admin acts on behalf of an end-user.
      name: admin_email
    - description: Identifies the user in the API request. The value can be the user's
        primary email address, alias email address, or unique user ID.
      name: user_key
      required: true
    - auto: PREDEFINED
      description: Indicates if the user is archived.
      name: archived
      predefined:
      - "true"
      - "false"
    - description: To move the user to OU (Organization Unit). The full path of the
        parent organization associated with the user. If the parent organization is
        the top-level, it is represented as a forward slash (/).
      name: org_unit_path
    description: Updates a user.
    name: gsuite-user-update
    outputs:
    - contextPath: GSuite.User.id
      description: The unique ID for the user.
      type: String
    - contextPath: GSuite.User.primaryEmail
      description: The user's primary email address.
      type: String
    - contextPath: GSuite.User.firstName
      description: The user's first name.
      type: String
    - contextPath: GSuite.User.lastName
      description: The user's last name.
      type: String
    - contextPath: GSuite.User.customerId
      description: The unique ID for the customer's G Suite account.
      type: String
    - contextPath: GSuite.User.gender
      description: Gender.
      type: String
    - contextPath: GSuite.User.suspended
      description: Indicates if the user is suspended.
      type: Boolean
    - contextPath: GSuite.User.notesValue
      description: Contents of notes.
      type: String
    - contextPath: GSuite.User.notesContentType
      description: Content type of notes.
      type: String
    - contextPath: GSuite.User.isAdmin
      description: Indicates a user with super administrator privileges.
      type: Boolean
    - contextPath: GSuite.User.creationTime
      description: The time the user's account was created.
      type: Date
    - contextPath: GSuite.User.phones.value
      description: A human-readable phone number. It may be in any telephone number
        format.
      type: String
    - contextPath: GSuite.User.phones.type
      description: The type of phone number.
      type: String
    - contextPath: GSuite.User.phones.primary
      description: Indicates if this is the user's primary phone number.
      type: Boolean
    - contextPath: GSuite.User.phones.customType
      description: If the value of type is custom, this property contains the custom
        type.
      type: String
    - contextPath: GSuite.User.addresses.type
      description: The address type.
      type: String
    - contextPath: GSuite.User.addresses.customType
      description: If the address type is custom, this property contains the custom
        value.
      type: String
    - contextPath: GSuite.User.addresses.sourceIsStructured
      description: Indicates if the user-supplied address was formatted. Formatted
        addresses are not currently supported.
      type: Boolean
    - contextPath: GSuite.User.addresses.formatted
      description: A full and unstructured postal address. This is not synced with
        the structured address fields.
      type: String
    - contextPath: GSuite.User.addresses.poBox
      description: The post office box, if present.
      type: String
    - contextPath: GSuite.User.addresses.locality
      description: The town or city of the address.
      type: String
    - contextPath: GSuite.User.addresses.countryCode
      description: The country code. Uses the ISO 3166-1 standard.
      type: String
    - contextPath: GSuite.User.addresses.country
      description: Country.
      type: String
    - contextPath: GSuite.User.addresses.postalCode
      description: The ZIP or postal code.
      type: String
    - contextPath: GSuite.User.addresses.region
      description: The abbreviated province or state.
      type: String
    - contextPath: GSuite.User.addresses.streetAddress
      description: The street address.
      type: String
    - contextPath: GSuite.User.addresses.extendedAddress
      description: For extended addresses, such as an  address that includes a sub-region.
      type: String
    - contextPath: GSuite.User.addresses.primary
      description: If this is the user's primary address.
      type: Boolean
    - contextPath: GSuite.User.emails.address
      description: The user's secondary email.
      type: String
    - contextPath: GSuite.User.emails.type
      description: The secondary email type.
      type: String
    - contextPath: GSuite.User.emails.customType
      description: If the value of type is custom, this property contains the custom
        type string.
      type: String
    - contextPath: GSuite.User.emails.primary
      description: Indicates if this is the user's primary email. Only one entry can
        be marked as primary.
      type: Boolean
    - contextPath: GSuite.User.ipWhitelisted
      description: If true, the user's IP address is added to allow list.
      type: Boolean
    - contextPath: GSuite.User.recoveryEmail
      description: Recovery email of the user.
      type: String
    - contextPath: GSuite.User.isDelegatedAdmin
      description: Indicates if the user is a delegated administrator.
      type: Boolean
    - contextPath: GSuite.User.recoveryPhone
      description: Recovery phone of the user.
      type: String
    - contextPath: GSuite.User.orgUnitPath
      description: The full path of the parent organization associated with the user.
        If the parent organization is the top-level, it is represented as a forward
        slash (/).
      type: String
    - contextPath: GSuite.User.isMailboxSetup
      description: Indicates if the user's Google mailbox is created.
      type: Boolean
    - contextPath: GSuite.User.kind
      description: The type of the API resource.
      type: Boolean
    - contextPath: GSuite.User.etag
      description: ETag of the resource.
      type: Boolean
    - contextPath: GSuite.User.hashFunction
      description: Stores the hash format of the password property.
      type: String
    - contextPath: GSuite.User.archived
      description: Indicates if the user is archived.
      type: Boolean
    - contextPath: GSuite.User.fullName
      description: The user's full name formed by concatenating the first and last
        name values.
      type: String
    - contextPath: GSuite.User.lastLoginTime
      description: The last time the user logged into the user's account. The value
        is in ISO 8601 date and time format. The time is the complete date plus hours,
        minutes, and seconds in the form YYYY-MM-DDThh:mm:ssTZD. For example, 2010-04-05T17:30:04+01:00.
      type: Date
    - contextPath: GSuite.User.deletionTime
      description: The time the user's account was deleted. The value is in ISO 8601
        date and time format. The time is the complete date plus hours, minutes, and
        seconds in the form YYYY-MM-DDThh:mm:ssTZD. For example 2010-04-05T17:30:04+01:00.
      type: Date
    - contextPath: GSuite.User.agreedToTerms
      description: This property is true if the user has completed an initial login
        and accepted the Terms of Service agreement.
      type: Boolean
    - contextPath: GSuite.User.suspensionReason
      description: Has the reason a user account is suspended either by the administrator
        or by Google at the time of suspension. The property is returned only if the
        suspended property is true.
      type: String
    - contextPath: GSuite.User.changePasswordAtNextLogin
      description: Indicates if the user is forced to change their password at next
        login. This setting doesn't apply when the user signs in via a third-party
        identity provider.
      type: Boolean
    - contextPath: GSuite.User.ims.type
      description: Type of the user's Instant Messenger (IM) account.
      type: Boolean
    - contextPath: GSuite.User.ims.customType
      description: If the IM type is custom, this property holds the custom type string.
      type: String
    - contextPath: GSuite.User.ims.protocol
      description: An IM protocol identifies the IM network. The value can be a custom
        network or the standard network.
      type: String
    - contextPath: GSuite.User.ims.customProtocol
      description: If the protocol value is custom_protocol, this property holds the
        custom protocol's string.
      type: String
    - contextPath: GSuite.User.ims.im
      description: The user's IM network ID.
      type: String
    - contextPath: GSuite.User.ims.primary
      description: If this is the user's primary IM. Only one entry in the IM list
        can have a value of true.
      type: Boolean
    - contextPath: GSuite.User.externalIds.value
      description: The value of the external ID.
      type: String
    - contextPath: GSuite.User.externalIds.type
      description: The type of the external ID.
      type: String
    - contextPath: GSuite.User.externalIds.customType
      description: If the external ID type is custom, this property holds the custom
        type.
      type: String
    - contextPath: GSuite.User.relations.value
      description: The name of the person the user is related to.
      type: String
    - contextPath: GSuite.User.relations.type
      description: The type of relation.
      type: String
    - contextPath: GSuite.User.relations.customType
      description: If the value of type is custom, this property contains the custom
        type.
      type: String
    - contextPath: GSuite.User.organizations.name
      description: The name of the organization.
      type: String
    - contextPath: GSuite.User.organizations.title
      description: The user's title within the organization, for example 'member'
        or 'engineer'.
      type: String
    - contextPath: GSuite.User.organizations.primary
      description: Indicates if this is the user's primary organization. A user may
        only have one primary organization.
      type: Boolean
    - contextPath: GSuite.User.organizations.type
      description: The type of organization.
      type: String
    - contextPath: GSuite.User.organizations.customType
      description: If the value of type is custom, this property contains the custom
        type.
      type: String
    - contextPath: GSuite.User.organizations.department
      description: Specifies the department within the organization, such as 'sales'
        or 'engineering'.
      type: String
    - contextPath: GSuite.User.organizations.symbol
      description: Text string symbol of the organization. For example, the text symbol
        for Google is GOOG.
      type: String
    - contextPath: GSuite.User.organizations.location
      description: The physical location of the organization. This does not need to
        be a fully qualified address.
      type: String
    - contextPath: GSuite.User.organizations.description
      description: The description of the organization.
      type: String
    - contextPath: GSuite.User.organizations.domain
      description: The domain the organization belongs to.
      type: String
    - contextPath: GSuite.User.organizations.costCenter
      description: The cost center of the user's organization.
      type: String
    - contextPath: GSuite.User.organizations.fullTimeEquivalent
      description: The full-time equivalent millipercent within the organization (100000
        = 100%).
      type: String
    - contextPath: GSuite.User.languages.languageCode
      description: Language Code. Should be used for storing Google III LanguageCode
        string representation for language. Illegal values cause SchemaException.
      type: String
    - contextPath: GSuite.User.languages.customLanguage
      description: Other language. A user can provide their own language name if there
        is no corresponding Google III language code. If this is set, LanguageCode
        can't be set.
      type: String
    - contextPath: GSuite.User.posixAccounts.username
      description: The username of the account.
      type: String
    - contextPath: GSuite.User.posixAccounts.uid
      description: The POSIX compliant user ID.
      type: Number
    - contextPath: GSuite.User.posixAccounts.gid
      description: The default group ID.
      type: Number
    - contextPath: GSuite.User.posixAccounts.homeDirectory
      description: The path to the home directory for this account.
      type: String
    - contextPath: GSuite.User.posixAccounts.shell
      description: The path to the login shell for this account.
      type: String
    - contextPath: GSuite.User.posixAccounts.gecos
      description: The GECOS (user information) for this account.
      type: String
    - contextPath: GSuite.User.posixAccounts.systemId
      description: System identifier for which account Username or Uid apply to.
      type: String
    - contextPath: GSuite.User.posixAccounts.primary
      description: If this is user's primary account within the SystemId.
      type: Boolean
    - contextPath: GSuite.User.posixAccounts.accountId
      description: A POSIX account field identifier.
      type: String
    - contextPath: GSuite.User.posixAccounts.operatingSystemType
      description: The operating system type for this account.
      type: String
    - contextPath: GSuite.User.sshPublicKeys.key
      description: An SSH public key.
      type: String
    - contextPath: GSuite.User.sshPublicKeys.expirationTimeUsec
      description: An expiration time in microseconds since epoch.
      type: String
    - contextPath: GSuite.User.sshPublicKeys.fingerprint
      description: A SHA-256 fingerprint of the SSH public key.
      type: String
    - contextPath: GSuite.User.aliases
      description: List of the user's alias email addresses.
      type: Unknown
    - contextPath: GSuite.User.nonEditableAliases
      description: List of the user's non-editable alias email addresses. These are
        typically outside the account's primary domain or sub-domain.
      type: Unknown
    - contextPath: GSuite.User.websites.value
      description: The URL of the website.
      type: String
    - contextPath: GSuite.User.websites.primary
      description: If this is user's primary website or not.
      type: Boolean
    - contextPath: GSuite.User.websites.type
      description: The type or purpose of the website. For example, a website could
        be labeled as home or blog. Alternatively, an entry can have a custom type.
      type: String
    - contextPath: GSuite.User.websites.customType
      description: The custom type. Only used if the type is custom.
      type: String
    - contextPath: GSuite.User.locations.type
      description: The location type.
      type: String
    - contextPath: GSuite.User.locations.customType
      description: If the location type is custom, this property contains the custom
        value.
      type: String
    - contextPath: GSuite.User.locations.area
      description: Textual location. This is most useful for display purposes to concisely
        describe the location. For example, "Mountain View, CA", "Near Seattle".
      type: String
    - contextPath: GSuite.User.locations.buildingId
      description: Building identifier.
      type: String
    - contextPath: GSuite.User.locations.floorName
      description: Floor name/number.
      type: String
    - contextPath: GSuite.User.locations.floorSection
      description: Floor section. More specific location within the floor. For example,
        if a floor is divided into sections "A", "B", and "C", this field would identify
        one of those values.
      type: String
    - contextPath: GSuite.User.locations.deskCode
      description: Most specific textual code of individual desk location.
      type: String
    - contextPath: GSuite.User.keywords.type
      description: Each entry can have a type which indicates standard type of that
        entry. For example, keyword could be of type occupation or outlook. In addition
        to the standard type, an entry can have a custom type and can give it any
        name. Such types should have the CUSTOM value as type and also have a customType
        value.
      type: String
    - contextPath: GSuite.User.keywords.customType
      description: Custom Type.
      type: String
    - contextPath: GSuite.User.keywords.value
      description: Keyword.
      type: String
    - contextPath: GSuite.User.isEnrolledIn2Sv
      description: Is enrolled in 2-step verification.
      type: Boolean
    - contextPath: GSuite.User.isEnforcedIn2Sv
      description: Is 2-step verification enforced.
      type: Boolean
    - contextPath: GSuite.User.includeInGlobalAddressList
      description: Indicates if the user's profile is visible in the G Suite global
        address list when the contact sharing feature is enabled for the domain.
      type: Boolean
    - contextPath: GSuite.User.thumbnailPhotoUrl
      description: Photo Url of the user.
      type: String
    - contextPath: GSuite.User.thumbnailPhotoEtag
      description: ETag of the user's photo.
      type: String
    - contextPath: GSuite.User.customSchemas
      description: Custom fields of the user.
      type: Unknown
  - arguments:
    - description: 'One of the following: user email address, alias email address,
        or the unique user ID.'
      name: user
      required: true
    description: Retrieve a user's details given a user key.
    name: gsuite-user-get
    outputs:
    - contextPath: GSuite.User.id
      description: The unique ID for the user.
      type: String
    - contextPath: GSuite.User.primaryEmail
      description: The user's primary email address.
      type: String
    - contextPath: GSuite.User.firstName
      description: The user's first name.
      type: String
    - contextPath: GSuite.User.lastName
      description: The user's last name.
      type: String
    - contextPath: GSuite.User.customerId
      description: The unique ID for the customer's G Suite account.
      type: String
    - contextPath: GSuite.User.gender
      description: Gender.
      type: String
    - contextPath: GSuite.User.suspended
      description: Indicates if the user is suspended.
      type: Boolean
    - contextPath: GSuite.User.notesValue
      description: Contents of notes.
      type: String
    - contextPath: GSuite.User.notesContentType
      description: Content type of notes.
      type: String
    - contextPath: GSuite.User.isAdmin
      description: Indicates a user with super administrator privileges.
      type: Boolean
    - contextPath: GSuite.User.creationTime
      description: The time the user's account was created.
      type: Date
    - contextPath: GSuite.User.phones.value
      description: A human-readable phone number. It may be in any telephone number
        format.
      type: String
    - contextPath: GSuite.User.phones.type
      description: The type of phone number.
      type: String
    - contextPath: GSuite.User.phones.primary
      description: Indicates if this is the user's primary phone number.
      type: Boolean
    - contextPath: GSuite.User.phones.customType
      description: If the value of type is custom, this property contains the custom
        type.
      type: String
    - contextPath: GSuite.User.addresses.type
      description: The address type.
      type: String
    - contextPath: GSuite.User.addresses.customType
      description: If the address type is custom, this property contains the custom
        value.
      type: String
    - contextPath: GSuite.User.addresses.sourceIsStructured
      description: Indicates if the user-supplied address was formatted. Formatted
        addresses are not currently supported.
      type: Boolean
    - contextPath: GSuite.User.addresses.formatted
      description: A full and unstructured postal address. This is not synced with
        the structured address fields.
      type: String
    - contextPath: GSuite.User.addresses.poBox
      description: The post office box, if present.
      type: String
    - contextPath: GSuite.User.addresses.locality
      description: The town or city of the address.
      type: String
    - contextPath: GSuite.User.addresses.countryCode
      description: The country code. Uses the ISO 3166-1 standard.
      type: String
    - contextPath: GSuite.User.addresses.country
      description: Country.
      type: String
    - contextPath: GSuite.User.addresses.postalCode
      description: The ZIP or postal code.
      type: String
    - contextPath: GSuite.User.addresses.region
      description: The abbreviated province or state.
      type: String
    - contextPath: GSuite.User.addresses.streetAddress
      description: The street address.
      type: String
    - contextPath: GSuite.User.addresses.extendedAddress
      description: For extended addresses, such as an  address that includes a sub-region.
      type: String
    - contextPath: GSuite.User.addresses.primary
      description: If this is the user's primary address.
      type: Boolean
    - contextPath: GSuite.User.emails.address
      description: The user's secondary email.
      type: String
    - contextPath: GSuite.User.emails.type
      description: The secondary email type.
      type: String
    - contextPath: GSuite.User.emails.customType
      description: If the value of type is custom, this property contains the custom
        type string.
      type: String
    - contextPath: GSuite.User.emails.primary
      description: Indicates if this is the user's primary email. Only one entry can
        be marked as primary.
      type: Boolean
    - contextPath: GSuite.User.ipWhitelisted
      description: If true, the user's IP address is added to allow list.
      type: Boolean
    - contextPath: GSuite.User.recoveryEmail
      description: Recovery email of the user.
      type: String
    - contextPath: GSuite.User.isDelegatedAdmin
      description: Indicates if the user is a delegated administrator.
      type: Boolean
    - contextPath: GSuite.User.recoveryPhone
      description: Recovery phone of the user.
      type: String
    - contextPath: GSuite.User.orgUnitPath
      description: The full path of the parent organization associated with the user.
        If the parent organization is the top-level, it is represented as a forward
        slash (/).
      type: String
    - contextPath: GSuite.User.isMailboxSetup
      description: Indicates if the user's Google mailbox is created.
      type: Boolean
    - contextPath: GSuite.User.kind
      description: The type of the API resource.
      type: Boolean
    - contextPath: GSuite.User.etag
      description: ETag of the resource.
      type: Boolean
    - contextPath: GSuite.User.hashFunction
      description: Stores the hash format of the password property.
      type: String
    - contextPath: GSuite.User.archived
      description: Indicates if the user is archived.
      type: Boolean
    - contextPath: GSuite.User.fullName
      description: The user's full name formed by concatenating the first and last
        name values.
      type: String
    - contextPath: GSuite.User.lastLoginTime
      description: The last time the user logged into the user's account. The value
        is in ISO 8601 date and time format. The time is the complete date plus hours,
        minutes, and seconds in the form YYYY-MM-DDThh:mm:ssTZD. For example, 2010-04-05T17:30:04+01:00.
      type: Date
    - contextPath: GSuite.User.deletionTime
      description: The time the user's account was deleted. The value is in ISO 8601
        date and time format. The time is the complete date plus hours, minutes, and
        seconds in the form YYYY-MM-DDThh:mm:ssTZD. For example 2010-04-05T17:30:04+01:00.
      type: Date
    - contextPath: GSuite.User.agreedToTerms
      description: This property is true if the user has completed an initial login
        and accepted the Terms of Service agreement.
      type: Boolean
    - contextPath: GSuite.User.suspensionReason
      description: Has the reason a user account is suspended either by the administrator
        or by Google at the time of suspension. The property is returned only if the
        suspended property is true.
      type: String
    - contextPath: GSuite.User.changePasswordAtNextLogin
      description: Indicates if the user is forced to change their password at next
        login. This setting doesn't apply when the user signs in via a third-party
        identity provider.
      type: Boolean
    - contextPath: GSuite.User.ims.type
      description: Type of the user's Instant Messenger (IM) account.
      type: Boolean
    - contextPath: GSuite.User.ims.customType
      description: If the IM type is custom, this property holds the custom type string.
      type: String
    - contextPath: GSuite.User.ims.protocol
      description: An IM protocol identifies the IM network. The value can be a custom
        network or the standard network.
      type: String
    - contextPath: GSuite.User.ims.customProtocol
      description: If the protocol value is custom_protocol, this property holds the
        custom protocol's string.
      type: String
    - contextPath: GSuite.User.ims.im
      description: The user's IM network ID.
      type: String
    - contextPath: GSuite.User.ims.primary
      description: If this is the user's primary IM. Only one entry in the IM list
        can have a value of true.
      type: Boolean
    - contextPath: GSuite.User.externalIds.value
      description: The value of the external ID.
      type: String
    - contextPath: GSuite.User.externalIds.type
      description: The type of the external ID.
      type: String
    - contextPath: GSuite.User.externalIds.customType
      description: If the external ID type is custom, this property holds the custom
        type.
      type: String
    - contextPath: GSuite.User.relations.value
      description: The name of the person the user is related to.
      type: String
    - contextPath: GSuite.User.relations.type
      description: The type of relation.
      type: String
    - contextPath: GSuite.User.relations.customType
      description: If the value of type is custom, this property contains the custom
        type.
      type: String
    - contextPath: GSuite.User.organizations.name
      description: The name of the organization.
      type: String
    - contextPath: GSuite.User.organizations.title
      description: The user's title within the organization, for example 'member'
        or 'engineer'.
      type: String
    - contextPath: GSuite.User.organizations.primary
      description: Indicates if this is the user's primary organization. A user may
        only have one primary organization.
      type: Boolean
    - contextPath: GSuite.User.organizations.type
      description: The type of organization.
      type: String
    - contextPath: GSuite.User.organizations.customType
      description: If the value of type is custom, this property contains the custom
        type.
      type: String
    - contextPath: GSuite.User.organizations.department
      description: Specifies the department within the organization, such as 'sales'
        or 'engineering'.
      type: String
    - contextPath: GSuite.User.organizations.symbol
      description: Text string symbol of the organization. For example, the text symbol
        for Google is GOOG.
      type: String
    - contextPath: GSuite.User.organizations.location
      description: The physical location of the organization. This does not need to
        be a fully qualified address.
      type: String
    - contextPath: GSuite.User.organizations.description
      description: The description of the organization.
      type: String
    - contextPath: GSuite.User.organizations.domain
      description: The domain the organization belongs to.
      type: String
    - contextPath: GSuite.User.organizations.costCenter
      description: The cost center of the user's organization.
      type: String
    - contextPath: GSuite.User.organizations.fullTimeEquivalent
      description: The full-time equivalent millipercent within the organization (100000
        = 100%).
      type: String
    - contextPath: GSuite.User.languages.languageCode
      description: Language Code. Should be used for storing Google III LanguageCode
        string representation for language. Illegal values cause SchemaException.
      type: String
    - contextPath: GSuite.User.languages.customLanguage
      description: Other language. A user can provide their own language name if there
        is no corresponding Google III language code. If this is set, LanguageCode
        can't be set.
      type: String
    - contextPath: GSuite.User.posixAccounts.username
      description: The username of the account.
      type: String
    - contextPath: GSuite.User.posixAccounts.uid
      description: The POSIX compliant user ID.
      type: Number
    - contextPath: GSuite.User.posixAccounts.gid
      description: The default group ID.
      type: Number
    - contextPath: GSuite.User.posixAccounts.homeDirectory
      description: The path to the home directory for this account.
      type: String
    - contextPath: GSuite.User.posixAccounts.shell
      description: The path to the login shell for this account.
      type: String
    - contextPath: GSuite.User.posixAccounts.gecos
      description: The GECOS (user information) for this account.
      type: String
    - contextPath: GSuite.User.posixAccounts.systemId
      description: System identifier for which account Username or Uid apply to.
      type: String
    - contextPath: GSuite.User.posixAccounts.primary
      description: If this is user's primary account within the SystemId.
      type: Boolean
    - contextPath: GSuite.User.posixAccounts.accountId
      description: A POSIX account field identifier.
      type: String
    - contextPath: GSuite.User.posixAccounts.operatingSystemType
      description: The operating system type for this account.
      type: String
    - contextPath: GSuite.User.sshPublicKeys.key
      description: An SSH public key.
      type: String
    - contextPath: GSuite.User.sshPublicKeys.expirationTimeUsec
      description: An expiration time in microseconds since epoch.
      type: String
    - contextPath: GSuite.User.sshPublicKeys.fingerprint
      description: A SHA-256 fingerprint of the SSH public key.
      type: String
    - contextPath: GSuite.User.aliases
      description: List of the user's alias email addresses.
      type: Unknown
    - contextPath: GSuite.User.nonEditableAliases
      description: List of the user's non-editable alias email addresses. These are
        typically outside the account's primary domain or sub-domain.
      type: Unknown
    - contextPath: GSuite.User.websites.value
      description: The URL of the website.
      type: String
    - contextPath: GSuite.User.websites.primary
      description: If this is user's primary website or not.
      type: Boolean
    - contextPath: GSuite.User.websites.type
      description: The type or purpose of the website. For example, a website could
        be labeled as home or blog. Alternatively, an entry can have a custom type.
      type: String
    - contextPath: GSuite.User.websites.customType
      description: The custom type. Only used if the type is custom.
      type: String
    - contextPath: GSuite.User.locations.type
      description: The location type.
      type: String
    - contextPath: GSuite.User.locations.customType
      description: If the location type is custom, this property contains the custom
        value.
      type: String
    - contextPath: GSuite.User.locations.area
      description: Textual location. This is most useful for display purposes to concisely
        describe the location. For example, "Mountain View, CA", "Near Seattle".
      type: String
    - contextPath: GSuite.User.locations.buildingId
      description: Building identifier.
      type: String
    - contextPath: GSuite.User.locations.floorName
      description: Floor name/number.
      type: String
    - contextPath: GSuite.User.locations.floorSection
      description: Floor section. More specific location within the floor. For example,
        if a floor is divided into sections "A", "B", and "C", this field would identify
        one of those values.
      type: String
    - contextPath: GSuite.User.locations.deskCode
      description: Most specific textual code of individual desk location.
      type: String
    - contextPath: GSuite.User.keywords.type
      description: Each entry can have a type which indicates standard type of that
        entry. For example, keyword could be of type occupation or outlook. In addition
        to the standard type, an entry can have a custom type and can give it any
        name. Such types should have the CUSTOM value as type and also have a customType
        value.
      type: String
    - contextPath: GSuite.User.keywords.customType
      description: Custom Type.
      type: String
    - contextPath: GSuite.User.keywords.value
      description: Keyword.
      type: String
    - contextPath: GSuite.User.isEnrolledIn2Sv
      description: Is enrolled in 2-step verification.
      type: Boolean
    - contextPath: GSuite.User.isEnforcedIn2Sv
      description: Is 2-step verification enforced.
      type: Boolean
    - contextPath: GSuite.User.includeInGlobalAddressList
      description: Indicates if the user's profile is visible in the G Suite global
        address list when the contact sharing feature is enabled for the domain.
      type: Boolean
    - contextPath: GSuite.User.thumbnailPhotoUrl
      description: Photo Url of the user.
      type: String
    - contextPath: GSuite.User.thumbnailPhotoEtag
      description: ETag of the user's photo.
      type: String
    - contextPath: GSuite.User.customSchemas
      description: Custom fields of the user.
      type: Unknown
  - arguments:
    - description: 'One of the following: group email address, group alias, or the
        unique group ID.'
      name: group
      required: true
    description: Retreive a group's details given a group key.
    name: gsuite-group-get
    outputs:
    - contextPath: GSuite.Group.kind
      description: The type of the API resource.
      type: String
    - contextPath: GSuite.Group.id
      description: The unique ID of a group.
      type: String
    - contextPath: GSuite.Group.etag
      description: ETag of the resource.
      type: String
    - contextPath: GSuite.Group.email
      description: The group's email address.
      type: String
    - contextPath: GSuite.Group.name
      description: The group's display name.
      type: String
    - contextPath: GSuite.Group.directMembersCount
      description: The number of users that are direct members of the group.
      type: String
    - contextPath: GSuite.Group.description
      description: An extended description to help users determine the purpose of
        a group.
      type: String
    - contextPath: GSuite.Group.adminCreated
      description: Value is true if this group was created by an administrator rather
        than a user.
      type: Boolean
    - contextPath: GSuite.Group.aliases
      description: List of a group's alias email addresses.
      type: String
    - contextPath: GSuite.Group.nonEditableAliases
      description: List of the group's non-editable alias email addresses that are
        outside of the account's primary domain or subdomains.
      type: String
  - arguments:
    - description: 'One of the following: user email address, alias email address,
        or the unique user ID.'
      name: user_key
      required: true
    description: Indicates if the user is forced to change their password at next
      login.
    name: gsuite-user-reset-password
    outputs:
    - contextPath: GSuite.User.id
      description: The unique ID for the user.
      type: String
    - contextPath: GSuite.User.primaryEmail
      description: The user's primary email address.
      type: String
    - contextPath: GSuite.User.firstName
      description: The user's first name.
      type: String
    - contextPath: GSuite.User.lastName
      description: The user's last name.
      type: String
    - contextPath: GSuite.User.customerId
      description: The unique ID for the customer's G Suite account.
      type: String
    - contextPath: GSuite.User.gender
      description: The user's gender.
      type: String
    - contextPath: GSuite.User.suspended
      description: Indicates if the user is suspended.
      type: Boolean
    - contextPath: GSuite.User.notesValue
      description: Content of the notes.
      type: String
    - contextPath: GSuite.User.notesContentType
      description: Content type of the notes.
      type: String
    - contextPath: GSuite.User.isAdmin
      description: Indicates a user with super administrator privileges.
      type: Boolean
    - contextPath: GSuite.User.creationTime
      description: The time the user's account was created.
      type: Date
    - contextPath: GSuite.User.phones.value
      description: A human-readable phone number. It may be in any telephone number
        format.
      type: String
    - contextPath: GSuite.User.phones.type
      description: The type of phone number.
      type: String
    - contextPath: GSuite.User.phones.primary
      description: Indicates if this is the user's primary phone number.
      type: Boolean
    - contextPath: GSuite.User.phones.customType
      description: If the value of type is custom, this property contains the custom
        type string.
      type: String
    - contextPath: GSuite.User.addresses.type
      description: The address type.
      type: String
    - contextPath: GSuite.User.addresses.customType
      description: If the value of type is custom, this property contains the custom
        type string.
      type: String
    - contextPath: GSuite.User.addresses.sourceIsStructured
      description: Indicates if the user-supplied address was formatted. Formatted
        addresses are not currently supported.
      type: Boolean
    - contextPath: GSuite.User.addresses.formatted
      description: A full and unstructured postal address. This is not synced with
        the structured address fields.
      type: String
    - contextPath: GSuite.User.addresses.poBox
      description: The post office box, if present.
      type: String
    - contextPath: GSuite.User.addresses.locality
      description: The town or city of the address.
      type: String
    - contextPath: GSuite.User.addresses.countryCode
      description: The country code. Uses the ISO 3166-1 standard.
      type: String
    - contextPath: GSuite.User.addresses.country
      description: Country.
      type: String
    - contextPath: GSuite.User.addresses.postalCode
      description: The ZIP or postal code.
      type: String
    - contextPath: GSuite.User.addresses.region
      description: The abbreviated province or state.
      type: String
    - contextPath: GSuite.User.addresses.streetAddress
      description: The street address.
      type: String
    - contextPath: GSuite.User.addresses.extendedAddress
      description: For extended addresses, such as an address that includes a sub-region.
      type: String
    - contextPath: GSuite.User.addresses.primary
      description: If this is the user's primary address.
      type: Boolean
    - contextPath: GSuite.User.emails.address
      description: The user's secondary email.
      type: String
    - contextPath: GSuite.User.emails.type
      description: The secondary email type.
      type: String
    - contextPath: GSuite.User.emails.customType
      description: If the value of type is custom, this property contains the custom
        type string.
      type: String
    - contextPath: GSuite.User.emails.primary
      description: Indicates if this is the user's primary email. Only one entry can
        be marked as primary.
      type: Boolean
    - contextPath: GSuite.User.ipWhitelisted
      description: If true, the user's IP address is added to the allow list.
      type: Boolean
    - contextPath: GSuite.User.recoveryEmail
      description: Recovery email of the user.
      type: String
    - contextPath: GSuite.User.isDelegatedAdmin
      description: Indicates if the user is a delegated administrator.
      type: Boolean
    - contextPath: GSuite.User.recoveryPhone
      description: Recovery phone of the user.
      type: String
    - contextPath: GSuite.User.orgUnitPath
      description: The full path of the parent organization associated with the user.
        If the parent organization is the top-level, it is represented as a forward
        slash (/).
      type: String
    - contextPath: GSuite.User.isMailboxSetup
      description: Indicates if the user's Google mailbox is created.
      type: Boolean
    - contextPath: GSuite.User.kind
      description: The type of the API resource.
      type: Boolean
    - contextPath: GSuite.User.etag
      description: ETag of the resource.
      type: Boolean
    - contextPath: GSuite.User.hashFunction
      description: Stores the hash format of the password property.
      type: String
    - contextPath: GSuite.User.archived
      description: Indicates if the user is archived.
      type: Boolean
    - contextPath: GSuite.User.fullName
      description: The user's full name formed by concatenating the first and last
        name values.
      type: String
    - contextPath: GSuite.User.lastLoginTime
      description: The last time the user logged into the user's account. The value
        is in ISO 8601 date and time format. The time is the complete date plus hours,
        minutes, and seconds in the form YYYY-MM-DDThh:mm:ssTZD. For example, 2010-04-05T17:30:04+01:00.
      type: Date
    - contextPath: GSuite.User.deletionTime
      description: The time the user's account was deleted. The value is in ISO 8601
        date and time format. The time is the complete date plus hours, minutes, and
        seconds in the form YYYY-MM-DDThh:mm:ssTZD. For example 2010-04-05T17:30:04+01:00.
      type: Date
    - contextPath: GSuite.User.agreedToTerms
      description: This property is true if the user has completed an initial login
        and accepted the Terms of Service agreement.
      type: Boolean
    - contextPath: GSuite.User.suspensionReason
      description: The reason a user account is suspended either by the administrator
        or by Google at the time of suspension. The property is returned only if the
        suspended property is true.
      type: String
    - contextPath: GSuite.User.changePasswordAtNextLogin
      description: Indicates if the user is forced to change their password at next
        login. This setting doesn't apply when the user signs in via a third-party
        identity provider.
      type: Boolean
    - contextPath: GSuite.User.ims.type
      description: Type of the user's Instant Messenger (IM) account.
      type: Boolean
    - contextPath: GSuite.User.ims.customType
      description: If the IM type is custom, this property holds the custom type string.
      type: String
    - contextPath: GSuite.User.ims.protocol
      description: An IM protocol identifies the IM network. The value can be a custom
        network or the standard network.
      type: String
    - contextPath: GSuite.User.ims.customProtocol
      description: If the protocol value is custom_protocol, this property holds the
        custom protocol's string.
      type: String
    - contextPath: GSuite.User.ims.im
      description: The user's IM network ID.
      type: String
    - contextPath: GSuite.User.ims.primary
      description: If this is the user's primary IM. Only one entry in the IM list
        can have a value of true.
      type: Boolean
    - contextPath: GSuite.User.externalIds.value
      description: The value of the external ID.
      type: String
    - contextPath: GSuite.User.externalIds.type
      description: The type of the external ID.
      type: String
    - contextPath: GSuite.User.externalIds.customType
      description: If the external ID type is custom, this property holds the custom
        type.
      type: String
    - contextPath: GSuite.User.relations.value
      description: The name of the person the user is related to.
      type: String
    - contextPath: GSuite.User.relations.type
      description: The type of relationship.
      type: String
    - contextPath: GSuite.User.relations.customType
      description: If the value of type is custom, this property contains the custom
        type.
      type: String
    - contextPath: GSuite.User.organizations.name
      description: The name of the organization.
      type: String
    - contextPath: GSuite.User.organizations.title
      description: The user's title within the organization, for example 'member'
        or 'engineer'.
      type: String
    - contextPath: GSuite.User.organizations.primary
      description: Indicates if this is the user's primary organization. A user may
        only have one primary organization.
      type: Boolean
    - contextPath: GSuite.User.organizations.type
      description: The type of organization.
      type: String
    - contextPath: GSuite.User.organizations.customType
      description: If the value of type is custom, this property contains the custom
        type.
      type: String
    - contextPath: GSuite.User.organizations.department
      description: Specifies the department within the organization, such as 'sales'
        or 'engineering'.
      type: String
    - contextPath: GSuite.User.organizations.symbol
      description: Text string symbol of the organization. For example, the text symbol
        for Google is GOOG.
      type: String
    - contextPath: GSuite.User.organizations.location
      description: The physical location of the organization. This does not need to
        be a fully qualified address.
      type: String
    - contextPath: GSuite.User.organizations.description
      description: The description of the organization.
      type: String
    - contextPath: GSuite.User.organizations.domain
      description: The domain the organization belongs to.
      type: String
    - contextPath: GSuite.User.organizations.costCenter
      description: The cost center of the user's organization.
      type: String
    - contextPath: GSuite.User.organizations.fullTimeEquivalent
      description: The full-time equivalent millipercent within the organization (100000
        = 100%).
      type: String
    - contextPath: GSuite.User.languages.languageCode
      description: Language Code. Should be used for storing Google III LanguageCode
        string representation for language. Illegal values cause SchemaException.
      type: String
    - contextPath: GSuite.User.languages.customLanguage
      description: Other language. A user can provide their own language name if there
        is no corresponding Google III language code. If this is set, LanguageCode
        can't be set.
      type: String
    - contextPath: GSuite.User.posixAccounts.username
      description: The username of the account.
      type: String
    - contextPath: GSuite.User.posixAccounts.uid
      description: The POSIX compliant user ID.
      type: Number
    - contextPath: GSuite.User.posixAccounts.gid
      description: The default group ID.
      type: Number
    - contextPath: GSuite.User.posixAccounts.homeDirectory
      description: The path to the home directory for this account.
      type: String
    - contextPath: GSuite.User.posixAccounts.shell
      description: The path to the login shell for this account.
      type: String
    - contextPath: GSuite.User.posixAccounts.gecos
      description: The GECOS (user information) for this account.
      type: String
    - contextPath: GSuite.User.posixAccounts.systemId
      description: System identifier for which account Username or UID applies to.
      type: String
    - contextPath: GSuite.User.posixAccounts.primary
      description: If this is the user's primary account within the SystemId.
      type: Boolean
    - contextPath: GSuite.User.posixAccounts.accountId
      description: A POSIX account field identifier.
      type: String
    - contextPath: GSuite.User.posixAccounts.operatingSystemType
      description: The operating system type for this account.
      type: String
    - contextPath: GSuite.User.sshPublicKeys.key
      description: An SSH public key.
      type: String
    - contextPath: GSuite.User.sshPublicKeys.expirationTimeUsec
      description: An expiration time in microseconds since epoch.
      type: String
    - contextPath: GSuite.User.sshPublicKeys.fingerprint
      description: A SHA-256 fingerprint of the SSH public key.
      type: String
    - contextPath: GSuite.User.aliases
      description: List of the user's alias email addresses.
      type: Unknown
    - contextPath: GSuite.User.nonEditableAliases
      description: List of the user's non-editable alias email addresses. These are
        typically outside the account's primary domain or sub-domain.
      type: Unknown
    - contextPath: GSuite.User.websites.value
      description: The URL of the website.
      type: String
    - contextPath: GSuite.User.websites.primary
      description: If this is the user's primary website or not.
      type: Boolean
    - contextPath: GSuite.User.websites.type
      description: The type or purpose of the website. For example, a website could
        be labeled as home or blog. Alternatively, an entry can have a custom type.
      type: String
    - contextPath: GSuite.User.websites.customType
      description: The custom type. Only used if the type is custom.
      type: String
    - contextPath: GSuite.User.locations.type
      description: The location type.
      type: String
    - contextPath: GSuite.User.locations.customType
      description: If the location type is custom, this property contains the custom
        value.
      type: String
    - contextPath: GSuite.User.locations.area
      description: Textual location. This is most useful for display purposes to concisely
        describe the location. For example, "Mountain View, CA", "Near Seattle".
      type: String
    - contextPath: GSuite.User.locations.buildingId
      description: Building identifier.
      type: String
    - contextPath: GSuite.User.locations.floorName
      description: Floor name/number.
      type: String
    - contextPath: GSuite.User.locations.floorSection
      description: Floor section. More specific location within the floor. For example,
        if a floor is divided into sections "A", "B", and "C", this field would identify
        one of those values.
      type: String
    - contextPath: GSuite.User.locations.deskCode
      description: Most specific textual code of individual desk location.
      type: String
    - contextPath: GSuite.User.keywords.type
      description: Each entry can have a type which indicates the standard type of
        that entry. For example, keyword could be of type occupation or outlook. In
        addition to the standard type, an entry can have a custom type and can give
        it any name. Such types should have the CUSTOM value as type and also have
        a customType value.
      type: String
    - contextPath: GSuite.User.keywords.customType
      description: Custom Type.
      type: String
    - contextPath: GSuite.User.keywords.value
      description: Keyword.
      type: String
    - contextPath: GSuite.User.isEnrolledIn2Sv
      description: Is enrolled in 2-step verification.
      type: Boolean
    - contextPath: GSuite.User.isEnforcedIn2Sv
      description: Is 2-step verification enforced.
      type: Boolean
    - contextPath: GSuite.User.includeInGlobalAddressList
      description: Indicates if the user's profile is visible in the G Suite global
        address list when the contact sharing feature is enabled for the domain.
      type: Boolean
    - contextPath: GSuite.User.thumbnailPhotoUrl
      description: Photo URL of the user.
      type: String
    - contextPath: GSuite.User.thumbnailPhotoEtag
      description: ETag of the user's photo.
      type: String
    - contextPath: GSuite.User.customSchemas
      description: Custom fields of the user.
      type: Unknown
  - arguments:
    - description: The unique identifier of the customer's Google account.
      name: customer_id
    - description: A comma-separated list of unique device IDs of Chrome browser devices
        to move. A maximum of 600 browsers may be moved per request. To get resource_id,
        please use gsuite-chromebrowserdevice-list command.
      isArray: true
      name: resource_ids
      required: true
    - description: Destination organization unit to move devices to. Full path of
        the organizational unit or its ID prefixed with 'id:'.
      name: org_unit_path
      required: true
    description: To move Chrome browser devices assigned to an account from one organization
      unit to another.
    name: gsuite-chromebrowserdevice-move-ou
  - arguments:
    - description: The unique identifier of the customer's Google account.
      name: customer_id
    - description: The unique ID of the device.
      name: device_id
    - auto: PREDEFINED
      description: Field by which to order.
      name: order_by
      predefined:
      - id
      - last_sync
      - machine_name
      - extension_count
      - policy_count
      - os_version
      - last_signed_in_user
      - annotated_user
      - annotated_location
      - annotated_asset_id
      - notes
      - browser_version_channel
      - org_unit
      - enrollment_date
      - save_browsing_clickthrough
      - platform_major_version
      - last_activity
      - browser_version_sortable
      - os_version_sortable
    - description: The full path of the organizational unit or its unique ID.
      name: org_unit_path
    - auto: PREDEFINED
      description: Restrict information returned to a set of selected fields. "BASIC"
        - Includes only the basic metadata fields (i.e., the ones found in the columns
        of the admin console browser list as enumerated above). "FULL" - Includes
        all metadata fields (as enumerated above).
      name: projection
      predefined:
      - BASIC
      - FULL
    - description: Search string using the list page query language (Filter Query
        Language).
      name: query
    - auto: PREDEFINED
      description: 'Whether to return results in ascending or descending order. Must
        be used with the orderBy parameter. Possible values are: ASCENDING, DESCENDING.'
      name: sort_order
      predefined:
      - ASCENDING
      - DESCENDING
    - defaultValue: "100"
      description: The maximum number of policy schemas to return. Default and maximum
        are 100.
      name: page_size
    - description: Page token.
      name: page_token
    - defaultValue: "50"
      description: Limit of number of devices. Default is 100.
      name: limit
    description: Retrieve all Chrome browser devices for an account or a specific
      Chrome browser device.
    name: gsuite-chromebrowserdevice-list
    outputs:
    - contextPath: GSuite.ChromeBrowserDevices.nextPageToken
      description: The token of the next page.
      type: String
    - contextPath: GSuite.ChromeBrowserDevices.browserObjects.deviceId
      description: The unique Device ID for the device.
      type: String
    - contextPath: GSuite.ChromeBrowserDevices.browserObjects.kind
      description: The type of device.
      type: String
    - contextPath: GSuite.ChromeBrowserDevices.browserObjects.osPlatform
      description: operating system platform.
      type: String
    - contextPath: GSuite.ChromeBrowserDevices.browserObjects.osVersion
      description: Device operating system version.
      type: String
    - contextPath: GSuite.ChromeBrowserDevices.browserObjects.machineName
      description: Device machine name.
      type: String
    - contextPath: GSuite.ChromeBrowserDevices.browserObjects.lastRegistrationTime
      description: Device last registration time.
      type: String
    - contextPath: GSuite.ChromeBrowserDevices.browserObjects.lastActivityTime
      description: Device last activity time.
      type: String
    - contextPath: GSuite.ChromeBrowserDevices.browserObjects.osPlatformVersion
      description: Device operating system platform version.
      type: String
    - contextPath: GSuite.ChromeBrowserDevices.browserObjects.serialNumber
      description: Device serial number.
      type: String
    - contextPath: GSuite.ChromeBrowserDevices.browserObjects.virtualDeviceId
      description: Device virtual ID.
      type: String
    - contextPath: GSuite.ChromeBrowserDevices.browserObjects.orgUnitPath
      description: Device organizational unit path.
      type: String
    - contextPath: GSuite.ChromeBrowserDevices.browserObjects.deviceIdentifiersHistory
      description: Device identifier history.
      type: String
  - arguments:
    - description: ID of the Google Workspace account or literal 'my_customer' for
        the customer associated with the request.
      name: customer_id
    - auto: PREDEFINED
      description: In case of Group use “POST…groups:batchModify”. In case of OrgUnit
        use “POST…orgunits:batchModify”.
      name: target_type
      predefined:
      - Group
      - OrgUnit
      required: true
    - description: |-
        String as JSON representation of the ModifyGroupPolicyRequest
        {
            "requests": [
                {
                    "policyTargetKey": {
                        "targetResource": "orgunits/03ph8a2z1kjba6k",
                        "additionalTargetKeys": {
                            "app_id": "chrome:jldhpllghnbhlbpcmnajkpdmadaolakh"
                        }
                    },
                    "policyValue": {
                        "policySchema": "chrome.users.apps.InstallType",
                        "value": {
                            "appInstallType": "BLOCKED"
                        }
                    },
                    "updateMask": "appInstallType"
                }
           ]
        }
      name: policy_raw_json
    - description: Entry ID of the file that contains JSON representation of the ModifyGroupPolicyRequest.
      name: policy_field_json_entry_id
    - description: |-
        The target resource on which this policy is applied. The following resources are supported:

        Organizational Unit ("orgunits/{orgunit_id}")
        Group ("groups/{groupId}").
      name: target_resource
    - description: |-
        Map containing the additional target key name and value pairs used to further identify the target of the policy.

        A string containing a list of "key": "value" pairs. Example: ""name": "wrench", "mass": "1.3kg", "count": "3"".
      name: additional_target_keys
    - description: The fully qualified name of the policy schema that is being inherited.
      name: policy_schema
    - description: The value of the policy that is compatible with the schema that
        it is associated with Struct format.
      name: policy_value
    - description: |-
        Policy fields to update. Only fields in this mask will be updated; other fields in policyValue will be ignored (even if they have values). If a field is in this list it must have a value in 'policyValue'.
        This is a comma-separated list of fully qualified names of fields. Example: "user.displayName,photo".
        Field mask format.
      name: update_mask
    description: Modifies multiple policy values that are applied to a specific group.
      All targets must have the same target format. That is to say that they must
      point to the same target resource and must have the same keys specified in additionalTargetKeyNames,
      though the values for those keys may be different. On failure the request will
      return the error details as part of the google.rpc.Status.
    name: gsuite-policy-modify
  - arguments:
    - description: ID of the Google Workspace account or literal "my_customer" for
        the customer associated with the request.
      name: customer_id
    - description: The policy schema resource name to query. Required when asking
        for a specific policy.
      name: schema_name
    - description: The schema filter is used to find a particular schema based on
        fields like its resource name, description and additionalTargetKeyNames.
      name: filter
    - description: The maximum number of policy schemas to return. Defaults to 100
        and has a maximum of 1000.
      name: page_size
    - description: Page token.
      name: page_token
    - defaultValue: "50"
      description: Limit of policies returned.
      name: limit
    description: Gets a list of policy schemas that match a specified filter value
      for a given customer.
    name: gsuite-policy-schemas-list
    outputs:
    - contextPath: GSuite.PolicySchema.nextPageToken
      description: The token of the next page.
      type: String
    - contextPath: GSuite.PolicySchema.policySchemaObjects
      description: A list of policy schemas objects.
      type: List
    - contextPath: GSuite.PolicySchema.policySchemaObjects.name
      description: Policy name.
      type: String
    - contextPath: GSuite.PolicySchema.policySchemaObjects.policyDescription
      description: Policy description.
      type: String
    - contextPath: GSuite.PolicySchema.policySchemaObjects.definition
      description: Policy definition.
      type: Array
    - contextPath: GSuite.PolicySchema.policySchemaObjects.definition.enumType
      description: Policy definition ENUM type.
      type: List
    - contextPath: GSuite.PolicySchema.policySchemaObjects.definition.messageType
      description: Policy definition message type.
      type: List
    - contextPath: GSuite.PolicySchema.policySchemaObjects.fieldDescriptions
      description: Policy file description.
      type: Array
    - contextPath: GSuite.PolicySchema.policySchemaObjects.fieldDescriptions.description
      description: Policy file object description.
      type: String
    - contextPath: GSuite.PolicySchema.policySchemaObjects.fieldDescriptions.field
      description: Policy file description field.
      type: String
    - contextPath: GSuite.PolicySchema.policySchemaObjects.fieldDescriptions.fieldConstraints
      description: Policy file description field constraints.
      type: Array
    - contextPath: GSuite.PolicySchema.policySchemaObjects.fieldDescriptions.knownValueDescriptions
      description: Policy file description known value description.
      type: List
    - contextPath: GSuite.PolicySchema.policySchemaObjects.notices
      description: Policy notice.
      type: List
    - contextPath: GSuite.PolicySchema.policySchemaObjects.notices.acknowledgementRequired
      description: Policy notice is acknowledgement required.
      type: Boolean
    - contextPath: GSuite.PolicySchema.policySchemaObjects.notices.field
      description: Policy notice field.
      type: String
    - contextPath: GSuite.PolicySchema.policySchemaObjects.notices.noticeMessage
      description: Policy notice message.
      type: String
    - contextPath: GSuite.PolicySchema.policySchemaObjects.notices.noticeValue
      description: Policy notice value.
      type: String
    - contextPath: GSuite.PolicySchema.policySchemaObjects.supportUri
      description: Policy support URI.
      type: String
    - contextPath: GSuite.PolicySchema.policySchemaObjects.schemaName
      description: Policy schema name.
      type: String
    - contextPath: GSuite.PolicySchema.policySchemaObjects.validTargetResources
      description: Policy valid target resources.
      type: List
    - contextPath: GSuite.PolicySchema.policySchemaObjects.policyApiLifecycle
      description: Policy API lifecycle.
      type: Array
    - contextPath: GSuite.PolicySchema.policySchemaObjects.policyApiLifecycle.policyApiLifecycleStage
      description: Policy API lifecycle stage.
      type: String
    - contextPath: GSuite.PolicySchema.policySchemaObjects.categoryTitle
      description: Policy category title.
      type: String
    - contextPath: GSuite.PolicySchema.policySchemaObjects.supportedPlatforms
      description: Policy supported platforms.
      type: String
  - arguments:
    - description: ID of the Google Workspace account or literal "my_customer" for
        the customer associated with the request.
      name: customer_id
    - description: 'Specify a schema name to view a particular schema, for example:
        chrome.users.ShowLogoutButton. See https://developers.google.com/chrome/policy/guides/policy-schemas
        for details on schema namespaces.'
      name: policy_schema_filter
      required: true
    - auto: PREDEFINED
      description: Type of target.
      name: target_type
      predefined:
      - Group
      - OrgUnit
      required: true
    - description: 'The target resource on which this policy is applied. The following
        resources are supported: Organizational Unit ("orgunits/{orgunit_id}") or
        Group ("groups/{groupId}").'
      name: target_resource
      required: true
    - description: 'Map (key: string, value: string) containing the additional target
        key name and value pairs used to further identify the target of the policy.'
      name: additional_target_keys
    - description: The maximum number of policy schemas to return. Defaults to 100
        and has a maximum of 1000.
      name: page_size
    - description: Page token.
      name: page_token
    - defaultValue: "50"
      description: Limit of policies returned.
      name: limit
    description: Gets the resolved policy values for a list of policies that match
      a search query.
    name: gsuite-policy-resolve
    outputs:
    - contextPath: GSuite.Policy.nextPageToken
      description: The token of the next page.
      type: String
    - contextPath: GSuite.Policy.policyObject.targetKey.targetResource
      description: Policy target key target resource.
      type: String
    - contextPath: GSuite.Policy.policyObject.targetKey.additionalTargetKeys
      description: Policy target key additional target keys.
      type: String
    - contextPath: GSuite.Policy.policyObject.value.policySchema
      description: Policy schema value.
      type: String
    - contextPath: GSuite.Policy.policyObject.value.value
      description: Policy value.
      type: String
    - contextPath: GSuite.Policy.policyObject.sourceKey.targetResource
      description: Policy source key target resource.
      type: String
    - contextPath: GSuite.Policy.policyObject.addedSourceKey.targetResource
      description: Policy added source key target resource.
      type: String
  - arguments:
    - description: ID of the Google Workspace account or literal "my_customer" for
        the customer associated with the request.
      name: customer_id
    - description: |-
        String as JSON representation of the DeleteGroupPolicyRequest
        {
          "policyTargetKey": {
            object (PolicyTargetKey)
          },
          "policySchema": string
        }
      name: policy_raw_json
    - description: |-
        Entry Id of the file that contains JSON representation of the DeleteGroupPolicyRequest
        {
          "policyTargetKey": {
            object (PolicyTargetKey)
          },
          "policySchema": string
        }
      name: policy_field_json_entry_id
    - description: |-
        The target resource on which this policy is applied. The following resources are supported:

        Organizational Unit ("orgunits/{orgunit_id}")
        Group ("groups/{groupId}").
      name: target_resource
    - description: |-
        Map containing the additional target key name and value pairs used to further identify the target of the policy.

        An object containing a list of "key": value pairs. Example: { "name": "wrench", "mass": "1.3kg", "count": "3" }.
      name: additional_target_keys
    - description: The fully qualified name of the policy schema that is being inherited.
      name: policy_schema
    description: Delete multiple policy values that are applied to a specific group.
      All targets must have the same target format. That is to say that they must
      point to the same target resource and must have the same keys specified in additionalTargetKeyNames,
      though the values for those keys may be different. On failure the request will
      return the error details as part of the google.rpc.Status.
    name: gsuite-policy-groups-delete
  dockerimage: demisto/googleapi-python3:1.0.0.115338
  runonce: false
  script: |
    register_module_line('GSuiteAdmin', 'start', __line__())
    demisto.debug('pack name = G Suite Admin, pack version = 1.2.4')

    ''' IMPORTS '''

    import urllib.parse
    import urllib3
    import hashlib
    import copy
    from typing import Any, NamedTuple
    from collections.abc import Callable

    ### GENERATED CODE ###: from GSuiteApiModule import *  # noqa: E402
    # This code was inserted in place of an API module.
    register_module_line('GSuiteApiModule', 'start', __line__(), wrapper=-3)


    ''' IMPORTS '''

    import urllib.parse
    import httplib2
    from google.auth import exceptions
    from contextlib import contextmanager
    from google.oauth2 import service_account
    from google_auth_httplib2 import AuthorizedHttp
    from typing import List, Dict, Any, Tuple, Optional

    ''' CONSTANTS '''

    COMMON_MESSAGES: Dict[str, str] = {
        'TIMEOUT_ERROR': 'Connection Timeout Error - potential reasons might be that the Server URL parameter'
                         ' is incorrect or that the Server is not accessible from your host. Reason: {}',
        'HTTP_ERROR': 'HTTP Connection error occurred. Status: {}. Reason: {}',
        'TRANSPORT_ERROR': 'Transport error occurred. Reason: {}',
        'AUTHENTICATION_ERROR': 'Unauthenticated. Check the configured Service Account JSON. Reason: {}',
        'BAD_REQUEST_ERROR': 'An error occurred while fetching/submitting the data. Reason: {}',
        'TOO_MANY_REQUESTS_ERROR': 'Too many requests please try after sometime. Reason: {}',
        'INTERNAL_SERVER_ERROR': 'The server encountered an internal error. Reason: {}',
        'AUTHORIZATION_ERROR': 'Request has insufficient privileges. Reason: {}',
        'JSON_PARSE_ERROR': 'Unable to parse JSON string. Please verify the JSON is valid.',
        'NOT_FOUND_ERROR': 'Not found. Reason: {}',
        'UNKNOWN_ERROR': 'An error occurred. Status: {}. Reason: {}',
        'PROXY_ERROR': 'Proxy Error - if the \'Use system proxy\' checkbox in the integration configuration is'
                       ' selected, try clearing the checkbox.',
        'REFRESH_ERROR': 'Failed to generate/refresh token. Subject email or service account credentials'
                         ' are invalid. Reason: {}',
        'BOOLEAN_ERROR': 'The argument {} must be either true or false.',
        'INTEGER_ERROR': 'The argument {} must be a positive integer.',
        'UNEXPECTED_ERROR': 'An unexpected error occurred.',
    }


    class GSuiteClient:
        """
        Client to use in integration with powerful http_request.
        """

        def __init__(self, service_account_dict: Dict[str, str], proxy: bool, verify: bool,
                     base_url: str = '', headers: Optional[Dict[str, str]] = None,
                     user_id: str = ''):
            self.headers = headers
            try:
                self.credentials = service_account.Credentials.from_service_account_info(info=service_account_dict)
            except Exception:
                raise ValueError(COMMON_MESSAGES['JSON_PARSE_ERROR'])
            self.proxy = proxy
            self.verify = verify
            self.authorized_http: Any = None
            self.base_url = base_url
            self.user_id = user_id

        def set_authorized_http(self, scopes: List[str], subject: Optional[str] = None, timeout: int = 60) -> None:
            """
            Set the http client from given subject and scopes.

            :param scopes: List of scopes needed to make request.
            :param subject: To link subject with credentials.
            :param timeout: Timeout value for request.

            :return: None.
            """
            self.credentials = self.credentials.with_scopes(scopes)
            if subject:
                self.credentials = self.credentials.with_subject(subject)
            authorized_http = AuthorizedHttp(credentials=self.credentials,
                                             http=GSuiteClient.get_http_client(self.proxy, self.verify, timeout=timeout))
            self.authorized_http = authorized_http

        def http_request(self, url_suffix: str = None, params: Optional[Dict[str, Any]] = None,
                         method: str = 'GET',
                         body: Optional[Dict[str, Any]] = None, full_url: Optional[str] = None) -> Dict[str, Any]:
            """
            Makes an API call to URL using authorized HTTP.

            :param url_suffix: url_suffix of url.
            :param params: Parameters to pass in request url.
            :param method: Method to use while making http request.
            :param body: Request body.
            :param full_url: URL to consider for request when given url_suffix will be ignored.

            :return: response json.
            :raises DemistoException: If there is issues while making the http call.
            """
            encoded_params = f'?{urllib.parse.urlencode(params)}' if params else ''

            url = full_url

            if url_suffix:
                url = urljoin(self.base_url, url_suffix)

            url = f'{url}{encoded_params}'

            body = json.dumps(body) if body else None

            with GSuiteClient.http_exception_handler():
                response = self.authorized_http.request(headers=self.headers, method=method, uri=url, body=body)
                return GSuiteClient.validate_and_extract_response(response)

        @staticmethod
        def handle_http_error(error: httplib2.socks.HTTPError) -> None:
            """
            Handle and raise DemistoException with respective message.

            :param error: HTTPError object.

            :return: None
            :raises DemistoException: raise DemistoException with respective error message.
            """
            if error.args and isinstance(error.args[0], tuple):
                error_status, error_msg = error.args[0][0], error.args[0][1].decode()
                if error_status == 407:  # Proxy Error
                    raise DemistoException(COMMON_MESSAGES['PROXY_ERROR'])
                raise DemistoException(COMMON_MESSAGES['HTTP_ERROR'].format(error_status, error_msg))
            raise DemistoException(error)

        @staticmethod
        @contextmanager
        def http_exception_handler():
            """
            Exception handler for handling different exceptions while making http calls.

            :return: None
            :raises DemistoException: If there is any other issues while making the http call.
            """
            try:
                yield
            except httplib2.socks.HTTPError as error:
                GSuiteClient.handle_http_error(error)
            except exceptions.TransportError as error:
                if 'proxyerror' in str(error).lower():
                    raise DemistoException(COMMON_MESSAGES['PROXY_ERROR'])
                raise DemistoException(COMMON_MESSAGES['TRANSPORT_ERROR'].format(error))
            except exceptions.RefreshError as error:
                if error.args:
                    raise DemistoException(COMMON_MESSAGES['REFRESH_ERROR'].format(error.args[0]))
                raise DemistoException(error)
            except TimeoutError as error:
                raise DemistoException(COMMON_MESSAGES['TIMEOUT_ERROR'].format(error))
            except Exception as error:
                raise DemistoException(error)

        @staticmethod
        def get_http_client(proxy: bool, verify: bool, timeout: int = 60) -> httplib2.Http:
            """
            Validate proxy and prepares Http object.

            :param proxy: Boolean indicates whether to use proxy or not.
            :param verify: Boolean indicates whether to use ssl certification.
            :param timeout: Timeout value for request.

            :return: ProxyInfo object.
            :raises DemistoException: If there is any other issues while preparing proxy.
            """
            proxy_info = {}
            proxies = handle_proxy()
            if proxy:
                https_proxy = proxies['https']
                if not https_proxy.startswith('https') and not https_proxy.startswith('http'):
                    https_proxy = 'https://' + https_proxy
                parsed_proxy = urllib.parse.urlparse(https_proxy)
                proxy_info = httplib2.ProxyInfo(
                    proxy_type=httplib2.socks.PROXY_TYPE_HTTP,
                    proxy_host=parsed_proxy.hostname,
                    proxy_port=parsed_proxy.port,
                    proxy_user=parsed_proxy.username,
                    proxy_pass=parsed_proxy.password)

            return httplib2.Http(proxy_info=proxy_info, disable_ssl_certificate_validation=not verify, timeout=timeout)

        @staticmethod
        def validate_and_extract_response(response: Tuple[httplib2.Response, Any]) -> Dict[str, Any]:
            """
            Prepares an error message based on status code and extract a response.

            :param response: Tuple containing httplib2.Response and content.

            :return: response extracted json.
            :raises DemistoException: If there is any other issues parsing response.
            """
            if response[0].status == 200 or response[0].status == 204:
                return GSuiteClient.safe_load_non_strict_json(response[1])

            status_code_message_map = {
                400: COMMON_MESSAGES['BAD_REQUEST_ERROR'],
                401: COMMON_MESSAGES['AUTHENTICATION_ERROR'],
                403: COMMON_MESSAGES['AUTHORIZATION_ERROR'],
                404: COMMON_MESSAGES['NOT_FOUND_ERROR'],
                429: COMMON_MESSAGES['TOO_MANY_REQUESTS_ERROR'],
                500: COMMON_MESSAGES['INTERNAL_SERVER_ERROR']
            }

            try:
                # Depth details of error.
                demisto.debug(response[1].decode() if type(response[1]) is bytes else response[1])
                message = GSuiteClient.safe_load_non_strict_json(response[1]).get('error', {}).get('message', '')
            except ValueError:
                message = COMMON_MESSAGES['UNEXPECTED_ERROR']

            if response[0].status in status_code_message_map:
                raise DemistoException(status_code_message_map[response[0].status].format(message))
            else:
                raise DemistoException(COMMON_MESSAGES['UNKNOWN_ERROR'].format(response[0].status, message))

        @staticmethod
        def safe_load_non_strict_json(json_string: str) -> Dict[str, Any]:
            """
            Loads the JSON with non-strict mode.

            :param json_string: json string to parse.

            :return: Parsed dictionary.
            :raises ValueError: If there is any other issues while parsing json.
            """
            try:
                if json_string:
                    return json.loads(json_string, strict=False)
                return {}
            except ValueError:
                raise ValueError(COMMON_MESSAGES['JSON_PARSE_ERROR'])

        @staticmethod
        def validate_set_boolean_arg(args: Dict[str, Any], arg: str, arg_name: Optional[str] = None) -> None:
            """
            Set and validate boolean arguments.

            :param args: dictionary containing arguments.
            :param arg: key containing boolean arg.
            :param arg_name: In case of arg name is different in command to set in exception.

            :return: None
            :raises ValueError: if boolean arg value is invalid.
            """
            if arg in args:
                try:
                    args[arg] = argToBoolean(args[arg])
                except ValueError:
                    raise ValueError(COMMON_MESSAGES['BOOLEAN_ERROR'].format(arg_name if arg_name else arg))

        @staticmethod
        def remove_empty_entities(d):
            """
            Recursively remove empty lists, empty dicts, or None elements from a dictionary.

            :param d: Input dictionary.
            :return: Dictionary with all empty lists, and empty dictionaries removed.
            """

            def empty(x):
                return x is None or x == {} or x == [] or x == ''

            if not isinstance(d, (dict, list)):
                return d
            elif isinstance(d, list):
                return [value for value in (GSuiteClient.remove_empty_entities(value) for value in d) if not empty(value)]
            else:
                return {key: value for key, value in ((key, GSuiteClient.remove_empty_entities(value))
                                                      for key, value in d.items()) if not empty(value)}

        @staticmethod
        def validate_get_int(max_results: Optional[str], message: str, limit: int = 0) -> Optional[int]:
            """
            Validate and convert string max_results to integer.

            :param max_results: max results in string.
            :param message: Message to display when exception raised.
            :param limit: If max_results > limit raise the exception.

            :return: int max_results
            :raises ValueError: if max_results is not a integer and < 0.
            """
            if max_results:
                try:
                    max_results_int = int(max_results)
                    if max_results_int <= 0:
                        raise ValueError
                    if limit and max_results_int > limit:
                        raise ValueError
                    return max_results_int
                except ValueError:
                    raise ValueError(message)
            return None

        @staticmethod
        def strip_dict(args: Dict[str, str]) -> Dict[str, str]:
            """
            Remove leading and trailing white spaces from dictionary values and remove empty entries.

            :param args: Arguments dict.
            :return: Dictionary with whitespaces and empty entries removed.
            """
            return {key: value.strip() for (key, value) in args.items() if value and value.strip()}

    register_module_line('GSuiteApiModule', 'end', __line__(), wrapper=1)
    ### END GENERATED CODE ###
    # Disable insecure warnings
    urllib3.disable_warnings()

    ''' CONSTANTS '''
    MAX_PAGE_SIZE = 100
    DEFAULT_PAGE_SIZE = 50
    DEFAULT_LIMIT = 50

    MESSAGES: dict[str, str] = {
        'TEST_FAILED_ERROR': 'Test connectivity failed. Check the configuration parameters provided.',
        'TEST_CONFIGURE_ERROR': ('In order for the test_module to run, an admin_email is required, '
                                 'if it is not configured, then each command can receive an admin_email '
                                 'argument as an optional argument.'),
        'BOOLEAN_ERROR': 'The argument {} must be either true or false.',
        'INTEGER_ERROR': 'The argument {} must be a positive integer.',
        'REQUIRED_ARGS_CUSTOM_SCHEMA': 'Argument field_raw_json or field_json_entry_id is required.',
        'CUSTOM_SCHEMA_UPDATE_REQUIRED_ARGS': 'Argument schema_id or schema_name is required.',
        'UNEXPECTED_ERROR': 'An unexpected error occurred.',
        'DATATRANSFER_MISSING_ARGUMENT': 'The argument application_id or applications_raw_json'
                                         ' or application_raw_json_entry_id is required.',
        'DATATRANSFER_TRANSFER_PARAM_FORMAT_ERROR': 'application_transfer_params argument not in expected format. Please '
                                                    'provide a comma separated string of format "key1:val;key2:val1,val2"',
        'INVALID_ADMIN_EMAIL': 'Invalid value of argument/parameter Admin Email.',
        'INVALID_RESOURCE_CUSTOMER_ID_ERROR': 'Please check the resource_id and the customer_id arguments.',
        'INVALID_RESOURCE_ID_ERROR': 'Please check the resource_id argument.',
        'INVALID_ORG_UNIT_PATH': 'Please insert a valid organization unit path (org_unit_path)',
        'INVALID_PAGINATION_ARGS_SUPPLIED': ('In order to use pagination, please supply either the argument limit,'
                                             ' or the argument page_token, or the arguments page_token and page_size together.'),
        'EXCEEDED_MAX_PAGE_SIZE_ERROR': f'The maximum page size is {MAX_PAGE_SIZE}',
        'LIMIT_ARG_INVALID_ERROR': 'The limit argument can\'t be negative or equal to zero.',
    }

    HR_MESSAGES: dict[str, str] = {
        'MOBILE_UPDATE_SUCCESS': 'Mobile device with resource id - {} updated.',
        'MOBILE_DELETE_SUCCESS': 'Mobile device with resource id - {} deleted.',
        'USER_CREATE': 'User Details',
        'LIST_COMMAND_SUCCESS': 'Total Retrieved {}: {}',
        'ALIAS_ADD_SUCCESS': 'Added alias "{}" to user key "{}".',
        'GROUP_CREATE_SUCCESS': 'A new group named "{}" created.',
        'GROUP_GET_SUCCESS': 'Found group named "{}" .',
        'ROLE_ASSIGNMENT_CREATE': 'Role Assignment Details',
        'ROLE_CREATE_PRIVILEGES_INCORRECT_FORMAT': 'role_privileges argument missing or not in expected format. Please '
                                                   'provide a comma separated string of form "PrivilegeName1:ServiceId1,'
                                                   'PrivilegeName2:ServiceId2".',
        'ROLE_CREATE_SUCCESS': 'A new role created.',
        'TOKEN_REVOKE_SUCCESS': 'All access tokens deleted for {}.',
        'NO_RECORDS': 'No {} found for the given argument(s).',
        'CUSTOM_USER_SCHEMA_CREATE': 'Custom User Schema Details',
        'CUSTOM_USER_SCHEMA_FIELD_DETAILS': 'Field Details',
        'CUSTOM_USER_SCHEMA_UPDATE': 'Updated Custom User Schema Details',
        'DATATRANSFER_REQUEST_CREATE_SUCCESS': 'Data Transfer Details',
        'NOT_FOUND': 'No {} found.',
        'USER_DELETE': 'User with user key {} deleted successfully.',
        'USER_UPDATE': 'Updated User Details',
        'USER_GET': 'Retrieved details for user {}',
        'MOBILE_DEVICES_LIST_SUCCESS': 'Google Workspace Admin - Mobile Devices List',
        'CHROMEOS_DEVICES_LIST_SUCCESS': 'Google Workspace Admin - ChromeOS Devices List',
        'CHROMEOS_DEVICE_ACTION_SUCCESS': 'ChromeOS device with resource id - {} updated.',
        'USER_SIGNOUT_SESSIONS': 'Signs a {} out of all web and device sessions and reset their sign-in cookies.',
        'POLICY_LIST': 'Policy Schemas List',
        'CHROME_BROWSER_LIST': 'Chrome Browser Device List',
        'POLICY_RESOLVE': 'Resolved Policies'
    }

    URL_SUFFIX: dict[str, str] = {
        'DATA_TRANSFER': 'admin/datatransfer/v1/transfers',
        'USER': 'admin/directory/v1/users',
        'MOBILE_UPDATE': 'admin/directory/v1/customer/{}/devices/mobile/{}/action',
        'MOBILE_DELETE': 'admin/directory/v1/customer/{}/devices/mobile/{}',
        'USER_ALIAS': 'admin/directory/v1/users/{}/aliases',
        'GROUP_CREATE': 'admin/directory/v1/groups',
        'GROUP_GET': 'admin/directory/v1/groups/{}',
        'ROLE_ASSIGNMENT': 'admin/directory/v1/customer/{}/roleassignments',
        'ROLE_CREATE': 'admin/directory/v1/customer/{}/roles',
        'TOKEN_REVOKE': 'admin/directory/v1/users/{}/tokens/{}',
        'CUSTOM_USER_SCHEMA': 'admin/directory/v1/customer/{}/schemas',
        'DATA_TRANSFER_CREATE': 'admin/datatransfer/v1/transfers',
        'MOBILE_DEVICES_LIST': 'admin/directory/v1/customer/{}/devices/mobile',
        'CHROMEOS_DEVICE_ACTION': 'admin/directory/v1/customer/{}/devices/chromeos/{}/action',
        'CHROMEOS_DEVICES_LIST': 'admin/directory/v1/customer/{}/devices/chromeos',
        'USER_SIGN_OUT': 'admin/directory/v1/users/{}/signOut',

    }
    SCOPES: dict[str, list[str]] = {
        'DIRECTORY_USER': ['https://www.googleapis.com/auth/admin.directory.user'],
        'DEVICE_MOBILE': ['https://www.googleapis.com/auth/admin.directory.device.mobile'],
        'GROUP': ['https://www.googleapis.com/auth/admin.directory.group'],
        'ROLE_MANAGEMENT': ['https://www.googleapis.com/auth/admin.directory.rolemanagement'],
        'USER_SECURITY': ['https://www.googleapis.com/auth/admin.directory.user.security'],
        'DATA_TRANSFER': ['https://www.googleapis.com/auth/admin.datatransfer'],
        'CUSTOM_USER_SCHEMA': ['https://www.googleapis.com/auth/admin.directory.userschema'],
        'CHROME_BROWSERS': ['https://www.googleapis.com/auth/admin.directory.device.chromebrowsers'],
        'POLICY_MANAGEMENT': ['https://www.googleapis.com/auth/chrome.management.policy'],

    }

    COMMAND_SCOPES: dict[str, list[str]] = {
        'DATA_TRANSFER_LIST': ['https://www.googleapis.com/auth/admin.datatransfer.readonly', *SCOPES['DATA_TRANSFER']],
        'MOBILE_UPDATE': ['https://www.googleapis.com/auth/admin.directory.device.mobile.action'],
        'USER_ALIAS_ADD': ['https://www.googleapis.com/auth/admin.directory.user.alias',
                           'https://www.googleapis.com/auth/admin.directory.user'],
        'ROLE_ASSIGNMENT': ['https://www.googleapis.com/auth/admin.directory.rolemanagement.readonly',
                            *SCOPES['ROLE_MANAGEMENT']],
        'MOBILE_DEVICES_LIST': ['https://www.googleapis.com/auth/admin.directory.device.mobile.readonly'],
        'CHROMEOS_DEVICE_ACTION': ['https://www.googleapis.com/auth/admin.directory.device.chromeos'],
        'CHROMEOS_DEVICES_LIST': ['https://www.googleapis.com/auth/admin.directory.device.chromeos.readonly'],
    }

    OUTPUT_PREFIX: dict[str, str] = {
        'CREATE_USER': 'GSuite.User',
        'ADD_ALIAS': 'GSuite.UserAlias',
        'GROUP': 'GSuite.Group',
        'ROLE_ASSIGNMENT_LIST': 'GSuite.RoleAssignment(val.roleAssignmentId == obj.roleAssignmentId)',
        'ROLE_ASSIGNMENT_LIST_PAGE_TOKEN': 'GSuite.PageToken.RoleAssignment',
        'ROLE_ASSIGNMENT_CREATE': 'GSuite.RoleAssignment',
        'ROLE': 'GSuite.Role',
        'DATA_TRANSFER_LIST': 'GSuite.DataTransfer(val.id == obj.id)',
        'DATA_TRANSFER_REQUEST_CREATE': 'GSuite.DataTransfer',
        'DATA_TRANSFER_LIST_PAGE_TOKEN': 'GSuite.PageToken.DataTransfer',
        'CUSTOM_USER_SCHEMA': 'GSuite.UserSchema',
        'MOBILE_DEVICES_LIST': 'GSuite.MobileDevices',
        'CHROMEOS_DEVICES_LIST': 'GSuite.ChromeOSDevices',
        'POLICY SCHEMAS': 'GSuite.PolicySchema',
        'CHROME_BROWSERS': 'GSuite.ChromeBrowserDevices',
        'POLICY_RESOLVE': 'GSuite.Policy'
    }


    # New Classes and Named Tuples
    class DevicesCommandConfig(NamedTuple):
        table_headers: list[str]
        table_title: str
        response_devices_list_key: str
        outputs_prefix: str


    MobileDevicesConfig = DevicesCommandConfig(table_headers=['Serial Number', 'User Names', 'Model Name', 'OS', 'Type', 'Status'],
                                               table_title=HR_MESSAGES.get('MOBILE_DEVICES_LIST_SUCCESS', ''),
                                               response_devices_list_key='mobiledevices',
                                               outputs_prefix=OUTPUT_PREFIX.get('MOBILE_DEVICES_LIST', ''),
                                               )

    ChromeOSDevicesConfig = DevicesCommandConfig(table_headers=['Serial Number', 'User Name', 'Model Name', 'OS', 'Status'],
                                                 table_title=HR_MESSAGES.get('CHROMEOS_DEVICES_LIST_SUCCESS', ''),
                                                 response_devices_list_key='chromeosdevices',
                                                 outputs_prefix=OUTPUT_PREFIX.get('CHROMEOS_DEVICES_LIST', ''),
                                                 )


    class Client(GSuiteClient):
        '''
            This class is in charge of calling the set_authorized_http function of the GSuiteClient with the required scopes
            and subject (admin_email, which can be as a command argument or integration parameter)
        '''

        def __init__(self, service_account_dict: dict[str, Any], proxy: bool, verify: bool, headers: Optional[dict[str, str]] = None,
                     base_url: str = '', admin_email: str = ''):
            super().__init__(service_account_dict=service_account_dict,
                             base_url=base_url, verify=verify, proxy=proxy,
                             headers=headers)
            self.admin_email = admin_email

        def set_authorized_http(self, scopes: list[str], subject: Optional[str] = None, timeout: int = 60) -> None:
            if not subject:
                subject = self.admin_email
            super().set_authorized_http(scopes=scopes, subject=subject, timeout=timeout)


    def return_customer_id(args):
        if not (customer_id := args.get('customer_id') or demisto.params().get('customer_id')):
            raise DemistoException("Missing required customer ID - either provide as an argument or set a parameter")
        return customer_id


    def return_file_from_entry_id(entry_id):  # pragma: no cover
        try:
            file_info = demisto.getFilePath(entry_id)

        except Exception as e:
            return_error(f"Failed to get the file path for entry: {entry_id} the error message was {str(e)}")

        file_path = file_info.get("path")

        # Open file and read data
        with open(file_path) as f:  # type: ignore
            dict_list = json.load(f)
        return dict_list


    def prepare_output_user_alias_add(alias: dict[str, Any]) -> list[dict[str, Any]]:
        """
        To create context output for gsuite-user-alias-add.

        :param alias: dictionary containing alias information.
        :return: context output list.
        """
        return GSuiteClient.remove_empty_entities({
            'kind': alias.get('kind', ''),
            'id': alias.get('id', ''),
            'etag': alias.get('etag', ''),
            'alias': alias.get('alias', '')
        })


    def prepare_args_for_user(args: dict[str, str]) -> dict[str, Any]:
        """
        Prepares and maps argument for gsuite-user-create and gsuite-user-update command.

        :param args: Command arguments.

        :return: Prepared argument dictionary for filter create API.
        """
        GSuiteClient.validate_set_boolean_arg(args, 'is_address_primary')
        GSuiteClient.validate_set_boolean_arg(args, 'is_phone_number_primary')
        GSuiteClient.validate_set_boolean_arg(args, 'suspended')
        GSuiteClient.validate_set_boolean_arg(args, 'archived')
        GSuiteClient.validate_set_boolean_arg(args, 'is_ip_white_listed')
        return GSuiteClient.remove_empty_entities({
            'name': {'familyName': args.get('last_name'),
                     'givenName': args.get('first_name')
                     },
            'password': hashlib.md5(args['password'].encode()).hexdigest() if args.get('password') else None,  # nosec
            'hashFunction': 'MD5' if args.get('password') else None,
            'primaryEmail': args.get('primary_email'),
            'addresses': [{
                'country': args.get('country'),
                'type': args.get('address_type'),
                'postalCode': args.get('postal_code'),
                'primary': args.get('is_address_primary'),
                'extendedAddress': args.get('extended_address'),
                'region': args.get('region', ''),
                'streetAddress': args.get('street_address')
            }],
            'emails': [{
                'address': args.get('secondary_email_address'),
                'type': args.get('secondary_email_type')
            }],
            'gender': {
                'type': args.get('gender')
            },
            'ipWhitelisted': args.get('is_ip_white_listed', ''),
            'notes': {
                'contentType': args.get('notes_content_type', ''),
                'value': args.get('notes_value', ''),
            },
            'phones': [{
                'value': args.get('phone_number'),
                'type': args.get('phone_number_type'),
                'primary': args.get('is_phone_number_primary'),

            }],
            'recoveryEmail': args.get('recovery_email'),
            'recoveryPhone': args.get('recovery_phone'),
            'suspended': args.get('suspended'),
            'archived': args.get('archived'),
            'orgUnitPath': args.get('org_unit_path')
        })


    def prepare_output_for_user_command(response: dict[str, Any]) -> dict[str, Any]:
        """
        Prepares output for gsuite-user commands.

        :param response: response from API.

        :return: Prepared output dictionary.
        """
        outputs = {
            'firstName': response.get('name', {}).pop('givenName', ''),
            'fullName': response.get('name', {}).pop('fullName', ''),
            'lastName': response.get('name', {}).pop('familyName', ''),
            'gender': response.pop('gender', {}).get('type', ''),
            'notesValue': response.get('notes', {}).pop('value', ''),
            'notesContentType': response.get('notes', {}).pop('contentType', '')
        }
        outputs.update(response)

        return GSuiteClient.remove_empty_entities(outputs)


    def prepare_markdown_from_dictionary(data: dict[str, Any], ignore_fields: list[str] = []) -> str:
        """
        Prepares markdown from dictionary.

        :param data: data directory.
        :param ignore_fields: fields to ignore while preparing mark-down from dictionary.

        :return: data in markdown format.
        """
        hr_cell_info: list[str] = []
        for key, value in data.items():
            if key not in ignore_fields:
                hr_cell_info.append(
                    '{}: {}'.format(pascalToSpace(key), ', '.join(value) if isinstance(value, list) else value))
        return '\n'.join(hr_cell_info)


    def prepare_readable_output_for_user_command(outputs):
        """
        Prepares readable output for gsuite-user commands.

        :param outputs: output context.

        :return: Prepared readable output dictionary.
        """

        readable_outputs = {
            'addressDetails': prepare_markdown_from_dictionary(
                outputs.pop('addresses', [])[0] if outputs.get('addresses', []) else {}),
            'secondaryEmailDetails': prepare_markdown_from_dictionary(
                outputs.pop('emails', [])[0] if outputs.get('emails', []) else {}),
            'phoneDetails': prepare_markdown_from_dictionary(
                outputs.pop('phones', [])[0] if outputs.get('phones', []) else {}),
        }
        readable_outputs.update(outputs)
        return readable_outputs


    def prepare_args_for_role_assignment_list(args: dict[str, str]) -> dict[str, str]:
        """
        Prepares arguments for gsuite-role-assignment-list command.

        :param args: Command arguments.

        :return: Prepared arguments.
        """
        return GSuiteClient.remove_empty_entities({
            'pageToken': args.get('page_token'),
            'roleId': args.get('role_id'),
            'userKey': args.get('user_key'),
            'maxResults': GSuiteClient.validate_get_int(args.get('max_results'),
                                                        MESSAGES['INTEGER_ERROR'].format('max_results'))
        })


    def prepare_output_for_role_assignment_list(response: dict[str, Any]) -> dict[str, Any]:
        """
        prepares context output for gsuite-role-assignment-list.

        :param response: API response.

        :return: output dictionary.
        """
        return GSuiteClient.remove_empty_entities({
            OUTPUT_PREFIX['ROLE_ASSIGNMENT_LIST']: response.get('items', []),
            OUTPUT_PREFIX['ROLE_ASSIGNMENT_LIST_PAGE_TOKEN']: {
                'nextPageToken': response['nextPageToken']
            } if response.get('nextPageToken', '') else {}
        })


    def prepare_args_for_role_assignment_create(args: dict[str, str]) -> dict[str, str]:
        """
        Prepares arguments for gsuite-role-assignment-create command.

        :param args: Command arguments.

        :return: Prepared arguments.
        """
        return GSuiteClient.remove_empty_entities({
            'orgUnitId': args.get('org_unit_id'),
            'roleId': args.get('role_id'),
            'assignedTo': args.get('assigned_to'),
            'scopeType': args.get('scope_type'),
        })


    def get_privileges_list_from_string(privileges: str) -> list[dict[str, str]]:
        """
        Converts string of form privilegeName:serviceId to a list of object containing privilegeName and serviceId keys
        :param privileges: privileges string
        :return: list of privilege objects

        :raises ValueError: if the passed string is empty or not in expected format.
        """
        if privileges and len(privileges) > 2 and ':' in privileges:
            privileges_list = []
            for privilege in privileges.split(','):
                privilege_items = privilege.split(':')
                privileges_list.append({'privilegeName': privilege_items[0], 'serviceId': privilege_items[1]})
            return privileges_list
        else:
            raise ValueError(HR_MESSAGES['ROLE_CREATE_PRIVILEGES_INCORRECT_FORMAT'])


    def prepare_args_for_datatransfer_list(args: dict[str, str]) -> dict[str, str]:
        """
        Prepares arguments for gsuite-datatransfer-list command.

        :param args: Command arguments.

        :return: Prepared arguments.
        """
        customer_id = return_customer_id(args)
        return GSuiteClient.remove_empty_entities({
            'customerId': customer_id,
            'maxResults': GSuiteClient.validate_get_int(args.get('max_results'),
                                                        MESSAGES['INTEGER_ERROR'].format('max_results')),
            'newOwnerUserId': args.get('new_owner_user_id'),
            'oldOwnerUserId': args.get('old_owner_user_id'),
            'pageToken': args.get('page_token'),
            'status': args.get('status'),
        })


    def prepare_output_for_datatransfer_list(response: dict[str, Any]) -> dict[str, Any]:
        """
        prepares context output for gsuite-datatransfer-list.

        :param response: API response.

        :return: output dictionary.
        """
        return GSuiteClient.remove_empty_entities({
            OUTPUT_PREFIX['DATA_TRANSFER_LIST']: response.get('dataTransfers', []),
            OUTPUT_PREFIX['DATA_TRANSFER_LIST_PAGE_TOKEN']: {
                'nextPageToken': response['nextPageToken'],
            } if response.get('nextPageToken', '') else {}
        })


    def prepare_readable_output_for_datatransfer_list(response: dict[str, Any]) -> str:
        """
        prepares readable output for gsuite-datatransfer-list.

        :param response: API response.

        :return: output markdown string.
        """
        readable_output = f'### Next Page Token: {response["nextPageToken"]}\n\n' if response.get("nextPageToken") else ''

        # Formatting applicationDataTransfers list.
        for datatransfer in response.get('dataTransfers', []):
            app_transfer_markdown = ''
            for app_transfer in datatransfer.get('applicationDataTransfers', []):
                app_transfer_markdown += prepare_markdown_from_dictionary(app_transfer,
                                                                          ['applicationTransferParams']) + '\n\n'
            datatransfer['applicationDataTransfers'] = app_transfer_markdown

        readable_output += tableToMarkdown(
            HR_MESSAGES['LIST_COMMAND_SUCCESS'].format('Data Transfers',
                                                       len(response.get('dataTransfers', []))),
            response.get('dataTransfers', []),
            ['id', 'oldOwnerUserId', 'newOwnerUserId', 'overallTransferStatusCode', 'requestTime',
             'applicationDataTransfers'],
            headerTransform=pascalToSpace,
            removeNull=True)
        return readable_output


    def prepare_args_for_custom_user_schema(args: dict[str, str]) -> dict[str, str]:
        """
        Prepares arguments for gsuite-custom-user-schema-create/update command.

        :param args: Command arguments.

        :return: Prepared arguments.
        :raises ValueError: If required argument(s) are not provided.
        """

        if args.get('field_raw_json'):
            field_json = GSuiteClient.safe_load_non_strict_json(args['field_raw_json'])
        elif args.get('field_json_entry_id'):
            field_json = return_file_from_entry_id(args['field_json_entry_id'])
        else:
            raise ValueError(MESSAGES['REQUIRED_ARGS_CUSTOM_SCHEMA'])

        return GSuiteClient.remove_empty_entities({
            'displayName': args.get('schema_display_name'),
            'schemaName': args.get('schema_name'),
            'schemaId': args.get('schema_id'),
            'fields': field_json.get('fields', [])
        })


    def prepare_output_for_custom_user_schema(context_output: dict[str, Any], readable_output: dict[str, Any]) -> None:
        """
        Prepares outputs for custom user schema command.

        :param context_output: Context output dictionary.
        :param readable_output: readable output dictionary.

        :return: None
        """
        for field in readable_output.get('fields', []):
            field['numericIndexingSpec'] = prepare_markdown_from_dictionary(field.pop('numericIndexingSpec', {}))

        for field in context_output.get('fields', []):
            numeric_indexing_spec = field.pop('numericIndexingSpec', {})
            field['numericIndexingSpecMinValue'] = numeric_indexing_spec.get('minValue')
            field['numericIndexingSpecMaxValue'] = numeric_indexing_spec.get('maxValue')


    def get_transfer_params_list_from_str(transfer_params_str: str) -> list:
        """
        Extract transfer parameter list from a string of format "key1:val;key2:val1,val2"

        :param transfer_params_str: Transfer parameters string
        :return: Application transfer parameters list.
        :raises ValueError: If the provided string is not in expected format.

        """
        transfer_params = []
        if transfer_params_str:
            try:
                if len(transfer_params_str) < 2 or ':' not in transfer_params_str:
                    raise ValueError

                for transfer_param in transfer_params_str.split(';'):
                    transfer_params.append({
                        'key': transfer_param.split(':')[0].strip(),
                        'value': transfer_param.split(':')[1].strip().split(',')
                    })
            except Exception:
                raise ValueError(MESSAGES['DATATRANSFER_TRANSFER_PARAM_FORMAT_ERROR'])

        return transfer_params


    def prepare_datatransfer_payload_from_arguments(args: dict[str, str]) -> dict[str, Any]:
        """
        Prepares datatransfer payload from command arguments dictionary.

        :param args: Command arguments
        :return: Dictionary containing datatransfer request payload.
        """
        transfer_params = get_transfer_params_list_from_str(args.get('application_transfer_params', ''))

        return GSuiteClient.remove_empty_entities({
            'oldOwnerUserId': args.get('old_owner_id'),
            'newOwnerUserId': args.get('new_owner_id'),
            'applicationDataTransfers': [{
                'applicationId': args.get('application_id'),
                'applicationTransferParams': transfer_params
            }]
        })


    def is_email_valid(email: str) -> bool:
        """
        Validates provided email is valid or not.

        :param email: email string.
        :return:  True if email is in valid format.
        """

        return bool(re.match(emailRegex, email))


    ''' COMMAND FUNCTIONS '''


    @logger
    def test_module(client: Client) -> str:
        """
        Performs test connectivity by valid http response

        :param client: client object which is used to get response from api.

        :return: raise ValueError if any error occurred during connection
        :raises DemistoException: If there is any other issues while making the http call.
        """

        with GSuiteClient.http_exception_handler():
            client.set_authorized_http(scopes=SCOPES['DIRECTORY_USER'])
            if client.admin_email:
                client.http_request(url_suffix=f"{URL_SUFFIX['USER']}/{client.admin_email}", method='GET')
            else:
                return_results(MESSAGES.get('TEST_CONFIGURE_ERROR', ''))
        return 'ok'


    @logger
    def mobile_update_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        Takes an action that affects a mobile device. For example, remotely wiping a device.

        :param client: client object used to get response from api
        :param args: command arguments
        :return: CommandResults which returns detailed results to war room and sets the context data.
        """

        client.set_authorized_http(scopes=COMMAND_SCOPES['MOBILE_UPDATE'])
        customer_id = return_customer_id(args)
        args.pop('admin_email', '')
        resource_id = urllib.parse.quote(args.pop('resource_id', ''))
        try:
            client.http_request(
                url_suffix=URL_SUFFIX['MOBILE_UPDATE'].format(urllib.parse.quote(customer_id), resource_id),
                method='POST', body=args)

            return CommandResults(readable_output=HR_MESSAGES['MOBILE_UPDATE_SUCCESS'].format(resource_id))
        except DemistoException as e:
            error_message = str(e)
            if ('Internal error encountered' in error_message or 'Bad Request' in error_message):
                raise DemistoException(MESSAGES.get('INVALID_RESOURCE_CUSTOMER_ID_ERROR', ''))
            raise DemistoException(error_message)


    @logger
    def mobile_delete_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        Removes a mobile device. Note that this does not break the device's sync, it simply removes it from the list of
        devices connected to the domain. If the device still has a valid login/authentication, it will be added back on
        it's next successful sync.

        :param client: client object used to get response from api
        :param args: command arguments
        :return: CommandResults which returns detailed results to war room and sets the context data.
        """
        client.set_authorized_http(scopes=SCOPES['DEVICE_MOBILE'])
        customer_id = return_customer_id(args)
        resource_id = urllib.parse.quote(args.pop('resource_id', ''))
        client.http_request(
            url_suffix=URL_SUFFIX['MOBILE_DELETE'].format(urllib.parse.quote(customer_id), resource_id),
            method='DELETE')

        return CommandResults(readable_output=HR_MESSAGES['MOBILE_DELETE_SUCCESS'].format(resource_id))


    @logger
    def user_create_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        Creates a user.

        :param client: Client object.
        :param args: Command arguments.

        :return: Command Result.
        """
        prepared_args = prepare_args_for_user(args)
        client.set_authorized_http(scopes=SCOPES['DIRECTORY_USER'])

        response = client.http_request(url_suffix=URL_SUFFIX['USER'], body=prepared_args, method='POST')

        # Context
        outputs = prepare_output_for_user_command(copy.deepcopy(response))

        # Readable Output
        readable_output_dict = prepare_readable_output_for_user_command(copy.deepcopy(outputs))
        readable_output = tableToMarkdown(HR_MESSAGES['USER_CREATE'], readable_output_dict,
                                          ['id', 'customerId', 'primaryEmail', 'firstName', 'lastName', 'gender',
                                           'suspended', 'notesValue', 'notesContentType', 'isAdmin', 'creationTime',
                                           'phoneDetails',
                                           'addressDetails', 'secondaryEmailDetails', 'ipWhitelisted', 'recoveryEmail',
                                           'recoveryPhone'],
                                          headerTransform=pascalToSpace, removeNull=True)

        return CommandResults(outputs_prefix=OUTPUT_PREFIX['CREATE_USER'],
                              outputs_key_field=['id'],
                              outputs=outputs, raw_response=response,
                              readable_output=readable_output)


    @logger
    def role_assignment_list_command(client: Client, args: dict[str, Any]) -> CommandResults:
        """
        Prints all admin role assignments in the G Suite instance.

        :param client: client object which is used to get response from api
        :param args: command arguments.

        :return: CommandResults object with context and human-readable.
        """
        arguments = prepare_args_for_role_assignment_list(args)
        customer_id = return_customer_id(args)
        client.set_authorized_http(scopes=COMMAND_SCOPES['ROLE_ASSIGNMENT'])
        response = client.http_request(
            url_suffix=URL_SUFFIX['ROLE_ASSIGNMENT'].format(urllib.parse.quote(customer_id)),
            params=arguments)

        # Context
        outputs = prepare_output_for_role_assignment_list(response)

        # Readable Output
        readable_output = f'### Next Page Token: {response["nextPageToken"]}\n' if response.get("nextPageToken") else ''
        readable_output += tableToMarkdown(
            HR_MESSAGES['LIST_COMMAND_SUCCESS'].format('Role Assignment(s)', len(response.get('items', []))),
            response.get('items', []),
            ['roleAssignmentId', 'roleId', 'assignedTo', 'scopeType', 'orgUnitId'],
            headerTransform=pascalToSpace,
            removeNull=True) if response.get(
            'items') else HR_MESSAGES['NO_RECORDS'].format('role assignment details')

        return CommandResults(
            outputs=outputs,
            readable_output=readable_output,
            raw_response=response
        )


    @logger
    def role_assignment_create_command(client: Client, args: dict[str, Any]) -> CommandResults:
        """
        Assigns a role to the customer.

        :param client: client object which is used to get response from api
        :param args: command arguments.

        :return: CommandResults object with context and human-readable.
        """
        arguments = prepare_args_for_role_assignment_create(args)
        customer_id = return_customer_id(args)

        client.set_authorized_http(scopes=SCOPES['ROLE_MANAGEMENT'])
        response = client.http_request(
            url_suffix=URL_SUFFIX['ROLE_ASSIGNMENT'].format(urllib.parse.quote(customer_id)),
            body=arguments, method='POST')

        # Readable Output
        readable_output = tableToMarkdown(
            HR_MESSAGES['ROLE_ASSIGNMENT_CREATE'],
            response,
            ['roleAssignmentId', 'roleId', 'assignedTo', 'scopeType', 'orgUnitId'],
            headerTransform=pascalToSpace,
            removeNull=True)

        return CommandResults(
            outputs_prefix=OUTPUT_PREFIX['ROLE_ASSIGNMENT_CREATE'],
            outputs_key_field='roleAssignmentId',
            outputs=GSuiteClient.remove_empty_entities(response),
            readable_output=readable_output,
            raw_response=response
        )


    @logger
    def user_alias_add_command(client: Client, args: dict[str, Any]) -> CommandResults:
        """
        Adds an alias.

        :param client: client object which is used to get response from api
        :param args: command arguments.

        :return: CommandResults object with context and human-readable.
        """
        user_key = args.get('user_key', '')
        user_key = urllib.parse.quote(user_key)  # type: ignore
        alias = args.get('alias', '')
        # admin_email = ADMIN_EMAIL

        body = {'alias': alias}
        body = GSuiteClient.remove_empty_entities(body)

        client.set_authorized_http(scopes=COMMAND_SCOPES['USER_ALIAS_ADD'])
        response = client.http_request(url_suffix=URL_SUFFIX['USER_ALIAS'].format(user_key), body=body, method='POST')

        outputs = prepare_output_user_alias_add(response)

        readable_output = HR_MESSAGES['ALIAS_ADD_SUCCESS'].format(alias, args.get('user_key', ''))

        return CommandResults(
            outputs_prefix=OUTPUT_PREFIX['ADD_ALIAS'],
            outputs_key_field=['id', 'alias'],
            outputs=outputs,
            readable_output=readable_output,
            raw_response=response
        )


    @logger
    def group_create_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        Creates a group with a group name and its description.

        :param client: Client object.
        :param args: Command arguments.

        :return: CommandResults.
        """
        client.set_authorized_http(scopes=SCOPES['GROUP'])
        args.pop('admin_email', '')
        args = {key.replace('group_', ''): value for (key, value) in args.items()}

        response = client.http_request(url_suffix=URL_SUFFIX['GROUP_CREATE'], body=args, method='POST')

        response = GSuiteClient.remove_empty_entities(response)

        hr_output_fields = ['id', 'email', 'description', 'adminCreated']

        readable_output = tableToMarkdown(HR_MESSAGES['GROUP_CREATE_SUCCESS'].format(response['name']),
                                          response, headerTransform=pascalToSpace, removeNull=True,
                                          headers=hr_output_fields)

        return CommandResults(
            outputs_prefix=OUTPUT_PREFIX['GROUP'],
            outputs_key_field='id',
            outputs=response,
            readable_output=readable_output,
            raw_response=response
        )


    @logger
    def group_get_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        Get a group information with a group key

        :param client: Client object.
        :param args: Command arguments.

        :return: CommandResults.
        """
        client.set_authorized_http(scopes=SCOPES['GROUP'])
        group_key_suffix = URL_SUFFIX['GROUP_GET'].format(args.pop('group', ''))

        response = client.http_request(
            url_suffix=group_key_suffix, method='GET')

        response = GSuiteClient.remove_empty_entities(response)

        hr_output_fields = ['id', 'email', 'description', 'adminCreated']

        readable_output = tableToMarkdown(HR_MESSAGES['GROUP_GET_SUCCESS'].format(response['name']),
                                          response, headerTransform=pascalToSpace, removeNull=True,
                                          headers=hr_output_fields)

        return CommandResults(
            outputs_prefix=OUTPUT_PREFIX['GROUP'],
            outputs_key_field='id',
            outputs=response,
            readable_output=readable_output,
            raw_response=response
        )


    @logger
    def role_create_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        Creates a role with a role name and its description.

        :param client: Client object.
        :param args: Command arguments.

        :return: CommandResults.
        """

        client.set_authorized_http(scopes=SCOPES['ROLE_MANAGEMENT'])
        customer_id = return_customer_id(args)

        params = {
            'rolePrivileges': get_privileges_list_from_string(args.pop('role_privileges', '')),
            'roleName': args.get('role_name', ''),
            'roleDescription': args.get('role_description', '')
        }

        response = client.http_request(
            url_suffix=URL_SUFFIX['ROLE_CREATE'].format(urllib.parse.quote(customer_id)), body=params,
            method='POST')

        response = GSuiteClient.remove_empty_entities(response)

        hr_output = {key.replace('role', ''): value for (key, value) in response.items()}

        hr_output['Privileges'] = ",\n".join(
            [privilege['privilegeName'] + ': ' + privilege['serviceId'] for privilege in hr_output.get('Privileges', [])])

        hr_output_fields = ['Id', 'Name', 'Description', 'Privileges']

        readable_output = tableToMarkdown(HR_MESSAGES['ROLE_CREATE_SUCCESS'], hr_output, headerTransform=pascalToSpace,
                                          removeNull=True, headers=hr_output_fields)

        return CommandResults(
            outputs_prefix=OUTPUT_PREFIX['ROLE'],
            outputs_key_field='roleId',
            outputs=response,
            readable_output=readable_output,
            raw_response=response
        )


    @logger
    def token_revoke_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        Delete all access tokens issued by a user for an application.

        :param client: Client object.
        :param args: Command arguments.

        :return: CommandResults.
        """

        client.set_authorized_http(scopes=SCOPES['USER_SECURITY'])

        user_key = urllib.parse.quote(args.get('user_key', ''))
        client_id = urllib.parse.quote(args.get('client_id', ''))

        client.http_request(url_suffix=URL_SUFFIX['TOKEN_REVOKE'].format(user_key, client_id), method='DELETE')

        return CommandResults(readable_output=HR_MESSAGES['TOKEN_REVOKE_SUCCESS'].format(args.get('client_id', '')))


    @logger
    def user_signout_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        Signs a user out of all web and device sessions and reset their sign-in cookies.

        :param client: Client object.
        :param args: Command arguments.

        :return: CommandResults.
        """

        client.set_authorized_http(scopes=SCOPES['USER_SECURITY'])

        user_key = urllib.parse.quote(args.get('user_key', ''))
        client.http_request(url_suffix=URL_SUFFIX['USER_SIGN_OUT'].format(user_key), method='POST')

        return CommandResults(readable_output=HR_MESSAGES['USER_SIGNOUT_SESSIONS'].format(args.get('user_key', '')))


    @logger
    def datatransfer_list_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        Lists the transfers for a customer by source user, destination user, or status.

        :param client: Client object.
        :param args: Command arguments.

        :return: CommandResults.
        """
        params = prepare_args_for_datatransfer_list(args)
        client.set_authorized_http(scopes=COMMAND_SCOPES['DATA_TRANSFER_LIST'])
        response = client.http_request(url_suffix=URL_SUFFIX['DATA_TRANSFER'], params=params)

        # Context
        outputs = prepare_output_for_datatransfer_list(response)

        # Readable Output
        readable_output = prepare_readable_output_for_datatransfer_list(copy.deepcopy(response)) if response.get(
            'dataTransfers') else HR_MESSAGES['NO_RECORDS'].format('data transfer details')

        return CommandResults(
            outputs=outputs,
            readable_output=readable_output,
            raw_response=response
        )


    @logger
    def custom_user_schema_create_command(client: Client, args: dict[str, Any]) -> CommandResults:
        """
        Creates a custom user schema to add custom fields to user profiles.

        :param client: client object which is used to get response from api
        :param args: command arguments.

        :return: CommandResults object with context and human-readable.
        """
        body = prepare_args_for_custom_user_schema(args)
        client.set_authorized_http(scopes=SCOPES['CUSTOM_USER_SCHEMA'])
        customer_id = return_customer_id(args)
        response = client.http_request(method='POST',
                                       url_suffix=URL_SUFFIX['CUSTOM_USER_SCHEMA'].format(
                                           urllib.parse.quote(customer_id)),
                                       body=body)

        outputs = copy.deepcopy(response)
        readable_output_dict = copy.deepcopy(response)

        prepare_output_for_custom_user_schema(outputs, readable_output_dict)

        readable_output = f"### {HR_MESSAGES['CUSTOM_USER_SCHEMA_CREATE']}\n"
        readable_output += f"Schema Id: {readable_output_dict.get('schemaId', '')}\n"
        readable_output += f"Schema Name: {readable_output_dict.get('schemaName', '')}\n"
        readable_output += f"Schema Display Name: {readable_output_dict.get('displayName', '')}\n"
        readable_output += tableToMarkdown(
            HR_MESSAGES['CUSTOM_USER_SCHEMA_FIELD_DETAILS'],
            readable_output_dict.get('fields', []),
            ['fieldId', 'fieldName', 'displayName', 'fieldType',
             'readAccessType', 'multiValued', 'indexed', 'numericIndexingSpec'],
            headerTransform=pascalToSpace,
            removeNull=True)

        return CommandResults(
            outputs_prefix=OUTPUT_PREFIX['CUSTOM_USER_SCHEMA'],
            outputs_key_field='schemaId',
            outputs=GSuiteClient.remove_empty_entities(outputs),
            readable_output=readable_output,
            raw_response=GSuiteClient.remove_empty_entities(response)
        )


    @logger
    def custom_user_schema_update_command(client: Client, args: dict[str, Any]) -> CommandResults:
        """
        Updates a custom user schema.

        :param client: client object which is used to get response from api
        :param args: command arguments.

        :return: CommandResults object with context and human-readable.
        :raise ValueError: If required arguments are not provided.
        """
        if not args.get('schema_id') and not args.get('schema_name'):
            raise ValueError(MESSAGES['CUSTOM_SCHEMA_UPDATE_REQUIRED_ARGS'])
        customer_id = return_customer_id(args)
        body = prepare_args_for_custom_user_schema(args)

        schema_key = args['schema_id'] if args.get('schema_id') else args.get('schema_name', '')

        url_suffix = f"{URL_SUFFIX['CUSTOM_USER_SCHEMA'].format(urllib.parse.quote(customer_id))}" \
                     f"/{urllib.parse.quote(schema_key)}"

        client.set_authorized_http(scopes=SCOPES['CUSTOM_USER_SCHEMA'])
        response = client.http_request(method='PUT',
                                       url_suffix=url_suffix,
                                       body=body)

        outputs = copy.deepcopy(response)
        readable_output_dict = copy.deepcopy(response)

        prepare_output_for_custom_user_schema(outputs, readable_output_dict)

        readable_output = f"### {HR_MESSAGES['CUSTOM_USER_SCHEMA_UPDATE']}\n"
        readable_output += f"Schema Id: {readable_output_dict['schemaId']}\n" if readable_output_dict.get(
            'schemaId', '') else ''
        readable_output += f"Schema Name: {readable_output_dict['schemaName']}\n" if readable_output_dict.get(
            'schemaName', '') else ''
        readable_output += f"Schema Display Name: {readable_output_dict['displayName']}\n" if readable_output_dict.get(
            'displayName', '') else ''
        readable_output += tableToMarkdown(
            HR_MESSAGES['CUSTOM_USER_SCHEMA_FIELD_DETAILS'],
            readable_output_dict.get('fields', []),
            ['fieldId', 'fieldName', 'displayName', 'fieldType',
             'readAccessType', 'multiValued', 'indexed', 'numericIndexingSpec'],
            headerTransform=pascalToSpace,
            removeNull=True)

        return CommandResults(
            outputs_prefix=OUTPUT_PREFIX['CUSTOM_USER_SCHEMA'],
            outputs_key_field='schemaId',
            outputs=GSuiteClient.remove_empty_entities(outputs),
            readable_output=readable_output,
            raw_response=GSuiteClient.remove_empty_entities(response)
        )


    @logger
    def datatransfer_request_create_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        Inserts a data transfer request.

        :param client: Client object.
        :param args: Command arguments.

        :return: CommandResults.
        """
        if not any([args.get('applications_raw_json'), args.get('applications_raw_json_entry_id'),
                    args.get('application_id')]):
            raise ValueError(MESSAGES['DATATRANSFER_MISSING_ARGUMENT'])

        app_payload = {}
        if args.get('applications_raw_json'):
            app_payload = GSuiteClient.safe_load_non_strict_json(args['applications_raw_json'])
        elif args.get('applications_raw_json_entry_id'):
            app_payload = return_file_from_entry_id(args['applications_raw_json_entry_id'])

        request_payload = prepare_datatransfer_payload_from_arguments(args)

        if app_payload.get('applicationDataTransfers'):
            request_payload['applicationDataTransfers'] = app_payload['applicationDataTransfers']

        client.set_authorized_http(scopes=SCOPES['DATA_TRANSFER'])

        response = client.http_request(url_suffix=URL_SUFFIX['DATA_TRANSFER_CREATE'], body=request_payload, method='POST')

        hr_output_data = response.copy()

        application_transfer_hr_output = '\n\n'.join(['Application Id: {}\nApplication Transfer Status: {}'.format(
            transfer.get('applicationId', ''), transfer.get('applicationTransferStatus', '')) for transfer in
            response.get('applicationDataTransfers', [])])

        hr_output_data['applicationDataTransfers'] = application_transfer_hr_output

        hr_output = tableToMarkdown(HR_MESSAGES['DATATRANSFER_REQUEST_CREATE_SUCCESS'], hr_output_data,
                                    headerTransform=pascalToSpace, removeNull=True,
                                    headers=['id', 'oldOwnerUserId', 'newOwnerUserId', 'overallTransferStatusCode',
                                             'requestTime', 'applicationDataTransfers'])

        return CommandResults(
            outputs_prefix=OUTPUT_PREFIX['DATA_TRANSFER_REQUEST_CREATE'],
            outputs=GSuiteClient.remove_empty_entities(response),
            readable_output=hr_output,
            raw_response=GSuiteClient.remove_empty_entities(response),
            outputs_key_field='id'
        )


    @logger
    def user_delete_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        Deletes a user.

        :param client: Client object.
        :param args: Command arguments.

        :return: CommandResults.
        """
        client.set_authorized_http(scopes=SCOPES['DIRECTORY_USER'])
        user_key = args.get('user_key', '')
        url_suffix = f"{URL_SUFFIX['USER']}/{urllib.parse.quote(user_key)}"
        client.http_request(url_suffix=url_suffix, method='DELETE')

        return CommandResults(readable_output=HR_MESSAGES['USER_DELETE'].format(user_key))


    @logger
    def user_update_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        updates a user.

        :param client: Client object.
        :param args: Command arguments.

        :return: Command Result.
        """
        prepared_args = prepare_args_for_user(args)
        client.set_authorized_http(scopes=SCOPES['DIRECTORY_USER'])
        user_key = args.get('user_key', '')
        url_suffix = f"{URL_SUFFIX['USER']}/{urllib.parse.quote(user_key)}"
        response = client.http_request(url_suffix=url_suffix, body=prepared_args, method='PUT')

        # Context
        outputs = prepare_output_for_user_command(copy.deepcopy(response))

        # Readable Output
        readable_output_dict = prepare_readable_output_for_user_command(copy.deepcopy(outputs))
        readable_output = tableToMarkdown(HR_MESSAGES['USER_UPDATE'], readable_output_dict,
                                          ['id', 'customerId', 'primaryEmail', 'firstName', 'lastName', 'gender',
                                           'archived', 'suspended',
                                           'orgUnitPath', 'notesValue', 'notesContentType', 'isAdmin', 'creationTime',
                                           'phoneDetails',
                                           'addressDetails', 'secondaryEmailDetails', 'ipWhitelisted', 'recoveryEmail',
                                           'recoveryPhone'],
                                          headerTransform=pascalToSpace, removeNull=True)

        return CommandResults(outputs_prefix=OUTPUT_PREFIX['CREATE_USER'],
                              outputs_key_field=['id'],
                              outputs=outputs, raw_response=response,
                              readable_output=readable_output)


    @logger
    def user_get_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
        get a user details based on user key.

        :param client: Client object.
        :param args: Command arguments.

        :return: Command Result.
        """
        client.set_authorized_http(scopes=SCOPES['DIRECTORY_USER'])
        user_key = args.get('user', '')
        url_suffix = urljoin(URL_SUFFIX['USER'], urllib.parse.quote(user_key))
        response = client.http_request(url_suffix=url_suffix, method='GET')

        # Context
        outputs = prepare_output_for_user_command(copy.deepcopy(response))

        # Readable Output
        readable_output_dict = prepare_readable_output_for_user_command(copy.deepcopy(outputs))
        readable_output = tableToMarkdown(HR_MESSAGES['USER_GET'].format(user_key), readable_output_dict,
                                          ['id', 'customerId', 'primaryEmail', 'firstName', 'lastName', 'gender',
                                           'archived', 'suspended',
                                           'orgUnitPath', 'notesValue', 'notesContentType', 'isAdmin', 'creationTime',
                                           'phoneDetails',
                                           'addressDetails', 'secondaryEmailDetails', 'ipWhitelisted', 'recoveryEmail',
                                           'recoveryPhone'],
                                          headerTransform=pascalToSpace, removeNull=True)

        return CommandResults(outputs_prefix=OUTPUT_PREFIX['CREATE_USER'],
                              outputs_key_field=['id'],
                              outputs=outputs,
                              readable_output=readable_output,
                              raw_response=response)


    def mobile_device_list_request(client: Client, customer_id: str, query_params: dict = {}):
        response = client.http_request(
            url_suffix=URL_SUFFIX.get('MOBILE_DEVICES_LIST', '').format(urllib.parse.quote(customer_id)),
            params=query_params)
        return response


    def chromeos_device_list_request(client: Client, customer_id: str, query_params: dict = {}):
        response = client.http_request(
            url_suffix=URL_SUFFIX.get('CHROMEOS_DEVICES_LIST', '').format(urllib.parse.quote(customer_id)),
            params=query_params)
        return response


    def chromeos_device_action_request(client: Client, customer_id: str, resource_id: str, action: str,
                                       deprovision_reason: str = ''):
        json_body = {'action': action}
        if action == 'deprovision':
            json_body['deprovisionReason'] = deprovision_reason
        response = client.http_request(
            method='POST', url_suffix=URL_SUFFIX.get('CHROMEOS_DEVICE_ACTION', '').format(urllib.parse.quote(customer_id),
                                                                                          urllib.parse.quote(resource_id)),
            body=json_body)
        return response


    def device_list_automatic_pagination(request_by_device_type: Callable, client, customer_id: str, query_params: dict,
                                         limit: int, response_devices_list_key: str) -> dict:
        """This function implements the automatic pagination mechanism for both commands: mobile-device-list, and chromos-device-list.
        Since the API does not support a `limit` argument, we have to do the automatic pagination manually. If the limit
        argument is smaller than or equal to the maximum page size allowed by the API, then we will only need one request call,
        else, we will make multiple requests by utilizing the `nextPageToken` argument supplied by the API.

        Args:
            api_request (Callable): The API request that will be used to retrieve the list of devices.
            client (Client): A Client instance.
            customer_id (str): The unique ID of the customer's Google Workspace Admin account.
            query_params (dict): The query parameters that will be sent with the API call.
            limit (int): The limit argument that will act as the maximum number of results to return from the API request.
            response_devices_list_key (str): The key that will point to the list of devices in the response body.

        Returns:
            dict: A dictionary that holds all the relevant data for creating a CommandResult.
        """
        results_limit = limit
        devices = []  # This will hold all aggregated mobile devices returned from the API requests
        responses = []  # This will hold all the responses from the API requests
        next_page_token = ''
        continue_pagination = True  # This will decide if we should continue requesting from the API or that we should stop
        while continue_pagination:
            query_params['maxResults'] = results_limit if results_limit <= MAX_PAGE_SIZE else MAX_PAGE_SIZE
            if next_page_token:
                query_params['pageToken'] = next_page_token
            response = request_by_device_type(client=client, customer_id=customer_id, query_params=query_params)
            responses.append(response)
            response_mobile_devices = response.get(response_devices_list_key, [])
            next_page_token = response.get('nextPageToken', '')

            devices.extend(response_mobile_devices)
            results_limit -= len(response_mobile_devices)
            if (results_limit <= 0 or not next_page_token):
                continue_pagination = False
        return {'data': devices, 'raw_response': responses}


    def device_list_manual_pagination(request_by_device_type: Callable, client, customer_id: str, query_params: dict,
                                      page_token: str, page_size: int, response_devices_list_key: str) -> dict:
        """This function is in charge of retrieving the data of one page using the page_size and page_token arguments supported
        by the API.

        Args:
            api_request (Callable): The API request that will be used to retrieve the list of devices.
            client (Client): A Client instance.
            customer_id (str): The unique ID of the customer's Google Workspace Admin account.
            query_params (dict): The query parameters that will be sent with the API call.
            page_token (str): The token of the page from where to retrieve the devices.
            page_size (int): The size of the page, which cannot be bigger than the maximum page size (100).
            response_devices_list_key (str): The key that will point to the list of devices in the response body.

        Returns:
            dict: A dictionary that holds all the relevant data for creating a CommandResult.
        """
        query_params['maxResults'] = page_size
        if page_token:
            query_params['pageToken'] = page_token
        response = request_by_device_type(client=client, customer_id=customer_id, query_params=query_params)
        devices = response.get(response_devices_list_key, [])
        return {'data': devices, 'raw_response': [response], 'next_page_token': response.get('nextPageToken', '')}


    def prepare_pagination_arguments(page_token: str, page_size: int | None, limit: int | None) -> dict:
        """ The function gets the arguments from the user and checks the content of the pagination arguments,
            and if everything is valid, it returns a dictionary that holds the pagination information.

        Args:
            args (dict): The arguments from the user

        Returns:
            dict: A dictionary that holds the pagination information.
        """
        if (page_token or page_size is not None):
            if limit is not None:
                raise DemistoException(MESSAGES.get('INVALID_PAGINATION_ARGS_SUPPLIED'))
            page_size = page_size if (page_size is not None) else DEFAULT_PAGE_SIZE
            if page_size > MAX_PAGE_SIZE:
                raise DemistoException(MESSAGES.get('EXCEEDED_MAX_PAGE_SIZE_ERROR'))
            return {'page_size': page_size, 'page_token': page_token}

        limit = limit if (limit is not None) else DEFAULT_LIMIT
        if (limit <= 0):
            raise DemistoException(message=MESSAGES.get('LIMIT_ARG_INVALID_ERROR'))
        return {'limit': limit}


    def mobile_device_list_create_query_parameters(projection: str, query: str, order_by: str,
                                                   sort_order: str) -> dict:
        """This function takes in the arguments from the user and creates a dictionary that will hold
        the query arguments for the mobile-device-list request.

        Args:
            args (dict): The arguments from the user

        Returns:
            dict: A dictionary that will hold the query arguments of the request.
        """
        query_params = assign_params(projection=projection.lower(),
                                     query=query,
                                     orderBy=order_by.lower(),
                                     sortOrder=sort_order.lower(),
                                     )
        return query_params


    def devices_to_human_readable(devices_data: list[dict], keys: list, keys_mapping: dict[str, str]) -> list[dict]:
        human_readable: list[dict] = []
        for device in devices_data:
            human_readable_data = {}
            for key in keys:
                if key in keys_mapping:
                    human_readable_data[keys_mapping.get(key)] = device.get(key)
                else:
                    human_readable_data[pascalToSpace(key)] = device.get(key)
            human_readable.append(human_readable_data)

        return human_readable


    @logger
    def gsuite_mobile_device_list_command(client: Client, args: dict[str, str]) -> CommandResults:
        """Retrieves a paginated list that includes company-owned mobile devices.

        Args:
            client (Client): A Client instance.
            args (Dict[str, str]): The arguments of the command.

        Returns:
            List[CommandResults]: List of CommandResults that hold the data to return to the engine.
        """
        client.set_authorized_http(scopes=COMMAND_SCOPES.get('MOBILE_DEVICES_LIST', []))
        customer_id = return_customer_id(args)
        query_params = mobile_device_list_create_query_parameters(projection=args.get('projection', 'full'),
                                                                  query=args.get('query', ''),
                                                                  order_by=args.get('order_by', 'status'),
                                                                  sort_order=args.get('sort_order', 'ascending'),)
        pagination_args = prepare_pagination_arguments(page_token=args.get('page_token', ''),
                                                       page_size=arg_to_number(args.get('page_size', '')),
                                                       limit=arg_to_number(args.get('limit', '')))
        mutual_pagination_args = assign_params(
            request_by_device_type=mobile_device_list_request,
            client=client,
            customer_id=customer_id,
            response_devices_list_key=MobileDevicesConfig.response_devices_list_key,
            query_params=query_params,
        )
        markdown = ''
        if 'limit' in pagination_args:
            pagination_result = device_list_automatic_pagination(**mutual_pagination_args, **pagination_args)
        else:
            pagination_result = device_list_manual_pagination(**mutual_pagination_args, **pagination_args)
        context_data: list[dict] = pagination_result.get('data', [{}])
        raw_response: list = pagination_result.get('raw_response', [])
        next_page_token: str = pagination_result.get('next_page_token', '')
        if not context_data:
            markdown = 'No results were found with the respected arguments'

        else:
            human_readable = devices_to_human_readable(
                devices_data=context_data,
                keys=['serialNumber', 'name', 'model', 'os', 'type', 'status', 'resourceId'],
                keys_mapping={'name': 'User Names', 'model': 'Model Name', 'os': 'OS'})
            num_of_devices = len(context_data)
            markdown = tableToMarkdown(MobileDevicesConfig.table_title, human_readable,
                                       metadata=f'{num_of_devices} {"results" if num_of_devices != 1 else "result"} found')
        outputs: dict[str, Any] = {}
        if context_data:
            outputs[(f'{MobileDevicesConfig.outputs_prefix}.'
                     'MobileListObjects(val.resourceId && val.resourceId == obj.resourceId)')] = context_data
        if next_page_token:
            markdown += f'### Next Page Token:\n{next_page_token}'
            outputs[f'{MobileDevicesConfig.outputs_prefix}.PageToken(val.NextPageToken)'] = {'NextPageToken': next_page_token}

        command_results = CommandResults(
            readable_output=markdown,
            outputs=outputs,
            raw_response=raw_response,
        )

        return command_results


    def chromeos_device_list_create_query_parameters(projection: str, query: str, include_child_org_units: bool, order_by: str,
                                                     sort_order: str, org_unit_path: str) -> dict:  # pragma: no cover
        """This function takes in the arguments from the user and creates a dictionary that will hold
        the query arguments for the chromeos-device-list request.

        Args:
            args (dict): The arguments from the user

        Returns:
            dict: A dictionary that will hold the query arguments of the request.
        """
        query_params = assign_params(projection=projection.lower(),
                                     query=query,
                                     orderBy=order_by.lower(),
                                     sortOrder=sort_order.lower(),
                                     orgUnitPath=org_unit_path,
                                     includeChildOrgunits=str(include_child_org_units)
                                     )
        return query_params


    @logger
    def gsuite_chromeos_device_list_command(client: Client, args: dict[str, str]) -> CommandResults:  # pragma: no cover
        """Retrieves a paginated list that includes company-owned ChromeOS devices.

        Args:
            client (Client): A Client instance.
            args (Dict[str, str]): The arguments of the command.

        Returns:
            List[CommandResults]: List of CommandResults that hold the data to return to the engine.
        """
        client.set_authorized_http(scopes=COMMAND_SCOPES.get('CHROMEOS_DEVICES_LIST', []))
        customer_id = return_customer_id(args)
        query_params = chromeos_device_list_create_query_parameters(projection=args.get('projection', 'full'),
                                                                    query=args.get('query', ''),
                                                                    include_child_org_units=argToBoolean(args.get(
                                                                        'include_child_org_units', False)),
                                                                    order_by=args.get('order_by', ''),
                                                                    sort_order=args.get('sort_order', ''),
                                                                    org_unit_path=args.get('org_unit_path', ''),
                                                                    )
        pagination_args = prepare_pagination_arguments(page_token=args.get('page_token', ''),
                                                       page_size=arg_to_number(args.get('page_size', '')),
                                                       limit=arg_to_number(args.get('limit', '')))
        mutual_pagination_args = assign_params(
            request_by_device_type=chromeos_device_list_request,
            client=client,
            customer_id=customer_id,
            response_devices_list_key=ChromeOSDevicesConfig.response_devices_list_key,
            query_params=query_params,
        )
        try:
            markdown = ''
            if 'limit' in pagination_args:
                pagination_result = device_list_automatic_pagination(**mutual_pagination_args, **pagination_args)
            else:
                pagination_result = device_list_manual_pagination(**mutual_pagination_args, **pagination_args)
            context_data: list[dict] = pagination_result.get('data', [{}])
            raw_response: list = pagination_result.get('raw_response', [])
            next_page_token: str = pagination_result.get('next_page_token', '')
            if not context_data:
                markdown = 'No results were found with the respected arguments'

            else:
                human_readable = devices_to_human_readable(
                    devices_data=context_data,
                    keys=['serialNumber', 'annotatedUser', 'model', 'osVersion', 'status', 'deviceId'],
                    keys_mapping={'annotatedUser': 'User Name', 'osVersion': 'OS'})
                num_of_devices = len(context_data)
                markdown = tableToMarkdown(ChromeOSDevicesConfig.table_title, human_readable,
                                           metadata=f'{num_of_devices} {"results" if num_of_devices != 1 else "result"} found')
            outputs: dict[str, Any] = {}
            if context_data:
                outputs[(f'{ChromeOSDevicesConfig.outputs_prefix}.'
                         'ChromeOSListObjects(val.resourceId && val.resourceId == obj.resourceId)')] = context_data

            if next_page_token:
                markdown += f'### Next Page Token:\n{next_page_token}'
                outputs[f'{ChromeOSDevicesConfig.outputs_prefix}.PageToken(val.NextPageToken)'] = {'NextPageToken': next_page_token}

            command_results = CommandResults(
                readable_output=markdown,
                outputs=outputs,
                raw_response=raw_response,
            )
            return command_results
        except DemistoException as e:
            error_message = str(e)
            if ('INVALID_OU_ID' in error_message):
                raise DemistoException(MESSAGES.get('INVALID_ORG_UNIT_PATH', ''))
            raise DemistoException(error_message)


    @logger
    def gsuite_chromeos_device_action_command(client: Client, args: dict[str, str]) -> CommandResults:
        """Executes an action that affects a ChromeOS Device.

        Args:
            client (Client): A Client instance.
            args (Dict[str, str]): The arguments of the command.

        Raises:
            DemistoException: If customer_id or resource_id are invalid.

        Returns:
            CommandResults: CommandResults that hold the data to return to the engine.
        """
        try:
            client.set_authorized_http(scopes=COMMAND_SCOPES.get('CHROMEOS_DEVICE_ACTION', []))
            customer_id = return_customer_id(args)
            chromeos_device_action_request(client=client, customer_id=customer_id,
                                           resource_id=args.get('resource_id', ''),
                                           action=args.get('action', ''),
                                           deprovision_reason=args.get('deprovision_reason', ''))

        except DemistoException as e:
            error_message = str(e)
            if ('Delinquent account' in error_message):
                raise DemistoException(MESSAGES.get('INVALID_RESOURCE_CUSTOMER_ID_ERROR', ''))
            raise DemistoException(error_message)
        command_results = CommandResults(
            readable_output=HR_MESSAGES.get('CHROMEOS_DEVICE_ACTION_SUCCESS', '').format(args.get('resource_id')),
        )
        return command_results


    def user_reset_password_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
            reset to user password based on given user_key (email)

            :param client: Client object.
            :param args: Command arguments.

            :return: Command Result.
        """
        client.set_authorized_http(scopes=SCOPES['DIRECTORY_USER'])
        user_key = args.get('user_key', '')
        url_suffix = urljoin(URL_SUFFIX['USER'], urllib.parse.quote(user_key))
        body = {"changePasswordAtNextLogin": True}
        response = client.http_request(url_suffix=url_suffix, method='PUT', body=body)

        # Context
        outputs = prepare_output_for_user_command(copy.deepcopy(response))
        # Output
        readable_output = tableToMarkdown(HR_MESSAGES['USER_UPDATE'].format(user_key), outputs,
                                          ['id', 'customerId', 'primaryEmail', 'changePasswordAtNextLogin'],
                                          headerTransform=pascalToSpace, removeNull=True)

        return CommandResults(outputs_prefix=OUTPUT_PREFIX['CREATE_USER'],
                              outputs_key_field=['id'],
                              outputs=outputs,
                              readable_output=readable_output,
                              raw_response=response)


    def chromebrowser_move_ou_command(client: Client, args: dict[str, str]) -> str:
        """
            Move Chrome Browser devices assigned to an account from one organization unit to another

            :param client: Client object.
            :param args: Command arguments - customer_id, resource_ids, org_unit_path - required.

            :return: Message for user upon success
        """
        client.set_authorized_http(scopes=SCOPES['CHROME_BROWSERS'])
        customer_id = return_customer_id(args)
        resource_ids_list = argToList(args.get('resource_ids', ''))
        org_unit_path = args.get('org_unit_path', '')
        full_url = f'https://www.googleapis.com/admin/directory/v1.1beta1/customer/{customer_id}' \
                   f'/devices/chromebrowsers/moveChromeBrowsersToOu'
        body = {"resource_ids": resource_ids_list, "org_unit_path": org_unit_path}
        client.http_request(full_url=full_url, method='POST', body=body)

        # Output
        return f'Chrome browser devices have been moved to the new organization unit {org_unit_path}'


    def assign_params_chromebrowser_list(projection, query, order_by, sort_order, org_u_path, page_t, page_s):
        return GSuiteClient.remove_empty_entities({
            'projection': projection,
            'query': query,
            'orderBy': order_by,
            'sortOrder': sort_order,
            'orgUnitPath': org_u_path,
            'pageToken': page_t,
            'maxResults': page_s
        })


    def chromebrowser_list_command(client: Client, args: dict[str, str]) -> CommandResults:
        '''
            List chromebrowsers devices

            :param client: Client object.
            :param args: Command arguments - customer_id (reqyired), device_id, order_by, org_unit_path, projection, query,
             sort_order, page_size and limit
            :return: Command Result.
        '''
        API_LIMIT = 100
        client.set_authorized_http(scopes=SCOPES['CHROME_BROWSERS'])
        customer_id = return_customer_id(args)
        device_id = args.get('device_id', '')
        order_by = args.get('order_by', '')
        org_unit_path = args.get('org_unit_path', '')
        projection = args.get('projection', '')
        query = args.get('query', '')
        sort_order = args.get('sort_order', '')
        page_size = args.get('page_size', '')
        page_token = args.get('page_token', '')
        limit = args.get('limit', '')

        full_url = f'https://www.googleapis.com/admin/directory/v1.1beta1/customer/{customer_id}/devices/chromebrowsers/'
        cb_list_resp = []
        if device_id:
            full_url = full_url + f'{device_id}'
            params_for_command = GSuiteClient.remove_empty_entities({
                'projection': projection
            })
            response = client.http_request(full_url=full_url, method='GET', params=params_for_command)
            cb_list_resp.append(response)
        else:
            if page_size or page_token:
                if not page_size:
                    page_size = str(DEFAULT_PAGE_SIZE)
                if int(page_size) > API_LIMIT:
                    page_size = str(API_LIMIT)
                params_for_command = assign_params_chromebrowser_list(projection, query, order_by, sort_order, org_unit_path,
                                                                      page_token, page_size)
                response = client.http_request(full_url=full_url, method='GET', params=params_for_command)
                page_token = response.get('nextPageToken', '')
                cb_list_resp.extend(response.get('browsers', ''))
            else:
                while len(cb_list_resp) < int(limit):
                    if int(limit) - len(cb_list_resp) > API_LIMIT:
                        page_size = str(API_LIMIT)
                    else:
                        page_size = str(int(limit) - len(cb_list_resp))
                    params_for_command = assign_params_chromebrowser_list(projection, query, order_by, sort_order, org_unit_path,
                                                                          page_token, page_size)
                    response = client.http_request(full_url=full_url, method='GET', params=params_for_command)
                    page_token = response.get('nextPageToken', '')
                    cb_list_resp.extend(response.get('browsers', ''))  # type: ignore
                    if not page_token:
                        break

        readable_output = tableToMarkdown(HR_MESSAGES['CHROME_BROWSER_LIST'].format(device_id), cb_list_resp,
                                          ['deviceId', 'osPlatform', 'osVersion', 'machineName', 'serialNumber', 'orgUnitPath'],
                                          headerTransform=pascalToSpace, removeNull=True)
        outputs = {
            'GSuite.ChromeBrowserDevices(val.deviceId && val.deviceId == obj.deviceId)':
                cb_list_resp,
            'GSuite(true)': {'ChromeBrowserNextToken': page_token}
        }
        return CommandResults(outputs=outputs,
                              readable_output=readable_output,
                              raw_response=response)


    def modify_policy_command(client: Client, args: dict[str, str]) -> str:
        """
            get a user details based on user key.

            :param client: Client object.
            :param args: Command arguments.

            :return: String that confirms request was executed.
        """
        client.set_authorized_http(scopes=SCOPES['POLICY_MANAGEMENT'])
        customer_id = return_customer_id(args)
        target_type = args.get('target_type', '')
        policy_raw_json = args.get('policy_raw_json', '')
        policy_field_json_entry_id = args.get('policy_field_json_entry_id', '')
        target_resource = args.get('target_resource', '')
        additional_target_keys = args.get('additional_target_keys', '')
        policy_schema = args.get('policy_schema', '')
        policy_value = args.get('policy_value', '')
        update_mask = args.get('update_mask', '')

        if target_type == 'Group':
            full_url = f'https://chromepolicy.googleapis.com/v1/customers/{customer_id}/policies/groups:batchModify'
            target_resource_customized = f'groups/{target_resource}'
        else:
            full_url = f'https://chromepolicy.googleapis.com/v1/customers/{customer_id}/policies/orgunits:batchModify'
            target_resource_customized = f'orgunits/{target_resource}'

        if additional_target_keys:
            atk_dict = json.loads(additional_target_keys)
        else:
            atk_dict = {}

        if policy_raw_json:
            app_payload = GSuiteClient.safe_load_non_strict_json(policy_raw_json)
        elif policy_field_json_entry_id:
            app_payload = return_file_from_entry_id(policy_field_json_entry_id)
        else:
            app_payload = {
                "requests": [
                    {
                        "policyTargetKey":
                        {
                            "targetResource": target_resource_customized,
                            "additionalTargetKeys": atk_dict
                        },
                        "policyValue": {
                            "policySchema": policy_schema,
                            "value": {
                                "appInstallType": policy_value
                            }
                        },
                        "updateMask": update_mask
                    }
                ]
            }

        client.http_request(full_url=full_url, method='POST', body=app_payload)

        # Output
        return f'Policy has been modified for the customer {customer_id}'


    def policy_resolve_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
            resolve the provided policy and return its details

            :param client: Client object.
            :param args: Command arguments.

            :return: Command Result.
        """
        API_LIMIT = 1000
        client.set_authorized_http(scopes=SCOPES['POLICY_MANAGEMENT'])
        customer_id = return_customer_id(args)
        target_type = args.get('target_type', '')
        policy_schema_filter = args.get('policy_schema_filter', '')
        target_resource = args.get('target_resource', '')
        additional_target_keys = args.get('additional_target_keys', '')
        page_size = args.get('page_size', '')
        page_token = args.get('page_token', '')
        limit = args.get('limit', '')

        if additional_target_keys:
            atk_dict = json.loads(additional_target_keys)
        else:
            atk_dict = {}

        if target_type == 'Group':
            target_resource_customized = f'groups/{target_resource}'
        else:
            target_resource_customized = f'orgunits/{target_resource}'

        app_payload = {
            "policySchemaFilter": policy_schema_filter,
            "policyTargetKey": {
                "targetResource": target_resource_customized,
                "additionalTargetKeys": atk_dict
            },
            "pageSize": page_size,
            "pageToken": page_token
        }

        full_url = f'https://chromepolicy.googleapis.com/v1/customers/{customer_id}/policies:resolve'

        policy_resolved_resp = []
        if page_size or page_token:
            if not page_size:
                page_size = str(DEFAULT_PAGE_SIZE)
            if int(page_size) > API_LIMIT:
                page_size = str(API_LIMIT)
            app_payload['pageSize'] = page_size
            response = client.http_request(full_url=full_url, method='POST', body=app_payload)
            page_token = response.get('nextPageToken', '')
            policy_resolved_resp.extend(response.get('resolvedPolicies', ''))  # type: ignore
        else:
            while len(policy_resolved_resp) < int(limit):
                if int(limit) - len(policy_resolved_resp) > API_LIMIT:
                    page_size = str(API_LIMIT)
                else:
                    page_size = str(int(limit) - len(policy_resolved_resp))
                app_payload['pageSize'] = page_size
                app_payload['pageToken'] = page_token
                response = client.http_request(full_url=full_url, method='POST', body=app_payload)
                page_token = response.get('nextPageToken', '')
                policy_resolved_resp.extend(response.get('resolvedPolicies', ''))  # type: ignore
                if not page_token:
                    break

        hr_from_response = []
        for res in policy_resolved_resp:
            customized_resp = {'targetResource': res['targetKey']['targetResource'],  # type: ignore
                               'additionalTargetKeys': res['targetKey']['additionalTargetKeys'],  # type: ignore
                               'policySchema': res['value']['policySchema']}  # type: ignore
            hr_from_response.append(customized_resp)
        # Readable Output
        readable_output = tableToMarkdown(HR_MESSAGES['POLICY_RESOLVE'], hr_from_response,
                                          ['targetResource', 'additionalTargetKeys', 'policySchema'],
                                          headerTransform=pascalToSpace, removeNull=True)
        outputs = {
            'GSuite.Policy(val.targetKey.targetResource && val.targetKey.targetResource == obj.targetKey.targetResource)':
                policy_resolved_resp,
            'GSuite(true)': {'PolicyNextToken': page_token}
        }
        return CommandResults(outputs=outputs,
                              readable_output=readable_output,
                              raw_response=response)


    def assign_params_policy_schemas(filter, page_size, page_token):
        return GSuiteClient.remove_empty_entities({
            'filter': filter,
            'pageSize': page_size,
            'pageToken': page_token
        })


    def policy_schemas_list_command(client: Client, args: dict[str, str]) -> CommandResults:
        """
            list policy schemas

            :param client: Client object.
            :param args: Command arguments.

            :return: Command Result.
        """
        API_LIMIT = 1000
        client.set_authorized_http(scopes=SCOPES['POLICY_MANAGEMENT'])
        customer_id = return_customer_id(args)
        schema_name = args.get('schema_name', '')
        filter = args.get('filter', '')
        page_size = args.get('page_size', '')
        page_token = args.get('page_token', '')
        limit = args.get('limit', '')

        full_url = f'https://chromepolicy.googleapis.com/v1/customers/{customer_id}/policySchemas'
        policy_schemas_resp = []
        if schema_name:
            full_url = f'https://chromepolicy.googleapis.com/v1/customers/{customer_id}/policySchemas/{schema_name}'
            response = client.http_request(full_url=full_url, method='GET')
            policy_schemas_resp.append(response)  # type: ignore
        else:
            if page_size or page_token:
                if not page_size:
                    page_size = str(DEFAULT_PAGE_SIZE)
                if int(page_size) > API_LIMIT:
                    page_size = str(API_LIMIT)
                params_for_command = assign_params_policy_schemas(filter, page_size, page_token)
                response = client.http_request(full_url=full_url, method='GET', params=params_for_command)
                page_token = response.get('nextPageToken', '')
                policy_schemas_resp.extend(response.get('policySchemas', ''))  # type: ignore
            else:
                while len(policy_schemas_resp) < int(limit):
                    if int(limit) - len(policy_schemas_resp) > API_LIMIT:
                        page_size = str(API_LIMIT)
                    else:
                        page_size = str(int(limit) - len(policy_schemas_resp))
                    params_for_command = assign_params_policy_schemas(filter, page_size, page_token)
                    response = client.http_request(full_url=full_url, method='GET', params=params_for_command)
                    page_token = response.get('nextPageToken', '')
                    policy_schemas_resp.extend(response.get('policySchemas', ''))  # type: ignore
                    if not page_token:
                        break

        # Readable Output
        readable_output = tableToMarkdown(HR_MESSAGES['POLICY_LIST'], policy_schemas_resp,
                                          ['name', 'policyDescription', 'schemaName'],
                                          headerTransform=pascalToSpace, removeNull=True)
        outputs = {
            'GSuite.Policy(val.name && val.name == obj.name)':
                policy_schemas_resp,
            'GSuite(true)': {'PolicySchemasNextToken': page_token}
        }
        return CommandResults(outputs=outputs,
                              readable_output=readable_output,
                              raw_response=response)


    def group_delete_command(client: Client, args: dict[str, str]) -> str:
        """
           delete a user_group based on target_id

           :param client: Client object.
           :param args: Command arguments.

           :return: String that confirms request was executed.
       """
        client.set_authorized_http(scopes=SCOPES['POLICY_MANAGEMENT'])
        customer_id = return_customer_id(args)
        policy_raw_json = args.get('policy_raw_json', '')
        policy_field_json_entry_id = args.get('policy_field_json_entry_id', '')
        target_resource = args.get('target_resource', '')
        additional_target_keys = args.get('additional_target_keys', '')
        policy_schema = args.get('policy_schema', '')

        if additional_target_keys:
            atk_dict = json.loads(additional_target_keys)
        else:
            atk_dict = {}

        target_resource_customized = f'groups/{target_resource}'
        full_url = f'https://chromepolicy.googleapis.com/v1/customers/{customer_id}/policies/groups:batchDelete'
        if policy_raw_json:
            app_payload = GSuiteClient.safe_load_non_strict_json(policy_raw_json)
        elif policy_field_json_entry_id:
            app_payload = return_file_from_entry_id(policy_field_json_entry_id)
        else:
            app_payload = {
                "requests": [
                    {
                        "policyTargetKey":
                            {
                                "targetResource": target_resource_customized,
                                "additionalTargetKeys": atk_dict
                            },
                        "policySchema": policy_schema,
                    }
                ]
            }

        client.http_request(full_url=full_url, method='POST', body=app_payload)

        # Output
        return f'Policy has been deleted for the customer {customer_id}'


    def main() -> None:
        """
             PARSE AND VALIDATE INTEGRATION PARAMS
        """

        # Commands dictionary
        commands: dict[str, Callable] = {
            'gsuite-custom-user-schema-update': custom_user_schema_update_command,
            'gsuite-custom-user-schema-create': custom_user_schema_create_command,
            'gsuite-datatransfer-list': datatransfer_list_command,
            'gsuite-role-assignment-create': role_assignment_create_command,
            'gsuite-role-assignment-list': role_assignment_list_command,
            'gsuite-user-create': user_create_command,
            'gsuite-user-get': user_get_command,
            'gsuite-mobile-update': mobile_update_command,
            'gsuite-mobile-delete': mobile_delete_command,
            'gsuite-user-alias-add': user_alias_add_command,
            'gsuite-group-create': group_create_command,
            'gsuite-group-get': group_get_command,
            'gsuite-role-create': role_create_command,
            'gsuite-token-revoke': token_revoke_command,
            'gsuite-datatransfer-request-create': datatransfer_request_create_command,
            'gsuite-user-delete': user_delete_command,
            'gsuite-user-update': user_update_command,
            'gsuite-mobiledevice-list': gsuite_mobile_device_list_command,
            'gsuite-chromeosdevice-action': gsuite_chromeos_device_action_command,
            'gsuite-chromeosdevice-list': gsuite_chromeos_device_list_command,
            'gsuite-user-signout': user_signout_command,
            'gsuite-user-reset-password': user_reset_password_command,
            'gsuite-chromebrowserdevice-move-ou': chromebrowser_move_ou_command,
            'gsuite-chromebrowserdevice-list': chromebrowser_list_command,
            'gsuite-policy-modify': modify_policy_command,
            'gsuite-policy-schemas-list': policy_schemas_list_command,
            'gsuite-policy-resolve': policy_resolve_command,
            'gsuite-policy-groups-delete': group_delete_command
        }
        command = demisto.command()
        demisto.info(f'Command being called is {command}')

        try:
            params = demisto.params()
            service_account_dict = GSuiteClient.safe_load_non_strict_json(
                params.get('admin_email_creds', {}).get('password') or params.get('user_service_account_json'))
            verify_certificate = not params.get('insecure', False)
            proxy = params.get('proxy', False)

            headers = {
                'Content-Type': 'application/json'
            }

            args = GSuiteClient.strip_dict(demisto.args())

            admin_email = args.get('admin_email')\
                or params.get('admin_email_creds', {}).get('identifier')\
                or params.get('admin_email')

            if admin_email and not is_email_valid(admin_email):
                raise ValueError(MESSAGES['INVALID_ADMIN_EMAIL'])

            # prepare client class object
            client = Client(service_account_dict=service_account_dict, base_url='https://admin.googleapis.com/',
                            verify=verify_certificate, proxy=proxy, headers=headers,
                            admin_email=admin_email
                            )

            # This is the call made when pressing the integration Test button.
            if demisto.command() == 'test-module':
                result = test_module(client)
                demisto.results(result)

            elif command in commands:
                return_results(commands[command](client, args))
            else:
                raise NotImplementedError(f'{command} command is not implemented.')
            # Log exceptions
        except Exception as e:
            demisto.error(traceback.format_exc())  # Print the traceback
            return_error(f'Error: {str(e)}')


    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()

    register_module_line('GSuiteAdmin', 'end', __line__())
  subtype: python3
  type: python
system: true
