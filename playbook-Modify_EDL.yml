contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.6.0
    itemVersion: 3.3.3
    packID: EDL
    packName: Generic Export Indicators Service
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: |-
  Adds indicators to or removes indicators from an external dynamic list (EDL) by adding or removing an indicator tag. The EDL itself is generated by using the Cortex XSOAR Generic Export Indicators Service integration and querying on a tag in the Indicator Query parameter.

  Incident fields that control the behavior of this playbook:
  - EDL Action: Whether to add or remove EDL indicators.
  - EDL Indicators List: Input list of indicators to add to or remove from EDL (according to the value of EDL Action).
  - EDL Tag: Tag value in the Generic Export Indicators Service integration instance Indicator Query, which controls which indicators are on the EDL.
  - EDL Indicator Type: (Only relevant if adding to EDL) Type of indicators to add to EDL.
id: Modify EDL
inputs:
- description: 'Action to perform on EDL. Possible values: "Add", "Remove".'
  key: EDL Action
  playbookInputQuery: null
  required: true
  value: {}
- description: Tag that adds indicators to EDL. Must match tag value used in EDL query
    in the instance configuration.
  key: EDL Tag
  playbookInputQuery: null
  required: true
  value: {}
- description: Required only if adding to EDL. Type of indicators to add to EDL.
  key: EDL Indicator Type
  playbookInputQuery: null
  required: false
  value: {}
- description: List of IOCs to add to or remove from EDL (according to value of EDL
    Action). May be newline or comma-delimited.
  key: EDL Indicators List
  playbookInputQuery: null
  required: true
  value: {}
name: Modify EDL
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eb9323b0-d4bf-435f-89f4-af6a567d771c
      iscommand: false
      name: ""
      version: -1
    taskid: eb9323b0-d4bf-435f-89f4-af6a567d771c
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 490,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: FoundIndicators=value
      value:
        complex:
          root: InputIndicatorsArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: e978deb1-0fbc-44bc-8784-4beb509246fb
      iscommand: true
      name: Check which indicators already exist in Cortex XSOAR
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: e978deb1-0fbc-44bc-8784-4beb509246fb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 895
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: InputIndicatorsArray
      value:
        complex:
          accessor: genericexportindicatorsserviceindicatorslist
          root: incident
          transformers:
          - args:
              chars:
                value:
                  simple: "\n "
            operator: StripChars
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: |2+

              toReplace:
                value:
                  simple: ','
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 2a97257f-f9bb-40f2-8d6f-b476961da61f
      iscommand: false
      name: Save input list of indicators as array (Split transformer)
      script: Set
      type: regular
      version: -1
    taskid: 2a97257f-f9bb-40f2-8d6f-b476961da61f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 545
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ac83f0a5-3b20-4adb-81c8-73e57d74fa66
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: ac83f0a5-3b20-4adb-81c8-73e57d74fa66
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 1740
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: true
    quietmode: 0
    scriptarguments:
      tags:
        simple: ${incident.genericexportindicatorsservicetag}
      type:
        simple: ${incident.genericexportindicatorsserviceindicatortype}
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InputIndicatorsArray
              operator: notIn
              right:
                value:
                  simple: ${FoundIndicators}
          root: InputIndicatorsArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 87ce6528-3366-4359-88b5-916e10797388
      iscommand: true
      name: Create new indicators with EDL tag
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 87ce6528-3366-4359-88b5-916e10797388
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1390
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 27208231-2d82-4d41-840e-d3b6703c3721
      iscommand: false
      name: ADD to EDL - Create new and update existing indicators
      type: title
      version: -1
    taskid: 27208231-2d82-4d41-840e-d3b6703c3721
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1070
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: true
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${incident.genericexportindicatorsservicetag}
      indicatorsValues:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InputIndicatorsArray
              operator: in
              right:
                value:
                  simple: ${FoundIndicators}
          root: InputIndicatorsArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      id: 0aa70b5b-fc6f-4cde-80d9-9b3fdc90c7bd
      iscommand: true
      name: Add EDL tag to existing indicators
      script: Builtin|||appendIndicatorField
      type: regular
      version: -1
    taskid: 0aa70b5b-fc6f-4cde-80d9-9b3fdc90c7bd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 1390
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: InputIndicatorsArray
                    operator: notIn
                    right:
                      value:
                        simple: ${FoundIndicators}
                root: InputIndicatorsArray
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if there are new indicators to create, which do not already
        exist in the Cortex XSOAR database.
      id: 0c815fb4-5ee4-4f72-8c83-6e559d73928a
      iscommand: false
      name: Are there new indicators to create?
      type: condition
      version: -1
    taskid: 0c815fb4-5ee4-4f72-8c83-6e559d73928a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1215
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: InputIndicatorsArray
                    operator: in
                    right:
                      value:
                        simple: ${FoundIndicators}
                root: InputIndicatorsArray
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if there are indicators that already exist in the Cortex
        XSOAR database. IF so, the tag needs to be added to add them to the EDL.
      id: 63c89c44-1914-427f-8590-328c861ba7ae
      iscommand: false
      name: Are there pre-existing indicators to update?
      type: condition
      version: -1
    taskid: 63c89c44-1914-427f-8590-328c861ba7ae
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1215
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: e58007a8-290f-43b3-85f2-280a16526440
      iscommand: true
      name: Close incident
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: e58007a8-290f-43b3-85f2-280a16526440
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 1565
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.genericexportindicatorsserviceaction
          operator: isEqualString
          right:
            value:
              simple: Add
      label: Adding
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.genericexportindicatorsserviceaction
          operator: isEqualString
          right:
            value:
              simple: Remove
      label: Removing
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Adding:
      - "1"
      Removing:
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether to add or remove indicators from the EDL, according
        to the value of the `EDL Action`input field.
      id: 8ff5b7b0-f350-47dc-85ae-a8674691f6d0
      iscommand: false
      name: Adding or removing indicators?
      type: condition
      version: -1
    taskid: 8ff5b7b0-f350-47dc-85ae-a8674691f6d0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 720
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c84c0471-d130-4b43-82de-39514d9f974a
      iscommand: false
      name: Remove from EDL - Update indicators to remove tag
      type: title
      version: -1
    taskid: c84c0471-d130-4b43-82de-39514d9f974a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1042.5,
          "y": 1230
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: true
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${incident.genericexportindicatorsservicetag}
      indicatorsValues:
        simple: ${InputIndicatorsArray}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: ffc0eb39-23e0-48ba-87be-37c73242c37e
      iscommand: true
      name: Remove EDL tag from indicators
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: ffc0eb39-23e0-48ba-87be-37c73242c37e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1042.5,
          "y": 1390
        }
      }
  "30":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.EDL Action
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: inputs.EDL Tag
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: inputs.EDL Indicators List
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: incident.genericexportindicatorsserviceaction
          operator: isEmpty
      - - left:
            iscontext: true
            value:
              simple: incident.genericexportindicatorsservicetag
          operator: isEmpty
      - - left:
            iscontext: true
            value:
              simple: incident.genericexportindicatorsserviceindicatorslist
          operator: isEmpty
      label: "yes"
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if playbook is being run as a sub-playbook. (Check if values
        were passed as playbook inputs instead of incident fields.)
      id: b4dc98ea-e45d-412a-899a-b4f454ff33bc
      iscommand: false
      name: Playbook inputs provided instead of incident fields?
      type: condition
      version: -1
    taskid: b4dc98ea-e45d-412a-899a-b4f454ff33bc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 195
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      genericexportindicatorsserviceaction:
        simple: ${inputs.EDL Action}
      genericexportindicatorsserviceindicatorslist:
        complex:
          root: inputs.EDL Indicators List
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      genericexportindicatorsserviceindicatortype:
        simple: ${inputs.EDL Indicator Type}
      genericexportindicatorsservicetag:
        simple: ${inputs.EDL Tag}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 3680f381-35df-4f13-850f-5f178d4f5499
      iscommand: true
      name: Set inputs to indicator fields
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 3680f381-35df-4f13-850f-5f178d4f5499
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": 370
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1755,
        "width": 1372.5,
        "x": 50,
        "y": 50
      }
    }
  }
