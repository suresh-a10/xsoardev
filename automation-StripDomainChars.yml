args:
- default: true
  name: value
  required: true
comment: Strips all www. http/s and after / chars from domain
commonfields:
  id: 538d1053-bf0f-476b-8458-5f1927a2aeff
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.7.4.2728
enabled: true
engineinfo: {}
mainengineinfo: {}
name: StripDomainChars
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  import re


  def main():
      value = demisto.args()['value']
      value1 = ""

      if "https" in value:
          value1 = value.split("https://")[1]
          if "www" in value1:
              value1 = value1.split("www.")[1]
          if "/" in value1:
              value1 = value1.split("/")[0]
      elif "http" in value:
          value1 = value.split("http://")[1]
          if "www" in value1:
              value1 = value1.split("www.")[1]
          if "/" in value1:
              value1 = value1.split("/")[0]
      elif "www" in value:
          value1 = value.split("www.")[1]
          if "/" in value1:
              value1 = value1.split("/")[0]
      else:
          if "/" in value:
              value1 = value.split("/")[0]

      ip = re.findall( r'([0-9]+)(?:\.[0-9]+){3}', value)
      if ip:
          value1 = ""

      demisto.results(value1)


  if __name__ == "__builtin__" or __name__ == "builtins":
      main()
scripttarget: 0
subtype: python3
tags:
- general
- transformer
type: python
