contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 1.10.54
    packID: ExpanseV2
    packName: Cortex Xpanse by Palo Alto Networks
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: |-
  A generic playbook for handling Xpanse issues.
  The logic behind this playbook is to work with an internal exclusions list which will help the analyst to get to a decision or, if configured, close incidents automatically.
  The phases of this playbook are:
    1) Check if assets (IP, Domain or Certificate) associated with the issue are excluded in the exclusions list and optionally, close the incident automatically.
    2) Optionally, enrich indicators and calculate the severity of the issue, using sub-playbooks.
    3) Optionally, allow the analyst to add associated assets (IP, Domain or Certificate) to the exclusions list.
    4) Tag associated assets.
    5) Update the status of the issue.
id: Xpanse Incident Handling - Generic
inputs:
- description: "The name of an internal XSOAR list which includes all IP values or
    Domain values on the allowed list.  If no list currently exist, the playbook will
    create it for you with the givan name.\nThe structure of this list should be:\n\n{\n
    \"Addresses\":[\n    {\n      \"ip\": \"x.x.x.x\",\n      \"issueTypeID\": \"issueTypeIDHere\",\n
    \     \"port\": 123,\n      \"protocol\": \"UDP\"\n    },\n    {\n      \"ip\":
    \"x.x.x.x\",\n      \"issueTypeID\": \"issueTypeIDHere\",\n      \"port\": 456,\n
    \     \"protocol\": \"TCP\"\n    },\n    .\n    .\n    .\n  ],\n\"Domains\":[\n
    \  {\n     \"domain\":\"some.domain.com\",\n     \"issueTypeID\": \"issueTypeIDHere\",\n
    \    \"port\": 80,\n     \"protocol\": \"TCP\"\n   }\n   .\n   .\n   .\n ] ,\n\"Certificates\":[\n
    \  {\n     \"sha256fingerprint\":\"value of sha256 fingerprin\",\n     \"issueTypeID\":
    \"issueTypeIDHere\",\n     \"subject\": \"certificate subject\"\n   }\n   .\n
    \  .\n   .\n ]\n}\n\nFor example:\n\n{\n   \"Addresses\":[\n      {\n         \"ip\":\"10.0.0.1\",\n
    \        \"issueTypeID\":\"MissingXFrameOptionsHeader\",\n         \"port\":443,\n
    \        \"protocol\": \"TCP\"\n      },\n      {\n         \"ip\":\"10.0.0.2\",\n
    \        \"issueTypeID\":\"WildcardCertificate\",\n         \"port\":443,\n         \"protocol\":
    \"TCP\"\n      }\n   ],\n   \"Domains\":[\n\t   {\n\t     \"domain\":\"my.domain.com\",\n\t
    \    \"issueTypeID\": \"ApacheWebServer\",\n\t     \"port\": 443,\n\t     \"protocol\":
    \"TCP\"\n\t   }\t\n   ],\n   \"Certificates\":[\n       {\n         \"sha256fingerprint\":\"f2ca1bb.....6fd2\",\n
    \    \t \"issueTypeID\": \"ShortKeyCertificate\",\n     \t \"subject\": \"C=US,ST=WASHINGTON,L=.....E=John@test.com\"\n
    \  \t}\n   ]\n}\n\nIn the above example, we will whitelist \"MissingXFrameOptionsHeader\"
    issue type ID on 10.0.0.1:443, \"WildcardCertificate\" issue type ID on 10.0.0.2:443,
    \"ApacheWebServer\" issue type ID on my.domain.com:443 And \"ShortKeyCertificate\"
    on a certificate with a specific sha256 fingerprint and subject. "
  key: ExclusionsList
  playbookInputQuery: null
  required: true
  value:
    simple: XpanseExclusionsList
- description: Whether to extract and enrich indicators automatically using the "Entity
    Enrichment - Generic V3" playbook.
  key: EnrichIndicators
  playbookInputQuery: null
  required: false
  value:
    simple: "True"
- description: Whether to calculate the severity of the incident automatically using
    the "Calculate Severity - Standard" playbook.
  key: CalculateSeverity
  playbookInputQuery: null
  required: false
  value:
    simple: "True"
- description: |-
    A comma-separated list of common tags (lower case letters) which your organization uses.
    For example:
    tag1, tag2, tag3 ...
  key: CommonTags
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    True - Close the incident automatically if the current issue's certificate or a domain are excluded. If an IP is excluded, close automatically only if there is no domain for the incident.

    False - Let the analyst go over the incident manually even if the assets are excluded.
  key: CloseWhenExcluded
  playbookInputQuery: null
  required: false
  value: {}
- description: "If the value of \"CloseWhenExcluded\" is \"True\", tag associated
    assets with this value in Xpanse. \nFor example, if the value of \"AutomaticTagValue\"
    is \"excluded-in-xsoar\", the tag \"excluded-in-xsoar\" will be assigned to the
    assets."
  key: AutomaticTagValue
  playbookInputQuery: null
  required: false
  value:
    simple: excluded-in-xsoar
name: Xpanse Incident Handling - Generic
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b1e16b69-e2e9-4156-8e41-ca3512ed4878
      iscommand: false
      name: ""
      version: -1
    taskid: b1e16b69-e2e9-4156-8e41-ca3512ed4878
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 480,
          "y": -2200
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "104"
    note: false
    quietmode: 0
    scriptarguments:
      ListName:
        simple: ${inputs.ExclusionsList}
      ListValues:
        simple: '{"Addresses":[],"Domains":[], "Certificates":[]}'
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |
        Sub-playbook to support the Expanse Handle Incident playbook.
        Loads a list to be used in the Expanse playbook.
        Creates the list if it does not exist.
      id: dd845f24-5012-4e3e-809b-930a255bbf5b
      iscommand: false
      name: Expanse Load-Create List
      playbookId: Expanse Load-Create List
      type: playbook
      version: -1
    taskid: dd845f24-5012-4e3e-809b-930a255bbf5b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 480,
          "y": -1310
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ParsedList.Addresses}
          operator: containsGeneral
          right:
            value:
              simple: ${XpanseValues_IP}
      label: IP Excluded
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      IP Excluded:
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if the combination of IP, Port, and IssueTypeID is excluded.
      id: ea00bef8-9002-4b98-8781-e69ccff3c9da
      iscommand: false
      name: Check if IP is excluded
      type: condition
      version: -1
    taskid: ea00bef8-9002-4b98-8781-e69ccff3c9da
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1340,
          "y": -545
        }
      }
  "4":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: |-
            Take a look at these IP values:
            ${XpanseValues_IP}

            Do you want to add them to the exclusion list "${inputs.ExclusionsList}"?
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: Your SOC team
      title: Excluding IP values
      totalanswers: 0
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: {}
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: Doesn't exist
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d566c3b1-e41a-4581-835e-78bed9e051e4
      iscommand: false
      name: Check if IP values should be excluded
      type: collection
      version: -1
    taskid: d566c3b1-e41a-4581-835e-78bed9e051e4
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 860,
          "y": 2400
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Excluding IP values.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check analyst's answer - exclude IP.
      id: 8eafaadc-2dc2-4509-8ee6-b7c9c0fb09cc
      iscommand: false
      name: Check Analyst's Answer - Exclude IP
      type: condition
      version: -1
    taskid: 8eafaadc-2dc2-4509-8ee6-b7c9c0fb09cc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 860,
          "y": 2575
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      keyName:
        simple: Addresses
      listName:
        simple: ${inputs.ExclusionsList}
      value:
        simple: ${XpanseValues_IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in the key/value store backed by a Cortex XSOAR
        list.
      id: 16e8382b-a6f7-4e9e-8a48-d2f0582fe243
      iscommand: false
      name: Add the new key to list
      script: AddKeyToList
      type: regular
      version: -1
    taskid: 16e8382b-a6f7-4e9e-8a48-d2f0582fe243
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 860,
          "y": 2760
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 28446c0a-34e7-4da8-8ccf-7e29a197d393
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 28446c0a-34e7-4da8-8ccf-7e29a197d393
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7080
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 709f9af5-8cc6-4392-838b-ed706abc07f1
      iscommand: false
      name: Manual Investigation
      type: title
      version: -1
    taskid: 709f9af5-8cc6-4392-838b-ed706abc07f1
    timertriggers:
    - action: start
      fieldname: remediationsla
    type: title
    view: |-
      {
        "position": {
          "x": 100,
          "y": 2945
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.EnrichIndicators
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "88"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Should indicators be extracted and enriched?
      id: 1b8c893e-ccd9-44db-871b-62e0167240e5
      iscommand: false
      name: Should indicators be extracted and enriched?
      type: condition
      version: -1
    taskid: 1b8c893e-ccd9-44db-871b-62e0167240e5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 365
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "87"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9585db58-a53e-4691-8d18-877d01a2c928
      iscommand: false
      name: Enrich indicators
      type: title
      version: -1
    taskid: 9585db58-a53e-4691-8d18-877d01a2c928
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 565
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4066cc9b-568f-44b0-8af0-dccc086c02f4
      iscommand: false
      name: Calculate Severity
      type: title
      version: -1
    taskid: 4066cc9b-568f-44b0-8af0-dccc086c02f4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1600,
          "y": 1020
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "88"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: a656c284-32ca-4147-8271-fcac5b1f1aed
      iscommand: false
      name: Calculate Severity - Standard
      playbookId: Calculate Severity - Standard
      type: playbook
      version: -1
    taskid: a656c284-32ca-4147-8271-fcac5b1f1aed
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1600,
          "y": 1135
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "92"
    note: false
    quietmode: 0
    scriptarguments:
      issue_id:
        simple: ${incident.expanseissueid}
      update_type:
        simple: ProgressStatus
      value:
        simple: Investigating
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Update a property of an Xpanse issue.
      id: c5b28218-f4f4-426f-820c-3c4998956103
      iscommand: true
      name: Update Xpanse's issue "Progress" to "Investigating"
      script: '|||expanse-update-issue'
      type: regular
      version: -1
    taskid: c5b28218-f4f4-426f-820c-3c4998956103
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": -1970
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6f0379da-a287-4f17-859d-50d230933205
      iscommand: false
      name: Check exclusions list
      type: title
      version: -1
    taskid: 6f0379da-a287-4f17-859d-50d230933205
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": -1470
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "118"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 336167f8-d845-4b01-8de5-8b3608cc234f
      iscommand: false
      name: Domain excluded in list
      type: title
      version: -1
    taskid: 336167f8-d845-4b01-8de5-8b3608cc234f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 100,
          "y": 170
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f0eacb79-b414-4a2b-8b68-c01627d99683
      iscommand: false
      name: Not excluded in list
      type: title
      version: -1
    taskid: f0eacb79-b414-4a2b-8b68-c01627d99683
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 170
        }
      }
  "26":
    continueonerrortype: ""
    form:
      description: Review the incident and choose the appropriate status.
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Provide a "Progress" status for Xpanse issue:'
        options: []
        optionsarg:
        - simple: New
        - simple: Investigating
        - simple: In Progress
        - simple: No Risk
        - simple: Acceptable Risk
        - simple: Resolved
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Add a comment to the issue
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: longText
      sender: ""
      title: Update status in Xpanse
      totalanswers: 0
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ' '
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c74b2501-8a59-4d79-865c-477da00d9d3e
      iscommand: false
      name: Update Xpanse issue
      type: collection
      version: -1
    taskid: c74b2501-8a59-4d79-865c-477da00d9d3e
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3130
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      closeNotes:
        simple: ${Close Reason and Note.Answers.1}
      closeReason:
        simple: ${Close Reason and Note.Answers.0}
      id:
        simple: ${incident.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 6a74eb2f-54cd-433a-8419-7004c8786613
      iscommand: true
      name: Close incident
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 6a74eb2f-54cd-433a-8419-7004c8786613
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 730,
          "y": 6910
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      issue_id:
        simple: ${incident.expanseissueid}
      update_type:
        simple: Comment
      value:
        simple: ${Update status in Xpanse.Answers.1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Update a property of an Xpanse issue.
      id: 9080641f-1b30-46b2-8f23-ddb3b99745e6
      iscommand: true
      name: Update Xpanse Comment
      script: '|||expanse-update-issue'
      type: regular
      version: -1
    taskid: 9080641f-1b30-46b2-8f23-ddb3b99745e6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 760,
          "y": 3860
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 0
    scriptarguments:
      issue_id:
        simple: ${incident.expanseissueid}
      update_type:
        simple: ProgressStatus
      value:
        complex:
          accessor: "0"
          root: Update status in Xpanse.Answers
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: ' '
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Update a property of an Xpanse issue.
      id: a8fef264-7505-497a-84e4-ce1415bb45c4
      iscommand: true
      name: Set Xpanse issue "Progress" Value
      script: '|||expanse-update-issue'
      type: regular
      version: -1
    taskid: a8fef264-7505-497a-84e4-ce1415bb45c4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3365
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.expanseasset.tags}
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 235edc69-d34f-4fe0-8c66-fdd3c285e103
      iscommand: false
      name: Check if Tags available
      type: condition
      version: -1
    taskid: 235edc69-d34f-4fe0-8c66-fdd3c285e103
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4430
        }
      }
  "36":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: |-
            Current associated assets:

            Display Name -  ${incident.expanseasset.displayname}
            Type: ${incident.expanseasset.assettype}

            Current assigned tags to the current issue (please note that new tags which have been assigned on associated assets can be seen on the issue only after 24-48 hours):
            ${incident.expanseasset.tags}

            Common Tags (only relevant when "CommonTags" playbook input was provided) :
            Pick one or more tags if you want them to be assigned to the asset as well:
        options: []
        optionsarg:
        - complex:
            root: inputs.CommonTags
            transformers:
            - args:
                delimiter:
                  value:
                    simple: ','
              operator: splitAndTrim
        placeholder: Tag1, Tag2, Tag3....
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: 'If you want to assign more tags, add them below. (If more than
            one, create a comma-separated list):'
        options: []
        optionsarg: []
        placeholder: Tag1, Tag2, Tag3....
        readonly: false
        required: false
        tooltip: ""
        type: shortText
      sender: ""
      title: Xpanse Issue Tagging
      totalanswers: 0
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 987cea9b-707b-481c-838c-2116abbefde2
      iscommand: false
      name: Add additional tags
      type: collection
      version: -1
    taskid: 987cea9b-707b-481c-838c-2116abbefde2
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 260,
          "y": 4640
        }
      }
  "37":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: |-
            Current associated assets:

            Display Name -  ${incident.expanseasset.displayname}
            Type: ${incident.expanseasset.assettype}

            No tags assigned for this issue yet. (Note that new tags which have been assigned on associated assets can be seen on the issue only after 24-48 hours).

            Common Tags (only relevant when "CommonTags" playbook input was provided) :
            Pick one or more tags if you want them to be assigned to the asset as well:
        options: []
        optionsarg:
        - complex:
            root: inputs.CommonTags
            transformers:
            - args:
                delimiter:
                  value:
                    simple: ','
              operator: splitAndTrim
        placeholder: Tag1, Tag2, Tag3...
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: 'If you want to assign other tags to this asset, please add them
            below. (If more than one, create a comma-separated list):'
        options: []
        optionsarg:
        - complex:
            root: inputs.CommonTags
            transformers:
            - args:
                delimiter:
                  value:
                    simple: ','
              operator: splitAndTrim
        placeholder: Tag1, Tag2, Tag3...
        readonly: false
        required: false
        tooltip: ""
        type: longText
      sender: ""
      title: Xpanse issue new tags
      totalanswers: 0
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 37e58bdc-0fb8-4c5b-8322-a45cadd16424
      iscommand: false
      name: Add new tags
      type: collection
      version: -1
    taskid: 37e58bdc-0fb8-4c5b-8322-a45cadd16424
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 700,
          "y": 4640
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "128"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 28dca17a-af73-4329-84f2-f51485117dd2
      iscommand: false
      name: Xxpanse Issue Tagging
      type: title
      version: -1
    taskid: 28dca17a-af73-4329-84f2-f51485117dd2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4055
        }
      }
  "39":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Xpanse issue new tags.Answers.0
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Xpanse issue new tags.Answers.1
          operator: isNotEmpty
      label: New - Both
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Xpanse issue new tags.Answers.0
          operator: isNotEmpty
      label: New - Common
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Xpanse issue new tags.Answers.1
          operator: isNotEmpty
      label: New - Not Common
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Xpanse Issue Tagging.Answers.0
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Xpanse Issue Tagging.Answers.1
          operator: isNotEmpty
      label: Add - Both
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Xpanse Issue Tagging.Answers.0
          operator: isNotEmpty
      label: Add - Common
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Xpanse Issue Tagging.Answers.1
          operator: isNotEmpty
      label: Add - Not Common
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "84"
      Add - Both:
      - "81"
      Add - Common:
      - "54"
      Add - Not Common:
      - "80"
      New - Both:
      - "83"
      New - Common:
      - "55"
      New - Not Common:
      - "82"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3f193959-9ff3-44a6-8f63-ce6b6540be62
      iscommand: false
      name: Check Tagging Answer
      type: condition
      version: -1
    taskid: 3f193959-9ff3-44a6-8f63-ce6b6540be62
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4820
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      name:
        complex:
          root: ${XpanseAdditionalTagNames}
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Create a new tag in Xpanse.
      id: b5fe89f5-88ee-4c8e-81eb-ed3e28945e13
      iscommand: true
      name: Create Tags
      script: '|||expanse-create-tag'
      type: regular
      version: -1
    taskid: b5fe89f5-88ee-4c8e-81eb-ed3e28945e13
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5240
        }
      }
  "53":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Update status in Xpanse.Answers.1
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if comment is not empty.
      id: 783b5ece-e198-44e8-8b99-eb33ba2bbbb5
      iscommand: false
      name: Check Comment
      type: condition
      version: -1
    taskid: 783b5ece-e198-44e8-8b99-eb33ba2bbbb5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3610
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: XpanseAdditionalTagNames
      value:
        simple: ${Xpanse Issue Tagging.Answers.0}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 85f73662-1235-4904-8c6d-c41be4be9774
      iscommand: false
      name: Set "ExpanseAdditionalTagNames" (Add - Common)
      script: Set
      type: regular
      version: -1
    taskid: 85f73662-1235-4904-8c6d-c41be4be9774
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -570,
          "y": 5030
        }
      }
  "55":
    continueonerrortype: ""
    defaultassigneecomplex: {}
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: XpanseAdditionalTagNames
      value:
        simple: ${Xpanse issue new tags.Answers.0}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in the context under the key you entered.
      id: bbd9ec79-2b2c-478c-8dd9-3b76e15904f9
      iscommand: false
      name: Set "ExpanseAdditionalTagNames" (New - Common)
      script: Set
      type: regular
      version: -1
    taskid: bbd9ec79-2b2c-478c-8dd9-3b76e15904f9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 710,
          "y": 5030
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "102"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Script to refresh tags and attribution reasons of assets inside the Xpanse issue. The script should be used inside the Xpanse issue incident context.
      id: 420bc35d-666e-4ce7-87e4-be0c0add6569
      iscommand: false
      name: Refresh Issue Assets
      script: ExpanseRefreshIssueAssets
      type: regular
      version: -1
    taskid: 420bc35d-666e-4ce7-87e4-be0c0add6569
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5410
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "115"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: XpanseValues_IP
      value:
        simple: '{"ip":"${incident.expanseip}","issueTypeID":"${incident.alerttypeid}","port":${incident.expanseport},"protocol":"${incident.expanseprotocol}"}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in the context under the key you entered.
      id: baf81be2-c66f-48d6-80d4-1e612be1a212
      iscommand: false
      name: Set "XpanseValues_IP"
      script: Set
      type: regular
      version: -1
    taskid: baf81be2-c66f-48d6-80d4-1e612be1a212
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": -960
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "116"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: XpanseValues_Domain
      value:
        simple: '{"domain":"${incident.expansedomain}","issueTypeID":"${incident.alerttypeid}","port":${incident.expanseport},"protocol":"${incident.expanseprotocol}"}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in the context under the key you entered.
      id: 39758fe0-8381-4d1b-8c3a-21532c179597
      iscommand: false
      name: Set "XpanseValues_Domain"
      script: Set
      type: regular
      version: -1
    taskid: 39758fe0-8381-4d1b-8c3a-21532c179597
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": -500
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 14d271a4-0d71-4372-81f3-25d8c18d9a9a
      iscommand: false
      name: IP excluded in list
      type: title
      version: -1
    taskid: 14d271a4-0d71-4372-81f3-25d8c18d9a9a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 670,
          "y": 170
        }
      }
  "61":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: |-
            The following domain was excluded in the "${inputs.ExclusionsList}" list with these values:
            ${XpanseValues_Domain}

            Do you want to exclude the following IP as well along with these values?
            ${AssetValues_IP}
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: IP Exclusion
      totalanswers: 0
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ' '
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c344c3f7-1938-44c8-81df-bfbf1457754c
      iscommand: false
      name: Exclude IP as well?
      type: collection
      version: -1
    taskid: c344c3f7-1938-44c8-81df-bfbf1457754c
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -150,
          "y": 950
        }
      }
  "63":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ParsedList.Addresses}
          operator: containsGeneral
          right:
            value:
              simple: ${XpanseValues_IP}
      label: "yes"
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if IP is also excluded.
      id: b8e8752d-652b-4033-85ca-d1510b1e0b5b
      iscommand: false
      name: Check if IP also excluded
      type: condition
      version: -1
    taskid: b8e8752d-652b-4033-85ca-d1510b1e0b5b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 100,
          "y": 690
        }
      }
  "64":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: IP Exclusion.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check analyst's answer - exclude IP.
      id: 594588b2-264e-4204-800c-37695f5292e6
      iscommand: false
      name: Check Analyst's answer - Exclude IP
      type: condition
      version: -1
    taskid: 594588b2-264e-4204-800c-37695f5292e6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -150,
          "y": 1135
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      keyName:
        simple: Addresses
      listName:
        simple: ${inputs.ExclusionsList}
      value:
        simple: ${XpanseValues_IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in the key/value store backed by a Cortex XSOAR
        list.
      id: 9f2f4f2d-e3b7-4044-83be-d2417e52e556
      iscommand: false
      name: Add the new key to list
      script: AddKeyToList
      type: regular
      version: -1
    taskid: 9f2f4f2d-e3b7-4044-83be-d2417e52e556
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -150,
          "y": 1345
        }
      }
  "67":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: |-
            The following IP was excluded in the "${inputs.ExclusionsList}" list with these values:
            ${XpanseValues_IP}

            Do you want to exclude the following IP as well along with these values?
            ${AssetValues_Domain}
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Domain Exclusion
      totalanswers: 0
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ' '
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5a2d01dd-8144-463e-8733-f308f005475c
      iscommand: false
      name: Exclude Domain as well?
      type: collection
      version: -1
    taskid: 5a2d01dd-8144-463e-8733-f308f005475c
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 670,
          "y": 550
        }
      }
  "68":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain Exclusion.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "119"
      "yes":
      - "70"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check analyst's answer - exclude domain.
      id: f6619685-1fd6-4667-88bd-01ed6a1930cc
      iscommand: false
      name: Check Analyst's answer - Exclude domain
      type: condition
      version: -1
    taskid: f6619685-1fd6-4667-88bd-01ed6a1930cc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 670,
          "y": 750
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "119"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      keyName:
        simple: Domains
      listName:
        simple: ${inputs.ExclusionsList}
      value:
        simple: ${XpanseValues_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in key/value store backed by an XSOAR list.
      id: adb5d414-caba-4562-80c0-2ebf3c82840e
      iscommand: false
      name: Add the new key to list
      script: AddKeyToList
      type: regular
      version: -1
    taskid: adb5d414-caba-4562-80c0-2ebf3c82840e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 1005
        }
      }
  "71":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.expansedomain}
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "73"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if Xpanse domain exists.
      id: bec52d6d-f628-4b0b-86e5-2784b1c26e64
      iscommand: false
      name: Check if domain exists
      type: condition
      version: -1
    taskid: bec52d6d-f628-4b0b-86e5-2784b1c26e64
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 1650
        }
      }
  "73":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: |-
            Please take a look at these domain values:
            ${XpanseValues_Domain}

            Do you want to add them to the exclusion list "${inputs.ExclusionsList}"?
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: Your SOC team
      title: Excluding Domain values
      totalanswers: 0
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: {}
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: Doesn't exist
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e85796c3-f8f9-45a9-840d-5a3c6b70c4f8
      iscommand: false
      name: Check if domain values should be excluded
      type: collection
      version: -1
    taskid: e85796c3-f8f9-45a9-840d-5a3c6b70c4f8
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 1850
        }
      }
  "75":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Excluding Domain values.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check analyst's answer - exclude domain.
      id: f76a0a5f-1d19-41d3-8452-19d49c4b9f58
      iscommand: false
      name: Check Analyst's Answer - Exclude Domain
      type: condition
      version: -1
    taskid: f76a0a5f-1d19-41d3-8452-19d49c4b9f58
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 2030
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      keyName:
        simple: Domains
      listName:
        simple: ${inputs.ExclusionsList}
      value:
        simple: ${XpanseValues_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in key/value store backed by an XSOAR list.
      id: eb511a13-440b-49a4-86c5-1f8faafba04b
      iscommand: false
      name: Add the new key to list
      script: AddKeyToList
      type: regular
      version: -1
    taskid: eb511a13-440b-49a4-86c5-1f8faafba04b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 2225
        }
      }
  "79":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${XpanseValues_Domain.domain}
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "119"
      "yes":
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if Xpanse domain exists.
      id: 0b6c0aa1-4478-4048-85a4-aa5645373e86
      iscommand: false
      name: Check if domain Exists
      type: condition
      version: -1
    taskid: 0b6c0aa1-4478-4048-85a4-aa5645373e86
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 670,
          "y": 330
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: XpanseAdditionalTagNames
      value:
        simple: ${Xpanse Issue Tagging.Answers.1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: bb1566be-de12-483a-8774-ba9c1a3b20c9
      iscommand: false
      name: Set "ExpanseAdditionalTagNames" (Add - Not Common)
      script: Set
      type: regular
      version: -1
    taskid: bb1566be-de12-483a-8774-ba9c1a3b20c9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -160,
          "y": 5030
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: XpanseAdditionalTagNames
      value:
        complex:
          accessor: 0}
          root: ${Xpanse Issue Tagging.Answers
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: Xpanse Issue Tagging.Answers.1
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4ad14c6c-b27e-47fe-847d-fdbd6bd66141
      iscommand: false
      name: Set "ExpanseAdditionalTagNames" (Add - Both)
      script: Set
      type: regular
      version: -1
    taskid: 4ad14c6c-b27e-47fe-847d-fdbd6bd66141
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 5030
        }
      }
  "82":
    continueonerrortype: ""
    defaultassigneecomplex: {}
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: XpanseAdditionalTagNames
      value:
        simple: ${Xpanse issue new tags.Answers.1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6c3f2473-0348-49b4-8076-7bd4691e9274
      iscommand: false
      name: Set "ExpanseAdditionalTagNames" (New - Not Common)
      script: Set
      type: regular
      version: -1
    taskid: 6c3f2473-0348-49b4-8076-7bd4691e9274
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1120,
          "y": 5030
        }
      }
  "83":
    continueonerrortype: ""
    defaultassigneecomplex: {}
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: XpanseAdditionalTagNames
      value:
        complex:
          accessor: 0}
          root: ${Xpanse issue new tags.Answers
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: Xpanse issue new tags.Answers.1
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 852c3159-5bb4-4807-8649-f877eb8d3735
      iscommand: false
      name: Set "ExpanseAdditionalTagNames" (New - Both)
      script: Set
      type: regular
      version: -1
    taskid: 852c3159-5bb4-4807-8649-f877eb8d3735
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1530,
          "y": 5030
        }
      }
  "84":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Do you want to close this incident?
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Close incident?
      totalanswers: 0
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "85"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a532f0f6-6600-48d9-8554-bb2fb17cac63
      iscommand: false
      name: Close Incident?
      type: collection
      version: -1
    taskid: a532f0f6-6600-48d9-8554-bb2fb17cac63
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6010
        }
      }
  "85":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Close incident?.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "99"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8a8dc8f8-5f93-4a74-83d7-20d79defef82
      iscommand: false
      name: Check if incident should be closed
      type: condition
      version: -1
    taskid: 8a8dc8f8-5f93-4a74-83d7-20d79defef82
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6190
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "84"
    note: false
    quietmode: 0
    scriptarguments:
      asset_id:
        simple: ${incident.expanseasset.assetkey}
      asset_type:
        simple: ${incident.expanseasset.assettype}
      tag_names:
        complex:
          root: ${XpanseAdditionalTagNames}
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
          - operator: toLowerCase
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assign tags to an Xpanse asset.
      id: 080bfa9b-05bd-4793-841a-79d7a804f8d4
      iscommand: true
      name: Assign tags to issue's assets (cloud)
      script: '|||expanse-assign-tags-to-asset'
      type: regular
      version: -1
    taskid: 080bfa9b-05bd-4793-841a-79d7a804f8d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 60,
          "y": 5800
        }
      }
  "87":
    continueonerrortype: ""
    id: "87"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "95"
    note: false
    quietmode: 0
    scriptarguments:
      Create Indicators:
        simple: "true"
      Expanse Assets:
        complex:
          accessor: expanseasset
          root: incident
      Expanse IP:
        complex:
          accessor: expanseip
          root: incident
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |2-
          Sub-playbook for Handle Expanse Incident playbooks.
          Extract and Enrich Indicators (CIDRs, IPs, Certificates, Domains and DomainGlobs) from Expanse Incidents.
          Enrichment is performed via enrichIndicators command and generic playbooks.
          Returns the enriched indicators.
      id: 11d99b57-2d20-40d4-8045-ad80dfedffd5
      iscommand: false
      name: Extract and Enrich Xpanse Indicators
      playbookId: Extract and Enrich Expanse Indicators
      type: playbook
      version: -1
    taskid: 11d99b57-2d20-40d4-8045-ad80dfedffd5
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 690
        }
      }
  "88":
    continueonerrortype: ""
    id: "88"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "108"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 71fca259-9459-4a4d-8542-26983d53b0d1
      iscommand: false
      name: Add new values to exclusion list
      type: title
      version: -1
    taskid: 71fca259-9459-4a4d-8542-26983d53b0d1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1090,
          "y": 1305
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: true
    quietmode: 0
    scriptarguments:
      issue_id:
        simple: ${incident.expanseissueid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve issue comments (subset of updates).
      id: 74d07baa-2ecb-46b6-8acd-c88dcfe5235e
      iscommand: true
      name: Fetch Xpanse Issue's comments
      script: '|||expanse-get-issue-comments'
      type: regular
      version: -1
    taskid: 74d07baa-2ecb-46b6-8acd-c88dcfe5235e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": -1750
        }
      }
  "95":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.CalculateSeverity
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "88"
      "yes":
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7cb7723e-0966-4bd9-8eb4-837e16d12dec
      iscommand: false
      name: Calculate severity?
      type: condition
      version: -1
    taskid: 7cb7723e-0966-4bd9-8eb4-837e16d12dec
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 845
        }
      }
  "99":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Please choose the relevant Close Reason
        options: []
        optionsarg:
        - simple: False Positive
        - simple: Resolved
        - simple: Duplicate
        - simple: Other
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Add a close note
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: longText
      sender: ""
      title: Close Reason and Note
      totalanswers: 0
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9f5d80de-6954-4add-82ba-d3bee5b692bb
      iscommand: false
      name: Close Reason and Note
      type: collection
      version: -1
    taskid: 9f5d80de-6954-4add-82ba-d3bee5b692bb
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 730,
          "y": 6360
        }
      }
  "102":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.expanseasset.assettype}
          operator: isEqualString
          right:
            value:
              simple: CloudResource
      label: "yes"
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "103"
      "yes":
      - "86"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 44b58df9-1fd2-48cb-8b65-f8a54ab66e56
      iscommand: false
      name: Check if the asset is Cloud Resource
      type: condition
      version: -1
    taskid: 44b58df9-1fd2-48cb-8b65-f8a54ab66e56
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5590
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "84"
    note: false
    quietmode: 0
    scriptarguments:
      asset_id:
        simple: ${incident.expanseasset.id}
      asset_type:
        simple: ${incident.expanseasset.assettype}
      tag_names:
        complex:
          root: ${XpanseAdditionalTagNames}
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
          - operator: toLowerCase
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assign tags to an Xpanse asset.
      id: f727cde3-8f9b-469d-83d4-941b223411c5
      iscommand: true
      name: Assign tags to issue's assets (not cloud)
      script: '|||expanse-assign-tags-to-asset'
      type: regular
      version: -1
    taskid: f727cde3-8f9b-469d-83d4-941b223411c5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5800
        }
      }
  "104":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.expanseasset.assettype}
          operator: isEqualString
          right:
            value:
              simple: Certificate
      label: Certificate
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "58"
      Certificate:
      - "105"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5d2479bb-4bca-44a3-862f-6b1a46ff7f48
      iscommand: false
      name: Check if resource type is Certificate
      type: condition
      version: -1
    taskid: 5d2479bb-4bca-44a3-862f-6b1a46ff7f48
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": -1140
        }
      }
  "105":
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    scriptarguments:
      md5_hash:
        simple: ${incident.expanseasset.assetkey}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve Xpanse certificates by MD5 hash or search parameters.
      id: 8b60919f-b071-49b4-83fc-3994aca3d282
      iscommand: true
      name: Fetch certificate details
      script: '|||expanse-get-certificate'
      type: regular
      version: -1
    taskid: 8b60919f-b071-49b4-83fc-3994aca3d282
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": -960
        }
      }
  "106":
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "113"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: XpanseValues_Certificate
      value:
        simple: '{"subject":"${Expanse.Certificate.certificate.subject}","sha256fingerprint":"${Expanse.Certificate.certificate.sha256Fingerprint}","issueTypeID":"${incident.alerttypeid}"}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f0533607-04aa-4c24-8a32-2aa99cafffe7
      iscommand: false
      name: Set "XpanseValues_Certificate"
      script: Set
      type: regular
      version: -1
    taskid: f0533607-04aa-4c24-8a32-2aa99cafffe7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": -780
        }
      }
  "108":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.expanseasset.assettype}
          operator: isEqualString
          right:
            value:
              simple: Certificate
      label: Certificate
    continueonerrortype: ""
    id: "108"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      Certificate:
      - "109"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 75430723-0c7c-4430-8a0b-a1a15072dfb3
      iscommand: false
      name: Check if resource type is Certificate
      type: condition
      version: -1
    taskid: 75430723-0c7c-4430-8a0b-a1a15072dfb3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1090,
          "y": 1440
        }
      }
  "109":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: |-
            Please take a look at these certificate values:
            ${XpanseValues_Certificate}

            Do you want to add them to the exclusion list "${inputs.ExclusionsList}"?
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Excluding Asset's Certificate values
      totalanswers: 0
    id: "109"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "110"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6e7a20f3-e0f3-48af-8ab8-64e59cb5f795
      iscommand: false
      name: Check if certificate should be excluded
      type: collection
      version: -1
    taskid: 6e7a20f3-e0f3-48af-8ab8-64e59cb5f795
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 650,
          "y": 1650
        }
      }
  "110":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Excluding Asset's Certificate values.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "110"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "112"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check analyst's answer - exclude certificate.
      id: 44addda2-bb6f-4187-8560-0fc96d0fdf7f
      iscommand: false
      name: Check Analyst's Answer - Exclude Certificate
      type: condition
      version: -1
    taskid: 44addda2-bb6f-4187-8560-0fc96d0fdf7f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 650,
          "y": 1850
        }
      }
  "112":
    continueonerrortype: ""
    id: "112"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      keyName:
        simple: Certificates
      listName:
        simple: ${inputs.ExclusionsList}
      value:
        simple: ${XpanseValues_Certificate}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in the key/value store backed by a Cortex XSOAR
        list.
      id: e60b4209-a90e-469d-832d-a78b9f2f6d03
      iscommand: false
      name: Add the new key to list
      script: AddKeyToList
      type: regular
      version: -1
    taskid: e60b4209-a90e-469d-832d-a78b9f2f6d03
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": 2030
        }
      }
  "113":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ParsedList.Certificates}
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: ${XpanseValues_Certificate}
      label: Certificate
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      Certificate:
      - "114"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if the certificate is excluded.
      id: eac03e3f-86ee-4a07-82da-030f60cad0c4
      iscommand: false
      name: Check if Certificate is excluded
      type: condition
      version: -1
    taskid: eac03e3f-86ee-4a07-82da-030f60cad0c4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": -330
        }
      }
  "114":
    continueonerrortype: ""
    id: "114"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "117"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 01420181-2705-467b-88b4-ea73eb5f93fe
      iscommand: false
      name: Certificate excluded in the list
      type: title
      version: -1
    taskid: 01420181-2705-467b-88b4-ea73eb5f93fe
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -410,
          "y": 170
        }
      }
  "115":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.expansedomain}
          operator: isNotEmpty
      label: Domain Exists
    continueonerrortype: ""
    id: "115"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      Domain Exists:
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bea06423-a8b7-4fc2-877f-973abb5a7097
      iscommand: false
      name: Check if domain exists
      type: condition
      version: -1
    taskid: bea06423-a8b7-4fc2-877f-973abb5a7097
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": -780
        }
      }
  "116":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ParsedList.Domains}
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: ${XpanseValues_Domain}
      label: Domain Excluded
    continueonerrortype: ""
    id: "116"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      Domain Excluded:
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if the combination of IP/Domain, Port, and IssueTypeID is
        excluded.
      id: cfc4a22e-13b2-49f8-8690-9843be26faa7
      iscommand: false
      name: Check if IP or Domain are excluded
      type: condition
      version: -1
    taskid: cfc4a22e-13b2-49f8-8690-9843be26faa7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 640,
          "y": -330
        }
      }
  "117":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.CloseWhenExcluded
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "117"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "120"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fdf7d013-b3eb-4970-852a-7be94ec5857c
      iscommand: false
      name: Close Automatically?
      type: condition
      version: -1
    taskid: fdf7d013-b3eb-4970-852a-7be94ec5857c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -410,
          "y": 340
        }
      }
  "118":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.CloseWhenExcluded
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "118"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "63"
      "yes":
      - "120"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0c00bc9a-1d07-40cd-87f5-1b8d96e77a14
      iscommand: false
      name: Close Automatically?
      type: condition
      version: -1
    taskid: 0c00bc9a-1d07-40cd-87f5-1b8d96e77a14
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 100,
          "y": 340
        }
      }
  "119":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.CloseWhenExcluded
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "119"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "120"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e96e1724-9ae6-460a-8df8-9313a0b82587
      iscommand: false
      name: Close Automatically?
      type: condition
      version: -1
    taskid: e96e1724-9ae6-460a-8df8-9313a0b82587
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1390
        }
      }
  "120":
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "122"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c97c171a-5b65-4b53-8025-3b7527742b35
      iscommand: false
      name: Close Incident
      type: title
      version: -1
    taskid: c97c171a-5b65-4b53-8025-3b7527742b35
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -410,
          "y": 2945
        }
      }
  "121":
    continueonerrortype: ""
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      closeNotes:
        simple: |-
          Incident closed after one of the following combinations was found as excluded in the "${inputs.ExclusionsList}" list:

          ${AssetValues_IP}

          ${AssetValues_Domain}
      closeReason:
        simple: ${Close Reason.Answers.0}
      id:
        simple: ${incident.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 5fde886b-5058-4f47-89e8-e82d2e8bee97
      iscommand: true
      name: Close incident (already excluded)
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 5fde886b-5058-4f47-89e8-e82d2e8bee97
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -350,
          "y": 4280
        }
      }
  "122":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.AutomaticTagValue
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "121"
      "yes":
      - "123"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6a34a419-442f-4d2d-8428-4778270c5b5f
      iscommand: false
      name: Tag as exluded?
      type: condition
      version: -1
    taskid: 6a34a419-442f-4d2d-8428-4778270c5b5f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -410,
          "y": 3270
        }
      }
  "123":
    continueonerrortype: ""
    id: "123"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "124"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Script to refresh tags and attribution reasons of assets inside Xpanse issue. The script should be used inside the Xpanse issue incident context.
      id: 830c899e-5a17-4118-8989-0fcbc76a8a87
      iscommand: false
      name: Refresh Issue Assets
      script: ExpanseRefreshIssueAssets
      type: regular
      version: -1
    taskid: 830c899e-5a17-4118-8989-0fcbc76a8a87
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -780,
          "y": 3470
        }
      }
  "124":
    continueonerrortype: ""
    id: "124"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "125"
    note: false
    quietmode: 0
    scriptarguments:
      name:
        complex:
          root: inputs.AutomaticTagValue
          transformers:
          - operator: toLowerCase
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Create a new tag in Xpanse.
      id: e9f2879a-a36d-482c-8f93-b9bab2174815
      iscommand: true
      name: Create Tags
      script: '|||expanse-create-tag'
      type: regular
      version: -1
    taskid: e9f2879a-a36d-482c-8f93-b9bab2174815
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -780,
          "y": 3670
        }
      }
  "125":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.expanseasset.assettype}
          operator: isEqualString
          right:
            value:
              simple: CloudResource
      label: "yes"
    continueonerrortype: ""
    id: "125"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "126"
      "yes":
      - "127"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c64cd42a-2551-4e9a-8d60-e6d93d833ccf
      iscommand: false
      name: Check if the asset is Cloud Resource
      type: condition
      version: -1
    taskid: c64cd42a-2551-4e9a-8d60-e6d93d833ccf
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -780,
          "y": 3850
        }
      }
  "126":
    continueonerrortype: ""
    id: "126"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    scriptarguments:
      asset_id:
        simple: ${incident.expanseasset.id}
      asset_type:
        simple: ${incident.expanseasset.assettype}
      tag_names:
        complex:
          root: inputs.AutomaticTagValue
          transformers:
          - operator: toLowerCase
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assign tags to an Xpanse asset.
      id: fd0dd16c-387e-4cc4-8d34-2675aa43adf2
      iscommand: true
      name: Assign tags to issue's assets (not cloud)
      script: '|||expanse-assign-tags-to-asset'
      type: regular
      version: -1
    taskid: fd0dd16c-387e-4cc4-8d34-2675aa43adf2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -570,
          "y": 4025
        }
      }
  "127":
    continueonerrortype: ""
    id: "127"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    scriptarguments:
      asset_id:
        simple: ${incident.expanseasset.assetkey}
      asset_type:
        simple: ${incident.expanseasset.assettype}
      tag_names:
        complex:
          root: inputs.AutomaticTagValue
          transformers:
          - operator: toLowerCase
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assign tags to an Xpanse asset.
      id: 2efd4a27-f99b-4ef4-848e-8b9379897381
      iscommand: true
      name: Assign tags to issue's assets (cloud)
      script: '|||expanse-assign-tags-to-asset'
      type: regular
      version: -1
    taskid: 2efd4a27-f99b-4ef4-848e-8b9379897381
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -990,
          "y": 4025
        }
      }
  "128":
    continueonerrortype: ""
    id: "128"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Script to refresh tags and attribution reasons of assets inside the Xpanse issue. The script should be used inside the Xpanse issue incident context.
      id: 702baf44-29b4-4d07-8d9f-d940ddf5b4a2
      iscommand: false
      name: Refresh Issue Assets
      script: ExpanseRefreshIssueAssets
      type: regular
      version: -1
    taskid: 702baf44-29b4-4d07-8d9f-d940ddf5b4a2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4230
        }
      }
  "129":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Close Reason and Note.Answers.1
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "129"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "130"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if comment is not empty.
      id: 35c0778f-0d7a-4c9f-84ea-e00c9960fb99
      iscommand: false
      name: Close note exist?
      type: condition
      version: -1
    taskid: 35c0778f-0d7a-4c9f-84ea-e00c9960fb99
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 730,
          "y": 6545
        }
      }
  "130":
    continueonerrortype: ""
    id: "130"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      issue_id:
        simple: ${incident.expanseissueid}
      update_type:
        simple: Comment
      value:
        simple: ${Close Reason and Note.Answers.1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ec3ed863-e897-4ee9-8e77-c455954bce8c
      iscommand: true
      name: Update Xpanse Comment
      script: '|||expanse-update-issue'
      type: regular
      version: -1
    taskid: ec3ed863-e897-4ee9-8e77-c455954bce8c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1070,
          "y": 6730
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "125_126_#default#": 0.73
    },
    "paper": {
      "dimensions": {
        "height": 9345,
        "width": 2970,
        "x": -990,
        "y": -2200
      }
    }
  }
