contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: cd88db09-7d3a-4efe-8dc8-d18dac3a9036
inputs:
- description: ""
  key: file
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: File
      root: ExtractedIndicators
- description: ""
  key: filesha1
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: filemd5
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-CERT Block Malicious Hash on CS v1.0_Kunal
outputs: []
sourceplaybookid: 9d6b9cb3-059d-4b12-865c-f73bed1daa8a
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 63b48607-cc28-4400-8dcc-17db79002f1d
      iscommand: false
      name: ""
      version: -1
    taskid: 63b48607-cc28-4400-8dcc-17db79002f1d
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": -730
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 96db5aa5-81bb-4b66-893a-66d9e1029c1a
      iscommand: false
      name: Set Indicator Tag
      type: title
      version: -1
    taskid: 96db5aa5-81bb-4b66-893a-66d9e1029c1a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1380
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "26"
      "yes":
      - "32"
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        simple: ${ExtractedIndicators.File_MD5}
      value:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Indicates whether a given value is a member of given array
      id: 843a711e-3ab6-4057-8226-d7327a359ae7
      iscommand: false
      name: Are there MD5 Hash Files ?
      script: IsValueInArray
      type: condition
      version: -1
    taskid: 843a711e-3ab6-4057-8226-d7327a359ae7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 200,
          "y": -90
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "26"
      "yes":
      - "30"
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        complex:
          accessor: File_SHA256
          root: ExtractedIndicators
      value:
        complex:
          root: inputs.file
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Indicates whether a given value is a member of given array
      id: 5cca3e81-c8d4-4189-8a8b-d550c39da159
      iscommand: false
      name: Are there SHA256 Hash Files ?
      script: IsValueInArray
      type: condition
      version: -1
    taskid: 5cca3e81-c8d4-4189-8a8b-d550c39da159
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 690,
          "y": -90
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      using:
        simple: Crowdstrike Falcon v2.0_instance_1
      value:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Crowdstrike Falcon v2.0
      description: Searches for the IDs of indicators
      id: bd2d51e4-11e0-44a8-8255-2df638713314
      iscommand: true
      name: Search For Hash In CS IOC Inventory
      script: Crowdstrike Falcon v2.0|||csfalcon-search-iocs
      type: regular
      version: -1
    taskid: bd2d51e4-11e0-44a8-8255-2df638713314
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 150
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: CrowdStrike
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.file
          operator: isEqualString
          right:
            iscontext: true
            value:
              complex:
                accessor: Value
                root: CrowdStrike.IOC
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "32"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2996e45a-189b-4683-86b6-853be0b570dc
      iscommand: false
      name: Is Hash Already Blocked ?
      type: condition
      version: -1
    taskid: 2996e45a-189b-4683-86b6-853be0b570dc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 200,
          "y": 340
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: CrowdStrike
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: c5b37427-c432-4489-82c8-0217ceef23d5
      iscommand: false
      name: Delete CS Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: c5b37427-c432-4489-82c8-0217ceef23d5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": -310
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      using:
        simple: Crowdstrike Falcon v2.0_instance_1
      value:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Crowdstrike Falcon v2.0
      description: Searches for the IDs of indicators
      id: b29fbbc7-8090-4b9e-8647-fa2311c0e45a
      iscommand: true
      name: Search For Hash In CS IOC Inventory
      script: Crowdstrike Falcon v2.0|||csfalcon-search-iocs
      type: regular
      version: -1
    taskid: b29fbbc7-8090-4b9e-8647-fa2311c0e45a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 150
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: CrowdStrike
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.file
          operator: isEqualString
          right:
            iscontext: true
            value:
              complex:
                accessor: Value
                root: CrowdStrike.IOC
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fba0490e-1376-4b4b-89cf-0794c633d445
      iscommand: false
      name: Is Hash Already Blocked ?
      type: condition
      version: -1
    taskid: fba0490e-1376-4b4b-89cf-0794c633d445
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 690,
          "y": 340
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "2"
      "yes":
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      id: f3266e82-facc-423f-8d5f-5380fd8721ba
      iscommand: false
      name: Did The Previous Task Encounter Error ?
      script: isError
      type: condition
      version: -1
    taskid: f3266e82-facc-423f-8d5f-5380fd8721ba
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 690,
          "y": 740
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Bocked.Hash
      value:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e285e297-2053-45f1-8482-4bbb215fbec2
      iscommand: false
      name: Set Error IOC in Context
      script: Set
      type: regular
      version: -1
    taskid: e285e297-2053-45f1-8482-4bbb215fbec2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 930
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "2"
      "yes":
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      id: a2bccaa6-80a5-424f-8f3e-e8d711553929
      iscommand: false
      name: Did The Previous Task Encounter Error ?
      script: isError
      type: condition
      version: -1
    taskid: a2bccaa6-80a5-424f-8f3e-e8d711553929
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 200,
          "y": 740
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Bocked.Hash
      value:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 824275c6-f504-4d1e-813b-bbbd089fe93d
      iscommand: false
      name: Set Error IOC in Context
      script: Set
      type: regular
      version: -1
    taskid: 824275c6-f504-4d1e-813b-bbbd089fe93d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 930
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: indicatorfile
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "19"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1c436961-1c2b-46e9-8381-1ad347078c7f
      iscommand: false
      name: Is Indicator Context Set ?
      type: condition
      version: -1
    taskid: 1c436961-1c2b-46e9-8381-1ad347078c7f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1540
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: indicatorfile
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 1bfeca80-68cb-428d-8f7d-f0f4b6ceceb5
      iscommand: false
      name: Delete 'Indicator' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 1bfeca80-68cb-428d-8f7d-f0f4b6ceceb5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1750
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicatorfile.value=value::indicatorfile.tag=CustomFields.tags
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.file
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 59620d8b-d1d0-46f5-8a71-f91030573c67
      iscommand: true
      name: Check If Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 59620d8b-d1d0-46f5-8a71-f91030573c67
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1980
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicatorfile
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e4422c1-8772-4c1f-8363-835f8098c376
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 1e4422c1-8772-4c1f-8363-835f8098c376
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2160
        }
      }
  "21":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicatorfile
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: certblockedhash
      label: "yes"
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4046814d-bfda-465f-881b-502db43a7051
      iscommand: false
      name: Is This Indicator CERT Tagged ?
      type: condition
      version: -1
    taskid: 4046814d-bfda-465f-881b-502db43a7051
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2390
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicatorfile
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 03d3f1cd-6c03-4b1a-854c-09daa518225c
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 03d3f1cd-6c03-4b1a-854c-09daa518225c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2670
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicatorfile.tag}
      indicatorsValues:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: dab5f25d-07f5-4ed1-89ff-9ce2da3e390d
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: dab5f25d-07f5-4ed1-89ff-9ce2da3e390d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2950
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: certblockedhash
      value:
        simple: ${inputs.file}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 780649be-caaa-45c2-8723-bbf9753279a4
      iscommand: true
      name: Add New CERT Tag
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 780649be-caaa-45c2-8723-bbf9753279a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 330,
          "y": 3335
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: certblockedhash
      type:
        simple: File
      value:
        simple: ${inputs.file}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 945e961f-092c-4657-8bd7-0a8157520e75
      iscommand: true
      name: Tag The Indicator With 'certblockedhash'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 945e961f-092c-4657-8bd7-0a8157520e75
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 10,
          "y": 3160
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d5ccc7c8-b7a3-4aca-8b24-4de5ed7dc8ab
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: d5ccc7c8-b7a3-4aca-8b24-4de5ed7dc8ab
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 950,
          "y": 3880
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: CrowdStrike
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0c419508-44fc-48d1-81f7-86399b0f4836
      iscommand: false
      name: Is CrowdStrike Context Defined ?
      type: condition
      version: -1
    taskid: 0c419508-44fc-48d1-81f7-86399b0f4836
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 0,
          "y": -500
        }
      }
  "28":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: CrowdStrike
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      - "5"
      "yes":
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cc21a777-6b37-4715-8a6f-df0d1c01b921
      iscommand: false
      name: Is Custom CrowdStrike Context defined?
      type: condition
      version: -1
    taskid: cc21a777-6b37-4715-8a6f-df0d1c01b921
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": -530
        }
      }
  "30":
    continueonerror: true
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        simple: prevent
      description:
        simple: XSOAR  - ${incident.labels.Email/Header/Subject}
      ioc_type:
        simple: sha256
      platforms:
        simple: windows
      severity:
        simple: high
      using:
        simple: Crowdstrike Falcon v2.0_PCI_BPS_instance,Crowdstrike Falcon v2.0_instance_1
      value:
        complex:
          root: inputs.file
    separatecontext: false
    skipunavailable: false
    task:
      brand: Crowdstrike Falcon v2.0
      description: Uploads an indicator for CrowdStrike to block and monitor.
      id: bce8a530-5a5f-44de-866e-3977d29d3455
      iscommand: true
      name: 'Add SHA256 File Hash For Blocking '
      script: Crowdstrike Falcon v2.0|||csfalcon-upload-ioc
      type: regular
      version: -1
    taskid: bce8a530-5a5f-44de-866e-3977d29d3455
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 570
        }
      }
  "32":
    continueonerror: true
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        simple: prevent
      description:
        simple: XSOAR  - ${incident.labels.Email/Header/Subject}
      ioc_type:
        simple: md5
      platforms:
        simple: windows
      severity:
        simple: high
      using:
        simple: Crowdstrike Falcon v2.0_PCI_BPS_instance,Crowdstrike Falcon v2.0_instance_1
      value:
        complex:
          root: inputs.file
    separatecontext: false
    skipunavailable: false
    task:
      brand: Crowdstrike Falcon v2.0
      description: Uploads an indicator for CrowdStrike to block and monitor.
      id: 14e3373e-336e-4f73-8fd5-da0759f579fb
      iscommand: true
      name: 'Add MD5 File Hash For Blocking '
      script: Crowdstrike Falcon v2.0|||csfalcon-upload-ioc
      type: regular
      version: -1
    taskid: 14e3373e-336e-4f73-8fd5-da0759f579fb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 570
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      hash_list:
        complex:
          root: inputs.file
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex XDR - IR
      description: Block lists requested files which have not already been block listed
        or added to allow lists.
      id: 3d331df0-562c-4ee7-89c4-e03dcec771fb
      iscommand: true
      name: Cortex XDR add a file SHA256 to block list
      script: Cortex XDR - IR|||xdr-blocklist-files
      type: regular
      version: -1
    taskid: 3d331df0-562c-4ee7-89c4-e03dcec771fb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1120,
          "y": -80
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: sampathchandra.1@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: pk.subbaiah@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: mathews.bruno@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 286efe12-ba96-452c-8686-9d9408355bab
      iscommand: false
      name: Check if email from  sampathchandra.1@tcs.com
      type: condition
      version: -1
    taskid: 286efe12-ba96-452c-8686-9d9408355bab
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -40,
          "y": 2720
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: sampathchandra.1@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: pk.subbaiah@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: mathews.bruno@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dc50b62c-e34e-4764-8377-90998902870b
      iscommand: false
      name: Check if email from  sampathchandra.1@tcs.com
      type: condition
      version: -1
    taskid: dc50b62c-e34e-4764-8377-90998902870b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3140
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: certblockedhash,DASA
      type:
        simple: IP
      value:
        simple: ${inputs.IP}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: ce045049-07da-4dae-8993-d5123c57d5d9
      iscommand: true
      name: Tag The Indicator With 'certblockedhash' 'DASA'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: ce045049-07da-4dae-8993-d5123c57d5d9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 3140
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: certblockedhash,DASA
      type:
        simple: File
      value:
        simple: ${inputs.file}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 5650a5b5-a3b7-47ae-8b29-42e54d2679a2
      iscommand: true
      name: Tag The Indicator With 'certblockedhash'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 5650a5b5-a3b7-47ae-8b29-42e54d2679a2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -450,
          "y": 3180
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: certblockedhash,DASA
      value:
        simple: ${inputs.file}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 7e06137b-2995-41f6-8985-2ec50f3c8a10
      iscommand: true
      name: Add New CERT Tag
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 7e06137b-2995-41f6-8985-2ec50f3c8a10
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 570,
          "y": 3530
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "13_14_yes": 0.5,
      "15_16_yes": 0.46,
      "8_2_yes": 0.18
    },
    "paper": {
      "dimensions": {
        "height": 4675,
        "width": 2050,
        "x": -450,
        "y": -730
      }
    }
  }
