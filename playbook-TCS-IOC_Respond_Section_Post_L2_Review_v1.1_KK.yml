contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: bccd9afc-973b-42d6-8ac9-b6ccfea6aae1
inputs: []
name: TCS-IOC Respond Section Post L2 Review v1.1_KK
outputs: []
sourceplaybookid: a1dbf5d6-aa8b-4c29-8860-cbc5c4677328
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "156"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 71ebadfb-cad2-4647-897e-a8f71a1bf50c
      iscommand: false
      name: ""
      version: -1
    taskid: 71ebadfb-cad2-4647-897e-a8f71a1bf50c
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 690,
          "y": 80
        }
      }
  "156":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ISOTimeNow
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "156"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "158"
      "yes":
      - "157"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 664638e9-d5b7-4a3f-8a54-f8b98e4e075f
      iscommand: false
      name: Is ISO Time Context Set?
      type: condition
      version: -1
    taskid: 664638e9-d5b7-4a3f-8a54-f8b98e4e075f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 690,
          "y": 280
        }
      }
  "157":
    continueonerrortype: ""
    id: "157"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "158"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ISOTimeNow
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 1866827d-c772-4cc8-8289-b7ec6fdbd294
      iscommand: false
      name: Delete Old Time Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 1866827d-c772-4cc8-8289-b7ec6fdbd294
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 510
        }
      }
  "158":
    continueonerrortype: ""
    id: "158"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "159"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: ISO
      dateFormat:
        simple: ISO
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: 89b28cce-b919-4619-8901-cc72ff033a11
      iscommand: false
      name: Set Current Date In Context
      script: GetTime
      type: regular
      version: -1
    taskid: 89b28cce-b919-4619-8901-cc72ff033a11
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 710
        }
      }
  "159":
    continueonerrortype: ""
    id: "159"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "162"
      - "160"
      - "166"
      - "170"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b3456623-83d9-4c48-8b89-a41c5ead6413
      iscommand: false
      name: TCS-Select IOC To Block v1_KK
      playbookId: 769b58c8-170a-499a-82e1-3d8942cfa39e
      type: playbook
      version: -1
    taskid: b3456623-83d9-4c48-8b89-a41c5ead6413
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 690,
          "y": 905
        }
      }
  "160":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "160"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "178"
      "yes":
      - "161"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c1914657-20f3-434f-883b-2d4ed1a98373
      iscommand: false
      name: Is There IP Address For Blocking?
      type: condition
      version: -1
    taskid: c1914657-20f3-434f-883b-2d4ed1a98373
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -40,
          "y": 1110
        }
      }
  "161":
    continueonerrortype: ""
    id: "161"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "188"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${ExtractedIndicators.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7951eacf-4a99-4690-8054-c25b91e7ad28
      iscommand: false
      name: TCS-Add New CSOC IP Indicator v1.0_Kunal
      playbookId: e653e5ab-6658-4f7a-806d-6a79d92d5d98
      type: playbook
      version: -1
    taskid: 7951eacf-4a99-4690-8054-c25b91e7ad28
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: playbook
    view: |-
      {
        "position": {
          "x": -40,
          "y": 1310
        }
      }
  "162":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "162"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "178"
      "yes":
      - "179"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 482f864a-f917-4845-8419-8e0b82cf745f
      iscommand: false
      name: Are There Domains For Blocking?
      type: condition
      version: -1
    taskid: 482f864a-f917-4845-8419-8e0b82cf745f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1100
        }
      }
  "163":
    continueonerror: true
    continueonerrortype: errorPath
    id: "163"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "197"
      '#none#':
      - "164"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                iscontext: true
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 15d35a80-3c69-4e4f-8ca8-154e6e71a643
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 15d35a80-3c69-4e4f-8ca8-154e6e71a643
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1630
        }
      }
  "164":
    continueonerrortype: ""
    id: "164"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "191"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                iscontext: true
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 96599ba1-4576-4176-80a9-0eff37198bc9
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 96599ba1-4576-4176-80a9-0eff37198bc9
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1780
        }
      }
  "165":
    continueonerrortype: ""
    id: "165"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: COSCBlockDomain
      type:
        simple: Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                iscontext: true
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 7f5d8fa8-6b11-4c52-8dcc-5fbde7755326
      iscommand: true
      name: Tag 'CSOC' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 7f5d8fa8-6b11-4c52-8dcc-5fbde7755326
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1240,
          "y": 2670
        }
      }
  "166":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "166"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "178"
      "yes":
      - "167"
      - "168"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 176a57d9-16b0-47fc-858f-00179fa5c954
      iscommand: false
      name: Is There URL For Blocking?
      type: condition
      version: -1
    taskid: 176a57d9-16b0-47fc-858f-00179fa5c954
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1580,
          "y": 1130
        }
      }
  "167":
    continueonerror: true
    continueonerrortype: errorPath
    id: "167"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "201"
      '#none#':
      - "178"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: f07de2ba-0074-4b67-885b-afa8e50f1ba4
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: f07de2ba-0074-4b67-885b-afa8e50f1ba4
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 1310
        }
      }
  "168":
    continueonerrortype: ""
    id: "168"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "192"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: dab68ce8-c1f4-42d0-8cfc-73c520039303
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: dab68ce8-c1f4-42d0-8cfc-73c520039303
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1310
        }
      }
  "169":
    continueonerrortype: ""
    id: "169"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: COSCBlockURL
      type:
        simple: URL
      value:
        simple: ${ExtractedIndicators.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: a97b7ab5-f8a7-432d-84ce-4c80e059707f
      iscommand: true
      name: Tag 'CSOC' Bad URL Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: a97b7ab5-f8a7-432d-84ce-4c80e059707f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1615
        }
      }
  "170":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: File
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "170"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "178"
      "yes":
      - "171"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 47ae3549-41c9-46fc-86b7-ee7a2ae49b87
      iscommand: false
      name: Is There Hash For Blocking ?
      type: condition
      version: -1
    taskid: 47ae3549-41c9-46fc-86b7-ee7a2ae49b87
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2280,
          "y": 1140
        }
      }
  "171":
    continueonerrortype: ""
    id: "171"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 5
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        complex:
          accessor: File
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b8e19f3d-ab9b-4a6a-8983-ed3cb830898b
      iscommand: false
      name: TCS-CSOC Block Malicious Hash on CS v1.0_Kunal
      playbookId: 9d6b9cb3-059d-4b12-865c-f73bed1daa8a
      type: playbook
      version: -1
    taskid: b8e19f3d-ab9b-4a6a-8983-ed3cb830898b
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: playbook
    view: |-
      {
        "position": {
          "x": 2280,
          "y": 1490
        }
      }
  "173":
    continueonerrortype: ""
    id: "173"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "177"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #ff00ff;">All
          IoC(s) Have Been Reviewed & Blocked</span><br /></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 448a32fc-adc2-4e22-870a-95b505d9390d
      iscommand: true
      name: Set Action Notification - All IoCs Blocked
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 448a32fc-adc2-4e22-870a-95b505d9390d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 620,
          "y": 2930
        }
      }
  "177":
    continueonerrortype: ""
    id: "177"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b4ef5e8e-82c2-486e-853a-0ab217dab885
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: b4ef5e8e-82c2-486e-853a-0ab217dab885
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 630,
          "y": 3300
        }
      }
  "178":
    continueonerrortype: ""
    id: "178"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "173"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f6dc9c66-16c6-44db-8639-5808ed301e96
      iscommand: false
      name: Notification
      type: title
      version: -1
    taskid: f6dc9c66-16c6-44db-8639-5808ed301e96
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 660,
          "y": 2840
        }
      }
  "179":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
          operator: isEqualString
          right:
            value:
              simple: EWS v2
      label: "yes"
    continueonerrortype: ""
    id: "179"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "181"
      "yes":
      - "180"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: befb267d-961b-4759-82e9-56b1a5121f5d
      iscommand: false
      name: Triggered From Email ?
      type: condition
      version: -1
    taskid: befb267d-961b-4759-82e9-56b1a5121f5d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 520,
          "y": 1270
        }
      }
  "180":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: email
      label: Email
    continueonerrortype: ""
    id: "180"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "163"
      Email:
      - "182"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b9cff54d-f4a7-4fe9-86f1-c4faa22c4289
      iscommand: false
      name: Does the subject line include 'Email'?
      type: condition
      version: -1
    taskid: b9cff54d-f4a7-4fe9-86f1-c4faa22c4289
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1440
        }
      }
  "181":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: email only
      label: Email Only
    continueonerrortype: ""
    id: "181"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "163"
      Email Only:
      - "182"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 80234335-b61b-4455-8e44-b7b0987ee1fd
      iscommand: false
      name: ' ''Block IOC On'' Email?'
      type: condition
      version: -1
    taskid: 80234335-b61b-4455-8e44-b7b0987ee1fd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 520,
          "y": 1450
        }
      }
  "182":
    continueonerrortype: ""
    id: "182"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: emailblock
      type:
        simple: Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                iscontext: true
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 48d04c4f-b737-415c-802a-e3cf8fc9a4e2
      iscommand: true
      name: Tag 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 48d04c4f-b737-415c-802a-e3cf8fc9a4e2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 360,
          "y": 2085
        }
      }
  "183":
    continueonerrortype: ""
    id: "183"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "184"
    note: false
    quietmode: 0
    scriptarguments:
      alert_time:
        complex:
          accessor: created
          root: incident
          transformers:
          - operator: 8726aa62-638b-41b0-8fd7-8d8892145289
          - args:
              delimiter:
                value:
                  simple: .
              fields:
                value:
                  simple: "1"
            operator: Cut
          - args:
              prefix: {}
              suffix:
                value:
                  simple: .0Z
            operator: concat
      destination_domain:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                iscontext: true
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      destination_url:
        simple: http://abc.com
      device_id:
        simple: abcdefghij
      device_version:
        simple: "1.0"
      using:
        simple: Cisco Umbrella Enforcement Block Domain_instance,Cisco Umbrella Enforcement
          Block Domain GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Enforcement Block Domain
      description: Posts a malware event to the API for processing and optionally
        adding to a customer's domain lists.
      id: d24c90af-b8dc-40d2-886c-558d6507a7d7
      iscommand: true
      name: Block Domain on Cisco Umbrella (opendns)
      script: Cisco Umbrella Enforcement Block Domain|||umbrella-domain-event-add
      type: regular
      version: -1
    taskid: d24c90af-b8dc-40d2-886c-558d6507a7d7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 940,
          "y": 2070
        }
      }
  "184":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
          operator: isEqualString
          right:
            value:
              simple: EWS v2
      label: "yes"
    continueonerrortype: ""
    id: "184"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "185"
      "yes":
      - "186"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dcefd793-f37a-4bb9-86e1-6601bd9f3b5b
      iscommand: false
      name: Triggered From Email ?
      type: condition
      version: -1
    taskid: dcefd793-f37a-4bb9-86e1-6601bd9f3b5b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 940,
          "y": 2210
        }
      }
  "185":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: internet only
      label: Internet Only
    continueonerrortype: ""
    id: "185"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "187"
      Internet Only:
      - "165"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2670e3d4-8166-4863-8f28-21d340d566b1
      iscommand: false
      name: ' ''Block IOC On'' Internet?'
      type: condition
      version: -1
    taskid: 2670e3d4-8166-4863-8f28-21d340d566b1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 830,
          "y": 2400
        }
      }
  "186":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: internet
      label: Internet
    continueonerrortype: ""
    id: "186"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "187"
      Internet:
      - "165"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 13a51f65-9a21-4030-8d47-a6135aeb8e39
      iscommand: false
      name: Does the subject line include 'Internet'?
      type: condition
      version: -1
    taskid: 13a51f65-9a21-4030-8d47-a6135aeb8e39
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1250,
          "y": 2410
        }
      }
  "187":
    continueonerrortype: ""
    id: "187"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: COSCBlockDomain,emailblock
      type:
        simple: Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                iscontext: true
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: e45e667e-1de0-47f2-858c-88fd95eeff48
      iscommand: true
      name: Tag 'CSOC' and 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: e45e667e-1de0-47f2-858c-88fd95eeff48
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 830,
          "y": 2670
        }
      }
  "188":
    continueonerror: true
    continueonerrortype: errorPath
    id: "188"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "193"
      '#none#':
      - "189"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_132
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 7048fc86-4dd5-4f44-819f-9c8d6a69206f
      iscommand: true
      name: 'Block IP on Zscaler Corporate '
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 7048fc86-4dd5-4f44-819f-9c8d6a69206f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": 1520
        }
      }
  "189":
    continueonerrortype: ""
    id: "189"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "190"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_241
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 11bb8382-916d-48c0-8141-76395421bb76
      iscommand: true
      name: Block IP on Zscaler BPS
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 11bb8382-916d-48c0-8141-76395421bb76
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": 1695
        }
      }
  "190":
    continueonerrortype: ""
    id: "190"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_57
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: b85adacd-4f5b-46e8-806e-f51f6f5d015d
      iscommand: true
      name: Block IP on Zscaler GNDM
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: b85adacd-4f5b-46e8-806e-f51f6f5d015d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": 1875
        }
      }
  "191":
    continueonerrortype: ""
    id: "191"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "183"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                iscontext: true
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 28ab9124-b25f-4617-841d-c86a97a4d08a
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 28ab9124-b25f-4617-841d-c86a97a4d08a
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1930
        }
      }
  "192":
    continueonerrortype: ""
    id: "192"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "169"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 3973e242-4261-4e56-85ba-b7baaf5f9402
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 3973e242-4261-4e56-85ba-b7baaf5f9402
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1460
        }
      }
  "193":
    continueonerrortype: ""
    id: "193"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "195"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          accessor: IP
          root: ExtractedIndicators
      listName:
        simple: Zscaler_Corp
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: 388e4718-a3e7-4dde-8f48-8b1e5c1c25bb
      iscommand: true
      name: List o f IP
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: 388e4718-a3e7-4dde-8f48-8b1e5c1c25bb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -540,
          "y": 1650
        }
      }
  "194":
    continueonerrortype: ""
    id: "194"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_57
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 3a3a894b-8df5-4901-8c54-a66169220f38
      iscommand: true
      name: Block IP on Zscaler GNDM
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 3a3a894b-8df5-4901-8c54-a66169220f38
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": 1875
        }
      }
  "195":
    continueonerrortype: ""
    id: "195"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "196"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_241
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: d94025fd-d0cc-42cb-818e-4706e159c67e
      iscommand: true
      name: Block IP on Zscaler BPS
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: d94025fd-d0cc-42cb-818e-4706e159c67e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -540,
          "y": 1820
        }
      }
  "196":
    continueonerrortype: ""
    id: "196"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_57
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 46af03a4-e9bd-424b-883a-2eb09fe0b714
      iscommand: true
      name: Block IP on Zscaler GNDM
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 46af03a4-e9bd-424b-883a-2eb09fe0b714
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -540,
          "y": 1990
        }
      }
  "197":
    continueonerrortype: ""
    id: "197"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "200"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      listName:
        simple: Zscaler_Corp
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: d42b7af3-5bea-4b96-8ad4-6670f6d3ebd7
      iscommand: true
      name: List of Domain
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: d42b7af3-5bea-4b96-8ad4-6670f6d3ebd7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 1710
        }
      }
  "199":
    continueonerrortype: ""
    id: "199"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "183"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                iscontext: true
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: cd11ecd2-1669-4f4f-8137-308bd42d8720
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: cd11ecd2-1669-4f4f-8137-308bd42d8720
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 2055
        }
      }
  "200":
    continueonerrortype: ""
    id: "200"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "199"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                iscontext: true
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: c309870a-1445-4a4e-81b8-3e0a768db60f
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: c309870a-1445-4a4e-81b8-3e0a768db60f
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 1875
        }
      }
  "201":
    continueonerrortype: ""
    id: "201"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          accessor: URL
          root: ExtractedIndicators
      listName:
        simple: Zscaler_Corp
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: 789e4e78-6ab1-4b39-8c2f-101ad3aa7590
      iscommand: true
      name: List of URL
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: 789e4e78-6ab1-4b39-8c2f-101ad3aa7590
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 1650
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "179_181_#default#": 0.53,
      "180_163_#default#": 0.45,
      "181_182_Email Only": 0.64,
      "186_165_Internet": 0.54
    },
    "paper": {
      "dimensions": {
        "height": 3285,
        "width": 3200,
        "x": -540,
        "y": 80
      }
    }
  }
