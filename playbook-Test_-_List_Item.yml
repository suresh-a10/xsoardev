contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: b0b668f3-ecaa-4a46-80e8-d5cafa3d6ab5
inputs:
- description: ""
  key: AverageAlertListItem
  playbookInputQuery: null
  required: false
  value: {}
name: Test - List Item
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: efacbfca-a8aa-49fe-8ce7-e454808dc52f
      iscommand: false
      name: ""
      version: -1
    taskid: efacbfca-a8aa-49fe-8ce7-e454808dc52f
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 440,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      fromdate:
        simple: 24 hours ago
      query:
        simple: type:${inputs.AverageAlertListItem.type}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Searches Demisto incidents. A summarized version of this scrips is avilable with the summarizedversion argument.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 936a9d8a-29b9-41a4-8867-ce0d164f485a
      iscommand: false
      name: Search Incident
      script: SearchIncidentsV2
      type: regular
      version: -1
    taskid: 936a9d8a-29b9-41a4-8867-ce0d164f485a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": 190
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: FoundIncidentTypeCount
      value:
        complex:
          accessor: id
          root: foundIncidents
          transformers:
          - operator: count
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c2eada87-91d3-4b90-84aa-da965d738003
      iscommand: false
      name: Get Count of Found Incident
      script: Set
      type: regular
      version: -1
    taskid: c2eada87-91d3-4b90-84aa-da965d738003
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": 400
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TriggeredIncidentPercentage
      value:
        complex:
          root: ${FoundIncidentTypeCount}
          transformers:
          - args:
              by:
                iscontext: true
                value:
                  simple: inputs.AverageAlertListItem.count
            operator: division
          - args:
              by:
                value:
                  simple: "100"
            operator: multiply
          - operator: ceil
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6427e30d-1099-4dfd-8e78-1b5a1e19547a
      iscommand: false
      name: Calculate Percentage
      script: Set
      type: regular
      version: -1
    taskid: 6427e30d-1099-4dfd-8e78-1b5a1e19547a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": 600
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: foundIncidents
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 06fae7fe-a92e-4d94-8282-60fa7df3a1f1
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 06fae7fe-a92e-4d94-8282-60fa7df3a1f1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": 1330
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${TriggeredIncidentPercentage}
          operator: lessThanOrEqual
          right:
            value:
              simple: "60"
      label: < 10%
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      < 10%:
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bfb1925e-9eaa-47a5-874e-314c453cda44
      iscommand: false
      name: Check the incident trigger  <10%
      type: condition
      version: -1
    taskid: bfb1925e-9eaa-47a5-874e-314c453cda44
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 440,
          "y": 770
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: LessTriggeredIncidentType
      value:
        simple: '[{"${inputs.AverageAlertListItem.type}":"${TriggeredIncidentPercentage}%"}]'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 0ea095a1-9011-4f6b-8080-43c15cb2d390
      iscommand: false
      name: Incident Types < 10%
      script: Set
      type: regular
      version: -1
    taskid: 0ea095a1-9011-4f6b-8080-43c15cb2d390
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 30,
          "y": 1060
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: TriggeredIncidentType
      value:
        complex:
          root: inputs.AverageAlertListItem
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1617f3dd-4a37-4fb9-8a01-85e85f7bf376
      iscommand: false
      name: Incident Types > 10%
      script: Set
      type: regular
      version: -1
    taskid: 1617f3dd-4a37-4fb9-8a01-85e85f7bf376
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 840,
          "y": 1060
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1375,
        "width": 1190,
        "x": 30,
        "y": 50
      }
    }
  }
