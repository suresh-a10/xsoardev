contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.2.0
    itemVersion: 4.11.4
    packID: ""
    packName: Cortex XDR by Palo Alto Networks
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: This playbook unisolates endpoints according to the endpoint ID that
  is provided in the playbook input.
id: 7bee3d42-1aa7-4797-806a-918bc217f47b
inputs:
- description: The endpoint ID that you want to be unisolated.
  key: Endpoint_ID
  playbookInputQuery: null
  required: false
  value: {}
- description: The endpoint's hostname that you want to be unisolated.
  key: Hostname
  playbookInputQuery: null
  required: false
  value: {}
- description: The endpoint's IP that you want to be unisolated.
  key: IP
  playbookInputQuery: null
  required: false
  value: {}
name: 'TCS-Cortex XDR - Unisolate Endpoint '
outputs: []
sourceplaybookid: Cortex XDR - Unisolate Endpoint
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5d94c136-6023-4c56-8f41-9c01aa21c851
      iscommand: false
      name: ""
      version: -1
    taskid: 5d94c136-6023-4c56-8f41-9c01aa21c851
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1470,
          "y": -250
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: rawType
                root: incident
          operator: isEqualString
          right:
            value:
              simple: Cortex XDR - IR_Incident
      label: XDR
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      XDR:
      - "9"
      "no":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'.
      id: b555627c-fbf5-40a2-8c8a-a1cb56235998
      iscommand: false
      name: Check If Alert Triggered From XDR
      type: condition
      version: -1
    taskid: b555627c-fbf5-40a2-8c8a-a1cb56235998
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1470,
          "y": -110
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsIsolated
                root: Endpoint
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsIsolated
                root: Endpoint
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "Yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "Yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Is there an endpoint to unisolate?
      id: b32d0a3c-502f-448d-8f40-5306ea4e2d99
      iscommand: false
      name: Is there an endpoint to unisolate?
      type: condition
      version: -1
    taskid: b32d0a3c-502f-448d-8f40-5306ea4e2d99
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1470,
          "y": 580
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 062b8818-2743-4237-883b-94dd2240e5b7
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 062b8818-2743-4237-883b-94dd2240e5b7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1450,
          "y": 1200
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      endpoint_id:
        simple: ${incident.deviceid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Reverses the isolation of an endpoint.
      id: 622280cc-1f45-43e9-8d00-1f06abeac90d
      iscommand: true
      name: Unisolate endpoint
      script: '|||xdr-endpoint-unisolate'
      type: regular
      version: -1
    taskid: 622280cc-1f45-43e9-8d00-1f06abeac90d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1450,
          "y": 945
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: The Host is Currently Contained. Would You Like To Remove Host From
          Containment ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "5"
      "Yes":
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      id: 4fe8bef7-5527-479f-8d03-e45a2773bd3c
      iscommand: false
      name: The Host is Currently Contained. Would You Like To Remove Host From Containment
        ?
      type: condition
      version: -1
    taskid: 4fe8bef7-5527-479f-8d03-e45a2773bd3c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1460,
          "y": 760
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      id:
        complex:
          accessor: deviceid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex XDR - IR
      description: Returns information about an endpoint.
      id: bd94d209-c747-4ead-8b3d-3de9ecd9c2b3
      iscommand: true
      name: Re-Fetch Endpoint Details
      script: Cortex XDR - IR|||endpoint
      type: regular
      version: -1
    taskid: bd94d209-c747-4ead-8b3d-3de9ecd9c2b3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1470,
          "y": 410
        }
      }
  "9":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Endpoint
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6b1e0121-a412-47f6-8564-5005b3c765c8
      iscommand: false
      name: Is Context 'Endpoint' Defined ?
      type: condition
      version: -1
    taskid: 6b1e0121-a412-47f6-8564-5005b3c765c8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1470,
          "y": 90
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Endpoint
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 84766b9d-9386-4252-8fe8-5e44b402aea6
      iscommand: false
      name: Delete Context 'Endpoint'
      script: DeleteContext
      type: regular
      version: -1
    taskid: 84766b9d-9386-4252-8fe8-5e44b402aea6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1470,
          "y": 250
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "3_5_no": 0.81
    },
    "paper": {
      "dimensions": {
        "height": 1515,
        "width": 400,
        "x": 1450,
        "y": -250
      }
    }
  }
