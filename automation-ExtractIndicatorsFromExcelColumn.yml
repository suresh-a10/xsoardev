args:
- name: entryID
- description: 'Specify which column to extract indicators from. Eg: A,B,C'
  name: column
comment: Extracts indicators only from specific columns within an excel with single
  sheet
commonfields:
  id: 70947ac9-0b08-4a10-8af4-e41a568e1e80
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: localhost/demisto/custompandas:latest
enabled: true
engineinfo: {}
mainengineinfo: {}
name: ExtractIndicatorsFromExcelColumn
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  import pandas as pd



  args=demisto.args()

  entryID=args.get("entryID")
  column=args.get("column")

  file_info = demisto.getFilePath(entryID)
  file_path = file_info['path']


  #import column E from Excel file
  df = pd.read_excel(file_path, usecols=column)
  products_list = df.values.tolist()

  # print(type(products_list))
  # demisto.setContext('ColumnData',products_list)
  demisto.results(demisto.executeCommand('extractIndicators',{'text':str(products_list)}))
scripttarget: 0
subtype: python3
tags: []
type: python
