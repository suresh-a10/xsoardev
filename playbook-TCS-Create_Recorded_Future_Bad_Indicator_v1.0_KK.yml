contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 1dd9f283-9c96-43ab-88a8-050da6467abc
inputs: []
name: TCS-Create Recorded Future Bad Indicator v1.0_KK
outputs: []
quiet: true
sourceplaybookid: 3a37bf98-d8e9-4ab9-8889-dba63691e69c
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fc6c46dc-4cf8-4de2-895f-68d081f1b310
      iscommand: false
      name: ""
      version: -1
    taskid: fc6c46dc-4cf8-4de2-895f-68d081f1b310
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -300,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "36000000"
      retry-count:
        simple: "3"
      retry-interval:
        simple: "20"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets the IP risk list as a CSV file from Recorded Future.
      id: 228678b9-3012-4049-8ac1-adaf31a58976
      iscommand: true
      name: Fetch recorded future IP risk list via Integration
      script: Recorded Future v2.1|||recorded-future-get-ip-risklist
      type: regular
      version: -1
    taskid: 228678b9-3012-4049-8ac1-adaf31a58976
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 380
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: ip_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: ip
      threshold:
        simple: "80"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e5f07b44-0124-45cf-874a-55aac47912c4
      iscommand: false
      name: Retrieve IPs with reputation >=80 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: e5f07b44-0124-45cf-874a-55aac47912c4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 555
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_ip.csv
          root: File
      extend-context:
        simple: extractedIPList=FileData
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: d37cc608-30b3-466c-816e-c800716d7520
      iscommand: false
      name: Read extracted list (only IP Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: d37cc608-30b3-466c-816e-c800716d7520
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 900
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a85dfb95-8939-41c9-8a02-700d7105384a
      iscommand: false
      name: Download Recorded Future IP List and Save to Demisto Lists
      type: title
      version: -1
    taskid: a85dfb95-8939-41c9-8a02-700d7105384a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -300,
          "y": 215
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 59d9bda5-c113-48fb-8ddd-7a53ee6bea43
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 59d9bda5-c113-48fb-8ddd-7a53ee6bea43
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3050
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
      listName:
        simple: RecordedFutureIPRiskList
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: e2b7f17c-86c8-42ea-8646-91130c5434f7
      iscommand: true
      name: Overwrite Recorded Future IPRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: e2b7f17c-86c8-42ea-8646-91130c5434f7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1070
        }
      }
  "49":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: "Yes"
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "Yes":
      - "21"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b369e11e-77ce-4f87-82bd-ba964eeb908d
      iscommand: false
      name: Are there any IP's with replutation >=80?
      type: condition
      version: -1
    taskid: b369e11e-77ce-4f87-82bd-ba964eeb908d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -300,
          "y": 720
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      execution-timeout:
        simple: "10000000"
      tags:
        simple: rfipblocked80
      type:
        simple: IP
      value:
        complex:
          accessor: RightOnly
          root: ListCompare
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: ef763d1b-ad68-4c85-8219-3c55e576153d
      iscommand: true
      name: Create New Indicator With Tag 'rfipblocked80'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: ef763d1b-ad68-4c85-8219-3c55e576153d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 540,
          "y": 2705
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "43200"
      extend-context:
        simple: indicator.ip=value
      ignore-outputs:
        simple: "true"
      query:
        simple: tags:rfipblocked80  and expirationStatus:active
      retry-count:
        simple: "3"
      size:
        simple: "100000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 54cbe198-5ad4-441e-82dd-8386796428db
      iscommand: true
      name: Fetch Indicators With Tag 'rfipblocked80'
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 54cbe198-5ad4-441e-82dd-8386796428db
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1440
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${TaggedIndicator}
      right:
        simple: ${RFSCORE80}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 5a47c272-d47a-44ec-8ec2-d20d290f2d2e
      iscommand: false
      name: Compare Context 'Extracted Indicator' and 'Indicator.Ip'
      script: CompareLists
      type: regular
      version: -1
    taskid: 5a47c272-d47a-44ec-8ec2-d20d290f2d2e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1780
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RFSCORE80
      value:
        complex:
          root: FileData
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3dbefc24-1193-4008-8561-05c9372fdf64
      iscommand: false
      name: Set IP Risk List Into Context
      script: Set
      type: regular
      version: -1
    taskid: 3dbefc24-1193-4008-8561-05c9372fdf64
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1265
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TaggedIndicator
      value:
        complex:
          accessor: ip
          root: indicator
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 46428c54-7416-489e-8119-8102a6611545
      iscommand: false
      name: Set Tagged Indictor In Context
      script: Set
      type: regular
      version: -1
    taskid: 46428c54-7416-489e-8119-8102a6611545
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1605
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 2
    scriptarguments:
      execution-timeout:
        simple: "100000"
      indicatorsValues:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: 2dec6ecf-409b-4c82-813a-65d7b4177e92
      iscommand: true
      name: Expire Indicator With Tag 'rfipblocked80' With Threshold < 80
      script: Builtin|||expireIndicators
      type: regular
      version: -1
    taskid: 2dec6ecf-409b-4c82-813a-65d7b4177e92
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 2
    scriptarguments:
      doNotWhitelist:
        simple: "true"
      execution-timeout:
        simple: "1000000"
      query:
        simple: expirationStatus:expired and tags:rfipblocked80
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.delete.indicators
      id: e4e3cef8-49ff-4ec3-803a-77d5f61a2b5a
      iscommand: true
      name: Delete Expired Indicators
      script: Builtin|||deleteIndicators
      type: regular
      version: -1
    taskid: e4e3cef8-49ff-4ec3-803a-77d5f61a2b5a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 83785d7e-3c32-4244-82e4-87fed77adb31
      iscommand: true
      name: Close Automation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 83785d7e-3c32-4244-82e4-87fed77adb31
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3215
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 91acecde-8414-4c25-8984-527c57d0273e
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 91acecde-8414-4c25-8984-527c57d0273e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3410
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ListCompare.RightOnly
              operator: isNotEmpty
          root: ListCompare.RightOnly
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3b66924b-8bb7-44ae-89fc-f437a3150f69
      iscommand: false
      name: TCS-Add New RF80 Indicator v1.0_Kunal
      playbookId: a69ebb8f-5c40-468e-822c-d117da401d5c
      type: playbook
      version: -1
    taskid: 3b66924b-8bb7-44ae-89fc-f437a3150f69
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2705
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: RightOnly
                root: ListCompare
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: RightOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "64"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cb380bf2-1190-479e-8a06-0ef0d36adf8a
      iscommand: false
      name: Is  There A New Indicator ?
      type: condition
      version: -1
    taskid: cb380bf2-1190-479e-8a06-0ef0d36adf8a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": 2490
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "65"
      "yes":
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 76573e84-6de9-436b-8824-1a15615a873c
      iscommand: false
      name: Is  There An Indicator To Expire ?
      type: condition
      version: -1
    taskid: 76573e84-6de9-436b-8824-1a15615a873c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1935
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "49_21_Yes": 0.51,
      "49_24_#default#": 0.1
    },
    "paper": {
      "dimensions": {
        "height": 3425,
        "width": 1220,
        "x": -300,
        "y": 50
      }
    }
  }
