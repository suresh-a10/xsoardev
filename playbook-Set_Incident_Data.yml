contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 99767e53-0ad7-472f-81d5-9e569b157a28
inputs:
- description: ""
  key: Data
  playbookInputQuery: null
  required: false
  value:
    simple: ${ParseExcel.[0]}
name: Set Incident Data
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9cfba8bc-97be-4f4c-8676-b5653b055a47
      iscommand: false
      name: ""
      version: -1
    taskid: 9cfba8bc-97be-4f4c-8676-b5653b055a47
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 20
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      query:
        simple: violationid:${inputs.Data.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Searches Demisto incidents. A summarized version of this scrips is avilable with the summarizedversion argument.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 7a03bbc2-f3b0-46b8-8333-5e152191461c
      iscommand: false
      name: search incident with violation id
      script: SearchIncidentsV2
      type: regular
      version: -1
    taskid: 7a03bbc2-f3b0-46b8-8333-5e152191461c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 190
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      acknowleged:
        complex:
          accessor: Acknowleged}
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ${inputs.Data.ID}
              operator: isEqualString
              right:
                value:
                  simple: ${foundIncidents.CustomFields.violationid}
          root: ${inputs.Data
      closurecategory:
        complex:
          accessor: Closure Category
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.Data.ID
              operator: isEqualString
              right:
                iscontext: true
                value:
                  simple: ${foundIncidents.CustomFields.violationid}
          root: inputs.Data
      closurenotes:
        complex:
          accessor: Closure Notes}
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ${inputs.Data.ID}
              operator: isEqualString
              right:
                value:
                  simple: ${foundIncidents.CustomFields.violationid}
          root: ${inputs.Data
      id:
        simple: ${foundIncidents.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 3e90307a-a0c4-4595-8c7a-ba7f1e124402
      iscommand: true
      name: update the incident
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 3e90307a-a0c4-4595-8c7a-ba7f1e124402
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 390
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      id:
        simple: ${foundIncidents.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: ad709c70-8376-48c5-8053-0b302abc7270
      iscommand: true
      name: Close investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: ad709c70-8376-48c5-8053-0b302abc7270
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 610
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: foundIncidents
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 35c52ddf-365b-4787-8743-f1c0405ce73d
      iscommand: false
      name: Delete Context Key FoundIncidents
      script: DeleteContext
      type: regular
      version: -1
    taskid: 35c52ddf-365b-4787-8743-f1c0405ce73d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 810
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 885,
        "width": 380,
        "x": 450,
        "y": 20
      }
    }
  }
