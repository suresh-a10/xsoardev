contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.5.0
    itemVersion: 1.1.19
    packID: Azure-Enrichment-Remediation
    packName: Azure Enrichment and Remediation
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: "This playbook provides response actions to Azure. The following are
  available for execution automatically/manually:\n- Resource remediation    \n   -
  Delete the instance\n   - Power off the instance\n- Identity remediation:\n   -
  Disable the user\n   - Delete the user\n- Block indicators."
id: Cloud Response - Azure
inputs:
- description: |-
    Choose the remediation type for the instances created.
    Poweroff - for shutting down the instances.
    Delete - for deleting the instances.
  key: resourceRemediationType
  playbookInputQuery: null
  required: false
  value:
    simple: Poweroff
- description: |-
    Choose the remediation type for the user involved.
    Disable - for disabling the user.
    Delete - for deleting the user.
  key: userRemediationType
  playbookInputQuery: null
  required: false
  value:
    simple: Disable
- description: Whether to execute the resource remediation flow automatically.
  key: autoResourceRemediation
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Whether to execute the user remediation flow automatically.
  key: autoUserRemediation
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Whether to block the indicators automatically.
  key: autoBlockIndicators
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: The resource name to take action on.
  key: resourceName
  playbookInputQuery: null
  required: false
  value: {}
- description: The resource group.
  key: resourceGroup
  playbookInputQuery: null
  required: false
  value: {}
- description: The username to take action on.
  key: username
  playbookInputQuery: null
  required: false
  value: {}
- description: The source IP address of the attacker.
  key: sourceIP
  playbookInputQuery: null
  required: false
  value: {}
name: Cloud Response - Azure
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
      - "1"
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cf64eba4-df4f-44d1-84c4-65c9ef85b786
      iscommand: false
      name: ""
      version: -1
    taskid: cf64eba4-df4f-44d1-84c4-65c9ef85b786
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 720,
          "y": 370
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4e285d3b-924b-48ab-8bb3-b1092e74a8a5
      iscommand: false
      name: Resource
      type: title
      version: -1
    taskid: 4e285d3b-924b-48ab-8bb3-b1092e74a8a5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2320,
          "y": 560
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: daead8d0-6cad-4acb-811a-c5eeb75fda74
      iscommand: false
      name: Block Indicators
      type: title
      version: -1
    taskid: daead8d0-6cad-4acb-811a-c5eeb75fda74
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -580,
          "y": 560
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3e349c03-2c6a-4283-8a64-50a326832bc6
      iscommand: false
      name: Identity
      type: title
      version: -1
    taskid: 3e349c03-2c6a-4283-8a64-50a326832bc6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 720,
          "y": 560
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.username
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is a user available for remediation.
      id: f546ed79-907b-4d94-8b18-6e50758f91b5
      iscommand: false
      name: Is there a user to remediate?
      type: condition
      version: -1
    taskid: f546ed79-907b-4d94-8b18-6e50758f91b5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 720,
          "y": 690
        }
      }
  "18":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.autoUserRemediation
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "35"
      "yes":
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the user chose automatic remediation.
      id: 56ed6fec-a5d3-4d05-86cc-c818cc4f0b2b
      iscommand: false
      name: Should remediate automatically?
      type: condition
      version: -1
    taskid: 56ed6fec-a5d3-4d05-86cc-c818cc4f0b2b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 720,
          "y": 900
        }
      }
  "19":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.userRemediationType
          operator: isEqualString
          right:
            value:
              simple: Delete
      label: Disable
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.userRemediationType
          operator: isEqualString
          right:
            value:
              simple: Delete
      label: Delete
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      Delete:
      - "21"
      Disable:
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks for the user's chosen remediation type.
      id: 21448ec3-2a33-4939-856d-a7d9d82741be
      iscommand: false
      name: Continue by remediation type
      type: condition
      version: -1
    taskid: 21448ec3-2a33-4939-856d-a7d9d82741be
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 720,
          "y": 1590
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      user:
        complex:
          accessor: "0"
          root: Manual user remediation.Answers
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.username
            operator: SetIfEmpty
          - operator: uniq
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: |-
        Disables a user from all Office 365 applications, and prevents sign in. Note: This command disables user,
        but does not terminate an existing session. Supported only in a self-deployed app flow with the
        permission: Directory.AccessAsUser.All(Delegated)
      id: a8a8963e-1359-4cf1-8280-322e15dfa9ac
      iscommand: true
      name: Disable the user
      script: '|||msgraph-user-account-disable'
      type: regular
      version: -1
    taskid: a8a8963e-1359-4cf1-8280-322e15dfa9ac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 1780
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      user:
        complex:
          accessor: "0"
          root: Manual user remediation.Answers
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.username
            operator: SetIfEmpty
          - operator: uniq
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: |-
        Deletes an existing user.
        Permissions: - Directory.AccessAsUser.All (Delegated) - User.ReadWrite.All (Application)
      id: 58e2591a-f8b7-48d6-8d0b-db9fa18a66be
      iscommand: true
      name: Delete the user
      script: '|||msgraph-user-delete'
      type: regular
      version: -1
    taskid: 58e2591a-f8b7-48d6-8d0b-db9fa18a66be
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 720,
          "y": 1780
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      id: 710a1688-0775-418f-8cf2-3ff25fce9336
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 710a1688-0775-418f-8cf2-3ff25fce9336
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 90,
          "y": 1960
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.resourceName
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is a resource available for remediation.
      id: 7936cb23-e5c7-4ecc-8ff4-ecbf03c27168
      iscommand: false
      name: Is there a resource to remediate?
      type: condition
      version: -1
    taskid: 7936cb23-e5c7-4ecc-8ff4-ecbf03c27168
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2320,
          "y": 680
        }
      }
  "25":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.autoResourceRemediation
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "45"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the user chose automatic remediation.
      id: c7795fd9-04ba-437a-82b4-563879b29175
      iscommand: false
      name: Should remediate automatically?
      type: condition
      version: -1
    taskid: c7795fd9-04ba-437a-82b4-563879b29175
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2320,
          "y": 870
        }
      }
  "26":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.resourceRemediationType
          operator: isEqualString
          right:
            value:
              simple: PowerOff
      label: Power Off
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.resourceRemediationType
          operator: isEqualString
          right:
            value:
              simple: Delete
      label: Delete
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "30"
      Delete:
      - "28"
      Power Off:
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks for the user's chosen remediation type.
      id: 844d96a3-eb31-4573-8078-1819e465876a
      iscommand: false
      name: Continue by remediation type
      type: condition
      version: -1
    taskid: 844d96a3-eb31-4573-8078-1819e465876a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2320,
          "y": 1590
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      resource_group:
        complex:
          accessor: referenced_resource
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: alertJson._all_events.referenced_resource_name
              operator: containsGeneral
              right:
                iscontext: true
                value:
                  simple: Manual resource remediation.Answers.0
          root: alertJson._all_events
          transformers:
          - args:
              delimiter:
                value:
                  simple: /
              fields:
                value:
                  simple: "5"
            operator: Cut
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.resourceGroup
            operator: SetIfEmpty
      virtual_machine_name:
        complex:
          root: remediateResourceList
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Powers off a given virtual machine.
      id: 80b31792-bb09-4c63-8f4b-7233c3a5a166
      iscommand: true
      name: Poweroff the instance
      script: '|||azure-vm-poweroff-instance'
      type: regular
      version: -1
    taskid: 80b31792-bb09-4c63-8f4b-7233c3a5a166
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2320,
          "y": 1780
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      resource_group:
        complex:
          accessor: referenced_resource
          filters:
          - - left:
                iscontext: true
                value:
                  simple: alertJson._all_events.referenced_resource_name
              operator: containsGeneral
              right:
                iscontext: true
                value:
                  simple: Manual resource remediation.Answers.0
          root: alertJson._all_events
          transformers:
          - args:
              delimiter:
                value:
                  simple: /
              fields:
                value:
                  simple: "5"
            operator: Cut
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.resourceGroup
            operator: SetIfEmpty
      virtual_machine_name:
        complex:
          root: remediateResourceList
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Deletes a specified virtual machine.
      id: 808f8e76-79cb-4a46-8a6b-0bc114398729
      iscommand: true
      name: Delete the instance
      script: '|||azure-vm-delete-instance'
      type: regular
      version: -1
    taskid: 808f8e76-79cb-4a46-8a6b-0bc114398729
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2740,
          "y": 1780
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4103b833-432f-4188-81e4-624e0ce96ab6
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 4103b833-432f-4188-81e4-624e0ce96ab6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1670,
          "y": 1960
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        simple: "No"
      CustomBlockRule:
        simple: "True"
      IP:
        complex:
          root: blockIndicatorsList
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.sourceIP
            operator: SetIfEmpty
          - operator: uniq
      InputEnrichment:
        simple: "False"
      RuleDirection:
        simple: inbound
      RuleName:
        simple: XSOAR - Block IP playbook - ${incident.id}
      UserVerification:
        simple: "False"
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: "This playbook blocks malicious IP addresses using all integrations
        that are enabled. The direction of the traffic that will be blocked is determined
        by the Cortex XSOAR user (and set by default to outgoing)\nNote the following:\n-
        \ Some of those integrations require specific parameters to run, which are
        based on the playbook inputs. Also, certain integrations use FW rules or appended
        network objects.\n- Note that the appended network objects should be specified
        in blocking rules inside the system later on. \n\n\nSupported integrations
        for this playbook [Network security products such as FW/WAF/IPs/etc.]: \n\n*
        Check Point Firewall\n* Palo Alto Networks PAN-OS\n* Zscaler\n* FortiGate\n*
        Aria Packet Intelligence\n* Cisco Firepower \n* Cisco Secure Cloud Analytics\n*
        Cisco ASA\n* Akamai WAF\n* F5 SilverLine\n* ThreatX\n* Signal Sciences WAF\n*
        Sophos Firewall\n\n"
      id: 43b93c5c-cebc-4d7b-87cd-1182f0473566
      iscommand: false
      name: Block IP - Generic v3
      playbookId: Block IP - Generic v3
      type: playbook
      version: -1
    taskid: 43b93c5c-cebc-4d7b-87cd-1182f0473566
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -580,
          "y": 1400
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 23b015a1-ba70-44ec-83aa-53ea52895282
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 23b015a1-ba70-44ec-83aa-53ea52895282
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1120,
          "y": 1570
        }
      }
  "35":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Choose user to remediate
        options: []
        optionsarg:
        - complex:
            root: inputs.username
            transformers:
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Manual user remediation
      totalanswers: 0
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Analyst interaction is needed for the user remediation.
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: XCLOUD Cryptominig Alert - User Remediation
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${incident.assigneduser}
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, nothing is returned.
      id: b1e272ac-82e0-49ac-8ba3-90eea0e26f7b
      iscommand: false
      name: Choose user to remediate
      type: collection
      version: -1
    taskid: b1e272ac-82e0-49ac-8ba3-90eea0e26f7b
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1070
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Manual user remediation.Answers
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks the user's answer.
      id: 0bae593f-6319-4ac5-8744-bc22a60e955c
      iscommand: false
      name: Check user answer
      type: condition
      version: -1
    taskid: 0bae593f-6319-4ac5-8744-bc22a60e955c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1230
        }
      }
  "38":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.autoBlockIndicators
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the user chose automatic remediation.
      id: dbe687e3-55bb-420d-8e22-270ea5cb6ef5
      iscommand: false
      name: Should block indicators automatically?
      type: condition
      version: -1
    taskid: dbe687e3-55bb-420d-8e22-270ea5cb6ef5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -580,
          "y": 690
        }
      }
  "39":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Choose indicators to block
        options: []
        optionsarg:
        - complex:
            root: inputs.sourceIP
            transformers:
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Block Indicators
      totalanswers: 0
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Analyst interaction is needed for indicators remediation.
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: XCLOUD Cryptominig Alert - Block Indicators
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${incident.assigneduser}
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, nothing is returned.
      id: e5576fdc-78ac-4ed2-8344-9a212dc03f7e
      iscommand: false
      name: Choose indicators to block
      type: collection
      version: -1
    taskid: e5576fdc-78ac-4ed2-8344-9a212dc03f7e
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -860,
          "y": 880
        }
      }
  "40":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Block Indicators.Answers
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "32"
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks the user's answer.
      id: 3489672c-b9f6-47ae-8947-c178338e102d
      iscommand: false
      name: Check user answer
      type: condition
      version: -1
    taskid: 3489672c-b9f6-47ae-8947-c178338e102d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -860,
          "y": 1040
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: blockIndicatorsList
      value:
        complex:
          accessor: "0"
          root: Block Indicators.Answers
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1374542f-3fb5-4ccd-8d31-9ac28bce6e3b
      iscommand: false
      name: Set selected indicators to remediate
      script: Set
      type: regular
      version: -1
    taskid: 1374542f-3fb5-4ccd-8d31-9ac28bce6e3b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -860,
          "y": 1230
        }
      }
  "43":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Manual resource remediation.Answers
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks the user's answer.
      id: dbfd19a9-5428-4843-8c6e-ace16c1408c2
      iscommand: false
      name: Check user answer
      type: condition
      version: -1
    taskid: dbfd19a9-5428-4843-8c6e-ace16c1408c2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1940,
          "y": 1210
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: remediateResourceList
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Manual resource remediation.Answers.0
              operator: isNotEqualString
              right:
                value:
                  simple: ALL
          root: Manual resource remediation.Answers.0
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.resourceName
            operator: SetIfEmpty
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d5484895-de9f-4476-8084-61335a33bf9f
      iscommand: false
      name: Set selected resources to remediate
      script: Set
      type: regular
      version: -1
    taskid: d5484895-de9f-4476-8084-61335a33bf9f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1940,
          "y": 1420
        }
      }
  "45":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Choose resources to remediate
        options: []
        optionsarg:
        - simple: ALL
        - complex:
            accessor: referenced_resource_name
            root: alertJson._all_events
            transformers:
            - operator: uniq
            - args:
                applyIfEmpty: {}
                defaultValue:
                  iscontext: true
                  value:
                    simple: inputs.resourceName
              operator: SetIfEmpty
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: Your SOC team
      title: Manual resource remediation
      totalanswers: 0
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Analyst interaction is needed for resource remediation.
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: XCLOUD Cryptominig Alert - Resource Remediation
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${incident.assigneduser}
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, nothing is returned.
      id: b5f2ce1e-84c6-444f-8fe7-7afca8212926
      iscommand: false
      name: Choose resources to remediate
      type: collection
      version: -1
    taskid: b5f2ce1e-84c6-444f-8fe7-7afca8212926
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1940,
          "y": 1050
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      user:
        complex:
          accessor: "0"
          root: Manual user remediation.Answers
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.username
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Revoke a user session- Invalidates all the refresh tokens issued to applications for a user.
        Permission: Directory.AccessAsUser.All(Delegated)
      id: cd8e8bd1-d5ca-453d-8989-cbbec45aeca6
      iscommand: true
      name: Revoke user's existing sessions
      script: '|||msgraph-user-session-revoke'
      type: regular
      version: -1
    taskid: cd8e8bd1-d5ca-453d-8989-cbbec45aeca6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 720,
          "y": 1420
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "17_18_yes": 0.4,
      "17_23_#default#": 0.37,
      "18_35_#default#": 0.62,
      "19_20_Disable": 0.64,
      "19_23_#default#": 0.74,
      "24_30_#default#": 0.36,
      "25_26_yes": 0.48,
      "25_45_#default#": 0.57,
      "26_27_Power Off": 0.78,
      "26_30_#default#": 0.76,
      "36_23_#default#": 0.31,
      "38_31_yes": 0.41,
      "38_39_#default#": 0.44,
      "40_32_#default#": 0.56,
      "40_41_yes": 0.44,
      "43_30_#default#": 0.32
    },
    "paper": {
      "dimensions": {
        "height": 1655,
        "width": 4240,
        "x": -1120,
        "y": 370
      }
    }
  }
