contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 3186f946-ebeb-4fec-8c59-71f81733bb52
inputs:
- description: ""
  key: IOC
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Add New Tag CSP Block Indicator v1.0_JP
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 00fb80a3-3546-4e2f-8893-b3b06068105d
      iscommand: false
      name: ""
      version: -1
    taskid: 00fb80a3-3546-4e2f-8893-b3b06068105d
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -390,
          "y": -5260
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 888a43c7-a502-4305-86ab-f3caf4524c67
      iscommand: false
      name: Is Indicator Context Set ?
      type: condition
      version: -1
    taskid: 888a43c7-a502-4305-86ab-f3caf4524c67
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -390,
          "y": -5120
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: indicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: c4eba29d-df9f-45e1-8a17-cfd5ca2e5e70
      iscommand: false
      name: Delete 'Indicator' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: c4eba29d-df9f-45e1-8a17-cfd5ca2e5e70
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -390,
          "y": -4905
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: a802db11-380c-411e-8fa3-c1b0a36a1802
      iscommand: true
      name: Check If IP Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: a802db11-380c-411e-8fa3-c1b0a36a1802
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -350,
          "y": -315
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5bd4fd6d-70f9-436b-8f8a-82bf5a6f05c2
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 5bd4fd6d-70f9-436b-8f8a-82bf5a6f05c2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -350,
          "y": -90
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: expirydate
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: in 24 months
            operator: ModifyDateTime
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 10571789-9d34-4782-8e35-344adb007b3f
      iscommand: false
      name: Calculate Expiry Date
      script: Set
      type: regular
      version: -1
    taskid: 10571789-9d34-4782-8e35-344adb007b3f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 120
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6819d80f-caaf-42b9-8b2e-0597120257ec
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 6819d80f-caaf-42b9-8b2e-0597120257ec
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -310,
          "y": 660
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: a663db48-0d59-4d0d-897a-089255f5db62
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: a663db48-0d59-4d0d-897a-089255f5db62
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -290,
          "y": 890
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 0989924f-74b5-478b-8d9f-8ff2da0e2a80
      iscommand: true
      name: Add New CSP Tag to IP
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 0989924f-74b5-478b-8d9f-8ff2da0e2a80
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -310,
          "y": 1165
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: IP
      value:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: ddc97019-f41b-4738-8c08-24c77baba61b
      iscommand: true
      name: Tag The IP Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: ddc97019-f41b-4738-8c08-24c77baba61b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1650,
          "y": -75
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ef8f1c1a-d330-402b-874b-bbfa7c8e0658
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: ef8f1c1a-d330-402b-874b-bbfa7c8e0658
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -20,
          "y": 2220
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 00ff4f0f-46ac-4d59-867a-8c22a05d251c
      iscommand: true
      name: Check If  domain Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 00ff4f0f-46ac-4d59-867a-8c22a05d251c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 120,
          "y": -410
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 972da0a4-1546-4be5-8cfc-2aee52b0f3f8
      iscommand: true
      name: Check If Indicators Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 972da0a4-1546-4be5-8cfc-2aee52b0f3f8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -390,
          "y": -4740
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea0d2330-8bd5-4b0a-884f-a49f2c8fd330
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: ea0d2330-8bd5-4b0a-884f-a49f2c8fd330
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -340,
          "y": 135
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: Domain
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 17143513-16fa-45de-89d4-e13b1c850a87
      iscommand: true
      name: Tag The Domain Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 17143513-16fa-45de-89d4-e13b1c850a87
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 20
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: URL
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: fbbe3b73-01d7-45e3-876c-8855e74e7399
      iscommand: true
      name: Tag The URL Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: fbbe3b73-01d7-45e3-876c-8855e74e7399
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1270,
          "y": 40
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 5e30ff3b-7a21-4ea8-8ac4-e30995977a36
      iscommand: true
      name: Add New CSP Tag to Domain
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 5e30ff3b-7a21-4ea8-8ac4-e30995977a36
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 1165
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 28ba285e-acbb-4203-87e7-d3aff07583aa
      iscommand: true
      name: Add New CSP Tag to URL
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 28ba285e-acbb-4203-87e7-d3aff07583aa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -800,
          "y": 1165
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Address2.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 1be5c140-d0b2-415e-8655-5bb74755b8ce
      iscommand: false
      name: Delete IP IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 1be5c140-d0b2-415e-8655-5bb74755b8ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -280,
          "y": 355
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 5f7a154b-9487-4133-8b58-a897686164fe
      iscommand: false
      name: Delete URL IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 5f7a154b-9487-4133-8b58-a897686164fe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 355
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 8b07f390-aff8-42c1-8356-6e1bd368d678
      iscommand: false
      name: Delete  domain IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 8b07f390-aff8-42c1-8356-6e1bd368d678
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 140,
          "y": 355
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: IP
      value:
        simple: ${inputs.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 40973bbc-2a6d-48b2-8aff-cac2ea001ef5
      iscommand: true
      name: Tag The Hash Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 40973bbc-2a6d-48b2-8aff-cac2ea001ef5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2080,
          "y": -75
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: ecf4ae6a-b35e-4310-8af8-cd637caa9746
      iscommand: false
      name: Delete hash IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: ecf4ae6a-b35e-4310-8af8-cd637caa9746
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 340
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 217f3e89-26f4-42dc-88e7-6128afe1a8eb
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 217f3e89-26f4-42dc-88e7-6128afe1a8eb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 180,
          "y": 900
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 56fd90c8-30f3-4ca3-84d4-cbacb03dd841
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 56fd90c8-30f3-4ca3-84d4-cbacb03dd841
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -830,
          "y": 880
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 766e8942-5991-4039-870f-d79c03b7ad3b
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 766e8942-5991-4039-870f-d79c03b7ad3b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 900
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 13fe4cf9-b1ef-4537-87cb-dc59b64bff6e
      iscommand: true
      name: Add New CSP Tag to  hash
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 13fe4cf9-b1ef-4537-87cb-dc59b64bff6e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 1165
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 8e9abc02-a4e3-41c9-8651-8a359503ece8
      iscommand: true
      name: Check If  hash Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 8e9abc02-a4e3-41c9-8651-8a359503ece8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 590,
          "y": -450
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: ip
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.URL
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: url
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: domain
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.File
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: file
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      domain:
      - "39"
      file:
      - "67"
      ip:
      - "65"
      url:
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e9283b62-1062-4fb2-89dd-34e3110e0c77
      iscommand: false
      name: Check which input is defined
      type: condition
      version: -1
    taskid: e9283b62-1062-4fb2-89dd-34e3110e0c77
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -390,
          "y": -4560
        }
      }
  "30":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a2f161a8-3899-41dd-8ea0-8bc43b0cc9b8
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: a2f161a8-3899-41dd-8ea0-8bc43b0cc9b8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1150,
          "y": -345
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 76fe147e-7d52-48dd-8d47-9aa744165686
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 76fe147e-7d52-48dd-8d47-9aa744165686
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 120,
          "y": -250
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2dd03553-fcb7-47e3-8f6b-a6cfad67f275
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 2dd03553-fcb7-47e3-8f6b-a6cfad67f275
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 580,
          "y": -240
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5258bef5-8713-420d-8cf4-2017ec0cca2c
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 5258bef5-8713-420d-8cf4-2017ec0cca2c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 630,
          "y": 120
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 53211618-adf9-4be8-8d36-b2045f856eb0
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 53211618-adf9-4be8-8d36-b2045f856eb0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -930,
          "y": 120
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5d2555b4-a273-4e73-86a8-4bc023d66b74
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 5d2555b4-a273-4e73-86a8-4bc023d66b74
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 130,
          "y": 120
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fbff6cb5-0e2b-4e02-8cd5-02cc543d78d7
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: fbff6cb5-0e2b-4e02-8cd5-02cc543d78d7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 620,
          "y": 680
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1d58577f-ff5d-422a-82f7-bfcb0c8f5dff
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 1d58577f-ff5d-422a-82f7-bfcb0c8f5dff
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 160,
          "y": 670
        }
      }
  "38":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "18"
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7509d82b-89a0-46c6-89d9-641d46c728c5
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 7509d82b-89a0-46c6-89d9-641d46c728c5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -960,
          "y": 680
        }
      }
  "39":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "75"
      "yes":
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f23ab10f-930a-4d34-8148-19d4cce4af4f
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: f23ab10f-930a-4d34-8148-19d4cce4af4f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -800,
          "y": -4350
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "54"
      "yes":
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a448cba6-92ec-409f-8afb-b2560980cc40
      iscommand: false
      name: Is This IP Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: a448cba6-92ec-409f-8afb-b2560980cc40
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2130,
          "y": -4160
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "76"
      "yes":
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 67027817-97aa-4b43-8640-5cc3dffc80da
      iscommand: false
      name: Is This Domain Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 67027817-97aa-4b43-8640-5cc3dffc80da
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -800,
          "y": -4140
        }
      }
  "47":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "104"
      "yes":
      - "101"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 13739758-eac1-4853-80e2-795db86154d5
      iscommand: false
      name: Is This Hash Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 13739758-eac1-4853-80e2-795db86154d5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1880,
          "y": -4160
        }
      }
  "48":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "82"
      "yes":
      - "84"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2844d6c0-da4e-4066-8a34-10735111904a
      iscommand: false
      name: Is This URL Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 2844d6c0-da4e-4066-8a34-10735111904a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": -4140
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c77057bf-2acb-4479-8384-d65b7aac86dc
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: c77057bf-2acb-4479-8384-d65b7aac86dc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1970,
          "y": -3990
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: eef6ada7-4c22-4217-8e67-d23263b3578d
      iscommand: true
      name: Add New CSP Tag to IP and Set Expiry to 30 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: eef6ada7-4c22-4217-8e67-d23263b3578d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1930,
          "y": -3640
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 428a7ac7-31f5-4f92-8cfb-096f739ebb88
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 428a7ac7-31f5-4f92-8cfb-096f739ebb88
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1970,
          "y": -3810
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "70"
      "yes":
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c15a0cfa-3f63-4e13-89d5-f53c7970e30a
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: c15a0cfa-3f63-4e13-89d5-f53c7970e30a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1900,
          "y": -4350
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "81"
      "yes":
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 30c5d0ec-9c1e-42dc-8a33-74cc076e001b
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 30c5d0ec-9c1e-42dc-8a33-74cc076e001b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": -4330
        }
      }
  "67":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "102"
      "yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 36583da5-fb45-481b-88a8-e9b9c43be0ad
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 36583da5-fb45-481b-88a8-e9b9c43be0ad
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1870,
          "y": -4330
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3d4d6f18-af62-4b56-85b9-b448e65af025
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 3d4d6f18-af62-4b56-85b9-b448e65af025
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -640,
          "y": -3380
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: IP
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: e8acefed-7c0c-4cad-8701-7d0eebdcd567
      iscommand: true
      name: Create New CSP IP Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: e8acefed-7c0c-4cad-8701-7d0eebdcd567
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1520,
          "y": -4140
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: a742371e-3e16-43e3-8003-9f765d6710f3
      iscommand: true
      name: 'Set expiry date to 30 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: a742371e-3e16-43e3-8003-9f765d6710f3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1520,
          "y": -3745
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: f49c1de2-e360-49df-89c7-cb16872f7976
      iscommand: false
      name: Delete IP IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: f49c1de2-e360-49df-89c7-cb16872f7976
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2340,
          "y": -3690
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "80"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: Domain
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 761df133-a25c-4ec1-8b7a-f3f3c32650de
      iscommand: true
      name: Create New CSP Domain Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 761df133-a25c-4ec1-8b7a-f3f3c32650de
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -360,
          "y": -4065
        }
      }
  "76":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3ca69239-b7a7-4adb-8a85-8ca095b5edb2
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 3ca69239-b7a7-4adb-8a85-8ca095b5edb2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -780,
          "y": -3965
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: e9f9c924-0959-40de-8f58-f93db7045099
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: e9f9c924-0959-40de-8f58-f93db7045099
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -770,
          "y": -3730
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 92135d08-fb38-4029-83ae-f3d8fd92a1ba
      iscommand: false
      name: Delete Domain IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 92135d08-fb38-4029-83ae-f3d8fd92a1ba
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1140,
          "y": -3610
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 137dc952-3ab4-4fe6-8c5e-51bbb6a683a3
      iscommand: true
      name: Add New CSP Tag to Domain and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 137dc952-3ab4-4fe6-8c5e-51bbb6a683a3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -730,
          "y": -3560
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: a7c86a79-a7c6-439a-8abe-3c987dc00cb6
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: a7c86a79-a7c6-439a-8abe-3c987dc00cb6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -340,
          "y": -3690
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: URL
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 128da6e6-339d-4afc-8c01-b272becb847d
      iscommand: true
      name: Create New CSP URL Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 128da6e6-339d-4afc-8c01-b272becb847d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": -3990
        }
      }
  "82":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "85"
      "yes":
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7e6e7836-b7b4-4b1b-85e8-8a0384158467
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 7e6e7836-b7b4-4b1b-85e8-8a0384158467
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 420,
          "y": -3920
        }
      }
  "83":
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "85"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: abb262d8-eb67-41ab-8b57-c6d1e95142fc
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: abb262d8-eb67-41ab-8b57-c6d1e95142fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": -3745
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 54febece-09fc-4bd8-829c-c66b21ca5636
      iscommand: false
      name: Delete  URL OC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 54febece-09fc-4bd8-829c-c66b21ca5636
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": -3580
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: a7dd0445-4be9-4ae8-880d-778ab25c7026
      iscommand: true
      name: Add New CSP Tag to URL and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: a7dd0445-4be9-4ae8-880d-778ab25c7026
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 420,
          "y": -3595
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: c29dbf43-bcdb-4353-8902-08f8fd98dba8
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: c29dbf43-bcdb-4353-8902-08f8fd98dba8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 830,
          "y": -3605
        }
      }
  "101":
    continueonerrortype: ""
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: File
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: e21a5443-ef41-4074-800b-1d4088380f02
      iscommand: false
      name: Delete  File OC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: e21a5443-ef41-4074-800b-1d4088380f02
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1730,
          "y": -3785
        }
      }
  "102":
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "103"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: File
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: abd4060c-5f28-4b21-81da-53ecb867e74a
      iscommand: true
      name: Create New CSP File Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: abd4060c-5f28-4b21-81da-53ecb867e74a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1290,
          "y": -3980
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: 9ccaec13-741d-4d6f-8453-9011a5b2b255
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: 9ccaec13-741d-4d6f-8453-9011a5b2b255
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1280,
          "y": -3650
        }
      }
  "104":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "106"
      "yes":
      - "105"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 31d63cc4-478f-45dd-8755-f1ecae3d96a9
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 31d63cc4-478f-45dd-8755-f1ecae3d96a9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2170,
          "y": -3940
        }
      }
  "105":
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 2e4d3643-dba1-40c6-851f-0a5c75dd58b9
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 2e4d3643-dba1-40c6-851f-0a5c75dd58b9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2190,
          "y": -3760
        }
      }
  "106":
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: e00a5914-4c52-48cc-882d-1967cbcf5664
      iscommand: true
      name: Add New CSP Tag to File and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: e00a5914-4c52-48cc-882d-1967cbcf5664
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2170,
          "y": -3560
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "1_2_yes": 0.44,
      "39_45_yes": 0.51,
      "54_56_yes": 0.53,
      "65_44_yes": 0.35,
      "66_48_yes": 0.37,
      "67_47_yes": 0.58
    },
    "paper": {
      "dimensions": {
        "height": 7545,
        "width": 4910,
        "x": -2340,
        "y": -5260
      }
    }
  }
