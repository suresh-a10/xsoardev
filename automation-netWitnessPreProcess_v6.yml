commonfields:
  id: 26e6e6eb-15df-4ad8-8cde-e27891630ab4
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dependson:
  must:
  - RSA NetWitness Packets and Logs|||netwitness-query
  - ' rsa-nw-incident-list-alerts'
dockerimage: demisto/python3:3.8.1.6120
enabled: true
engineinfo: {}
mainengineinfo: {}
name: netWitnessPreProcess_v6
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  import datetime
  from datetime import datetime
  from dateutil import tz
  res = demisto.incidents()[0]
  labels = res.get('labels')
  #print(labels)
  incId = ''
  brand =''
  brand1 = ''
  ntfields =''
  customfields =''
  alerts = []
  siemfirstalerttime =''

  demisto.executeCommand('startTimer',{'timerField':'hclincidentresolvedtimer'})
  demisto.executeCommand('startTimer',{'timerField':'hclresolutiontime'})
  demisto.executeCommand('startTimer',{'timerField':'hclincidentdaysopentimer'})

  def convertactualalerttime(value):
       return datetime.fromtimestamp(int(value)).strftime('%B %d,%Y,%I:%M %p')
  def firstalerttime(str_date):
      from_zone = tz.gettz('UTC')  # from time zone (i.e. UTC)
      to_zone = tz.gettz('Asia/Calcutta')  # to time zone (i.e India)

      # replacing removing 'T and Z' from string time
      str_date = str_date.replace('T', ' ')
      str_date = str_date.replace('Z', '')
      format = '%Y-%m-%d %H:%M:%S.%f'
      try:
          datetime_obj = datetime.strptime(str_date, format)
      except Exception as e:
          format = '%Y-%m-%d %H:%M:%S'
          datetime_obj = datetime.strptime(str_date, format)
          print(datetime_obj)

      utc = datetime_obj.replace(tzinfo=from_zone)  # assigning date as UTC date
      local = utc.astimezone(to_zone)  # utc date -> local date
      # converting local date in readable format
      expected_local = local.strftime("%B %d, %Y, %I:%M %p")
      print(expected_local)
      return expected_local

  title =res.get('type')
  #print(title)
  #titlelog = next((item['value'] for item in labels if item["type"] == "title"), None)
  titlelog=demisto.get(res,'name')
  titlelog=titlelog.split("- ")[-1]
  #print(titlelog)

  if title not in ('HCL DSM Log Inspection Critical Severity','HCL FireEye HX - Maze Ransomware','HCL_MSOffice365 - ATP detection for','HCL FireEye HX - Ransomware Detection','HCL FireEye NX Phish URL','HCL FireEye HX Base Alert','HCL DSM - Integrity Monitoring','HCL Proxy - Threat Risk – Suspicious/Risky','HCL Proxy - Threat Risk – Probably Malicious','HCL Proxy - Threat Risk – Possibly Malicious - Stronger possibility of maliciousness','HCL FireEye NX Base Alert','HCL EPP','HCL Unauthorized Login Attampt','HCL Unusual Traffic','HCL MSOffice365 via ATP','HCL O365 Anomali - Malware IP Match','HCL Detecting Tor','HCL MSoffice365 - eDiscovery','HCL AD Spyware-Adware','HCL FireEye Containment','HCL SIEM Alert-Logs','HCL Proxy','HCL DAM','HCL Deception','HCL IPS','HCL DLP via CASB','HCL AD','HCL O365 Login Via CASB','HCL Threat Intel Platform','HCL Anomali Blocking Aged Out','HCL AD DADMIN','HCL Arbor','HCL Default Accounts Login Attempt RSA MFA','HCL Default Accounts Login Attempt Proxy','HCL Default Accounts Login Attempt Demisto','HCL Default Accounts Login Attempt Deception','HCL Default Accounts Login Attempt SIEM','HCL Default Accounts Login Attempt CASB','HCL Default Accounts Login Attempt Symantec AV','HCL Default Accounts Login Attempt DAM','HCL Default Accounts Login Attempt Cisco ISE','HCL Default Accounts Login Attempt FireEye HX','HCL Default Accounts Login Attempt FireEye NX','HCL Default Accounts Login Attempt Mcafee IPS','HCL Default Accounts Login Attempt CAS','HCL Default Accounts Login Attempt A10','HCL VMware Horizon - Failed Login Attempts','HCL Non PAM account Logon Activity on Security Devices',"HCL Non PAM account on BigFix/GITAutomation Devices","HCL Non PAM account Logon Activity on DBA/APAC Devices","HCL Non PAM account Logon Activity on BackUps/VMOps/GITCST Devices","HCL Non PAM account Logon Activity for Non Windows on RSA/DAM/NAC Devices","HCL Non PAM account Logon Activity on IT Devices","HCL Non PAM account Logon Activity for Non Windows on Unix Team devices","HCL Non PAM account Logon Activity on VDI/Storage/Cloud Devices","HCL Non PAM on ITOM/Solarwind/Cyberark/NM",'HCL Non PAM account Logon Activity for Non Windows on DBA/APACDevices','HCL Non PAM account Logon Activity on AD-DNS-EmailArchival','HCL Non PAM account Logon Activity on ACT Devices',"HCL Non PAM account Logon Activity on Telecom Devices",'HCL Non PAM account Logon Activity on Identity/Video/Tarmac Devices','HCL Non PAM account Login','HCL Mcafee IPS Inbound','HCL Mcafee IPS Outbound','HCL Mcafee IPS Lateral','HCL VMware Horizon - Failed Login Attempts','HCL VMware Horizon - Threatstream Match','HCL Port Scanning External Malport','HCL Data Sharing via CASB','HCL Port Scanning Single external host to multiple DST ports','HCL Port Scanning Single Host To Multiple Internal Destination','HCL MSoffice365 - eDiscovery Search Activity Detected On Jay','HCL Port Scanning Single Host To Multiple HCL Public Destination','HCL Port Scanning Internal Malport Traffic from Single Host to Single Destination on Multiple Port','HCL MSoffice365 - eDiscovery Export activity - Jay','HCL MSoffice365- From single non HCL email ID to 100 HCL email'):
      title = 'others'

  if "SEP" in titlelog :
      title = 'HCL EPP-SEP'
  elif "DSM-Integrity Monitoring" in titlelog :
      title = 'HCL EPP-DSM'
  elif "DSM - Intrusion Prevention" in titlelog :
      title = 'HCL EPP-DSM-IPS'
  print(title)

  fields_mapping ={'HCL EPP-SEP': {'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.src',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclsourceip':'ip.src',
                              'hclsepincvirusname':'virusname',
                              'hclsourcefilepath':'filename',
                              'hcltoolaction':'action',
                              'hclsourceusername':'user.dst',
                              'hcltitle':'policy.name',
                              'hclhostname':'host.src',
                              'hclclassifiedhashvalue':'checksum'}},
              'HCL DSM Log Inspection Critical Severity':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnessdestinationeip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcldevicetype':'device.type',
                              'hclsourceusername':'user.src',
                              'hclhostname':'host.src',
                              'hclincidentseverityreportedbydevice':'d.severity',
                              'hclsourcefilepath':'directory',
                              'hclcasbdlppolicy':'policy.name',
                              'hcleventid':'incident.id',
                              'hclsourcefile':'obj.name',
                              'hcldestinationpath':'result',
                              'hcldescription':'event.desc',
                              'hclfilepath':'filename',
                              'hclactualeventalerttime':'time'}},
              'HCL Proxy - Threat Risk – Suspicious/Risky':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.dst',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hclcountry' : 'category',
                              'userloginlocation' : 'server',
                              # 'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hcldestinationurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hcldestinationip':'ip.dst',
                              'hclsourceurl':'url',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id'}},
              'HCL Proxy - Threat Risk – Probably Malicious':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.dst',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hclcountry' : 'category',
                              'userloginlocation' : 'server',
                              # 'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              # 'hclhostname':'host.dst',
                              # 'hclsourceurl':'host.dst',
                              'hclsourceurl':'url',
                              'hclsourceusername':'username',
                              'hcleventid':'incident.id'}},
              'HCL Proxy - Threat Risk – Possibly Malicious - Stronger possibility of maliciousness':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.dst',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hclcountry' : 'category',
                              'userloginlocation' : 'server',
                              # 'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              # 'hclhostname':'host.dst',
                              # 'hclsourceurl':'host.dst',
                              'hclsourceurl':'url',
                              'hclsourceusername':'user.dst',
                              'hclsourceip':'ip.src',
                              'hcldestinationip':'ip.dst',
                              'hclresult':'action',
                              'hcleventid':'incident.id'}},
              'HCL O365 Login Via CASB':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.dst',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hclcountry' : 'category',
                              'userloginlocation' : 'server',
                              # 'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              # 'hclhostname':'host.dst',
                              # 'hclsourceurl':'host.dst',
                              'hclsourceip':'host.src',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id'}},
              'HCL Data Sharing Via CASB':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.dst',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'userloginlocation' : 'server',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'host.dst',
                              'hclsourceurl':'host.dst',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id'}},
              'HCL DSM - Integrity Monitoring':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnessdestinationeip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcldevicetype':'device.type',
                              'hclsourceusername':'user.src',
                              'hclhostname':'hostname',
                              'hclsourceip':'device.host',
                              'hclincidentseverityreportedbydevice':'d.severity',
                              'hclsourcefilepath':'directory',
                              'hclcasbdlppolicy':'policy.name',
                              'hcleventid':'incident.id',
                              'hclsourcefile':'obj.name',
                              'hcldestinationpath':'result',
                              'hclactualeventalerttime':'time'}},
              'HCL EPP': {'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.src',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclsourceip':'ip.src',
                              'hclsepincvirusname':'virusname',
                              'hclsourcefilepath':'filename',
                              'hcltoolaction':'action',
                              'hclsourceusername':'user.dst',
                              'hcltitle':'policy.name',
                              'hclhostname':'host.src',
                              'hclclassifiedhashvalue':'checksum'   }},
              'HCL Proxy': {'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.src',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcltitle':'policy.name',
                              'hcldestinationurl':'host.dst',
                              'hclurlcategoryreported':'category',
                              'hclresult':'result',
                              'hcldestinationport':'ip.dstport',
                              'hclactualeventalerttime':'time',
                              'hcluseragent':'user.agent' }},
              'HCL EPP-DSM': {'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'device.host',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclsourceip':'ip.src',
                              'hclsourcefilepath':'filename',
                              'hcltoolaction':'action',
                              'hclsourceusername':'user.dst',
                              'hcltitle':'policy.name',
                              'hclhostname':'device.host',
                              'hclclassifiedhashvalue':'checksum',
                              'hclresult':'action',
                              'hclincidentsummary':'event.type' }},
              'HCL EPP-DSM-IPS': {'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessdestinationport':'ip.dstport','netwitnesssourceip':'ip.src','netwitnessdestinationip':'ip.dst'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclsourceip':'ip.src',
                              'hcldestinationip':'ip.dst',
                              'hclincidentsummary':'event.type',
                              'hcldestinationport':'ip.dstport',
                              'hclsourceport':'ip.srcport',
                              'hclhostname':'hostname',
                              'hclresult':'action',
                              'hclincidentsummary':'event.type' }},
    'HCL SIEM Alert-Logs':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclsourceusername':'user.dst',
                              'hclobjectname':'obj.name',
                              'hclaction':'action',
                              'hclactiontwo':'ec.outcome',
                              'hclincidenteventid':'incident.id' }},
    'HCL MSoffice365- From single non HCL email ID to 100 HCL email':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'email.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclobjectname':'obj.name',
                              'hclaction':'action',
                              'hclactiontwo':'ec.outcome',
                              'hclincidenteventid':'incident.id' }},
    'HCL Port Scanning Single Host To Multiple HCL Public Destination':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclsourceusername':'user.dst',
                              'hclobjectname':'obj.name',
                              'hclaction':'action',
                              'hclactiontwo':'ec.outcome',
                              'hclincidenteventid':'incident.id' }},
    'HCL Port Scanning Internal Malport Traffic from Single Host to Single Destination on Multiple Port':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclsourceusername':'user.dst',
                              'hclobjectname':'obj.name',
                              'hclaction':'action',
                              'hclactiontwo':'ec.outcome',
                              'hclincidenteventid':'incident.id' }},
    'HCL FireEye HX Base Alert':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hcldestinationip':'ip.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceurl':'url',
                              'hclmd5hash':'checksum',
                              'hcleventid':'incident.id',
                              # 'hclresult':'ec.activity',
                              # 'hclsourceusername':'user.dst',
                              # 'hclobjectname':'obj.name',
                              'hclaction':'action',
                              # 'hclactiontwo':'ec.outcome',
                              'hclincidenteventid':'incident.id' }},
    'HCL FireEye NX Phish URL':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'url',
                              'hclsourceusername':'user.src',
                              'hcldestinationip':'ip.dst',
                              'hclsourceip':'ip.src',
                              'hclmd5hash':'checksum',
                              'hcleventid':'incident.id',
                              'hclaction':'action',
                              # 'hclactiontwo':'ec.outcome',
                              'hclincidenteventid':'incident.id' }},
    'HCL FireEye NX Base Alert':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hcldestinationip':'ip.dst',
                              'hclsourceip':'ip.src',
                              # 'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              # 'hclresult':'ec.activity',
                              # 'hclsourceusername':'user.dst',
                              # 'hclobjectname':'obj.name',
                              'hclaction':'action',
                              # 'hclactiontwo':'ec.outcome',
                              'hclincidenteventid':'incident.id' }},
    'HCL MSoffice365 - eDiscovery Search Activity Detected On Jay':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclsourceusername':'user.dst',
                              'hclobjectname':'obj.name',
                              'hclaction':'action',
                              'hclactiontwo':'ec.outcome',
                              'hclincidenteventid':'incident.id' }},
    'HCL MSoffice365 - eDiscovery Export activity - Jay':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclsourceusername':'user.dst',
                              'hclobjectname':'obj.name',
                              'hclaction':'action',
                              'hclactiontwo':'ec.outcome',
                              'hclincidenteventid':'incident.id' }},
    'HCL Unauthorized Login Attampt':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
    'HCL Unusual Traffic':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
    'HCL Detecting Tor':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
    'HCL MSoffice365 - eDiscovery':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
    'HCL Port Scanning External Malport':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              # 'hclsourceip':'ip.src',
                              # 'hcldestinationip':'ip.dst',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
    'HCL Port Scanning Single external host to multiple DST ports':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hcldestinationip':'ip.dst',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
    'HCL Port Scanning Single Host To Multiple Internal Destination':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'hostname',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hcldestinationip':'ip.dst',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
        'HCL Non PAM account Logon Activity on Security Devices':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
          'HCL Non PAM account Logon Activity on Telecom Devices':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
          'HCL Non PAM account Logon Activity on VDI/Storage/Cloud Devices':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
          'HCL Non PAM account Logon Activity on IT Devices':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
          'HCL Non PAM account Logon Activity for Non Windows on Unix Team devices':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
          'HCL Non PAM account Logon Activity for Non Windows on RSA/DAM/NAC Devices':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
          'HCL Non PAM account Logon Activity on BackUps/VMOps/GITCST Devices':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
        'HCL Non PAM account Logon Activity on Identity/Video/Tarmac Devices':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
        'HCL Non PAM on ITOM/Solarwind/Cyberark/NM':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
        'HCL Non PAM account on BigFix/GITAutomation Devices':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
        'HCL Non PAM account Logon Activity on DBA/APAC Devices':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
        'HCL Non PAM account Logon Activity on ACT Devices':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
        'HCL Non PAM account Logon Activity on AD-DNS-EmailArchival':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
          'HCL Non PAM account Logon Activity for Non Windows on DBA/APACDevices':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceurl':'host.dst',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity',
                              'hclincidenteventid':'incident.id' }},
        'HCL Non PAM account Login':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'device.host',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hcleventid':'incident.id',
                              'hclresult':'ec.activity'}},
        'HCL Default Accounts Login Attempt Deception':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            #'netwitnesshostname': 'hostname',
                            'netwitnesshostname':'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              #'hclhostname':'host.src',
                              'hclhostname':'alias.host',
                              'hclusername':'user.dst',
                              'hclsourceusername':'user.dst',
                              #'hclsourceip':'attacker.ip',
                              'hclsourceip':'device.ip',
                              'hclincidentsummary':'threat.desc',
                              #'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt Proxy':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'device.type',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt RSA MFA':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'hostname',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt SIEM':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'hostname',
                              # 'hclsourceip':'ip.src',
                              'hclsourceip':'device.ip',
                              'hclsourceusername':'user.src',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt Symantec AV':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'hostname',
                              'hclsourceip':'device.ip',
                              'hclsourceusername':'user.dst',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt DAM':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'device.host',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt CASB':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'hostname',
                              'hclsourceip':'device.ip',
                              'hclsourceusername':'user.src',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt A10':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'device.host',
                              'hclsourceip':'device.ip',
                              'hclsourceusername':'user.dst',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt Demisto':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'hostname',
                              'hclsourceip':'device.ip',
                              'hclsourceusername':'user.dst',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt Cisco ISE':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'hostname',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'username',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt FireEye NX':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'alias.host',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt FireEye HX':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'loc.desc',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt Mcafee IPS':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hcldetectorip':'device.ip',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'device.type',
                              'hclsourceip':'device.ip',
                              'hclsourceusername':'user.dst',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL Default Accounts Login Attempt CAS':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcluseragent':'user.agent',
                              'hclhostname':'device.type',
                              'hclsourceip':'device.ip',
                              'hclsourceusername':'event.desc',
                              'hclusername':'user.dst',
                              'hclincidentsummary':'threat.desc',
                              # 'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
        'HCL AD DADMIN':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hcldeviceip':'device.ip',
                              'hclhostname':'hostname',
                              'hclincidentsummary':'event.desc',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst',
                              'hclactualeventalerttime':'time' }},
        'HCL AD':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hcldeviceip':'device.ip',
                              'hclhostname':'hostname',
                              'hclincidentsummary':'event.desc',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst' }},
        'HCL AD Spyware-Adware':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hcldeviceip':'device.ip',
                              'hclhostname':'hostname',
                              'hclincidentsummary':'event.desc',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst' }},
         'HCL VMware Horizon - Failed Login Attempts':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hcldeviceip':'device.ip',
                              'hclhostname':'hostname',
                              'hclincidentsummary':'event.desc',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst' }},
         'HCL VMware Horizon - Threatstream Match':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hcldeviceip':'device.ip',
                              'hclhostname':'hostname',
                              'hclincidentsummary':'event.desc',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst' }},
          'HCL O365 Anomali - Malware IP Match':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hcldeviceip':'device.ip',
                              'hclresult':'action',
                              'hcldestinationip':'ip.dst',
                              'hcldestinationport':'ip.dstport',
                              'hclsourceport':'ip.srcport',
                              'hclsourceip':'ip.src',
                              'internetserviceprovidername' : "org",
                              'hclsourceusername':'user.dst' }},
          'HCL Anomali C2 Match':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hcldeviceip':'device.ip',
                              'hclresult':'action',
                              'hcldestinationip':'ip.dst',
                              'hcldestinationport':'ip.dstport',
                              'hclsourceport':'ip.srcport',
                              'hclsourceip':'ip.src',
                              'hcldevicetype':'device.type',
                              'internetserviceprovidername' : "org",
                              'hclsourceusername':'user.dst' }},
          'HCL Arbor':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hcldeviceip':'device.ip',
                              'hclresult':'action',
                              'hcldestinationip':'ip.dst',
                              'hcldestinationport':'ip.dstport',
                              'hclsourceport':'ip.srcport',
                              'hclsourceip':'ip.src' }},
          'HCL Anomali Blocking Aged Out':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              # 'hcldeviceip':'device.ip',
                              'hclresult':'action',
                              'hcldestinationip':'ip.dst',
                              'hcldestinationport':'ip.dstport',
                              'hclsourceport':'ip.srcport',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.dst' }},
       'HCL DAM':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hcldestinationip':'ip.dst',
                              'hclhostname':'host.src',
                              'hclincidentsummary':'event.desc',
                              'hclresult':'action',
                              'hclsourceip':'ip.src',
                              'hclsourceusername':'user.src',
                              'hcldestinationuser':'user.dst' }},
       'HCL Deception':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hcluseragent':'user.agent',
                              'hclhostname':'host.src',
                              'hclusername':'user.dst',
                              'hclsourceusername':'user',
                              'hclsourceip':'attacker.ip',
                              'hclincidentsummary':'threat.desc',
                              'hcldestinationurl':'alias.host',
                              'hcldestinationip':'decoy.ip'}},
  'HCL Threat Intel Platform':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclsourceusername':'user.dst',
                              'hclsourceport':'ip.srcport',
                              'hclsourceip':'ip.src',
                              'hclresult':'action',
                              'hcldestinationport':'ip.dstport',
                              'hcldestinationip':'ip.dst'}},
      'HCL IPS':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnessdestinationeip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclsourceport':'ip.srcport',
                              'hclsourceip':'ip.src',
                              'hclresult':'result',
                              'hclincidentsummary':'policy.name',
                              'hcldestinationport':'ip.dstport',
                              'hcldestinationip':'ip.dst'}},
      'HCL Mcafee IPS Inbound':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnessdestinationeip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclsourceport':'ip.srcport',
                              'hclsourceip':'ip.src',
                              'hclresult':'result',
                              'hclincidentsummary':'policy.name',
                              'hcldestinationport':'ip.dstport',
                              'hcldetectorip':'device.ip',
                              'hclipssignature':'policy.name',
                              'hcldestinationip':'ip.dst'}},
      'HCL Mcafee IPS Outbound':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnessdestinationeip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclsourceport':'ip.srcport',
                              'hclsourceip':'ip.src',
                              'hclresult':'result',
                              'hclincidentsummary':'policy.name',
                              'hcldestinationport':'ip.dstport',
                              'hclipssignature':'policy.name',
                              'hcldestinationip':'ip.dst'}},
      'HCL Mcafee IPS Lateral':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnessdestinationeip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclsourceport':'ip.srcport',
                              'hclsourceip':'ip.src',
                              'hclresult':'result',
                              'hclincidentsummary':'policy.name',
                              'hcldestinationport':'ip.dstport',
                              'hclipssignature':'policy.name',
                              'hcldestinationip':'ip.dst'}},
          'HCL DLP via CASB':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'hostname',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnessdestinationeip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hcldevicetype':'device.type',
                              'hclsourceusername':'user.src',
                              'hclincidentseverityreportedbydevice':'d.severity',
                              'hclsourcefilepath':'directory',
                              'hclcasbdlppolicy':'policy.name',
                              'hcleventid':'incident.id',
                              'hclsourceusername':'user.src',
                              'hclsourcefile':'obj.name',
                              'hclhostname':'hostname',
                              'hcldestinationpath':'result',
                              'hclactualeventalerttime':'time'}},
      'HCL FireEye HX - Maze Ransomware':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.dst',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'host.dst',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id'}},
      'HCL FireEye HX - Ransomware Detection':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.src',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'host.src',
                              'hclsourceurl':'host.dst',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id'}},
       'HCL FireEye Containment':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.dst',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'host.src',
                              'hclsourceurl':'host.dst',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id'}},
       'HCL MSOffice365 via ATP':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.dst',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'host.dst',
                              'hclsourceurl':'host.dst',
                              'hclsourceusername':'user.dst',
                              'hclfilename':'filename',
                              'hcldestinationpath':'directory',
                              'hcleventid':'incident.id'}},
       'others':{'ntfields':{'netwitnessdevicetype': 'device.type',
                            'netwitnessfilename': 'filename',
                            'netwitnesshostname': 'host.dst',
                            'netwitnessaction': 'action',
                            'netwitnessdeviceclass': 'device.class',
                            'netwitnessvirusname': 'virusname',
                            'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
                            'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
              'customfields': {'hcleventtimestamp':'time',
                              'hclreportingdevice':'device.type',
                              'hcldeviceclass':'device.class',
                              'hclincidentsummary':'event.type',
                              'hclhostname':'host.dst',
                              'hclsourceurl':'host.dst',
                              'hclsourceusername':'user.src',
                              'hcleventid':'incident.id'}}}
      #  'others':{'ntfields':{'netwitnessdevicetype': 'device.type',
      #                   'netwitnessfilename': 'filename',
      #                   'netwitnesshostname': 'hostname',
      #                   'netwitnessaction': 'action',
      #                   'netwitnessdeviceclass': 'device.class',
      #                   'netwitnessvirusname': 'virusname',
      #                   'netwitnesstitle':'policy.name','netwitnesssourceip':'ip.src','netwitnesssourceip':'ip.dst',
      #                   'netwitnessclassifiedmaliciousdomain':'domain','netwitnesseventid':'incident.id'},
      #     'customfields': {'hcleventtimestamp':'event.time',
                              # 'hclreportingdevice':'device.type',
      #                     'hcldeviceclass':'device.class',
      #                     'hclincidentsummary':'event.type',
      #                     'hclhostname':'hostname',
      #                     'hclsourceurl':'host.dst',
      #                     'hclsourceusername':'user.src',
      #                     'hcleventid':'incident.id'}}}
  #demisto.log(fields_mapping['HCL EPP'])

  def setincidentfields(newFields):
      print("--------------- newFields -------------------")
      print(newFields)
      demisto.executeCommand("setIncident",newFields)

  def mapnetwitnessfields(ntfields):
      alerts.append(ntfields)
      netwitnessalerts = json.dumps(alerts)
      #Setting incident alerts Grid
      demisto.executeCommand("setIncident", {'netwitnessalerts':netwitnessalerts})

  def getmappedfieldvalue(mapping,fields):
      return next((item['value'] for item in fields if item["type"] == mapping),None)

  #Getting all necessary labels: instances and incid
  for label in labels:
      if label.get('type') == 'id':
          incId = label.get('value')
      if label.get('type') =='Instance':
          if (label.get('value')=='RSA NetWitness v11.5_Chennai'):
              brand ="RSA NetWitness v11.1_Chennai"
              brand1 = "RSA NetWitness Packets and Logs_copy_Chennai"
          else:
              brand = "RSA NetWitness v11.5_Noida"
              brand1 = "HCL_RSA NetWitness Packets and Logs_Noida"

  print(brand)


  #Declaring events list
  events = []
  try:
      #Getting events/alerts from NetWitness
      res = demisto.executeCommand('netwitness-get-alerts', {'incidentId':incId.strip('"'),'using':brand})[0]['Contents']
      print(res)
      # createdarray = [sub['created'] for sub in res]
      #print(createdarray)
      # siemfirstalerttime = firstalerttime(createdarray[0])
      # print(siemfirstalerttime)
      # demisto.executeCommand("hcl_setdatefield", {"fieldName":"hclactualalertdate","value":siemfirstalerttime})

      for inc in res:
          events.append(inc['events'])
  except Exception as e:
      print(e)

  #Iteration Counter
  counter = 0

  #Iterating over events to query them
  for event in events:
      #print(event)
      counter+=1
      source_ip=event[0].get('eventSource')
      #print(source_ip)
      if source_ip == "10.150.30.12:56003":
          source_ip = "10.150.30.12:50005"
      elif source_ip == "10.98.148.153:56003":
            source_ip = "10.98.148.153:50005"
      elif source_ip == "10.98.148.152:56003":
            source_ip = "10.98.148.152:50005"
      print(source_ip)
      try:
          # Get the incident fields from logs and packets
          fields = demisto.executeCommand("netwitness-query", {'query':'select * where sessionid={}'.format(event[0].get('eventSourceId')),'using':source_ip})[0]['Contents'][0]['results']['fields']
          #fields = demisto.executeCommand("netwitness-query", {'query':'select * where sessionid=2436666332832'})[0]['Contents'][0]['results']['fields']
          print(fields)
          eventFields ={}

          for ntfields,mapping in fields_mapping[title]['ntfields'].items():
              #print(ntfields,mapping)
              eventFields[ntfields] = getmappedfieldvalue(mapping,fields)

          #print(eventFields)
          mapnetwitnessfields(eventFields)
          #Adding alert to grid

          #Last iteration - adding incident global details

          if counter == len(events):
              #Declaring incident fields JSON
              newFields = {}
              for customfields,mapping in fields_mapping[title]['customfields'].items():
                  #print(ntfields,mapping)
                  newFields[customfields] = getmappedfieldvalue(mapping,fields)
              if title=="HCL DLP via CASB":
                  newFields["hclincidentsummary"] ="Potential Data Leakage event(s) towards external collaborator"
                  valuefield = newFields["hclactualeventalerttime"]
                  #demisto.log("vake")
                  #demisto.log(valuefield)
                  #actualtime = demisto.executeCommand('HCL_ConvertUTCintoLocal',{'value':'1602177878'})[0]['Contents']
                  actualtime = convertactualalerttime(valuefield)#demisto.executeCommand('HCL_ConvertUTCintoLocal',{'value':valuefield})[0]['Contents']
                  #print(actualtime)
                  newFields["hclactualeventalerttime"] =actualtime
                  #print(newFields["hclactualeventalerttime"])
              else:
                  print("else")
                  #newFields["hclactualalerttime"] = siemfirstalerttime
              setincidentfields(newFields)

      except Exception as e:
          print(e)


  #demisto.executeCommand('startTimer',{'timerField':'hclresponsetime'})
  #demisto.executeCommand('startTimer',{'timerField':'hclresolutiontime'})
scripttarget: 0
subtype: python3
tags:
- preProcessing
type: python
