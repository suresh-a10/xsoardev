contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 35e94937-7dd6-4166-82fc-1a7ea373193c
inputs: []
name: TCS-IOC Respond Section Post L2 Review v1_KK_WIP
outputs: []
sourceplaybookid: a1dbf5d6-aa8b-4c29-8860-cbc5c4677328
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "156"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2c265644-4136-4a43-8b5d-aa7963d740d8
      iscommand: false
      name: ""
      version: -1
    taskid: 2c265644-4136-4a43-8b5d-aa7963d740d8
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 690,
          "y": 80
        }
      }
  "156":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ISOTimeNow
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "156"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "158"
      "yes":
      - "157"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3abce05c-e1b3-4ef5-8984-6adfeebc3381
      iscommand: false
      name: Is ISO Time Context Set?
      type: condition
      version: -1
    taskid: 3abce05c-e1b3-4ef5-8984-6adfeebc3381
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 690,
          "y": 280
        }
      }
  "157":
    continueonerrortype: ""
    id: "157"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "158"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ISOTimeNow
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 5b50b109-93f5-43e9-85c3-ae12199241d7
      iscommand: false
      name: Delete Old Time Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 5b50b109-93f5-43e9-85c3-ae12199241d7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 510
        }
      }
  "158":
    continueonerrortype: ""
    id: "158"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "159"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: ISO
      dateFormat:
        simple: ISO
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: 1edf1c20-3e37-4851-8884-605d4b3db3a7
      iscommand: false
      name: Set Current Date In Context
      script: GetTime
      type: regular
      version: -1
    taskid: 1edf1c20-3e37-4851-8884-605d4b3db3a7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 710
        }
      }
  "159":
    continueonerrortype: ""
    id: "159"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "162"
      - "166"
      - "160"
      - "170"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a2719b3f-d92f-4e56-82c5-65378191e974
      iscommand: false
      name: TCS-Select IOC To Block v1_KK
      playbookId: 769b58c8-170a-499a-82e1-3d8942cfa39e
      type: playbook
      version: -1
    taskid: a2719b3f-d92f-4e56-82c5-65378191e974
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 700,
          "y": 850
        }
      }
  "160":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: ExtractedIndicators
          operator: in
          right:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Which IOC.Answers
      label: "yes"
    continueonerrortype: ""
    id: "160"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "178"
      "yes":
      - "161"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 046c2842-9322-48a5-8ce4-0a97806ec10e
      iscommand: false
      name: Is There IP Address For Blocking?
      type: condition
      version: -1
    taskid: 046c2842-9322-48a5-8ce4-0a97806ec10e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -40,
          "y": 1110
        }
      }
  "161":
    continueonerrortype: ""
    id: "161"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "188"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${ExtractedIndicators.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 00db6a93-e9e2-4253-8d44-a39869840546
      iscommand: false
      name: TCS-Add New CSOC IP Indicator v1.0_Kunal
      playbookId: e653e5ab-6658-4f7a-806d-6a79d92d5d98
      type: playbook
      version: -1
    taskid: 00db6a93-e9e2-4253-8d44-a39869840546
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: playbook
    view: |-
      {
        "position": {
          "x": -40,
          "y": 1310
        }
      }
  "162":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: ExtractedIndicators
          operator: in
          right:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Which IOC.Answers
      label: "yes"
    continueonerrortype: ""
    id: "162"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "178"
      "yes":
      - "163"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 813105b5-12ed-48ff-85cd-a5a2cf5969ea
      iscommand: false
      name: Are There Domains For Blocking?
      type: condition
      version: -1
    taskid: 813105b5-12ed-48ff-85cd-a5a2cf5969ea
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 710,
          "y": 1100
        }
      }
  "163":
    continueonerrortype: ""
    id: "163"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                iscontext: true
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 2ea285fc-3ce1-4d90-803d-54b6ffa88c01
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 2ea285fc-3ce1-4d90-803d-54b6ffa88c01
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1630
        }
      }
  "164":
    continueonerrortype: ""
    id: "164"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "191"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 32f39c18-2366-4449-8540-3a558c655967
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 32f39c18-2366-4449-8540-3a558c655967
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1820
        }
      }
  "165":
    continueonerrortype: ""
    id: "165"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: COSCBlockDomain
      type:
        simple: Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: fe9015d5-c68e-424b-8103-61e89a0f851b
      iscommand: true
      name: Tag 'CSOC' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: fe9015d5-c68e-424b-8103-61e89a0f851b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1240,
          "y": 2670
        }
      }
  "166":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: ExtractedIndicators
          operator: in
          right:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Which IOC.Answers
      label: "yes"
    continueonerrortype: ""
    id: "166"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "178"
      "yes":
      - "167"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5388ebb0-857a-4f3f-85b3-4298997709a5
      iscommand: false
      name: Is There URL For Blocking?
      type: condition
      version: -1
    taskid: 5388ebb0-857a-4f3f-85b3-4298997709a5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1580,
          "y": 1130
        }
      }
  "167":
    continueonerrortype: ""
    id: "167"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.URL
              operator: in
              right:
                iscontext: true
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 6f2800e8-ea87-459c-8467-e1b387a79784
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 6f2800e8-ea87-459c-8467-e1b387a79784
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 1320
        }
      }
  "168":
    continueonerrortype: ""
    id: "168"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "192"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: cb3135a8-1158-46eb-84c7-210a0727ce01
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: cb3135a8-1158-46eb-84c7-210a0727ce01
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1320
        }
      }
  "169":
    continueonerrortype: ""
    id: "169"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: COSCBlockURL
      type:
        simple: URL
      value:
        simple: ${ExtractedIndicators.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 66d42ba2-107c-49e2-854b-d44a79780947
      iscommand: true
      name: Tag 'CSOC' Bad URL Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 66d42ba2-107c-49e2-854b-d44a79780947
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1615
        }
      }
  "170":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: File
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "170"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "178"
      "yes":
      - "171"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 854d95f3-67cd-4db3-850c-522e4bbc6436
      iscommand: false
      name: Is There Hash For Blocking ?
      type: condition
      version: -1
    taskid: 854d95f3-67cd-4db3-850c-522e4bbc6436
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2280,
          "y": 1140
        }
      }
  "171":
    continueonerrortype: ""
    id: "171"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 5
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        complex:
          accessor: File
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2300eaa2-9b36-4f6b-886b-51c874cbb440
      iscommand: false
      name: TCS-CSOC Block Malicious Hash on CS v1.0_Kunal
      playbookId: 9d6b9cb3-059d-4b12-865c-f73bed1daa8a
      type: playbook
      version: -1
    taskid: 2300eaa2-9b36-4f6b-886b-51c874cbb440
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: playbook
    view: |-
      {
        "position": {
          "x": 2280,
          "y": 1490
        }
      }
  "173":
    continueonerrortype: ""
    id: "173"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "177"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #ff00ff;">All
          IoC(s) Have Been Reviewed & Blocked</span><br /></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: cc0ccbdc-a710-459b-8f7f-691b37c9024b
      iscommand: true
      name: Set Action Notification - All IoCs Blocked
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: cc0ccbdc-a710-459b-8f7f-691b37c9024b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 620,
          "y": 2930
        }
      }
  "177":
    continueonerrortype: ""
    id: "177"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ed832aa1-afae-4333-8ccd-8e8d139ed1fd
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: ed832aa1-afae-4333-8ccd-8e8d139ed1fd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 630,
          "y": 3300
        }
      }
  "178":
    continueonerrortype: ""
    id: "178"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "173"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0561c675-aeee-4d5a-8f36-e5106ffc2543
      iscommand: false
      name: Notification
      type: title
      version: -1
    taskid: 0561c675-aeee-4d5a-8f36-e5106ffc2543
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 660,
          "y": 2840
        }
      }
  "179":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
          operator: isEqualString
          right:
            value:
              simple: EWS v2
      label: "yes"
    continueonerrortype: ""
    id: "179"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "181"
      "yes":
      - "180"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7c39298b-b211-4fa6-8e0d-54c7cb70e506
      iscommand: false
      name: Triggered From Email ?
      type: condition
      version: -1
    taskid: 7c39298b-b211-4fa6-8e0d-54c7cb70e506
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 520,
          "y": 1320
        }
      }
  "180":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: email
      label: Email
    continueonerrortype: ""
    id: "180"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "163"
      Email:
      - "182"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ebe58c1b-c434-42f6-8f19-06a558599750
      iscommand: false
      name: Does the subject line include 'Email'?
      type: condition
      version: -1
    taskid: ebe58c1b-c434-42f6-8f19-06a558599750
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1440
        }
      }
  "181":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: email only
      label: Email Only
    continueonerrortype: ""
    id: "181"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "163"
      Email Only:
      - "182"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4ab4246f-dff7-4877-8abe-5cc27e83a310
      iscommand: false
      name: ' ''Block IOC On'' Email?'
      type: condition
      version: -1
    taskid: 4ab4246f-dff7-4877-8abe-5cc27e83a310
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 520,
          "y": 1460
        }
      }
  "182":
    continueonerrortype: ""
    id: "182"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: emailblock
      type:
        simple: Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 875c7671-8456-4b43-8028-fb0a25f58c98
      iscommand: true
      name: Tag 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 875c7671-8456-4b43-8028-fb0a25f58c98
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 360,
          "y": 2085
        }
      }
  "183":
    continueonerrortype: ""
    id: "183"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "184"
    note: false
    quietmode: 0
    scriptarguments:
      alert_time:
        complex:
          accessor: created
          root: incident
          transformers:
          - operator: 8726aa62-638b-41b0-8fd7-8d8892145289
          - args:
              delimiter:
                value:
                  simple: .
              fields:
                value:
                  simple: "1"
            operator: Cut
          - args:
              prefix: {}
              suffix:
                value:
                  simple: .0Z
            operator: concat
      destination_domain:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      destination_url:
        simple: http://abc.com
      device_id:
        simple: abcdefghij
      device_version:
        simple: "1.0"
      using:
        simple: Cisco Umbrella Enforcement Block Domain_instance,Cisco Umbrella Enforcement
          Block Domain GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Enforcement Block Domain
      description: Posts a malware event to the API for processing and optionally
        adding to a customer's domain lists.
      id: ae885ec7-9720-4737-81f6-6c74b4f13fc9
      iscommand: true
      name: Block Domain on Cisco Umbrella (opendns)
      script: Cisco Umbrella Enforcement Block Domain|||umbrella-domain-event-add
      type: regular
      version: -1
    taskid: ae885ec7-9720-4737-81f6-6c74b4f13fc9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 940,
          "y": 2070
        }
      }
  "184":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
          operator: isEqualString
          right:
            value:
              simple: EWS v2
      label: "yes"
    continueonerrortype: ""
    id: "184"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "185"
      "yes":
      - "186"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 636f54e3-2815-4abf-84b5-82c4414b99a8
      iscommand: false
      name: Triggered From Email ?
      type: condition
      version: -1
    taskid: 636f54e3-2815-4abf-84b5-82c4414b99a8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 940,
          "y": 2220
        }
      }
  "185":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: internet only
      label: Internet Only
    continueonerrortype: ""
    id: "185"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "187"
      Internet Only:
      - "165"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8a4ca718-dd53-4105-882e-862bdfb5ae6c
      iscommand: false
      name: ' ''Block IOC On'' Internet?'
      type: condition
      version: -1
    taskid: 8a4ca718-dd53-4105-882e-862bdfb5ae6c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 830,
          "y": 2400
        }
      }
  "186":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: internet
      label: Internet
    continueonerrortype: ""
    id: "186"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "187"
      Internet:
      - "165"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7efdea3c-ff0a-4071-8370-c54fb1490413
      iscommand: false
      name: Does the subject line include 'Internet'?
      type: condition
      version: -1
    taskid: 7efdea3c-ff0a-4071-8370-c54fb1490413
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1250,
          "y": 2410
        }
      }
  "187":
    continueonerrortype: ""
    id: "187"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: COSCBlockDomain,emailblock
      type:
        simple: Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 137ac281-05e2-4bd7-8a05-adf169b7fb45
      iscommand: true
      name: Tag 'CSOC' and 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 137ac281-05e2-4bd7-8a05-adf169b7fb45
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 830,
          "y": 2670
        }
      }
  "188":
    continueonerrortype: ""
    id: "188"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "189"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_132
      ip:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
              operator: in
              right:
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.IP
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: f6ce38e1-d2c4-4820-882d-b7047cc725df
      iscommand: true
      name: 'Block IP on Zscaler Corporate '
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: f6ce38e1-d2c4-4820-882d-b7047cc725df
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": 1520
        }
      }
  "189":
    continueonerrortype: ""
    id: "189"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "190"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_241
      ip:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
              operator: in
              right:
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.IP
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 21c76f1f-aaa2-439a-895d-f447bbfbab8d
      iscommand: true
      name: Block IP on Zscaler BPS
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 21c76f1f-aaa2-439a-895d-f447bbfbab8d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": 1695
        }
      }
  "190":
    continueonerrortype: ""
    id: "190"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_57
      ip:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
              operator: in
              right:
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.IP
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 15bdd2df-6b67-43a3-8bf0-98669448d27a
      iscommand: true
      name: Block IP on Zscaler GNDM
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 15bdd2df-6b67-43a3-8bf0-98669448d27a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": 1875
        }
      }
  "191":
    continueonerrortype: ""
    id: "191"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "183"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
              operator: in
              right:
                value:
                  simple: Which IOC.Answers.0
          root: ExtractedIndicators.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 134c2524-2b80-4269-8ad2-9aae19c8dbb0
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 134c2524-2b80-4269-8ad2-9aae19c8dbb0
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1930
        }
      }
  "192":
    continueonerrortype: ""
    id: "192"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "169"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: bbf888ef-4287-4612-80c4-f18f1ef7039d
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: bbf888ef-4287-4612-80c4-f18f1ef7039d
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1460
        }
      }
  "193":
    continueonerrortype: ""
    id: "193"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "195"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: BlockIOCF
      value:
        complex:
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 516e1609-119a-4c01-8b55-320d961ab638
      iscommand: false
      name: set new indicator blockiocF
      script: Set
      type: regular
      version: -1
    taskid: 516e1609-119a-4c01-8b55-320d961ab638
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2340,
          "y": 5
        }
      }
  "194":
    continueonerrortype: ""
    id: "194"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlockIOCF.Domain
              operator: in
              right:
                value:
                  simple: Which IOC.Answers.0
          - - left:
                iscontext: true
                value:
                  simple: BlockIOCF.Domain
              operator: notContainsGeneral
              right:
                value:
                  simple: .google.com
          root: BlockIOCF.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: bac07d1a-d293-48c5-8de6-51ec37c3e76c
      iscommand: false
      name: Compare the Domain from ExtractIndicators and SelectedIOC
      script: Set
      type: regular
      version: -1
    taskid: bac07d1a-d293-48c5-8de6-51ec37c3e76c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2350,
          "y": 375
        }
      }
  "195":
    continueonerrortype: ""
    id: "195"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "194"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.[0].Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 1d237b45-c722-4a51-84d8-617142169d11
      iscommand: false
      name: delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 1d237b45-c722-4a51-84d8-617142169d11
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2340,
          "y": 185
        }
      }
  "196":
    continueonerrortype: ""
    id: "196"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Which IOC.Answers.0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5b816bad-58e2-4a81-8ec0-1518903bb4b6
      iscommand: false
      name: set new indicator Which IOC.Answers.0
      script: Set
      type: regular
      version: -1
    taskid: 5b816bad-58e2-4a81-8ec0-1518903bb4b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 100
        }
      }
  "197":
    continueonerrortype: ""
    id: "197"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators.Domain
      value:
        simple: xyz.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 37953b63-1636-405d-884f-f83b4ef5440b
      iscommand: false
      name: set new indicator BlockIOCF
      script: Set
      type: regular
      version: -1
    taskid: 37953b63-1636-405d-884f-f83b4ef5440b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2980,
          "y": 345
        }
      }
  "199":
    continueonerrortype: ""
    id: "199"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .tcs.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .ultimatix.net
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .google.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .microsoft.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .gstatic.com
          root: Domain3
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 05105060-6257-42cb-839d-f5cae5942e33
      iscommand: false
      name: check for trusted domain
      script: Set
      type: regular
      version: -1
    taskid: 05105060-6257-42cb-839d-f5cae5942e33
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2890,
          "y": -40
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "179_181_#default#": 0.53,
      "180_163_#default#": 0.45,
      "181_182_Email Only": 0.64,
      "186_165_Internet": 0.54
    },
    "paper": {
      "dimensions": {
        "height": 3405,
        "width": 3480,
        "x": -40,
        "y": -40
      }
    }
  }
