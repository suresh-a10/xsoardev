contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.8.0
    itemVersion: 1.2.2
    packID: CortexXpanse
    packName: Cortex Xpanse
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: Playbook that uses NMap to do a validation scan.
id: Xpanse - NMap - Detect Service
inputs:
- description: Remote IP address in the alert.
  key: RemoteIP
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: remoteip
      root: alert
- description: Remote port number in the alert.
  key: RemotePort
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: remoteport
      root: alert
- description: Scan number in case there are multiple IDs in the parent playbook.
  key: ScanNumber
  playbookInputQuery: null
  required: true
  value: {}
name: Xpanse - NMap - Detect Service
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 06574df5-dedf-45fe-8dac-ee83db5625c1
      iscommand: false
      name: ""
      version: -1
    taskid: 06574df5-dedf-45fe-8dac-ee83db5625c1
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": -160
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 95954e95-d689-4021-8953-1795c8f7aa60
      iscommand: false
      name: Complete
      type: title
      version: -1
    taskid: 95954e95-d689-4021-8953-1795c8f7aa60
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1180
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.RemoteIP
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.RemotePort
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if RemoteIp and RemotePort inputs are defined for error
        checking.
      id: 5e78366d-61bc-47fd-8142-e06ce4329e84
      iscommand: false
      name: Is RemoteIP and RemotePort defined?
      type: condition
      version: -1
    taskid: 5e78366d-61bc-47fd-8142-e06ce4329e84
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": -20
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      NMAPOptions:
        simple: -Pn --unprivileged
      RemoteIP:
        complex:
          root: inputs.RemoteIP
      RemotePort:
        complex:
          root: inputs.RemotePort
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: Sub-playbook that conducts a single port Nmap scan and returns
        the results to the parent playbook.
      id: 9133fc17-e865-4ddf-8506-ef80c6f02c5e
      iscommand: false
      name: NMAP - Single Port Scan
      playbookId: NMAP - Single Port Scan
      type: playbook
      version: -1
    taskid: 9133fc17-e865-4ddf-8506-ef80c6f02c5e
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 450,
          "y": 370
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 959dfb81-aa8e-4723-86b8-d98aca555b26
      iscommand: false
      name: continue
      type: title
      version: -1
    taskid: 959dfb81-aa8e-4723-86b8-d98aca555b26
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -30,
          "y": 370
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fea55f84-4992-4c0c-8835-e0508fc603f3
      iscommand: false
      name: Set Field
      type: title
      version: -1
    taskid: fea55f84-4992-4c0c-8835-e0508fc603f3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 645
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpanseservicevalidation
      keys:
        simple: scannum,scandone,scanresult,timestamp,scanstate
      val1:
        complex:
          root: inputs.ScanNumber
      val2:
        complex:
          root: ScanDone
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: "null"
            operator: SetIfEmpty
      val3:
        complex:
          root: ScanResult
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: "null"
            operator: SetIfEmpty
      val4:
        complex:
          accessor: Started
          root: NMAP.Scan
          transformers:
          - operator: TimeStampToDate
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: "null"
            operator: SetIfEmpty
      val5:
        complex:
          accessor: State
          root: NMAP.Scan.Hosts.Services
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: "null"
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: d03b7e17-6b42-44f2-8d1b-1b905b810798
      iscommand: false
      name: Set service validation grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: d03b7e17-6b42-44f2-8d1b-1b905b810798
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 980
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      xpanseservicevalidation:
        simple: '{}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: c2707e61-23a4-42db-8fdb-b91914d9240c
      iscommand: true
      name: Set Xpanse service validation
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: c2707e61-23a4-42db-8fdb-b91914d9240c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 780
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1405,
        "width": 860,
        "x": -30,
        "y": -160
      }
    }
  }
