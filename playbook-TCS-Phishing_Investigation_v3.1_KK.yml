contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: |-
  Use this playbook to investigate and remediate a potential phishing incident. The playbook simultaneously engages with the user that triggered the incident, while investigating the incident itself.

  The final remediation tasks are always decided by a human analyst.
id: 673f6ed3-6759-4f4e-8836-306f5a09e6d8
inputs:
- description: The default role to assign the incident to.
  key: Role
  playbookInputQuery: null
  required: true
  value:
    simple: Administrator
- description: |-
    Enable the "Search and Delete" capability (can be either "True" or "False").
    In case of a malicious email, the "Search and Delete" sub-playbook will look for other instances of the email and delete them pending analyst approval.
  key: SearchAndDelete
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: |-
    Enable the "Block Indicators" capability (can be either "True" or "False").
    In case of a malicious email, the "Block Indicators" sub-playbook will block all malicious indicators in the relevant integrations.
  key: BlockIndicators
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Whether the authenticity of the email should be verified, using SPF,
    DKIM and DMARC.
  key: AuthenticateEmail
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
name: TCS-Phishing Investigation v3.1_KK
outputs: []
sourceplaybookid: Phishing Investigation - Generic v2
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 395c4ec2-8c26-4c3b-8072-37c1fd552464
      iscommand: false
      name: ""
      version: -1
    taskid: 395c4ec2-8c26-4c3b-8072-37c1fd552464
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 10,
          "y": -1320
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Name
          root: Domain
          transformers:
          - operator: uniq
      Email:
        complex:
          accessor: Email.Address
          root: Account
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 738d6cd9-edbd-45e2-8132-befd7b270e09
      iscommand: false
      name: Email Address Enrichment - Generic v2.1
      playbookId: Email Address Enrichment - Generic v2.1
      type: playbook
      version: -1
    taskid: 738d6cd9-edbd-45e2-8132-befd7b270e09
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 1720
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "118"
      - "119"
      - "196"
      - "203"
      - "204"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e0e6b2c0-d365-4cfe-8dae-9a6d440704f2
      iscommand: false
      name: Indicator Enrichment
      type: title
      version: -1
    taskid: e0e6b2c0-d365-4cfe-8dae-9a6d440704f2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -640,
          "y": 740
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "121"
      - "52"
    note: false
    quietmode: 2
    reputationcalc: 3
    scriptarguments:
      text:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Email.HTML
              operator: isNotEmpty
          root: Email.HTML
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 3bb53890-54c2-408f-8299-7cf1f02ec059
      iscommand: true
      name: Extract Indicators From Email Body
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 3bb53890-54c2-408f-8299-7cf1f02ec059
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -432.5,
          "y": 265
        }
      }
  "96":
    continueonerrortype: ""
    id: "96"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "120"
    note: false
    quietmode: 0
    scriptarguments:
      File:
        complex:
          root: File
      Interval:
        simple: "1"
      Timeout:
        simple: "15"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Detonate one or more files using the Wildfire integration. This playbook
        returns relevant reports to the War Room and file reputations to the context data.
        The detonation supports the following file types -
        APK, JAR, DOC, DOCX, RTF, XLS, XLSX, PPT, PPTX, OOXML, PE32, PDF, DMG, PKG, RAR, 7Z
      id: c1e6494e-87b2-4774-8d7a-ad5480496814
      iscommand: false
      name: TCS-Detonate File v2.1
      playbookId: d3596cd5-648f-40d2-8cc9-5829b6672242
      type: playbook
      version: -1
    taskid: c1e6494e-87b2-4774-8d7a-ad5480496814
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1455
        }
      }
  "102":
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "219"
      "yes":
      - "137"
      - "122"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the investigation found any malicious indicators (file,
        URL, IP address, domain, or email). Returns "yes" if at least one malicious
        indicator is found.
      id: cc03ee13-7c6a-469d-8005-9845ec56ba3a
      iscommand: false
      name: Are Indicators Malicious
      script: IsMaliciousIndicatorFound
      type: condition
      version: -1
    taskid: cc03ee13-7c6a-469d-8005-9845ec56ba3a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -442.5,
          "y": 1480
        }
      }
  "104":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: File
                root: Attachment
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "129"
      "yes":
      - "107"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bf7f1e3d-d220-43ab-88c1-66ed0d452292
      iscommand: false
      name: Is There an Attachment in The Email ?
      type: condition
      version: -1
    taskid: bf7f1e3d-d220-43ab-88c1-66ed0d452292
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 620
        }
      }
  "107":
    continueonerrortype: ""
    id: "107"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "108"
      - "114"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      file:
        complex:
          accessor: SHA256
          root: Attachment.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a file.
      id: 08ac1094-0b2a-4812-8ef6-e1d005bc1677
      iscommand: true
      name: Check Attachment Risk Score In Recorded Future
      script: Recorded Future v2|||file
      type: regular
      version: -1
    taskid: 08ac1094-0b2a-4812-8ef6-e1d005bc1677
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 840
        }
      }
  "108":
    continueonerrortype: ""
    id: "108"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "112"
      "no":
      - "96"
      "yes":
      - "127"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the investigation found any malicious indicators (file,
        URL, IP address, domain, or email). Returns "yes" if at least one malicious
        indicator is found.
      id: b6afa664-3a71-4ebb-80bc-1b6e631a5060
      iscommand: false
      name: Attachment Found Malicious ?
      script: IsMaliciousIndicatorFound
      type: condition
      version: -1
    taskid: b6afa664-3a71-4ebb-80bc-1b6e631a5060
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1190
        }
      }
  "110":
    continueonerrortype: ""
    id: "110"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "111"
    note: false
    quietmode: 0
    scriptarguments:
      hash:
        complex:
          accessor: SHA256
          root: WildFire.Report
    separatecontext: false
    skipunavailable: false
    task:
      brand: WildFire-v2
      description: Returns a verdict for a hash.
      id: ef313c02-c618-47e1-85e9-90453cec1c60
      iscommand: true
      name: Get WildFire Report Verdict
      script: WildFire-v2|||wildfire-get-verdict
      type: regular
      version: -1
    taskid: ef313c02-c618-47e1-85e9-90453cec1c60
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1850
        }
      }
  "111":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: VerdictDescription
                root: WildFire.Verdicts
          operator: isEqualString
          right:
            value:
              simple: benign
      label: Benign
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: VerdictDescription
                root: WildFire.Verdicts
          operator: isEqualString
          right:
            value:
              simple: malicious
      label: Malicious
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "112"
      Benign:
      - "170"
      Malicious:
      - "125"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b1edabbf-f857-4605-8f74-73b5341fd481
      iscommand: false
      name: Is The WildFire Report Verdict Benign or Malicious?
      type: condition
      version: -1
    taskid: b1edabbf-f857-4605-8f74-73b5341fd481
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 470,
          "y": 2105
        }
      }
  "112":
    continueonerrortype: ""
    id: "112"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "145"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d40c9892-faef-46fb-8449-014bbaaac3d4
      iscommand: false
      name: Generate Report & Notify
      type: title
      version: -1
    taskid: d40c9892-faef-46fb-8449-014bbaaac3d4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 890,
          "y": 2480
        }
      }
  "113":
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "170"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          Hello Human,

          I found a suspicious email reported by user - ${incident.labels.Email/from}

          Following are the investigation findings:

          Suspicious Email Sent By: ${Email.From}

          Email subject: ${Email.Subject}

          Malicious attachment hash: ${Malicious.Attachment}

          XSOAR investigation Id : ${incident.id}


          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: kunal.krushev@tcs.com,prashant.matle@tcs.com,yogesh.gholap@tcs.com
      subject:
        simple: Found Suspicious Email Reported By User - ${incident.labels.Email/from}
      to:
        simple: internalis.cybersecurityops@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 13462aa2-0e0a-45fa-89e1-89fb44b964c8
      iscommand: true
      name: Notify Suspicious Email With Attachment
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 13462aa2-0e0a-45fa-89e1-89fb44b964c8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3210
        }
      }
  "114":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.File
          operator: greaterThan
          right:
            value:
              simple: "24"
      label: "yes"
    continueonerrortype: ""
    id: "114"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "108"
      "yes":
      - "126"
      - "140"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the investigation found any malicious indicators (file,
        URL, IP address, domain, or email). Returns "yes" if at least one malicious
        indicator is found.
      id: 85a4be5b-a169-414f-8d55-3418bf2a150e
      iscommand: false
      name: Is Risk Score Greater Than 24 ?
      type: condition
      version: -1
    taskid: 85a4be5b-a169-414f-8d55-3418bf2a150e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1020
        }
      }
  "117":
    continueonerrortype: ""
    id: "117"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "170"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          Hello Human,

          I found a suspicious email reported by user - ${incident.labels.Email/from}

          Following are the investigation findings:

          Suspicious Email Sent By: ${Email.From}

          Email subject: ${Email.Subject}

          Malicious IOC: ${Malicious.IOC}

          XSOAR investigation Id : ${incident.id}

          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: kunal.krushev@tcs.com,prashant.matle@tcs.com,yogesh.gholap@tcs.com
      subject:
        simple: Found Suspicious Email Reported By User - ${incident.labels.Email/from}
      to:
        simple: internalis.cybersecurityops@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 0de71b5d-dace-4be5-8b04-cf202394f2a8
      iscommand: true
      name: Notify Suspicious Email Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 0de71b5d-dace-4be5-8b04-cf202394f2a8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 280,
          "y": 3210
        }
      }
  "118":
    continueonerror: true
    continueonerrortype: ""
    id: "118"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: OpenPhish_v2
      description: Checks the reputation of a URL.
      id: b55700e9-26d5-44f6-8feb-c04ca98ef273
      iscommand: true
      name: Check if Known Phishing URL Using OpenPhish Data
      script: OpenPhish_v2|||url
      type: regular
      version: -1
    taskid: b55700e9-26d5-44f6-8feb-c04ca98ef273
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -442.5,
          "y": 1120
        }
      }
  "119":
    continueonerror: true
    continueonerrortype: ""
    id: "119"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: PhishTank V2
      description: Checks the reputation of the supplied URLs.
      id: 96a00348-5e77-455f-8b22-d4486bff8a3a
      iscommand: true
      name: Check if Known  Phishing URL Using PhishTank Data
      script: PhishTank V2|||url
      type: regular
      version: -1
    taskid: 96a00348-5e77-455f-8b22-d4486bff8a3a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -850,
          "y": 1120
        }
      }
  "120":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: SHA256
                root: WildFire.Report
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "112"
      "yes":
      - "110"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: de79c7ba-83d1-47ce-8d3a-044b3d29644a
      iscommand: false
      name: Is There a WildFire Report?
      type: condition
      version: -1
    taskid: de79c7ba-83d1-47ce-8d3a-044b3d29644a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1640
        }
      }
  "121":
    continueonerror: true
    continueonerrortype: ""
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "200"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      confidenceThreshold:
        simple: "0"
      emailBodyHTML:
        simple: ${Email.HTML}
      emailSubject:
        simple: ${Email.Subject}
      retry-count:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Predict phishing incidents using the out-of-the-box pre-trained
        model.
      id: d6972b57-8d52-4c05-8b42-519728892593
      iscommand: false
      name: DBot Predict Phishing
      script: DBotPredictOutOfTheBoxV2
      type: regular
      version: -1
    taskid: d6972b57-8d52-4c05-8b42-519728892593
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -432.5,
          "y": 445
        }
      }
  "122":
    continueonerrortype: ""
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Malicious.IOC
      value:
        complex:
          accessor: Indicator
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: isEqualString
              right:
                value:
                  simple: "3"
          root: DBotScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 373f2944-8c16-4cca-8213-cdd9a790439c
      iscommand: false
      name: Set Context Key For Malicious IOC
      script: Set
      type: regular
      version: -1
    taskid: 373f2944-8c16-4cca-8213-cdd9a790439c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 1710
        }
      }
  "123":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOC
                root: Malicious
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Attachment
                root: Malicious
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "123"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "170"
      "yes":
      - "124"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fd2b5823-6b99-4ecb-80bd-92f9c0eba7a4
      iscommand: false
      name: Check If Malicious Indicators Were Detected  In Email Body & Attachment
        Is Malicious
      type: condition
      version: -1
    taskid: fd2b5823-6b99-4ecb-80bd-92f9c0eba7a4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 3000
        }
      }
  "124":
    continueonerrortype: ""
    id: "124"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "170"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          Hello Human,

          I found a suspicious email reported by user - ${incident.labels.Email/from}

          Following are the investigation findings:

          Suspicious Email Sent By: ${Email.From}

          Email subject: ${Email.Subject}

          Malicious attachment hash: ${Malicious.Attachment}

          Malicious IOCs found in the email body: ${Malicious.IOC}

          XSOAR investigation Id : ${incident.id}


          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: kunal.krushev@tcs.com,prashant.matle@tcs.com,yogesh.gholap@tcs.com
      subject:
        simple: Found Suspicious Email Reported By User - ${incident.labels.Email/from}
      to:
        simple: internalis.cybersecurityops@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: fa6b4541-1cac-4855-8d3d-22d68410d87c
      iscommand: true
      name: Notify Suspicious Email With Attachment
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: fa6b4541-1cac-4855-8d3d-22d68410d87c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1360,
          "y": 3220
        }
      }
  "125":
    continueonerrortype: ""
    id: "125"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Malicious.Attachment
      value:
        complex:
          accessor: SHA256
          filters:
          - - left:
                iscontext: true
                value:
                  simple: WildFire.Verdicts.VerdictDescription
              operator: isNotEqualString
              right:
                value:
                  simple: benign
          root: WildFire.Verdicts
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c29a3711-4431-4ade-83d3-70ce85e1fbee
      iscommand: false
      name: Set Context Key For Malicious Attachment Hash
      script: Set
      type: regular
      version: -1
    taskid: c29a3711-4431-4ade-83d3-70ce85e1fbee
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 2300
        }
      }
  "126":
    continueonerrortype: ""
    id: "126"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Malicious.Attachment
      value:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.File.riskScore
              operator: greaterThan
              right:
                value:
                  simple: "24"
          root: RecordedFuture.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2e7142b4-2cea-44f0-8c34-ef0f6dd0e433
      iscommand: false
      name: Set Context Key For Malicious Attachment
      script: Set
      type: regular
      version: -1
    taskid: 2e7142b4-2cea-44f0-8c34-ef0f6dd0e433
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 1455
        }
      }
  "127":
    continueonerrortype: ""
    id: "127"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Malicious.Attachment
      value:
        complex:
          accessor: Indicator
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: isEqualString
              right:
                value:
                  simple: "3"
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Vendor
              operator: isEqualString
              right:
                value:
                  simple: Recorded Future v2
          root: DBotScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: fcfd4d48-5d31-4536-8fae-98e014613a5a
      iscommand: false
      name: Set Context Key For Malicious Attachment
      script: Set
      type: regular
      version: -1
    taskid: fcfd4d48-5d31-4536-8fae-98e014613a5a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": 1455
        }
      }
  "128":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Attachment
                root: Malicious
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOC
                root: Malicious
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "128"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "170"
      "yes":
      - "117"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 55bc9222-07e5-443b-8958-12fd28f22eb1
      iscommand: false
      name: Check If Only Malicious IOCs Were Detected  In Email Body
      type: condition
      version: -1
    taskid: 55bc9222-07e5-443b-8958-12fd28f22eb1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 270,
          "y": 2940
        }
      }
  "129":
    continueonerrortype: ""
    id: "129"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "102"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e37153ac-9076-497c-8320-dda30668328e
      iscommand: false
      name: Check If Indicator Is Malicious
      type: title
      version: -1
    taskid: e37153ac-9076-497c-8320-dda30668328e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -442.5,
          "y": 1360
        }
      }
  "130":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Attachment
                root: Malicious
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOC
                root: Malicious
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "130"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "170"
      "yes":
      - "113"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c9d460a0-d693-4fe6-8977-f83a29dd129b
      iscommand: false
      name: Check If Only  Malicious Attachments Found
      type: condition
      version: -1
    taskid: c9d460a0-d693-4fe6-8977-f83a29dd129b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 920,
          "y": 3000
        }
      }
  "131":
    continueonerrortype: ""
    id: "131"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "195"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fb294746-f2fb-406a-8691-1d5032e87882
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
    taskid: fb294746-f2fb-406a-8691-1d5032e87882
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -470,
          "y": 2615
        }
      }
  "132":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Label
                root: DBotPredictPhishingWords
          operator: isEqualString
          right:
            value:
              simple: malicious
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOC
                root: Malicious
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Attachment
                root: Malicious
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "132"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "170"
      "yes":
      - "133"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 78966c45-9a0b-4c93-86f9-8f7b37281fd0
      iscommand: false
      name: Check If malicious content detected, Malicious Indicators Were Detected  In
        Email Body & Attachment Is Malicious
      type: condition
      version: -1
    taskid: 78966c45-9a0b-4c93-86f9-8f7b37281fd0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1810,
          "y": 3000
        }
      }
  "133":
    continueonerrortype: ""
    id: "133"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "170"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          Hello Human,

          My machine learning algorithm  found a suspected malicious email reported by user - ${incident.labels.Email/from}

          Following are the investigation findings:

          Suspicious Email Sent By: ${Email.From}

          Email subject: ${Email.Subject}

          XSOAR investigation Id : ${incident.id}


          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: kunal.krushev@tcs.com,prashant.matle@tcs.com,yogesh.gholap@tcs.com
      subject:
        simple: Found Suspicious Email Reported By User - ${incident.labels.Email/from}
      to:
        simple: internalis.cybersecurityops@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 2a9d2751-a477-42b8-816f-64b4cde64687
      iscommand: true
      name: Notify Suspicious Email With Attachment
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 2a9d2751-a477-42b8-816f-64b4cde64687
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 3210
        }
      }
  "134":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: AttachmentNames
                root: Email
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: AttachmentNames
                root: Email
          operator: isNotEmpty
      label: "Yes"
    continueonerrortype: ""
    id: "134"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "129"
      "Yes":
      - "135"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 64c6ca57-a036-4e32-83b7-16e858a08cc4
      iscommand: false
      name: 'Is There an Attachment In The Reported Email ? '
      type: condition
      version: -1
    taskid: 64c6ca57-a036-4e32-83b7-16e858a08cc4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 470,
          "y": 70
        }
      }
  "135":
    continueonerrortype: ""
    id: "135"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "104"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Attachment.File
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Info
              operator: notContainsGeneral
              right:
                value:
                  simple: msg,eml
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isNotEqualString
              right:
                value:
                  simple: email.png
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: be1580d2-317d-4a60-8331-52d11635b1b1
      iscommand: false
      name: Set Attachment Info To Context Field
      script: Set
      type: regular
      version: -1
    taskid: be1580d2-317d-4a60-8331-52d11635b1b1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 445
        }
      }
  "136":
    continueonerrortype: ""
    id: "136"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "215"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "1"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 6b20b76a-1de4-431f-89d3-cdcd1fee6689
      iscommand: true
      name: Set Incident Severity Low
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6b20b76a-1de4-431f-89d3-cdcd1fee6689
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -582.5,
          "y": -1180
        }
      }
  "137":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Score
                root: DBotScore
          operator: isEqualNumber
          right:
            value:
              simple: "2"
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: DBotScore.Score
                    operator: isEqualString
                    right:
                      value:
                        simple: "3"
                root: DBotScore.Score
          operator: isNotExists
      label: High
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Score
                root: DBotScore
          operator: isEqualNumber
          right:
            value:
              simple: "3"
      label: Critical
    continueonerrortype: ""
    id: "137"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "112"
      Critical:
      - "144"
      High:
      - "139"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      id: 5d35dfd6-dd57-42ba-86a6-5e696b92fbfe
      iscommand: false
      name: 'Check Risk Score To Set Severity '
      type: condition
      version: -1
    taskid: 5d35dfd6-dd57-42ba-86a6-5e696b92fbfe
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -732.5,
          "y": 1735
        }
      }
  "139":
    continueonerrortype: ""
    id: "139"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "3"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f3633aa9-60a0-47fc-8386-489d6c709f54
      iscommand: true
      name: Set Severity High
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f3633aa9-60a0-47fc-8386-489d6c709f54
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -992.5,
          "y": 1925
        }
      }
  "140":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.File
          operator: greaterThan
          right:
            value:
              simple: "24"
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.File
          operator: lessThan
          right:
            value:
              simple: "65"
      label: Medium
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.File
          operator: greaterThan
          right:
            value:
              simple: "65"
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.File
          operator: lessThan
          right:
            value:
              simple: "90"
      label: High
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.File
          operator: greaterThan
          right:
            value:
              simple: "89"
      label: Critical
    continueonerrortype: ""
    id: "140"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "112"
      Critical:
      - "142"
      High:
      - "141"
      Medium:
      - "143"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      id: 8d735e40-8f75-4cc7-8011-778297f55596
      iscommand: false
      name: 'Check DBot Indicator Score To Set Severity '
      type: condition
      version: -1
    taskid: 8d735e40-8f75-4cc7-8011-778297f55596
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 1060
        }
      }
  "141":
    continueonerrortype: ""
    id: "141"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "3"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: a2c9f951-ceb0-4bbe-8e41-a679f1d09ca2
      iscommand: true
      name: Set Severity High
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: a2c9f951-ceb0-4bbe-8e41-a679f1d09ca2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 1230
        }
      }
  "142":
    continueonerrortype: ""
    id: "142"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "4"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: de78e78b-f2a1-44ea-8dff-1242d2bf1556
      iscommand: true
      name: Set Severity Critical
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: de78e78b-f2a1-44ea-8dff-1242d2bf1556
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1760,
          "y": 1230
        }
      }
  "143":
    continueonerrortype: ""
    id: "143"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 5b287a35-5b4d-4a08-8ed6-f1720df4f172
      iscommand: true
      name: Set Severity Medium
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 5b287a35-5b4d-4a08-8ed6-f1720df4f172
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1230
        }
      }
  "144":
    continueonerrortype: ""
    id: "144"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "4"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: e031c6ce-3ab5-4018-822f-3b45bd0329fb
      iscommand: true
      name: Set Severity Critical
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: e031c6ce-3ab5-4018-822f-3b45bd0329fb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -470,
          "y": 1925
        }
      }
  "145":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: EntryID
                root: InfoFile
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "145"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "128"
      - "130"
      - "123"
      - "132"
      "yes":
      - "146"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6d52387d-e787-4684-8657-8d1c74aad5a5
      iscommand: false
      name: Check If InfoFile Context Is Set ?
      type: condition
      version: -1
    taskid: 6d52387d-e787-4684-8657-8d1c74aad5a5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 890,
          "y": 2570
        }
      }
  "146":
    continueonerrortype: ""
    id: "146"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "128"
      - "130"
      - "123"
      - "132"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: File
      value:
        complex:
          root: InfoFile
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4dfe6afc-6e7c-4a99-8a71-c542a6017a32
      iscommand: false
      name: Combine InfoFile & File Context
      script: Set
      type: regular
      version: -1
    taskid: 4dfe6afc-6e7c-4a99-8a71-c542a6017a32
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2770
        }
      }
  "147":
    continueonerror: true
    continueonerrortype: ""
    id: "147"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "148"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 45b14e9a-6ecb-419f-8a9b-72e638acdc31
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 45b14e9a-6ecb-419f-8a9b-72e638acdc31
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -470,
          "y": 3145
        }
      }
  "148":
    continueonerrortype: ""
    id: "148"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7d5f6709-d75c-498e-8059-6ddbc126d913
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 7d5f6709-d75c-498e-8059-6ddbc126d913
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -470,
          "y": 3475
        }
      }
  "149":
    continueonerrortype: ""
    id: "149"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "152"
      - "52"
    note: false
    quietmode: 2
    reputationcalc: 3
    scriptarguments:
      text:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Email.Text
              operator: isNotEmpty
          root: Email.Text
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 6665dba5-1fd3-433c-8e4d-c374664acb52
      iscommand: true
      name: Extract Indicators From Email Body
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 6665dba5-1fd3-433c-8e4d-c374664acb52
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -892.5,
          "y": 265
        }
      }
  "150":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: HTML
                root: Email
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "150"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "52"
      "yes":
      - "92"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2a27954d-7569-4a39-8f63-ddb36f05e187
      iscommand: false
      name: Is There A Email HTML
      type: condition
      version: -1
    taskid: 2a27954d-7569-4a39-8f63-ddb36f05e187
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -442.5,
          "y": 70
        }
      }
  "151":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Text
                root: Email
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "151"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "150"
      "yes":
      - "149"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9bd29b4c-f953-48bd-8573-1fc79e2e2e9c
      iscommand: false
      name: 'Is There A Email Text '
      type: condition
      version: -1
    taskid: 9bd29b4c-f953-48bd-8573-1fc79e2e2e9c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -790,
          "y": -360
        }
      }
  "152":
    continueonerror: true
    continueonerrortype: ""
    id: "152"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "201"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      confidenceThreshold:
        simple: "0"
      emailBody:
        simple: ${Email.Text}
      emailSubject:
        simple: ${Email.Subject}
      retry-count:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Predict phishing incidents using the out-of-the-box pre-trained
        model.
      id: 062779f6-6aaa-4839-8d0c-441fde106281
      iscommand: false
      name: DBot Predict Phishing
      script: DBotPredictOutOfTheBoxV2
      type: regular
      version: -1
    taskid: 062779f6-6aaa-4839-8d0c-441fde106281
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -892.5,
          "y": 445
        }
      }
  "154":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: containsGeneral
          right:
            value:
              simple: '@tcs.com'
        - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: containsGeneral
          right:
            value:
              simple: '@tataquelaunch.com'
        - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: containsGeneral
          right:
            value:
              simple: '@medibuddy.app'
        - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: containsGeneral
          right:
            value:
              simple: '@medibuddy.in'
        - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: isEqualString
          right:
            value:
              simple: '@ihcltata.com'
        - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: isEqualString
          right:
            value:
              simple: '@seleqtionshotels.com'
        - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: isEqualString
          right:
            value:
              simple: '@tajhotels.com'
        - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: isEqualString
          right:
            value:
              simple: '@mail.gingerhotels.com'
        - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: isEqualString
          right:
            value:
              simple: '@mbcare.in'
        - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: isEqualString
          right:
            value:
              simple: '@mediassist.in'
      label: "yes"
    continueonerrortype: ""
    id: "154"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "151"
      - "134"
      "yes":
      - "131"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9044256e-12f9-4efd-8ed9-6a060a86473e
      iscommand: false
      name: Original Mail Sender From TCS/ Customer Domain ?
      type: condition
      version: -1
    taskid: 9044256e-12f9-4efd-8ed9-6a060a86473e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -50,
          "y": -540
        }
      }
  "155":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: manual
      label: Manual
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: rawType
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: malware investigation
      label: From Malware Investigation Playbook
    continueonerrortype: ""
    id: "155"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "136"
      From Malware Investigation Playbook:
      - "216"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7f6174e2-8937-4ef7-8b34-f33b286f2661
      iscommand: false
      name: Manual or Tool Triggered ?
      type: condition
      version: -1
    taskid: 7f6174e2-8937-4ef7-8b34-f33b286f2661
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 10,
          "y": -1190
        }
      }
  "156":
    continueonerror: true
    continueonerrortype: ""
    id: "156"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "157"
    note: false
    quietmode: 0
    scriptarguments:
      name:
        simple: AutoAssignment_Lock
      timeout:
        simple: "600"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Demisto Lock
      description: Gets a specific lock. If the lock doesn't exist, it creates one.
        If the lock is already in use, the command waits until the lock is released
        or until timeout is reached. If timeout is reached and the lock hasn't been
        released, the command fails to get the lock.
      id: adaf6630-daab-4310-8ce8-7a736cf79855
      iscommand: true
      name: Locking the Assignment Task
      script: Demisto Lock|||demisto-lock-get
      type: regular
      version: -1
    taskid: adaf6630-daab-4310-8ce8-7a736cf79855
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 3740
        }
      }
  "157":
    continueonerrortype: ""
    id: "157"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "158"
    note: false
    quietmode: 0
    scriptarguments:
      desc:
        complex:
          accessor: name
          root: incident
      incidentid:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 74886048-9531-49f9-8a9c-a06cb555e9dc
      iscommand: false
      name: AutoAssign Analyst To Incident
      script: 0021cb92-321d-4754-81a1-66fc6a41635d
      type: regular
      version: -1
    taskid: 74886048-9531-49f9-8a9c-a06cb555e9dc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 3900
        }
      }
  "158":
    continueonerrortype: ""
    id: "158"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "186"
    note: false
    quietmode: 0
    scriptarguments:
      name:
        simple: AutoAssignment_Lock
    separatecontext: false
    skipunavailable: false
    task:
      brand: Demisto Lock
      description: Release a lock
      id: dc3f9137-8751-4f9c-8f4c-6925d66ea196
      iscommand: true
      name: Release the Assignment Task
      script: Demisto Lock|||demisto-lock-release
      type: regular
      version: -1
    taskid: dc3f9137-8751-4f9c-8f4c-6925d66ea196
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 4050
        }
      }
  "159":
    continueonerrortype: ""
    id: "159"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Expose the incident owner into IncidentOwner context key
      id: 0dfdc0b1-b2e2-4f9e-8c8a-7d958662561b
      iscommand: false
      name: Populate Incident Owner Context
      script: ExposeIncidentOwner
      type: regular
      version: -1
    taskid: 0dfdc0b1-b2e2-4f9e-8c8a-7d958662561b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1120,
          "y": 3935
        }
      }
  "160":
    continueonerrortype: ""
    id: "160"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "185"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: edff7f33-1595-4b0e-8aa7-8ce2be29f244
      iscommand: false
      name: Start Acknowledgement, Detection and Closure  SLA
      type: title
      version: -1
    taskid: edff7f33-1595-4b0e-8aa7-8ce2be29f244
    timertriggers:
    - action: start
      fieldname: responsesla
    - action: start
      fieldname: acknowledgementsla
    - action: start
      fieldname: detectionsla
    - action: start
      fieldname: closuresla
    type: title
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 4360
        }
      }
  "161":
    continueonerrortype: ""
    id: "161"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      roles:
        complex:
          accessor: demisto
          root: IncidentOwner.roles
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 575335e5-5fff-4465-8a6d-764e2ed4da32
      iscommand: true
      name: Set Investigator Role In Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 575335e5-5fff-4465-8a6d-764e2ed4da32
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 940,
          "y": 4240
        }
      }
  "162":
    continueonerrortype: ""
    id: "162"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "163"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 24c02845-0b53-49e4-89fa-bbd9736f0e9b
      iscommand: false
      name: Set Severity
      type: title
      version: -1
    taskid: 24c02845-0b53-49e4-89fa-bbd9736f0e9b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 4610
        }
      }
  "163":
    continueonerrortype: ""
    id: "163"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "164"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: OrignalSeverity
      value:
        simple: ${incident.severity}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e3fb9af1-c922-4647-8114-b62d05ffde81
      iscommand: false
      name: Set Orignal Severity to Context
      script: Set
      type: regular
      version: -1
    taskid: e3fb9af1-c922-4647-8114-b62d05ffde81
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 4725
        }
      }
  "164":
    continueonerrortype: ""
    id: "164"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "165"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "0.5"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 5363449a-1aab-4413-8d96-a4e0e052e60e
      iscommand: true
      name: Set Severity to Informational
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 5363449a-1aab-4413-8d96-a4e0e052e60e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 4870
        }
      }
  "165":
    continueonerrortype: ""
    id: "165"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "166"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: ${OrignalSeverity}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: b8523d2a-be15-4b73-80bc-cfe2d3f85a99
      iscommand: true
      name: 'Set Original Severity to Incident '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: b8523d2a-be15-4b73-80bc-cfe2d3f85a99
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 5020
        }
      }
  "166":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: runStatus
                root: incident.responsesla
          operator: isEqualString
          right:
            value:
              simple: running
      label: "yes"
    continueonerrortype: ""
    id: "166"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "168"
      "yes":
      - "167"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 372ab1ee-aeea-45d2-8028-319a918376c4
      iscommand: false
      name: Is Response SLA Still Running ?
      type: condition
      version: -1
    taskid: 372ab1ee-aeea-45d2-8028-319a918376c4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 5180
        }
      }
  "167":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Have You Completed This Task
        options: []
        optionsarg:
        - {}
        - simple: Yes - Move To The Next Task
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Please Click The 'Lets Get Started!' Button
      totalanswers: 0
    id: "167"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "168"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 29ad3235-f041-42e4-85d4-8d9e19a6b84b
      iscommand: false
      name: Please Click The 'Lets Get Started!' Button
      type: collection
      version: -1
    taskid: 29ad3235-f041-42e4-85d4-8d9e19a6b84b
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 5320
        }
      }
  "168":
    continueonerrortype: ""
    id: "168"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "205"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 31555e51-22b0-4bb1-8ce3-3bb99573bba2
      iscommand: false
      name: Stop Acknowledgement and Response SLA
      type: title
      version: -1
    taskid: 31555e51-22b0-4bb1-8ce3-3bb99573bba2
    timertriggers:
    - action: stop
      fieldname: responsesla
    - action: stop
      fieldname: acknowledgementsla
    type: title
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 5470
        }
      }
  "170":
    continueonerrortype: ""
    id: "170"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "207"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3d7cc6bf-258d-4e77-8300-8b44c8722125
      iscommand: false
      name: Assign to analyst
      type: title
      version: -1
    taskid: 3d7cc6bf-258d-4e77-8300-8b44c8722125
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1730,
          "y": 3475
        }
      }
  "171":
    continueonerrortype: ""
    form:
      description: Was There Any Impact ?? (Data Collection , Communication to a C&C
        , Malware installation )
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: anyimpact
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Was There Any Impact ?? (Data Collection , Communication to a C&C
            , Malware installation )
        options: []
        optionsarg:
        - {}
        - simple: "No"
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Was There Any Impact ?? (Data Collection , Communication to a C&C , Malware
        installation )
      totalanswers: 0
    id: "171"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Was There Any Impact ?? (Data Collection , Communication to a C&C
          , Malware installation )
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "191"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 563d5b13-f732-45ba-82f8-9203a545e949
      iscommand: false
      name: Was There Any Impact ?? (Data Collection , Communication to a C&C , Malware
        installation )
      type: collection
      version: -1
    taskid: 563d5b13-f732-45ba-82f8-9203a545e949
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1920,
          "y": 6240
        }
      }
  "172":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: emailbody
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter Notification Message To CSOC Manager (give a brief about the
            true positive alert and the impact)
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: ""
      title: Enter Notification Message To CSOC Manager
      totalanswers: 0
    id: "172"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "173"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 487b6e38-4697-440e-84d1-f3e6a98fa186
      iscommand: false
      name: Enter Notification Message To CSOC Manager (give a brief about the true
        positive alert and the impact)
      type: collection
      version: -1
    taskid: 487b6e38-4697-440e-84d1-f3e6a98fa186
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 2220,
          "y": 6525
        }
      }
  "173":
    continueonerrortype: ""
    id: "173"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "174"
    note: false
    quietmode: 2
    scriptarguments:
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          ${incident.emailbody}

          Investigation Link --> https://soar.tcsapps.com/#/Custom/caseinfoid/${incident.id}
      cc:
        simple: ${UserByUsername.email}
      subject:
        simple: '*True Positive Notification* Phishing Investigation - Severity -
          ${incident.mailerseverity}'
      to:
        simple: nimisha.prajapati@tcs.com,yogesh.gholap@tcs.com,
      using:
        simple: Mail Sender_instance_CSOC_Mail
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 3c57bb8a-17b8-4fdf-855e-373f2693b870
      iscommand: true
      name: Notify CSOC Manager & Necessary Stakeholders
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 3c57bb8a-17b8-4fdf-855e-373f2693b870
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2220,
          "y": 6650
        }
      }
  "174":
    continueonerrortype: ""
    id: "174"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Do you want to block external IP?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - No - They Are Already Blocked
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      No - They Are Already Blocked:
      - "188"
      "Yes":
      - "175"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b8559556-20c5-40d4-89af-4037bb0eb3f0
      iscommand: false
      name: Any IoCs You'd Like To Block ?
      tags:
      - report
      type: condition
      version: -1
    taskid: b8559556-20c5-40d4-89af-4037bb0eb3f0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1920,
          "y": 6810
        }
      }
  "175":
    continueonerrortype: ""
    id: "175"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "176"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fc6515c4-8f34-4f79-897d-8b98be742129
      iscommand: false
      name: TCS-Select IOC To Block_CM Playbook v1_KK
      playbookId: 9dacaaf8-64e7-4758-822e-694b991ee19c
      type: playbook
      version: -1
    taskid: fc6515c4-8f34-4f79-897d-8b98be742129
    timertriggers:
    - action: start
      fieldname: mitigationsla
    type: playbook
    view: |-
      {
        "position": {
          "x": 2180,
          "y": 6960
        }
      }
  "176":
    continueonerrortype: ""
    id: "176"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "188"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 848de769-3dc8-44db-847a-f0edb85c6aa5
      iscommand: false
      name: TCS-Block-CyberSOC Shared IOC v1_KK
      playbookId: 00a90bfa-b2f8-4ee1-8f6f-84824afdd3f2
      type: playbook
      version: -1
    taskid: 848de769-3dc8-44db-847a-f0edb85c6aa5
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2180,
          "y": 7090
        }
      }
  "177":
    continueonerrortype: ""
    id: "177"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 319c7e94-4eae-4281-8cf8-2145cc0399f7
      iscommand: false
      name: Document & Close Investigation
      type: title
      version: -1
    taskid: 319c7e94-4eae-4281-8cf8-2145cc0399f7
    timertriggers:
    - action: stop
      fieldname: threatresponsesla
    type: title
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 8000
        }
      }
  "178":
    continueonerrortype: ""
    id: "178"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "179"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ce6d6ae9-1562-4c2e-8617-108fc0a697d2
      iscommand: false
      name: TCS-Document & Close Section v1_KK
      playbookId: 4a46e3dc-82da-4b3a-86ca-eb2f9dfd589f
      type: playbook
      version: -1
    taskid: ce6d6ae9-1562-4c2e-8617-108fc0a697d2
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 8140
        }
      }
  "179":
    continueonerrortype: ""
    id: "179"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3dec0d52-1566-43f8-800a-3e97dfbc612b
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 3dec0d52-1566-43f8-800a-3e97dfbc612b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 8310
        }
      }
  "180":
    continueonerrortype: ""
    id: "180"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "181"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3ccde6bd-6f79-49bd-8523-14077beee131
      iscommand: false
      name: Stop Detection SLA - Benign True Positive
      type: title
      version: -1
    taskid: 3ccde6bd-6f79-49bd-8523-14077beee131
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 1360,
          "y": 6200
        }
      }
  "181":
    continueonerrortype: ""
    id: "181"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "177"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: Benign-True Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 7f91d8c0-4c25-4838-8f7b-6e1700e11846
      iscommand: true
      name: Set 'Investigation Conclusion' To Benign - True Positive
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 7f91d8c0-4c25-4838-8f7b-6e1700e11846
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1360,
          "y": 6400
        }
      }
  "182":
    continueonerrortype: ""
    id: "182"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Review Alert Info to decide whether it is Benign True positive alert
          or truepositive alert. (check email notification with this incident ID from
          BOT ).
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Benign - True Positive
      - True Positive
      - False Positive
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Benign - True Positive:
      - "180"
      False Positive:
      - "194"
      True Positive:
      - "184"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 18deba55-c698-47fe-87e5-7a87de242669
      iscommand: false
      name: Review Alert Info to decide whether it is Benign True positive alert or
        truepositive alert. (check email notification with this incident ID from BOT
        ).
      tags:
      - report
      type: condition
      version: -1
    taskid: 18deba55-c698-47fe-87e5-7a87de242669
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 5870
        }
      }
  "183":
    continueonerrortype: ""
    id: "183"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "171"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: True Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f5d193ff-c797-4da1-8bfd-9127b89403cf
      iscommand: true
      name: Set 'Investigation Conclusion' To True Positive
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f5d193ff-c797-4da1-8bfd-9127b89403cf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 6090
        }
      }
  "184":
    continueonerrortype: ""
    id: "184"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "183"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 55071aa9-8539-4a2b-8775-3bae7382d5b7
      iscommand: false
      name: Stop Detection SLA
      type: title
      version: -1
    taskid: 55071aa9-8539-4a2b-8775-3bae7382d5b7
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 5980
        }
      }
  "185":
    continueonerrortype: ""
    id: "185"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "162"
    note: false
    quietmode: 0
    scriptarguments:
      selectshift:
        complex:
          accessor: roles
          root: UserByUsername
          transformers:
          - args:
              from:
                value:
                  simple: '['
            operator: substringFrom
          - args:
              to:
                value:
                  simple: ']'
            operator: substringTo
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ' '
            operator: join
          - args:
              regex:
                value:
                  simple: ' CSOC-XSOAR-Admin'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Read-Only'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Operator'
              replaceWith: {}
            operator: replaceMatch
          - args:
              delimiter: {}
            operator: splitAndTrim
      shift:
        complex:
          accessor: roles
          root: UserByUsername
          transformers:
          - args:
              from:
                value:
                  simple: '['
            operator: substringFrom
          - args:
              to:
                value:
                  simple: ']'
            operator: substringTo
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ' '
            operator: join
          - args:
              regex:
                value:
                  simple: ' CSOC-XSOAR-Admin'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Read-Only'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Operator'
              replaceWith: {}
            operator: replaceMatch
          - args:
              delimiter: {}
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: db7d8abc-9b28-4744-85c9-671aeb4f2c94
      iscommand: true
      name: Set Investigator Role In Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: db7d8abc-9b28-4744-85c9-671aeb4f2c94
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 4460
        }
      }
  "186":
    continueonerrortype: ""
    id: "186"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "160"
    note: false
    quietmode: 0
    scriptarguments:
      username:
        complex:
          accessor: owner
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.get.user.by.username
      id: 382af58e-0cf8-46aa-887a-b0299491bcc9
      iscommand: true
      name: Get Incident Owner Details
      script: Builtin|||getUserByUsername
      type: regular
      version: -1
    taskid: 382af58e-0cf8-46aa-887a-b0299491bcc9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 4200
        }
      }
  "187":
    continueonerrortype: ""
    id: "187"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "177"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "No"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 4e4a85ae-ebf1-42dd-8985-22e735d569d4
      iscommand: true
      name: Update IMT Context To - No
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 4e4a85ae-ebf1-42dd-8985-22e735d569d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 7490
        }
      }
  "188":
    continueonerrortype: ""
    id: "188"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Review The Alert - Check If You Need To Raise an IMT ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No -  IMT Not Required
      - Yes - I Have Raised an IMT
      - I'm Not Sure - Will Do It later
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      No -  IMT Not Required:
      - "187"
      Yes - I Have Raised an IMT:
      - "189"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fb4d9cfe-d515-4d88-8835-43a50d0971bd
      iscommand: false
      name: Review The Alert - Check If You Need To Raise an IMT ?
      type: condition
      version: -1
    taskid: fb4d9cfe-d515-4d88-8835-43a50d0971bd
    timertriggers:
    - action: stop
      fieldname: threatresponsesla
    type: condition
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 7260
        }
      }
  "189":
    continueonerrortype: ""
    id: "189"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "190"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "Yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 30616abc-75f4-4aee-8fc0-742a3f20aa6f
      iscommand: true
      name: Update IMT Context To - Yes
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 30616abc-75f4-4aee-8fc0-742a3f20aa6f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 7480
        }
      }
  "190":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtnumber
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Number
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: ""
      title: Enter The IMT Number
      totalanswers: 0
    id: "190"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "208"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4c22f9ed-8a89-400f-827b-1dc860263d60
      iscommand: false
      name: Enter The IMT Number
      type: collection
      version: -1
    taskid: 4c22f9ed-8a89-400f-827b-1dc860263d60
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 7655
        }
      }
  "191":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: anyimpact
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    continueonerrortype: ""
    id: "191"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "174"
      "yes":
      - "172"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3217e937-88a9-44b9-8ba6-a412eb0be489
      iscommand: false
      name: If Impact is set to Yes
      type: condition
      version: -1
    taskid: 3217e937-88a9-44b9-8ba6-a412eb0be489
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1920,
          "y": 6390
        }
      }
  "193":
    continueonerrortype: ""
    id: "193"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "177"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 6226a643-3dfa-40f9-8ee9-2c1157b42c34
      iscommand: true
      name: Set 'Investigation Conclusion' To False Positive
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6226a643-3dfa-40f9-8ee9-2c1157b42c34
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 6400
        }
      }
  "194":
    continueonerrortype: ""
    id: "194"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "193"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b8eed6af-8bca-48af-8709-751f652c5cda
      iscommand: false
      name: Document & Close Investigation - False Positive
      type: title
      version: -1
    taskid: b8eed6af-8bca-48af-8709-751f652c5cda
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 870,
          "y": 6045
        }
      }
  "195":
    continueonerrortype: ""
    id: "195"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "147"
    note: false
    quietmode: 0
    scriptarguments:
      closingnote:
        simple: Autoclosed by Bot as there is nothing suspicious.
      investigationanalysis:
        simple: Autoclosed by Bot as there is nothing suspicious.
      investigationconclusion:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 197e0c02-19dc-4e56-81ab-c0206c58aa39
      iscommand: true
      name: Mandatory Field set to Context & REport Summary
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 197e0c02-19dc-4e56-81ab-c0206c58aa39
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -470,
          "y": 2785
        }
      }
  "196":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "196"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "129"
      "yes":
      - "197"
      - "198"
      - "217"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5b7bfebf-d4e5-47b9-8473-eb2accf465ad
      iscommand: false
      name: Is there a URL ?
      type: condition
      version: -1
    taskid: 5b7bfebf-d4e5-47b9-8473-eb2accf465ad
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1890,
          "y": 1020
        }
      }
  "197":
    continueonerror: true
    continueonerrortype: ""
    id: "197"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    scriptarguments:
      urls:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Predict phishing URLs using a pre-trained model.
      id: f470e5c4-c5f5-4f08-8ebd-4d5c9d10b65d
      iscommand: false
      name: Analyze via ML
      script: DBotPredictURLPhishing
      type: regular
      version: -1
    taskid: f470e5c4-c5f5-4f08-8ebd-4d5c9d10b65d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1720,
          "y": 1345
        }
      }
  "198":
    continueonerror: true
    continueonerrortype: ""
    id: "198"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    scriptarguments:
      urls:
        complex:
          accessor: URL
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Predict phishing URLs using a pre-trained model.
      id: 62db8cc4-f28b-4704-82a7-e9750f3cc2ce
      iscommand: false
      name: Analyze via ML
      script: DBotPredictURLPhishing
      type: regular
      version: -1
    taskid: 62db8cc4-f28b-4704-82a7-e9750f3cc2ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2110,
          "y": 1345
        }
      }
  "199":
    continueonerrortype: ""
    id: "199"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 116829ea-ffee-4bc4-855c-b32011ef9875
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 116829ea-ffee-4bc4-855c-b32011ef9875
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 580
        }
      }
  "200":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: DBotPredictPhishingWords.Label
          operator: isEqualString
          right:
            value:
              simple: malicious
      label: "yes"
    continueonerrortype: ""
    id: "200"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "129"
      "yes":
      - "112"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea33f012-a762-489d-89e4-d8940dbba7dd
      iscommand: false
      name: Is email content suspicious
      type: condition
      version: -1
    taskid: ea33f012-a762-489d-89e4-d8940dbba7dd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -432.5,
          "y": 630
        }
      }
  "201":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: DBotPredictPhishingWords.Label
          operator: isEqualString
          right:
            value:
              simple: malicious
      label: "yes"
    continueonerrortype: ""
    id: "201"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "129"
      "yes":
      - "112"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 00a1071a-4caa-4018-8cca-4bed76ea2b3a
      iscommand: false
      name: Is email content suspicious
      type: condition
      version: -1
    taskid: 00a1071a-4caa-4018-8cca-4bed76ea2b3a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -892.5,
          "y": 610
        }
      }
  "203":
    continueonerrortype: ""
    id: "203"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      Hash:
        complex:
          accessor: File
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      IP Address:
        complex:
          accessor: IP
          root: Address2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6d8390dd-ab90-4106-818f-7bcef051d08b
      iscommand: false
      name: TCS-Recorded Future IOC Enrichment Playbook v 1.1
      playbookId: 5aaa0bc6-781d-4216-8678-5830391bf6e2
      type: playbook
      version: -1
    taskid: 6d8390dd-ab90-4106-818f-7bcef051d08b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1282.5,
          "y": 1120
        }
      }
  "204":
    continueonerrortype: ""
    id: "204"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 58e7b2be-781a-4345-80b7-608e652f6815
      iscommand: false
      name: TCS-Cisco Umbrella  IOC Enrichment Playbook v 1.1
      playbookId: 0ac25229-526d-4fea-8888-a41e5e416ba2
      type: playbook
      version: -1
    taskid: 58e7b2be-781a-4345-80b7-608e652f6815
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -30,
          "y": 1120
        }
      }
  "205":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: whichslabreached
                root: incident
          operator: isEqualString
          right:
            value:
              simple: acknowledgementsla
        - left:
            iscontext: true
            value:
              complex:
                accessor: whichslabreached
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: acknowledgementsla
      label: "yes"
    continueonerrortype: ""
    id: "205"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "182"
      "yes":
      - "206"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fe60562b-8208-49cc-8397-c09b573c77b0
      iscommand: false
      name: Is response sla breached?
      type: condition
      version: -1
    taskid: fe60562b-8208-49cc-8397-c09b573c77b0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 5570
        }
      }
  "206":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: justificationforacknowledgementslabreached
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Provide justification for response sla violated
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: Your SOC team
      title: Provide justification for response sla violated
      totalanswers: 0
    id: "206"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Provide justification for response sla violated
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "210"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: d2a1e35d-cbce-4b4b-808c-f32026aee222
      iscommand: false
      name: Provide justification for response sla violated
      type: collection
      version: -1
    taskid: d2a1e35d-cbce-4b4b-808c-f32026aee222
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 2300,
          "y": 5610
        }
      }
  "207":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: owner
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "207"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "186"
      "yes":
      - "156"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0e207017-8224-46e6-89be-d541cf802842
      iscommand: false
      name: 'Check Whether Owner is Assigned or not '
      type: condition
      version: -1
    taskid: 0e207017-8224-46e6-89be-d541cf802842
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 3560
        }
      }
  "208":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtlocation
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Location
        options: []
        optionsarg: []
        placeholder: 'Enter Branch and Location.  Eg: TCS-Mumbai-Olympus'
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: Your SOC team
      title: Enter The IMT Location
      totalanswers: 0
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: ""
      headerfontcolor: ""
      isexternalrtl: false
      sender: ""
      submitbuttonbackgroundcolor: ""
      submitbuttonfontcolor: ""
      submittext: ""
    id: "208"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "177"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c84807ac-f03e-4202-8b8c-9f29ef8e6b30
      iscommand: false
      name: Enter The IMT Location
      type: collection
      version: -1
    taskid: c84807ac-f03e-4202-8b8c-9f29ef8e6b30
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 7820
        }
      }
  "210":
    continueonerrortype: ""
    id: "210"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "182"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: c5383288-c3a6-4dfa-8486-c2adf5976f36
      iscommand: false
      name: TCS-Triage-Case Management v3_KK
      playbookId: b82a6df1-9a17-4fae-889e-c6f7bde37df1
      type: playbook
      version: -1
    taskid: c5383288-c3a6-4dfa-8486-c2adf5976f36
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2300,
          "y": 5775
        }
      }
  "211":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtlocation
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Location
        options: []
        optionsarg: []
        placeholder: 'Enter Branch and Location.  Eg: TCS-Mumbai-Olympus'
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: Your SOC team
      title: Enter The IMT Location
      totalanswers: 0
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: ""
      headerfontcolor: ""
      isexternalrtl: false
      sender: ""
      submitbuttonbackgroundcolor: ""
      submitbuttonfontcolor: ""
      submittext: ""
    id: "211"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7a754e79-cd2e-4905-8446-b93659d06255
      iscommand: false
      name: Enter The IMT Location
      type: collection
      version: -1
    taskid: 7a754e79-cd2e-4905-8446-b93659d06255
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 3290,
          "y": 6950
        }
      }
  "212":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: emailfrom
                root: incident
          operator: containsString
          right:
            value:
              simple: sharepoint@micrasoft-office365.com
        - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: containsGeneral
          right:
            value:
              simple: sharepoint@micrasoft-office365.com
        - left:
            iscontext: true
            value:
              complex:
                accessor: emailfrom
                root: incident
          operator: containsString
          right:
            value:
              simple: performance.mgmtgrp@tcs.com
        - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: containsGeneral
          right:
            value:
              simple: performance.mgmtgrp@tcs.com
        - left:
            iscontext: true
            value:
              complex:
                accessor: emailfrom
                root: incident
          operator: containsString
          right:
            value:
              simple: Performance.Management@tcs.co
        - left:
            iscontext: true
            value:
              complex:
                accessor: emailfrom
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: Performance.Management@tcs.co
        - left:
            iscontext: true
            value:
              complex:
                accessor: emailfrom
                root: incident
          operator: containsString
          right:
            value:
              simple: no-reply@InternaIISMasseging.com
        - left:
            iscontext: true
            value:
              complex:
                accessor: emailfrom
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: no-reply@InternaIISMasseging.com
        - left:
            iscontext: true
            value:
              complex:
                accessor: emailfrom
                root: incident
          operator: isEqualString
          right:
            value:
              simple: learn.wisdomenext@tcs.co
      - - left:
            iscontext: true
            value:
              complex:
                accessor: emailsubject
                root: incident
          operator: containsString
          right:
            value:
              simple: 'FY24 Performance Management: Review Supervisor Feedback'
        - left:
            iscontext: true
            value:
              complex:
                accessor: Subject
                root: Email
          operator: containsString
          right:
            value:
              simple: 'FY24 Performance Management: Review Supervisor Feedback'
        - left:
            iscontext: true
            value:
              complex:
                accessor: Subject
                root: Email
          operator: containsString
          right:
            value:
              simple: FY 23-24 Appraisal and Performance Management
        - left:
            iscontext: true
            value:
              complex:
                accessor: emailsubject
                root: incident
          operator: containsString
          right:
            value:
              simple: FY 23-24 Appraisal and Performance Management
        - left:
            iscontext: true
            value:
              complex:
                accessor: emailsubject
                root: incident
          operator: containsString
          right:
            value:
              simple: Performance Band FY 2023-24
        - left:
            iscontext: true
            value:
              complex:
                accessor: Subject
                root: Email
          operator: containsString
          right:
            value:
              simple: Performance Band FY 2023-24
        - left:
            iscontext: true
            value:
              complex:
                accessor: emailsubject
                root: incident
          operator: containsString
          right:
            value:
              simple: Mandatory Security Update for Cloud Storage Users
        - left:
            iscontext: true
            value:
              complex:
                accessor: Subject
                root: Email
          operator: isEqualString
          right:
            value:
              simple: Mandatory Security Update for Cloud Storage Users
        - left:
            iscontext: true
            value:
              complex:
                accessor: emailsubject
                root: incident
          operator: containsString
          right:
            value:
              simple: Exclusive access to TCS AI WisdomNext
        - left:
            iscontext: true
            value:
              complex:
                accessor: Subject
                root: Email
          operator: containsString
          right:
            value:
              simple: Exclusive access to TCS AI WisdomNext
      label: "yes"
    continueonerrortype: ""
    id: "212"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "154"
      "yes":
      - "213"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1a45489e-45fd-4f35-8a16-601c8d0149b3
      iscommand: false
      name: Is Email from Phishing Campaign?
      type: condition
      version: -1
    taskid: 1a45489e-45fd-4f35-8a16-601c8d0149b3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -582.5,
          "y": -650
        }
      }
  "213":
    continueonerrortype: ""
    id: "213"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "214"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e5abfd7e-8347-44fa-8e17-7d365c8e547f
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
    taskid: e5abfd7e-8347-44fa-8e17-7d365c8e547f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1420,
          "y": 2570
        }
      }
  "214":
    continueonerrortype: ""
    id: "214"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "147"
    note: false
    quietmode: 0
    scriptarguments:
      closingnote:
        simple: This email is part of TCS Internal Phishing campaign so closing this
          as false positive.
      investigationanalysis:
        simple: This email is part of TCS Internal Phishing campaign so closing this
          as false positive.
      investigationconclusion:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: ac141ee5-85a2-41b4-809c-219e0e1b51c0
      iscommand: true
      name: Mandatory Field set to Context & Report Summary for campaign
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ac141ee5-85a2-41b4-809c-219e0e1b51c0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1420,
          "y": 2805
        }
      }
  "215":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: emailfrom
                root: incident
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: emailsubject
                root: incident
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: emailsubject
                root: incident
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              complex:
                accessor: emailfrom
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "215"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "216"
      "yes":
      - "212"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 805dc881-c6af-486c-8b28-f0db45f2ccd0
      iscommand: false
      name: Is Email from and subject defined?
      type: condition
      version: -1
    taskid: 805dc881-c6af-486c-8b28-f0db45f2ccd0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -582.5,
          "y": -1005
        }
      }
  "216":
    continueonerrortype: ""
    id: "216"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "212"
    note: false
    quietmode: 0
    scriptarguments:
      Email:
        complex:
          accessor: labels.Email
          root: incident
      Email/cc:
        complex:
          accessor: labels.CC
          root: incident
      Email/format:
        complex:
          accessor: labels.Email/format
          root: incident
      Email/from:
        complex:
          accessor: labels.Email/from
          root: incident
      Email/headers:
        complex:
          accessor: labels.Email/headers
          root: incident
      Email/html:
        complex:
          accessor: labels.Email/html
          root: incident
      Email/subject:
        complex:
          accessor: labels.Email/subject
          root: incident
      Email/text:
        complex:
          accessor: labels.Email/text
          root: incident
      File:
        complex:
          root: File
      GetOriginalEmail:
        simple: "False"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Add email details to the relevant context entities and handle the
        case where original emails are attached.
      id: 5543564d-16d3-4583-8346-879a397513a8
      iscommand: false
      name: TCS-Process Email-Generic v2.2
      playbookId: 5c4c4341-086a-454b-8975-639a3afd0374
      type: playbook
      version: -1
    taskid: 5543564d-16d3-4583-8346-879a397513a8
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 10,
          "y": -830
        }
      }
  "217":
    continueonerrortype: ""
    id: "217"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      Rasterize:
        simple: "True"
      URL:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      UseReputationCommand:
        simple: "False"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Enrich URLs using one or more integrations.

        URL enrichment includes:
        * SSL verification for URLs.
        * Threat information.
        * Providing of URL screenshots.
        * URL Reputation using !url.
      id: d0615066-ba1b-49c8-8ebf-cda96c56030a
      iscommand: false
      name: URL Snap and Enrichment_v1
      playbookId: e1a8502c-c1be-4c55-88fd-83d6988bd90b
      type: playbook
      version: -1
    taskid: d0615066-ba1b-49c8-8ebf-cda96c56030a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -2522.5,
          "y": 1345
        }
      }
  "219":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: File
                root: Attachment
          operator: isExists
          right:
            value: {}
        - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "219"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "131"
      "yes":
      - "170"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 90dbeb7b-54da-42fc-8643-cf3dca546174
      iscommand: false
      name: Check whether URL and attachement present
      type: condition
      version: -1
    taskid: 90dbeb7b-54da-42fc-8643-cf3dca546174
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -90,
          "y": 2120
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "104_107_yes": 0.57,
      "134_135_Yes": 0.45,
      "137_112_#default#": 0.78,
      "145_128_#default#": 0.33,
      "154_131_yes": 0.47,
      "155_136_#default#": 0.48,
      "182_194_False Positive": 0.66,
      "207_156_yes": 0.39,
      "215_212_yes": 0.4
    },
    "paper": {
      "dimensions": {
        "height": 9695,
        "width": 6192.5,
        "x": -2522.5,
        "y": -1320
      }
    }
  }
