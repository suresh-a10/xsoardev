contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: acfd41a4-2bf4-4ddb-806d-86859bd3d0ad
inputs:
- description: ""
  key: EmailedFileData
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: File
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Generic Email Trigger BlockList handler v2.0
outputs:
- contextPath: EmailedDomainsURLsUnique
  description: Global Context Key for emailed Domains/URL's joined and deduped
  type: unknown
- contextPath: JoinedFilesUnique
  description: Global Context Key for emailed IP's joined with IP Blocklist EDL and
    deduped
  type: unknown
- contextPath: EmailedHashs-SHA256
  description: Global Context Key for SHA256 Hashs received by Email
  type: unknown
- contextPath: EmailedHashs-SHA1
  description: Global Context Key for SHA1 Hashs received by Email
  type: unknown
- contextPath: EmailedHashs-MD5
  description: Global Context Key for MD5 Hashs received by Email
  type: unknown
- contextPath: EmailedIPs
  description: Global Context Key for IPs received by Email
  type: unknown
- contextPath: EmailedDomains
  description: Global Context Key for Domains received by Email
  type: unknown
sourceplaybookid: 3a37bf98-d8e9-4ab9-8889-dba63691e69c
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c8491406-896b-4485-8024-300d31fd7f4c
      iscommand: false
      name: ""
      version: -1
    taskid: c8491406-896b-4485-8024-300d31fd7f4c
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 600,
          "y": -370
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7b3d6733-d72c-4345-80fd-633bb8c1f755
      iscommand: false
      name: 'IP Block PLaybook: Update existing Recorded Blocklists'
      type: title
      version: -1
    taskid: 7b3d6733-d72c-4345-80fd-633bb8c1f755
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 600,
          "y": -250
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 87c5c45c-9ba9-41c7-8bd4-7b82add22785
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 87c5c45c-9ba9-41c7-8bd4-7b82add22785
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 600,
          "y": 20
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 31faa53a-2b72-4552-8fa9-b2976774e8ed
      iscommand: false
      name: Add URL IOC's to ZScaler Blocklist
      type: title
      version: -1
    taskid: 31faa53a-2b72-4552-8fa9-b2976774e8ed
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1020,
          "y": -250
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      url:
        complex:
          root: ${EmailedDomainsURLsUnique}
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds URL to the blacklist.
      id: 06c69124-966c-4ae3-8a51-e5da3372b731
      iscommand: true
      name: Upload URL Block List to ZScaler
      script: '|||zscaler-blacklist-url'
      type: regular
      version: -1
    taskid: 06c69124-966c-4ae3-8a51-e5da3372b731
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1020,
          "y": -130
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3a037cff-695d-429d-8f41-2af9453b5dc5
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 3a037cff-695d-429d-8f41-2af9453b5dc5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 20
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e9d25f5d-bf70-4e74-8363-f4ae1387e407
      iscommand: false
      name: Add Hash to Crowdstrike
      type: title
      version: -1
    taskid: e9d25f5d-bf70-4e74-8363-f4ae1387e407
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1440,
          "y": -250
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5922332d-84ab-4fe2-8f1b-6e07577bd1b7
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 5922332d-84ab-4fe2-8f1b-6e07577bd1b7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 20
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e5ecc66-978d-4a45-8975-7c14cf1499d7
      iscommand: false
      name: Add Domain to Bluecoat Proxy
      type: title
      version: -1
    taskid: 1e5ecc66-978d-4a45-8975-7c14cf1499d7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1860,
          "y": -250
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9d5438da-b7ba-4c32-89c6-2689cc5b4327
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 9d5438da-b7ba-4c32-89c6-2689cc5b4327
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1860,
          "y": 20
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      EmailedFileData:
        simple: ${inputs.FileData}
      File:
        simple: ${inputs.File}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 13b8c50f-c924-4319-8be1-7c9daed23051
      iscommand: false
      name: TCS-Upload BlockList to Webserver
      playbookId: dbc273f1-c131-4e07-80e6-4babc78a9e03
      type: playbook
      version: -1
    taskid: 13b8c50f-c924-4319-8be1-7c9daed23051
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 600,
          "y": -130
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 455,
        "width": 1640,
        "x": 600,
        "y": -370
      }
    }
  }
