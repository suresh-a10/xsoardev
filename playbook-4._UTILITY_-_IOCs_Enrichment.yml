contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: ""
    packID: ""
    packName: 4. UTILITY - IOCs Enrichment Contribution Pack
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: This playbook executes when no other playbook is associated with an incident.
  It enriches indicators in an incident using one or more integrations.
id: 540d21cb-0678-4f6c-8f83-133d7fea8a0f
inputs:
- description: Determines whether to enrich all indicators in the incident.
  key: Enrich
  playbookInputQuery: null
  required: false
  value:
    simple: "True"
- description: Set to true to assign only user that is currently on shift. Requires
    Cortex XSOAR v5.5 or later.
  key: OnCall
  playbookInputQuery: null
  required: false
  value:
    simple: "false"
name: 4. UTILITY - IOCs Enrichment
outputs: []
quiet: true
sourceplaybookid: playbook0
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 54dc00ce-092e-4a81-87d3-afd5c9694b74
      iscommand: false
      name: ""
      version: -1
    taskid: 54dc00ce-092e-4a81-87d3-afd5c9694b74
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 265,
          "y": 65
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: da109bb3-cf40-4e4e-84c1-9add2d7203d0
      iscommand: false
      name: Enrich indicators
      type: title
      version: -1
    taskid: da109bb3-cf40-4e4e-84c1-9add2d7203d0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 225
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d6c25be4-69b6-41cf-80a2-c3cbe678f6a3
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: d6c25be4-69b6-41cf-80a2-c3cbe678f6a3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 190,
          "y": 1570
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 2
    scriptarguments:
      CVE:
        complex:
          accessor: ID
          root: CVE
      Domain:
        simple: ${ExtractedIndicators.Domain}
      Email:
        complex:
          accessor: Email.Address
          root: Account
          transformers:
          - operator: uniq
      Hostname:
        complex:
          accessor: Hostname
          root: Endpoint
          transformers:
          - operator: uniq
      IP:
        simple: ${ExtractedIndicators.IP}
      MD5:
        simple: ${ExtractedIndicators.File}
      ResolveIP:
        simple: "False"
      SHA1:
        simple: ${ExtractedIndicators.File}
      SHA256:
        simple: ${ExtractedIndicators.File}
      URL:
        simple: ${ExtractedIndicators.URL}
      Username:
        complex:
          accessor: Username
          root: Account
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Enrich entities using one or more integrations.
      id: a939c0ca-2b57-4eea-83be-c20d6f9be39d
      iscommand: false
      name: Entity Enrichment - Generic v3_ENSOC TI
      playbookId: 0694357e-a998-4d9b-881b-25e2513e2e8a
      type: playbook
      version: -1
    taskid: a939c0ca-2b57-4eea-83be-c20d6f9be39d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
  "14":
    continueonerror: true
    continueonerrortype: errorPath
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "21"
      '#none#':
      - "12"
    note: false
    quietmode: 1
    scriptarguments:
      DbotscoreData:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScore
              operator: isNotEmpty
          root: DBotScore
      VTURLData:
        simple: ${VirusTotal.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6ce0c791-71eb-4879-80c7-5b0cbc344d44
      iscommand: false
      name: Include Suspicious&Malicious Indicator to HTML Table
      script: 88c2afcf-352a-4270-8194-901d1e02d91b
      type: regular
      version: -1
    taskid: 6ce0c791-71eb-4879-80c7-5b0cbc344d44
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 177fea44-6e02-4549-8f26-0f87dca10bbe
      iscommand: false
      name: 4. UTILITY - Enrich Indicators
      playbookId: 68fb26cc-811a-4a47-8e98-96abc6e1f0b0
      type: playbook
      version: -1
    taskid: 177fea44-6e02-4549-8f26-0f87dca10bbe
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 695,
          "y": 50
        }
      }
  "16":
    continueonerror: true
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 2
    scriptarguments:
      text:
        simple: ${incident}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: d355478c-74ba-4681-831e-08f4c37f9483
      iscommand: true
      name: Extract Indicator
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: d355478c-74ba-4681-831e-08f4c37f9483
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
  "17":
    continueonerror: true
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 2
    scriptarguments:
      value:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
          - args:
              item:
                value:
                  simple: ExtractedIndicators.IP
            operator: append
          - args:
              item:
                value:
                  simple: ExtractedIndicators.URL
            operator: append
          - args:
              item:
                value:
                  simple: ExtractedIndicators.Domain
            operator: append
          - args:
              item:
                value:
                  simple: ExtractedIndicators.File
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get the overall score for the indicator as calculated by DBot.
      id: 6e77259c-185c-4635-840a-38ee9c60e847
      iscommand: false
      name: Fetch existing DBot Score information
      script: GetIndicatorDBotScoreFromCache
      type: regular
      version: -1
    taskid: 6e77259c-185c-4635-840a-38ee9c60e847
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
  "18":
    continueonerror: true
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 2
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: indicatorignorelist
      value:
        complex:
          accessor: Indicator
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScoreCache.Expired
              operator: isNotEqualString
              right:
                value:
                  simple: "true"
          - - left:
                iscontext: true
                value:
                  simple: DBotScoreCache.Score
              operator: isNotEqualString
              right:
                value:
                  simple: "0"
          root: DBotScoreCache
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d62f339d-69c4-46b0-898a-4ddaa324cbc4
      iscommand: false
      name: Generate indicator whitelist
      script: Set
      type: regular
      version: -1
    taskid: d62f339d-69c4-46b0-898a-4ddaa324cbc4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
  "19":
    continueonerror: true
    continueonerrortype: errorPath
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "21"
      '#none#':
      - "12"
    note: false
    quietmode: 1
    scriptarguments:
      DbotscoreData:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScoreCache
              operator: isNotEmpty
          root: DBotScoreCache
      VTURLData:
        simple: ${VirusTotal.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2429a9e7-ccd8-4afb-8a35-fe5c3c6c0f32
      iscommand: false
      name: Include Suspicious&Malicious Indicator to HTML Table
      script: 88c2afcf-352a-4270-8194-901d1e02d91b
      type: regular
      version: -1
    taskid: 2429a9e7-ccd8-4afb-8a35-fe5c3c6c0f32
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: DBotScoreCache.Indicator
          operator: isNotEmpty
          right:
            value: {}
      label: Cache
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      Cache:
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e7864be1-e964-437c-8654-37595d2c8111
      iscommand: false
      name: Check Cache or New Enrichment
      type: condition
      version: -1
    taskid: e7864be1-e964-437c-8654-37595d2c8111
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      ctihtml:
        simple: No Malicious/Suspicious Indicator to Include
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f6c6073b-fe21-4a36-86eb-5c3baabdfa3e
      iscommand: true
      name: No Malicious Indicator
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f6c6073b-fe21-4a36-86eb-5c3baabdfa3e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 970,
          "y": 1290
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1585,
        "width": 1300,
        "x": 50,
        "y": 50
      }
    }
  }
