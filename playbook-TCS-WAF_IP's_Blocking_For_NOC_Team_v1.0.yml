contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 8d9f6469-76aa-4588-854b-4aebbf2c0818
inputs: []
name: TCS-WAF IP's Blocking For NOC Team_v1.0
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e6e1d68b-bf0c-4d9b-84f5-be9fe406ab21
      iscommand: false
      name: ""
      version: -1
    taskid: e6e1d68b-bf0c-4d9b-84f5-be9fe406ab21
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 650,
          "y": -110
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      listName:
        simple: WAF_IP's_Needtobeblock
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.get
      id: da37be1a-3bbe-44a0-8ca6-ce8a14b96fbc
      iscommand: true
      name: Get the list for IP
      script: Builtin|||getList
      type: regular
      version: -1
    taskid: da37be1a-3bbe-44a0-8ca6-ce8a14b96fbc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -130,
          "y": 320
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          root: File
      bcc:
        simple: porkodi.g@tcs.com,komal.lugade@tcs.com
      body:
        simple: |
          Hi Team,

          This is critical CSOC notification for blacklisting suspicious IP Address(s).

          Our investigation has concluded these IP Address(s) are suspicious with possible malicious intent. Kindly blacklist the IP Address(s) on priority.

          Note: Once blocking is done kindly revert to internalis.cybersecurityops@tcs.com

          Thanks and Regards,
          Cyberautobot
      cc:
        simple: internalis.cybersecurityops@tcs.com,yogesh.gholap@tcs.com,kunal.krushev@tcs.com,nimisha.prajapati@tcs.com
      subject:
        simple: IP need to be blocked based on Critical alerts
      to:
        simple: internalis.noc@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 0cb96a74-3c4b-42a4-80e7-190f1e774ebd
      iscommand: true
      name: 'send the mail to NOC team '
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 0cb96a74-3c4b-42a4-80e7-190f1e774ebd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 630
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      context_key:
        simple: Value
      file_name:
        simple: IP's Needs to Block.csv
      header:
        simple: IP's
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ed6a9413-9190-434e-89c9-d708494aae60
      iscommand: false
      name: Convert into CSV
      script: 98fd7176-124d-4739-8f9d-2f1edb20aa55
      type: regular
      version: -1
    taskid: ed6a9413-9190-434e-89c9-d708494aae60
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 470
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Value
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9b077d62-1da2-4db6-8365-5360eafc59d0
      iscommand: false
      name: Check the value is define
      type: condition
      version: -1
    taskid: 9b077d62-1da2-4db6-8365-5360eafc59d0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 650,
          "y": 225
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 91b24a87-56fe-4303-8afd-32a39c917018
      iscommand: true
      name: 'Close Investigation '
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 91b24a87-56fe-4303-8afd-32a39c917018
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": 970
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ba088d3e-f693-416f-86a4-daf921630e91
      iscommand: false
      name: END
      type: title
      version: -1
    taskid: ba088d3e-f693-416f-86a4-daf921630e91
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 650,
          "y": 1140
        }
      }
  "11":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Have you blocked IP's?
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: IP blocking Confirmation
      totalanswers: 0
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: WAF IP blocking
      timings:
        completeafterreplies: 0
        completeaftersla: true
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: komal.lugade@tcs.com,jyoti.pawar1@tcs.com
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    sla:
      days: 1
      hours: 0
      minutes: 0
      weeks: 0
    task:
      brand: ""
      id: 8e7942c7-0fbf-4254-868b-c565f3a1a7cf
      iscommand: false
      name: Data collection
      type: collection
      version: -1
    taskid: 8e7942c7-0fbf-4254-868b-c565f3a1a7cf
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1860,
          "y": 405
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sleep for X seconds.
      id: 64f15343-1612-4f16-83c5-ea72c9053506
      iscommand: false
      name: Sleep
      script: Sleep
      type: regular
      version: -1
    taskid: 64f15343-1612-4f16-83c5-ea72c9053506
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 490
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        complex:
          root: Value
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 1bcc1933-6765-4c52-8829-c116851cf38a
      iscommand: false
      name: count the array size
      script: CountArraySize
      type: regular
      version: -1
    taskid: 1bcc1933-6765-4c52-8829-c116851cf38a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1570,
          "y": 60
        }
      }
  "15":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ArraySize
          operator: isEqualString
          right:
            value:
              simple: "1"
      label: "yes"
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5d390e45-7764-41d7-85dc-185e84fc1311
      iscommand: false
      name: Check for size
      type: condition
      version: -1
    taskid: 5d390e45-7764-41d7-85dc-185e84fc1311
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1570,
          "y": 220
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |
          Hi Team,

          This is critical CSOC notification for blacklisting suspicious IP Address(s).

          Our investigation has concluded these IP Address(s) are suspicious with possible malicious intent. Kindly blacklist the IP Address(s) on priority.

          ${Value}

          Note: Kindly confirm the IP blocking on the below link.

          ${IP blocking Confirmation.Links.0.link}

          Thanks and Regards,
          Cyberautobot
      subject:
        simple: IP need to be blocked based on Critical alerts
      to:
        simple: jyoti.pawar1@tcs.com,komal.lugade@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 2b40a9c1-3b2a-4722-8618-93fd6f1c2963
      iscommand: true
      name: 'send the mail to NOC team '
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 2b40a9c1-3b2a-4722-8618-93fd6f1c2963
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1860,
          "y": 610
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Value
      value:
        complex:
          accessor: WAF_IP's_Needtobeblock
          root: lists
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e2905b39-25ff-4039-83a1-8f6fb0f08e03
      iscommand: false
      name: 'Get the list '
      script: Set
      type: regular
      version: -1
    taskid: e2905b39-25ff-4039-83a1-8f6fb0f08e03
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": 50
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${Value}
      listName:
        simple: WAF_IP's_Needtobeblock
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.remove
      id: 1a7d1292-953e-496c-89eb-6ea0a56d94d1
      iscommand: true
      name: Delete the data in WAF list
      script: Builtin|||removeFromList
      type: regular
      version: -1
    taskid: 1a7d1292-953e-496c-89eb-6ea0a56d94d1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 800
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      htmlBody:
        simple: |
          Hi Team,

          <p>This is critical CSOC notification for blacklisting suspicious IP Address(s).</p>

          <p>Our investigation has concluded these IP Address(s) are suspicious with possible malicious intent. Kindly blacklist the IP Address(s) on priority.</p>

          <form action="mailto:internalis.cyberautobot@tcs.com" method="post" enctype="text/plain">
                  <input type="hidden" name="subject" value="Response to Request">
                  <input type="hidden" name="body" value="Yes">
                  <button type="submit" style="background-color: green; color: white; padding: 10px 20px; border: none; cursor: pointer;">
                      Yes
                  </button>
              </form>
              <form action="mailto:internalis.cyberautobot@tcs.com" method="post" enctype="text/plain">
                  <input type="hidden" name="subject" value="Response to Request">
                  <input type="hidden" name="body" value="No">
                  <button type="submit" style="background-color: red; color: white; padding: 10px 20px; border: none; cursor: pointer;">
                      No
                  </button>
              </form>

          <p>Thanks and Regards,<br>
          Cyberautobot</p>
      subject:
        simple: IP need to be blocked based on Critical alerts
      to:
        simple: jyoti.pawar1@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 7a89ff4e-97d8-4db0-8137-da44ec0f52b3
      iscommand: true
      name: 'send the mail to NOC team '
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 7a89ff4e-97d8-4db0-8137-da44ec0f52b3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 1010
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1315,
        "width": 2370,
        "x": -130,
        "y": -110
      }
    }
  }
