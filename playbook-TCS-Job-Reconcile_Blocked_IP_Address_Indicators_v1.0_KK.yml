contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: b198343f-3aa2-4b90-8ca5-4549c087a6b4
inputs: []
name: TCS-Job-Reconcile Blocked IP Address Indicators v1.0_KK
outputs: []
sourceplaybookid: 3a37bf98-d8e9-4ab9-8889-dba63691e69c
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5d0fed0d-be85-488b-82ca-cac41a79ec1c
      iscommand: false
      name: ""
      version: -1
    taskid: 5d0fed0d-be85-488b-82ca-cac41a79ec1c
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 60,
          "y": 20
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "36000000"
      retry-count:
        simple: "3"
      retry-interval:
        simple: "20"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets the IP risk list as a CSV file from Recorded Future.
      id: 59263e6d-833c-4cd2-895b-8db5051ffd3d
      iscommand: true
      name: Fetch recorded future IP risk list via Integration
      script: Recorded Future v2.1|||recorded-future-get-ip-risklist
      type: regular
      version: -1
    taskid: 59263e6d-833c-4cd2-895b-8db5051ffd3d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 60,
          "y": 185
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: ip_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: ip
      threshold:
        simple: "35"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0e8c3cfb-5483-4553-84e8-a4a6c5ea4359
      iscommand: false
      name: Retrieve IPs with reputation >=65 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: 0e8c3cfb-5483-4553-84e8-a4a6c5ea4359
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 60,
          "y": 350
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_ip.csv
          root: File
      extend-context:
        simple: extractedIPList=FileData
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: bc5e55c0-2241-4f87-8d5f-ab40a34fb5be
      iscommand: false
      name: Read extracted list (only IP Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: bc5e55c0-2241-4f87-8d5f-ab40a34fb5be
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c04e6d76-e8c1-46e1-8164-73d6eba48185
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: c04e6d76-e8c1-46e1-8164-73d6eba48185
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2520
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
      listName:
        simple: RecordedFutureIPRiskList65
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: dd486137-13ea-44f7-8f46-494164376af4
      iscommand: true
      name: Overwrite Recorded Future IPRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: dd486137-13ea-44f7-8f46-494164376af4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
  "49":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: "Yes"
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "Yes":
      - "21"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 885c7648-912e-4c02-8bb1-bc7496c21e48
      iscommand: false
      name: Are there any IP's with reputation >=65?
      type: condition
      version: -1
    taskid: 885c7648-912e-4c02-8bb1-bc7496c21e48
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 60,
          "y": 550
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "43200"
      extend-context:
        simple: indicator.ip=value
      ignore-outputs:
        simple: "true"
      query:
        simple: tags:csocblockedip and expirationStatus:active and lastSeen:<="6 months
          ago"
      retry-count:
        simple: "3"
      size:
        simple: "200000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: ebd6f7cc-80d4-436f-8949-ec876f28e4e6
      iscommand: true
      name: Fetch Indicators With CSOC Tag & Older Than 6 Months
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: ebd6f7cc-80d4-436f-8949-ec876f28e4e6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${TaggedIndicator}
      right:
        simple: ${RFSCORE65}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 75ddf31e-cf76-4eec-83f5-fb63a988eba8
      iscommand: false
      name: Compare Context 'Extracted Indicator' and 'Indicator.Ip'
      script: CompareLists
      type: regular
      version: -1
    taskid: 75ddf31e-cf76-4eec-83f5-fb63a988eba8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1815
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RFSCORE65
      value:
        complex:
          root: FileData
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a99ac331-1d4b-42ad-88c8-b3ff5e510ed8
      iscommand: false
      name: Set IP Risk List Into Context
      script: Set
      type: regular
      version: -1
    taskid: a99ac331-1d4b-42ad-88c8-b3ff5e510ed8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TaggedIndicator
      value:
        complex:
          accessor: ip
          root: indicator
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3579134a-be4e-4836-8851-0f360fbf05a2
      iscommand: false
      name: Set Tagged Indictor In Context
      script: Set
      type: regular
      version: -1
    taskid: 3579134a-be4e-4836-8851-0f360fbf05a2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1640
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: b7ea6d31-ea1a-4cf6-885b-1d3badf0df3f
      iscommand: true
      name: Close Automation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: b7ea6d31-ea1a-4cf6-885b-1d3badf0df3f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2660
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5a173843-1ee8-4466-877f-9d0385ce4378
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 5a173843-1ee8-4466-877f-9d0385ce4378
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2845
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isEmpty
      label: "No"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "62"
      "No":
      - "24"
      "yes":
      - "69"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6096f65e-a071-4d03-81ff-fd9300dbccb7
      iscommand: false
      name: Is  There An Indicator To Expire ?
      type: condition
      version: -1
    taskid: 6096f65e-a071-4d03-81ff-fd9300dbccb7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1990
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BELOWSIXFIVE.IP
      value:
        complex:
          accessor: LeftOnly
          root: ListCompare
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2772eb71-8358-45fe-8ccd-65e8407cfa63
      iscommand: false
      name: Set Review IOCs To Context
      script: Set
      type: regular
      version: -1
    taskid: 2772eb71-8358-45fe-8ccd-65e8407cfa63
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2165
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 05c1d3b3-8d34-46e7-892f-7145f0a43b3b
      iscommand: false
      name: TCS-RiskScore Below 65 UNBLOCK Approval Workflow v1.0_KK_WIP
      playbookId: f28d4357-e8e4-409e-8226-e6c8aec56938
      type: playbook
      version: -1
    taskid: 05c1d3b3-8d34-46e7-892f-7145f0a43b3b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2340
        }
      }
  "74":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ip
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9ad271bc-1db5-463b-8fb0-52a250d9b81d
      iscommand: false
      name: Is Context 'indicator.ip' Defined ?
      type: condition
      version: -1
    taskid: 9ad271bc-1db5-463b-8fb0-52a250d9b81d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1440
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        complex:
          accessor: LeftOnly
          root: ListCompare
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5d70a120-0d14-4bd4-8e90-be85f85c96b5
      iscommand: false
      name: 'Sub Playbook: Unblock IOC Task'
      playbookId: 6b908384-c08d-4f61-8072-0869ba263404
      type: playbook
      version: -1
    taskid: 5d70a120-0d14-4bd4-8e90-be85f85c96b5
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -200,
          "y": 2340
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "49_24_#default#": 0.14,
      "74_24_#default#": 0.1,
      "74_59_yes": 0.5
    },
    "paper": {
      "dimensions": {
        "height": 2890,
        "width": 845,
        "x": -200,
        "y": 20
      }
    }
  }
