contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 62a1fa17-83cb-4b66-8396-ddfb0267788c
inputs: []
name: IOC Reconciliation_copy
outputs: []
sourceplaybookid: 0ccb9021-ad43-4b79-8486-29194c8a9d7d
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 30078af1-3b70-4a5e-808e-cbb8b875f41a
      iscommand: false
      name: ""
      version: -1
    taskid: 30078af1-3b70-4a5e-808e-cbb8b875f41a
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 890,
          "y": -790
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2ad99c38-dec6-4637-826f-fbb2512a57e7
      iscommand: false
      name: Get IOC Risk Scores
      script: b15a38a4-e760-4de5-80e3-8ff23b052b78
      type: regular
      version: -1
    taskid: 2ad99c38-dec6-4637-826f-fbb2512a57e7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": -540
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2218a396-228b-4244-8aed-1626365b2759
      iscommand: false
      name: Read file and Extract IOCs to Context
      script: 8ce879aa-e1fe-49a5-85f7-10a0eec2271b
      type: regular
      version: -1
    taskid: 2218a396-228b-4244-8aed-1626365b2759
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": -690
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f8d31c34-f771-40fc-89c3-80c53c45fc69
      iscommand: false
      name: Send report
      type: title
      version: -1
    taskid: f8d31c34-f771-40fc-89c3-80c53c45fc69
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 380,
          "y": 225
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 39163023-54ec-453a-874b-f18e97ca0393
      iscommand: false
      name: Generate IOC Reports
      type: title
      version: -1
    taskid: 39163023-54ec-453a-874b-f18e97ca0393
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 380,
          "y": -370
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${Above65RiskList}
      fileName:
        simple: Above65RiskscoreReport.csv
      headers:
        simple: ioc,riskscore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: c20a29d0-6a66-418b-8a40-8f79ca2891a5
      iscommand: false
      name: Generate Above 65 IOC Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: c20a29d0-6a66-418b-8a40-8f79ca2891a5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": -60
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Above65RiskList
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: Above65RiskList
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether the playbook's input contains at least one IP
        address.
      id: 1afabf95-2442-4810-89e3-6bd509e086c8
      iscommand: false
      name: Are there any  IOC >=65 ?
      type: condition
      version: -1
    taskid: 1afabf95-2442-4810-89e3-6bd509e086c8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 380,
          "y": -225
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: Above65RiskscoreReport.csv
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: Below65RiskscoreReport.csv
          root: File
      body:
        simple: |-
          Hello,

          IOC Reconciliation completed. Please find risk score report attached.
      cc:
        simple: CyberAutoBotGrp@tcscomprod.onmicrosoft.com
      subject:
        simple: IOC Reconciliation- Above 65 Risk Report
      to:
        simple: kunal.krushev@tcs.com,yogesh.gholap@tcs.com,nimisha.prajapati@tcs.com
      using:
        simple: EWS Mail Sender_Autobot
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 3ba420e5-4f12-4bf5-8f26-829a66b4dd99
      iscommand: true
      name: Send Notification with Report
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 3ba420e5-4f12-4bf5-8f26-829a66b4dd99
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": 320
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello,

          WAF Inbound Threats Mitigated events count for ${Date} is ${QRadar.Search.Result.events.EventCount}, which has crossed the threshold limit - ${Threshold}. Kindly investigate further.

          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: kunal.krushev@tcs.com,yogesh.gholap@tcs.com,rupesh.sane@tcs.com,nimisha.prajapati@tcs.com,Shahnawaz.Kohati@tcs.com
      subject:
        simple: WAF Inbound Threats Mitigated - Threshold limit exceeded
      to:
        simple: priyadarshani.kate@tcs.com,jha.sweta1@tcs.com,sonam.bhandari@tcs.com,vaithilingam.arumugam@tcs.com,gayathri.pulla@tcs.com,prasad.kaginkar@tcs.com,samadhan.pardeshi@tcs.com
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 3d5e6698-4e5d-4a5b-8e7f-3881a155b760
      iscommand: true
      name: Send email notification to Leads
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 3d5e6698-4e5d-4a5b-8e7f-3881a155b760
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -580,
          "y": 160
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: Below65RiskscoreReport.csv
          root: File
      body:
        simple: |-
          Hello,

          I did not find any IOC with Risk Score >=65.
      cc:
        simple: CyberAutoBotGrp@tcscomprod.onmicrosoft.com
      subject:
        simple: IOC Reconciliation- Above 65 Risk Report
      to:
        simple: kunal.krushev@tcs.com,yogesh.gholap@tcs.com,nimisha.prajapati@tcs.com
      using:
        simple: EWS Mail Sender_Autobot
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 17f433b9-fbbd-482a-82ce-bda30998a208
      iscommand: true
      name: Send Notification For No IOC Above Risk Score 65
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 17f433b9-fbbd-482a-82ce-bda30998a208
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 620,
          "y": 195
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 574aafa5-0722-4c5e-8a7a-7908997499b5
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
    taskid: 574aafa5-0722-4c5e-8a7a-7908997499b5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 580,
          "y": 490
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${Below65RiskList}
      fileName:
        simple: Below65RiskscoreReport.csv
      headers:
        simple: ioc,riskscore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 4e017ab4-9bb4-4fe3-8154-33eb18ea5641
      iscommand: false
      name: Generate Below 65 IOC Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 4e017ab4-9bb4-4fe3-8154-33eb18ea5641
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": 85
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 2
    scriptarguments:
      limit:
        simple: "1000"
      populateFields:
        simple: value
      query:
        simple: tags:csocblockedip and expirationStatus:active
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a list of indicator objects and the associated indicator outputs
        that match the specified query and filters. The results are returned in a
        structured data file.
      id: 3e19f4bb-376e-4829-8481-49225615f34e
      iscommand: false
      name: get indictor
      script: GetIndicatorsByQuery
      type: regular
      version: -1
    taskid: 3e19f4bb-376e-4829-8481-49225615f34e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": -650
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 2
    scriptarguments:
      execution-timeout:
        simple: "36000000"
      ip:
        complex:
          root: CSOCIP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with an IP address.
      id: abee10e5-b338-4f2d-8725-0b7aee759680
      iscommand: true
      name: get rf risk score
      script: Recorded Future v2|||ip
      type: regular
      version: -1
    taskid: abee10e5-b338-4f2d-8725-0b7aee759680
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": -170
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 2
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 8ce8fe35-7550-4a9f-8456-a5e7fc296056
      iscommand: false
      name: Read file
      script: ReadFile
      type: regular
      version: -1
    taskid: 8ce8fe35-7550-4a9f-8456-a5e7fc296056
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": -490
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 2
    scriptarguments:
      key:
        simple: CSOCIP
      value:
        complex:
          root: FileData
          transformers:
          - operator: ParseJSON
          - args:
              field:
                value:
                  simple: value
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1f27d494-13fc-4baf-85d1-a683323f0594
      iscommand: false
      name: set
      script: Set
      type: regular
      version: -1
    taskid: 1f27d494-13fc-4baf-85d1-a683323f0594
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": -330
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: RecordedFuture.IP.riskScore
          operator: greaterThan
          right:
            value:
              simple: "65"
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether the playbook's input contains at least one IP
        address.
      id: f4a54a78-75a0-424d-801b-325ccbf084ca
      iscommand: false
      name: Are there any  IOC < 65 ?
      type: condition
      version: -1
    taskid: f4a54a78-75a0-424d-801b-325ccbf084ca
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 20
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Above65
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: 'RecordedFuture.IP.riskScore '
              operator: greaterThan
              right:
                value:
                  simple: "65"
          root: RecordedFuture.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9c2923d5-aca8-452c-8e50-60c5b512078d
      iscommand: false
      name: Above 65 Score
      script: Set
      type: regular
      version: -1
    taskid: 9c2923d5-aca8-452c-8e50-60c5b512078d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1620,
          "y": 235
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Below65
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.IP.riskScore
              operator: lessThan
              right:
                value:
                  simple: "65"
          root: RecordedFuture.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 047ed1f1-561d-46e6-89b7-51c6c5982593
      iscommand: false
      name: Less than 65
      script: Set
      type: regular
      version: -1
    taskid: 047ed1f1-561d-46e6-89b7-51c6c5982593
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 225
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      fileName:
        simple: Below65
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: ee23a5ac-143c-4dcd-8500-cc8fb86ed74c
      iscommand: false
      name: Export
      script: ExportToCSV
      type: regular
      version: -1
    taskid: ee23a5ac-143c-4dcd-8500-cc8fb86ed74c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -10,
          "y": 475
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        simple: ${Below65}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: 85350348-bfad-4cad-828b-7f18b70a8133
      iscommand: true
      name: Expire Indictor
      script: Builtin|||expireIndicators
      type: regular
      version: -1
    taskid: 85350348-bfad-4cad-828b-7f18b70a8133
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 435
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1360,
        "width": 2580,
        "x": -580,
        "y": -790
      }
    }
  }
