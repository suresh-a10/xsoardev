contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: edaf9cc5-214c-458f-8615-f243c7b5b17c
inputs:
- description: ""
  key: Domain
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Domain
      root: ExtractedIndicators
name: TCS-Domain Verification IOC Blocking v1.0_KK
outputs:
- contextPath: ExtractedIndicators.Domain
  description: Domain
  type: unknown
sourceplaybookid: 10a892d4-e4b5-4b5e-80ea-dcaccb53541a
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "96"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 72aa8ff6-9c0a-4c7c-8a67-336f3b996309
      iscommand: false
      name: ""
      version: -1
    taskid: 72aa8ff6-9c0a-4c7c-8a67-336f3b996309
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 275,
          "y": -475
        }
      }
  "3":
    continueonerror: true
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "62"
      "yes":
      - "7"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.TCS_Customer_Domain_List}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 3120e9ef-214d-441e-8531-de8e05574848
      iscommand: false
      name: Does Domain Belong To Customer ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 3120e9ef-214d-441e-8531-de8e05574848
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 3870
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain4.Customer
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a6eb4075-09d1-417b-85f7-10997b71b164
      iscommand: false
      name: Set Customer Domain into Context
      script: Set
      type: regular
      version: -1
    taskid: a6eb4075-09d1-417b-85f7-10997b71b164
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 4045
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain3
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 65e92ba1-5d61-4f0a-881f-b2d6b8e3a356
      iscommand: false
      name: Set Output into Context
      script: Set
      type: regular
      version: -1
    taskid: 65e92ba1-5d61-4f0a-881f-b2d6b8e3a356
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 3355
        }
      }
  "11":
    continueonerror: true
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "no":
      - "10"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.TCS_Customer_Domain_List},${lists.MasterIOC_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 1ede4e4a-3f15-4628-82d9-06945128b79f
      iscommand: false
      name: Does Domain Belong To TCS or Customer or In Master IOC List?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 1ede4e4a-3f15-4628-82d9-06945128b79f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 3170
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      attachIDs:
        simple: ${.=val.File.filter(function(f){return f.EntryID;}).reduce(function(acc,
          f) {return f;}, null).EntryID}
      body:
        simple: "Hello Human,\n\nI found Internal/Customer Domain in this file ${incident.attachment.name}.
          \nPFA Risk Score report.\n\nInternal/Customer Domain:\n\n${Domain4.Customer}\n\n\nRegards,\nCSOC
          CyberAutoBot"
      subject:
        simple: Found Internal/Customer Domain In This File ${incident.attachment.name}
      to:
        complex:
          accessor: emailfrom
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 10fabc9c-7a24-4448-8629-8a54fe253d10
      iscommand: true
      name: Send Email Notification That Internal/Customer Domain Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 10fabc9c-7a24-4448-8629-8a54fe253d10
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 5475
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cc108200-cac5-4f0f-8dbf-c951a17c84a5
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: cc108200-cac5-4f0f-8dbf-c951a17c84a5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -490,
          "y": 6110
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
      - "35"
      - "61"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8d4cc3da-1962-4107-8d41-5794fb5f7b4b
      iscommand: false
      name: Generate Report & Notify
      type: title
      version: -1
    taskid: 8d4cc3da-1962-4107-8d41-5794fb5f7b4b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 275,
          "y": 5065
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain4.Customer
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: check for trusted ioc
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2d38d3f1-b894-46b4-8076-b7007323818c
      iscommand: false
      name: Verify There Are No Customer Domain In The List ?
      type: condition
      version: -1
    taskid: 2d38d3f1-b894-46b4-8076-b7007323818c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 5220
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI did not find any customer domain in this file ${incident.attachment.name}\n\n\nRegards,\nCSOC
          CyberAutoBot "
      subject:
        simple: No Customer Domain Found In This File ${incident.attachment.name}
      to:
        complex:
          accessor: emailfrom
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: f097b317-77e1-4d7d-82a4-62c4cb5a4ca3
      iscommand: true
      name: Send Email Notification That No Customer Domain Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: f097b317-77e1-4d7d-82a4-62c4cb5a4ca3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 5475
        }
      }
  "40":
    continueonerror: true
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "92"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${Domain4.Customer}
      retry-count:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets a quick indicator of the risk associated with a domain.
      id: fc91b0cc-13c3-4d87-8ba9-1a99b57def66
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2.1|||domain
      type: regular
      version: -1
    taskid: fc91b0cc-13c3-4d87-8ba9-1a99b57def66
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 4210
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: b479fe1b-7c51-4342-8f33-19e3336afb0b
      iscommand: false
      name: Delete Extracted Indicators Domain Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: b479fe1b-7c51-4342-8f33-19e3336afb0b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 3520
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .tcs.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .ultimatix.net
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .google.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .microsoft.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .gstatic.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .cisco.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .zscaler.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .zoom.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .zoom.us
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .riverside.fm
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .amazon.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .amazon.in
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .azure.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .microsoftonline.com
          root: Domain3
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 7ea9a7f4-af4e-4818-8b19-c26db2bc0a54
      iscommand: false
      name: Set New Unique Domains Into Extracted Indicators
      script: Set
      type: regular
      version: -1
    taskid: 7ea9a7f4-af4e-4818-8b19-c26db2bc0a54
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 3695
        }
      }
  "61":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain4.Customer
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isNotEqualString
          right:
            value:
              simple: ajit.menon@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d704613e-70ab-455a-8b56-5d90510ad497
      iscommand: false
      name: Is There a Internal/Customer Domain ?
      type: condition
      version: -1
    taskid: d704613e-70ab-455a-8b56-5d90510ad497
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 820,
          "y": 5220
        }
      }
  "62":
    continueonerror: true
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "63"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.MasterIOC_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 1a42a389-b4bc-4675-8f07-ac4a46692a0b
      iscommand: false
      name: Is Domain In Master IOC List ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 1a42a389-b4bc-4675-8f07-ac4a46692a0b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 4570
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain5.MasterIOC
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4040095c-bc02-433a-8499-c65aaee27ddc
      iscommand: false
      name: Set Master IOC Domain into Context
      script: Set
      type: regular
      version: -1
    taskid: 4040095c-bc02-433a-8499-c65aaee27ddc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 4810
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI found that below Domains from the file ${incident.attachment.name}
          are already in the Master IOC list. I will not be performing any action
          on these IOCs.\n\nDomain:\n\n${Domain5.MasterIOC} \n\n\n\nRegards,\nCSOC
          CyberAutoBot "
      subject:
        simple: Domains In Master IOC List Found In This File ${incident.attachment.name}
      to:
        complex:
          accessor: emailfrom
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 4af1ed02-5195-40a2-8979-d19a8a02db4d
      iscommand: true
      name: Send Email Notification Found Domain In Master IOC
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 4af1ed02-5195-40a2-8979-d19a8a02db4d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -257.5,
          "y": 5475
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: MasterIOC
                root: Domain5
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: check for trusted ioc
        - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: block ioc
        - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: blacklist ioc
      label: "yes"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "64"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e8b26d0f-52a3-49d6-824e-a1f214cd281e
      iscommand: false
      name: Verify The Master IOC & Email Subject Condition
      type: condition
      version: -1
    taskid: e8b26d0f-52a3-49d6-824e-a1f214cd281e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -257.5,
          "y": 5220
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          accessor: Domain_Test_
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c5d46411-5a24-4d50-8471-d0cc4ac8d913
      iscommand: false
      name: Set Extracted Indicators Context (Strip www. & Unique)
      script: Set
      type: regular
      version: -1
    taskid: c5d46411-5a24-4d50-8471-d0cc4ac8d913
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1985
        }
      }
  "68":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain_Test_
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "70"
      "yes":
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3c2126e6-36fc-4cd7-8e06-becf43973c6c
      iscommand: false
      name: Is Domain Test Context Defined ?
      type: condition
      version: -1
    taskid: 3c2126e6-36fc-4cd7-8e06-becf43973c6c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 820,
          "y": 1800
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "89"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: IOC.Domain2
      value:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8635ac7a-3d41-4605-8c27-926f9b885bb2
      iscommand: false
      name: Set Indicators In Context
      script: Set
      type: regular
      version: -1
    taskid: 8635ac7a-3d41-4605-8c27-926f9b885bb2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 2160
        }
      }
  "82":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.URL
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "68"
      "yes":
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 09bf536a-ca51-4a26-8dcf-33164d14d7b9
      iscommand: false
      name: Is There a URL Context ?
      type: condition
      version: -1
    taskid: 09bf536a-ca51-4a26-8dcf-33164d14d7b9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 270
        }
      }
  "83":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "68"
      "yes":
      - "84"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5532499f-4044-4509-8986-e01a03619887
      iscommand: false
      name: Is there a Domain Context ?
      type: condition
      version: -1
    taskid: 5532499f-4044-4509-8986-e01a03619887
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 500
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    scriptarguments:
      domains:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      urls:
        complex:
          accessor: URL
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the supplied URLs are in the specified domains.
      id: b0ce73a4-9cbe-452e-8f48-65d012faa2ad
      iscommand: false
      name: 'Compare Domain & URL Context '
      script: IsUrlPartOfDomain
      type: regular
      version: -1
    taskid: b0ce73a4-9cbe-452e-8f48-65d012faa2ad
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 730
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: IOC.URLDomains
      value:
        complex:
          accessor: Domain
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IsUrlPartOfDomain.IsInternal
              operator: isEqualString
              right:
                value:
                  simple: "true"
          root: IsUrlPartOfDomain
          transformers:
          - args:
              chars:
                value:
                  simple: www.
            operator: StripChars
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c9b36cb8-2fb5-4a2f-8623-952e24520043
      iscommand: false
      name: Set URL Domains in Context
      script: Set
      type: regular
      version: -1
    taskid: c9b36cb8-2fb5-4a2f-8623-952e24520043
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 915
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "87"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        complex:
          accessor: URLDomains
          root: IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets a quick indicator of the risk associated with a domain.
      id: 5478b2d5-f357-41c6-8a63-5c97dcc226f0
      iscommand: true
      name: Enrich Domain With RF
      script: Recorded Future v2.1|||domain
      type: regular
      version: -1
    taskid: 5478b2d5-f357-41c6-8a63-5c97dcc226f0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1100
        }
      }
  "87":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.Domain
          operator: lessThan
          right:
            value:
              simple: "65"
      label: "yes"
    continueonerrortype: ""
    id: "87"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "93"
      "yes":
      - "88"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4a94a357-c18b-464b-806d-b3b2fa7509fd
      iscommand: false
      name: Any Domain With Risk Score < 65 ?
      type: condition
      version: -1
    taskid: 4a94a357-c18b-464b-806d-b3b2fa7509fd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1280
        }
      }
  "88":
    continueonerrortype: ""
    id: "88"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: IOC.Domain
      value:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.Domain.riskScore
              operator: lessThan
              right:
                value:
                  simple: "65"
          root: RecordedFuture.Domain
          transformers:
          - args:
              chars:
                value:
                  simple: www.
            operator: StripChars
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 0b51cc18-cb15-45db-8346-c2378cacf7b0
      iscommand: false
      name: 'Set Domains < 65 in Context '
      script: Set
      type: regular
      version: -1
    taskid: 0b51cc18-cb15-45db-8346-c2378cacf7b0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1450
        }
      }
  "89":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: IOC
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: IOC
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "95"
      "yes":
      - "90"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c5470fc7-65e0-43a5-8de8-6a07e446e32c
      iscommand: false
      name: Any URL Domains To Compare ?
      type: condition
      version: -1
    taskid: c5470fc7-65e0-43a5-8de8-6a07e446e32c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 2335
        }
      }
  "90":
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${IOC.Domain2}
      right:
        simple: ${IOC.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 8bef9309-715d-464b-8b98-4ce1b9f3febb
      iscommand: false
      name: Compare The URL Domain < 65 and Extracted Domain
      script: CompareLists
      type: regular
      version: -1
    taskid: 8bef9309-715d-464b-8b98-4ce1b9f3febb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 2360
        }
      }
  "91":
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators2.Domain
      value:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5026a18d-6da2-46a4-8c00-037553a26382
      iscommand: false
      name: Set Context Extracted indicators 2
      script: Set
      type: regular
      version: -1
    taskid: 5026a18d-6da2-46a4-8c00-037553a26382
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 2730
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${RecordedFuture.Domain}
      fileName:
        simple: Domain Risk Score.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 3651adaf-9b2c-4c3b-81a8-49addd3f8961
      iscommand: false
      name: Generate CSV Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 3651adaf-9b2c-4c3b-81a8-49addd3f8961
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 4385
        }
      }
  "93":
    continueonerrortype: ""
    id: "93"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RecordedFuture
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 20dac313-9d49-4a90-8483-5a426f7e2e1d
      iscommand: false
      name: Delete Recorded Future context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 20dac313-9d49-4a90-8483-5a426f7e2e1d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1625
        }
      }
  "94":
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "98"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 77819699-1725-40e8-86b7-c34d38538610
      iscommand: false
      name: 'Domain Owner Verification '
      type: title
      version: -1
    taskid: 77819699-1725-40e8-86b7-c34d38538610
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 275,
          "y": 2870
        }
      }
  "95":
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators2.Domain
      value:
        complex:
          accessor: Domain2
          root: IOC
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d981e614-7504-4b1d-8e52-5362b7d5207b
      iscommand: false
      name: Set Context Extracted indicators 2
      script: Set
      type: regular
      version: -1
    taskid: d981e614-7504-4b1d-8e52-5362b7d5207b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 2705
        }
      }
  "96":
    continueonerrortype: ""
    id: "96"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "97"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cabee128-efa1-4348-8f7e-51a0846b5fa8
      iscommand: false
      name: Identify Domain Indicators For Owner Verification
      type: title
      version: -1
    taskid: cabee128-efa1-4348-8f7e-51a0846b5fa8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 275,
          "y": -290
        }
      }
  "97":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain_Test_
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.URL
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "82"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 77c05293-853d-418b-8ffc-1b5bf6fcc69d
      iscommand: false
      name: Is there a Domain Context ?
      type: condition
      version: -1
    taskid: 77c05293-853d-418b-8ffc-1b5bf6fcc69d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -80,
          "y": -50
        }
      }
  "98":
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: a6e67c10-746a-42f8-8a1c-3d9597572b05
      iscommand: false
      name: Delete Extract Indicator Domain Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: a6e67c10-746a-42f8-8a1c-3d9597572b05
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 3010
        }
      }
  "99":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsInternal
                root: IsUrlPartOfDomain
          operator: isEqualString
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "87"
      "yes":
      - "85"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cd41486d-f284-4832-8609-2735adccaa2b
      iscommand: false
      name: Is Domain Found in URL Context
      type: condition
      version: -1
    taskid: cd41486d-f284-4832-8609-2735adccaa2b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -200,
          "y": 840
        }
      }
  "100":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "100"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "95"
      "yes":
      - "91"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 770b9f62-a3c6-43e1-8ead-44b75b4b35b9
      iscommand: false
      name: Check If Left Context Is NOT Empty
      type: condition
      version: -1
    taskid: 770b9f62-a3c6-43e1-8ead-44b75b4b35b9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 820,
          "y": 2525
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "100_91_yes": 0.61,
      "11_10_no": 0.53,
      "11_3_#default#": 0.2,
      "35_33_#default#": 0.69,
      "3_62_#default#": 0.49,
      "3_7_yes": 0.52,
      "61_33_#default#": 0.56,
      "62_34_#default#": 0.52,
      "62_63_yes": 0.53,
      "66_33_#default#": 0.71,
      "68_67_yes": 0.46,
      "68_70_#default#": 0.48,
      "82_68_#default#": 0.21,
      "82_83_yes": 0.5,
      "83_68_#default#": 0.24,
      "83_84_yes": 0.52,
      "87_88_yes": 0.56,
      "89_90_yes": 0.52,
      "89_95_#default#": 0.55
    },
    "paper": {
      "dimensions": {
        "height": 6650,
        "width": 1690,
        "x": -490,
        "y": -475
      }
    }
  }
