contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 2ae9443a-7d05-43e2-8b5b-119755787192
inputs:
- description: ""
  key: mitreid
  playbookInputQuery: null
  required: false
  value: {}
name: MITREMAPPING
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 658414a4-df3b-466f-8bc1-f831bab42c18
      iscommand: false
      name: ""
      version: -1
    taskid: 658414a4-df3b-466f-8bc1-f831bab42c18
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 480,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      attack_ids:
        simple: ${inputs.mitreid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: MITRE ATT&CK v2
      description: Gets the Attack Pattern value from the Attack Pattern ID.
      id: 89d8fcdd-c954-4c8d-8e66-937b36a87490
      iscommand: true
      name: ExtractMITREDetails
      script: MITRE ATT&CK v2|||mitre-get-indicator-name
      type: regular
      version: -1
    taskid: 89d8fcdd-c954-4c8d-8e66-937b36a87490
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": 545
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "4"
      "yes":
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${MITREATTACK.value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 2636df25-9eb2-4492-8323-21f3d6196110
      iscommand: false
      name: Does MITRE ATTACK NAME Exists
      script: Exists
      type: condition
      version: -1
    taskid: 2636df25-9eb2-4492-8323-21f3d6196110
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 695,
          "y": 720
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      value:
        simple: ${findresults.value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.associate.indicator
      id: 3b6ae042-8c8d-47a0-8629-9303a53c72e6
      iscommand: true
      name: Associate Incident to MITRE ATTACK When Result found in local DB
      script: Builtin|||associateIndicatorToIncident
      type: regular
      version: -1
    taskid: 3b6ae042-8c8d-47a0-8629-9303a53c72e6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: No MITRE ATTACK PATTERN FOUND - change for test
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: 1a514c22-add8-4c86-8fa5-dc958490d7d8
      iscommand: false
      name: No MITRE ATTACK PATTERN Found
      script: Print
      type: regular
      version: -1
    taskid: 1a514c22-add8-4c86-8fa5-dc958490d7d8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f3182a36-7228-4611-8b04-6199e5cb0d90
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: f3182a36-7228-4611-8b04-6199e5cb0d90
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1245
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 2
    scriptarguments:
      execution-timeout:
        simple: "6"
      extend-context:
        simple: findresults.mitreid=CustomFields.mitreid::findresults.value=value
      query:
        simple: mitreid=${inputs.mitreid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 347b4f81-12d3-4294-8c2e-227ae869aa9c
      iscommand: true
      name: Check if Indicator Exists in DB
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 347b4f81-12d3-4294-8c2e-227ae869aa9c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "1"
      "yes":
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${findresults}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 6150ccb7-c999-49f5-8e1e-ba57da9f5a46
      iscommand: false
      name: Does the Indicator Exist ?
      script: Exists
      type: condition
      version: -1
    taskid: 6150ccb7-c999-49f5-8e1e-ba57da9f5a46
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      mitreid:
        simple: ${MITREATTACK.id}
      value:
        simple: ${MITREATTACK.value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 92841bca-19c8-4c06-88c6-79ed2ba60d6b
      iscommand: true
      name: Add the Indicator in the DB
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 92841bca-19c8-4c06-88c6-79ed2ba60d6b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 895
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      value:
        simple: ${MITREATTACK.value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.associate.indicator
      id: aa598029-bd81-4010-803b-3b0d799f761a
      iscommand: true
      name: Associate Incident to MITRE ATTACK - When result no found in local DB
      script: Builtin|||associateIndicatorToIncident
      type: regular
      version: -1
    taskid: aa598029-bd81-4010-803b-3b0d799f761a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1070
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 0954ae87-8699-4884-86a6-22037511b14c
      iscommand: false
      name: 20201010_IncidentAnalysis_main
      playbookId: ad88f586-31d0-4f59-8e4a-a76a169ed399
      type: playbook
      version: -1
    taskid: 0954ae87-8699-4884-86a6-22037511b14c
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1250
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "2_4_no": 0.57
    },
    "paper": {
      "dimensions": {
        "height": 1295,
        "width": 1240,
        "x": 50,
        "y": 50
      }
    }
  }
