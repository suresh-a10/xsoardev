contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 2ae9443a-7d05-43e2-8b5b-119755787192
inputs:
- description: ""
  key: mitreid
  playbookInputQuery: null
  required: false
  value: {}
name: MITREMAPPING
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1816815d-89c6-42ce-8db5-4bfad906233b
      iscommand: false
      name: ""
      version: -1
    taskid: 1816815d-89c6-42ce-8db5-4bfad906233b
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 480,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      attack_ids:
        simple: ${inputs.mitreid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: MITRE ATT&CK v2
      description: Gets the Attack Pattern value from the Attack Pattern ID.
      id: 7483ac46-37ed-4b78-8f20-d8d8e723a2b7
      iscommand: true
      name: ExtractMITREDetails
      script: MITRE ATT&CK v2|||mitre-get-indicator-name
      type: regular
      version: -1
    taskid: 7483ac46-37ed-4b78-8f20-d8d8e723a2b7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": 545
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "4"
      "yes":
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${MITREATTACK.value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 1c7c903a-1251-40b8-8e33-422498e1c1c1
      iscommand: false
      name: Does MITRE ATTACK NAME Exists
      script: Exists
      type: condition
      version: -1
    taskid: 1c7c903a-1251-40b8-8e33-422498e1c1c1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 695,
          "y": 720
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      value:
        simple: ${findresults.value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.associate.indicator
      id: 5960ea53-d6f8-4d14-8437-82a8f2af0291
      iscommand: true
      name: Associate Incident to MITRE ATTACK When Result found in local DB
      script: Builtin|||associateIndicatorToIncident
      type: regular
      version: -1
    taskid: 5960ea53-d6f8-4d14-8437-82a8f2af0291
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: No MITRE ATTACK PATTERN FOUND - change for test
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: 7d5fdbba-4abb-4113-8a69-e731b45f3e58
      iscommand: false
      name: No MITRE ATTACK PATTERN Found
      script: Print
      type: regular
      version: -1
    taskid: 7d5fdbba-4abb-4113-8a69-e731b45f3e58
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 292f6f17-a2f0-4cb4-8814-deba10e8b08f
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 292f6f17-a2f0-4cb4-8814-deba10e8b08f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1245
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 2
    scriptarguments:
      execution-timeout:
        simple: "6"
      extend-context:
        simple: findresults.mitreid=CustomFields.mitreid::findresults.value=value
      query:
        simple: mitreid=${inputs.mitreid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 8ab23385-2a0d-4b50-8445-05fdc839719b
      iscommand: true
      name: Check if Indicator Exists in DB
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 8ab23385-2a0d-4b50-8445-05fdc839719b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "1"
      "yes":
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${findresults}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: a542fd44-660b-4f9c-8328-0495aba62dd7
      iscommand: false
      name: Does the Indicator Exist ?
      script: Exists
      type: condition
      version: -1
    taskid: a542fd44-660b-4f9c-8328-0495aba62dd7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      mitreid:
        simple: ${MITREATTACK.id}
      value:
        simple: ${MITREATTACK.value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: a30a2f04-7ce9-407c-8d47-4a7ea4c3cb95
      iscommand: true
      name: Add the Indicator in the DB
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: a30a2f04-7ce9-407c-8d47-4a7ea4c3cb95
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 895
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      value:
        simple: ${MITREATTACK.value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.associate.indicator
      id: bca9360a-3aea-4c6c-8f6f-2ce2544e09a0
      iscommand: true
      name: Associate Incident to MITRE ATTACK - When result no found in local DB
      script: Builtin|||associateIndicatorToIncident
      type: regular
      version: -1
    taskid: bca9360a-3aea-4c6c-8f6f-2ce2544e09a0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1070
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 153b3a81-9074-457a-8d75-0dc6b624e092
      iscommand: false
      name: 20201010_IncidentAnalysis_main
      playbookId: ad88f586-31d0-4f59-8e4a-a76a169ed399
      type: playbook
      version: -1
    taskid: 153b3a81-9074-457a-8d75-0dc6b624e092
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1250
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "2_4_no": 0.57
    },
    "paper": {
      "dimensions": {
        "height": 1295,
        "width": 1240,
        "x": 50,
        "y": 50
      }
    }
  }
