args:
- name: path
  required: true
- name: PC
commonfields:
  id: 457cecce-0e01-4bc1-8b2c-c3a1a66d73a2
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.9.6.22912
enabled: true
engineinfo: {}
mainengineinfo: {}
name: McAfeeGetGroupId
outputs:
- contextPath: epoGroups
- contextPath: epoGroups.path
- contextPath: epoGroups.id
- contextPath: epoGroups.result
- contextPath: epoGroups.PC
pswd: ""
runas: DBotWeakRole
runonce: false
script: |-
  args = demisto.args()
  path = args.get('path')
  pc = args.get('PC')
  res = safeExecute('epo-get-system-tree-group', {'search':path.split('\\')[-1]})[0]['Contents']
  results = []
  context = {'path':path, 'PC':pc}
  for group in res:
      if group.get('groupPath') == path:
          results.append(group.get('groupId'))


  if len(results)>0:
      context['id']=[]
      for result in results:
          context['id'].append(result)
          context['result'] = 'Success'
          demisto.setContext('epoGroups', context)
          return_results(result)
  else:
      context['id'] = None
      context['result'] = 'Failed'
      demisto.setContext('epoGroups', context)
      return_results(result)

  demisto.results('done')
scripttarget: 0
subtype: python3
tags: []
type: python
