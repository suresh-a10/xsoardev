contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: bbf78894-1a36-465f-8b22-7c59370eff6c
inputs:
- description: ""
  key: Domain
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Domain
      root: ExtractedIndicators
name: TCS-Domain Owner Verification  v3.3_copy
outputs:
- contextPath: ExtractedIndicators.Domain
  description: Domain
  type: unknown
sourceplaybookid: 10a892d4-e4b5-4b5e-80ea-dcaccb53541a
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0d5c3752-295e-4054-8d2e-f22c9c2c13e6
      iscommand: false
      name: ""
      version: -1
    taskid: 0d5c3752-295e-4054-8d2e-f22c9c2c13e6
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -210,
          "y": -1040
        }
      }
  "3":
    continueonerror: true
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "62"
      "yes":
      - "7"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.TCS_Customer_Domain_List}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: d7120443-a409-4a48-8075-cf222f3c0c6b
      iscommand: false
      name: Does Domain Belong To Customer ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: d7120443-a409-4a48-8075-cf222f3c0c6b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -670,
          "y": 310
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain4.Customer
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b0617a27-62ae-446a-8e4d-f347f93b842d
      iscommand: false
      name: Set Customer Domain into Context
      script: Set
      type: regular
      version: -1
    taskid: b0617a27-62ae-446a-8e4d-f347f93b842d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 550
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain3
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4b9b39b5-d037-4a16-840b-524d04852e91
      iscommand: false
      name: Set Output into Context
      script: Set
      type: regular
      version: -1
    taskid: 4b9b39b5-d037-4a16-840b-524d04852e91
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": 550
        }
      }
  "11":
    continueonerror: true
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "no":
      - "10"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.TCS_Customer_Domain_List},${lists.MasterIOC_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: c495f32f-4a24-4c43-8d18-2848fd316269
      iscommand: false
      name: Does Domain Belong To TCS or Customer or In Master IOC List?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: c495f32f-4a24-4c43-8d18-2848fd316269
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -210,
          "y": 320
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: true
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      actionnotification:
        simple: <p>Found Internal/Customer Domain in this file </p>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f3730892-7524-4b2e-89a2-6826b3746dc6
      iscommand: true
      name: Send Note That Internal/Customer Domain Found
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f3730892-7524-4b2e-89a2-6826b3746dc6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1500
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 85dd0bc9-4d5a-4ce0-8d87-b501fc149d85
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 85dd0bc9-4d5a-4ce0-8d87-b501fc149d85
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -430,
          "y": 2220
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7f7c4610-fca8-4595-84ec-ce4adc5672d0
      iscommand: false
      name: Generate Report & Notify
      type: title
      version: -1
    taskid: 7f7c4610-fca8-4595-84ec-ce4adc5672d0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -200,
          "y": 930
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain4.Customer
          operator: isNotExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: type
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: check for trusted ioc
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "36"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 500513d6-5a7f-4e3a-8313-19a154f7e292
      iscommand: false
      name: Verify There Are No Customer Domain In The List ?
      type: condition
      version: -1
    taskid: 500513d6-5a7f-4e3a-8313-19a154f7e292
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 1290
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: true
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      actionnotification:
        simple: <p>No Customer Domain Found in this file </p>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8e9e5679-bd24-47db-8c50-0c8e3df8d845
      iscommand: true
      name: Send Note That No Customer Domain Found
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8e9e5679-bd24-47db-8c50-0c8e3df8d845
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 1500
        }
      }
  "40":
    continueonerror: true
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${Domain4.Customer}
      retry-count:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: bb15f022-cabc-4459-8f4e-bb9ef1a9fab4
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2|||domain
      type: regular
      version: -1
    taskid: bb15f022-cabc-4459-8f4e-bb9ef1a9fab4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 750
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: true
    quietmode: 2
    scriptarguments:
      csvArray:
        simple: ${RecordedFuture.Domain}
      fileName:
        simple: Domain Risk Score.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 6759129a-a6f3-4b69-8120-ff6c122e5a90
      iscommand: false
      name: Generate CSV Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 6759129a-a6f3-4b69-8120-ff6c122e5a90
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1080
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: RecordedFuture
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "35"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d80b3867-1ec9-4116-8da0-f48cb0a617ec
      iscommand: false
      name: Is There a Report To Generate
      type: condition
      version: -1
    taskid: d80b3867-1ec9-4116-8da0-f48cb0a617ec
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 1080
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Domain2
      value:
        complex:
          accessor: Domain
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 015099ad-f38e-4608-80d0-2b018763893e
      iscommand: false
      name: Set Domain In New Context For DeDup
      script: Set
      type: regular
      version: -1
    taskid: 015099ad-f38e-4608-80d0-2b018763893e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 90,
          "y": -10
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Domain2
      value:
        complex:
          accessor: Domain_Test_
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a80a26db-5f9e-4d3f-8237-ebb8a57954db
      iscommand: false
      name: Set Unique Domain In New Context
      script: Set
      type: regular
      version: -1
    taskid: a80a26db-5f9e-4d3f-8237-ebb8a57954db
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 120
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators2.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain2
              operator: notContainsGeneral
              right:
                value:
                  simple: www.
          - - left:
                iscontext: true
                value:
                  simple: Domain2
              operator: notContainsGeneral
              right:
                value:
                  simple: /
          root: Domain2
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: .
              toReplace:
                value:
                  simple: '[.]'
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6b703374-562b-49f2-8b2c-d5cb467a245b
      iscommand: false
      name: Set New Unique Domains Into Extracted Indicators
      script: Set
      type: regular
      version: -1
    taskid: 6b703374-562b-49f2-8b2c-d5cb467a245b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 120
        }
      }
  "58":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain_Test_
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b509ff15-7c43-465d-85af-6525a4932fab
      iscommand: false
      name: Are there any Domains ?
      type: condition
      version: -1
    taskid: b509ff15-7c43-465d-85af-6525a4932fab
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -210,
          "y": -860
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: cdaff105-34b2-490c-843e-2b61187df8a7
      iscommand: false
      name: Delete Extracted Indicators Domain Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: cdaff105-34b2-490c-843e-2b61187df8a7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 220,
          "y": 550
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .tcs.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .ultimatix.net
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .google.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .microsoft.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .gstatic.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .amazonaws.com
          root: Domain3
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 181a9de1-f891-4d2a-8aa6-b7c1e4a1add0
      iscommand: false
      name: Set New Unique Domains Into Extracted Indicators
      script: Set
      type: regular
      version: -1
    taskid: 181a9de1-f891-4d2a-8aa6-b7c1e4a1add0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": 750
        }
      }
  "61":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain4.Customer
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "19"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 05046999-f343-4bf7-82f0-716a6aed7d34
      iscommand: false
      name: Is There a Internal/Customer Domain ?
      type: condition
      version: -1
    taskid: 05046999-f343-4bf7-82f0-716a6aed7d34
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1290
        }
      }
  "62":
    continueonerror: true
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "63"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.MasterIOC_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 8ebd063a-7a00-4a3d-8208-27f0ed4a0237
      iscommand: false
      name: Is Domain In Master IOC List ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 8ebd063a-7a00-4a3d-8208-27f0ed4a0237
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1110,
          "y": 320
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
      - "66"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain5.MasterIOC
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a17cb31d-9b67-4a83-8ce2-57a35dc66405
      iscommand: false
      name: Set Master IOC Domain into Context
      script: Set
      type: regular
      version: -1
    taskid: a17cb31d-9b67-4a83-8ce2-57a35dc66405
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1110,
          "y": 550
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: true
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      actionnotification:
        simple: <p> Found Domain In Master IOC </p>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 6410aa56-efbf-4826-81cf-1040f778319d
      iscommand: true
      name: Send Note as Found Domain In Master IOC
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6410aa56-efbf-4826-81cf-1040f778319d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 680,
          "y": 1500
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "54"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bb9c7f62-bafb-484a-89de-22dee7926a2a
      iscommand: false
      name: Is There Extracted Indicator Context ?
      type: condition
      version: -1
    taskid: bb9c7f62-bafb-484a-89de-22dee7926a2a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 90,
          "y": -300
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: MasterIOC
                root: Domain5
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: type
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: check for trusted ioc
        - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: block ioc
        - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: blacklist ioc
      label: "yes"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "64"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 37fbcd51-721d-4b50-8272-cc96a7500322
      iscommand: false
      name: Verify The Master IOC & Email Subject Condition
      type: condition
      version: -1
    taskid: 37fbcd51-721d-4b50-8272-cc96a7500322
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 680,
          "y": 1290
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
    note: false
    quietmode: 1
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          accessor: Domain_Test_
          root: ExtractedIndicators
          transformers:
          - args:
              chars:
                value:
                  simple: www.
            operator: StripChars
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 31ca1222-5821-435c-80dc-2a7c5c47e380
      iscommand: false
      name: Set Extracted Indicators Context (Strip www. & Unique)
      script: Set
      type: regular
      version: -1
    taskid: 31ca1222-5821-435c-80dc-2a7c5c47e380
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": -445
        }
      }
  "68":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain_Test_
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "70"
      "yes":
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3b6f0cc5-27f9-475e-8cf2-c32f9491c4eb
      iscommand: false
      name: Is Domain Test Context Defined ?
      type: condition
      version: -1
    taskid: 3b6f0cc5-27f9-475e-8cf2-c32f9491c4eb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -430,
          "y": -620
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain_Test_
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: a16277c6-edd0-4edf-8805-acaac87685d5
      iscommand: false
      name: Delete Domain Test Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: a16277c6-edd0-4edf-8805-acaac87685d5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": -260
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators2.Domain
      value:
        complex:
          accessor: Domain
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e61226d5-9169-4a9a-8ac0-096fb3fb0366
      iscommand: false
      name: Set Indicators In Context
      script: Set
      type: regular
      version: -1
    taskid: e61226d5-9169-4a9a-8ac0-096fb3fb0366
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": -80
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "58_33_#default#": 0.44
    },
    "paper": {
      "dimensions": {
        "height": 3325,
        "width": 2600,
        "x": -1110,
        "y": -1040
      }
    }
  }
