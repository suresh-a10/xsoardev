contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 16980641-dc12-41db-8e7c-7c7ebc57b470
inputs:
- description: ""
  key: Domain
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Domain
      root: ExtractedIndicators
name: TCS-Domain Owner Verification  v3.4
outputs:
- contextPath: ExtractedIndicators.Domain
  description: Domain
  type: unknown
sourceplaybookid: 10a892d4-e4b5-4b5e-80ea-dcaccb53541a
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 29b2b9f6-8d94-42eb-82ec-a2d36405c4e7
      iscommand: false
      name: ""
      version: -1
    taskid: 29b2b9f6-8d94-42eb-82ec-a2d36405c4e7
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -210,
          "y": -460
        }
      }
  "3":
    continueonerror: true
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "62"
      "yes":
      - "7"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.TCS_Customer_Domain_List}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 3dd5d8e2-a34a-41f3-8c57-255e53e1ef90
      iscommand: false
      name: Does Domain Belong To Customer ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 3dd5d8e2-a34a-41f3-8c57-255e53e1ef90
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 230,
          "y": 320
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain4.Customer
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4874125d-6e65-4ea8-820b-f9530cc61f68
      iscommand: false
      name: Set Customer Domain into Context
      script: Set
      type: regular
      version: -1
    taskid: 4874125d-6e65-4ea8-820b-f9530cc61f68
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 230,
          "y": 520
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain3
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 36473479-0add-422d-866c-d3def85d7e54
      iscommand: false
      name: Set Output into Context
      script: Set
      type: regular
      version: -1
    taskid: 36473479-0add-422d-866c-d3def85d7e54
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 520
        }
      }
  "11":
    continueonerror: true
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "no":
      - "10"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.TCS_Customer_Domain_List},${lists.MasterIOC_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 284ac7d0-a97c-40ad-8551-6b6d46422f5b
      iscommand: false
      name: Does Domain Belong To TCS or Customer or In Master IOC List?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 284ac7d0-a97c-40ad-8551-6b6d46422f5b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 670,
          "y": 320
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f36e7fa9-2487-48a8-8c0e-2f02b16fc1ed
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: f36e7fa9-2487-48a8-8c0e-2f02b16fc1ed
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -500,
          "y": 1680
        }
      }
  "40":
    continueonerror: true
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${Domain4.Customer}
      using:
        simple: Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: e68861ba-de24-4a67-84dc-6b2b75320ea0
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2|||domain
      type: regular
      version: -1
    taskid: e68861ba-de24-4a67-84dc-6b2b75320ea0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 230,
          "y": 710
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Domain2
      value:
        complex:
          accessor: Domain
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8363a0ef-d4b9-4602-87fb-3ca55ccf019f
      iscommand: false
      name: Set Domain In New Context For DeDup
      script: Set
      type: regular
      version: -1
    taskid: 8363a0ef-d4b9-4602-87fb-3ca55ccf019f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": 110
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Domain2
      value:
        complex:
          accessor: Domain_Test_
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9277c6d2-0d72-472e-8f32-22dffc0a30e8
      iscommand: false
      name: Set Unique Domain In New Context
      script: Set
      type: regular
      version: -1
    taskid: 9277c6d2-0d72-472e-8f32-22dffc0a30e8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 220,
          "y": 110
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators2.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain2
              operator: notContainsGeneral
              right:
                value:
                  simple: www.
          - - left:
                iscontext: true
                value:
                  simple: Domain2
              operator: notContainsGeneral
              right:
                value:
                  simple: /
          root: Domain2
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: .
              toReplace:
                value:
                  simple: '[.]'
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: ac362d24-a445-4f2e-8bd1-576acc5e4b7d
      iscommand: false
      name: Set New Unique Domains Into Extracted Indicators
      script: Set
      type: regular
      version: -1
    taskid: ac362d24-a445-4f2e-8bd1-576acc5e4b7d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 110
        }
      }
  "58":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain_Test_
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "65"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0a0a96cd-1ab8-47af-8316-21a2fdf98e17
      iscommand: false
      name: Are there any Domains ?
      type: condition
      version: -1
    taskid: 0a0a96cd-1ab8-47af-8316-21a2fdf98e17
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -210,
          "y": -320
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: fced1950-49df-4147-8d5b-2a631e45fc72
      iscommand: false
      name: Delete Extracted Indicators Domain Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: fced1950-49df-4147-8d5b-2a631e45fc72
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 710
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .tcs.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .ultimatix.net
          root: Domain3
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 752ffa51-5cb2-41e2-860c-f1ac56bdf1e8
      iscommand: false
      name: Set New Unique Domains Into Extracted Indicators
      script: Set
      type: regular
      version: -1
    taskid: 752ffa51-5cb2-41e2-860c-f1ac56bdf1e8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 900
        }
      }
  "62":
    continueonerror: true
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "63"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.MasterIOC_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: f987ddbd-e80f-4eb0-85e0-bf27d8663674
      iscommand: false
      name: Is Domain In Master IOC List ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: f987ddbd-e80f-4eb0-85e0-bf27d8663674
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -200,
          "y": 320
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain5.MasterIOC
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 99b237c7-35a2-4179-808c-643abf7d2a2a
      iscommand: false
      name: Set Master IOC Domain into Context
      script: Set
      type: regular
      version: -1
    taskid: 99b237c7-35a2-4179-808c-643abf7d2a2a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 520
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "54"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aea8b29d-9aeb-4e83-8310-7265a1790658
      iscommand: false
      name: Is There Extracted Indicator Context ?
      type: condition
      version: -1
    taskid: aea8b29d-9aeb-4e83-8310-7265a1790658
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -210,
          "y": -110
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "67"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${RecordedFuture.Domain}
      fileName:
        simple: Customer Domain_Risk Score.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: cc5a17fb-044e-4116-8d5d-a6918b885ffe
      iscommand: false
      name: Generate CSV Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: cc5a17fb-044e-4116-8d5d-a6918b885ffe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 230,
          "y": 900
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RecordedFuture
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: a1a3caba-92e2-4378-8413-0931cdf15038
      iscommand: false
      name: Delete Recorded Future Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: a1a3caba-92e2-4378-8413-0931cdf15038
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 230,
          "y": 1090
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 78966e86-b998-4d9f-897f-0dbe6d302976
      iscommand: false
      name: Set Report To Context
      script: Set
      type: regular
      version: -1
    taskid: 78966e86-b998-4d9f-897f-0dbe6d302976
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 230,
          "y": 1290
        }
      }
  "69":
    continueonerror: true
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${Domain5.MasterIOC}
      retry-count:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: 27672068-9ca5-44be-8ee4-fa6e651c099f
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2|||domain
      type: regular
      version: -1
    taskid: 27672068-9ca5-44be-8ee4-fa6e651c099f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 710
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${RecordedFuture.Domain}
      fileName:
        simple: MasterIOC Domain_Risk Score.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: d8ccc3bb-20a9-4f96-87a8-1a54c766cbc0
      iscommand: false
      name: Generate CSV Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: d8ccc3bb-20a9-4f96-87a8-1a54c766cbc0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 900
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "72"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RecordedFuture
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: d83c335c-4853-4b2c-8729-d305533b3c1e
      iscommand: false
      name: Delete Recorded Future Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: d83c335c-4853-4b2c-8729-d305533b3c1e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1090
        }
      }
  "72":
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8bcdfe9a-28b4-4ca8-85da-61b614b5f478
      iscommand: false
      name: Set Report To Context
      script: Set
      type: regular
      version: -1
    taskid: 8bcdfe9a-28b4-4ca8-85da-61b614b5f478
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1290
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "58_33_#default#": 0.46
    },
    "paper": {
      "dimensions": {
        "height": 2205,
        "width": 1550,
        "x": -500,
        "y": -460
      }
    }
  }
