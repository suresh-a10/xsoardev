contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 563fb8c4-d4f3-4378-81c4-7052068d2ad8
inputs: []
name: TCS-IP_OwnerDetails_PG_v1.0
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c989a2c5-453a-4877-8feb-8a83afcd1f57
      iscommand: false
      name: ""
      version: -1
    taskid: c989a2c5-453a-4877-8feb-8a83afcd1f57
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        complex:
          accessor: enterioc
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: af703824-f282-4d43-8e02-6b90501b9c9d
      iscommand: true
      name: Extract the IOC from incident
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: af703824-f282-4d43-8e02-6b90501b9c9d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 200
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      using:
        simple: AbuseIPDB_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: AbuseIPDB
      description: Checks the specified IP address against the AbuseIP database.
      id: e67cd433-4ebe-4bdd-8f1e-0e4808f316fc
      iscommand: true
      name: Extract the indicators
      script: AbuseIPDB|||ip
      type: regular
      version: -1
    taskid: e67cd433-4ebe-4bdd-8f1e-0e4808f316fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 380
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: CSP
      value:
        complex:
          accessor: IP
          root: AbuseIPDB
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 78e9cd7c-f154-45c7-8caf-7d4c8043fa4f
      iscommand: false
      name: Set Context
      script: Set
      type: regular
      version: -1
    taskid: 78e9cd7c-f154-45c7-8caf-7d4c8043fa4f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 575
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: CSP
      stringify:
        simple: "true"
      value:
        complex:
          accessor: ISP
          root: AbuseIPDB.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 7d30229b-2ea7-482e-85ce-004a3cff3e29
      iscommand: false
      name: Set context (Investigation Analysis)
      script: Set
      type: regular
      version: -1
    taskid: 7d30229b-2ea7-482e-85ce-004a3cff3e29
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -180,
          "y": 640
        }
      }
  "6":
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: FILE
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: true
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${CSP}
      fileName:
        simple: ISP.csv
      headers:
        simple: Address,ISP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 36deb94d-b34e-4a10-80db-a57a221ec4d2
      iscommand: false
      name: Generate Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 36deb94d-b34e-4a10-80db-a57a221ec4d2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 775
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: fdde269f-f27b-4155-856c-7aca8b63fe0c
      iscommand: false
      name: Set IOC Report To Context
      script: Set
      type: regular
      version: -1
    taskid: fdde269f-f27b-4155-856c-7aca8b63fe0c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 970
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name:
        simple: sample
      type:
        simple: pdf
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: 535585ae-4e28-4554-851e-c606cd741be0
      iscommand: false
      name: Untitled Task
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: 535585ae-4e28-4554-851e-c606cd741be0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1240,
          "y": 530
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hi Team,

                  Zcaler Ip's fetched sucessfully

          Regards,
          Cyberbot
      subject:
        simple: Zscaler-Autofetch indicators
      to:
        simple: keerthana.ramesh@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 670303fd-6ce4-4dac-84a8-e3584b757231
      iscommand: true
      name: Send Mail to Team
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 670303fd-6ce4-4dac-84a8-e3584b757231
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1520
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: ee020387-228a-41aa-8db8-e91e116860df
      iscommand: true
      name: Closeinvestigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: ee020387-228a-41aa-8db8-e91e116860df
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1150
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a5dcedcf-9204-41d8-8827-b06ba077bad0
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: a5dcedcf-9204-41d8-8827-b06ba077bad0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1330
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1565,
        "width": 1800,
        "x": -180,
        "y": 50
      }
    }
  }
