contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: c49b9c0f-60f3-4deb-855d-2a133d4267c1
inputs: []
name: TCS-Qradar Hunt for IOC_V1.2
outputs: []
sourceplaybookid: 7edb4ef0-ae29-4a85-8df5-6df16b8c3bad
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 55940fee-f07d-4574-8e95-8ec4891b8c96
      iscommand: false
      name: ""
      version: -1
    taskid: 55940fee-f07d-4574-8e95-8ec4891b8c96
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 255,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: db99fd6e-8e46-4a56-8c77-8e23f80aabdd
      iscommand: true
      name: 'Extract Indicators '
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: db99fd6e-8e46-4a56-8c77-8e23f80aabdd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 550,
          "y": 390
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: ${incident.id}_Hunt_IOC_IP
      value:
        simple: ${ExtractedIndicators.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Add or update a value in a reference set.
      id: 30f8030d-18a1-4c41-8356-9909938a6fcb
      iscommand: true
      name: Populate IP to reference set OnDemandHuntingIPs
      script: QRadar_v2_copy|||qradar-create-reference-set-value
      type: regular
      version: -1
    taskid: 30f8030d-18a1-4c41-8356-9909938a6fcb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 560,
          "y": 895
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 25697c95-6fc1-4f3b-839c-1a14599522b1
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 25697c95-6fc1-4f3b-839c-1a14599522b1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 60,
          "y": 2100
        }
      }
  "11":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: sonam.bhandari@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: internalis.cybersecurityops@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: v.ghule@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: nishanth.dharuman@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      - "31"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8bde5a56-7755-4223-86fe-4565aeba9cae
      iscommand: false
      name: Is Email from Authorised Sender
      type: condition
      version: -1
    taskid: 8bde5a56-7755-4223-86fe-4565aeba9cae
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 255,
          "y": 195
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: ${AQLIPSearchSource}
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 4938bf8b-d93e-492c-881e-31fa75ae437b
      iscommand: false
      name: QRadarFullSearch_v1.0_Source
      playbookId: 1af6d691-c912-44b9-8502-2b9b2acc4e74
      type: playbook
      version: -1
    taskid: 4938bf8b-d93e-492c-881e-31fa75ae437b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 785,
          "y": 1255
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: ${AQLIPSearchDestination}
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: e4e21683-f302-4c88-82d8-e84496c5c89a
      iscommand: false
      name: QRadarFullSearch_v1.0_Destination
      playbookId: 1af6d691-c912-44b9-8502-2b9b2acc4e74
      type: playbook
      version: -1
    taskid: e4e21683-f302-4c88-82d8-e84496c5c89a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1275
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      body:
        simple: "Hi Team , \n\nPlease find the attached hunt result .\n\nThanks\nCyberSecurity
          AutoBot\n"
      subject:
        simple: Hunt IOC Report from Qradar
      to:
        simple: ${incident.labels.Email/from}
      using:
        simple: EWS Mail Sender_Autobot
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 75613823-177a-4724-82bd-c3dd1cb3eed4
      iscommand: true
      name: Send report via email
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 75613823-177a-4724-82bd-c3dd1cb3eed4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1775
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d6e2dea0-2899-4ef0-8d62-93207bc9c59a
      iscommand: false
      name: Are there IPs to Hunt
      type: condition
      version: -1
    taskid: d6e2dea0-2899-4ef0-8d62-93207bc9c59a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 550,
          "y": 545
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        complex:
          accessor: events}
          root: ${subplaybook-13.QRadar.Search.Result
      fileName:
        simple: Presence of IOC in Destination.csv
      headers:
        simple: Destination IP,Destination Port,Event Count,Event Name,Log Source,Low
          Level Category,Magnitude,Source IP,Source Port,Time
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: c9df500f-3e5b-4ada-8c3f-ea7da4e3777e
      iscommand: false
      name: Presence of IOC in Destination
      script: ExportToCSV
      type: regular
      version: -1
    taskid: c9df500f-3e5b-4ada-8c3f-ea7da4e3777e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1590
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${subplaybook-12.QRadar.Search.Result.events}
      fileName:
        simple: Presence of IOC in Source.csv
      headers:
        simple: Destination IP,Destination Port,Event Count,Event Name,Log Source,Low
          Level Category,Magnitude,Source IP,Source Port,Time
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 713ab3f0-3d96-40bd-8498-a4d87771ad05
      iscommand: false
      name: Presence of IOC in Source
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 713ab3f0-3d96-40bd-8498-a4d87771ad05
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 785,
          "y": 1590
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AQLIPSearchDestination
      value:
        simple: select QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as
          'Log Source',"eventCount" as 'Event Count',"startTime" as 'Time',categoryname(category)
          as 'Low Level Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source
          Port',"destinationIP" as 'Destination IP',"destinationPort" as 'Destination
          Port',"userName" as 'Username',"magnitude" as 'Magnitude' from events where
          referencesetcontains('${incident.id}_Hunt_IOC_IP', "destinationIP") order
          by "startTime" desc last 30 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 07d8ba79-9f3b-41df-89ef-88822ad28109
      iscommand: false
      name: create IP search in Destination AQL
      script: Set
      type: regular
      version: -1
    taskid: 07d8ba79-9f3b-41df-89ef-88822ad28109
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1090
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AQLIPSearchSource
      value:
        simple: select QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as
          'Log Source',"eventCount" as 'Event Count',"startTime" as 'Time',categoryname(category)
          as 'Low Level Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source
          Port',"destinationIP" as 'Destination IP',"destinationPort" as 'Destination
          Port',"userName" as 'Username',"magnitude" as 'Magnitude' from events where
          referencesetcontains('${incident.id}_Hunt_IOC_IP', "sourceIP") order by
          "startTime" desc last 30 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2d08d1fc-8ec3-441c-8a36-61b31934568f
      iscommand: false
      name: create IP search in Source AQL
      script: Set
      type: regular
      version: -1
    taskid: 2d08d1fc-8ec3-441c-8a36-61b31934568f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 785,
          "y": 1090
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: ${incident.id}_Hunt_IOC_IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Deletes a reference set corresponding to the name provided.
      id: 440293e4-d2ec-43c1-88b5-3e4a6367bbe3
      iscommand: true
      name: Delete IP Reference Set
      script: QRadar_v2_copy|||qradar-delete-reference-set
      type: regular
      version: -1
    taskid: 440293e4-d2ec-43c1-88b5-3e4a6367bbe3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1930
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      element_type:
        simple: IP
      ref_name:
        simple: ${incident.id}_Hunt_IOC_IP
      using:
        simple: QRadar v3_Typosquat Offences
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a new reference set. If the provided name is already in
        use, this command will fail.
      id: 9ba1c079-79f7-4c96-8824-87471cad460d
      iscommand: true
      name: Create Reference Set
      script: '|||qradar-create-reference-set'
      type: regular
      version: -1
    taskid: 9ba1c079-79f7-4c96-8824-87471cad460d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 560,
          "y": 740
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: sonam.bhandari@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: internalis.cybersecurityops@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: v.ghule@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: komal.lugade@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: edef648f-1f30-417f-8cf3-69b1d5b8699f
      iscommand: false
      name: Is Email from Authorised Sender
      type: condition
      version: -1
    taskid: edef648f-1f30-417f-8cf3-69b1d5b8699f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -150,
          "y": 370
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${subplaybook-12.QRadar.Search.Result.events}
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 57ac1080-4870-4cde-8c61-93969e0845f3
      iscommand: false
      name: Are there any findings?
      type: condition
      version: -1
    taskid: 57ac1080-4870-4cde-8c61-93969e0845f3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 785,
          "y": 1430
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${subplaybook-13.QRadar.Search.Result.events}
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 79555e2b-69ec-486b-8ad3-90f74dda1897
      iscommand: false
      name: Are there any findings?
      type: condition
      version: -1
    taskid: 79555e2b-69ec-486b-8ad3-90f74dda1897
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1430
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2115,
        "width": 1315,
        "x": -150,
        "y": 50
      }
    }
  }
