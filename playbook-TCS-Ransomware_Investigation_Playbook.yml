contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 8b17410f-2865-47f4-8917-43596c8da847
inputs: []
name: TCS-Ransomware Investigation Playbook
outputs: []
sourceplaybookid: de222b92-fc61-4b42-8cc8-535ec9f9c4b5
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b8b0fafc-65c4-4942-8f43-f90ebbb0ddd4
      iscommand: false
      name: ""
      version: -1
    taskid: b8b0fafc-65c4-4942-8f43-f90ebbb0ddd4
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": -450
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ee1f62e9-03b1-45e7-8ea1-9f94e6a0a9f7
      iscommand: false
      name: Analysis
      type: title
      version: -1
    taskid: ee1f62e9-03b1-45e7-8ea1-9f94e6a0a9f7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": -335
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      hash:
        complex:
          accessor: sha256
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns a verdict for a hash.
      id: 84c0a7eb-fb4d-4744-8fe3-0750ed3f16c3
      iscommand: true
      name: IS File hash found in Malware DB?
      script: '|||wildfire-get-verdict'
      type: regular
      version: -1
    taskid: 84c0a7eb-fb4d-4744-8fe3-0750ed3f16c3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": -50
        }
      }
  "4":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Upload timeline logs
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: attachments
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Notes
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: ""
      title: Timeline logs info
      totalanswers: 0
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 633f6a7a-1433-445c-8f68-298ab85af5e6
      iscommand: false
      name: Get  host timeline logs and upload attachment
      type: collection
      version: -1
    taskid: 633f6a7a-1433-445c-8f68-298ab85af5e6
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 405
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: WildFire.Verdicts.VerdictDescription
          operator: isEqualString
          right:
            value:
              simple: benign
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 245ea65b-f282-4ace-86c7-e16ac3d4ecf2
      iscommand: false
      name: If file verdict is benign
      type: condition
      version: -1
    taskid: 245ea65b-f282-4ace-86c7-e16ac3d4ecf2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 105
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a5834eb7-ab8a-4f42-8e0d-c3ca058cacd7
      iscommand: false
      name: Close this case as a false positive
      type: regular
      version: -1
    taskid: a5834eb7-ab8a-4f42-8e0d-c3ca058cacd7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1530
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Dear Team,

          PFA details of Unknown or malicious hash observed

          Crowdstrike Details:
          ${CrowdStrike.Device}

          Wildfire Verdict for file hash :
          ${WildFire.Verdicts}
      subject:
        simple: '!! Need Attention !! Unknown or Malicious hash observed_${incident.id}'
      to:
        simple: v.ghule@tcs.com,sonam.bhandari@tcs.com,jha.sweta1@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: f47fc11d-876e-4105-8730-4f8d300b3386
      iscommand: true
      name: Notify CSOC Manger
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: f47fc11d-876e-4105-8730-4f8d300b3386
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1560
        }
      }
  "9":
    continueonerrortype: ""
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: ""
      headerfontcolor: ""
      isexternalrtl: false
      sender: ""
      submitbuttonbackgroundcolor: ""
      submitbuttonfontcolor: ""
      submittext: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: 'Are there encryption capabilities '
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject:
        simple: 'Are there encryption capabilities '
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      "No":
      - "41"
      "Yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check encryption capabilities of malicious file . found and not
        found
      id: 0e1d215a-794d-4ee0-8a68-8a9460a7856b
      iscommand: false
      name: 'Check encryption capabilities of malicious file  '
      type: condition
      version: -1
    taskid: 0e1d215a-794d-4ee0-8a68-8a9460a7856b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1730
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: Malware Investigation Benign Hash
      value:
        simple: ${incident.sha256}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Add or update a value in a reference set.
      id: c801fbc1-49fc-4b44-868a-d9486831a886
      iscommand: true
      name: Update SIEM reference set
      script: '|||qradar-create-reference-set-value'
      type: regular
      version: -1
    taskid: c801fbc1-49fc-4b44-868a-d9486831a886
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1720
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: WildFire.Verdicts.Verdict
          operator: isEqualString
          right:
            value:
              simple: benign
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c81ea02d-b689-4cad-85c1-505e715196e3
      iscommand: false
      name: If file verdict is benign
      type: condition
      version: -1
    taskid: c81ea02d-b689-4cad-85c1-505e715196e3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1195
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          root: CrowdStrike.Device
          transformers:
          - operator: uniq
      using:
        simple: CrowdstrikeFalcon_Host Contain
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Contains containment for a specified host. When contained, a host
        can only communicate with the CrowdStrike cloud and any IPs specified in your
        containment policy.
      id: df87c0ac-cb2e-4241-8e1f-a6d761fcf654
      iscommand: true
      name: Isolate the Endpoints/Contain host
      script: CrowdstrikeFalcon|||cs-falcon-contain-host
      type: regular
      version: -1
    taskid: df87c0ac-cb2e-4241-8e1f-a6d761fcf654
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1385
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      ioc_type:
        simple: sha256
      value:
        simple: ${WildFire.Verdicts.SHA256}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Updates an indicator for CrowdStrike to monitor.
      id: 5aff4f4c-12fa-4e94-845a-b4885385a214
      iscommand: true
      name: 'Block  Hash /upload hash '
      script: CrowdstrikeFalcon|||cs-falcon-update-ioc
      type: regular
      version: -1
    taskid: 5aff4f4c-12fa-4e94-845a-b4885385a214
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 2370
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      subject:
        simple: File founsd to be malicious
      to:
        simple: v.ghule@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 80121c12-f641-46a1-8138-d73f4fca4d14
      iscommand: true
      name: Notify CSOC Manger/ Stakeholders
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 80121c12-f641-46a1-8138-d73f4fca4d14
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 2215
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: ${AQL}
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 0a9d175a-cf93-4edb-8364-3cd7e998f92a
      iscommand: false
      name: QRadarFullSearch_v1.0
      playbookId: 1af6d691-c912-44b9-8502-2b9b2acc4e74
      type: playbook
      version: -1
    taskid: 0a9d175a-cf93-4edb-8364-3cd7e998f92a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -230,
          "y": 2330
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: QRadar.Search.Result
          operator: isExists
      label: "YES"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "YES":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4d04042f-4d6a-47f8-8538-765e6e54a626
      iscommand: false
      name: 'Check QRadra search results if hostname is present or not? '
      type: condition
      version: -1
    taskid: 4d04042f-4d6a-47f8-8538-765e6e54a626
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -230,
          "y": 2475
        }
      }
  "19":
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: .
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Are All machines contained
        options: []
        optionsarg:
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      sender: Your SOC team
      title: Are All machines contained
      totalanswers: 0
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: ""
      headerfontcolor: ""
      isexternalrtl: false
      sender: ""
      submitbuttonbackgroundcolor: ""
      submitbuttonfontcolor: ""
      submittext: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Manually contain host
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    note: true
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Contains containment for a specified host. When contained, a host
        can only communicate with the CrowdStrike cloud and any IPs specified in your
        containment policy.
      id: 83794e55-7f1c-41d9-8ed1-408b55edca66
      iscommand: false
      name: Manually contain host
      type: collection
      version: -1
    taskid: 83794e55-7f1c-41d9-8ed1-408b55edca66
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -240,
          "y": 2660
        }
      }
  "20":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Delete file from users machines through RTR or manually
        options: []
        optionsarg:
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Delete file from users machines through RTR or manually
      totalanswers: 0
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Delete file from users machines through RTR or manually
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 53a6ef96-80e7-4915-8068-30e8d938bc6c
      iscommand: false
      name: 'Analyst Task -Delete file and Process from users machines '
      type: collection
      version: -1
    taskid: 53a6ef96-80e7-4915-8068-30e8d938bc6c
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 2640
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check health status of endpoints machines if found clean then isolate
        the system
      id: 9c13e489-b312-481e-805b-0725ce365264
      iscommand: false
      name: Check health status of endpoints machines( Is endpoint clean)
      type: regular
      version: -1
    taskid: 9c13e489-b312-481e-805b-0725ce365264
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 2805
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 68a28852-3dce-471e-852f-71e892ec1560
      iscommand: false
      name: Remove system from containmet
      type: regular
      version: -1
    taskid: 68a28852-3dce-471e-852f-71e892ec1560
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 2970
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 12460c75-3521-47ba-874e-e27dd0611f7c
      iscommand: false
      name: Review ,Update and Close the ticket
      type: regular
      version: -1
    taskid: 12460c75-3521-47ba-874e-e27dd0611f7c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 3840
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bfaf9e2f-b17b-45cb-8922-6e5d52b86552
      iscommand: false
      name: For unknown/malicious hash
      type: title
      version: -1
    taskid: bfaf9e2f-b17b-45cb-8922-6e5d52b86552
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 280
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2476fe44-1491-4eae-8346-8d720bdc7cf3
      iscommand: false
      name: Close
      type: title
      version: -1
    taskid: 2476fe44-1491-4eae-8346-8d720bdc7cf3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 4015
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1caf99af-3e21-4654-8c87-9501f10981ad
      iscommand: false
      name: Cleanup and Restoration Activities
      type: title
      version: -1
    taskid: 1caf99af-3e21-4654-8c87-9501f10981ad
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 2525
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 12c9110f-5799-4e7e-89a4-e3b64dd4330b
      iscommand: false
      name: Suspected malware
      type: title
      version: -1
    taskid: 12c9110f-5799-4e7e-89a4-e3b64dd4330b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 1940
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5a8b4865-000e-4b40-8ec7-bde247e10bb1
      iscommand: false
      name: Raise IMT
      type: regular
      version: -1
    taskid: 5a8b4865-000e-4b40-8ec7-bde247e10bb1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 2055
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AQL
      value:
        simple: xyz
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 42b8fa5d-b429-4385-8ab9-d3c6157c21d1
      iscommand: false
      name: Build CS Query
      script: Set
      type: regular
      version: -1
    taskid: 42b8fa5d-b429-4385-8ab9-d3c6157c21d1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -230,
          "y": 2150
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      host_id:
        complex:
          accessor: ID
          root: CrowdStrike.Device
      sha256:
        complex:
          accessor: sha256
          root: incident
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Gets the RTR extracted file contents for the specified session
        and SHA256 hash.
      id: a95c7418-ace8-4190-8bda-b21bdad10fb3
      iscommand: true
      name: Extract file from RTR
      script: CrowdstrikeFalcon|||cs-falcon-get-extracted-file
      type: regular
      version: -1
    taskid: a95c7418-ace8-4190-8bda-b21bdad10fb3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 880
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: crowdstrikedetectionid
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: ':'
            operator: splitAndTrim
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: 97c02ba1-5a31-4d03-8c1c-49a47575f4ef
      iscommand: true
      name: CS falcon seach device
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: 97c02ba1-5a31-4d03-8c1c-49a47575f4ef
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 565
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      assignBy:
        simple: machine-learning
      roles:
        complex:
          root: inputs.Role
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Assign analyst to incident.
        By default,  the analyst is picked randomly from the available users, according to the provided roles (if no roles provided, will fetch all users).
        Otherwise, the analyst will be picked according to the 'assignBy' arguments.
        machine-learning: DBot will calculated and decide who is the best analyst for the job.
        top-user: The user that is most commonly owns this type of incident
        less-busy-user: The less busy analyst will be picked to be the incident owner.
        online: The analyst is picked randomly from all online analysts, according to the provided roles (if no roles provided, will fetch all users).
        current: The user that executed the command
      id: 3b2d0055-cf71-4b7b-8f9c-69b13f302662
      iscommand: false
      name: 'Incident Assignment '
      script: AssignAnalystToIncident
      type: regular
      version: -1
    taskid: 3b2d0055-cf71-4b7b-8f9c-69b13f302662
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": -210
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 11820461-6565-49be-8c4b-9a19b19654fb
      iscommand: false
      name: WildFire - Detonate file
      playbookId: WildFire - Detonate file
      type: playbook
      version: -1
    taskid: 11820461-6565-49be-8c4b-9a19b19654fb
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1040
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    scriptarguments:
      file_path:
        complex:
          accessor: crowdstrikecmdline
          root: incident
      host_ids:
        complex:
          accessor: ID
          root: CrowdStrike.Device
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Batch executes 'get' command across hosts to retrieve files.
      id: 924ef9df-3975-4d0b-8d65-cc887ecac5dc
      iscommand: true
      name: Get file trough RTR (Manually insert file path)
      script: CrowdstrikeFalcon|||cs-falcon-run-get-command
      type: regular
      version: -1
    taskid: 924ef9df-3975-4d0b-8d65-cc887ecac5dc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 720
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 1f05d161-764b-4cc5-8a00-8b9a6cbbe11b
      iscommand: false
      name: 'TCS-MALWARE INVESTIGATION PLAYBOOK '
      playbookId: de222b92-fc61-4b42-8cc8-535ec9f9c4b5
      type: playbook
      version: -1
    taskid: 1f05d161-764b-4cc5-8a00-8b9a6cbbe11b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1940
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9cba2c7e-ae36-4a4d-839e-a9b783773e06
      iscommand: false
      name: Create list of  infected file to recover from backup
      type: regular
      version: -1
    taskid: 9cba2c7e-ae36-4a4d-839e-a9b783773e06
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 3140
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0eedabb3-d062-4438-8fae-ebffa95f021c
      iscommand: false
      name: Use Decryption software which is available
      type: regular
      version: -1
    taskid: 0eedabb3-d062-4438-8fae-ebffa95f021c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 3310
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: {}
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "46"
      "yes":
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8f2acf92-e1e5-4d58-85e6-c718a9b85a4b
      iscommand: false
      name: IS malicious IOC discover in backup
      type: condition
      version: -1
    taskid: 8f2acf92-e1e5-4d58-85e6-c718a9b85a4b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 3475
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 43988065-2149-4c87-8455-5deb5e648e51
      iscommand: false
      name: Delete backup from system
      type: regular
      version: -1
    taskid: 43988065-2149-4c87-8455-5deb5e648e51
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 790,
          "y": 3650
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 48168a17-5219-454f-8a90-72bb37794d5a
      iscommand: false
      name: 'Reimage system and Restore data from backup '
      type: regular
      version: -1
    taskid: 48168a17-5219-454f-8a90-72bb37794d5a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 3650
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6eb25b1c-660c-441a-8bcc-67364e2e4a4c
      iscommand: false
      name: Send mail to user
      type: regular
      version: -1
    taskid: 6eb25b1c-660c-441a-8bcc-67364e2e4a4c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1030
        }
      }
  "48":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Are you aware of the mentioned file? '
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: 'Why these files have executed?​  What is the purpose of this file? '
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: 'Is it an Internal develop file? and  project name '
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: shortText
      sender: ""
      title: Ask Question
      totalanswers: 0
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: "Are you aware of the mentioned file? \nWhy these files have executed?​\nWhat
          is the purpose of this file? \nIs it an Internal develop file? "
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 931a6366-cb55-455c-8c0f-02135f8557c4
      iscommand: false
      name: "Ask below questions\nAre you aware of the mentioned file? \nWhy these
        files have executed?​\nWhat is the purpose of this file? \nIs it an Internal
        develop file? "
      type: collection
      version: -1
    taskid: 931a6366-cb55-455c-8c0f-02135f8557c4
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1240
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4530,
        "width": 1540,
        "x": -240,
        "y": -450
      }
    }
  }
