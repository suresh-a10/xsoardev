contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.5.0
    itemVersion: 1.6.7
    packID: ""
    packName: Recorded Future Intelligence
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: Template playbook to incorporate Recorded Future enrichment for IPs,
  Hashes, Domains, URLs into your current workflows. Playbook also shows how to look
  up available 'Links' data for IOCs.
id: 9fd8be93-2567-4996-822b-7042d4e9ee00
inputs:
- description: File MD5 hash to enrich.
  key: MD5
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: MD5
      root: File
      transformers:
      - operator: uniq
- description: The file SHA256 hash to enrich.
  key: SHA256
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: SHA256
      root: File
      transformers:
      - operator: uniq
- description: The file SHA1 hash to enrich.
  key: SHA1
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: SHA1
      root: File
      transformers:
      - operator: uniq
- description: The IP Address to enrich.
  key: IP
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: IP
      root: ExtractedIndicators
- description: The Domain name to enrich.
  key: Domain
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Domain
      root: ExtractedIndicators
- description: The URL to enrich.
  key: URL
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: URL
      root: ExtractedIndicators
name: TCS-Recorded Future Entity Enrichment v1.0-PG
outputs:
- contextPath: DBotScore.Indicator
  description: The indicator that was tested.
  type: string
- contextPath: DBotScore.Type
  description: The indicator type.
  type: string
- contextPath: DBotScore
  description: The DBotScore object.
  type: unknown
- contextPath: DBotScore.Vendor
  description: Vendor used to calculate the score.
  type: string
- contextPath: DBotScore.Score
  description: The actual score.
  type: number
sourceplaybookid: Recorded Future Entity Enrichment
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fd60ba5f-044d-497f-846c-d32e5ae118ed
      iscommand: false
      name: ""
      version: -1
    taskid: fd60ba5f-044d-497f-846c-d32e5ae118ed
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 50
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2235a855-3d25-463b-8e58-087decdcb729
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 2235a855-3d25-463b-8e58-087decdcb729
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 2150
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.SHA256
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${File.SHA256}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if there is a SHA256 hash in context.
      id: 1e37a8f5-9a8c-453b-8d9d-984cc0743365
      iscommand: false
      name: Is there a SHA256 hash?
      type: condition
      version: -1
    taskid: 1e37a8f5-9a8c-453b-8d9d-984cc0743365
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 515
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.SHA1
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if there is a SHA1 hash in context.
      id: b1a94d7c-2b8a-4c36-8b8e-c1cdf0b85f52
      iscommand: false
      name: Is there a SHA1 hash?
      type: condition
      version: -1
    taskid: b1a94d7c-2b8a-4c36-8b8e-c1cdf0b85f52
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2300,
          "y": 515
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.MD5
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if there is a SHA1 hash in context.
      id: 9c6cd782-1ea5-422f-89b1-a2dcf376e1ab
      iscommand: false
      name: Is there a MD5 hash?
      type: condition
      version: -1
    taskid: 9c6cd782-1ea5-422f-89b1-a2dcf376e1ab
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 950,
          "y": 515
        }
      }
  "28":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
        - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain_Test_
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if there is a SHA1 hash in context.
      id: 9c7ed148-664c-40ae-8839-44d41a2beb37
      iscommand: false
      name: Is there a Domain?
      type: condition
      version: -1
    taskid: 9c7ed148-664c-40ae-8839-44d41a2beb37
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1850,
          "y": 515
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if there is a SHA1 hash in context.
      id: 0c54ecf2-848c-424e-880c-350f276ad4db
      iscommand: false
      name: Is there a URL?
      type: condition
      version: -1
    taskid: 0c54ecf2-848c-424e-880c-350f276ad4db
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 510,
          "y": 515
        }
      }
  "30":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if there is a SHA1 hash in context.
      id: b51f555d-8e78-4c2a-8bd3-6bdd9881abc3
      iscommand: false
      name: Is there a IP?
      type: condition
      version: -1
    taskid: b51f555d-8e78-4c2a-8bd3-6bdd9881abc3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 515
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        complex:
          root: inputs.MD5
      entity_type:
        simple: file
      fetch_related_entities:
        simple: "no"
      fetch_riskyCIDRips:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL or File.
      id: be52e635-5991-4133-814d-73389165ba00
      iscommand: true
      name: Recorded Future MD5 Intel
      script: Recorded Future v2|||recordedfuture-intelligence
      type: regular
      version: -1
    taskid: be52e635-5991-4133-814d-73389165ba00
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1062.5,
          "y": 690
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        complex:
          root: inputs.SHA1
      entity_type:
        simple: file
      fetch_related_entities:
        simple: "no"
      fetch_riskyCIDRips:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL or File.
      id: 4f8bd43d-f2ec-4c79-8ef0-95d389e3e01e
      iscommand: true
      name: Recorded Future SHA1 Intel
      script: Recorded Future v2|||recordedfuture-intelligence
      type: regular
      version: -1
    taskid: 4f8bd43d-f2ec-4c79-8ef0-95d389e3e01e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2412.5,
          "y": 690
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        complex:
          root: inputs.SHA256
      entity_type:
        simple: file
      fetch_related_entities:
        simple: "no"
      fetch_riskyCIDRips:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL or File.
      id: d840cae0-7021-45cb-860c-faf57fb605b9
      iscommand: true
      name: Recorded Future SHA256 Intel
      script: Recorded Future v2|||recordedfuture-intelligence
      type: regular
      version: -1
    taskid: d840cae0-7021-45cb-860c-faf57fb605b9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 690
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        complex:
          root: inputs.URL
      entity_type:
        simple: url
      fetch_related_entities:
        simple: "no"
      fetch_riskyCIDRips:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL or File.
      id: e5dc08dc-6343-4cdb-8f94-cee77f1c1555
      iscommand: true
      name: Recorded Future URL Intel
      script: Recorded Future v2|||recordedfuture-intelligence
      type: regular
      version: -1
    taskid: e5dc08dc-6343-4cdb-8f94-cee77f1c1555
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 720
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      entity_type:
        simple: domain
      fetch_related_entities:
        simple: "no"
      fetch_riskyCIDRips:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL or File.
      id: cc064a14-1e31-4da1-8e33-17aab8baea4b
      iscommand: true
      name: Recorded Future Domain Intel
      script: Recorded Future v2|||recordedfuture-intelligence
      tags:
      - rf
      type: regular
      version: -1
    taskid: cc064a14-1e31-4da1-8e33-17aab8baea4b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1962.5,
          "y": 690
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        complex:
          accessor: IP
          root: ExtractedIndicators
      entity_type:
        simple: ip
      fetch_related_entities:
        simple: "no"
      fetch_riskyCIDRips:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get threat intelligence for an IP, Domain, CVE, URL or File.
      id: 2312dd0f-effa-45d3-8b75-9092bd894a90
      iscommand: true
      name: Recorded Future IP Intel
      script: Recorded Future v2|||recordedfuture-intelligence
      type: regular
      version: -1
    taskid: 2312dd0f-effa-45d3-8b75-9092bd894a90
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1512.5,
          "y": 690
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        complex:
          root: inputs.SHA1
      entity_type:
        simple: file
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get Insikt Group Research Links for an IP, Domain, CVE, URL or
        File.
      id: 4102d71b-1138-48ad-8137-4df7c8b145fa
      iscommand: true
      name: Recorded Future Link Research (SHA1)
      script: Recorded Future v2|||recordedfuture-links
      type: regular
      version: -1
    taskid: 4102d71b-1138-48ad-8137-4df7c8b145fa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2412.5,
          "y": 865
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        complex:
          root: inputs.SHA256
      entity_type:
        simple: file
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get Insikt Group Research Links for an IP, Domain, CVE, URL or
        File.
      id: de185b3c-3786-4dd9-8891-ee24e276ebe2
      iscommand: true
      name: Recorded Future Link Research (SHA256)
      script: Recorded Future v2|||recordedfuture-links
      type: regular
      version: -1
    taskid: de185b3c-3786-4dd9-8891-ee24e276ebe2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 865
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        complex:
          root: inputs.MD5
      entity_type:
        simple: file
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get Insikt Group Research Links for an IP, Domain, CVE, URL or
        File.
      id: 61bef647-e473-4a6d-88d5-610298f36d58
      iscommand: true
      name: Recorded Future Link Research (MD5)
      script: Recorded Future v2|||recordedfuture-links
      type: regular
      version: -1
    taskid: 61bef647-e473-4a6d-88d5-610298f36d58
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1062.5,
          "y": 865
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        complex:
          root: inputs.URL
      entity_type:
        simple: url
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get Insikt Group Research Links for an IP, Domain, CVE, URL or
        File.
      id: 394fb624-df5d-44c4-82f3-cbbdbe4c627d
      iscommand: true
      name: Recorded Future Link Research (URL)
      script: Recorded Future v2|||recordedfuture-links
      type: regular
      version: -1
    taskid: 394fb624-df5d-44c4-82f3-cbbdbe4c627d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 895
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      entity_type:
        simple: domain
      using:
        simple: Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get Insikt Group Research Links for an IP, Domain, CVE, URL or
        File.
      id: 53c4d91b-5605-4fc4-8b70-e7089e8c8f2d
      iscommand: true
      name: Recorded Future Link Research (Domain)
      script: Recorded Future v2|||recordedfuture-links
      type: regular
      version: -1
    taskid: 53c4d91b-5605-4fc4-8b70-e7089e8c8f2d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1962.5,
          "y": 865
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entity:
        complex:
          accessor: IP
          root: ExtractedIndicators
      entity_type:
        simple: ip
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Get Insikt Group Research Links for an IP, Domain, CVE, URL or
        File.
      id: 2eb863e2-6d8c-4de1-8169-f073adee1956
      iscommand: true
      name: Recorded Future Link Research (IP)
      script: Recorded Future v2|||recordedfuture-links
      type: regular
      version: -1
    taskid: 2eb863e2-6d8c-4de1-8169-f073adee1956
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1512.5,
          "y": 865
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
      - "29"
      - "27"
      - "30"
      - "28"
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: dcdc04c3-8cd1-4f2d-8fc2-1d484337403a
      iscommand: false
      name: Check Indicator Extraction
      type: title
      version: -1
    taskid: dcdc04c3-8cd1-4f2d-8fc2-1d484337403a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1175,
          "y": 370
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: containsString
                    right:
                      value:
                        simple: Recorded Future v2
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b7de91e6-be2e-4f2a-8e10-83e6e24bba11
      iscommand: false
      name: Is Recorded Future API enabled?
      type: condition
      version: -1
    taskid: b7de91e6-be2e-4f2a-8e10-83e6e24bba11
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 195
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    scriptarguments:
      ignore-outputs:
        simple: "false"
      url:
        complex:
          root: inputs.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Converts the contents of a URL to an image file or a PDF file.
      id: a6dac360-bacf-4ab2-8fbd-71d0203d0361
      iscommand: true
      name: Capture screenshots of the URL
      script: '|||rasterize'
      tags:
      - url_screenshot
      type: regular
      version: -1
    taskid: a6dac360-bacf-4ab2-8fbd-71d0203d0361
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 1040
        }
      }
  "46":
    continueonerror: true
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain.Name
              operator: notContainsGeneral
              right:
                value:
                  simple: tcs.com
          - - left:
                iscontext: true
                value:
                  simple: Domain.Name
              operator: notContainsGeneral
              right:
                value:
                  simple: ultimatix.net
          root: Domain.Name
      extend-context:
        simple: Umbrella.ContentCategories=Domain.Umbrella.ContentCategories, Umbrella.MalwareCategories=Domain.Umbrella.MalwareCategories
      retry-count:
        simple: "2"
      using:
        simple: Cisco Umbrella Investigate_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Investigate
      description: Get Domain Reputation info using Cisco Umbrella Investigate. Domain
        reputation score is either true or false from the service and cannot be modified
        using a threshold.
      id: 8b616904-0d96-4936-8d6e-f7749e418ff6
      iscommand: true
      name: 'Get Domain Report From Cisco Umbrella '
      script: Cisco Umbrella Investigate|||domain
      tags:
      - cs
      type: regular
      version: -1
    taskid: 8b616904-0d96-4936-8d6e-f7749e418ff6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1962.5,
          "y": 1180
        }
      }
  "47":
    continueonerror: true
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      retry-count:
        simple: "2"
      using:
        simple: Cisco Umbrella Investigate_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Investigate
      description: This will return a list of domain names that have been frequently
        seen requested b around the same time (up to 60 seconds before or after) as
        the given domain name, but that are not frequently associated with other domain
        names.
      id: cda3c100-c3d5-487c-8b60-370a6873cb95
      iscommand: true
      name: 'Get Related/Associated  Domain From Cisco Umbrella '
      script: Cisco Umbrella Investigate|||umbrella-domain-related
      tags:
      - cs
      type: regular
      version: -1
    taskid: cda3c100-c3d5-487c-8b60-370a6873cb95
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1962.5,
          "y": 1355
        }
      }
  "48":
    continueonerror: true
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Investigate
      description: Get Domain Reputation info using Cisco Umbrella Investigate. Domain
        reputation score is either true or false from the service and cannot be modified
        using a threshold.
      id: 541b34e7-8e2e-46cb-8540-1bbc3cb6834a
      iscommand: true
      name: Get Whois Information
      script: Cisco Umbrella Investigate|||domain
      tags:
      - whois
      type: regular
      version: -1
    taskid: 541b34e7-8e2e-46cb-8540-1bbc3cb6834a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1962.5,
          "y": 1515
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      using:
        simple: Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: ec29aeb0-7963-43a6-8460-8dfe0e969b79
      iscommand: true
      name: Get Domain Report From Recorded Future
      script: Recorded Future v2|||domain
      tags:
      - rf
      type: regular
      version: -1
    taskid: ec29aeb0-7963-43a6-8460-8dfe0e969b79
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1962.5,
          "y": 1010
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      using:
        simple: Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with an IP address.
      id: 8bbe87bd-c56e-4113-86c5-162f7d5650bb
      iscommand: true
      name: Get IP Report From Recorded Future
      script: Recorded Future v2|||ip
      tags:
      - rf
      type: regular
      version: -1
    taskid: 8bbe87bd-c56e-4113-86c5-162f7d5650bb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1512.5,
          "y": 1020
        }
      }
  "51":
    continueonerror: true
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      retry-count:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Investigate
      description: The DNS database can be used to query the history that Umbrella
        has seen for a given IP address. The most common use case is to obtain the
        DNS Resource Record (RR) history for a given IP, passing in the record query
        type as a parameter, to help build intelligence around an IP or a range of
        IPs. The information provided is from within the last 90 days.
      id: d357a201-2974-4fa3-815f-40c708a0bdfc
      iscommand: true
      name: 'Get IP DNS History From Cisco Umbrella '
      script: Cisco Umbrella Investigate|||umbrella-ip-dns-history
      tags:
      - cs
      type: regular
      version: -1
    taskid: d357a201-2974-4fa3-815f-40c708a0bdfc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1512.5,
          "y": 1345
        }
      }
  "52":
    continueonerror: true
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ipinfo_v2
      description: Check IP reputation (when information is available, returns a JSON
        with details). Uses all configured Threat Intelligence feeds.
      id: a051979a-a65f-4235-8e3a-cc0ddd047ad7
      iscommand: true
      name: Get Whois Information
      script: ipinfo_v2|||ip
      tags:
      - whois
      type: regular
      version: -1
    taskid: a051979a-a65f-4235-8e3a-cc0ddd047ad7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1512.5,
          "y": 1500
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        complex:
          root: inputs.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a URL.
      id: b3818b4c-0974-4418-8749-23016a2049a0
      iscommand: true
      name: Get URL reputation from Recorded Future
      script: Recorded Future v2|||url
      tags:
      - rf
      type: regular
      version: -1
    taskid: b3818b4c-0974-4418-8749-23016a2049a0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 1215
        }
      }
  "55":
    continueonerror: true
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        complex:
          root: inputs.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Looks up the classification for the each of the specified URLs.
      id: 6ccc6670-f340-4587-8459-994534a57979
      iscommand: true
      name: "Check the given URL Zscalar Category \t"
      script: Zscaler|||url
      tags:
      - zscalar
      type: regular
      version: -1
    taskid: 6ccc6670-f340-4587-8459-994534a57979
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 1385
        }
      }
  "56":
    continueonerror: true
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Looks up the classification for the each of the specified URLs.
      id: f913e5c6-a83a-42d8-83f9-777983bc6830
      iscommand: true
      name: Check the given Domain Zscalar category
      script: Zscaler|||url
      tags:
      - zscalar
      type: regular
      version: -1
    taskid: f913e5c6-a83a-42d8-83f9-777983bc6830
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1962.5,
          "y": 1670
        }
      }
  "57":
    continueonerror: true
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Return IP information and reputation
      id: d37c6e9c-287d-42ac-8cac-6f7a0234d9ec
      iscommand: true
      name: "Check the given IP Zscalar Category \t"
      script: '|||ip'
      tags:
      - zscalar
      type: regular
      version: -1
    taskid: d37c6e9c-287d-42ac-8cac-6f7a0234d9ec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1512.5,
          "y": 1645
        }
      }
  "58":
    continueonerror: true
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: Umbrella.ContentCategories=Domain.Umbrella.ContentCategories, Umbrella.MalwareCategories=Domain.Umbrella.MalwareCategories
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      retry-count:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Investigate
      description: The DNS database can be used to query the history that Umbrella
        has seen for a given IP address. The most common use case is to obtain the
        DNS Resource Record (RR) history for a given IP, passing in the record query
        type as a parameter, to help build intelligence around an IP or a range of
        IPs. The information provided is from within the last 90 days.
      id: 0e1e83fa-0a62-41c7-8851-5ce97f6be30f
      iscommand: true
      name: 'Get IP Report From Cisco Umbrella '
      script: Cisco Umbrella Investigate|||umbrella-ip-dns-history
      tags:
      - toreport
      type: regular
      version: -1
    taskid: 0e1e83fa-0a62-41c7-8851-5ce97f6be30f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2490,
          "y": 1825
        }
      }
  "59":
    continueonerror: true
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      using:
        simple: urlscan.io_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: urlscan.io
      description: Submits a URL to scan.
      id: 9eba9a70-cf8a-470c-8501-422359652d11
      iscommand: true
      name: Capture screenshots of the Domain(urlscan.io)
      script: urlscan.io|||url
      tags:
      - url_screenshot
      type: regular
      version: -1
    taskid: 9eba9a70-cf8a-470c-8501-422359652d11
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1962.5,
          "y": 1825
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      using:
        simple: Cisco Umbrella Investigate_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Investigate
      description: This command  shows whether the IP address youâ€™ve entered as input
        has any known malicious domains associated with it. The domains that appear
        when using this endpoint are those that currently exist in the Umbrella block
        list. This endpoint will return an array with a single domain name for each
        domain associated with the IP, along with an id number that can be ignored.
      id: 470393d3-4505-4bb8-873c-3ce12e88ec39
      iscommand: true
      name: Get IP Reputation From Cisco Umbrella
      script: Cisco Umbrella Investigate|||umbrella-ip-malicious-domains
      tags:
      - cs
      type: regular
      version: -1
    taskid: 470393d3-4505-4bb8-873c-3ce12e88ec39
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1512.5,
          "y": 1180
        }
      }
  "61":
    continueonerror: true
    continueonerrortype: errorPath
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        complex:
          root: inputs.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: urlscan.io
      description: Submits a URL to scan.
      id: 32662627-5ac0-4e5d-82a7-7dd4549e0e76
      iscommand: true
      name: Capture screenshots of the Domain(urlscan.io)
      script: urlscan.io|||url
      tags:
      - url_screenshot
      type: regular
      version: -1
    taskid: 32662627-5ac0-4e5d-82a7-7dd4549e0e76
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 1595
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with an IP address.
      id: 53a5914e-3381-499a-87cd-f9b035057cf2
      iscommand: true
      name: 'Get Risk Score '
      script: Recorded Future v2|||ip
      type: regular
      version: -1
    taskid: 53a5914e-3381-499a-87cd-f9b035057cf2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1512.5,
          "y": 1810
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: 017f8b73-efe9-4a35-84bc-8605b93576b2
      iscommand: true
      name: 'Get Risk Score '
      script: Recorded Future v2|||domain
      type: regular
      version: -1
    taskid: 017f8b73-efe9-4a35-84bc-8605b93576b2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1962.5,
          "y": 1980
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "25_7_#default#": 0.44,
      "30_7_#default#": 0.39,
      "44_43_yes": 0.37,
      "44_7_#default#": 0.8
    },
    "paper": {
      "dimensions": {
        "height": 2165,
        "width": 2820,
        "x": 50,
        "y": 50
      }
    }
  }
