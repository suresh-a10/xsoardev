contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: a568e71f-82fd-4589-848e-f61e09c86222
inputs:
- description: ""
  key: id
  playbookInputQuery: null
  required: false
  value: {}
name: searchRelevantXSOARIncident
outputs:
- contextPath: sentinelIncidentExists.sentinelincidentnumber
  description: A list of incident IDs returned from the query.
  type: string
- contextPath: sentinelIncidentExists.xsoarincidentnumber
  description: A list of incident IDs returned from the query.
  type: string
- contextPath: missingSentinelIncident
  description: A list of the incident create date returned from the query.
  type: string
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 31b9cf60-ada4-499b-8251-e8c64328364e
      iscommand: false
      name: ""
      version: -1
    taskid: 31b9cf60-ada4-499b-8251-e8c64328364e
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 80b92f64-963b-4a3f-8c43-f2086a538b83
      iscommand: false
      name: DeleteContext
      script: DeleteContext
      type: regular
      version: -1
    taskid: 80b92f64-963b-4a3f-8c43-f2086a538b83
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      add_fields_to_context:
        simple: dbotMirrorId
      query:
        simple: dbotMirrorId:${inputs.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Searches Cortex XSOAR Incidents and returnrs the most relevant
        fields. Default search range is the last 30 days, if you want to change this,
        use the fromDate argument. \n\nReturns the id, name, type, severity, status,
        owner, and created/closed times to context.  You can add additional fields
        using the add_field_to_context argument.\n\nThis automation runs using the
        default Limited User role, unless you explicitly change the permissions.  Based
        on the SearchIncidentsV2 from the Common Scripts pack, but more efficient."
      id: 4d3e2a2d-0286-4212-893a-f27e510d07d6
      iscommand: false
      name: SearchXSOARIncident
      script: SearchIncidentsSummary
      type: regular
      version: -1
    taskid: 4d3e2a2d-0286-4212-893a-f27e510d07d6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: foundIncidents.id
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 96d687f7-ef45-46e8-8881-1fb51c1a2a77
      iscommand: false
      name: Was Result found
      type: condition
      version: -1
    taskid: 96d687f7-ef45-46e8-8881-1fb51c1a2a77
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: sentinelIncidentExists.sentinelincidentnumber
      value:
        simple: ${inputs.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b38886e0-9774-4059-86e7-ae0a99185638
      iscommand: false
      name: Set Found Sentinel Incident Number
      script: Set
      type: regular
      version: -1
    taskid: b38886e0-9774-4059-86e7-ae0a99185638
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 53a64556-a157-4dcc-862a-f2c7814136e4
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 53a64556-a157-4dcc-862a-f2c7814136e4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: missingSentinelIncident
      value:
        simple: ${inputs.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 0e92ffd8-7e05-4d77-825f-a87ac566de92
      iscommand: false
      name: Set Missing Incident
      script: Set
      type: regular
      version: -1
    taskid: 0e92ffd8-7e05-4d77-825f-a87ac566de92
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: sentinelIncidentExists.xsoarincidentnumber
      value:
        simple: ${foundIncidents.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 29501837-9885-4782-8e05-a460a154fdaf
      iscommand: false
      name: Set Found XSOAR Incident number
      script: Set
      type: regular
      version: -1
    taskid: 29501837-9885-4782-8e05-a460a154fdaf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1085,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
