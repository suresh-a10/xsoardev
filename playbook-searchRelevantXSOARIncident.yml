contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: a568e71f-82fd-4589-848e-f61e09c86222
inputs:
- description: ""
  key: id
  playbookInputQuery: null
  required: false
  value: {}
name: searchRelevantXSOARIncident
outputs:
- contextPath: sentinelIncidentExists.sentinelincidentnumber
  description: A list of incident IDs returned from the query.
  type: string
- contextPath: sentinelIncidentExists.xsoarincidentnumber
  description: A list of incident IDs returned from the query.
  type: string
- contextPath: missingSentinelIncident
  description: A list of the incident create date returned from the query.
  type: string
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 71e4bf46-c0bc-4cf2-8373-4f7e7b344acb
      iscommand: false
      name: ""
      version: -1
    taskid: 71e4bf46-c0bc-4cf2-8373-4f7e7b344acb
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 420e34cf-f010-4c48-879a-8072a1cf427e
      iscommand: false
      name: DeleteContext
      script: DeleteContext
      type: regular
      version: -1
    taskid: 420e34cf-f010-4c48-879a-8072a1cf427e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      add_fields_to_context:
        simple: dbotMirrorId
      query:
        simple: dbotMirrorId:${inputs.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Searches Cortex XSOAR Incidents and returnrs the most relevant
        fields. Default search range is the last 30 days, if you want to change this,
        use the fromDate argument. \n\nReturns the id, name, type, severity, status,
        owner, and created/closed times to context.  You can add additional fields
        using the add_field_to_context argument.\n\nThis automation runs using the
        default Limited User role, unless you explicitly change the permissions.  Based
        on the SearchIncidentsV2 from the Common Scripts pack, but more efficient."
      id: f153a0cb-4ee3-48ed-82ba-12c5ecd13332
      iscommand: false
      name: SearchXSOARIncident
      script: SearchIncidentsSummary
      type: regular
      version: -1
    taskid: f153a0cb-4ee3-48ed-82ba-12c5ecd13332
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: foundIncidents.id
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b76f89cd-9829-4291-83f3-3d79cdbf82ca
      iscommand: false
      name: Was Result found
      type: condition
      version: -1
    taskid: b76f89cd-9829-4291-83f3-3d79cdbf82ca
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: sentinelIncidentExists.sentinelincidentnumber
      value:
        simple: ${inputs.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6a28a2b5-5ed6-441d-8d5c-c07db2b33721
      iscommand: false
      name: Set Found Sentinel Incident Number
      script: Set
      type: regular
      version: -1
    taskid: 6a28a2b5-5ed6-441d-8d5c-c07db2b33721
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e523aad2-29eb-4142-87e7-5c382f8f7c4f
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: e523aad2-29eb-4142-87e7-5c382f8f7c4f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: missingSentinelIncident
      value:
        simple: ${inputs.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: fa01117f-d769-48cf-8a91-476c89328766
      iscommand: false
      name: Set Missing Incident
      script: Set
      type: regular
      version: -1
    taskid: fa01117f-d769-48cf-8a91-476c89328766
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: sentinelIncidentExists.xsoarincidentnumber
      value:
        simple: ${foundIncidents.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8d8ed460-a360-4f35-81ad-dd7f3b57be23
      iscommand: false
      name: Set Found XSOAR Incident number
      script: Set
      type: regular
      version: -1
    taskid: 8d8ed460-a360-4f35-81ad-dd7f3b57be23
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1085,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
