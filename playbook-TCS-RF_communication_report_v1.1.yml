contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: f81a2341-0ee7-4d69-8005-e9ac1889c04d
inputs: []
name: TCS-RF communication report v1.1
outputs: []
quiet: true
sourceplaybookid: b3d1ecc4-8713-42f2-8d79-00287a09a048
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 29a7469f-9843-46e0-8b45-1e085871c10a
      iscommand: false
      name: ""
      version: -1
    taskid: 29a7469f-9843-46e0-8b45-1e085871c10a
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 70,
          "y": -390
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
      - "10"
    note: false
    quietmode: 1
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      using:
        simple: AbuseIPDB_instance_1,Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Looks up the classification for each of the specified IP addresses.
      id: 74bef4d6-e80c-4ab8-8ebc-eeebfebb0aac
      iscommand: true
      name: Get Risk Score For IPs
      script: '|||ip'
      type: regular
      version: -1
    taskid: 74bef4d6-e80c-4ab8-8ebc-eeebfebb0aac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 450
        }
      }
  "2":
    continueonerror: true
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.enrich.indicators
      id: bf85e7dc-e8cc-40e1-8cc1-8563ac2e9d77
      iscommand: true
      name: Enrich IPs
      script: Builtin|||enrichIndicators
      type: regular
      version: -1
    taskid: bf85e7dc-e8cc-40e1-8cc1-8563ac2e9d77
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 240
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a8bdc775-72b6-42e2-8ba2-a3049c868770
      iscommand: false
      name: Are there any extracted indicators?
      type: condition
      version: -1
    taskid: a8bdc775-72b6-42e2-8ba2-a3049c868770
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 70,
          "y": -30
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 2
    scriptarguments:
      text:
        simple: 128.199.252.34,1.1.1.1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: cba172b8-91d1-473c-8664-3bb6cc21482d
      iscommand: true
      name: Extract Indicators from the Source IP column of the report
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: cba172b8-91d1-473c-8664-3bb6cc21482d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": -230
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.IP
          operator: greaterThanOrEqual
          right:
            value:
              simple: "65"
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 53648de6-556c-4eda-806b-78df39adca19
      iscommand: false
      name: Are There Any IoCs With Risk Score > 65
      type: condition
      version: -1
    taskid: 53648de6-556c-4eda-806b-78df39adca19
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -330,
          "y": 680
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This playbook will block only IOC that have riskscore 65 and above
        from the Tip report and notify the team after blocking
      id: ed3ab527-a4e8-4828-848f-38e8452163d0
      iscommand: false
      name: TCS-Block IOC-Risk Score 65- Tor report v1.0_copy
      playbookName: TCS-Block IOC-Risk Score 65- Tor report v1.0_copy
      type: playbook
      version: -1
    taskid: ed3ab527-a4e8-4828-848f-38e8452163d0
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -350,
          "y": 860
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: RecordedFuture.IP.riskScore
          operator: lessThanOrEqual
          right:
            value:
              simple: "64"
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3c14caa2-d9fe-4655-8649-96aefceb249a
      iscommand: false
      name: ' IoCs With Risk Score < 65'
      type: condition
      version: -1
    taskid: 3c14caa2-d9fe-4655-8649-96aefceb249a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 330,
          "y": 680
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RiskScorebelow65
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.IP.riskScore
              operator: lessThanOrEqual
              right:
                value:
                  simple: "64"
          root: RecordedFuture.IP.riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a08afdec-9a78-49bc-826c-9ca1b49608ff
      iscommand: false
      name: Set IOC less Than 65 To Context
      script: Set
      type: regular
      version: -1
    taskid: a08afdec-9a78-49bc-826c-9ca1b49608ff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 330,
          "y": 940
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 2
    scriptarguments:
      csvArray:
        simple: $RiskScorebelow65}
      fileName:
        simple: IOC_below_64_RiskScore.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 9f3be3c6-2a0f-458e-88a2-1ab52e3bfdcd
      iscommand: false
      name: Create Risk Score Report less than 65
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 9f3be3c6-2a0f-458e-88a2-1ab52e3bfdcd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 330,
          "y": 1170
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 55088952-5cbb-435b-8257-743f089862a5
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: 55088952-5cbb-435b-8257-743f089862a5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1970
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 179dfa76-9219-466b-8051-f071644864e9
      iscommand: false
      name: TCS-Report Autoassign_WIP
      playbookName: TCS-Report Autoassign_WIP
      type: playbook
      version: -1
    taskid: 179dfa76-9219-466b-8051-f071644864e9
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 330,
          "y": 1660
        }
      }
  "16":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${RiskScorebelow65}
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b3edd1ad-c660-430b-8c1e-4424836a8874
      iscommand: false
      name: Untitled Task
      type: condition
      version: -1
    taskid: b3edd1ad-c660-430b-8c1e-4424836a8874
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 330,
          "y": 1385
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2425,
        "width": 1070,
        "x": -350,
        "y": -390
      }
    }
  }
