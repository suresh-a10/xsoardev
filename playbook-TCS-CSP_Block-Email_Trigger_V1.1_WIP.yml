contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: d94e46d3-45db-4516-8b76-ae2ef19635e3
inputs: []
name: TCS-CSP Block-Email Trigger V1.1_WIP
outputs: []
sourceplaybookid: 0a608f75-4154-430b-81e0-3a7bc08ad2e0
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "122"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5f6c99e7-c682-48c7-898b-4b9ce4791f0e
      iscommand: false
      name: ""
      version: -1
    taskid: 5f6c99e7-c682-48c7-898b-4b9ce4791f0e
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1290,
          "y": -1730
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9f5e8e59-8105-45ec-8198-ad90c4f49e06
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 9f5e8e59-8105-45ec-8198-ad90c4f49e06
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1120,
          "y": 2705
        }
      }
  "122":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: enterioc
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "152"
      "yes":
      - "130"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6147e118-57d7-46fd-80e3-446c55223de7
      iscommand: false
      name: Are There IoCs For Blocking ?
      type: condition
      version: -1
    taskid: 6147e118-57d7-46fd-80e3-446c55223de7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1290,
          "y": -1580
        }
      }
  "126":
    continueonerrortype: ""
    id: "126"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #ff00ff;">No
          IoCs Found For Blocking</span></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: a734c24b-cce0-44ff-8405-8c9b93e11892
      iscommand: true
      name: Update Notification - No IoCs Found For Blocking
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: a734c24b-cce0-44ff-8405-8c9b93e11892
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2500,
          "y": 2270
        }
      }
  "130":
    continueonerrortype: ""
    id: "130"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "131"
      - "140"
      - "143"
      - "148"
    note: false
    quietmode: 0
    scriptarguments:
      suspiciousiocs:
        complex:
          accessor: enterioc
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e0f95d4-21ee-4795-8638-e8663d3ff400
      iscommand: false
      name: TCS-Validate Submitted temp IOC v3.2_WIP
      playbookId: ee8b8a68-d619-4b8e-8923-b963356abaad
      type: playbook
      version: -1
    taskid: 1e0f95d4-21ee-4795-8638-e8663d3ff400
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1290,
          "y": -1415
        }
      }
  "131":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IPV4
                root: FinalBlacklist
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "131"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "155"
      "yes":
      - "162"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 648e7e22-1477-40f9-8307-08496c536295
      iscommand: false
      name: Are There IP Address For Blocking?
      type: condition
      version: -1
    taskid: 648e7e22-1477-40f9-8307-08496c536295
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": -1210
        }
      }
  "135":
    continueonerrortype: ""
    id: "135"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "138"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: Domain
          root: FinalBlacklist
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 6ff0ed98-37fc-4022-83b6-38cfa6810576
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 6ff0ed98-37fc-4022-83b6-38cfa6810576
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": -860
        }
      }
  "136":
    continueonerrortype: ""
    id: "136"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "137"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: Domain
          root: FinalBlacklist
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 5a1f1cb9-2061-4bdf-8fe8-c85a424fcd23
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 5a1f1cb9-2061-4bdf-8fe8-c85a424fcd23
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": -505
        }
      }
  "137":
    continueonerrortype: ""
    id: "137"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      alert_time:
        complex:
          accessor: created
          root: incident
          transformers:
          - operator: 8726aa62-638b-41b0-8fd7-8d8892145289
          - args:
              delimiter:
                value:
                  simple: .
              fields:
                value:
                  simple: "1"
            operator: Cut
          - args:
              prefix: {}
              suffix:
                value:
                  simple: .0Z
            operator: concat
      destination_domain:
        complex:
          accessor: Domain
          root: FinalBlacklist
      destination_url:
        simple: http://abc.com
      device_id:
        simple: abcdefghij
      device_version:
        simple: "1.0"
      using:
        simple: Cisco Umbrella Enforcement Block Domain_instance,Cisco Umbrella Enforcement
          Block Domain GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Enforcement Block Domain
      description: Posts a malware event to the API for processing and optionally
        adding to a customer's domain lists.
      id: 64d97d0f-149a-447a-8be4-4713499cc1d0
      iscommand: true
      name: Block Domain on Cisco Umbrella (opendns)
      script: Cisco Umbrella Enforcement Block Domain|||umbrella-domain-event-add
      type: regular
      version: -1
    taskid: 64d97d0f-149a-447a-8be4-4713499cc1d0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": -330
        }
      }
  "138":
    continueonerrortype: ""
    id: "138"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "136"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: Domain
          root: FinalBlacklist
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 4116615f-9fc1-4322-8546-787ea634ba0b
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 4116615f-9fc1-4322-8546-787ea634ba0b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": -680
        }
      }
  "140":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: FinalBlacklist
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "140"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "155"
      "yes":
      - "142"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aea5d426-8c92-43b4-8171-f9ba9e70b3bc
      iscommand: false
      name: Are There Domains For Blocking?
      type: condition
      version: -1
    taskid: aea5d426-8c92-43b4-8171-f9ba9e70b3bc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1500,
          "y": -1220
        }
      }
  "142":
    continueonerrortype: ""
    id: "142"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "135"
    note: false
    quietmode: 0
    scriptarguments:
      IOC:
        complex:
          accessor: Domain
          root: FinalBlacklist
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dcd126e9-87d4-43b7-8a06-9740f2ea708b
      iscommand: false
      name: TCS- Add New Tag CSP Block Indicator_v1.1_WIP
      playbookId: 749674fa-3117-4992-85d6-4ff7a009aa3b
      type: playbook
      version: -1
    taskid: dcd126e9-87d4-43b7-8a06-9740f2ea708b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1500,
          "y": -1025
        }
      }
  "143":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: FinalBlacklist
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "143"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "155"
      "yes":
      - "157"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4f4e9f5b-6dee-4e09-8bb8-a5490d903dcb
      iscommand: false
      name: Are There URL For Blocking?
      type: condition
      version: -1
    taskid: 4f4e9f5b-6dee-4e09-8bb8-a5490d903dcb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2070,
          "y": -1220
        }
      }
  "148":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: File
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "148"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "155"
      "yes":
      - "149"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bcbbb340-d800-4e94-8eb2-a5e5973880f2
      iscommand: false
      name: Are There Hash For Blocking ?
      type: condition
      version: -1
    taskid: bcbbb340-d800-4e94-8eb2-a5e5973880f2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2590,
          "y": -1220
        }
      }
  "149":
    continueonerrortype: ""
    id: "149"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        complex:
          accessor: Hash
          root: FinalBlacklist
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: abfb1b39-8e7f-4b2b-8ebf-bfc8dcfc73ec
      iscommand: false
      name: TCS-CSP Block Malicious Hash on CS v1.0_Kunal_WIP
      playbookId: 7f7cc5a4-2a45-4ea9-8bc5-df697dc64131
      type: playbook
      version: -1
    taskid: abfb1b39-8e7f-4b2b-8ebf-bfc8dcfc73ec
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2600,
          "y": -1025
        }
      }
  "150":
    continueonerrortype: ""
    id: "150"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "152"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #ff00ff;">IoC
          Have Been Blocked For 30 days</span><br /></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: dde4dbd3-01e1-4985-8820-d47ccd5a330f
      iscommand: true
      name: Set Action Notification - IoCs Blocked
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: dde4dbd3-01e1-4985-8820-d47ccd5a330f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 40
        }
      }
  "152":
    continueonerrortype: ""
    id: "152"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "153"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 010c08fd-aa48-4024-8d58-a0d7737264c1
      iscommand: false
      name: Close Incident
      type: title
      version: -1
    taskid: 010c08fd-aa48-4024-8d58-a0d7737264c1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 210
        }
      }
  "153":
    continueonerrortype: ""
    id: "153"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "154"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: e7ea91b7-9620-47a3-860c-38db977de358
      iscommand: true
      name: Close Incident
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: e7ea91b7-9620-47a3-860c-38db977de358
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 335
        }
      }
  "154":
    continueonerrortype: ""
    id: "154"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 648f538c-bb7d-4c8b-8e71-b559e3dab0ec
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 648f538c-bb7d-4c8b-8e71-b559e3dab0ec
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 505
        }
      }
  "155":
    continueonerrortype: ""
    id: "155"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "150"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 791e85ef-de79-49b3-886c-9b673eadd34e
      iscommand: false
      name: Notify
      type: title
      version: -1
    taskid: 791e85ef-de79-49b3-886c-9b673eadd34e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": -110
        }
      }
  "156":
    continueonerrortype: ""
    id: "156"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "158"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${SetURL}
      contextKey:
        simple: BlacklistURL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: e35caba4-d717-4bc6-889b-959da6982942
      iscommand: false
      name: Create Array of Input Data
      script: CreateArray
      type: regular
      version: -1
    taskid: e35caba4-d717-4bc6-889b-959da6982942
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2070,
          "y": -850
        }
      }
  "157":
    continueonerrortype: ""
    id: "157"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "156"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SetURL
      value:
        complex:
          accessor: URL
          root: FinalBlacklist
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4c32fca8-d218-464a-8072-5075d0cd1a80
      iscommand: false
      name: Set Data To Context
      script: Set
      type: regular
      version: -1
    taskid: 4c32fca8-d218-464a-8072-5075d0cd1a80
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2070,
          "y": -1035
        }
      }
  "158":
    continueonerrortype: ""
    id: "158"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      URL:
        complex:
          root: BlacklistURL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f872ea48-582c-4150-8c9d-a7b8154bc69a
      iscommand: false
      name: TCS-CSP BlacklistURLcontain_v1.0_WIP
      playbookId: f309228e-ff71-4979-8b82-227838c9ee66
      type: playbook
      version: -1
    taskid: f872ea48-582c-4150-8c9d-a7b8154bc69a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2070,
          "y": -670
        }
      }
  "162":
    continueonerrortype: ""
    id: "162"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      IOC:
        complex:
          accessor: IPV4
          root: FinalBlacklist
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b0a9124c-89da-4184-8b73-57186037777d
      iscommand: false
      name: TCS- Add New Tag CSP Block Indicator_v1.1_WIP
      playbookId: 749674fa-3117-4992-85d6-4ff7a009aa3b
      type: playbook
      version: -1
    taskid: b0a9124c-89da-4184-8b73-57186037777d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 890,
          "y": -1005
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4500,
        "width": 2090,
        "x": 890,
        "y": -1730
      }
    }
  }
