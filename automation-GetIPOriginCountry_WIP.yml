commonfields:
  id: 7755aeac-f2e8-4dc7-8925-37328d09f1ab
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.9.7.24076
enabled: true
engineinfo: {}
mainengineinfo: {}
name: GetIPOriginCountry_WIP
pswd: ""
runas: DBotWeakRole
runonce: false
script: |+
  # hashes="08709ef0e3d467ce843af4deb77d74d52f712cdae87cdb7ccc0f4046ffa32 81d1d290d993eac8634b15b2204c3c011b43a746f525877b3d006758def2957ddaf40b83c7963e02baa00063a346b349b649f65e3b320ec91380ebc28d4fdff48955eabc9c54b73fffb5f3fddb37a653d7ba683a19b396be56749989f12aff2b8716a09bc6c19c4236c0bd8a01953371a294de28110bfb88fdcdf4a0133e118d998738c60fff066934b6f33e368cfe9a88cd0ec86f1fdb257db40a7baaae6ad5d4cfd8e27f820bdbdf6cb80a46c67fd978a4365057ef0c5a9518d95d53eab5995a8f79caf27a99c091e6c1775b306993341d4fdf63d88da2d59569bb621b18bf5e4363a95777f401df40db61148593ea387591a5ef38c1be504fbbc88219eb3969201039a95e0a14767784acc8f07035935f3962456f7fc8d10644bf051ddb7c7ef8bb3d91b666813372e66903209bd45fdc8b49b42e6ebb6b977ce7001b6bd96c8110d32df05d0605e73fef38dd00c46a6ed24b708a0abb91d2d984c646527823f11796e9e5567954ffe6eb9049f29acb297fa94e60ccc91dcc6e5ee2848f48415e5aacf3103af27f9aaafa0a74b296d506805c95e94feb35873412afdc6d0e540b91ce2fa41029f6955bff20079468448b0c12b32ed763e2fd9f0a1669f82d5795eb7edc915ab27deedf422e3f184c89a71fcbce4a9071e779dd9212cdffedc0a8719198899a009c8deb544b12d0cb35fb4ae6966e65e47afa41610b1fb5546071a42acbdb285a7fba17f95068822ea4ed3109c83e07dd5d7fe032dc80c581d08d5aad0d248c237360cf39c054b654d692c4a910a1299cdae2a4e55988a2f102e42ffc84c6381a18b1f6d000b94c74b09ae7e3e531494b201fbf6021066ddd1885a75adf861a11e0d8557630759cd0affe07ef8ffe965ec8b72041ddf9527cac450992eefe5df1c85dde85dc008b5010d75457cc94b1d1dfa3f5d1aedc2edb04450bf9c6de53b7de6906c2d5ed6177c28a0b4e7622728c317f37ae354b8bc3dbb44011659d6f589e6b654f5ef0e1d8b6c1d3e2742e922641b7063db8cafed6531919d8dec00ff5ac570b39c46ac6eb9ecf6d07f3d81dcea99b27462d1004149176332176672744320e9fee2117b059193bb83d98bfaf909bef230532c3572315a1e417aa350346731f6e0c936d725f1a57f6bca4f08c63e597bed969f5b729c568777a9796565effa01b03cf1cea9d24d8e5106565fd96df1308d208d1e3426a3ae505c295fc0f98c10aa08577fb9fe00cf59ed2b5473281cc2e083eba3f4b662969310a9775070c314377a9a4a665686b0a9a175e2407352214b2d005253bc0cd5a82520ebf38a0c595367ff0ca89faee315436c42e681962a8e174ef7fad480e1db6b72ec26311b175663b7d88e3c001e031a879ae98aee59cd4f40590ab9dce55d9f6300fa32458b909fded48ec2c9e405285f73ddb8986cbf31b9ca864f1b1819eff02c4fd5b30771eb89cac4fe69416db420e781c709bb71acee0b79282fe9594890e33b653eb6a8b4c87f6b32a80be02d5f66f84ebd03f362ad4b4a06e6c42bf27579eaadfa080134f3400a417ba879889bc011f0fb9a17681ea85113ce7edf943ed251fa480c5ca5abb2446c755dc4fced3eb731fffb88d0d2b17b1c83273ce653c457c9220ce53d0dfd3c60f1f58a4369b8176edbde4396dc977c90089f612661000605c5d0787fe13746e4ccf1583641033d66873ed1604e2f1bea1bb58fb3e7a7fd225e0059d19f33b9b3d5913967b243fd49ffad3de984642e2eba3633203d9a93fecfa9d4d9c06fc7fe36d1ce79089578da2d41f1ad901f7b1014d4aed55bfbfe0afac5230d9827c638787ad50c9e4a4bab73bba38860906220b6054940ba8908b9e11f57ee081d1140cbe1c383cc6aa2449f149e142433eff5e58716cec33a4fea1c00d57c4040945d9e658c6fe38f95995fa8dc8f6cfe41df7b41dd8cee47c036e7e9e92c395c5d1feb664b149ae8469cbda7fd7ed48c7dc9b683f57f0116a3b3d69ef7b1dbe9943801d36351af2453640663bba20d365e538318e64b8e5ce5bdd33ce8bd9e00af672c856b224da7525ea5192efbef7a9b811237ea95f7fa8fb51446c18f9f3aa63df33fccf531ff0ae6fedd7c586774b17a2d53db085a276ebbf5798ba756cac833ea4f2eb62fa529c0283b28d05ddd311fae69cab1853df0749d42b68bf41d78e655811f66d6dd2c713073c0b0aebbe74ce878e51be60eab2c6e952c9538a46ab521f1fde39260e8383d66831358387bd1d225fd7a4ba2592d1fba48557d9860b1bcac7a22d1af180c21b0061b8d512586d391aaf47843a34a9d8d1bb715a6d4aceca9485f3ecf7f35ba16a680a03d17c9ee6a5a0ac42161333e9758589ecabed3c69812bb73079a739b97f2c3927ad764ba608b22fcd2d067730176e335d3c6454b0f9534b63cb7af1e3aa34839d7d6e6321a874e5ecd67dffab45e17e9b730daedcbf93b5dd9add2ac5abacd9e97a6ad3cf0bf570b9cc055c7c7b8a77573264917a7f7a0f74c8b48f1699858b3b6c11eda004b55a66b3a86a1ce0a0b9b69b95976d596827d48a3ff836545b3a999f2c3e3d2d6093f0bd1ffdbc01ea7f1390a84b33e329a4c9030b26ba152fb602a1d5893dc6cc442c0900104a5601a6049354fad0d7cefb89b6d31ab784bd4e0b0f0eaad7688be226b946e231e0cd36e6b708d20cec747328516d2e7c7cfdcb359a791f2b84c00ae9e7f9684b36d75a1a09f8210aefd68ed5b4b672e72b5e00391fed9eda3369c4bf67cdb3f4be6772680b1e21597886672cc570ba4a5d6a162e92d0155e6399853def634dc8f8893f93158486d98613ecb3afde5fc48ca4204f8363f1d29e2ef8ef5c6ff95e98bff095e63dc05967fcf185634def5177f74b0f703bdc00753697172046fcfb03d6445fff1f09332e0940e1715392280d4bdb514d9cf11dc92eba92885f2e937cb6f694647eb714af2a3d07062d5d28dad7d3a6dfb0b4b95b3ec0a4e539efaa1faa3d4e25d51ded5c26128127f2fac6e3ff2c87b473d7472512c49401bd3d04a8ef6c7a64753071c3b8ae594cb4ce24c2680b47cebf8083304036ac3bbf6cb2205e30226c89a1a4fd640185f229d0ef142899c5402461586e0f3071c3b3feecf36ea13891633fb3a9cdd8a5cbc3ab10ad64c4bb641b41f52474b705610245f67bbd1c86ab8bd7bbdf1c4267ab407081c3789ebe83baa79ebe2f8df39b4a94fb408580a728d351f1dd593ad084e1526c8facce834b0e124b5553645fe819a93aafe2894da13dae707660a9b83b7fbc7ab372a911c69a85bd824cbf08604dea9724ab8e707bb9fecffb407dc2b20357302a4550a73f6c3427382039a11cfd0bd88eef629738f5f56b53271982622d9302af2f09fe162342ecc08a6df151b8879a4969b2e99086b48030da7510113c28ee68df8a19c643bb0e8510a7ae4919a3fcedad985fbbca352736d58bf1d28bf930534dd4e05c4aa9cf22606385080d35551e7f8e8f49b7de9d543904651b180fd5e4dc1584e639b5e6f535a0f5c7f710ec4739e52f35a56732ef51f1ca11ce73fa20b54a5886ad1dd72b494d0921296cdd5e4a07a0869b2443a04a5d7ed785daa16f4ebfd3acf0867556b9eca4a85f52e2f3176c306e1866116bbc967a8b6a365871a05c74a4f345bbfd2d6bf8e99332157a0fe46a4a91c52bfc36f03b9752ca9d49ffb4d259129adaaee4a7ee015cc6d249c48cba1815ce4a25ec7749b2de12c2a86167afa88a4ddcbc1dc536cd6f4fb9648e229e5d2336191a50a90cb31fad48908d5c6294e92ba3195110045f64a3c83fc3e043c46d25311db740d08cb908f428253c47ec2286157a1f0658712ee7b3a724b6d07e97259d7af9a4010c75af6756a603fd6aef5a4c8eb6040fd02d77660d19057a38ff7699ad55b83f2eec0c19873a770b0c86a2f600aceaddb22b9a1d6ae374ba7fc28c51d97d76afefaa09556683c2fcd875baa4cbd9a0832dcf23867b092de37c10d9d1a262a7bfecd981d7874633f41ea5de890bd910ee161b71c7a37ac642f9100598473fae7fdae7ee5a8b0fb64ebb596c15fa3c3dabb8edd601302d9cf02db899dd7817bc8fc539fba6388907223773546ff730329757d57a1d4e5e8404398b0cdc23f1af6d1724324f866fe68634396f9b8690064dc61333c591252c4204fbbb328f96a57fa5ff663926e9bad51a1d0cb964e4b516d72b7717aabb71ad7cc7bf662c4ce93050e48d623569c7dcc4d0278992d2386998566a2a95c2affbfe3f3fea4f3e00b3da3e9d9382840dfbdbef3114d3a94134aaf590ae8ece0a57257e129e268e5c53da8361d4f7b6a884d7dfc8a429be60f0e444f4d9ba1255e88093721f0a6436ffee12558a434a0fc24b3b33f9d95c8f09f991a5fc37b79c45ebd204363523643e2040bf01dc0c312294feb809018fa0826f237342471895f315dbf393d3363598f87c78826c859077606e51401d322dcac438d2bb6bce2bae8d613cb66534e53d8751a24a767221fed01268da707f6bd9c96423619366b02073f0923cc2a08783fe8de00a550fbac50cf9e16b37eefd5c8433a91827904483ccb926e6ac740ebf98df7217d31cb826a207af66ed0020b0851fb71d5b0076f4ee95f3c8b3050a95e3ce00424b85f6e9cc3ccec4c6608203e751cf27f627220269d6835f02da961eb7b87b41aee5fd9537022f0e00bf9b8261410744c10ae3fe2ce9049837b522730ff896435682b36f7b27a3eacac7584d7dc066d27555997d0f6d6cf8c4537a0df7d02bfa6e6a76ea3c72ea451ea28f4f3fa794d5b207475897b1eef2b13b244aafe1ecace61ea1119a1b2ee20d86cb4ebbffb739faa47f7354ee1341dde02ff744fa4e261168e2008fd613a351c913e4120081d8f04317121654a3968271df868f462c06e24a896a949422552dc7f62d3d3d80b7d1dfb828f467d0d8670710bc9477431a01a576b6b5c1b2a45d6515ebb7f57404b8703f1e77a461acc4011807862338aefddc485ec293e21e163d9a91f97f133b0e3f2bbe4dc226ae930633b2d99da097ef2dfff6734afab27f3d0556c59e32791567a09236507d9f5a9d696828051d4487dde248a97365810b852b9f669aa6ec60bc838dbee6de36761106f816313394a653db5172dc487acffb2823fc655637657dcbd25f35af82e3b4221697bc2a374cd6d313021b767af534ba7bfc624c76e718ceab347711815b3856e59a242577d83275279ed70e0b2737204531a80c31bb30e9be9a1cc4c5b4250a6bb4c6915ce962d489ee912d68c9113aec4d0585f2744e2027ef8a03dbc626c8f11ed753f33ad1c0fe848d8985ebce6cbedfec82f1428c3409e3df0efa5d6ad8ad82c266fda96e076335a50801f480ce31673205e7b38e7017e096b76a9c045c401afb9766e2ca838dc6f47a4ee6420f6bccd3eb9510211c020129c0cfbbec66d68e0804c1db8c1e59bb1227bf338e21422eca3a52239089f821519d6bd05e95b88b41cad419d450b10f801c5bd7734d9ee4a6d9aca03e96d5e951805e031c9984f65a9060ec1e70fbb84746bf16dff8ec8702518471f637eb5313ab2f2b05e6b01be3b6cb14e9068e7a66fc187dfac39f577e5f52f0724455e8832a870f5574e4e7ad360f4f5c2117a7a1ca7181a88c911b10d0fcb4682ae552c0de3b3a1d5dd34a2ebbf5a0e00aeb523c655da1787c54896a926b4893de19fd2554c5c37d66e0a02ee4ee4e85ae769bb025043c012086c1ae0a67c38b0926d6cba3f57c627d68e156676d08bfc0829b9433186ef8f5f62ae8590d6edf45e04806515e18a6a21eb44e77ca8d739a72209c3701e1b0d16a16cf5c7f3a7c053ce78f515a0170807b9dc06589628c0e8db8dd669719cf63a3922953ceaca6fb4dbed6584038579bdb1de9e0ab541df532afeb50d3729a14be6b3a92265cf6d8e14c79abe2aabd78ef11926d7b562fd0d91e68ad377605aa6bd6fb890b9b823bd7a3cc78be58b8de07372b9913ca2fbd3b103bb8f628799f1f8146038b488c9ed06799b933bf4168617e7598d6de2a0836a32b9703bca13af71cc45d0b9825f68f89a68314ae0b6be7f38e2eb84b881abf5110edc2e64131c0426a18c1c363ec69ae6b5f29b02dd2a1a15e94922be3f85129083acdcfd60883c73c3d92fceb6ac910d5b8069ca8c489161abc084ebbef37c05d3c2c5d5cb99291fa4b2a68b5ea3ff9d9f9ad8b09942b58a15a697068867abe59a4e8f154d23ac2071d7f179959aaba37ad514d779777af6eb7c556ae338b462c48d4f148ffeac50df60f9f9015b909d8ed031b3069cef380b4bf85e75a8885bcee83d18bc4bfe1ec7b6b73a3fb39d490b6418427cdcb5729a194954f0a6b5c0835a"
  # hashes=hashes.split()
  # # demisto.results(hashes)
  # demisto.results(len(hashes))

  indicator= demisto.context().get('ExtractedIndicators')
  if indicator:
      print("indicator present")
  else:
      print("indicator absent")
  '''
  ips=demisto.context().get('IOC').get('IP')
  ipset=[]
  if ips:
      iplookup = argToList(ips)
      for ip in iplookup:
          res = demisto.executeCommand("ip", { 'ip': ip, 'using' : 'AbuseIPDB_instance_1'})[0]['Contents']
          ipset.append({
              "ip" : res[0]['IP']['Address'],
              "country" : res[0]['IP']['Geo']['Country']
          })
              # if res['data']['results'][0]['risk']['score']>=65:
              #     risklist.append(
              #         {"ioc" : res['data']['results'][0]['entity']['name'],
              #         "riskscore" : res['data']['results'][0]['risk']['score']}
              #         )
              # else:
              #     safelist.append(
              #         {"ioc" : res['data']['results'][0]['entity']['name'],
              #         "riskscore" : res['data']['results'][0]['risk']['score']}
              #         )
              # # demisto.results(fileResult('resultSet.json', str(resultset)))
  demisto.results({
      "Type": entryTypes["note"],
      "ContentsFormat": formats["json"],
      "Contents": ipset,
      "HumanReadable": tableToMarkdown('IP List', ipset),
      "EntryContext": {'IPAddress':ipset}
  })



  # ipset=[]
  # res = demisto.executeCommand("ip", { 'ip': '103.77.139.26', 'using' : 'AbuseIPDB_instance_1'})[0]['Contents']
  # print(res)
  # # print(res[0]['IP']['Address'])
  # # print(res[0]['IP']['Geo']['Country'])

  # ipset.append({
  #     "ip" : res[0]['IP']['Address'],
  #     "country" : res[0]['IP']['Geo']['Country']
  #     })
  # demisto.results({
  #     "Type": entryTypes["note"],
  #     "ContentsFormat": formats["json"],
  #     "Contents": ipset,
  #     "HumanReadable": tableToMarkdown('IP List', ipset),
  #     "EntryContext": {'IPAddress':ipset}
  # })





  '''



scripttarget: 0
subtype: python3
tags: []
timeout: 7.2µs
type: python
