contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
hidden: true
id: 49800f93-135c-4542-8467-f7177dabcc02
inputs: []
name: TCS-Qradar Hunt for IOC_V1.1
outputs: []
sourceplaybookid: 7edb4ef0-ae29-4a85-8df5-6df16b8c3bad
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0fd54ef4-e1de-4e7d-80a1-8c27df345e77
      iscommand: false
      name: ""
      version: -1
    taskid: 0fd54ef4-e1de-4e7d-80a1-8c27df345e77
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 730,
          "y": 40
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: e30a8c1d-ee68-4848-83ad-7f96ce488577
      iscommand: true
      name: 'Extract Indicators '
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: e30a8c1d-ee68-4848-83ad-7f96ce488577
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 730,
          "y": 380
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: ${incident.id}_Hunt_IOC_IP
      value:
        simple: ${ExtractedIndicators.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Add or update a value in a reference set.
      id: 4b4981d2-81bc-4645-8697-0d8ce6f1cd46
      iscommand: true
      name: Populate IP to reference set OnDemandHuntingIPs
      script: QRadar_v2_copy|||qradar-create-reference-set-value
      type: regular
      version: -1
    taskid: 4b4981d2-81bc-4645-8697-0d8ce6f1cd46
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 885
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: ${incident.id}_Hunt_IOC_Domain
      value:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Add or update a value in a reference set.
      id: 81042556-0bed-4ef2-8544-7e7ea0b23ee8
      iscommand: true
      name: Populate Domains to reference set
      script: QRadar_v2_copy|||qradar-create-reference-set-value
      type: regular
      version: -1
    taskid: 81042556-0bed-4ef2-8544-7e7ea0b23ee8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1052.5,
          "y": 895
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 379fc4f4-3801-4e6d-88b2-c188c9f428e7
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 379fc4f4-3801-4e6d-88b2-c188c9f428e7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 390,
          "y": 2100
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: ${AQLDomainSearch}
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 72a1ab02-dd7d-4433-8d18-68eebf895d08
      iscommand: false
      name: QRadarFullSearch_v1.0_Domain
      playbookId: 1af6d691-c912-44b9-8502-2b9b2acc4e74
      type: playbook
      version: -1
    taskid: 72a1ab02-dd7d-4433-8d18-68eebf895d08
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1052.5,
          "y": 1245
        }
      }
  "11":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: sonam.bhandari@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: internalis.cybersecurityops@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: v.ghule@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: nishanth.dharuman@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9c4274af-a030-466a-892d-f7d94045a600
      iscommand: false
      name: Is Email from Authorised Sender
      type: condition
      version: -1
    taskid: 9c4274af-a030-466a-892d-f7d94045a600
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 730,
          "y": 185
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: ${AQLIPSearchSource}
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 599fcba5-76db-43fa-8def-208712dfcce1
      iscommand: false
      name: QRadarFullSearch_v1.0_Source
      playbookId: 1af6d691-c912-44b9-8502-2b9b2acc4e74
      type: playbook
      version: -1
    taskid: 599fcba5-76db-43fa-8def-208712dfcce1
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1245
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: ${AQLIPSearchDestination}
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 00e79f18-eed2-47bc-8f15-e24a3518c356
      iscommand: false
      name: QRadarFullSearch_v1.0_Destination
      playbookId: 1af6d691-c912-44b9-8502-2b9b2acc4e74
      type: playbook
      version: -1
    taskid: 00e79f18-eed2-47bc-8f15-e24a3518c356
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 1245
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
      - "28"
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      body:
        simple: "Hi Team , \n\nPlease find the attached hunt result .\n\nThanks\nCyberSecurity
          AutoBot\n"
      subject:
        simple: Hunt IOC Report from Qradar
      to:
        simple: ${incident.labels.Email/from}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 7a0b12bd-0196-4fe7-8896-61bda3e39c84
      iscommand: true
      name: Send report via email
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 7a0b12bd-0196-4fe7-8896-61bda3e39c84
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1605
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 522f29d4-6077-4f21-86af-513d166733bd
      iscommand: false
      name: Are there IPs to Hunt
      type: condition
      version: -1
    taskid: 522f29d4-6077-4f21-86af-513d166733bd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 545
        }
      }
  "19":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain_Test_
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0be6d775-6eb0-4581-8f25-a661c37f18b7
      iscommand: false
      name: Are there Domains to Hunt
      type: condition
      version: -1
    taskid: 0be6d775-6eb0-4581-8f25-a661c37f18b7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1052.5,
          "y": 545
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        complex:
          accessor: events}
          root: ${subplaybook-13.QRadar.Search.Result
      fileName:
        simple: Presence of IOC in Destination.csv
      headers:
        simple: Destination IP,Destination Port,Event Count,Event Name,Log Source,Low
          Level Category,Magnitude,Source IP,Source Port,Time
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 2e23f20b-5eb2-41fb-841d-5f6a39b78341
      iscommand: false
      name: Presence of IOC in Destination
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 2e23f20b-5eb2-41fb-841d-5f6a39b78341
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 1420
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${subplaybook-12.QRadar.Search.Result.events}
      fileName:
        simple: Presence of IOC in Source.csv
      headers:
        simple: Destination IP,Destination Port,Event Count,Event Name,Log Source,Low
          Level Category,Magnitude,Source IP,Source Port,Time
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 1b6e8a0f-abd3-4392-87e4-99602099528e
      iscommand: false
      name: Presence of IOC in Source
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 1b6e8a0f-abd3-4392-87e4-99602099528e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1420
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${subplaybook-10.QRadar.Search.Result.events}
      fileName:
        simple: Presence of Domain.csv
      headers:
        simple: Destination IP,Destination Port,Event Count,Event Name,Log Source,Low
          Level Category,Magnitude,Source IP,Source Port,Time
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: a4e386f1-8c4e-44ff-8ca7-bbf31688fe10
      iscommand: false
      name: Presence of Domain
      script: ExportToCSV
      type: regular
      version: -1
    taskid: a4e386f1-8c4e-44ff-8ca7-bbf31688fe10
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1052.5,
          "y": 1420
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AQLDomainSearch
      value:
        simple: select QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as
          'Log Source',"eventCount" as 'Event Count',"startTime" as 'Time',categoryname(category)
          as 'Low Level Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source
          Port',"destinationIP" as 'Destination IP',"destinationPort" as 'Destination
          Port',"userName" as 'Username',"magnitude" as 'Magnitude' from events where
          ( referencesetcontains('${incident.id}_Hunt_IOC_Domain', "BC_ParentDomain")
          AND "deviceGroupList"='100074' ) order by "startTime" desc last 30 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 97e8369e-dcab-49de-897b-1c46dcb9ffd2
      iscommand: false
      name: create Domain search AQL
      script: Set
      type: regular
      version: -1
    taskid: 97e8369e-dcab-49de-897b-1c46dcb9ffd2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1052.5,
          "y": 1070
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AQLIPSearchDestination
      value:
        simple: select QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as
          'Log Source',"eventCount" as 'Event Count',"startTime" as 'Time',categoryname(category)
          as 'Low Level Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source
          Port',"destinationIP" as 'Destination IP',"destinationPort" as 'Destination
          Port',"userName" as 'Username',"magnitude" as 'Magnitude' from events where
          referencesetcontains('${incident.id}_Hunt_IOC_IP', "destinationIP") order
          by "startTime" desc last 30 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c28d84a3-e95c-46ad-87a5-814eafa8848c
      iscommand: false
      name: create IP search in Destination AQL
      script: Set
      type: regular
      version: -1
    taskid: c28d84a3-e95c-46ad-87a5-814eafa8848c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 1070
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AQLIPSearchSource
      value:
        simple: select QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as
          'Log Source',"eventCount" as 'Event Count',"startTime" as 'Time',categoryname(category)
          as 'Low Level Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source
          Port',"destinationIP" as 'Destination IP',"destinationPort" as 'Destination
          Port',"userName" as 'Username',"magnitude" as 'Magnitude' from events where
          referencesetcontains('${incident.id}_Hunt_IOC_IP', "sourceIP") order by
          "startTime" desc last 30 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f374f77d-c989-479d-80ed-d55e4879d7d5
      iscommand: false
      name: create IP search in Source AQL
      script: Set
      type: regular
      version: -1
    taskid: f374f77d-c989-479d-80ed-d55e4879d7d5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1070
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: ${incident.id}_Hunt_IOC_IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Deletes a reference set corresponding to the name provided.
      id: 08600cf3-e5e5-4aaf-8129-5ac77206818d
      iscommand: true
      name: Delete IP Reference Set
      script: QRadar_v2_copy|||qradar-delete-reference-set
      type: regular
      version: -1
    taskid: 08600cf3-e5e5-4aaf-8129-5ac77206818d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 170,
          "y": 1810
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: ${incident.id}_Hunt_IOC_Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Deletes a reference set corresponding to the name provided.
      id: 724cf9f4-e230-4c8c-8c99-b2108c72bab9
      iscommand: true
      name: Delete Domain Reference Set
      script: QRadar_v2_copy|||qradar-delete-reference-set
      type: regular
      version: -1
    taskid: 724cf9f4-e230-4c8c-8c99-b2108c72bab9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1100,
          "y": 1820
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      element_type:
        simple: IP
      ref_name:
        simple: ${incident.id}_Hunt_IOC_IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Creates a new reference set. If the provided name is already in
        use, this command will fail.
      id: 1be60c8c-7973-40eb-860f-ecf857b8e8e2
      iscommand: true
      name: Create Reference Set
      script: QRadar_v2_copy|||qradar-create-reference-set
      type: regular
      version: -1
    taskid: 1be60c8c-7973-40eb-860f-ecf857b8e8e2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 150,
          "y": 740
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      element_type:
        simple: ALNIC
      ref_name:
        simple: ${incident.id}_Hunt_IOC_Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Creates a new reference set. If the provided name is already in
        use, this command will fail.
      id: 882dbbf3-0dca-4c10-8db6-e3168c0c71ac
      iscommand: true
      name: Create Reference Set
      script: QRadar_v2_copy|||qradar-create-reference-set
      type: regular
      version: -1
    taskid: 882dbbf3-0dca-4c10-8db6-e3168c0c71ac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1052.5,
          "y": 730
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2125,
        "width": 1330,
        "x": 150,
        "y": 40
      }
    }
  }
