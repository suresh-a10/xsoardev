contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: 1.0.6
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: Detonate one or more files using the FireEye AX integration. This playbook
  returns relevant reports to the War Room and file reputations to the context data.
  The detonation supports the following file types - PE32, EXE, DLL, JAR, JS, PDF,
  DOC, DOCX, RTF, XLS, PPT, PPTX, XML, ZIP, VBN, SEP, XZ, GZ, BZ2, TAR, MHTML, SWF,
  LNK, URL, MSI, JTD, JTT, JTDC, JTTC, HWP, HWT, HWPX, BAT, HTA, PS1, VBS, WSF, JSE,
  VBE, CHM, JPG, JPEG, GIF, PNG, XLSX
id: 70115b48-f6f8-496c-8d3c-58e2dc87180f
inputs:
- description: File object of the file to detonate.
  key: File
  playbookInputQuery: null
  required: false
  value:
    complex:
      root: File
- description: Polling frequency - how often the polling command should run (minutes)
  key: Interval
  playbookInputQuery: null
  required: true
  value:
    simple: "1"
- description: How much time to wait before a timeout occurs  (minutes)
  key: Timeout
  playbookInputQuery: null
  required: true
  value:
    simple: "30"
name: Detonate File - FireEye AX_WIP
outputs:
- contextPath: File.SHA256
  description: SHA256 hash of the file
  type: string
- contextPath: File.Malicious
  description: The File malicious description
  type: unknown
- contextPath: File.Type
  description: File type e.g. "PE"
  type: string
- contextPath: File.Size
  description: File size
  type: number
- contextPath: File.MD5
  description: MD5 hash of the file
  type: string
- contextPath: File.Name
  description: Filename
  type: string
- contextPath: File.SHA1
  description: SHA1 hash of the file
  type: string
- contextPath: File
  description: The File object
  type: unknown
- contextPath: File.Malicious.Vendor
  description: For malicious files, the vendor that made the decision
  type: string
- contextPath: DBotScore
  description: The DBotScore object
  type: unknown
- contextPath: DBotScore.Indicator
  description: The indicator we tested
  type: string
- contextPath: DBotScore.Type
  description: The type of the indicator
  type: string
- contextPath: DBotScore.Vendor
  description: Vendor used to calculate the score
  type: string
- contextPath: DBotScore.Score
  description: The actual score
  type: number
sourceplaybookid: Detonate File - FireEye AX
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea209ca2-f884-4a14-84ba-0b79f3dc67f8
      iscommand: false
      name: ""
      version: -1
    taskid: ea209ca2-f884-4a14-84ba-0b79f3dc67f8
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1210,
          "y": -130
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Fireeye
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Verify that there is a valid instance of FireEye AX enabled.
      id: b62b2cb6-5ec5-4dc4-82e9-ba982d28099f
      iscommand: false
      name: Is FireEye AX enabled
      type: condition
      version: -1
    taskid: b62b2cb6-5ec5-4dc4-82e9-ba982d28099f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -320,
          "y": 175
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Done
      id: 9927925c-faba-45e0-89b2-ca9ce4cdcd38
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 9927925c-faba-45e0-89b2-ca9ce4cdcd38
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -330,
          "y": 1720
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: File
      value:
        complex:
          root: inputs.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set the file object into context.
      id: 98a72d01-6d62-4502-889d-7359632eb9a9
      iscommand: false
      name: Set file to context
      script: Set
      type: regular
      version: -1
    taskid: 98a72d01-6d62-4502-889d-7359632eb9a9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -95,
          "y": 525
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        simple: "2"
      application:
        simple: "0"
      force:
        simple: "false"
      prefetch:
        simple: "1"
      priority:
        simple: "0"
      profiles:
        simple: ' win7-sp1m'
      timeout:
        simple: "300"
      uploadFile:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: Submits a sample to FireEye AX
      id: f6c17a68-433d-475f-87c7-8fb4bb9d739a
      iscommand: true
      name: FireEye AX Upload Sample
      script: fireeye|||fe-submit
      type: regular
      version: -1
    taskid: f6c17a68-433d-475f-87c7-8fb4bb9d739a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 30,
          "y": 890
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.File
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Asserts there's a file to detonate
      id: 26a41c6c-df17-444a-8074-920396504c3f
      iscommand: false
      name: Is there a file to detonate?
      type: condition
      version: -1
    taskid: 26a41c6c-df17-444a-8074-920396504c3f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -210,
          "y": 350
        }
      }
  "15":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Type
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                  - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Info
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                  - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Extension
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                root: File
          operator: isExists
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: File.Extension
          operator: notEndWith
          right:
            value:
              simple: eml
      label: "yes"
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Asserts the file type is supported
      id: edfb2141-13a5-4a9a-800f-fb5a2264cfb8
      iscommand: false
      name: Is the file type supported?
      type: condition
      version: -1
    taskid: edfb2141-13a5-4a9a-800f-fb5a2264cfb8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -95,
          "y": 700
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      Ids:
        complex:
          accessor: Submissions.Key
          root: FireEyeAX
      Interval:
        complex:
          root: inputs.Interval
      PollingCommandArgName:
        simple: submission_Key
      PollingCommandName:
        simple: fe-submit-status
      Timeout:
        complex:
          root: inputs.Timeout
      dt:
        simple: FireEyeAX.Submissions(val.Status != 'Done').Key
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continually running the command in Step #2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      id: b1c5cb66-ea88-48d4-8a05-51e325bd49b1
      iscommand: false
      name: GenericPolling
      playbookId: GenericPolling
      type: playbook
      version: -1
    taskid: b1c5cb66-ea88-48d4-8a05-51e325bd49b1
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 30,
          "y": 1100
        }
      }
  "17":
    continueonerror: true
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      submission_Key:
        simple: ${FireEyeAX.Submissions.Key}
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: Retrieve result data upon a file. NOTE - This command returns a
        file
      id: 3b554088-be58-4ed7-8d28-f33923cc9efc
      iscommand: true
      name: AX-result
      script: fireeye|||fe-submit-result
      type: regular
      version: -1
    taskid: 3b554088-be58-4ed7-8d28-f33923cc9efc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 17.5,
          "y": 1400
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      Email/cc:
        complex:
          accessor: labels.CC
          root: incident
      Email/from:
        complex:
          accessor: labels.Email/from
          root: incident
      Email/subject:
        complex:
          accessor: labels.Email/subject
          root: incident
      File:
        complex:
          root: File
      GetOriginalEmail:
        simple: "False"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Add email details to the relevant context entities and handle the
        case where original emails are attached.
      id: 2d44bed4-2791-47a5-84ca-77faacbff786
      iscommand: false
      name: TCS - Process Email - Generic
      playbookId: 3d54551f-efc4-420a-8b21-ac3ae034714d
      type: playbook
      version: -1
    taskid: 2d44bed4-2791-47a5-84ca-77faacbff786
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 25
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: inList
              right:
                value:
                  simple: zip,7z
          root: File
      password:
        simple: '{TOMMED}QxtjxSG4hY1TFP6lEob6Y7JirlsVZtpq6Q3/Ra+ekHjpcO+oqgZYVu8ECc0r0xsjn61QHS2y3zj6+ivvRIw4PQ=='
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Unzip a file using fileName or entryID to specify a file. Unzipped
        files will be loaded to the War Room and names will be put into the context.
      id: 1672a6a1-8cb7-4187-8cec-a42f36893dd7
      iscommand: false
      name: Unzip File
      script: UnzipFile
      type: regular
      version: -1
    taskid: 1672a6a1-8cb7-4187-8cec-a42f36893dd7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 200
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      upload:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: inList
              right:
                iscontext: true
                value:
                  simple: ExtractedFiles
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Uploads a file to WildFire for analysis.
      id: 11baba96-782c-4b9a-8fb4-17fbbbe2f504
      iscommand: true
      name: WildFire Upload File
      script: '|||wildfire-upload'
      type: regular
      version: -1
    taskid: 11baba96-782c-4b9a-8fb4-17fbbbe2f504
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 400
        }
      }
  "21":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Report.SHA256
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: WildFire.Report.Status
                    operator: isEqualString
                    right:
                      value:
                        simple: Pending
                root: WildFire
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 88b5db15-fdd1-47fc-8c6e-697996ccb1f2
      iscommand: false
      name: Was upload finished successfully?
      type: condition
      version: -1
    taskid: 88b5db15-fdd1-47fc-8c6e-697996ccb1f2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 605
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      AdditionalPollingCommandArgNames:
        simple: using
      AdditionalPollingCommandArgValues:
        simple: WildFire-v2_instance_1
      Ids:
        complex:
          accessor: Report.SHA256
          root: WildFire
      Interval:
        complex:
          root: inputs.Interval
      PollingCommandArgName:
        simple: hash
      PollingCommandName:
        simple: wildfire-report
      Timeout:
        complex:
          root: inputs.Timeout
      dt:
        simple: WildFire.Report(val.Status != 'Success').SHA256
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      id: 44b3a8ef-3bdb-4610-837c-512c0e330a89
      iscommand: false
      name: GenericPolling
      playbookId: GenericPolling
      type: playbook
      version: -1
    taskid: 44b3a8ef-3bdb-4610-837c-512c0e330a89
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 795
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      format:
        complex:
          root: inputs.ReportFileType
      hash:
        complex:
          accessor: Report.SHA256
          root: WildFire
      using:
        simple: WildFire-v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve results for a file hash using WildFire.
      id: d5761cfa-b217-416c-85d6-9748eb930065
      iscommand: true
      name: WildFire Get Report
      script: '|||wildfire-report'
      type: regular
      version: -1
    taskid: d5761cfa-b217-416c-85d6-9748eb930065
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 960
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${InfoFile.EntryID}
      body:
        simple: |
          Dear Team,

          Please find the attached report for the following file.

          ${ExtractedFiles}

          Thanks & Regards,
          Automation assistance.
      cc:
        simple: ${Email.CC}
      subject:
        complex:
          accessor: Subject
          root: Email
          transformers:
          - args:
              prefix:
                value:
                  simple: Analysis-
              suffix: {}
            operator: concat
      to:
        simple: ${Email.From}
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: be021e90-57ac-477d-8689-45fa105013d8
      iscommand: true
      name: Send Report
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: be021e90-57ac-477d-8689-45fa105013d8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 760,
          "y": 1315
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${InfoFile.EntryID}
      body:
        simple: |
          Dear Team,

          Could not fetch the report for following file.

          ${ExtractedFiles}

          The file upload to sandbox failed. Please try again later.

          Thanks & Regards,
          Automation assistance.
      cc:
        simple: ${Email.CC}
      subject:
        complex:
          accessor: Subject
          root: Email
          transformers:
          - args:
              prefix:
                value:
                  simple: Analysis-
              suffix: {}
            operator: concat
      to:
        simple: ${Email.From}
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: a0c4cfdc-9187-4e63-838f-110032de6011
      iscommand: true
      name: Send Error Mail-file upload failed
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: a0c4cfdc-9187-4e63-838f-110032de6011
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 1330
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 7fcbf007-afd6-4645-8316-22223bc352d7
      iscommand: true
      name: close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 7fcbf007-afd6-4645-8316-22223bc352d7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 970,
          "y": 1510
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 003a84ab-1e3f-4aed-8fef-1b519264e7c4
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 003a84ab-1e3f-4aed-8fef-1b519264e7c4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 970,
          "y": 1655
        }
      }
  "28":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Type
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                  - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Info
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                  - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Extension
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                root: File
          operator: isExists
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: File.Extension
          operator: notEndWith
          right:
            value:
              simple: eml
      label: "yes"
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Asserts the file type is supported
      id: 3f75228e-4748-4f2b-86f5-af2f08803994
      iscommand: false
      name: Is the file type supported in FireEye?
      type: condition
      version: -1
    taskid: 3f75228e-4748-4f2b-86f5-af2f08803994
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 640,
          "y": 370
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        simple: "1"
      application:
        simple: "0"
      force:
        simple: "true"
      prefetch:
        simple: "0"
      priority:
        simple: "1"
      profiles:
        simple: win10x64m
      timeout:
        simple: "500"
      urls:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: inList
              right:
                iscontext: true
                value:
                  simple: ExtractedFiles
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: Submit a url for analysis by FireEye
      id: 0130704d-b967-470a-8634-432852d7c578
      iscommand: true
      name: FireEye AX Upload Sample
      script: fireeye|||fe-submit-url
      type: regular
      version: -1
    taskid: 0130704d-b967-470a-8634-432852d7c578
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 580
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 72662dc3-7389-4731-8476-36a2404c93d5
      iscommand: false
      name: Send Mail
      type: title
      version: -1
    taskid: 72662dc3-7389-4731-8476-36a2404c93d5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 760,
          "y": 1160
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        Ids:
          complex:
            accessor: Submissions.Key
            root: FireEyeAX
        Interval:
          complex:
            root: inputs.Interval
        PollingCommandArgName:
          simple: submission_Key
        PollingCommandName:
          simple: fe-submit-status
        Timeout:
          complex:
            root: inputs.Timeout
        dt:
          simple: FireEyeAX.Submissions(val.Status != 'Done').Key
      wait: 1
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      Ids:
        complex:
          accessor: Key
          root: FireEyeAX.Submissions.URL
      Interval:
        complex:
          root: inputs.Interval
      PollingCommandArgName:
        simple: submission_Key
      PollingCommandName:
        simple: fe-submit-url-status
      Timeout:
        complex:
          root: inputs.Timeout
      dt:
        simple: FireEyeAX.Submissions.URL(val.Status != 'Submission Done').Key
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      id: 0dfab3c7-6058-4dc1-8451-35b868364365
      iscommand: false
      name: GenericPolling
      playbookId: GenericPolling
      type: playbook
      version: -1
    taskid: 0dfab3c7-6058-4dc1-8451-35b868364365
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 480,
          "y": 770
        }
      }
  "32":
    continueonerror: true
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      submissionID:
        simple: ${subplaybook-31.FireEyeAX.Submissions.URL.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      id: 3cf97a08-23a9-4792-8ec3-6f52c7d3ce32
      iscommand: false
      name: AX-result
      script: ca07fab8-8b93-431f-8946-ad2b007a145e
      type: regular
      version: -1
    taskid: 3cf97a08-23a9-4792-8ec3-6f52c7d3ce32
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 970
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      submission_Key:
        simple: ${FireEyeAX.Submissions.Key}
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: Get a status for a url submitted to FireEye analysis
      id: 3da9fe7d-6bcc-4f58-85b1-6e1fac54ff76
      iscommand: true
      name: Get Submission ID
      script: fireeye|||fe-submit-url-status
      type: regular
      version: -1
    taskid: 3da9fe7d-6bcc-4f58-85b1-6e1fac54ff76
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -170,
          "y": 810
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "15_6_#default#": 0.38,
      "28_29_yes": 0.43
    },
    "paper": {
      "dimensions": {
        "height": 1915,
        "width": 2110,
        "x": -330,
        "y": -130
      }
    }
  }
