contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 1.2.13
    packID: ""
    packName: Malware
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: "This playbook provides a framework for handling malware investigation
  through all essential steps. The playbook consists of 7 stages. Each stage contains
  the relevant playbook or tasks. \nThis playbook auto extracts indicators from incidents
  using indicator extraction rules of the malware incident type.\nTo use Illusive
  integration in the `Forensics - Generic` playbook,  note that you will be able to
  set the forensic timeline by editing the `Forensics - Generic` playbook inputs.
  \ \n    "
id: 0bfc45a0-6bd8-4cb3-81ce-d98bd079cdce
inputs:
- description: |-
    This input determines the threshold severity from which to perform auto-isolation for the infected endpoint.
    Specify the severity number (Default is 3 - High):
    Specify the severity number:
    0 - Unknown
    0.5 - Informational
    1 - Low
    2 - Medium
    3 - High
    4 - Critical
  key: AutoIsolation
  playbookInputQuery: null
  required: false
  value:
    simple: "3"
- description: The email address to send a notification if there is a possibility
    of the malware spreading and infecting other endpoints.
  key: Email
  playbookInputQuery: null
  required: false
  value: {}
- description: The MD5 hash value for the suspicious file.
  key: MD5
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: md5
      root: incident
- description: The SHA256 hash value for the suspicious file.
  key: SHA256
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: sha256
      root: incident
- description: Hostname of the machine on which the file is located.
  key: Hostname
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: hostname
      root: incident
- description: |-
    The path of the file to retrieve.
    For example:
    C:\users\folder\file.txt
  key: FilePath
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Path
      root: File
- description: Specifies whether to use a D2 agent to retrieve the file.
  key: UseD2
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: The SHA1 hash value for the suspicious file.
  key: SHA1
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: sha1
      root: incident
- description: |
    Activate Threat Hunting - Generic playbook for automatic hunting.
    Yes- to activate.
  key: ActivateAutomaticHunting
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: |
    Perform manual threat hunting.
    Yes- to activate.
  key: ManualThreatHunting
  playbookInputQuery: null
  required: false
  value:
    simple: "No"
- description: "The value `Yes` will activate the playbook `Forensics - Generic` that
    retrieves additional forensics on the investigating host. \nYes- to activate,"
  key: NeedMoreForensics
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: "This input is relevant if the Threat Hunting - Generic playbook is
    activated. \nIf you activated the Threat Hunting - Generic playbook and you are
    hunting IP addresses, provide the IP addresses here.\n"
  key: IPAddress
  playbookInputQuery: null
  required: false
  value: {}
- description: "This input is relevant if the Threat Hunting - Generic playbook is
    activated. \nIf you activated Threat Hunting - Generic playbook and you are hunting
    for URLs or domains, provide the URLs or domains here."
  key: URLDomain
  playbookInputQuery: null
  required: false
  value: {}
- description: "This input is relevant if the Threat Hunting - Generic playbook is
    activated. \nThe input is a list of internal IP ranges to check IP addresses against.
    The list should be provided in CIDR notation, separated by commas. An example
    of a list of ranges would be: \"172.16.0.0/12,10.0.0.0/8,192.168.0.0/16\" (without
    quotes). If a list is not provided, the playbook will use the default list provided
    in the IsIPInRanges script (the known IPv4 private address ranges)."
  key: InternalRange
  playbookInputQuery: null
  required: false
  value: {}
- description: "This input is relevant if the Threat Hunting - Generic playbook is
    activated. \nThe input is the organization's internal domain name. This is provided
    for the IsInternalHostName script that checks if the detected host names are internal
    or external if the hosts contain the internal domains suffix. For example, demisto.com.
    If there is more than one domain, use the | character to separate values such
    as (demisto.com|test.com)"
  key: InternalDomainName
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    This input is relevant if the Threat Hunting - Generic playbook is activated.
    This is provided for the IsInternalHostName script that checks if the detected host names are internal or external if the hosts match the organizations naming convention. For example, the host testpc1 will have the following regex \w{6}\d{1}
  key: InternalHostRegex
  playbookInputQuery: null
  required: false
  value: {}
- description: This input is relevant if retrieving the file by EDR. If so, provide
    the relevant Agent_ID\Endpoint id.
  key: Agent_ID
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: agentsid
      root: incident
- description: |-
    This input will be used for the `Calculate Severity - Generic v2` playbook.
    Provide your critical users (CSV is optional).
  key: CriticalUsers
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    This input will be uses for the `Calculate Severity - Generic v2` playbook.
    Provide your critical endpoint hostnames (CSV is optional).
  key: CriticalEndpoints
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    This input will be uses for the `Calculate Severity - Generic v2` playbook.
    Provide the DN names of your critical AD groups (CSV is optional).
  key: CriticalGroups
  playbookInputQuery: null
  required: false
  value: {}
- description: Providing "Yes" in this playbook input will activated the "Unisolate
    Endpoint - Generic" playbook.
  key: AutoUnIsolation
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: The IP of the endpoint which is involved in the investigation.
  key: Endpoint_ip
  playbookInputQuery: null
  required: false
  value: {}
- description: Providing "Yes" in this playbook input will link the incidents that
    were found similar by DBotFindSimilarIncidents.
  key: LinkSimilarIncidents
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: Providing "Yes" to this input will activate the "Detonate File - Generic".
  key: DetonateFile
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: Providing "Yes" to this input will activate the "Isolate Endpoint Generic
    V2" after the execution of threat hunting procedures.
  key: IsolationAfterHunting
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
name: Endpoint Malware Investigation - Generic V2_copy
outputs: []
sourceplaybookid: Endpoint Malware Investigation - Generic V2
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "113"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e85bc75b-2e5c-4b19-853f-ccce12860261
      iscommand: false
      name: ""
      version: -1
    taskid: e85bc75b-2e5c-4b19-853f-ccce12860261
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 490,
          "y": 50
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0358e4b3-aa0b-49f1-8711-dd5201d482a0
      iscommand: false
      name: Detonation
      type: title
      version: -1
    taskid: 0358e4b3-aa0b-49f1-8711-dd5201d482a0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2030
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 70abfb54-cfe8-4001-8aeb-541f67b3a66f
      iscommand: false
      name: File enrichment
      type: title
      version: -1
    taskid: 70abfb54-cfe8-4001-8aeb-541f67b3a66f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 90,
          "y": 2030
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 09ad161f-d253-4d6b-80ad-443a69dea01d
      iscommand: false
      name: Hunting
      type: title
      version: -1
    taskid: 09ad161f-d253-4d6b-80ad-443a69dea01d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 180,
          "y": 5570
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 94c7e120-0b42-45f5-815b-01b116b9119a
      iscommand: false
      name: Remediation
      type: title
      version: -1
    taskid: 94c7e120-0b42-45f5-815b-01b116b9119a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 250,
          "y": 8435
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "No":
      - "41"
      "Yes":
      - "115"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ec3b9337-f1a2-4d0f-8ae8-c19945e172bb
      iscommand: false
      name: Manual - Get analyst approval for auto-remediation
      type: condition
      version: -1
    taskid: ec3b9337-f1a2-4d0f-8ae8-c19945e172bb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 8560
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f77fd538-1e5d-4f2a-87a0-44a1610386c4
      iscommand: false
      name: Analyst review of the investigation
      type: regular
      version: -1
    taskid: f77fd538-1e5d-4f2a-87a0-44a1610386c4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 8900
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Unisolate endpoints that were isolated during the investigation
        after remediation.
      id: 5755abf8-a1de-4472-893e-f99cfa89aeb9
      iscommand: false
      name: Manual - Unisolate endpoints
      type: regular
      version: -1
    taskid: 5755abf8-a1de-4472-893e-f99cfa89aeb9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 9600
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    scriptarguments:
      MD5:
        complex:
          root: inputs.MD5
          transformers:
          - operator: uniq
      SHA1:
        complex:
          root: inputs.SHA1
          transformers:
          - operator: uniq
      SHA256:
        complex:
          root: inputs.SHA256
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Enrich a file with threat information using one or more integrations.
      id: 961aa34b-c7b1-4f54-8c78-3ecdaa6b0020
      iscommand: false
      name: File Enrichment - Generic v2
      playbookId: File Enrichment - Generic v2
      type: playbook
      version: -1
    taskid: 961aa34b-c7b1-4f54-8c78-3ecdaa6b0020
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 90,
          "y": 2160
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    scriptarguments:
      EntryID:
        complex:
          accessor: EntryID
          root: File
      File:
        complex:
          root: File
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Detonate file through active integrations that support file detonation.
      id: 8ff380f4-4278-4f31-8e2a-a14ce9f62fdc
      iscommand: false
      name: Detonate File - Generic
      playbookId: Detonate File - Generic
      type: playbook
      version: -1
    taskid: 8ff380f4-4278-4f31-8e2a-a14ce9f62fdc
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2950
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        A script to generate an automated investigation summary report.
        Can be used in the post-processing flow as well.
      id: 6a97803f-cbc0-40e8-80d3-adc0945241fd
      iscommand: false
      name: Generate Investigation Summary Report
      script: GenerateInvestigationSummaryReport
      tags:
      - Investigation-Report
      type: regular
      version: -1
    taskid: 6a97803f-cbc0-40e8-80d3-adc0945241fd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 9065
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: EntryID
                root: File
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "123"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 23d8f7ae-b25d-4923-8f48-b11509ccf8aa
      iscommand: false
      name: Was a file retrieved?
      type: condition
      version: -1
    taskid: 23d8f7ae-b25d-4923-8f48-b11509ccf8aa
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2330
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6c44edfa-9bdb-4af2-8c68-a367d15d3bf7
      iscommand: false
      name: Retrieve file manually
      type: regular
      version: -1
    taskid: 6c44edfa-9bdb-4af2-8c68-a367d15d3bf7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 2510
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manually hunt for other infected endpoints.
      id: 129fc1ec-f59f-4b8d-8980-a0177eff0d77
      iscommand: false
      name: Manual - Hunt for other infected endpoints
      type: regular
      version: -1
    taskid: 129fc1ec-f59f-4b8d-8980-a0177eff0d77
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6705
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "No":
      - "103"
      "Yes":
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7c1d7d51-f868-47ee-8554-c226bc863198
      iscommand: false
      name: Were there any more infected endpoints found?
      type: condition
      version: -1
    taskid: 7c1d7d51-f868-47ee-8554-c226bc863198
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6855
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e9586853-dcab-44e2-8ef3-9dfa34e52154
      iscommand: false
      name: Analyst manual remediation
      type: regular
      version: -1
    taskid: e9586853-dcab-44e2-8ef3-9dfa34e52154
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 8730
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 22902447-f4d3-4137-8f62-99fd58c0bf8a
      iscommand: false
      name: Perform manual malware analysis and forensics
      type: regular
      version: -1
    taskid: 22902447-f4d3-4137-8f62-99fd58c0bf8a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 190,
          "y": 5080
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5d1f16e5-303c-4a23-841b-a3bdce94e63a
      iscommand: false
      name: False Positive
      type: title
      version: -1
    taskid: 5d1f16e5-303c-4a23-841b-a3bdce94e63a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -670,
          "y": 4350
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "No":
      - "98"
      "Yes":
      - "95"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f71da604-4245-4e11-8b24-869deeb6ea62
      iscommand: false
      name: Get analyst approval for local containment
      type: condition
      version: -1
    taskid: f71da604-4245-4e11-8b24-869deeb6ea62
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 190,
          "y": 4405
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: inputs.AutoIsolation
                    operator: lessThanOrEqual
                    right:
                      iscontext: true
                      value:
                        simple: incident.severity
                root: inputs.AutoIsolation
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "95"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 28751e9a-12c2-4a68-8d4c-b21b64bb05ea
      iscommand: false
      name: Auto-Isolation?
      type: condition
      version: -1
    taskid: 28751e9a-12c2-4a68-8d4c-b21b64bb05ea
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 4210
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Continue Investigation:
      - "50"
      False positive:
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 980b17ce-f776-4967-8f2c-019ab995a934
      iscommand: false
      name: Continue with the investigation or close as false positive?
      type: condition
      version: -1
    taskid: 980b17ce-f776-4967-8f2c-019ab995a934
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3920
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "73"
    note: false
    quietmode: 0
    scriptarguments:
      Account:
        complex:
          root: Account
          transformers:
          - operator: uniq
      CriticalEndpoints:
        complex:
          root: inputs.CriticalEndpoints
          transformers:
          - operator: uniq
      CriticalGroups:
        complex:
          root: inputs.CriticalGroups
          transformers:
          - operator: uniq
      CriticalUsers:
        complex:
          root: inputs.CriticalUsers
          transformers:
          - operator: uniq
      DBotScore:
        complex:
          root: DBotScore
      EmailAuthenticityCheck:
        complex:
          accessor: AuthenticityCheck
          root: Email
          transformers:
          - operator: uniq
      Endpoint:
        complex:
          accessor: Hostname
          root: incident
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Calculate and assign the incident severity based on the highest returned severity level from the following calculations:

        - DBotScores of indicators
        - Critical assets
        - Email authenticity
        - Current incident severity
      id: 0b25efd1-81ff-4499-8166-086795436374
      iscommand: false
      name: Calculate Severity - Generic v2
      playbookId: Calculate Severity - Generic v2
      type: playbook
      version: -1
    taskid: 0b25efd1-81ff-4499-8166-086795436374
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3400
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          During an endpoint malware investigation in Cortex XSOAR, other infected endpoints were found, which can possibly indicate the malware is spreading in your organization and requires your attention.
          To get more information, go to this incident in Cortex XSOAR: ${incident.id}
      subject:
        simple: Potential malware spreading in your organization
      to:
        complex:
          root: inputs.Email
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 9686a789-19cf-45c1-80dc-f97d72c662f9
      iscommand: true
      name: Notify that more infected endpoints were found
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 9686a789-19cf-45c1-80dc-f97d72c662f9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 830,
          "y": 7540
        }
      }
  "56":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Email
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "66"
      "yes":
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: efee6c2a-80c4-44db-827e-dce4c943ae52
      iscommand: false
      name: Send notification regarding infected endpoints?
      type: condition
      version: -1
    taskid: efee6c2a-80c4-44db-827e-dce4c943ae52
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 7370
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 30329d9a-02d2-409d-8748-1baef910bdb7
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 30329d9a-02d2-409d-8748-1baef910bdb7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -670,
          "y": 10350
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: ${Closing reason.Answers.0}
      id:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 8ea1ade5-1424-48cb-8384-1e089f0d49e1
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 8ea1ade5-1424-48cb-8384-1e089f0d49e1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -220,
          "y": 10140
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Close the incident in the source product that triggered it.
      id: 87ff19f8-25fe-444d-85aa-33211b953ef0
      iscommand: false
      name: Manual - Close incident in the source product
      type: regular
      version: -1
    taskid: 87ff19f8-25fe-444d-85aa-33211b953ef0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -220,
          "y": 9810
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "98"
    note: false
    quietmode: 0
    scriptarguments:
      isolated:
        simple: Endpoint was isolated successfully.
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an incident
      id: 7eb34321-9cdb-492b-869c-8a9f10a1ba91
      iscommand: true
      name: Set incident - Isolated field
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 7eb34321-9cdb-492b-869c-8a9f10a1ba91
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 4760
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "124"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 700e95ca-3311-41b8-85cb-61df1efd309e
      iscommand: false
      name: Isolate infected endpoints
      type: title
      version: -1
    taskid: 700e95ca-3311-41b8-85cb-61df1efd309e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 7710
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      Agent_ID:
        simple: ${Endpoint.ID}
      Hostname:
        simple: ${Endpoint.Hostname}
      MD5:
        simple: ${inputs.MD5}
      Path:
        simple: ${inputs.FilePath}
      SHA256:
        simple: ${inputs.SHA256}
      UseD2:
        simple: ${inputs.UseD2}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        'This playbook retrieves a file sample from an endpoint using the following playbooks:'
        - Get File Sample From Path - Generic v2.
        - Get File Sample By Hash - Generic v3.
      id: 6d2a3b5d-2a66-49b8-80e2-8f28c321d1e2
      iscommand: false
      name: Retrieve File from Endpoint - Generic V2
      playbookId: Retrieve File from Endpoint - Generic V2
      type: playbook
      version: -1
    taskid: 6d2a3b5d-2a66-49b8-80e2-8f28c321d1e2
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2160
        }
      }
  "68":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ActivateAutomaticHunting
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "69"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9f077e86-80c8-4bdd-8ebd-5edec3278e59
      iscommand: false
      name: Activate automatic hunting
      type: condition
      version: -1
    taskid: 9f077e86-80c8-4bdd-8ebd-5edec3278e59
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 180,
          "y": 5720
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "101"
    note: false
    quietmode: 0
    scriptarguments:
      Hostname:
        simple: ${Endpoint.Hostname}
      InternalDomainName:
        simple: ${inputs.InternalDomainName}
      InternalHostRegex:
        simple: ${inputs.InternalHostRegex}
      InternalRange:
        simple: ${inputs.InternalRange}
      MD5:
        simple: ${inputs.MD5}
      SHA1:
        simple: ${inputs.SHA1}
      SHA256:
        simple: ${inputs.SHA256}
      URLDomain:
        simple: ${inputs.URLDomain}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook enables threat hunting for IOCs in your enterprise.\nThis
        playbook currently supports the following integrations:\n- Splunk\n- Qradar\n-
        Pan-os\n- Cortex data lake \n- Autofocus"
      id: e1f6eb0d-3282-45cf-8dab-53b335e80e21
      iscommand: false
      name: Threat Hunting - Generic
      playbookId: Threat Hunting - Generic
      type: playbook
      version: -1
    taskid: e1f6eb0d-3282-45cf-8dab-53b335e80e21
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 5900
        }
      }
  "70":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ManualThreatHunting
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b3d8b6fd-bec6-4f61-8a71-2fdfaa5fa7e2
      iscommand: false
      name: Continue to manual threat hunting?
      type: condition
      version: -1
    taskid: b3d8b6fd-bec6-4f61-8a71-2fdfaa5fa7e2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6535
        }
      }
  "71":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.NeedMoreForensics
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eac45cbe-827e-41cb-8c62-98682053e95a
      iscommand: false
      name: Need more forensics?
      type: condition
      version: -1
    taskid: eac45cbe-827e-41cb-8c62-98682053e95a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 190,
          "y": 5220
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "97"
    note: false
    quietmode: 0
    scriptarguments:
      onCall:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Assign analyst to incident.
        By default, the analyst is picked randomly from the available users, according to the provided roles. (If no roles are provided, will fetch all users).
        Otherwise, the analyst will be picked according to the 'assignBy' arguments.
        machine-learning: DBot will calculate and decide who is the best analyst for the job.
        top-user: The user who most commonly owns this type of incident.
        less-busy-user: The less busy analyst will be picked to be the incident owner.
        online: The analyst is picked randomly from all online analysts, according to the provided roles. (If no roles provided, will fetch all users).
        current: The user who executed the command.
      id: cdf06534-9aec-4685-867d-2bb6963fbf09
      iscommand: false
      name: Assign incident to analyst
      script: AssignAnalystToIncident
      type: regular
      version: -1
    taskid: cdf06534-9aec-4685-867d-2bb6963fbf09
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3595
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "120"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2d8c8358-4ce3-402e-8157-c1fa970a7c14
      iscommand: false
      name: Add the file that caused the FP in the source product to allow list
      type: regular
      version: -1
    taskid: 2d8c8358-4ce3-402e-8157-c1fa970a7c14
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 4855
        }
      }
  "76":
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook retrieves forensics from hosts.\nThe available integration
        is Illusive networks. "
      id: 79d7c27b-0df9-495f-8e33-c07b165d38b7
      iscommand: false
      name: Get host forensics - Generic
      playbookId: Get host forensics - Generic
      type: playbook
      version: -1
    taskid: 79d7c27b-0df9-495f-8e33-c07b165d38b7
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 5395
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c0cbbfbd-7c4f-48e1-8146-036c63db0bf5
      iscommand: false
      name: Manually list detected hostnames
      type: regular
      version: -1
    taskid: c0cbbfbd-7c4f-48e1-8146-036c63db0bf5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7055
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: Threat.Hunting.Detected.Hostsname
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      id: 7689250e-1d4f-4c2d-8cce-8af1194c31cc
      iscommand: false
      name: Set manual host names
      script: commentsToContext
      type: regular
      version: -1
    taskid: 7689250e-1d4f-4c2d-8cce-8af1194c31cc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7200
        }
      }
  "79":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.AutoUnIsolation
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f38195fb-5dbc-4882-8cd1-4e332c93c19f
      iscommand: false
      name: Activated auto unisolation
      type: condition
      version: -1
    taskid: f38195fb-5dbc-4882-8cd1-4e332c93c19f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 9410
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_ID:
        simple: ${Endpoint.ID}
      Hostname:
        complex:
          accessor: Hostname
          root: Endpoint
          transformers:
          - args:
              item:
                value:
                  simple: Threat.Hunting.Detected.Hostsname
            operator: append
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook unisolates endpoints according to the endpoint ID
        or hostname that is provided in the playbook.\nCurrently supports the following
        integrations:\n- Carbon Black Response\n- Cortex XDR\n- Crowdstrike Falcon\n-
        FireEye HX \n- Cybereason\n"
      id: 5a49f432-f48b-405c-83e2-dc5b22fe5e62
      iscommand: false
      name: Unisolate Endpoint - Generic
      playbookId: Unisolate Endpoint - Generic
      type: playbook
      version: -1
    taskid: 5a49f432-f48b-405c-83e2-dc5b22fe5e62
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 9600
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "110"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        simple: ${inputs.Hostname}
      Endpoint_id:
        simple: ${inputs.Agent_ID}
      Endpoint_ip:
        simple: ${inputs.Endpoint_ip}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook uses the generic command !endpoint to retrieve details
        on specific endpoint.\nThis command currently supports the following integrations:\n-
        Palo Alto Networks Cortex XDR - Investigation and Response.\n- CrowdStrike
        Falcon. "
      id: 85236a32-cefd-4e98-8e88-0bbdb96312e5
      iscommand: false
      name: Get endpoint details - Generic
      playbookId: Get endpoint details - Generic
      type: playbook
      version: -1
    taskid: 85236a32-cefd-4e98-8e88-0bbdb96312e5
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1400
        }
      }
  "94":
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        simple: ${Threat.Hunting.Detected.Hostsname}
      Endpoint_id:
        simple: ${Endpoint.ID}
      Endpoint_ip:
        simple: ${Threat.Hunting.Detected.IP}
      ManualHunting.DetectedHosts:
        simple: ${ManualHunting.DetectedHosts}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This playbook isolates a given endpoint via various endpoint product integrations.
        Make sure to provide the valid playbook input for the integration that you are using.
      id: 3ac22f17-2cb5-402a-8062-2fe79ed21c0a
      iscommand: false
      name: Isolate Endpoint - Generic V2
      playbookId: Isolate Endpoint - Generic V2
      type: playbook
      version: -1
    taskid: 3ac22f17-2cb5-402a-8062-2fe79ed21c0a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 8250
        }
      }
  "95":
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        simple: ${Endpoint.Hostname}
      Endpoint_id:
        simple: ${Endpoint.ID}
      Endpoint_ip:
        simple: ${Endpoint.IPAddress}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This playbook isolates a given endpoint via various endpoint product integrations.
        Make sure to provide the valid playbook input for the integration that you are using.
      id: 3452c399-4fc9-4ebc-8401-f8bc9d8a2427
      iscommand: false
      name: Isolate Endpoint - Generic V2
      playbookId: Isolate Endpoint - Generic V2
      type: playbook
      version: -1
    taskid: 3452c399-4fc9-4ebc-8401-f8bc9d8a2427
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 4580
        }
      }
  "97":
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 69c0fda1-cbb1-446a-823f-bc787a0c29f2
      iscommand: false
      name: Isolation
      type: title
      version: -1
    taskid: 69c0fda1-cbb1-446a-823f-bc787a0c29f2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3770
        }
      }
  "98":
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3c3f9d43-65c8-419c-86ac-57cb7b00251c
      iscommand: false
      name: Forensics
      type: title
      version: -1
    taskid: 3c3f9d43-65c8-419c-86ac-57cb7b00251c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 190,
          "y": 4960
        }
      }
  "99":
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 64dddd1b-b42a-400d-8ded-1c485dc79de2
      iscommand: false
      name: Unisolation
      type: title
      version: -1
    taskid: 64dddd1b-b42a-400d-8ded-1c485dc79de2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 250,
          "y": 9250
        }
      }
  "100":
    continueonerrortype: ""
    id: "100"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Account.Username
      value:
        complex:
          accessor: user
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6b2bd964-30ed-4658-870f-42b7f244f66a
      iscommand: false
      name: Set user as account
      script: Set
      type: regular
      version: -1
    taskid: 6b2bd964-30ed-4658-870f-42b7f244f66a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3205
        }
      }
  "101":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Hostnames
      output:
        simple: ${Threat.Hunting.Detected.Hostsname}
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "102"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.Hostsname
      value:
        complex:
          accessor: DetectedInternalHosts
          root: QRadar
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: PANWHunting.DetectedInternalHosts
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: Splunk.DetectedInternalHosts
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 9bcd5762-90b9-40f2-882d-a2d283a3ae05
      iscommand: false
      name: Set detected hostnames to context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 9bcd5762-90b9-40f2-882d-a2d283a3ae05
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6055
        }
      }
  "102":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Detected IPs
      output:
        simple: ${Threat.Hunting.Detected.IP}
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "122"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.IP
      value:
        complex:
          accessor: DetectedInternalIPs
          root: Splunk
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: PANWHunting.DetectedInternalIPs
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: QRadar.DetectedInternalIPs
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 527aa643-6a60-49f4-82aa-78c9a8432097
      iscommand: false
      name: Set detected IP's to context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 527aa643-6a60-49f4-82aa-78c9a8432097
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6210
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7e34fd27-558d-4cff-8b60-a179b6858ac5
      iscommand: false
      name: No results for manual TH
      type: title
      version: -1
    taskid: 7e34fd27-558d-4cff-8b60-a179b6858ac5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -160,
          "y": 7710
        }
      }
  "104":
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        simple: ${Threat.Hunting.Detected.Hostsname}
      Endpoint_id:
        simple: ${EndpointDetails.ID}
      Endpoint_ip:
        simple: ${Threat.Hunting.Detected.IP}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook uses the generic command !endpoint to retrieve details
        on specific endpoint.\nThis command currently supports the following integrations:\n-
        Palo Alto Networks Cortex XDR - Investigation and Response.\n- CrowdStrike
        Falcon. "
      id: a2420b0b-768a-4f2d-8b77-16bcffbff065
      iscommand: false
      name: Get endpoint details - Generic
      playbookId: Get endpoint details - Generic
      type: playbook
      version: -1
    taskid: a2420b0b-768a-4f2d-8b77-16bcffbff065
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 8085
        }
      }
  "107":
    continueonerrortype: ""
    id: "107"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: Endpoint Hostname,Endpoint ID,Endpoint IP Address,Endpoint Is Isolated,Endpoint
          MAC Address,Endpoint OS,Endpoint Vendor
      context_path:
        simple: Endpoint
      grid_id:
        simple: endpoint
      keys:
        simple: Hostname,ID,IPAddress,IsIsolated,MACAddress,OS,Vendor
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a grid table from items or key-value pairs.
      id: 00c981c5-e838-4f77-85cc-1980dc4dabcf
      iscommand: false
      name: Set endpoint details to layout
      script: SetGridField
      type: regular
      version: -1
    taskid: 00c981c5-e838-4f77-85cc-1980dc4dabcf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1680
        }
      }
  "110":
    continueonerrortype: ""
    id: "110"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "107"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 206c1f75-9cd5-4a70-857b-66c166a099a3
      iscommand: false
      name: Set to layout
      type: title
      version: -1
    taskid: 206c1f75-9cd5-4a70-857b-66c166a099a3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1535
        }
      }
  "111":
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "116"
    note: false
    quietmode: 0
    scriptarguments:
      fieldExactMatch:
        simple: incident.type
      similarTextField:
        simple: incident.parentcmdline,incident.filepaths,incident.cmd
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Find past similar incidents based on incident fields' similarity.
        Includes an option to also display indicators' similarity.
      id: d14052a2-e47f-4e08-84e4-28f34b04d06c
      iscommand: false
      name: Find similar incidents
      script: DBotFindSimilarIncidents
      type: regular
      version: -1
    taskid: d14052a2-e47f-4e08-84e4-28f34b04d06c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 340
        }
      }
  "112":
    continueonerrortype: ""
    id: "112"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "118"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: Incident Id,Created,Name,Similarity Incident,Parent CMD line,File
          path,Command line
      context_path:
        simple: DBotFindSimilarIncidents.similarIncident(val.id='#/Details/'+val.id,val.parentcmdline=val.parentcmdline.join(','),val.filepaths=val.filepaths.join(','),val.cmd=val.cmd.join(','))
      grid_id:
        simple: similarincidentsdbot
      keys:
        simple: id,created,name,similarity incident,parentcmdline,filepaths,cmd
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a grid table from items or key-value pairs.
      id: 029d95e5-9e52-49b7-86b1-f985d8d7b6eb
      iscommand: false
      name: Set similar incidents to layout
      script: SetGridField
      type: regular
      version: -1
    taskid: 029d95e5-9e52-49b7-86b1-f985d8d7b6eb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 690
        }
      }
  "113":
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "111"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 670dc711-d951-4d60-8835-67be18dbea28
      iscommand: false
      name: Find similar incidents
      type: title
      version: -1
    taskid: 670dc711-d951-4d60-8835-67be18dbea28
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 195
        }
      }
  "114":
    continueonerrortype: ""
    id: "114"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bec7c9a3-000b-446f-8a63-711bc18f8e65
      iscommand: false
      name: Get endpoint details
      type: title
      version: -1
    taskid: bec7c9a3-000b-446f-8a63-711bc18f8e65
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1275
        }
      }
  "115":
    continueonerrortype: ""
    id: "115"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        simple: "No"
      CustomBlockRule:
        simple: "True"
      CustomURLCategory:
        simple: Demisto Remediation - Malicious URLs
      IP:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: ip
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      MD5:
        complex:
          accessor: MD5
          root: File
      SHA256:
        complex:
          accessor: SHA256
          root: File
      URL:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: url
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      URLListName:
        simple: Demisto Remediation - URL EDL
      Username:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: username
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |+
        This playbook blocks malicious indicators using all integrations that are enabled, using the following sub-playbooks:

        - Block URL - Generic
        - Block Account - Generic
        - Block IP - Generic v2
        - Block File - Generic v2

      id: f403def3-c127-418d-8bc9-78c72b4a2858
      iscommand: false
      name: Block Indicators - Generic v2
      playbookId: Block Indicators - Generic v2
      type: playbook
      version: -1
    taskid: f403def3-c127-418d-8bc9-78c72b4a2858
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -20,
          "y": 8730
        }
      }
  "116":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: DBotFindSimilarIncidents.similarIncident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "116"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "114"
      "yes":
      - "112"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a7b74666-1919-4898-8de6-c0bb1dd82042
      iscommand: false
      name: Are there similar incidents?
      type: condition
      version: -1
    taskid: a7b74666-1919-4898-8de6-c0bb1dd82042
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 515
        }
      }
  "117":
    continueonerrortype: ""
    id: "117"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "114"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        complex:
          accessor: id
          root: incident
      linkedIncidentIDs:
        simple: ${DBotFindSimilarIncidents.similarIncident.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.linkIncidents
      id: f228db01-3bea-40be-84c8-196edf3b2211
      iscommand: true
      name: Link similar incidents
      script: Builtin|||linkIncidents
      type: regular
      version: -1
    taskid: f228db01-3bea-40be-84c8-196edf3b2211
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 1070
        }
      }
  "118":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.LinkSimilarIncidents
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "118"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "114"
      "yes":
      - "117"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c746236d-22e8-48f6-8502-436dc54b70b4
      iscommand: false
      name: Link the similar events?
      type: condition
      version: -1
    taskid: c746236d-22e8-48f6-8502-436dc54b70b4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 960,
          "y": 855
        }
      }
  "119":
    continueonerrortype: ""
    id: "119"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: d4de2ee2-7f48-43b0-8e29-1c06cf3f2801
      iscommand: true
      name: Close investigation as false positive
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: d4de2ee2-7f48-43b0-8e29-1c06cf3f2801
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 10140
        }
      }
  "120":
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "119"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Close the incident in the source product that triggered it.
      id: cd6c795c-744f-4568-8741-62cca3f85fa0
      iscommand: false
      name: Manual - Close incident in the source product
      type: regular
      version: -1
    taskid: cd6c795c-744f-4568-8741-62cca3f85fa0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 5090
        }
      }
  "121":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Specify the closing reason
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: shortText
      sender: ""
      title: Closing reason
      totalanswers: 0
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: {}
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d7188cfa-02be-4d84-8454-f7e7b69e1825
      iscommand: false
      name: Closing reason
      type: collection
      version: -1
    taskid: d7188cfa-02be-4d84-8454-f7e7b69e1825
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -220,
          "y": 9970
        }
      }
  "122":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Detected User
      output:
        simple: ${Threat.Hunting.Detected.Users}
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.Users
      value:
        complex:
          accessor: DetectedUsers
          root: Splunk
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: PANWHunting.DetectedUsers
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: QRadar.DetectedUsers
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: b3dc913d-16da-49f5-8614-2db636fe924d
      iscommand: false
      name: Set detected users to to context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: b3dc913d-16da-49f5-8614-2db636fe924d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6370
        }
      }
  "123":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.DetonateFile
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "123"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "100"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 89be850e-47a1-4d4e-81e3-2acf4f7e5e37
      iscommand: false
      name: Activate auto detonation?
      type: condition
      version: -1
    taskid: 89be850e-47a1-4d4e-81e3-2acf4f7e5e37
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2685
        }
      }
  "124":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.IsolationAfterHunting
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "124"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "104"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3d9f09b6-b157-4f15-882b-ea0d04bb47c2
      iscommand: false
      name: Activate auto isolation after threat hunting?
      type: condition
      version: -1
    taskid: 3d9f09b6-b157-4f15-882b-ea0d04bb47c2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 7840
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "116_112_yes": 0.53,
      "116_114_#default#": 0.32,
      "118_114_#default#": 0.83,
      "118_117_yes": 0.68,
      "123_100_#default#": 0.64,
      "123_28_yes": 0.56,
      "124_104_yes": 0.63,
      "19_115_Yes": 0.53,
      "19_41_No": 0.58,
      "36_123_yes": 0.53,
      "36_37_#default#": 0.64,
      "39_77_Yes": 0.49,
      "46_98_No": 0.51,
      "50_46_#default#": 0.66,
      "50_95_yes": 0.49,
      "51_45_False positive": 0.67,
      "51_50_Continue Investigation ": 0.58,
      "56_55_yes": 0.6,
      "56_66_#default#": 0.51,
      "71_12_#default#": 0.51,
      "79_21_#default#": 0.64
    },
    "paper": {
      "dimensions": {
        "height": 10365,
        "width": 2210,
        "x": -670,
        "y": 50
      }
    }
  }
