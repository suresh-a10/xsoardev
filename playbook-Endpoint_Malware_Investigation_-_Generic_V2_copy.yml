contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 1.2.13
    packID: ""
    packName: Malware
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: "This playbook provides a framework for handling malware investigation
  through all essential steps. The playbook consists of 7 stages. Each stage contains
  the relevant playbook or tasks. \nThis playbook auto extracts indicators from incidents
  using indicator extraction rules of the malware incident type.\nTo use Illusive
  integration in the `Forensics - Generic` playbook,  note that you will be able to
  set the forensic timeline by editing the `Forensics - Generic` playbook inputs.
  \ \n    "
id: 0bfc45a0-6bd8-4cb3-81ce-d98bd079cdce
inputs:
- description: |-
    This input determines the threshold severity from which to perform auto-isolation for the infected endpoint.
    Specify the severity number (Default is 3 - High):
    Specify the severity number:
    0 - Unknown
    0.5 - Informational
    1 - Low
    2 - Medium
    3 - High
    4 - Critical
  key: AutoIsolation
  playbookInputQuery: null
  required: false
  value:
    simple: "3"
- description: The email address to send a notification if there is a possibility
    of the malware spreading and infecting other endpoints.
  key: Email
  playbookInputQuery: null
  required: false
  value: {}
- description: The MD5 hash value for the suspicious file.
  key: MD5
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: md5
      root: incident
- description: The SHA256 hash value for the suspicious file.
  key: SHA256
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: sha256
      root: incident
- description: Hostname of the machine on which the file is located.
  key: Hostname
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: hostname
      root: incident
- description: |-
    The path of the file to retrieve.
    For example:
    C:\users\folder\file.txt
  key: FilePath
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Path
      root: File
- description: Specifies whether to use a D2 agent to retrieve the file.
  key: UseD2
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: The SHA1 hash value for the suspicious file.
  key: SHA1
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: sha1
      root: incident
- description: |
    Activate Threat Hunting - Generic playbook for automatic hunting.
    Yes- to activate.
  key: ActivateAutomaticHunting
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: |
    Perform manual threat hunting.
    Yes- to activate.
  key: ManualThreatHunting
  playbookInputQuery: null
  required: false
  value:
    simple: "No"
- description: "The value `Yes` will activate the playbook `Forensics - Generic` that
    retrieves additional forensics on the investigating host. \nYes- to activate,"
  key: NeedMoreForensics
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: "This input is relevant if the Threat Hunting - Generic playbook is
    activated. \nIf you activated the Threat Hunting - Generic playbook and you are
    hunting IP addresses, provide the IP addresses here.\n"
  key: IPAddress
  playbookInputQuery: null
  required: false
  value: {}
- description: "This input is relevant if the Threat Hunting - Generic playbook is
    activated. \nIf you activated Threat Hunting - Generic playbook and you are hunting
    for URLs or domains, provide the URLs or domains here."
  key: URLDomain
  playbookInputQuery: null
  required: false
  value: {}
- description: "This input is relevant if the Threat Hunting - Generic playbook is
    activated. \nThe input is a list of internal IP ranges to check IP addresses against.
    The list should be provided in CIDR notation, separated by commas. An example
    of a list of ranges would be: \"172.16.0.0/12,10.0.0.0/8,192.168.0.0/16\" (without
    quotes). If a list is not provided, the playbook will use the default list provided
    in the IsIPInRanges script (the known IPv4 private address ranges)."
  key: InternalRange
  playbookInputQuery: null
  required: false
  value: {}
- description: "This input is relevant if the Threat Hunting - Generic playbook is
    activated. \nThe input is the organization's internal domain name. This is provided
    for the IsInternalHostName script that checks if the detected host names are internal
    or external if the hosts contain the internal domains suffix. For example, demisto.com.
    If there is more than one domain, use the | character to separate values such
    as (demisto.com|test.com)"
  key: InternalDomainName
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    This input is relevant if the Threat Hunting - Generic playbook is activated.
    This is provided for the IsInternalHostName script that checks if the detected host names are internal or external if the hosts match the organizations naming convention. For example, the host testpc1 will have the following regex \w{6}\d{1}
  key: InternalHostRegex
  playbookInputQuery: null
  required: false
  value: {}
- description: This input is relevant if retrieving the file by EDR. If so, provide
    the relevant Agent_ID\Endpoint id.
  key: Agent_ID
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: agentsid
      root: incident
- description: |-
    This input will be used for the `Calculate Severity - Generic v2` playbook.
    Provide your critical users (CSV is optional).
  key: CriticalUsers
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    This input will be uses for the `Calculate Severity - Generic v2` playbook.
    Provide your critical endpoint hostnames (CSV is optional).
  key: CriticalEndpoints
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    This input will be uses for the `Calculate Severity - Generic v2` playbook.
    Provide the DN names of your critical AD groups (CSV is optional).
  key: CriticalGroups
  playbookInputQuery: null
  required: false
  value: {}
- description: Providing "Yes" in this playbook input will activated the "Unisolate
    Endpoint - Generic" playbook.
  key: AutoUnIsolation
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: The IP of the endpoint which is involved in the investigation.
  key: Endpoint_ip
  playbookInputQuery: null
  required: false
  value: {}
- description: Providing "Yes" in this playbook input will link the incidents that
    were found similar by DBotFindSimilarIncidents.
  key: LinkSimilarIncidents
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: Providing "Yes" to this input will activate the "Detonate File - Generic".
  key: DetonateFile
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: Providing "Yes" to this input will activate the "Isolate Endpoint Generic
    V2" after the execution of threat hunting procedures.
  key: IsolationAfterHunting
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
name: Endpoint Malware Investigation - Generic V2_copy
outputs: []
sourceplaybookid: Endpoint Malware Investigation - Generic V2
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "113"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ed8f0812-be8f-4778-8d08-a9f04a70f61e
      iscommand: false
      name: ""
      version: -1
    taskid: ed8f0812-be8f-4778-8d08-a9f04a70f61e
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 490,
          "y": 50
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5c9f4df9-774e-425c-89bb-72f1ca067167
      iscommand: false
      name: Detonation
      type: title
      version: -1
    taskid: 5c9f4df9-774e-425c-89bb-72f1ca067167
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2030
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 86e46e51-1acb-4b62-86eb-a13d51af2b4d
      iscommand: false
      name: File enrichment
      type: title
      version: -1
    taskid: 86e46e51-1acb-4b62-86eb-a13d51af2b4d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 90,
          "y": 2030
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7681703b-e236-4715-8f72-4dd2aefbe5bc
      iscommand: false
      name: Hunting
      type: title
      version: -1
    taskid: 7681703b-e236-4715-8f72-4dd2aefbe5bc
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 180,
          "y": 5570
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ebde0cf9-00f2-49e5-81c4-f12bf4e38f71
      iscommand: false
      name: Remediation
      type: title
      version: -1
    taskid: ebde0cf9-00f2-49e5-81c4-f12bf4e38f71
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 250,
          "y": 8435
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "No":
      - "41"
      "Yes":
      - "115"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b9051066-0ce9-49c0-8fe8-2e9d5ee486cc
      iscommand: false
      name: Manual - Get analyst approval for auto-remediation
      type: condition
      version: -1
    taskid: b9051066-0ce9-49c0-8fe8-2e9d5ee486cc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 8560
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4808e0df-f4ca-4cd2-8ad5-eccd641e843a
      iscommand: false
      name: Analyst review of the investigation
      type: regular
      version: -1
    taskid: 4808e0df-f4ca-4cd2-8ad5-eccd641e843a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 8900
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Unisolate endpoints that were isolated during the investigation
        after remediation.
      id: cf0f7ac5-9f05-4831-8d02-07ef797bf81e
      iscommand: false
      name: Manual - Unisolate endpoints
      type: regular
      version: -1
    taskid: cf0f7ac5-9f05-4831-8d02-07ef797bf81e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 9600
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    scriptarguments:
      MD5:
        complex:
          root: inputs.MD5
          transformers:
          - operator: uniq
      SHA1:
        complex:
          root: inputs.SHA1
          transformers:
          - operator: uniq
      SHA256:
        complex:
          root: inputs.SHA256
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Enrich a file with threat information using one or more integrations.
      id: 3bfb0c59-f0b3-4907-8623-9c09ae83f138
      iscommand: false
      name: File Enrichment - Generic v2
      playbookId: File Enrichment - Generic v2
      type: playbook
      version: -1
    taskid: 3bfb0c59-f0b3-4907-8623-9c09ae83f138
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 90,
          "y": 2160
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    scriptarguments:
      EntryID:
        complex:
          accessor: EntryID
          root: File
      File:
        complex:
          root: File
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Detonate file through active integrations that support file detonation.
      id: 92a58ca0-3d97-4c98-86c4-97f3eebc3473
      iscommand: false
      name: Detonate File - Generic
      playbookId: Detonate File - Generic
      type: playbook
      version: -1
    taskid: 92a58ca0-3d97-4c98-86c4-97f3eebc3473
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2950
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        A script to generate an automated investigation summary report.
        Can be used in the post-processing flow as well.
      id: b6c402ba-de55-4da9-8b99-864ec8b2ee11
      iscommand: false
      name: Generate Investigation Summary Report
      script: GenerateInvestigationSummaryReport
      tags:
      - Investigation-Report
      type: regular
      version: -1
    taskid: b6c402ba-de55-4da9-8b99-864ec8b2ee11
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 9065
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: EntryID
                root: File
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "123"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 380e910c-e876-4d6a-83be-3a3c2ef8c20d
      iscommand: false
      name: Was a file retrieved?
      type: condition
      version: -1
    taskid: 380e910c-e876-4d6a-83be-3a3c2ef8c20d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2330
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 861f0df2-62d1-4f67-856b-0ac350fe89bc
      iscommand: false
      name: Retrieve file manually
      type: regular
      version: -1
    taskid: 861f0df2-62d1-4f67-856b-0ac350fe89bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 2510
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manually hunt for other infected endpoints.
      id: 6c2be885-5090-4506-8d13-474893307f05
      iscommand: false
      name: Manual - Hunt for other infected endpoints
      type: regular
      version: -1
    taskid: 6c2be885-5090-4506-8d13-474893307f05
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6705
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "No":
      - "103"
      "Yes":
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3475a1a6-589e-4e1e-853a-6dfe381c2cf2
      iscommand: false
      name: Were there any more infected endpoints found?
      type: condition
      version: -1
    taskid: 3475a1a6-589e-4e1e-853a-6dfe381c2cf2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6855
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e3cd9c77-ba15-4875-8108-3856ff8f0b7e
      iscommand: false
      name: Analyst manual remediation
      type: regular
      version: -1
    taskid: e3cd9c77-ba15-4875-8108-3856ff8f0b7e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 8730
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 89647ec0-873a-4af4-8d22-ddc4e19572f6
      iscommand: false
      name: Perform manual malware analysis and forensics
      type: regular
      version: -1
    taskid: 89647ec0-873a-4af4-8d22-ddc4e19572f6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 190,
          "y": 5080
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f239ea28-54eb-4417-8a8b-b84b91adab13
      iscommand: false
      name: False Positive
      type: title
      version: -1
    taskid: f239ea28-54eb-4417-8a8b-b84b91adab13
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -670,
          "y": 4350
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "No":
      - "98"
      "Yes":
      - "95"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 435ee741-dabb-4a79-8859-b7184bf76ae8
      iscommand: false
      name: Get analyst approval for local containment
      type: condition
      version: -1
    taskid: 435ee741-dabb-4a79-8859-b7184bf76ae8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 190,
          "y": 4405
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: inputs.AutoIsolation
                    operator: lessThanOrEqual
                    right:
                      iscontext: true
                      value:
                        simple: incident.severity
                root: inputs.AutoIsolation
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "95"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ff4afe90-ad11-4313-87b5-a4a6dcb4bbee
      iscommand: false
      name: Auto-Isolation?
      type: condition
      version: -1
    taskid: ff4afe90-ad11-4313-87b5-a4a6dcb4bbee
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 4210
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Continue Investigation:
      - "50"
      False positive:
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e52759df-285d-4eac-89eb-5058ffcabad7
      iscommand: false
      name: Continue with the investigation or close as false positive?
      type: condition
      version: -1
    taskid: e52759df-285d-4eac-89eb-5058ffcabad7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3920
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "73"
    note: false
    quietmode: 0
    scriptarguments:
      Account:
        complex:
          root: Account
          transformers:
          - operator: uniq
      CriticalEndpoints:
        complex:
          root: inputs.CriticalEndpoints
          transformers:
          - operator: uniq
      CriticalGroups:
        complex:
          root: inputs.CriticalGroups
          transformers:
          - operator: uniq
      CriticalUsers:
        complex:
          root: inputs.CriticalUsers
          transformers:
          - operator: uniq
      DBotScore:
        complex:
          root: DBotScore
      EmailAuthenticityCheck:
        complex:
          accessor: AuthenticityCheck
          root: Email
          transformers:
          - operator: uniq
      Endpoint:
        complex:
          accessor: Hostname
          root: incident
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Calculate and assign the incident severity based on the highest returned severity level from the following calculations:

        - DBotScores of indicators
        - Critical assets
        - Email authenticity
        - Current incident severity
      id: 0bb6cb79-affd-4fbf-8196-003826c285a4
      iscommand: false
      name: Calculate Severity - Generic v2
      playbookId: Calculate Severity - Generic v2
      type: playbook
      version: -1
    taskid: 0bb6cb79-affd-4fbf-8196-003826c285a4
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3400
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          During an endpoint malware investigation in Cortex XSOAR, other infected endpoints were found, which can possibly indicate the malware is spreading in your organization and requires your attention.
          To get more information, go to this incident in Cortex XSOAR: ${incident.id}
      subject:
        simple: Potential malware spreading in your organization
      to:
        complex:
          root: inputs.Email
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 58321c3f-d5c8-44f3-81c4-2ea45ede0669
      iscommand: true
      name: Notify that more infected endpoints were found
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 58321c3f-d5c8-44f3-81c4-2ea45ede0669
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 830,
          "y": 7540
        }
      }
  "56":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Email
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "66"
      "yes":
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 204fa649-e3bc-4f8d-8e45-b33eaeb309e3
      iscommand: false
      name: Send notification regarding infected endpoints?
      type: condition
      version: -1
    taskid: 204fa649-e3bc-4f8d-8e45-b33eaeb309e3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 7370
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f7c9c9bb-77c4-463b-862e-ec58c12de9bb
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: f7c9c9bb-77c4-463b-862e-ec58c12de9bb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -670,
          "y": 10350
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: ${Closing reason.Answers.0}
      id:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 11dff5ba-830a-4ca5-82ea-3a093ca892f4
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 11dff5ba-830a-4ca5-82ea-3a093ca892f4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -220,
          "y": 10140
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Close the incident in the source product that triggered it.
      id: 9523a2b2-e03c-4da2-847c-0f6b89f80493
      iscommand: false
      name: Manual - Close incident in the source product
      type: regular
      version: -1
    taskid: 9523a2b2-e03c-4da2-847c-0f6b89f80493
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -220,
          "y": 9810
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "98"
    note: false
    quietmode: 0
    scriptarguments:
      isolated:
        simple: Endpoint was isolated successfully.
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an incident
      id: 7171d967-46b4-42dc-86cc-b10676abfb4b
      iscommand: true
      name: Set incident - Isolated field
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 7171d967-46b4-42dc-86cc-b10676abfb4b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 4760
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "124"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: de54bf2e-ea3c-4173-8868-a887f4947d6c
      iscommand: false
      name: Isolate infected endpoints
      type: title
      version: -1
    taskid: de54bf2e-ea3c-4173-8868-a887f4947d6c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 7710
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      Agent_ID:
        simple: ${Endpoint.ID}
      Hostname:
        simple: ${Endpoint.Hostname}
      MD5:
        simple: ${inputs.MD5}
      Path:
        simple: ${inputs.FilePath}
      SHA256:
        simple: ${inputs.SHA256}
      UseD2:
        simple: ${inputs.UseD2}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        'This playbook retrieves a file sample from an endpoint using the following playbooks:'
        - Get File Sample From Path - Generic v2.
        - Get File Sample By Hash - Generic v3.
      id: 6509d4c0-ebb5-4b2c-8385-89cc6b7b9c5b
      iscommand: false
      name: Retrieve File from Endpoint - Generic V2
      playbookId: Retrieve File from Endpoint - Generic V2
      type: playbook
      version: -1
    taskid: 6509d4c0-ebb5-4b2c-8385-89cc6b7b9c5b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2160
        }
      }
  "68":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ActivateAutomaticHunting
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "69"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d0bf5181-315c-4211-8618-351e035aeb5d
      iscommand: false
      name: Activate automatic hunting
      type: condition
      version: -1
    taskid: d0bf5181-315c-4211-8618-351e035aeb5d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 180,
          "y": 5720
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "101"
    note: false
    quietmode: 0
    scriptarguments:
      Hostname:
        simple: ${Endpoint.Hostname}
      InternalDomainName:
        simple: ${inputs.InternalDomainName}
      InternalHostRegex:
        simple: ${inputs.InternalHostRegex}
      InternalRange:
        simple: ${inputs.InternalRange}
      MD5:
        simple: ${inputs.MD5}
      SHA1:
        simple: ${inputs.SHA1}
      SHA256:
        simple: ${inputs.SHA256}
      URLDomain:
        simple: ${inputs.URLDomain}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook enables threat hunting for IOCs in your enterprise.\nThis
        playbook currently supports the following integrations:\n- Splunk\n- Qradar\n-
        Pan-os\n- Cortex data lake \n- Autofocus"
      id: c358f256-5672-4a79-84b7-d397cb65043c
      iscommand: false
      name: Threat Hunting - Generic
      playbookId: Threat Hunting - Generic
      type: playbook
      version: -1
    taskid: c358f256-5672-4a79-84b7-d397cb65043c
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 5900
        }
      }
  "70":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ManualThreatHunting
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ca2c99b2-9210-4f50-89c0-98da6e08c860
      iscommand: false
      name: Continue to manual threat hunting?
      type: condition
      version: -1
    taskid: ca2c99b2-9210-4f50-89c0-98da6e08c860
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6535
        }
      }
  "71":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.NeedMoreForensics
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 29a141e3-aada-4b78-8123-7fb711926113
      iscommand: false
      name: Need more forensics?
      type: condition
      version: -1
    taskid: 29a141e3-aada-4b78-8123-7fb711926113
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 190,
          "y": 5220
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "97"
    note: false
    quietmode: 0
    scriptarguments:
      onCall:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Assign analyst to incident.
        By default, the analyst is picked randomly from the available users, according to the provided roles. (If no roles are provided, will fetch all users).
        Otherwise, the analyst will be picked according to the 'assignBy' arguments.
        machine-learning: DBot will calculate and decide who is the best analyst for the job.
        top-user: The user who most commonly owns this type of incident.
        less-busy-user: The less busy analyst will be picked to be the incident owner.
        online: The analyst is picked randomly from all online analysts, according to the provided roles. (If no roles provided, will fetch all users).
        current: The user who executed the command.
      id: 70e55a0f-92e2-48e1-8fbe-fb466272c1f0
      iscommand: false
      name: Assign incident to analyst
      script: AssignAnalystToIncident
      type: regular
      version: -1
    taskid: 70e55a0f-92e2-48e1-8fbe-fb466272c1f0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3595
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "120"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 10536893-29e4-46a2-8288-40896fa6d29c
      iscommand: false
      name: Add the file that caused the FP in the source product to allow list
      type: regular
      version: -1
    taskid: 10536893-29e4-46a2-8288-40896fa6d29c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 4855
        }
      }
  "76":
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook retrieves forensics from hosts.\nThe available integration
        is Illusive networks. "
      id: ae1c541d-3a8d-453e-8231-1fc27f22b38f
      iscommand: false
      name: Get host forensics - Generic
      playbookId: Get host forensics - Generic
      type: playbook
      version: -1
    taskid: ae1c541d-3a8d-453e-8231-1fc27f22b38f
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 5395
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6192da27-7e6c-415f-8358-fa20f02d9bbf
      iscommand: false
      name: Manually list detected hostnames
      type: regular
      version: -1
    taskid: 6192da27-7e6c-415f-8358-fa20f02d9bbf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7055
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: Threat.Hunting.Detected.Hostsname
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      id: cc9cf9eb-053e-4dbc-875d-76c1a8c2c6d7
      iscommand: false
      name: Set manual host names
      script: commentsToContext
      type: regular
      version: -1
    taskid: cc9cf9eb-053e-4dbc-875d-76c1a8c2c6d7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7200
        }
      }
  "79":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.AutoUnIsolation
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0f9563ee-e7d3-4325-8932-1d5ebbdd831d
      iscommand: false
      name: Activated auto unisolation
      type: condition
      version: -1
    taskid: 0f9563ee-e7d3-4325-8932-1d5ebbdd831d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 9410
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_ID:
        simple: ${Endpoint.ID}
      Hostname:
        complex:
          accessor: Hostname
          root: Endpoint
          transformers:
          - args:
              item:
                value:
                  simple: Threat.Hunting.Detected.Hostsname
            operator: append
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook unisolates endpoints according to the endpoint ID
        or hostname that is provided in the playbook.\nCurrently supports the following
        integrations:\n- Carbon Black Response\n- Cortex XDR\n- Crowdstrike Falcon\n-
        FireEye HX \n- Cybereason\n"
      id: 8716454c-bddd-4204-812f-133d35e88ca8
      iscommand: false
      name: Unisolate Endpoint - Generic
      playbookId: Unisolate Endpoint - Generic
      type: playbook
      version: -1
    taskid: 8716454c-bddd-4204-812f-133d35e88ca8
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 9600
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "110"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        simple: ${inputs.Hostname}
      Endpoint_id:
        simple: ${inputs.Agent_ID}
      Endpoint_ip:
        simple: ${inputs.Endpoint_ip}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook uses the generic command !endpoint to retrieve details
        on specific endpoint.\nThis command currently supports the following integrations:\n-
        Palo Alto Networks Cortex XDR - Investigation and Response.\n- CrowdStrike
        Falcon. "
      id: 8ad767c0-ee95-4fed-8ff2-4f01914540a3
      iscommand: false
      name: Get endpoint details - Generic
      playbookId: Get endpoint details - Generic
      type: playbook
      version: -1
    taskid: 8ad767c0-ee95-4fed-8ff2-4f01914540a3
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1400
        }
      }
  "94":
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        simple: ${Threat.Hunting.Detected.Hostsname}
      Endpoint_id:
        simple: ${Endpoint.ID}
      Endpoint_ip:
        simple: ${Threat.Hunting.Detected.IP}
      ManualHunting.DetectedHosts:
        simple: ${ManualHunting.DetectedHosts}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This playbook isolates a given endpoint via various endpoint product integrations.
        Make sure to provide the valid playbook input for the integration that you are using.
      id: 8ba2fa11-3ae6-4adc-88bc-f1d227b9e2ad
      iscommand: false
      name: Isolate Endpoint - Generic V2
      playbookId: Isolate Endpoint - Generic V2
      type: playbook
      version: -1
    taskid: 8ba2fa11-3ae6-4adc-88bc-f1d227b9e2ad
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 8250
        }
      }
  "95":
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        simple: ${Endpoint.Hostname}
      Endpoint_id:
        simple: ${Endpoint.ID}
      Endpoint_ip:
        simple: ${Endpoint.IPAddress}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This playbook isolates a given endpoint via various endpoint product integrations.
        Make sure to provide the valid playbook input for the integration that you are using.
      id: 5ab2d2a1-e289-4188-8d2d-ded71919a2f4
      iscommand: false
      name: Isolate Endpoint - Generic V2
      playbookId: Isolate Endpoint - Generic V2
      type: playbook
      version: -1
    taskid: 5ab2d2a1-e289-4188-8d2d-ded71919a2f4
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 4580
        }
      }
  "97":
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9be30a51-a06d-481e-8f3b-327851beca26
      iscommand: false
      name: Isolation
      type: title
      version: -1
    taskid: 9be30a51-a06d-481e-8f3b-327851beca26
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3770
        }
      }
  "98":
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8a3a35e0-dde9-43b0-89e2-5af424500d9a
      iscommand: false
      name: Forensics
      type: title
      version: -1
    taskid: 8a3a35e0-dde9-43b0-89e2-5af424500d9a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 190,
          "y": 4960
        }
      }
  "99":
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 535acaa4-2b2a-48f0-8e89-d1fd63a02263
      iscommand: false
      name: Unisolation
      type: title
      version: -1
    taskid: 535acaa4-2b2a-48f0-8e89-d1fd63a02263
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 250,
          "y": 9250
        }
      }
  "100":
    continueonerrortype: ""
    id: "100"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Account.Username
      value:
        complex:
          accessor: user
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 65decd3c-4260-49ab-86a1-0406fbc5fcd1
      iscommand: false
      name: Set user as account
      script: Set
      type: regular
      version: -1
    taskid: 65decd3c-4260-49ab-86a1-0406fbc5fcd1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3205
        }
      }
  "101":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Hostnames
      output:
        simple: ${Threat.Hunting.Detected.Hostsname}
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "102"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.Hostsname
      value:
        complex:
          accessor: DetectedInternalHosts
          root: QRadar
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: PANWHunting.DetectedInternalHosts
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: Splunk.DetectedInternalHosts
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 0d07b5df-5175-43c2-89ae-9f19e8450e6c
      iscommand: false
      name: Set detected hostnames to context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 0d07b5df-5175-43c2-89ae-9f19e8450e6c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6055
        }
      }
  "102":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Detected IPs
      output:
        simple: ${Threat.Hunting.Detected.IP}
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "122"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.IP
      value:
        complex:
          accessor: DetectedInternalIPs
          root: Splunk
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: PANWHunting.DetectedInternalIPs
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: QRadar.DetectedInternalIPs
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 3bda0c54-e79a-4d29-878e-4b9a89c20a09
      iscommand: false
      name: Set detected IP's to context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 3bda0c54-e79a-4d29-878e-4b9a89c20a09
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6210
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 53452506-0ce6-48dd-8e5b-020a36026daf
      iscommand: false
      name: No results for manual TH
      type: title
      version: -1
    taskid: 53452506-0ce6-48dd-8e5b-020a36026daf
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -160,
          "y": 7710
        }
      }
  "104":
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        simple: ${Threat.Hunting.Detected.Hostsname}
      Endpoint_id:
        simple: ${EndpointDetails.ID}
      Endpoint_ip:
        simple: ${Threat.Hunting.Detected.IP}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook uses the generic command !endpoint to retrieve details
        on specific endpoint.\nThis command currently supports the following integrations:\n-
        Palo Alto Networks Cortex XDR - Investigation and Response.\n- CrowdStrike
        Falcon. "
      id: b5072ffe-f04d-47ad-8616-a59abe212ad3
      iscommand: false
      name: Get endpoint details - Generic
      playbookId: Get endpoint details - Generic
      type: playbook
      version: -1
    taskid: b5072ffe-f04d-47ad-8616-a59abe212ad3
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 8085
        }
      }
  "107":
    continueonerrortype: ""
    id: "107"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: Endpoint Hostname,Endpoint ID,Endpoint IP Address,Endpoint Is Isolated,Endpoint
          MAC Address,Endpoint OS,Endpoint Vendor
      context_path:
        simple: Endpoint
      grid_id:
        simple: endpoint
      keys:
        simple: Hostname,ID,IPAddress,IsIsolated,MACAddress,OS,Vendor
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a grid table from items or key-value pairs.
      id: 9a021821-5028-4e3f-84c6-2ecb1bd3c05b
      iscommand: false
      name: Set endpoint details to layout
      script: SetGridField
      type: regular
      version: -1
    taskid: 9a021821-5028-4e3f-84c6-2ecb1bd3c05b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1680
        }
      }
  "110":
    continueonerrortype: ""
    id: "110"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "107"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 18f1a0f9-895d-4798-8597-84db75fdafbc
      iscommand: false
      name: Set to layout
      type: title
      version: -1
    taskid: 18f1a0f9-895d-4798-8597-84db75fdafbc
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1535
        }
      }
  "111":
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "116"
    note: false
    quietmode: 0
    scriptarguments:
      fieldExactMatch:
        simple: incident.type
      similarTextField:
        simple: incident.parentcmdline,incident.filepaths,incident.cmd
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Find past similar incidents based on incident fields' similarity.
        Includes an option to also display indicators' similarity.
      id: a0e1eeb2-5a98-4d7c-81a3-23669a6018b4
      iscommand: false
      name: Find similar incidents
      script: DBotFindSimilarIncidents
      type: regular
      version: -1
    taskid: a0e1eeb2-5a98-4d7c-81a3-23669a6018b4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 340
        }
      }
  "112":
    continueonerrortype: ""
    id: "112"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "118"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: Incident Id,Created,Name,Similarity Incident,Parent CMD line,File
          path,Command line
      context_path:
        simple: DBotFindSimilarIncidents.similarIncident(val.id='#/Details/'+val.id,val.parentcmdline=val.parentcmdline.join(','),val.filepaths=val.filepaths.join(','),val.cmd=val.cmd.join(','))
      grid_id:
        simple: similarincidentsdbot
      keys:
        simple: id,created,name,similarity incident,parentcmdline,filepaths,cmd
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a grid table from items or key-value pairs.
      id: 9073a5f3-b2e2-4f48-8ebc-aa5c814d2975
      iscommand: false
      name: Set similar incidents to layout
      script: SetGridField
      type: regular
      version: -1
    taskid: 9073a5f3-b2e2-4f48-8ebc-aa5c814d2975
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 690
        }
      }
  "113":
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "111"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0dbcd3b4-a455-4c7a-83db-87839884d41f
      iscommand: false
      name: Find similar incidents
      type: title
      version: -1
    taskid: 0dbcd3b4-a455-4c7a-83db-87839884d41f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 195
        }
      }
  "114":
    continueonerrortype: ""
    id: "114"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 40f496d0-91b2-40f9-89aa-6f9cc02ae19c
      iscommand: false
      name: Get endpoint details
      type: title
      version: -1
    taskid: 40f496d0-91b2-40f9-89aa-6f9cc02ae19c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1275
        }
      }
  "115":
    continueonerrortype: ""
    id: "115"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        simple: "No"
      CustomBlockRule:
        simple: "True"
      CustomURLCategory:
        simple: Demisto Remediation - Malicious URLs
      IP:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: ip
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      MD5:
        complex:
          accessor: MD5
          root: File
      SHA256:
        complex:
          accessor: SHA256
          root: File
      URL:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: url
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      URLListName:
        simple: Demisto Remediation - URL EDL
      Username:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: username
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |+
        This playbook blocks malicious indicators using all integrations that are enabled, using the following sub-playbooks:

        - Block URL - Generic
        - Block Account - Generic
        - Block IP - Generic v2
        - Block File - Generic v2

      id: 5912c5af-8a92-4618-83ad-86147b9e6b12
      iscommand: false
      name: Block Indicators - Generic v2
      playbookId: Block Indicators - Generic v2
      type: playbook
      version: -1
    taskid: 5912c5af-8a92-4618-83ad-86147b9e6b12
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -20,
          "y": 8730
        }
      }
  "116":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: DBotFindSimilarIncidents.similarIncident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "116"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "114"
      "yes":
      - "112"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 714d3925-2556-4dde-8d83-732ae3a9a875
      iscommand: false
      name: Are there similar incidents?
      type: condition
      version: -1
    taskid: 714d3925-2556-4dde-8d83-732ae3a9a875
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 515
        }
      }
  "117":
    continueonerrortype: ""
    id: "117"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "114"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        complex:
          accessor: id
          root: incident
      linkedIncidentIDs:
        simple: ${DBotFindSimilarIncidents.similarIncident.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.linkIncidents
      id: 5bdc2d46-0ff5-455d-870d-04ab36007eb8
      iscommand: true
      name: Link similar incidents
      script: Builtin|||linkIncidents
      type: regular
      version: -1
    taskid: 5bdc2d46-0ff5-455d-870d-04ab36007eb8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 1070
        }
      }
  "118":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.LinkSimilarIncidents
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "118"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "114"
      "yes":
      - "117"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e50fea62-869b-4357-8950-149a803da137
      iscommand: false
      name: Link the similar events?
      type: condition
      version: -1
    taskid: e50fea62-869b-4357-8950-149a803da137
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 960,
          "y": 855
        }
      }
  "119":
    continueonerrortype: ""
    id: "119"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 97667ee3-c3db-4074-8971-403125c799ea
      iscommand: true
      name: Close investigation as false positive
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 97667ee3-c3db-4074-8971-403125c799ea
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 10140
        }
      }
  "120":
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "119"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Close the incident in the source product that triggered it.
      id: 9261f70e-073e-47a1-8224-2a43a038e22f
      iscommand: false
      name: Manual - Close incident in the source product
      type: regular
      version: -1
    taskid: 9261f70e-073e-47a1-8224-2a43a038e22f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 5090
        }
      }
  "121":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Specify the closing reason
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: shortText
      sender: ""
      title: Closing reason
      totalanswers: 0
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: {}
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 01d1d231-8dca-442a-8baf-fd71a7cc0888
      iscommand: false
      name: Closing reason
      type: collection
      version: -1
    taskid: 01d1d231-8dca-442a-8baf-fd71a7cc0888
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -220,
          "y": 9970
        }
      }
  "122":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Detected User
      output:
        simple: ${Threat.Hunting.Detected.Users}
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.Users
      value:
        complex:
          accessor: DetectedUsers
          root: Splunk
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: PANWHunting.DetectedUsers
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: QRadar.DetectedUsers
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 836cd786-3f10-49d4-8056-e86e78ccfa6b
      iscommand: false
      name: Set detected users to to context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 836cd786-3f10-49d4-8056-e86e78ccfa6b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6370
        }
      }
  "123":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.DetonateFile
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "123"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "100"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 19941479-7dfa-4317-8fb3-dea1cae06510
      iscommand: false
      name: Activate auto detonation?
      type: condition
      version: -1
    taskid: 19941479-7dfa-4317-8fb3-dea1cae06510
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2685
        }
      }
  "124":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.IsolationAfterHunting
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "124"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "104"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dc40f2f4-4c1b-4f57-8295-32560c3ec1ce
      iscommand: false
      name: Activate auto isolation after threat hunting?
      type: condition
      version: -1
    taskid: dc40f2f4-4c1b-4f57-8295-32560c3ec1ce
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 7840
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "116_112_yes": 0.53,
      "116_114_#default#": 0.32,
      "118_114_#default#": 0.83,
      "118_117_yes": 0.68,
      "123_100_#default#": 0.64,
      "123_28_yes": 0.56,
      "124_104_yes": 0.63,
      "19_115_Yes": 0.53,
      "19_41_No": 0.58,
      "36_123_yes": 0.53,
      "36_37_#default#": 0.64,
      "39_77_Yes": 0.49,
      "46_98_No": 0.51,
      "50_46_#default#": 0.66,
      "50_95_yes": 0.49,
      "51_45_False positive": 0.67,
      "51_50_Continue Investigation ": 0.58,
      "56_55_yes": 0.6,
      "56_66_#default#": 0.51,
      "71_12_#default#": 0.51,
      "79_21_#default#": 0.64
    },
    "paper": {
      "dimensions": {
        "height": 10365,
        "width": 2210,
        "x": -670,
        "y": 50
      }
    }
  }
