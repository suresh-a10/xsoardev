contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 8cf5ee73-8921-4d93-8299-88bcf772799b
inputs: []
name: TCS-Unblock IOC-Email Trigger v2.4_sweta_copy
outputs: []
sourceplaybookid: 0a608f75-4154-430b-81e0-3a7bc08ad2e0
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 035bd328-f488-4390-88c1-a7d4e247df4c
      iscommand: false
      name: ""
      version: -1
    taskid: 035bd328-f488-4390-88c1-a7d4e247df4c
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 480,
          "y": -700
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 603f1f5b-e5c1-4ee5-8eac-45c8b68445ea
      iscommand: false
      name: Report & Notify
      type: title
      version: -1
    taskid: 603f1f5b-e5c1-4ee5-8eac-45c8b68445ea
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 500,
          "y": 2010
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello Human,

          I've unblocked/removed the IOCs in this list  - ${incident.attachment.name}

          XSOAR Investigation id - ${incident.id}


          Regards,
          Cyber AutoBot
      subject:
        simple: IOC Blacklisting/Blocking Completed For List - ${incident.attachment.name}
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: e4733cc9-f818-4de5-8b96-00a2f8ddc72f
      iscommand: true
      name: Notify IOC Unblocking Done
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: e4733cc9-f818-4de5-8b96-00a2f8ddc72f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 2240
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bfe703fc-9c8b-4489-8b50-e2f584396fed
      iscommand: false
      name: Close Incident
      type: title
      version: -1
    taskid: bfe703fc-9c8b-4489-8b50-e2f584396fed
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 630,
          "y": 2680
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_134
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: Domain_Test_}
          root: ${ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes URLs from the specified category.
      id: 701f0b56-7369-40c5-856b-a6196e6b6150
      iscommand: true
      name: Unblock Domain on ZScalar Proxy
      script: Zscaler|||zscaler-category-remove-url
      type: regular
      version: -1
    taskid: 701f0b56-7369-40c5-856b-a6196e6b6150
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 680,
          "y": 630
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: f5cca822-557b-413a-8718-c718c8f59234
      iscommand: true
      name: Close Incident
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: f5cca822-557b-413a-8718-c718c8f59234
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 2860
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dc4ea954-9de3-4e6a-80e0-d15f0cec57c4
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: dc4ea954-9de3-4e6a-80e0-d15f0cec57c4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 630,
          "y": 3080
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID}
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ${File.Info}
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: ${File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: f27db392-1b84-48de-8ac6-36fcd69fc879
      iscommand: true
      name: Extract Indicators From Text File
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: f27db392-1b84-48de-8ac6-36fcd69fc879
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": -220
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: 69307c7f-42fd-40b7-88cc-67cd2f073ebb
      iscommand: true
      name: Expire Domain Indicator
      script: Builtin|||expireIndicators
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 69307c7f-42fd-40b7-88cc-67cd2f073ebb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1670
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        simple: ${ExtractedIndicators.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: ffa6add9-a865-4bf4-807b-557beb5703d2
      iscommand: true
      name: Expire IP Indicator
      script: Builtin|||expireIndicators
      tags:
      - CERTDomainBlock
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: ffa6add9-a865-4bf4-807b-557beb5703d2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1670
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello Human,

          Unblocking was unsucessful for the IOCs in this list  - ${incident.attachment.name}

          XSOAR Investigation id - ${incident.id}


          Regards,
          Cyber AutoBot
      subject:
        simple: Unblocking was unsuccessful for the IOCs in this list  - ${incident.attachment.name}
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: ed052dcd-d03c-4991-8cc1-7026351fec4e
      iscommand: true
      name: Notify Stake holder for unsuccessful Unblocking
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: ed052dcd-d03c-4991-8cc1-7026351fec4e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -520,
          "y": 1650
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "31"
      "yes":
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      id: 66ec800a-fa31-49f5-8f16-02d2589d6999
      iscommand: false
      name: Did Unblocking Task Encounter Error ?
      script: isError
      type: condition
      version: -1
    taskid: 66ec800a-fa31-49f5-8f16-02d2589d6999
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 260,
          "y": 840
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "27"
      "yes":
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      id: ed0debd0-ad25-43c8-8032-a070bed9b355
      iscommand: false
      name: Did Unblocking Task Encounter Error ?
      script: isError
      type: condition
      version: -1
    taskid: ed0debd0-ad25-43c8-8032-a070bed9b355
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 670,
          "y": 840
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3332926d-dc49-4853-804f-d5c67837743a
      iscommand: false
      name: ' Task Get error message'
      script: dfaf73eb-0458-4817-86b5-7588ccf04c64
      type: regular
      version: -1
    taskid: 3332926d-dc49-4853-804f-d5c67837743a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 130,
          "y": 1160
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c7c79e7a-4694-45a7-83dd-b50ddb5649b8
      iscommand: false
      name: ' Task Get error message'
      script: dfaf73eb-0458-4817-86b5-7588ccf04c64
      type: regular
      version: -1
    taskid: c7c79e7a-4694-45a7-83dd-b50ddb5649b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": 1170
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
      - "46"
      - "44"
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 90cdccf6-5d2d-456d-88b9-d5ad55bb7be9
      iscommand: false
      name: Both IP and Domain are Present
      type: title
      version: -1
    taskid: 90cdccf6-5d2d-456d-88b9-d5ad55bb7be9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 250
        }
      }
  "43":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_}
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.IP}
          operator: isExists
      label: Both
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.IP}
          operator: isExists
      label: IP
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_}
          operator: isExists
      label: Domain
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Both:
      - "42"
      Domain:
      - "7"
      - "44"
      IP:
      - "45"
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b0989c3f-c754-4c3c-839d-21f6286ca0c9
      iscommand: false
      name: what is there in aattachment?
      type: condition
      version: -1
    taskid: b0989c3f-c754-4c3c-839d-21f6286ca0c9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": -60
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: Domain_Test_}
          root: ${ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes the specified URLs from the blacklist.
      id: 8036eaee-69ea-41bc-875f-f8cc6eacf359
      iscommand: true
      name: Unblock Domain on ZScalar BPS Proxy
      script: Zscaler|||zscaler-undo-blacklist-url
      type: regular
      version: -1
    taskid: 8036eaee-69ea-41bc-875f-f8cc6eacf359
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": 630
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      ip:
        simple: ${ExtractedIndicators.IP}
      retry-count:
        simple: "3"
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes the specified IP addresses from the blacklist.
      id: 3aa7c1c7-fdde-49ef-8216-b6aaa8416f1a
      iscommand: true
      name: Unblock IP on ZScalar BPS Proxy
      script: Zscaler|||zscaler-undo-blacklist-ip
      type: regular
      version: -1
    taskid: 3aa7c1c7-fdde-49ef-8216-b6aaa8416f1a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -150,
          "y": 630
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      ip:
        complex:
          accessor: IP}
          root: ${ExtractedIndicators
      retry-count:
        simple: "3"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes the specified IP addresses from the blacklist.
      id: 64e36ed5-4cba-4551-8e4b-0f19c55f3890
      iscommand: true
      name: Unblock IP on ZScalar Proxy
      script: Zscaler|||zscaler-undo-blacklist-ip
      type: regular
      version: -1
    taskid: 64e36ed5-4cba-4551-8e4b-0f19c55f3890
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 280,
          "y": 630
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3845,
        "width": 1990,
        "x": -520,
        "y": -700
      }
    }
  }
