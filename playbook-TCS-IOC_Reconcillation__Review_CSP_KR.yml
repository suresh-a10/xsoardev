contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 8895dab5-adc3-45c3-84e9-4e304d591f6c
inputs: []
name: TCS-IOC Reconcillation _Review_CSP_KR
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a9854d3d-1afb-4ac3-8044-f674e733dbb6
      iscommand: false
      name: ""
      version: -1
    taskid: a9854d3d-1afb-4ac3-8044-f674e733dbb6
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 90,
          "y": -3200
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        complex:
          accessor: id
          root: incident
      linkedIncidentIDs:
        complex:
          accessor: ticketnumber
          root: incident
          transformers:
          - args:
              from:
                value:
                  simple: '-'
            operator: substringFrom
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.linkIncidents
      id: 8ca2cfc0-d681-4908-8cb7-5977f29f5740
      iscommand: true
      name: Link To Parent Incident
      script: Builtin|||linkIncidents
      type: regular
      version: -1
    taskid: 8ca2cfc0-d681-4908-8cb7-5977f29f5740
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 90,
          "y": -2880
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get the Server URL.
      id: cb621f58-0efe-4bc3-82b6-233484f18a76
      iscommand: false
      name: Get Server URL
      script: GetServerURL
      type: regular
      version: -1
    taskid: cb621f58-0efe-4bc3-82b6-233484f18a76
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 90,
          "y": -2700
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: incidentlink
      value:
        simple: https://${ServerURL.Host}/#/Custom/caseinfoid/${incident.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f0780eca-c24e-4667-88d4-d0e82bca1f66
      iscommand: false
      name: Set Server link In Context
      script: Set
      type: regular
      version: -1
    taskid: f0780eca-c24e-4667-88d4-d0e82bca1f66
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 90,
          "y": -2530
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      incidentlink:
        simple: ${incidentlink}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f212688b-7b8a-4d3e-8746-7ea177d6137c
      iscommand: true
      name: Set Incident Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f212688b-7b8a-4d3e-8746-7ea177d6137c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 90,
          "y": -2350
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      Reconcillation IOC CSP:
        complex:
          accessor: cspioc
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 38d59ccf-6485-4fd5-875e-3728a74d7195
      iscommand: false
      name: Revalidate the IOC(S)_CSP_KR
      playbookId: c4f23417-f744-4746-88a9-8998a6d4fec4
      type: playbook
      version: -1
    taskid: 38d59ccf-6485-4fd5-875e-3728a74d7195
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 90,
          "y": -3060
        }
      }
  "11":
    continueonerrortype: ""
    form:
      description: These IOC's were expired.Please select the IOC's from below list
        which you would like to Keep it in Blacklist.
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Select The IoC(s) You'd Like to keep it in Blacklist
        options: []
        optionsarg:
        - complex:
            accessor: IP
            root: CSPFInal
        - complex:
            accessor: Domain
            root: CSPFInal
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: Your SOC team
      title: Please select the IOC for Reconcillation
      totalanswers: 0
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: '#a62572'
      headerfontcolor: ""
      isexternalrtl: false
      sender: ""
      submitbuttonbackgroundcolor: '#2a4aa8'
      submitbuttonfontcolor: ""
      submittext: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: "<p>Hi team,</p>\n<p>&nbsp;This is regarding reconciliation of Blocked
          CSP IOCs.Please Click the below link to select the IOC's from list which
          you would like to unblock.</p>\n<br>\n<br>\n<br>\n<br>\n<p>Thanks & Regards,</p>\n<p>
          CSOC Cyber AutoBot.</p>\n\n\n  "
      cc: null
      format: html
      methods:
      - email
      replyOptions:
      - 'Yes - Unblock All '
      - No - Unblock Some of them(let me choose)
      - None of The IoC(s) Are Approved For Reconciliation
      subject:
        simple: CSP IOC Reconcillation
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: keerthana.ramesh@tcs.com
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      using:
        simple: Mail Sender (New)_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 29ca5c5c-f5b5-4973-8c8d-34e5d181ca4f
      iscommand: false
      name: Task for CSP team--Select the IOC you want to Block Further
      tags:
      - cspreviewd
      type: collection
      version: -1
    taskid: 29ca5c5c-f5b5-4973-8c8d-34e5d181ca4f
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 90,
          "y": -2180
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      cspiocreviewed:
        simple: ${Please select the IOC's for Reconcillation.Answers.0}
      reconcillationrequestreviwer:
        simple: ${Please select the IOC's for Reconcillation.Answers.name}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 10408e3a-c89b-4862-84d4-f77fad691afe
      iscommand: true
      name: Update the response in SOAR
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 10408e3a-c89b-4862-84d4-f77fad691afe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 90,
          "y": -2010
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      IOC:
        simple: ${Please select the IOC for Reconcillation.Answers.0}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 29997766-6504-4b12-87b6-5d8066a925bf
      iscommand: false
      name: Process IOC's selected By CSP Team_KR
      playbookName: Process IOC's selected By CSP Team_KR
      type: playbook
      version: -1
    taskid: 29997766-6504-4b12-87b6-5d8066a925bf
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -630,
          "y": -1965
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        simple: ${Reviewed.Domain}
      IP:
        simple: ${Reviewed.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4cedb5cf-4836-47b2-81df-c848d1223190
      iscommand: false
      name: TCS-Blacklist CyberSOC_Shared IOC Above RiskScore 65 v3.0_KK
      playbookId: 232d5d44-d909-4dfd-879c-d8b9d153dc0a
      type: playbook
      version: -1
    taskid: 4cedb5cf-4836-47b2-81df-c848d1223190
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1060,
          "y": -1670
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      Unselected:
        complex:
          root: Unselected IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 39b5a3d5-16a9-4d56-8192-cff8df4d2eff
      iscommand: false
      name: UnBlock Unselected IOc's
      playbookId: cf2e6399-ef16-4cac-8f81-c5e49b246762
      type: playbook
      version: -1
    taskid: 39b5a3d5-16a9-4d56-8192-cff8df4d2eff
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1030,
          "y": -1290
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: b76aa13c-1a0c-4159-86a2-8300d8219c2d
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: b76aa13c-1a0c-4159-86a2-8300d8219c2d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 90,
          "y": -1505
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 982f30ec-0bab-4265-86ae-2c57a2491304
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: 982f30ec-0bab-4265-86ae-2c57a2491304
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 90,
          "y": -1340
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fdbfdf34-fc57-40ad-846a-2834471b0fab
      iscommand: false
      name: TCS-Compare Lists For Unblocking_CSP_KR
      playbookName: TCS-Compare Lists For Unblocking_CSP_KR
      type: playbook
      version: -1
    taskid: fdbfdf34-fc57-40ad-846a-2834471b0fab
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1040,
          "y": -2000
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1178d7fe-0e4c-4ec0-8834-1effb50938da
      iscommand: false
      name: TCS-Preprocessing Playbook For Reconciliation Review Request v1.0_KR
      playbookId: 45310316-33ad-43c8-8d62-e52d24af459e
      type: playbook
      version: -1
    taskid: 1178d7fe-0e4c-4ec0-8834-1effb50938da
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1315,
          "y": 1470
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      emailbodyhtml:
        simple: ${HTMLBody}
      iocvalue:
        complex:
          root: Below65
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: \n
            operator: split
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      name:
        simple: IOC Reconciliation Review
      parentincidentlink:
        simple: ${incidentlink}
      reviewdomain:
        complex:
          accessor: Domain
          root: BELOWSIXFIVE
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      reviewhash:
        complex:
          accessor: File
          root: BELOWSIXFIVE
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      reviewip:
        complex:
          accessor: IP
          root: BELOWSIXFIVE
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      reviewipaddress:
        complex:
          accessor: IP
          root: BELOWSIXFIVE
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      reviewurl:
        complex:
          accessor: URL
          root: BELOWSIXFIVE
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      ticketnumber:
        simple: HT-${incident.id}
      type:
        simple: IOC Reconcillation Review
      whyareyoublacklistingtheseiocs:
        simple: ${incident.whyareyoublacklistingtheseiocs}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.create.inc
      id: f1dcbc49-489b-4ab9-8de6-8363571a749e
      iscommand: true
      name: Create a New Ticket To Track IoC Blocking
      script: Builtin|||createNewIncident
      type: regular
      version: -1
    taskid: f1dcbc49-489b-4ab9-8de6-8363571a749e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1315,
          "y": 1630
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${Reviewed.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 19462426-cfa3-476b-8a7b-619b06f6b329
      iscommand: false
      name: TCS-Unblock IP_KR
      playbookName: TCS-Unblock IP_KR
      type: playbook
      version: -1
    taskid: 19462426-cfa3-476b-8a7b-619b06f6b329
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -760,
          "y": -1610
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      Unselected:
        simple: ${Unselected IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c86956f7-5e32-49c4-8934-304456417b06
      iscommand: false
      name: Unblock Unselected IOC-KR
      playbookName: Unblock Unselected IOC-KR
      type: playbook
      version: -1
    taskid: c86956f7-5e32-49c4-8934-304456417b06
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1030,
          "y": -1870
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        simple: ${Reviewed.Domain}
      Ip:
        simple: ${Reviewed.IP}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: a449f462-bfa9-44f2-8142-0d5d3a5c99b0
      iscommand: false
      name: Unblock All IOC's-KR
      playbookId: cf2e6399-ef16-4cac-8f81-c5e49b246762
      type: playbook
      version: -1
    taskid: a449f462-bfa9-44f2-8142-0d5d3a5c99b0
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 90,
          "y": -1670
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 81d75a1b-3847-4f80-8ee6-b98fa9d83113
      iscommand: false
      name: TCS-Process IoC(s) Selected By L3 CSOC For Blacklisting v1.0_KK
      playbookId: 60e55054-b756-4030-8bf0-1ecf75bf09e7
      type: playbook
      version: -1
    taskid: 81d75a1b-3847-4f80-8ee6-b98fa9d83113
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 90,
          "y": -1840
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4925,
        "width": 2755,
        "x": -1060,
        "y": -3200
      }
    }
  }
