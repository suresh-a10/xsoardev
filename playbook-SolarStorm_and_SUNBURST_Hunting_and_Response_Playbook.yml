contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.5.0
    itemVersion: 1.6.38
    packID: MajorBreachesInvestigationandResponse
    packName: Rapid Breach Response
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: "This playbook does the following:\n- Collect indicators to aid in your
  threat hunting process.\n   - Retrieve IOCs of SUNBURST (a trojanized version of
  the SolarWinds Orion plugin).\n   - Retrieve C2 domains and URLs associated with
  Sunburst. \n   - Discover IOCs of associated activity related to the infection.\n
  \  - Generate an indicator list to block indicators with SUNBURST tags.\n- Hunt
  for the SUNBURST backdoor\n   - Query firewall logs to detect network activity.
  \n   - Search endpoint logs for Sunburst hashes to detect presence on hosts.\nIf
  compromised hosts are found:\n- Notify security team to review and trigger remediation
  response actions. \n- Run sub-playbooks to isolate/quarantine infected hosts/endpoints
  and await further actions from the security team.\n\nSources:\nhttps://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html\nhttps://unit42.paloaltonetworks.com/fireeye-solarstorm-sunburst/3/\nhttps://www.splunk.com/en_us/blog/security/sunburst-backdoor-detections-in-splunk.html"
id: SolarStorm and SUNBURST Hunting and Response Playbook
inputs:
- description: Whether to automatically isolate endpoints, or opt for manual user
    approval. True means isolation will be done automatically.
  key: IsolateEndpointAutomatically
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Whether to automatically indicators involved with SolarStorm.
  key: BlockIndicatorsAutomatically
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: CVEs related to SUNBURST and SolarStorm.
  key: CVEs
  playbookInputQuery: null
  required: false
  value:
    simple: CVE-2020-14005,CVE-2020-13169
- description: Hard-coded STIX file of SUNBURST and SolarStorm indicators.
  key: SunBurstSTIX
  playbookInputQuery: null
  required: false
  value:
    simple: '{"id":"bundle--60aab587-660c-4b58-89d0-efcf9cbdf8dd","type":"bundle","spec_version":"2.0","objects":[{"created":"2020-12-17T16:50:49.000Z","id":"indicator--180de847-a4c8-4e76-b719-138ac9c9b58e","labels":["file
      sha-256"],"modified":"2020-12-17T16:50:49.000Z","pattern":"[file:hashes.sha256
      = ''019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.12709Z"},{"created":"2020-12-17T16:51:42.000Z","id":"indicator--8d217031-22f6-4d86-bd42-0519032d93bc","labels":["file
      sha-256"],"modified":"2020-12-17T16:51:42.000Z","pattern":"[file:hashes.sha256
      = ''439bcd0a17d53837bc29fb51c0abd9d52a747227f97133f8ad794d9cc0ef191e'']","score":"Medium","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.144865Z"},{"created":"2020-12-17T16:58:27.000Z","id":"indicator--ff3c830a-dbe2-45ec-bfbc-dd357ae040fc","labels":["domain"],"modified":"2020-12-17T16:58:27.000Z","pattern":"[domain-name:value
      = ''thedoccloud.com'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.146129Z"},{"created":"2020-12-17T16:52:06.000Z","id":"indicator--514f2faf-9572-44e3-8f67-ea782206335f","labels":["file
      sha-256"],"modified":"2020-12-17T16:52:06.000Z","pattern":"[file:hashes.sha256
      = ''a25cadd48d70f6ea0c4a241d99c5241269e6faccb4054e62d16784640f8e53bc'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.149043Z"},{"created":"2020-12-17T16:50:28.000Z","id":"indicator--2e3e39c2-757d-496f-82b1-a715e44fb682","labels":["file
      sha-256"],"modified":"2020-12-17T16:50:28.000Z","pattern":"[file:hashes.sha256
      = ''abe22cf0d78836c3ea072daeaf4c5eeaf9c29b6feb597741651979fc8fbd2417'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.150253Z"},{"created":"2020-12-17T16:59:49.000Z","id":"indicator--a444b6e0-da14-4a6e-8024-15cda0061a6e","labels":["domain"],"modified":"2020-12-17T16:59:49.000Z","pattern":"[domain-name:value
      = ''databasegalore.com'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.151314Z"},{"created":"2020-12-17T16:54:00.000Z","id":"indicator--1fbf05cb-270c-4c0b-aac1-1ae960fb166a","labels":["file
      sha-256"],"modified":"2020-12-17T16:54:00.000Z","pattern":"[file:hashes.sha256
      = ''c15abaf51e78ca56c0376522d699c978217bf041a3bd3c71d09193efa5717c71'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.152749Z"},{"created":"2020-12-17T16:51:14.000Z","id":"indicator--18561b05-1cbe-42ab-b4ae-b315e8709c02","labels":["file
      sha-256"],"modified":"2020-12-17T16:51:14.000Z","pattern":"[file:hashes.sha256
      = ''ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.15395Z"},{"created":"2020-12-17T16:49:45.000Z","id":"indicator--85ebd471-202b-4086-93fb-e075f70f506d","labels":["file
      sha-256"],"modified":"2020-12-17T16:49:45.000Z","pattern":"[file:hashes.sha256
      = ''53f8dfc65169ccda021b72a62e0c22a4db7c4077f002fa742717d41b3c40f2c7'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.155011Z"},{"created":"2020-12-17T16:52:27.000Z","id":"indicator--57f6e856-0188-4ab8-b563-f3633ec093fb","labels":["file
      sha-256"],"modified":"2020-12-17T16:52:27.000Z","pattern":"[file:hashes.sha256
      = ''d3c6785e18fba3749fb785bc313cf8346182f532c59172b69adfb31b96a5d0af'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.156195Z"},{"created":"2020-12-17T16:57:26.000Z","id":"indicator--bf705330-2adb-4dfa-a844-d5d1176a0ad0","labels":["url"],"modified":"2020-12-17T16:57:26.000Z","pattern":"[url:value
      = ''mhdosoksaccf9sni9icp.appsync-api.eu-west-1.avsvmcloud.com \t'']","score":"Medium","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.157272Z"},{"created":"2020-12-17T16:57:06.000Z","id":"indicator--2c1cfda2-2481-498f-8123-47ac1276f799","labels":["url"],"modified":"2020-12-17T16:57:06.000Z","pattern":"[url:value
      = ''k5kcubuassl3alrf7gm3.appsync-api.eu-west-1.avsvmcloud.com \t'']","score":"Medium","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.159475Z"},{"created":"2020-12-17T16:59:33.000Z","id":"indicator--a64f9a04-d494-40ee-bb54-9b9406b76372","labels":["domain"],"modified":"2020-12-17T16:59:33.000Z","pattern":"[domain-name:value
      = ''incomeupdate.com'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.160553Z"},{"created":"2020-12-17T16:52:52.000Z","id":"indicator--8683f37c-2ea9-4253-b8c5-e138ddff40c3","labels":["file
      sha-256"],"modified":"2020-12-17T16:52:52.000Z","pattern":"[file:hashes.sha256
      = ''292327e5c94afa352cc5a02ca273df543f2020d0e76368ff96c84f4e90778712'']","score":"Medium","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.161572Z"},{"created":"2020-12-17T16:46:31.000Z","id":"indicator--cc6f08e1-3475-43bc-ab4e-e5818e5b37b2","labels":["file
      sha-256"],"modified":"2020-12-17T16:46:31.000Z","pattern":"[file:hashes.sha256
      = ''32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.162783Z"},{"created":"2020-12-17T16:47:35.000Z","id":"indicator--9ca400a7-257b-4cf3-91a8-b2c9a565266b","labels":["file
      sha-256"],"modified":"2020-12-17T16:47:35.000Z","pattern":"[file:hashes.sha256
      = ''d0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.163984Z"},{"created":"2020-12-17T17:00:14.000Z","id":"indicator--ea44dc42-e516-4307-9225-21ccb22a7cc2","labels":["domain"],"modified":"2020-12-17T17:00:14.000Z","pattern":"[domain-name:value
      = ''panhardware.com'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.165095Z"},{"created":"2020-12-17T16:56:41.000Z","id":"indicator--45f9a437-c4ee-4a24-9ffa-35a1202d62d5","labels":["url"],"modified":"2020-12-17T16:56:41.000Z","pattern":"[url:value
      = ''ihvpgv9psvq02ffo77et.appsync-api.us-east-2.avsvmcloud.com'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.166111Z"},{"created":"2020-12-17T16:55:40.000Z","id":"indicator--242b1ad9-6309-4752-bad4-abf73f641297","labels":["url"],"modified":"2020-12-17T16:55:40.000Z","pattern":"[url:value
      = ''7sbvaemscs0mc925tb99.appsync-api.us-west-2.avsvmcloud.com \t'']","score":"Medium","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.167169Z"},{"created":"2020-12-17T16:55:18.000Z","id":"indicator--b96ee095-a7d4-40a8-a4b4-9e7c080f5a44","labels":["url"],"modified":"2020-12-17T16:55:18.000Z","pattern":"[url:value
      = ''6a57jk2ba1d9keg15cbg.appsync-api.eu-west-1.avsvmcloud.com'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.168384Z"},{"created":"2020-12-17T16:59:14.000Z","id":"indicator--e03d0075-7880-43cd-86b1-18325470be45","labels":["domain"],"modified":"2020-12-17T16:59:14.000Z","pattern":"[domain-name:value
      = ''highdatabase.com'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.169586Z"},{"created":"2020-12-17T16:58:56.000Z","id":"indicator--8942bb33-e898-4a10-bfb3-64530bd973ab","labels":["domain"],"modified":"2020-12-17T16:58:56.000Z","pattern":"[domain-name:value
      = ''websitetheme.com'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.170584Z"},{"created":"2020-12-17T16:56:08.000Z","id":"indicator--2be41276-00d3-4438-bbf0-4fcc56dc3076","labels":["url"],"modified":"2020-12-17T16:56:08.000Z","pattern":"[url:value
      = ''gq1h856599gqh538acqn.appsync-api.us-west-2.avsvmcloud.com'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.171575Z"},{"created":"2020-12-17T16:58:10.000Z","id":"indicator--8cd838ae-6330-4fbf-b5b4-07b77d46438d","labels":["domain"],"modified":"2020-12-17T16:58:10.000Z","pattern":"[domain-name:value
      = ''freescanonline.com'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.172676Z"},{"created":"2020-12-17T16:57:52.000Z","id":"indicator--646c5771-6904-4176-813f-a2ca357f0e42","labels":["domain"],"modified":"2020-12-17T16:57:52.000Z","pattern":"[domain-name:value
      = ''deftsecurity.com'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.173695Z"},{"created":"2020-12-17T16:47:15.000Z","id":"indicator--4069cf11-f617-40f2-8f7f-534e225aa33b","labels":["file
      sha-256"],"modified":"2020-12-17T16:47:15.000Z","pattern":"[file:hashes.sha256
      = ''efbec6863f4330dbb702cc43a85a0a7c29d79fde0f7d66eac9a3be43493cab4f'']","score":"Medium","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.174561Z"},{"created":"2020-12-17T17:00:41.000Z","id":"indicator--026307f7-449c-4858-a112-fc4b73c31593","labels":["domain"],"modified":"2020-12-17T17:00:41.000Z","pattern":"[domain-name:value
      = ''zupertech.com'']","score":"High","source":"","type":"indicator","valid_from":"2020-12-17T17:01:35.175745Z"}]}'
- description: |
    Add your own custom SUNBURST and SolarStorm IOCs to hunt.
  key: KnownRelatedIOCs
  playbookInputQuery: null
  required: false
  value: {}
- description: PAN-OS Log Forwarding Profile Name
  key: LogForwarding
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    This input establishes whether to commit the configuration automatically in PAN-OS.
    Yes - Commit automatically.
    No - Commit manually.
  key: AutoCommit
  playbookInputQuery: null
  required: false
  value:
    simple: "No"
- description: |-
    This input establishes whether to block the SolarWinds server automatically in PAN-OS.
    True - Commit automatically.
    False - Commit manually.
  key: AutoBlockSolarWindsServer
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: 'Target Device Group (Panorama only) '
  key: DeviceGroup
  playbookInputQuery: null
  required: false
  value: {}
- description: Comma-separated list of Service O365 admin roles.
  key: O365_AdminRolesList
  playbookInputQuery: null
  required: false
  value: {}
- description: The maximum number of results to retrieve. Default is 10.
  key: Mialboxes_Retrieve_Limit
  playbookInputQuery: null
  required: false
  value:
    simple: "10"
- description: 'The input setting indicates whether to Automatically Block Indicators
    related to the SolarStrom Attack Default: True'
  key: AutoBlockIndicators
  playbookInputQuery: null
  required: false
  value:
    simple: "True"
- description: 'The input indicates whether the user should verify the indicators
    before continuing with the playbook Default: Fasle'
  key: UserVerification
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: 'A list of internal IP ranges to check IP addresses against. The comma-separated
    list should be provided in CIDR notation. For example, a list of ranges would
    be: "172.16.0.0/12,10.0.0.0/8,192.168.0.0/16" (without quotes).'
  key: InternalRange
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: PrivateIPs
      root: lists
      transformers:
      - args:
          error_if_no_match: {}
          ignore_case: {}
          multi_line: {}
          period_matches_newline: {}
          regex:
            value:
              simple: (\b(?:\d{1,3}\.){3}\d{1,3}\b/\d{1,2})
          unpack_matches: {}
        operator: RegexExtractAll
      - args:
          separator:
            value:
              simple: ','
        operator: join
name: SolarStorm and SUNBURST Hunting and Response Playbook
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "95"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: df7502eb-2e4b-4de4-8ef1-697b83012f1b
      iscommand: false
      name: ""
      version: -1
    taskid: df7502eb-2e4b-4de4-8ef1-697b83012f1b
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 240,
          "y": -990
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
      - "61"
      - "62"
      - "93"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e72a5f88-9b96-410b-83f8-04a61daeb514
      iscommand: false
      name: Collect and Retrieve Indicators to Hunt
      type: title
      version: -1
    taskid: e72a5f88-9b96-410b-83f8-04a61daeb514
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": -465
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      filename:
        simple: fireeye_Indicator_Release_Hashes.csv
      method:
        simple: GET
      url:
        simple: https://raw.githubusercontent.com/fireeye/sunburst_countermeasures/main/indicator_release/Indicator_Release_Hashes.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends HTTP request. Returns the response as a JSON file.
      id: f6dc8e72-4e53-495f-80c8-57260deac55d
      iscommand: false
      name: Collect hashes from FireEye for installed SUNBURST backdoor
      script: http
      type: regular
      version: -1
    taskid: f6dc8e72-4e53-495f-80c8-57260deac55d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 970,
          "y": -120
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: d3bb2cfc-d4d3-45ac-8d51-6d176397f96c
      iscommand: true
      name: Close investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: d3bb2cfc-d4d3-45ac-8d51-6d176397f96c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 4810
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 23e1215c-26fe-4bb2-8a6a-cf5d0c558ca5
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 23e1215c-26fe-4bb2-8a6a-cf5d0c558ca5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 4980
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      log_type:
        simple: threat
      query:
        simple: (threatid eq 86237) or (threatid eq 86245) or (threatid eq 86242)
          or (threatid eq 86246) or (threatid eq 86249) or (threatid eq 86247) or
          (threatid eq 86243) or (threatid eq 86248) or (threatid eq 86244) or (threatid
          eq 86238) or (threatid eq 86239) or (threatid eq 86240) or (threatid eq
          86251) or (threatid eq 86250)
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: 'Query Panorama logs of types: traffic, threat, url, data-filtering,
        and wildfire.'
      id: 74ab24f0-0bd4-47eb-8d5b-13e7a94c01fa
      iscommand: false
      name: Panorama Query Logs
      playbookId: Panorama Query Logs
      type: playbook
      version: -1
    taskid: 74ab24f0-0bd4-47eb-8d5b-13e7a94c01fa
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2490,
          "y": 920
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
      - "52"
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d0b423c5-3032-4ba8-8a3a-6fb47a515de6
      iscommand: false
      name: 'Remediation '
      type: title
      version: -1
    taskid: d0b423c5-3032-4ba8-8a3a-6fb47a515de6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 1830
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Further investigate the incident (endpoints, entry point, etc.').\nIf
        Expanse found SolarWinds C2 connection, investigate the internal server too. "
      id: 915d6f50-e12b-4526-8582-8fcb4f78d60e
      iscommand: false
      name: Investigate further
      type: regular
      version: -1
    taskid: 915d6f50-e12b-4526-8582-8fcb4f78d60e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 4640
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "104"
      - "105"
      - "107"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: commands.local.cmd.close.inv
      id: f83d2976-e87f-4c01-8165-77423b4ca394
      iscommand: false
      name: Mitigation
      type: title
      version: -1
    taskid: f83d2976-e87f-4c01-8165-77423b4ca394
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 3415
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: SolarStorm, SunBurst
      indicatorsValues:
        complex:
          accessor: MD5
          root: File
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      id: 250497c1-30af-46c8-8335-e700e5a36318
      iscommand: true
      name: Mark hash indicators with SolarStorm tag
      script: Builtin|||appendIndicatorField
      type: regular
      version: -1
    taskid: 250497c1-30af-46c8-8335-e700e5a36318
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 2130
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      MD5Hash:
        complex:
          accessor: MD5
          root: File
          transformers:
          - operator: uniq
      SHA1Hash:
        complex:
          accessor: SHA1
          root: File
          transformers:
          - operator: uniq
      SHA256Hash:
        complex:
          accessor: SHA256
          root: File
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Hunt using available tools
      id: 48472983-7092-4dfe-89f6-ceb26703829b
      iscommand: false
      name: Search Endpoints By Hash - Generic V2
      playbookId: Search Endpoints By Hash - Generic V2
      type: playbook
      version: -1
    taskid: 48472983-7092-4dfe-89f6-ceb26703829b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 970,
          "y": 920
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
      - "46"
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 55ace1d4-8de9-45ea-8ebe-6365b73836e6
      iscommand: false
      name: Hunt SolarStorm and SunBurst in Network Activity
      type: title
      version: -1
    taskid: 55ace1d4-8de9-45ea-8ebe-6365b73836e6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2490,
          "y": 770
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cd98aba6-c495-4a50-8875-83640d95f2f0
      iscommand: false
      name: Hunt Backdoor SolarWinds and SunBurst in Endpoints
      type: title
      version: -1
    taskid: cd98aba6-c495-4a50-8875-83640d95f2f0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 970,
          "y": 770
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fc976106-3685-4df9-8e2c-7bbd57a0c515
      iscommand: false
      name: No Infections Found
      type: title
      version: -1
    taskid: fc976106-3685-4df9-8e2c-7bbd57a0c515
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 280,
          "y": 2405
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        complex:
          accessor: Hostname
          root: Endpoint
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: foundIncidents.CustomFields.xdralerts.host_name
            operator: append
          - operator: uniq
      Endpoint_id:
        complex:
          accessor: endpoint_id
          root: PaloAltoNetworksXDR.Endpoint
          transformers:
          - args:
              item:
                value:
                  simple: Endpoint.endpoint_id
            operator: append
          - operator: uniq
      Endpoint_ip:
        complex:
          accessor: DetectedInternalIPs
          root: PANWHunting
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: |-
        This playbook isolates a given endpoint using various endpoint product integrations.
        Make sure to provide valid playbook inputs for the integration you are using.
      id: ff78093a-70f4-4b4b-85d0-295d38234445
      iscommand: false
      name: Isolate Endpoint - Generic V2
      playbookId: Isolate Endpoint - Generic V2
      type: playbook
      version: -1
    taskid: ff78093a-70f4-4b4b-85d0-295d38234445
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 2490
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      log_type:
        simple: traffic
      query:
        simple: (app eq solarwinds)or(app eq solarwinds-rmm)or(app eq solarwinds-msp-manager)or(app
          eq solarwinds-agent)or(app eq solarwinds-npm)or(app eq solarwinds-sam)or(app
          eq solarwinds-msp-anywhere)
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: 'Query Panorama logs of types: traffic, threat, url, data-filtering,
        and wildfire.'
      id: b37458d1-def5-4d43-80d5-fab59e932ea3
      iscommand: false
      name: Panorama Query Logs
      playbookId: Panorama Query Logs
      type: playbook
      version: -1
    taskid: b37458d1-def5-4d43-80d5-fab59e932ea3
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2920,
          "y": 920
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8d8e955b-0570-45b2-8846-5fb49ddd92d5
      iscommand: false
      name: Block Indicators
      type: title
      version: -1
    taskid: 8d8e955b-0570-45b2-8846-5fb49ddd92d5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2280,
          "y": 1975
        }
      }
  "43":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Endpoint
          operator: isNotEmpty
        - left:
            iscontext: true
            value:
              complex:
                accessor: DetectedInternalIPs
                root: PANWHunting
          operator: isNotEmpty
        - left:
            iscontext: true
            value:
              complex:
                accessor: DetectedInternalHosts
                root: PANWHunting
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "50"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Checks whether there was a compromised host found.
      id: 20c12bed-6e5d-470e-8472-bc04e8d65808
      iscommand: false
      name: Any compromised hosts found?
      type: condition
      version: -1
    taskid: 20c12bed-6e5d-470e-8472-bc04e8d65808
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 610,
          "y": 2130
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "100"
      - "101"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b23dbbf1-0265-4224-8745-0ec6fc213257
      iscommand: false
      name: Hunting
      type: title
      version: -1
    taskid: b23dbbf1-0265-4224-8745-0ec6fc213257
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 450
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      IPAddresses:
        complex:
          accessor: Address
          root: IP
      MD5:
        complex:
          accessor: MD5
          root: File
      SHA1:
        complex:
          accessor: SHA1
          root: File
      SHA256:
        complex:
          accessor: SHA256
          root: File
      URLDomain:
        complex:
          accessor: Data
          root: URL
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      id: 838bb5a8-c5b1-42f7-814b-cdc8a9fb786b
      iscommand: false
      name: Palo Alto Networks - Hunting And Threat Detection
      playbookName: Palo Alto Networks - Hunting And Threat Detection
      type: playbook
      version: -1
    taskid: 838bb5a8-c5b1-42f7-814b-cdc8a9fb786b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2030,
          "y": 920
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: Indicator_Release_NBIs.csv
      method:
        simple: GET
      url:
        simple: https://raw.githubusercontent.com/fireeye/sunburst_countermeasures/main/indicator_release/Indicator_Release_NBIs.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends HTTP request. Returns the response as a JSON file.
      id: ae3c46c9-ff8a-4458-83ba-abe76e20b4ee
      iscommand: false
      name: Collect domains and IPs from FireEye for installed SUNBURST backdoor
      script: http
      type: regular
      version: -1
    taskid: ae3c46c9-ff8a-4458-83ba-abe76e20b4ee
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": -120
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      input:
        complex:
          accessor: Body
          root: HttpRequest.Response
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Remove escaping chars from IP
        127[.]0[.]0[.]1 -> 127.0.0.1
      id: 559abe5c-5326-4b75-8682-7e6aa4c3a6d3
      iscommand: false
      name: UnEscape IPs from result to indicators
      script: UnEscapeIPs
      type: regular
      version: -1
    taskid: 559abe5c-5326-4b75-8682-7e6aa4c3a6d3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 45
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      input:
        complex:
          accessor: Body
          root: HttpRequest.Response
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Extract URLs redirected by security tools like Proofpoint.
        Changes https://urldefense.proofpoint.com/v2/url?u=https-3A__example.com_something.html -> https://example.com/something.html
        Also, un-escape URLs that are escaped for safety with formats like hxxps://www[.]demisto[.]com
      id: dcf9c17e-1de1-464e-8f79-45b45f4e6f37
      iscommand: false
      name: UnEscape URLs from result to indicators
      script: UnEscapeURLs
      type: regular
      version: -1
    taskid: dcf9c17e-1de1-464e-8f79-45b45f4e6f37
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 220
        }
      }
  "50":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.IsolateEndpointAutomatically
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "57"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Checks whether files associated with the incident can be blocked automatically using various EDR integrations.
      id: 4a3d415c-8f04-4028-857b-d6d39b7a2c14
      iscommand: false
      name: Whether to automatically isolate compromised hosts?
      type: condition
      version: -1
    taskid: 4a3d415c-8f04-4028-857b-d6d39b7a2c14
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 810,
          "y": 2310
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f5255969-e3b5-4dbb-808d-28d7093ac2be
      iscommand: false
      name: Isolate Compromised Hosts
      type: title
      version: -1
    taskid: f5255969-e3b5-4dbb-808d-28d7093ac2be
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 610,
          "y": 1975
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    scriptarguments:
      merge:
        simple: "True"
      tags:
        simple: SolarStorm, SUNBURST
      type:
        simple: IP
      value:
        complex:
          accessor: Address
          root: IP
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 11e03119-eb81-4efb-8f4d-32b7805d8999
      iscommand: true
      name: Mark IP indicators with SolarStorm tag
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 11e03119-eb81-4efb-8f4d-32b7805d8999
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 2310
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    scriptarguments:
      merge:
        simple: "True"
      tags:
        simple: SolarStorm, SUNBURST
      type:
        simple: URL
      value:
        complex:
          accessor: Data
          root: URL
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 7fd76e93-b362-4e9a-8ca9-86912e60e82e
      iscommand: true
      name: Mark URL indicators with SolarStorm tag
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 7fd76e93-b362-4e9a-8ca9-86912e60e82e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 2490
        }
      }
  "55":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.BlockIndicatorsAutomatically
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "114"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether IOCs associated with the incident can be blocked
        automatically.
      id: 9d6d6b1d-9742-461d-86b1-cd8e5e9fbfa2
      iscommand: false
      name: Whether to block indicators automatically?
      type: condition
      version: -1
    taskid: 9d6d6b1d-9742-461d-86b1-cd8e5e9fbfa2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2280,
          "y": 2120
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manually block the IOCs in the relevant systems.
      id: 511ceecb-ce1d-4060-8f4d-5e96475ebb41
      iscommand: false
      name: Manually block indicators
      type: regular
      version: -1
    taskid: 511ceecb-ce1d-4060-8f4d-5e96475ebb41
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2040,
          "y": 2310
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manually isolate the compromised hosts.
      id: cc2310e2-051f-46d1-8a1d-83b3a3fcb4ad
      iscommand: false
      name: Manually isolate endpoints
      type: regular
      version: -1
    taskid: cc2310e2-051f-46d1-8a1d-83b3a3fcb4ad
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 600,
          "y": 2490
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d4973066-0d77-40e4-8104-9324bd5a09cf
      iscommand: false
      name: Tag SolarStorm and SUNBURST Indicators
      type: title
      version: -1
    taskid: d4973066-0d77-40e4-8104-9324bd5a09cf
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 1975
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      method:
        simple: GET
      url:
        simple: https://github.com/pan-unit42/iocs/blob/master/SolarStorm/IOCs
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends HTTP request. Returns the response as a JSON file.
      id: 86f09a3f-2404-448a-865c-d450cdfc100c
      iscommand: false
      name: Collect IOCs from UNIT42 GIT
      script: http
      type: regular
      version: -1
    taskid: 86f09a3f-2404-448a-865c-d450cdfc100c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 570,
          "y": -120
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
      - "47"
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 899900ab-c1d5-4b7c-80d5-3bab3cbe7ecd
      iscommand: false
      name: Indicators from GIT Sources
      type: title
      version: -1
    taskid: 899900ab-c1d5-4b7c-80d5-3bab3cbe7ecd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 970,
          "y": -290
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 185d4a76-851d-45e1-897a-dee9956f38ba
      iscommand: false
      name: Indicators from STIX File
      type: title
      version: -1
    taskid: 185d4a76-851d-45e1-897a-dee9956f38ba
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2010,
          "y": -290
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fcb7d370-ad48-4f01-8f49-ebd6f8e732dd
      iscommand: false
      name: CVE Indicators
      type: title
      version: -1
    taskid: fcb7d370-ad48-4f01-8f49-ebd6f8e732dd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2530,
          "y": -290
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 0
    scriptarguments:
      data:
        complex:
          root: inputs.SunBurstSTIX
      filename:
        simple: SunBurst STIX
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Creates a file (using the given data input or entry ID) and uploads it to the current investigation War Room.
      id: 31b82d2f-dc62-4dc5-8702-3f58845246ba
      iscommand: false
      name: Create aSTIX file
      script: FileCreateAndUploadV2
      type: regular
      version: -1
    taskid: 31b82d2f-dc62-4dc5-8702-3f58845246ba
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2010,
          "y": -120
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File
              operator: isExists
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates indicators from the submitted STIX file. Supports STIX
        1.0 and STIX 2.0.
      id: a1297631-2ac8-4963-873d-8c1710d5b19e
      iscommand: false
      name: Create indicators from STIX
      script: CreateIndicatorsFromSTIX
      type: regular
      version: -1
    taskid: a1297631-2ac8-4963-873d-8c1710d5b19e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2010,
          "y": 45
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      cve_id:
        complex:
          root: inputs.CVEs
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This playbook performs CVE enrichment using the following integrations:
        - VulnDB
        - CVE Search
        - IBM X-Force Exchange
      id: 16b0b0b3-851c-4072-814a-673eb1f7b6b4
      iscommand: false
      name: CVE Enrichment - Generic v2
      playbookId: CVE Enrichment - Generic v2
      type: playbook
      version: -1
    taskid: 16b0b0b3-851c-4072-814a-673eb1f7b6b4
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2530,
          "y": -120
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 266b5bd4-3db5-463e-86e1-00829e09df3e
      iscommand: false
      name: CVEs Hunt
      type: title
      version: -1
    taskid: 266b5bd4-3db5-463e-86e1-00829e09df3e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 770
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      CVE_ID:
        complex:
          root: inputs.CVEs
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      id: a89635fa-cc4b-4ef3-8637-2440274c72da
      iscommand: false
      name: Search Endpoint by CVE - Generic
      playbookId: Search Endpoint by CVE - Generic
      type: playbook
      version: -1
    taskid: a89635fa-cc4b-4ef3-8637-2440274c72da
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 920
        }
      }
  "70":
    continueonerror: true
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          root: inputs.KnownRelatedIOCs
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: d428e0f2-294d-47ea-8e0d-40a89308f07b
      iscommand: true
      name: Extract indicators from playbook inputs
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: d428e0f2-294d-47ea-8e0d-40a89308f07b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3400,
          "y": 280
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: SUNBURSTXDRincidents=
      query:
        simple: xdralerts.name:"SunBurst Module loaded" or xdralerts.name:"SunBurst
          domain access"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Search XDR incidents for SUNBURST in the network.
      id: eab9c45c-7490-4f8c-8eec-d0ed2c9838ee
      iscommand: false
      name: Search XDR incidents for SUNBURST
      script: SearchIncidentsV2
      type: regular
      version: -1
    taskid: eab9c45c-7490-4f8c-8eec-d0ed2c9838ee
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 920
        }
      }
  "75":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.KnownRelatedIOCs
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "45"
      "yes":
      - "70"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there are additional IOCs from the playbook input.
      id: 95a06bdf-7d38-4c9e-81b5-d5d0e4c93783
      iscommand: false
      name: 'Are there custom IOCs? '
      type: condition
      version: -1
    taskid: 95a06bdf-7d38-4c9e-81b5-d5d0e4c93783
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3120,
          "y": 70
        }
      }
  "76":
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      issue_type:
        simple: Insecure SolarWinds Orion Platform, SolarWinds Orion Platform
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Search for vulnerable SolarWinds server with Expanse.
      id: b642ac48-a581-4b86-8126-3fc37c69f495
      iscommand: true
      name: Expanse search for SolarWinds server
      script: '|||expanse-get-issues'
      type: regular
      version: -1
    taskid: b642ac48-a581-4b86-8126-3fc37c69f495
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3590,
          "y": 1310
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dc0d9da2-ba62-4849-87f6-7b2353a410ce
      iscommand: false
      name: Expanse Search SolarWinds Server and C2 Network Connection
      type: title
      version: -1
    taskid: dc0d9da2-ba62-4849-87f6-7b2353a410ce
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3590,
          "y": 770
        }
      }
  "83":
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "84"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aef22b99-450a-4f3e-8078-db05a73a9eb9
      iscommand: false
      name: Block Access to Vulnerable SolarWinds
      type: title
      version: -1
    taskid: aef22b99-450a-4f3e-8078-db05a73a9eb9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 2700
        }
      }
  "84":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ip
                root: Expanse.Issue
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "85"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if a vulnerable SolarWinds server was found.
      id: 9d66b70c-9ac8-4f0b-8d30-786e6fbd1a2c
      iscommand: false
      name: Was a vulnerable SolarWinds server found?
      type: condition
      version: -1
    taskid: 9d66b70c-9ac8-4f0b-8d30-786e6fbd1a2c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 2860
        }
      }
  "85":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.AutoBlockSolarWindsServer
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "86"
      "yes":
      - "115"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether to block the vulnerable SolarWinds server automatically
        according to the value set for the "AutoBlockSolarWindsServer" playbook input.
      id: 19541626-dcaf-4f4a-89a2-45d193c85535
      iscommand: false
      name: Block vulnerable SolarWinds server automatically?
      type: condition
      version: -1
    taskid: 19541626-dcaf-4f4a-89a2-45d193c85535
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2040,
          "y": 3040
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: To protect your network, block the internet facing SolarWinds server
        until patch.
      id: 5f091703-1630-4781-839b-77c8b525cc6e
      iscommand: false
      name: Manually block SolarWinds server
      type: regular
      version: -1
    taskid: 5f091703-1630-4781-839b-77c8b525cc6e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1830,
          "y": 3220
        }
      }
  "90":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                  - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Expanse V2
                root: modules
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "19"
      "yes":
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the Expanse instance is enabled.
      id: 9b7aec71-0f58-4d7c-8d61-b85d8f52f681
      iscommand: false
      name: 'Is Expanse enabled? '
      type: condition
      version: -1
    taskid: 9b7aec71-0f58-4d7c-8d61-b85d8f52f681
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3590,
          "y": 920
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: XDRSolarStormBehaviorIncidents=
      query:
        simple: 'xdralerts.name:"Malicious NetSetupSvc.dll loaded into svchost.exe"
          or xdralerts.name:"ADFind queries Active Directory for Exchange groups"
          or xdralerts.name:"Virtual Directory configuration access via PowerShell"
          or xdralerts.name:"PowerShell dumps users and roles from Exchange server"
          or xdralerts.name:"Unverified domain added to Azure AD" or xdralerts.name:"Domain
          federation settings have been modified" or xdralerts.name:"Uncommon PowerShell
          commands used to create or alter scheduled task parameters" '
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Search for an XDR incident related to the suspicious SolarStorm
        behavior.
      id: 7ecbe048-d99e-472b-85d6-54cc9382d5e0
      iscommand: false
      name: Search XDR incidents for suspicious SolarStorm behavior
      script: SearchIncidentsV2
      type: regular
      version: -1
    taskid: 7ecbe048-d99e-472b-85d6-54cc9382d5e0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 130,
          "y": 755
        }
      }
  "93":
    continueonerrortype: ""
    id: "93"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: de31edb7-621b-40e0-80e9-e8538ed132d9
      iscommand: false
      name: Additional IOCs
      type: title
      version: -1
    taskid: de31edb7-621b-40e0-80e9-e8538ed132d9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3120,
          "y": -290
        }
      }
  "94":
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: d0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600,
          efbec6863f4330dbb702cc43a85a0a7c29d79fde0f7d66eac9a3be43493cab4f, d0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600,
          efbec6863f4330dbb702cc43a85a0a7c29d79fde0f7d66eac9a3be43493cab4f, 32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77,
          d0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600, efbec6863f4330dbb702cc43a85a0a7c29d79fde0f7d66eac9a3be43493cab4f,
          32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77, 019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134,
          ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 3c50cb80-09f0-4906-8af0-768bcdd77eef
      iscommand: true
      name: Hard-coded related IOCs
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 3c50cb80-09f0-4906-8af0-768bcdd77eef
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3120,
          "y": -100
        }
      }
  "95":
    continueonerrortype: ""
    form:
      description: Checks if the SolarWinds server version is vulnerable.
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: "Is the version of the organization SolarWinds one of the following?
            \n- Orion Platform 2019.4 HF5, version 2019.4.5200.9083\n- Orion Platform
            2020.2 RC1, version 2020.2.100.12219\n- Orion Platform 2020.2 RC2, version
            2020.2.5200.12394\n- Orion Platform 2020.2, 2020.2 HF1, version 2020.2.5300.12432"
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: SolarWinds Server Version Check
      totalanswers: 0
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Please check your SolarWinds Orion Platform.
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: SolarWinds server version check
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Administrator,Analyst
    nexttasks:
      '#none#':
      - "96"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Data collection task to checks whether there is a SolarWinds server
        with a vulnerable version.
      id: 5d7b85ac-5395-47ca-8c38-9d783985c1c8
      iscommand: false
      name: Is the organization SolarWinds server version vulnerable?
      type: collection
      version: -1
    taskid: 5d7b85ac-5395-47ca-8c38-9d783985c1c8
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 240,
          "y": -830
        }
      }
  "96":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: SolarWinds server version check.Answers
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "96"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "97"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether there is a SolarWinds server with a vulnerable version.
      id: 923654a0-7f07-4e46-8380-23ab98694d19
      iscommand: false
      name: 'Was SolarWinds found vulnerable? '
      type: condition
      version: -1
    taskid: 923654a0-7f07-4e46-8380-23ab98694d19
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 240,
          "y": -650
        }
      }
  "97":
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f7dc53c2-d3bb-42a8-8e12-3e65a22bc21a
      iscommand: false
      name: SolarWinds Not Vulnerable
      type: title
      version: -1
    taskid: f7dc53c2-d3bb-42a8-8e12-3e65a22bc21a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1090,
          "y": -465
        }
      }
  "99":
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: |2-



        Sources:
        - https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html
        - https://unit42.paloaltonetworks.com/fireeye-solarstorm-sunburst/3/
        - https://www.splunk.com/en_us/blog/security/sunburst-backdoor-detections-in-splunk.html
      id: 0e599e7e-111d-40ae-8a2b-c4c3dba27831
      iscommand: false
      name: SolarStorm Activity Behavior Hunting playbook
      playbookId: SolarStorm Activity Behavior Hunting playbook
      type: playbook
      version: -1
    taskid: 0e599e7e-111d-40ae-8a2b-c4c3dba27831
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -320,
          "y": 755
        }
      }
  "100":
    continueonerrortype: ""
    id: "100"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
      - "67"
      - "31"
      - "81"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fba6698e-be59-4a22-87af-0ee37844d94d
      iscommand: false
      name: Hunt SolarStrom IOCs
      type: title
      version: -1
    taskid: fba6698e-be59-4a22-87af-0ee37844d94d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2490,
          "y": 600
        }
      }
  "101":
    continueonerrortype: ""
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "92"
      - "99"
      - "102"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c9c188c4-20b4-490e-8b73-0baef1f24b4b
      iscommand: false
      name: Hunt SolarStorm Activity
      type: title
      version: -1
    taskid: c9c188c4-20b4-490e-8b73-0baef1f24b4b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -320,
          "y": 600
        }
      }
  "102":
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      id: c4833080-27d3-49be-8720-409614f5c265
      iscommand: false
      name: Office 365 and Azure Hunting
      playbookName: Office 365 and Azure Hunting
      type: playbook
      version: -1
    taskid: c4833080-27d3-49be-8720-409614f5c265
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -770,
          "y": 755
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "113"
    note: false
    quietmode: 0
    scriptarguments:
      Limit:
        complex:
          root: inputs.Mialboxes_Retrieve_Limit
      O365_AdminRolesList:
        complex:
          root: inputs.O365_AdminRolesList
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: This playbook helps you collect, review, and find misconfigurations
        with the Azure environment.
      id: 730fc061-b36a-4810-8e3b-c3755849cc79
      iscommand: false
      name: Office 365 and Azure Configuration Analysis
      playbookName: Office 365 and Azure Configuration Analysis
      type: playbook
      version: -1
    taskid: 730fc061-b36a-4810-8e3b-c3755849cc79
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 3710
        }
      }
  "104":
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9a2c8087-c99e-4854-8b9b-ef1ff564379d
      iscommand: false
      name: SolarWinds Mitigation
      type: title
      version: -1
    taskid: 9a2c8087-c99e-4854-8b9b-ef1ff564379d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2070,
          "y": 3560
        }
      }
  "105":
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "103"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8cd27b2c-e82e-43c4-825a-5b64cace9c3a
      iscommand: false
      name: Azure Mitigation
      type: title
      version: -1
    taskid: 8cd27b2c-e82e-43c4-825a-5b64cace9c3a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 3560
        }
      }
  "106":
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "108"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        The latest SolarWinds updates designed to protect against SUNBURST and SUPERNOVA are as follows:
        2019.4 HF 6 (released December 14, 2020)

        2020.2.1 HF 2 (released December 15, 2020)

        2019.2 SUPERNOVA Patch (released December 23, 2020)

        2018.4 SUPERNOVA Patch (released December 23, 2020)

        2018.2 SUPERNOVA Patch (released December 23, 2020)
      id: e2a29a05-d556-456d-8808-7da11f65d3f1
      iscommand: false
      name: Patch Vulnerable SolarWinds Server
      type: regular
      version: -1
    taskid: e2a29a05-d556-456d-8808-7da11f65d3f1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2070,
          "y": 3710
        }
      }
  "107":
    continueonerrortype: ""
    id: "107"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "109"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9f4dff31-2428-4dad-811b-5c070e355325
      iscommand: false
      name: 'Compromised Organization Entities Mitigation '
      type: title
      version: -1
    taskid: 9f4dff31-2428-4dad-811b-5c070e355325
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 950,
          "y": 3560
        }
      }
  "108":
    continueonerrortype: ""
    id: "108"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "113"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Change the password for the SolarWinds user.
      id: ee17d4d1-16a8-4135-8e82-28ee85d1c97c
      iscommand: false
      name: Change the password for SolarWinds user
      type: regular
      version: -1
    taskid: ee17d4d1-16a8-4135-8e82-28ee85d1c97c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2070,
          "y": 3890
        }
      }
  "109":
    continueonerrortype: ""
    id: "109"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "110"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: It is recommended to reset all credentials used by or stored in
        SolarWinds software since the SolarWinds server was compromised.
      id: fd8a92e6-fd8a-4e88-8d07-4ad9904547f0
      iscommand: false
      name: Reset all credentials used by or stored in SolarWinds software
      type: regular
      version: -1
    taskid: fd8a92e6-fd8a-4e88-8d07-4ad9904547f0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 950,
          "y": 3710
        }
      }
  "110":
    continueonerrortype: ""
    id: "110"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "111"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Replace the user account by Group Managed Service Account. '
      id: b1cc79b7-0379-4bad-870b-0f4424bbb70d
      iscommand: false
      name: 'Replace the user account by Group Managed Service Account '
      type: regular
      version: -1
    taskid: b1cc79b7-0379-4bad-870b-0f4424bbb70d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 950,
          "y": 3880
        }
      }
  "111":
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |+
        Set the allowable encryption types to AES256_HMAC_SHA1 and Future encryption types. https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-configure-encryption-types-allowed-for-kerberos

      id: ad25d090-f5ce-4d9b-8d72-08b54b94d01d
      iscommand: false
      name: Configure encryption types allowed for Kerberos
      type: regular
      version: -1
    taskid: ad25d090-f5ce-4d9b-8d72-08b54b94d01d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 950,
          "y": 4070
        }
      }
  "112":
    continueonerrortype: ""
    id: "112"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "113"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Treat all hosts monitored by the SolarWinds Orion monitoring software
        as compromised by threat actors and assume that further persistence mechanisms
        have been deployed.
      id: 2c96a4e2-48e0-4732-8ede-84852f08559c
      iscommand: false
      name: Rebuild hosts monitored by the SolarWinds
      type: regular
      version: -1
    taskid: 2c96a4e2-48e0-4732-8ede-84852f08559c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 950,
          "y": 4260
        }
      }
  "113":
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2f97a38b-6815-4cc2-8e2d-5a62a5916f40
      iscommand: false
      name: Mitigation Complete
      type: title
      version: -1
    taskid: 2f97a38b-6815-4cc2-8e2d-5a62a5916f40
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 4440
        }
      }
  "114":
    continueonerrortype: ""
    id: "114"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    scriptarguments:
      AutoBlockIndicators:
        complex:
          root: inputs.AutoBlockIndicators
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      CustomBlockRule:
        simple: "True"
      CustomURLCategory:
        simple: Demisto Remediation - Malicious URLs
      IP:
        complex:
          accessor: DetectedExternalIPs
          root: PANWHunting
          transformers:
          - args:
              item:
                value:
                  simple: '(item: IP.Address)'
            operator: append
      InputEnrichment:
        simple: "False"
      LogForwarding:
        complex:
          root: inputs.LogForwarding
      MD5:
        complex:
          accessor: MD5
          root: File
      RuleDirection:
        simple: outbound
      RuleName:
        simple: XSOAR - Block Indicators playbook - ${incident.id}
      SHA256:
        complex:
          accessor: SHA256
          root: File
      URL:
        complex:
          accessor: Data
          root: URL
          transformers:
          - operator: uniq
      UserVerification:
        complex:
          root: inputs.UserVerification
      Username:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: username
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      device-group:
        complex:
          root: inputs.DeviceGroup
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |+
        This playbook blocks malicious Indicators using all integrations that are enabled, using the following sub-playbooks:

        - Block URL - Generic v2
        - Block Account - Generic v2
        - Block IP - Generic v3
        - Block File - Generic v2
        - Block Email - Generic
        - Block Domain - Generic

      id: dd4134b7-7d24-4e31-824e-ee5fba7ae8c7
      iscommand: false
      name: Block Indicators - Generic v3
      playbookId: Block Indicators - Generic v3
      type: playbook
      version: -1
    taskid: dd4134b7-7d24-4e31-824e-ee5fba7ae8c7
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2480,
          "y": 2310
        }
      }
  "115":
    continueonerrortype: ""
    id: "115"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      CustomBlockRule:
        simple: "True"
      IP:
        complex:
          accessor: ip
          root: Expense.Issue
      InputEnrichment:
        simple: "False"
      InternalRange:
        simple: ${inputs.InternalRange}
      LogForwarding:
        complex:
          root: inputs.LogForwarding
      RuleDirection:
        simple: outbound
      RuleName:
        simple: XSOAR - Block IP playbook - ${incident.id}
      UserVerification:
        simple: "True"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook blocks malicious IP addresses using all integrations
        that are enabled. The direction of the traffic that will be blocked is determined
        by the XSOAR user (and set by default to outgoing)\nNote the following:\n-
        \ some of those integrations require specific parameters to run, which are
        based on the playbook inputs. Also, certain integrations use FW rules or appended
        network objects.\n- Note that the appended network objects should be specified
        in blocking rules inside the system later on. \n\n\nSupported integrations
        for this playbook [Network security products such as FW/WAF/IPs/etc.]: \n\n*
        Check Point Firewall\n* Palo Alto Networks PAN-OS\n* Zscaler\n* FortiGate\n*
        Aria Packet Intelligence\n* Cisco Firepower \n* Cisco Secure Cloud Analytics\n*
        Cisco ASA\n* Akamai WAF\n* F5 SilverLine\n* ThreatX\n* Signal Sciences WAF\n*
        Sophos Firewall\n\n"
      id: 48339eeb-7c30-46db-83a3-e80e890befaa
      iscommand: false
      name: Block IP - Generic v3
      playbookId: Block IP - Generic v3
      type: playbook
      version: -1
    taskid: 48339eeb-7c30-46db-83a3-e80e890befaa
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2270,
          "y": 3220
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "43_33_#default#": 0.23,
      "43_50_yes": 0.65,
      "50_34_yes": 0.5,
      "50_57_#default#": 0.51,
      "75_45_#default#": 0.15,
      "75_70_yes": 0.65,
      "84_24_#default#": 0.35,
      "84_85_yes": 0.28,
      "90_19_#default#": 0.22,
      "90_76_yes": 0.29,
      "96_4_yes": 0.18,
      "96_97_#default#": 0.18
    },
    "paper": {
      "dimensions": {
        "height": 6035,
        "width": 5060,
        "x": -1090,
        "y": -990
      }
    }
  }
