contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: Hunt for endpoint activity involving hash and domain IOCs using Crowdstrike
  Falcon Host.\nAlso use AnalystEmail label to determine where to send an email alert
  if something is found.
id: 60e6ba07-ddd5-4fab-852d-9e9893145ade
inputs: []
name: TCS-CrowdStrike Rapid IOC Hunting v1.0
outputs: []
sourceplaybookid: CrowdStrike Rapid IOC Hunting v2
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 20ea238f-2462-4423-8ba8-f8fafe5d8a8f
      iscommand: false
      name: ""
      version: -1
    taskid: 20ea238f-2462-4423-8ba8-f8fafe5d8a8f
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 725,
          "y": -120
        }
      }
  "1":
    continueonerror: true
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        complex:
          accessor: Domain_Test_
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: f277e913-cb13-44ea-85dd-64e69bc9db3e
      iscommand: false
      name: Ae there domain to hunt
      script: Exists
      type: condition
      version: -1
    taskid: f277e913-cb13-44ea-85dd-64e69bc9db3e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 515
        }
      }
  "2":
    continueonerror: true
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        complex:
          accessor: MD5
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: a5a40bee-d209-40a5-8feb-1d66bccd6b0a
      iscommand: false
      name: Are thre MD5 to hunt
      script: Exists
      type: condition
      version: -1
    taskid: a5a40bee-d209-40a5-8feb-1d66bccd6b0a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 500,
          "y": 515
        }
      }
  "3":
    continueonerror: true
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        complex:
          accessor: SHA1
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 1f43daf1-6844-4c70-8b5b-92ef3f4306ed
      iscommand: false
      name: Are there SHA1 to hunt
      script: Exists
      type: condition
      version: -1
    taskid: 1f43daf1-6844-4c70-8b5b-92ef3f4306ed
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 960,
          "y": 515
        }
      }
  "4":
    continueonerror: true
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        complex:
          accessor: SHA256
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 0373c347-4a6c-4ed1-810a-6391175ce80e
      iscommand: false
      name: Are there SHA 256 to hunt
      script: Exists
      type: condition
      version: -1
    taskid: 0373c347-4a6c-4ed1-810a-6391175ce80e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 515
        }
      }
  "5":
    continueonerror: true
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      type:
        simple: domain
      value:
        simple: ${Domain.Name}
    separatecontext: false
    skipunavailable: false
    task:
      brand: FalconHost
      description: Returns a list of device IDs on which an indicator ran.
      id: 08fcc783-9d1c-4853-8fc7-7755a3a77da5
      iscommand: true
      name: Hunt for devices accessing bad domains
      script: FalconHost|||cs-device-ran-on
      type: regular
      version: -1
    taskid: 08fcc783-9d1c-4853-8fc7-7755a3a77da5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 710
        }
      }
  "6":
    continueonerror: true
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      type:
        simple: md5
      value:
        simple: ${File.MD5}
    separatecontext: false
    skipunavailable: false
    task:
      brand: FalconHost
      description: |
        Returns a list of device IDs on which an indicator ran.
      id: 51bdd569-dd31-4a94-841a-32d2e3c443b8
      iscommand: true
      name: Hunt for devices running MD5
      script: FalconHost|||cs-device-ran-on
      type: regular
      version: -1
    taskid: 51bdd569-dd31-4a94-841a-32d2e3c443b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 700
        }
      }
  "7":
    continueonerror: true
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      type:
        simple: sha1
      value:
        simple: ${File.SHA1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: FalconHost
      description: Returns a list of device IDs on which an indicator ran.
      id: b61768c6-1d44-4d54-84dd-b23ab9c03438
      iscommand: true
      name: Hunt for devices accessing SHA1
      script: FalconHost|||cs-device-ran-on
      type: regular
      version: -1
    taskid: b61768c6-1d44-4d54-84dd-b23ab9c03438
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 700
        }
      }
  "8":
    continueonerror: true
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      type:
        simple: sha256
      value:
        simple: ${File.SHA256}
    separatecontext: false
    skipunavailable: false
    task:
      brand: FalconHost
      description: Returns a list of device IDs on which an indicator ran.
      id: deeb9262-98a6-4f7a-8cc4-e859ca5e1608
      iscommand: true
      name: Hunt for devices accessing SHA256
      script: FalconHost|||cs-device-ran-on
      type: regular
      version: -1
    taskid: deeb9262-98a6-4f7a-8cc4-e859ca5e1608
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 690
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d697eb51-1384-4f3e-8b38-e7f29fa0e132
      iscommand: false
      name: Get device details and email
      type: title
      version: -1
    taskid: d697eb51-1384-4f3e-8b38-e7f29fa0e132
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 740,
          "y": 940
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      query:
        simple: ${FalconHostDevices}
      value:
        simple: ${FalconHostDevices}
    separatecontext: false
    skipunavailable: false
    task:
      brand: FalconHost
      description: Enrcich device information.
      id: bd068867-2c9c-41ea-8260-aad9eef6431d
      iscommand: true
      name: Get device details
      script: FalconHost|||cs-device-search
      type: regular
      version: -1
    taskid: bd068867-2c9c-41ea-8260-aad9eef6431d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1260
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: 'Hello,\nPlease review Cortex XSOAR incident "${incident.name} # ${incident.id}
          " - results are waiting for you.'
      subject:
        simple: 'Cortex XSOAR incident ${incident.name} # ${incident.id}'
      to:
        simple: ${incident.labels.AnalystEmail}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 16c4fdd5-b1b2-4061-8c49-4f79013e220c
      iscommand: false
      name: ""
      version: -1
    taskid: 16c4fdd5-b1b2-4061-8c49-4f79013e220c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1430
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Review incident information
      id: 1513369a-f2a4-412d-8d01-ddcc01a3c3ff
      iscommand: false
      name: Analyst - review information
      type: regular
      version: -1
    taskid: 1513369a-f2a4-412d-8d01-ddcc01a3c3ff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1605
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${FalconHostDevices}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Conditional task to verify if devices found with suspicious indicator
      id: 4181776b-15fe-424a-8a30-32362a0e3200
      iscommand: false
      name: Found any devices?
      script: Exists
      type: condition
      version: -1
    taskid: 4181776b-15fe-424a-8a30-32362a0e3200
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1090
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2f4cc0e9-41e4-4dc9-870d-3c388beed193
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 2f4cc0e9-41e4-4dc9-870d-3c388beed193
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1840
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${modules(val.brand == 'FalconHost' && val.state == 'active')}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: dfc47282-55ee-47c2-8fa3-93d541054fd5
      iscommand: false
      name: Is FalconHost enabled?
      script: Exists
      type: condition
      version: -1
    taskid: dfc47282-55ee-47c2-8fa3-93d541054fd5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 725,
          "y": 180
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
      - "2"
      - "3"
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 78160a40-b214-4ad1-8a73-e0a67237ad76
      iscommand: false
      name: Hunt for indicators
      type: title
      version: -1
    taskid: 78160a40-b214-4ad1-8a73-e0a67237ad76
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 725,
          "y": 360
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: aef214ba-4f39-4fd9-8af4-ba25e3c82a10
      iscommand: true
      name: Extract Indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: aef214ba-4f39-4fd9-8af4-ba25e3c82a10
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 725,
          "y": 10
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "14_11_yes": 0.55,
      "4_8_yes": 0.56
    },
    "paper": {
      "dimensions": {
        "height": 2025,
        "width": 1730,
        "x": 50,
        "y": -120
      }
    }
  }
