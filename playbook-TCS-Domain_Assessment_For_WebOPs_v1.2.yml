contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
hidden: true
id: 1f490f9a-43f2-47a1-8129-772d689b92f1
inputs: []
name: TCS-Domain Assessment For WebOPs v1.2
outputs: []
sourceplaybookid: 08c3b260-77a7-4316-8c5d-802cc55f4e22
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cd7d2be9-7ac8-4d4a-8c3b-f9b085b05973
      iscommand: false
      name: ""
      version: -1
    taskid: cd7d2be9-7ac8-4d4a-8c3b-f9b085b05973
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 460,
          "y": -740
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 49a9994d-d91f-442f-8f09-bd488527d98e
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 49a9994d-d91f-442f-8f09-bd488527d98e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 570,
          "y": 1610
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "85"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name:
        simple: IOC Threat Intel
      type:
        simple: pdf
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: 3681f8df-d499-4ec4-822d-d44dfd42c2a7
      iscommand: false
      name: Generate Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: 3681f8df-d499-4ec4-822d-d44dfd42c2a7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1000
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${InfoFile.EntryID}
      body:
        simple: |-
          Hello Human,

          My assessment has found the domain(s) to be CLEAN. And can be allowed on the proxy. Attached report for your reference.

           Accessed Domain/URL/IP: ${ExtractedIndicators.Domain_Test_},${ExtractedIndicators.IP}

          Investigation Id:  ${incident.id}


          Regards,
          Cyber AutoBot
          Internal IT Cyber Security
      cc:
        simple: internalis.cybersecurityops@tcs.com,yogesh.gholap@tcs.com,kunal.krushev@tcs.com
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: '*URL CLEAN* WebOps URL Investigation Summary - ${incident.id}'
      to:
        simple: InternalIS.SecOpsL2Support@tcs.com
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 5c007bc4-70f3-42bf-8911-bd9daf0a3351
      iscommand: true
      name: Notification To WebOps Team That Domain(s) is Clean
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 5c007bc4-70f3-42bf-8911-bd9daf0a3351
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 900,
          "y": 1430
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${InfoFile.EntryID}
      body:
        simple: |-
          Hello Human,

          My assessment has found the domain(s) to be SUSPICIOUS and needs to be further investigated by the CSOC Team

          CSOC Team, PFA my assessment report. Please investigate if the domain(s) can be allowed on the proxy, and share results with the CSOC manager.

          Submitted Domain/URL/IP : ${ExtractedIndicators.Domain_Test_},${ExtractedIndicators.IP}

          Suspicious URL : ${SuspiciousDomainRF},${SuspiciousIPRF},${SuspiciousDomainUmbrella},${SuspiciousIPUmbrella}

          Investigation Id - ${incident.id}


          Regards,
          Cyber AutoBot
          Internal IT Cyber Security
      cc:
        simple: yogesh.gholap@tcs.com,kunal.krushev@tcs.com
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: '*Domain Suspicious* WebOps URL Investigation Summary - ${incident.id}'
      to:
        simple: InternalIS.SecOpsL2Support@tcs.com,internalis.cybersecurityops@tcs.com
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: c0fcf6b5-9647-4ec9-8374-9e05bdd6c7f6
      iscommand: true
      name: 'Notification To CSOC Team To Further Investigate The Suspicious Domain(s) '
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: c0fcf6b5-9647-4ec9-8374-9e05bdd6c7f6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 360,
          "y": 1430
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 582a5ba3-aa7c-4fe9-8fa0-7612e27479fc
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 582a5ba3-aa7c-4fe9-8fa0-7612e27479fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 570,
          "y": 1760
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ffce7eb1-5ece-4dcd-8ba3-c2a7183c93f3
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: ffce7eb1-5ece-4dcd-8ba3-c2a7183c93f3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 570,
          "y": 1930
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: a8967c2c-38bb-46c7-8a19-6a5c8ee6862b
      iscommand: true
      name: Recorded Future Enrichment
      script: Recorded Future v2|||domain
      type: regular
      version: -1
    taskid: a8967c2c-38bb-46c7-8a19-6a5c8ee6862b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 370
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Investigate
      description: Get Domain Reputation info using Cisco Umbrella Investigate. Domain
        reputation score is either true or false from the service and cannot be modified
        using a threshold.
      id: 74dc3a8f-d4aa-48a8-816f-05811f03c2c0
      iscommand: true
      name: Cisco Umbrella Enrichment
      script: Cisco Umbrella Investigate|||domain
      type: regular
      version: -1
    taskid: 74dc3a8f-d4aa-48a8-816f-05811f03c2c0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 510
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: f3a520e6-f268-4ad8-8fed-1207037fac51
      iscommand: true
      name: Extract indicator from file
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: f3a520e6-f268-4ad8-8fed-1207037fac51
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": -370
        }
      }
  "76":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_}
          operator: containsString
          right:
            value:
              simple: .quest.com
        - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_}
          operator: containsString
          right:
            value:
              simple: .slack.com
      label: "yes"
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cdd663ef-ea71-4c54-80a6-197cfc41cc2d
      iscommand: false
      name: Check if domain belongs to Quest or slack
      type: condition
      version: -1
    taskid: cdd663ef-ea71-4c54-80a6-197cfc41cc2d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 10,
          "y": 170
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a domain.
      id: b23849bd-334b-4b91-8413-2c2322cb47d4
      iscommand: true
      name: Recorded Future Enrichment
      script: Recorded Future v2|||domain
      type: regular
      version: -1
    taskid: b23849bd-334b-4b91-8413-2c2322cb47d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 370
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Investigate
      description: Get Domain Reputation info using Cisco Umbrella Investigate. Domain
        reputation score is either true or false from the service and cannot be modified
        using a threshold.
      id: 787e0c11-a5e1-4c79-887b-8eb90a1bdd60
      iscommand: true
      name: Cisco Umbrella Enrichment
      script: Cisco Umbrella Investigate|||domain
      type: regular
      version: -1
    taskid: 787e0c11-a5e1-4c79-887b-8eb90a1bdd60
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 520
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "80"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name:
        simple: IOC Threat Intel
      type:
        simple: pdf
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: 16e74585-aed7-4c99-8745-7bc3cfd1fd4c
      iscommand: false
      name: Generate Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: 16e74585-aed7-4c99-8745-7bc3cfd1fd4c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 700
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${InfoFile.EntryID}
      body:
        simple: "Hello Human,\n\nThe Domain found contain Slack or Quest domain. Please
          take necessary action.\n\nDomain is ${ExtractedIndicators.Domain_Test_}
          \n\nPFA  Investigation Summary Report for Incident ${incident.id}\n\n\nRegards,\nCSOC
          Cyber Bot"
      cc:
        simple: sonam.bhandari@tcs.com , InternalIS.SecOpsL2Support@tcs.com
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: WebOps URL Investigation Summary - ${incident.id} contain Slack or
          Quest
      to:
        simple: yogesh.gholap@tcs.com,kunal.krushev@tcs.com
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: acc92582-fbeb-4ecf-8a34-dc005b19fe82
      iscommand: true
      name: Email Report Summary For  URL contains Slack or Quest
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: acc92582-fbeb-4ecf-8a34-dc005b19fe82
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -160,
          "y": 1240
        }
      }
  "81":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_}
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.IP}
          operator: isExists
      label: Both
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.IP}
          operator: isExists
      label: IP
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_}
          operator: isExists
      label: Domain
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "82"
      Both:
      - "95"
      Domain:
      - "76"
      IP:
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8a675104-f3bb-465e-8216-55197bcd3619
      iscommand: false
      name: what is there in aattachment?
      type: condition
      version: -1
    taskid: 8a675104-f3bb-465e-8216-55197bcd3619
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": -190
        }
      }
  "82":
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${.=val.File.filter(function(f){return f.EntryID;}).reduce(function(acc,
          f) {return f;}, null).EntryID}
      body:
        simple: |-
          Hello Human,

          I am unable to serve you as there is no URL in the attachment  of the email.


          Regards,
          CSOC Cyber Bot
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: WebOps URL Investigation Summary - ${incident.id} No URL present in
          email
      to:
        simple: InternalIS.SecOpsL2Support@tcs.com
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 629c3d1c-7aaa-4795-8645-64b9e62f20e7
      iscommand: true
      name: Email team no URL to investigate
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 629c3d1c-7aaa-4795-8645-64b9e62f20e7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 1190
        }
      }
  "83":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: InternalIS.SecOpsL2Support@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: sonam.bhandari@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: v.ghule@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: kunal.krushev@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: yogesh.gholap@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "84"
      "yes":
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 50e1abc6-84b1-4e08-8c6d-f4d782430691
      iscommand: false
      name: Is the email from Authorized sender ?
      type: condition
      version: -1
    taskid: 50e1abc6-84b1-4e08-8c6d-f4d782430691
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": -600
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${.=val.File.filter(function(f){return f.EntryID;}).reduce(function(acc,
          f) {return f;}, null).EntryID}
      body:
        simple: |-
          Hello Human,

          Your email id is not on my authorized sender list. I'm currently only taking requests from "InternalIS.SecOpsL2Support@tcs.com"

          Regards,
          Cyber AutoBot
          Internal IT Cyber Security
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
      subject:
        simple: Not an Authorized Sender
      to:
        simple: ${incident.labels.Email/from}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: fb7dfb3c-6f03-47d6-8bbe-b5330c7aa91d
      iscommand: true
      name: Not an authorised sender
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: fb7dfb3c-6f03-47d6-8bbe-b5330c7aa91d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1850,
          "y": 1170
        }
      }
  "85":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${SuspiciousDomainRF}
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: ${SuspiciousDomainUmbrella}
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "31"
      "yes":
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 83c93dda-1b38-4d8d-834e-005022d47493
      iscommand: false
      name: If Risk score is not Zero
      type: condition
      version: -1
    taskid: 83c93dda-1b38-4d8d-834e-005022d47493
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1180
        }
      }
  "86":
    continueonerror: true
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "87"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SuspiciousDomainRF
      value:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.Domain.riskScore
              operator: isNotEqualNumber
              right:
                value:
                  simple: "0"
          root: RecordedFuture.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 07d965d3-bd5a-4d06-8fad-185cc0cdf387
      iscommand: false
      name: Set SuspiciousDomainRF
      script: Set
      type: regular
      version: -1
    taskid: 07d965d3-bd5a-4d06-8fad-185cc0cdf387
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 650
        }
      }
  "87":
    continueonerror: true
    continueonerrortype: ""
    id: "87"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SuspiciousDomainUmbrella
      value:
        complex:
          accessor: Name}
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ${Domain.Umbrella.RiskScore}
              operator: isNotEqualNumber
              right:
                value:
                  simple: "0"
          root: ${Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 449e75ba-1a88-43e5-80f3-ef895887c068
      iscommand: false
      name: Set SuspiciousDomainUmbrella
      script: Set
      type: regular
      version: -1
    taskid: 449e75ba-1a88-43e5-80f3-ef895887c068
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 830
        }
      }
  "89":
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${ExtractedIndicators.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with an IP address.
      id: 3e9c5d96-b601-4f75-803f-2eac7e9f147f
      iscommand: true
      name: Recorded Future Enrichment
      script: Recorded Future v2|||ip
      type: regular
      version: -1
    taskid: 3e9c5d96-b601-4f75-803f-2eac7e9f147f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": 210
        }
      }
  "90":
    continueonerror: true
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "92"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${ExtractedIndicators.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: AutoFocus V2
      description: Checks the reputation of an IP address in AutoFocus.
      id: ae66b45f-a7e8-48bc-83f2-a238a5b90066
      iscommand: true
      name: AutoFocus Enrichment
      script: AutoFocus V2|||ip
      type: regular
      version: -1
    taskid: ae66b45f-a7e8-48bc-83f2-a238a5b90066
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": 510
        }
      }
  "91":
    continueonerror: true
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SuspiciousIPAutoFocus
      value:
        complex:
          accessor: IndicatorValue}
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ${AutoFocus.IP.LatestPanVerdicts.PAN_DB}
              operator: isNotEqualString
              right:
                value:
                  simple: BENIGN
          root: ${AutoFocus.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 65303750-2d71-4978-8278-8dc6f7ea758a
      iscommand: false
      name: Set SuspiciousIPAutoFocus
      script: Set
      type: regular
      version: -1
    taskid: 65303750-2d71-4978-8278-8dc6f7ea758a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": 830
        }
      }
  "92":
    continueonerror: true
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SuspiciousIPRF
      value:
        complex:
          accessor: name}
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ${RecordedFuture.IP.riskScore}
              operator: isNotEqualNumber
              right:
                value:
                  simple: "0"
          root: ${RecordedFuture.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d976a31c-f682-49ea-86e2-f9a0b0899637
      iscommand: false
      name: Set SuspiciousIPRF
      script: Set
      type: regular
      version: -1
    taskid: d976a31c-f682-49ea-86e2-f9a0b0899637
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": 670
        }
      }
  "93":
    continueonerrortype: ""
    id: "93"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name:
        simple: IOC Threat Intel
      type:
        simple: pdf
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: 8ac1d94a-0821-4bca-8493-3af14e5781e6
      iscommand: false
      name: Generate Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: 8ac1d94a-0821-4bca-8493-3af14e5781e6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": 1000
        }
      }
  "94":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${SuspiciousIPRF}
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: ${SuspiciousIPAutoFocus}
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "31"
      "yes":
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fcd8e550-eb03-4564-8ce3-e3d26cf276ca
      iscommand: false
      name: If Risk score is not Zero
      type: condition
      version: -1
    taskid: fcd8e550-eb03-4564-8ce3-e3d26cf276ca
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 870,
          "y": 1180
        }
      }
  "95":
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "76"
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b12c34dc-7f14-4f58-851d-302e9cbd63d6
      iscommand: false
      name: Both IP and Domain are present
      type: title
      version: -1
    taskid: b12c34dc-7f14-4f58-851d-302e9cbd63d6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 70
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2735,
        "width": 2390,
        "x": -160,
        "y": -740
      }
    }
  }
