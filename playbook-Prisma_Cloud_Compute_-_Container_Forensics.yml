contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.10.0
    itemVersion: 1.7.4
    packID: PrismaCloudCompute
    packName: Prisma Cloud Compute by Palo Alto Networks
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: |-
  This is a sub-playbook of the "Prisma Cloud Compute - Audit Alert v2" playbook.
  Gets the container profile and forensics.
id: Prisma Cloud Compute - Container Forensics
inputs:
- description: The audit alert type.
  key: AuditAlertType
  playbookInputQuery: null
  required: false
  value: {}
- description: Image name.
  key: Image
  playbookInputQuery: null
  required: false
  value: {}
- description: The defender type.
  key: DefenderType
  playbookInputQuery: null
  required: false
  value: {}
- description: The alert's cluster name.
  key: AlertCluster
  playbookInputQuery: null
  required: false
  value: {}
- description: The hostname.
  key: Hostname
  playbookInputQuery: null
  required: false
  value: {}
- description: This link exists in audit runtime incidents.
  key: ForensicLink
  playbookInputQuery: null
  required: false
  value: {}
name: Prisma Cloud Compute - Container Forensics
outputs: []
quiet: true
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 78849801-94db-4ca1-8b81-fdc547777e13
      iscommand: false
      name: ""
      version: -1
    taskid: 78849801-94db-4ca1-8b81-fdc547777e13
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 250,
          "y": 90
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      image:
        complex:
          root: inputs.Image
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get information about the containers and their profile events.
        This command supports asterisks which allows you to get container profiles
        by filtering its fields according to a specific substring.
      id: 0dce6302-4741-4387-89b8-ae752a0c605c
      iscommand: true
      name: Get container profile
      script: '|||prisma-cloud-compute-profile-container-list'
      tags:
      - forensics
      type: regular
      version: -1
    taskid: 0dce6302-4741-4387-89b8-ae752a0c605c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 660
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          root: inputs.Hostname
      id:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: PrismaCloudCompute.ProfileContainer._id
              operator: containsGeneral
              right:
                iscontext: true
                value:
                  simple: inputs.AlertCluster
          root: PrismaCloudCompute.ProfileContainer._id
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get runtime forensics data for a specific container on a specific
        host
      id: 498dd99f-42a3-4732-8192-235613be6e21
      iscommand: true
      name: Get container forensics
      script: '|||prisma-cloud-compute-profile-container-forensic-list'
      tags:
      - forensics
      type: regular
      version: -1
    taskid: 498dd99f-42a3-4732-8192-235613be6e21
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1220
        }
      }
  "3":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.AuditAlertType
          operator: containsGeneral
          right:
            value:
              simple: container
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Image
          operator: isNotEmpty
      label: Container
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      Container:
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fb0b1ecf-71f9-452a-8dab-c1814ddf98de
      iscommand: false
      name: Check alert type
      type: condition
      version: -1
    taskid: fb0b1ecf-71f9-452a-8dab-c1814ddf98de
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 250
        }
      }
  "4":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.DefenderType
          operator: startWith
          right:
            value:
              simple: server
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "1"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 39c41666-e0a5-4193-8283-ecbf57d35743
      iscommand: false
      name: Check if defender type is server
      type: condition
      version: -1
    taskid: 39c41666-e0a5-4193-8283-ecbf57d35743
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 460
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9cc4a280-94ad-4d29-81ca-743edd8fbcf0
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 9cc4a280-94ad-4d29-81ca-743edd8fbcf0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 250,
          "y": 1400
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.ForensicLink
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c0c53de6-3a0d-45ba-87cc-47aef8e36a5c
      iscommand: false
      name: Forensic link exists?
      type: condition
      version: -1
    taskid: c0c53de6-3a0d-45ba-87cc-47aef8e36a5c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 830
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ContainerID
      value:
        complex:
          root: inputs.ForensicLink
          transformers:
          - args:
              delimiter:
                value:
                  simple: container/
              fields:
                value:
                  simple: "2"
            operator: Cut
          - args:
              delimiter:
                value:
                  simple: /forensic
              fields:
                value:
                  simple: "1"
            operator: Cut
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 2d178d2d-57f0-498a-89a3-7972faf323de
      iscommand: false
      name: Extract container id
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 2d178d2d-57f0-498a-89a3-7972faf323de
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1030
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          root: inputs.Hostname
      id:
        complex:
          root: ContainerID
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get runtime forensics data for a specific container on a specific
        host
      id: 5033cbbc-5694-4e86-8d06-20b0d00f8b7e
      iscommand: true
      name: Get container forensics
      script: '|||prisma-cloud-compute-profile-container-forensic-list'
      tags:
      - forensics
      type: regular
      version: -1
    taskid: 5033cbbc-5694-4e86-8d06-20b0d00f8b7e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1220
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "3_4_Container": 0.37,
      "3_5_#default#": 0.16,
      "4_1_#default#": 0.43,
      "4_5_yes": 0.1,
      "6_2_#default#": 0.28,
      "6_7_yes": 0.51
    },
    "paper": {
      "dimensions": {
        "height": 1375,
        "width": 1040,
        "x": 250,
        "y": 90
      }
    }
  }
