contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.10.0
    itemVersion: 1.7.4
    packID: PrismaCloudCompute
    packName: Prisma Cloud Compute by Palo Alto Networks
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: |-
  Default playbook for parsing and enrichment of Prisma Cloud Compute audit alerts.
  The playbook has the following sections:
  Enrichment:
  - Image details
  - Similar container events
  - Owner details
  - Vulnerabilities
  - Compliance details
  - Forensics
  - Defender logs.

  Remediation:
  - Block Indicators - Generic v3
  - Cloud Response - Generic
  - Manual Remediation.

  Currently, the playbook supports incidents created by **Runtime** and **WAAS** triggers.
id: Prisma Cloud Compute - Audit Alert v3
inputs:
- description: |-
    The base URL of the Prisma Cloud Compute Instance used to create a link back to the alerts for an image.
    For example: https://app.prismacloud.io
  key: baseUrl
  playbookInputQuery: null
  required: false
  value: {}
- description: A specific project name to get alert profiles for
  key: Project
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Project
      root: PrismaCloudCompute.AlertProfiles.ServiceNow
- description: |-
    Relevant to the "Block Indicators - Generic v3" playbook.
    Possible values: True/False.  Default: True.
    Should the given indicators be automatically blocked, or should the user be given the option to choose?

    If set to False - no prompt will appear, and all provided indicators will be blocked automatically.
    If set to True - the user will be prompted to select which indicators to block.
  key: AutoBlockIndicators
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: |-
    Relevant to the "Cloud Response - Generic playbook".
    Whether to execute the resource remediation flow automatically.
    Available options:
    - True
    - False
  key: autoResourceRemediation
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: |
    Relevant to the "Cloud Response - Generic playbook".
    Available options:
    - Stop
    - Delete
  key: resourceRemediationType
  playbookInputQuery: null
  required: false
  value:
    simple: Stop
- description: |-
    Relevant to the "Cloud Response - Generic playbook".
    Whether to execute the access key remediation flow automatically.
    Available options:
    - True
    - False
  key: autoAccessKeyRemediation
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: |-
    Relevant to the "Cloud Response - Generic playbook".
    Choose the remediation type for the user's access key.
    Available types:
    Disable - for disabling the user's access key.
    Delete - for the user's access key deletion.
  key: accessKeyRemediationType
  playbookInputQuery: null
  required: false
  value:
    simple: Disable
- description: |-
    Relevant to the "Cloud Response - Generic playbook".
    Whether to execute the user remediation flow automatically.
    Choose the remediation type for the user involved.

    - Disable - for disabling the user (GCP + Azure) or revoking the user's credentials (AWS).
    - Delete - for deleting the user.
  key: userRemediationType
  playbookInputQuery: null
  required: false
  value:
    simple: Disable
- description: |-
    Relevant to the "Cloud Response - Generic playbook".
    Whether to execute the user remediation flow automatically.
    Available options:
    - True
    - False
  key: autoUserRemediation
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: |-
    Whether to run the Cloud Response - Generic playbook.
    Available options:
    - True
    - False
  key: AdvancedCloudResponseFlow
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: |-
    Whether to allow the analyst to manually review the alert before the playbook ends.
    Available options:
        - True
        - False
  key: PauseForReview
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
name: Prisma Cloud Compute - Audit Alert v3
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cf0a785f-613d-4365-8b3d-7d6e4a1b904c
      iscommand: false
      name: ""
      version: -1
    taskid: cf0a785f-613d-4365-8b3d-7d6e4a1b904c
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 132.5,
          "y": -270
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "92"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 30634963-65c8-459d-8c88-bd23405c5bc5
      iscommand: false
      name: Vulnerability
      type: title
      version: -1
    taskid: 30634963-65c8-459d-8c88-bd23405c5bc5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -100,
          "y": 450
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 30a5db4e-10be-45ed-899b-85177f7b55ec
      iscommand: false
      name: Compliance
      type: title
      version: -1
    taskid: 30a5db4e-10be-45ed-899b-85177f7b55ec
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 352.5,
          "y": 450
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "82"
      - "85"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b9608d40-c531-44c7-832f-271bb1e017b0
      iscommand: false
      name: Remediation
      type: title
      version: -1
    taskid: b9608d40-c531-44c7-832f-271bb1e017b0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 122.5,
          "y": 2090
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 7089537e-4d24-43d9-8b70-55ad792faa01
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 7089537e-4d24-43d9-8b70-55ad792faa01
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 122.5,
          "y": 3060
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 719b0edc-d837-4415-8d4b-d3f9dc13d157
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 719b0edc-d837-4415-8d4b-d3f9dc13d157
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 122.5,
          "y": 3260
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "96"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9d8b387d-d0e2-4945-8ad6-f6da20257cf3
      iscommand: false
      name: Forensics
      type: title
      version: -1
    taskid: 9d8b387d-d0e2-4945-8ad6-f6da20257cf3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 122.5,
          "y": 805
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          accessor: prismacloudcomputehost
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get information about the hosts and their profile events. This
        command supports asterisks which allows you to get host profiles by filtering
        its fields according to a specific substring.
      id: a120fb5c-4ba7-4c21-890f-a637d3a639b2
      iscommand: true
      name: Get Host Profile
      script: '|||prisma-cloud-compute-profile-host-list'
      type: regular
      version: -1
    taskid: a120fb5c-4ba7-4c21-890f-a637d3a639b2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 1720
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Perform manual remediation to ensure full incident resolution
      id: f203322f-2774-4db8-870f-86b8a328abe5
      iscommand: false
      name: Manually Review
      type: regular
      version: -1
    taskid: f203322f-2774-4db8-870f-86b8a328abe5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 420,
          "y": 2880
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          accessor: prismacloudcomputehost
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve a list of defenders and their information.
      id: 3ff6b6fc-ef9f-4a02-829f-c2d0861d70d9
      iscommand: true
      name: 'Get host''s defenders list '
      script: '|||prisma-cloud-compute-defenders-list'
      type: regular
      version: -1
    taskid: 3ff6b6fc-ef9f-4a02-829f-c2d0861d70d9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 122.5,
          "y": 1180
        }
      }
  "60":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: DefenderDetails
                root: PrismaCloudCompute
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "63"
      - "72"
      - "73"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6dd6182c-c17a-4238-8339-36c389b3945e
      iscommand: false
      name: Check if there's a defender on the host
      type: condition
      version: -1
    taskid: 6dd6182c-c17a-4238-8339-36c389b3945e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 122.5,
          "y": 1380
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      id:
        complex:
          accessor: prismacloudcomputehost
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get forensics on a specific host.
      id: ac792c52-b152-46f9-8a2e-11477b39d650
      iscommand: true
      name: Get host forensic
      script: '|||prisma-cloud-compute-host-forensic-list'
      tags:
      - forensics
      type: regular
      version: -1
    taskid: ac792c52-b152-46f9-8a2e-11477b39d650
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 1910
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fff05ff0-dbd6-4597-8f4a-58e36122b981
      iscommand: false
      name: Get defender logs
      type: title
      version: -1
    taskid: fff05ff0-dbd6-4597-8f4a-58e36122b981
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 122.5,
          "y": 1580
        }
      }
  "72":
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6656b168-ce74-499b-8e5d-0976d950f857
      iscommand: false
      name: Container Forensics
      type: title
      version: -1
    taskid: 6656b168-ce74-499b-8e5d-0976d950f857
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -377.5,
          "y": 1580
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 30b21f2f-548a-4035-89fa-8daef7690c3c
      iscommand: false
      name: Host Forensics
      type: title
      version: -1
    taskid: 30b21f2f-548a-4035-89fa-8daef7690c3c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 1580
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      Hostname:
        complex:
          accessor: prismacloudcomputehost
          root: incident
      Project:
        complex:
          root: inputs.Project
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This is a sub-playbook of the “Prisma Cloud Compute - Audit Alert v2” playbook
        - Gets defender logs and sets them to layout
        - Downloads defender logs
        - Gets defender backups.
      id: b1799d2a-a668-45ea-89e1-bfd9cefa0d3e
      iscommand: false
      name: Prisma Cloud Compute - Get Defender Logs
      playbookId: Prisma Cloud Compute - Get Defender Logs
      type: playbook
      version: -1
    taskid: b1799d2a-a668-45ea-89e1-bfd9cefa0d3e
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 122.5,
          "y": 1790
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      AlertCluster:
        complex:
          accessor: prismacloudcomputecluster
          root: incident
      AuditAlertType:
        complex:
          accessor: category
          root: PrismaCloudCompute.DefenderDetails
      DefenderType:
        complex:
          accessor: type
          root: PrismaCloudCompute.DefenderDetails
      ForensicLink:
        complex:
          accessor: prismacloudcomputeforensic
          root: incident
      Hostname:
        complex:
          accessor: prismacloudcomputehost
          root: incident
      Image:
        complex:
          accessor: prismacloudcomputeimage
          root: incident
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This is a sub-playbook of the "Prisma Cloud Compute - Audit Alert v2" playbook.
        Gets the container profile and forensics.
      id: 9f958f9c-d881-4b46-8098-583835b6089b
      iscommand: false
      name: Prisma Cloud Compute - Container Forensics
      playbookId: Prisma Cloud Compute - Container Forensics
      type: playbook
      version: -1
    taskid: 9f958f9c-d881-4b46-8098-583835b6089b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -377.5,
          "y": 1790
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      ComplianceIssues:
        complex:
          accessor: complianceIssues
          root: PrismaCloudCompute.ReportsImagesScan
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: PrismaCloudCompute.ReportHostScan.complianceIssues
            operator: SetIfEmpty
      Project:
        complex:
          root: inputs.Project
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This is a sub-playbook of the "Prisma Cloud Compute - Audit Alert v2" playbook.
        Retrieves the following information:
        - Alert profiles
        - Container WAAS policies
        - Image compliance issues
      id: f53bbd8c-a8a2-464a-860c-20f9461dce84
      iscommand: false
      name: Prisma Cloud Compute - Audit Alert Compliance Enrichment
      playbookId: Prisma Cloud Compute - Audit Alert Compliance Enrichment
      type: playbook
      version: -1
    taskid: f53bbd8c-a8a2-464a-860c-20f9461dce84
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 352.5,
          "y": 610
        }
      }
  "82":
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      AutoBlockIndicators:
        complex:
          root: inputs.AutoBlockIndicators
      AutoCommit:
        simple: "No"
      CustomBlockRule:
        simple: "True"
      CustomURLCategory:
        simple: XSOAR Remediation - Malicious URLs
      DomainToBlock:
        complex:
          accessor: Indicator
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: domain
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      EmailToBlock:
        complex:
          accessor: Indicator
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: email
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      FilesToBlock:
        complex:
          accessor: Indicator
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: file
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      IP:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: ip
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      InputEnrichment:
        simple: "False"
      MD5:
        complex:
          accessor: Indicator
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Indicator
              operator: stringHasLength
              right:
                value:
                  simple: "32"
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: file
            - left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: hash
          root: DBotScore
          transformers:
          - operator: uniq
      RuleDirection:
        simple: outbound
      RuleName:
        simple: XSOAR - Block Indicators playbook - ${incident.id}
      SHA256:
        complex:
          accessor: Indicator
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Indicator
              operator: stringHasLength
              right:
                value:
                  simple: "64"
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: file
            - left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: hash
          root: DBotScore
          transformers:
          - operator: uniq
      Tag:
        simple: Blocked Indicator In Systems
      URL:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: url
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      UserVerification:
        simple: "True"
      Username:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: username
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: |-
        This playbook blocks malicious indicators using all integrations that are enabled, using the following sub-playbooks:

        - Block URL - Generic v2
        - Block Account - Generic v2
        - Block IP - Generic v3
        - Block File - Generic v2
        - Block Email - Generic v2
        - Block Domain - Generic v2.
      id: 982cf912-0bc2-4661-8638-10c8b8e18e15
      iscommand: false
      name: Block Indicators - Generic v3
      playbookId: Block Indicators - Generic v3
      type: playbook
      version: -1
    taskid: 982cf912-0bc2-4661-8638-10c8b8e18e15
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 342.5,
          "y": 2270
        }
      }
  "83":
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      AWS-accessKeyRemediationType:
        complex:
          root: inputs.accessKeyRemediationType
      AWS-resourceRemediationType:
        complex:
          root: inputs.resourceRemediationType
          transformers:
          - args:
              condition:
                value:
                  simple: lhs==rhs
              conditionB: {}
              conditionInBetween: {}
              else:
                iscontext: true
                value:
                  simple: inputs.resourceRemediationType
              equals: {}
              lhs:
                iscontext: true
                value:
                  simple: inputs.resourceRemediationType
              lhsB: {}
              options: {}
              optionsB: {}
              rhs:
                value:
                  simple: Delete
              rhsB: {}
              then:
                value:
                  simple: Terminate
            operator: If-Then-Else
      AWS-userRemediationType:
        complex:
          root: inputs.userRemediationType
          transformers:
          - args:
              condition:
                value:
                  simple: lhs==rhs
              conditionB: {}
              conditionInBetween: {}
              else:
                iscontext: true
                value:
                  simple: inputs.userRemediationType
              equals: {}
              lhs:
                iscontext: true
                value:
                  simple: inputs.userRemediationType
              lhsB: {}
              options: {}
              optionsB: {}
              rhs:
                value:
                  simple: Disable
              rhsB: {}
              then:
                value:
                  simple: Revoke
            operator: If-Then-Else
      Azure-resourceRemediationType:
        complex:
          root: inputs.resourceRemediationType
          transformers:
          - args:
              condition:
                value:
                  simple: lhs==rhs
              conditionB: {}
              conditionInBetween: {}
              else:
                iscontext: true
                value:
                  simple: inputs.resourceRemediationType
              equals: {}
              lhs:
                iscontext: true
                value:
                  simple: inputs.resourceRemediationType
              lhsB: {}
              options: {}
              optionsB: {}
              rhs:
                value:
                  simple: Stop
              rhsB: {}
              then:
                value:
                  simple: Poweroff
            operator: If-Then-Else
      Azure-userRemediationType:
        complex:
          root: inputs.userRemediationType
      GCP-accessKeyRemediationType:
        complex:
          root: inputs.accessKeyRemediationType
      GCP-resourceRemediationType:
        complex:
          root: inputs.resourceRemediationType
      GCP-userRemediationType:
        complex:
          root: inputs.userRemediationType
      autoAccessKeyRemediation:
        complex:
          root: inputs.autoAccessKeyRemediation
      autoBlockIndicators:
        simple: "False"
      autoResourceRemediation:
        complex:
          root: inputs.autoResourceRemediation
      autoUserRemediation:
        complex:
          root: inputs.autoUserRemediation
      cloudProvider:
        complex:
          accessor: provider
          root: PrismaCloudCompute.DefenderDetails.cloudMetadata
      resourceGroup:
        complex:
          accessor: resourceID
          root: PrismaCloudCompute.DefenderDetails.cloudMetadata
          transformers:
          - args:
              delimiter:
                value:
                  simple: /resourceGroups/
              fields:
                value:
                  simple: "2"
            operator: Cut
          - args:
              delimiter:
                value:
                  simple: /
              fields:
                value:
                  simple: "1"
            operator: Cut
      resourceName:
        complex:
          accessor: name
          root: PrismaCloudCompute.DefenderDetails.cloudMetadata
      resourceZone:
        complex:
          accessor: region
          root: PrismaCloudCompute.DefenderDetails.cloudMetadata
      username:
        complex:
          accessor: prismacloudcomputeuser
          root: incident
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: |-
        This playbook provides response playbooks for:
        - AWS
        - Azure
        - GCP

        The response actions available are:
        - Terminate/Shut down/Power off an instance
        - Delete/Disable a user
        - Delete/Revoke/Disable credentials
        - Block indicators
      id: 30c3ac07-637e-435a-8ff4-0468b40d75c9
      iscommand: false
      name: Cloud Response - Generic
      playbookId: Cloud Response - Generic
      type: playbook
      version: -1
    taskid: 30c3ac07-637e-435a-8ff4-0468b40d75c9
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -110,
          "y": 2470
        }
      }
  "85":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.AdvancedCloudResponseFlow
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "93"
      "yes":
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c49230e2-fca1-40c5-8aeb-c93fd6a7b10b
      iscommand: false
      name: Run "Cloud Response - Generic" playbook?
      type: condition
      version: -1
    taskid: c49230e2-fca1-40c5-8aeb-c93fd6a7b10b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -110,
          "y": 2270
        }
      }
  "90":
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "6"
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      AccountID:
        complex:
          accessor: accountid
          root: incident
      AuditAlertType:
        complex:
          accessor: prismacloudcomputetype
          root: incident
      BaseURL:
        complex:
          root: inputs.baseUrl
      ConsoleLink:
        complex:
          accessor: externallink
          root: incident
      Hostname:
        complex:
          accessor: prismacloudcomputehost
          root: incident
      ImageName:
        complex:
          accessor: prismacloudcomputeimage
          root: incident
      Namespace:
        complex:
          accessor: prismacloudcomputenamespaces
          root: incident
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This is a sub-playbook of the "Prisma Cloud Compute - Audit Alert v2" playbook.
        It does the following:
        - Runs the "Prisma Cloud - Get Account Owner" playbook in order to retrieve potential owners for the alert.
        - Sets the incident link to the layout.
        - Pulls image details and alerts
        - Pulls host scan results.
      id: c2ccda34-5687-4d6e-83dc-c274bced2f0d
      iscommand: false
      name: Prisma Cloud Compute - Audit Alert Enrichment
      playbookId: Prisma Cloud Compute - Audit Alert Enrichment
      type: playbook
      version: -1
    taskid: c2ccda34-5687-4d6e-83dc-c274bced2f0d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 132.5,
          "y": 265
        }
      }
  "91":
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4e719c23-808d-41ef-8312-84cda9e2ed2c
      iscommand: false
      name: Enrichment
      type: title
      version: -1
    taskid: 4e719c23-808d-41ef-8312-84cda9e2ed2c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 132.5,
          "y": 100
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      HostVulnerabilities:
        complex:
          accessor: vulnerabilities
          root: PrismaCloudCompute.ReportHostScan
      ImageVulnerabilities:
        complex:
          accessor: vulnerabilities
          root: PrismaCloudCompute.ReportsImagesScan
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 0e22ce71-ea68-4cde-8f27-e188718e72fa
      iscommand: false
      name: Prisma Cloud Compute - Audit Alert Vulnerabilities Enrichment
      playbookId: Prisma Cloud Compute - Audit Alert Vulnerabilities Enrichment
      type: playbook
      version: -1
    taskid: 0e22ce71-ea68-4cde-8f27-e188718e72fa
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -100,
          "y": 610
        }
      }
  "93":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.PauseForReview
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "93"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fdfc2c0a-3f69-48fc-8293-0907e637aa98
      iscommand: false
      name: Pause for a manual review?
      type: condition
      version: -1
    taskid: fdfc2c0a-3f69-48fc-8293-0907e637aa98
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 122.5,
          "y": 2660
        }
      }
  "94":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: prismacloudcomputehost
                root: incident
          operator: isNotEmpty
        - left:
            iscontext: true
            value:
              complex:
                accessor: prismacloudcomputeimage
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "95"
      "yes":
      - "91"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 31b70d13-f37a-4b13-8dd3-de6587c05f96
      iscommand: false
      name: Check if host or image resources exist in the incident.
      type: condition
      version: -1
    taskid: 31b70d13-f37a-4b13-8dd3-de6587c05f96
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 132.5,
          "y": -120
        }
      }
  "95":
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 17e84d9d-91b4-40fb-8948-6a993b3c92f3
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 17e84d9d-91b4-40fb-8948-6a993b3c92f3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -337.5,
          "y": 100
        }
      }
  "96":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: prismacloudcomputehost
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "96"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1c29ba4d-506a-4785-8028-c319936b62f5
      iscommand: false
      name: Is there a host?
      type: condition
      version: -1
    taskid: 1c29ba4d-506a-4785-8028-c319936b62f5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 122.5,
          "y": 980
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "60_11_#default#": 0.31,
      "85_83_yes": 0.47,
      "85_93_#default#": 0.22,
      "93_26_#default#": 0.2,
      "93_42_yes": 0.52,
      "96_11_#default#": 0.1,
      "96_59_yes": 0.4
    },
    "paper": {
      "dimensions": {
        "height": 3595,
        "width": 1340,
        "x": -377.5,
        "y": -270
      }
    }
  }
