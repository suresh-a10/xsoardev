contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 37475a39-1e77-4bb1-8a2d-bda3f8a63bcc
inputs: []
name: TCS-Recorded Future Playbook Alert Details Domain Abuse_v1.0_PG
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 293c5a46-3268-4fcb-8dc3-9284bbe69bf3
      iscommand: false
      name: ""
      version: -1
    taskid: 293c5a46-3268-4fcb-8dc3-9284bbe69bf3
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 380,
          "y": 2590
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: true
    quietmode: 2
    scriptarguments:
      alert_ids:
        complex:
          accessor: alertid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get Playbook alert details by id.
      id: 976305b4-f0ac-4258-8705-3ac605388ca3
      iscommand: true
      name: Get Alert detail from Recorded Future
      script: '|||recordedfuture-playbook-alerts-details'
      type: regular
      version: -1
    taskid: 976305b4-f0ac-4258-8705-3ac605388ca3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": 2930
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 261360fa-1d32-41f2-8cd7-e838d59a5685
      iscommand: false
      name: Start Acknowledgement SLA
      type: title
      version: -1
    taskid: 261360fa-1d32-41f2-8cd7-e838d59a5685
    timertriggers:
    - action: start
      fieldname: acknowledgementsla
    type: title
    view: |-
      {
        "position": {
          "x": 380,
          "y": 3450
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.owner
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c52e94bf-4757-4eb4-8710-f459b120b4a3
      iscommand: false
      name: Is Owner assigned?
      type: condition
      version: -1
    taskid: c52e94bf-4757-4eb4-8710-f459b120b4a3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 380,
          "y": 3605
        }
      }
  "4":
    continueonerror: true
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      name:
        simple: AutoAssignment_Lock
      timeout:
        simple: "600"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Demisto Lock
      description: Gets a specific lock. If the lock doesn't exist, it creates one.
        If the lock is already in use, the command waits until the lock is released
        or until timeout is reached. If timeout is reached and the lock hasn't been
        released, the command fails to get the lock.
      id: 49494fba-95c7-43d6-8f1a-a2ce539a537d
      iscommand: true
      name: Locking the Assignment Task
      script: Demisto Lock|||demisto-lock-get
      type: regular
      version: -1
    taskid: 49494fba-95c7-43d6-8f1a-a2ce539a537d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 3795
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      desc:
        complex:
          accessor: title
          root: incident.labels
      incidentid:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b5a74298-be62-49d4-8897-ce0a55298bac
      iscommand: false
      name: AutoAssign Analyst To Incident
      script: 0021cb92-321d-4754-81a1-66fc6a41635d
      type: regular
      version: -1
    taskid: b5a74298-be62-49d4-8897-ce0a55298bac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 3950
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      name:
        simple: AutoAssignment_Lock
    separatecontext: false
    skipunavailable: false
    task:
      brand: Demisto Lock
      description: Release a lock
      id: 57448ae8-6c38-4cb7-8f42-d340e43554c2
      iscommand: true
      name: Release the Assignment Task
      script: Demisto Lock|||demisto-lock-release
      type: regular
      version: -1
    taskid: 57448ae8-6c38-4cb7-8f42-d340e43554c2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 4125
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Expose the incident owner into IncidentOwner context key
      id: 6b37b77c-af5b-4664-82ee-830345ed585a
      iscommand: false
      name: Populate Incident Owner Context
      script: ExposeIncidentOwner
      type: regular
      version: -1
    taskid: 6b37b77c-af5b-4664-82ee-830345ed585a
    timertriggers:
    - action: start
      fieldname: closuresla
    - action: start
      fieldname: detectionsla
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 4285
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      username:
        complex:
          accessor: owner
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.get.user.by.username
      id: 0413e300-0025-4234-857e-dab97d127b45
      iscommand: true
      name: Get Incident Owner Details
      script: Builtin|||getUserByUsername
      type: regular
      version: -1
    taskid: 0413e300-0025-4234-857e-dab97d127b45
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 4445
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    scriptarguments:
      selectshift:
        complex:
          accessor: roles
          root: UserByUsername
          transformers:
          - args:
              from:
                value:
                  simple: '['
            operator: substringFrom
          - args:
              to:
                value:
                  simple: ']'
            operator: substringTo
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ' '
            operator: join
          - args:
              regex:
                value:
                  simple: ' CSOC-XSOAR-Admin'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Read-Only'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Operator'
              replaceWith: {}
            operator: replaceMatch
          - args:
              delimiter: {}
            operator: splitAndTrim
      shift:
        complex:
          accessor: roles
          root: UserByUsername
          transformers:
          - args:
              from:
                value:
                  simple: '['
            operator: substringFrom
          - args:
              to:
                value:
                  simple: ']'
            operator: substringTo
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ' '
            operator: join
          - args:
              regex:
                value:
                  simple: ' CSOC-XSOAR-Admin'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Read-Only'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Operator'
              replaceWith: {}
            operator: replaceMatch
          - args:
              delimiter: {}
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 466b5a48-f89f-4464-8665-2f0f53f4a448
      iscommand: true
      name: Set Investigator Role In Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 466b5a48-f89f-4464-8665-2f0f53f4a448
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 4610
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
      MD5:
        complex:
          accessor: MD5
          root: File
          transformers:
          - operator: uniq
      SHA1:
        complex:
          accessor: SHA1
          root: File
          transformers:
          - operator: uniq
      SHA256:
        complex:
          accessor: SHA256
          root: File
          transformers:
          - operator: uniq
      URL:
        complex:
          accessor: URL
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Template playbook to incorporate Recorded Future enrichment for
        IPs, Hashes, Domains, URLs into your current workflows. Playbook also shows
        how to look up available 'Links' data for IOCs.
      id: dd8cf936-3c19-472c-81cf-c379a5bb075c
      iscommand: false
      name: TCS-Recorded Future Entity Enrichment v1.0-KK
      playbookId: 9fd8be93-2567-4996-822b-7042d4e9ee00
      type: playbook
      version: -1
    taskid: dd8cf936-3c19-472c-81cf-c379a5bb075c
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 380,
          "y": 3260
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: alertname
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: ad7ab223-34df-47dd-806c-f8ea14fd832d
      iscommand: true
      name: Extract the domain from alert
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: ad7ab223-34df-47dd-806c-f8ea14fd832d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": 3090
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: runStatus
                root: incident.acknowledgementsla
          operator: isEqualString
          right:
            value:
              simple: running
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 17893547-7b7b-4d1c-8fac-3c4718266c4a
      iscommand: false
      name: Is Acknowledgement SLA Still Running ?
      type: condition
      version: -1
    taskid: 17893547-7b7b-4d1c-8fac-3c4718266c4a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": 4940
        }
      }
  "13":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Have You Completed This Task
        options: []
        optionsarg:
        - {}
        - simple: Yes - Move To The Next Task
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Please Click The 'Lets Get Started!' Button
      totalanswers: 0
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c7bc96cb-3d7b-4567-88be-c6fef6a42c35
      iscommand: false
      name: Please Click The 'Lets Get Started!' Button
      type: collection
      version: -1
    taskid: c7bc96cb-3d7b-4567-88be-c6fef6a42c35
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 370,
          "y": 5115
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b5c06f60-4908-485b-829a-dd89bb7d4cde
      iscommand: false
      name: Stop Acknowledgement SLA
      type: title
      version: -1
    taskid: b5c06f60-4908-485b-829a-dd89bb7d4cde
    timertriggers:
    - action: stop
      fieldname: responsesla
    - action: stop
      fieldname: acknowledgementsla
    - action: start
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 370,
          "y": 5305
        }
      }
  "15":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: whichslabreached
                root: incident
          operator: isEqualString
          right:
            value:
              simple: acknowledgementsla
        - left:
            iscontext: true
            value:
              complex:
                accessor: whichslabreached
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: acknowledgementsla
      label: "yes"
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 470053fe-5197-46e1-82a4-52b6067f9364
      iscommand: false
      name: Is response sla breached?
      type: condition
      version: -1
    taskid: 470053fe-5197-46e1-82a4-52b6067f9364
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": 5440
        }
      }
  "16":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: justificationforacknowledgementslabreached
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Provide justification for response sla violated
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: Your SOC team
      title: Provide justification for response sla violated
      totalanswers: 0
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Provide justification for acknowledgement sla violated
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: b2c7bb33-93ef-4477-84e4-333d6d5bd153
      iscommand: false
      name: Provide justification for acknowledgement sla violated
      type: collection
      version: -1
    taskid: b2c7bb33-93ef-4477-84e4-333d6d5bd153
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 5605
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 34414164-cfd5-4d04-8464-eb0b58d9d36c
      iscommand: false
      name: TCS-Triage-Case Management v3_KK
      playbookId: b82a6df1-9a17-4fae-889e-c6f7bde37df1
      type: playbook
      version: -1
    taskid: 34414164-cfd5-4d04-8464-eb0b58d9d36c
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 5775
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: "Is This a True Positive Alert ?\n(Study The IoC Threat Intelligence
          Report. Are IoCs Part of The XSOAR Block List ? Check if the indicators
          have block tags and the expiration status. Also check for 'Related Incidents') "
      cc: null
      format: ""
      methods: []
      replyOptions:
      - 'No, It is False Positive '
      - No, its a Benign-True Positive
      - Yes, it is True Positive
      - No / Not Sure - To Be Determined
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: {}
    nexttasks:
      No / Not Sure - To Be Determined:
      - "23"
      'No, It is False Positive ':
      - "20"
      No, its a Benign-True Positive:
      - "21"
      Yes, it is True Positive:
      - "34"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9b7903f2-8207-4805-818a-e4a96bc7a8c8
      iscommand: false
      name: "Is This a True Positive Alert ? \n(Study The IoC Threat Intelligence
        Report. Are IoCs Part of The XSOAR Block List ? Check if the indicators have
        block tags and the expiration status. Also check for 'Related Incidents') "
      tags:
      - Note
      type: condition
      version: -1
    taskid: 9b7903f2-8207-4805-818a-e4a96bc7a8c8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": 5970
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8f2de2a9-6989-479f-8c0d-30075b44a534
      iscommand: true
      name: Set 'False Positive'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8f2de2a9-6989-479f-8c0d-30075b44a534
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -560,
          "y": 7040
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: Benign-True Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 208d7f9b-bb95-406d-87c2-9516c4728461
      iscommand: true
      name: Set 'Benign-True Positive'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 208d7f9b-bb95-406d-87c2-9516c4728461
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -220,
          "y": 6800
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: "Would You Like To Contain The Host While You Investigate ? \n(NOTE:
          if the alert looks suspicious its recommended to contain the machine) "
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "26"
      "Yes":
      - "24"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0e588d60-9a98-4ac8-8531-781cb87080ef
      iscommand: false
      name: "Would You Like To Contain The Host While You Investigate ? \n(NOTE: if
        the alert looks suspicious its recommended to contain the machine) "
      tags:
      - report
      type: condition
      version: -1
    taskid: 0e588d60-9a98-4ac8-8531-781cb87080ef
    timertriggers:
    - action: stop
      fieldname: threatresponsesla
    type: condition
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 6280
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3b61da7b-9396-40a1-895b-de3f4debb8c2
      iscommand: false
      name: Investigate - Not Sure To Be Determined
      type: title
      version: -1
    taskid: 3b61da7b-9396-40a1-895b-de3f4debb8c2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 370,
          "y": 6160
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      containmachine:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 2c173963-1811-44ce-8154-eec9590baa3c
      iscommand: true
      name: Set Contain Machine Context To - YES
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 2c173963-1811-44ce-8154-eec9590baa3c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 6510
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e6de8222-18c1-48b2-86a2-401c8868f2e0
      iscommand: false
      name: 'Sub Playbook: Contain Host via CrowdStrike'
      playbookId: a4d833cf-d2ae-4de1-846a-992f5293b414
      type: playbook
      version: -1
    taskid: e6de8222-18c1-48b2-86a2-401c8868f2e0
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 6680
        }
      }
  "26":
    continueonerrortype: ""
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: ""
      headerfontcolor: ""
      isexternalrtl: false
      sender: ""
      submitbuttonbackgroundcolor: ""
      submitbuttonfontcolor: ""
      submittext: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: 'Study The IoC Threat Intelligence Report. Are IoCs Part of The XSOAR
          Block List ? (check if the indicators have block tags and the expiration
          status. Also check for ''Related Incidents'') '
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes - SOME IoCs Are Part of The Block List
      - Yes - ALL IoCs Are Part of The Block List
      - No - NONE of The IoCs are Part of The Block List
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      No - NONE of The IoCs are Part of The Block List:
      - "28"
      Yes - ALL IoCs Are Part of The Block List:
      - "29"
      Yes - SOME IoCs Are Part of The Block List:
      - "27"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 08191f1e-816a-462a-8000-fa8c741fa53e
      iscommand: false
      name: 'Study The IoC Threat Intelligence Report. Are IoCs Part of The XSOAR
        Block List ? (check if the indicators have block tags and the expiration status.
        Also check for ''Related Incidents'') '
      tags:
      - report
      type: condition
      version: -1
    taskid: 08191f1e-816a-462a-8000-fa8c741fa53e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 6860
        }
      }
  "27":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Review The IoC Intel To Assess The Threat Severity of The IoCs That
            Are Not Blocked. Once Your Ready - Move To The Next Task
        options: []
        optionsarg:
        - {}
        - simple: I'm Ready - Move To The Next Task
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Investigation Guide
      totalanswers: 0
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Investigation Guide
      cc: null
      format: ""
      methods: []
      replyOptions:
      - I'm Ready - Procced To Next Task
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bdd81194-2c63-4468-8711-50b6dbc84046
      iscommand: false
      name: Review The IoC Intel To Assess The Threat Severity of The IoCs That Are
        Not Blocked. Once Your Ready - Move To The Next Task
      tags:
      - report
      type: collection
      version: -1
    taskid: bdd81194-2c63-4468-8711-50b6dbc84046
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7040
        }
      }
  "28":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Review The IoC Intel To Assess The Threat. Once Your Ready - Move
            To The Next Task
        options: []
        optionsarg:
        - {}
        - simple: I'm Ready - Procced To Next Task
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Investigation Guide
      totalanswers: 0
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Investigation Guide
      cc: null
      format: ""
      methods: []
      replyOptions:
      - I'm Ready - Procced To Next Task
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5f1d5049-92eb-4f89-8de9-5d508aa405ce
      iscommand: false
      name: Review The IoC Intel To Assess The Threat. Once Your Ready - Move To The
        Next Task
      tags:
      - report
      type: collection
      version: -1
    taskid: 5f1d5049-92eb-4f89-8de9-5d508aa405ce
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 690,
          "y": 7040
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Based on The IoC Intel, Do You Need To Change The Alert Severity ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "31"
      "Yes":
      - "30"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 15b70276-94d8-4ea7-8e2e-7d6506bc9edc
      iscommand: false
      name: Based on The IoC Intel, Do You Need To Change The Alert Severity ?
      tags:
      - report
      type: condition
      version: -1
    taskid: 15b70276-94d8-4ea7-8e2e-7d6506bc9edc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 7230
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1b9ddf47-4ec7-4e14-8da2-41a2ef1b2813
      iscommand: false
      name: 'Sub Playbook: Triage The Alert'
      playbookId: b82a6df1-9a17-4fae-889e-c6f7bde37df1
      type: playbook
      version: -1
    taskid: 1b9ddf47-4ec7-4e14-8da2-41a2ef1b2813
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 370,
          "y": 7445
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Is This a True Positive Alert ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No, Its a Confirmed - False Positive
      - No, Its a Benign-True Positive
      - Yes, it is True Positive
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      No, Its a Benign-True Positive:
      - "33"
      No, Its a Confirmed - False Positive:
      - "32"
      Yes, it is True Positive:
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1f493be0-586a-4f31-8cc9-19c6c034c7ca
      iscommand: false
      name: Is This a True Positive Alert ?
      type: condition
      version: -1
    taskid: 1f493be0-586a-4f31-8cc9-19c6c034c7ca
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": 7670
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9569d9e1-6947-4e16-8d75-41f21d6e4d66
      iscommand: false
      name: Close Investigation- False Positive
      type: title
      version: -1
    taskid: 9569d9e1-6947-4e16-8d75-41f21d6e4d66
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": -570,
          "y": 7890
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3e45314f-2d5a-4fd5-8ad2-3fdfd29af9cc
      iscommand: false
      name: 'Close Investigation -Benign True positive '
      type: title
      version: -1
    taskid: 3e45314f-2d5a-4fd5-8ad2-3fdfd29af9cc
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": -160,
          "y": 7890
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2a8b4680-e78c-4ba3-875c-c74297ab9649
      iscommand: false
      name: 'Close Investigation -True positive '
      type: title
      version: -1
    taskid: 2a8b4680-e78c-4ba3-875c-c74297ab9649
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 1100,
          "y": 7890
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: True Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: b447d91f-49c2-4d09-898f-3d35d852add9
      iscommand: true
      name: Set 'True Positive'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: b447d91f-49c2-4d09-898f-3d35d852add9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1100,
          "y": 8060
        }
      }
  "36":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: anyimpact
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Was there any Impact ? (service disruption, malware installed,
            successful C&C communication..etc) '
        options: []
        optionsarg:
        - {}
        - simple: "No"
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Was there any Impact ? (service disruption, malware installed, successful
        C&C communication..etc)
      totalanswers: 0
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1de2fa24-7edd-4f30-8b39-120cdfd1bbcf
      iscommand: false
      name: 'Was there any Impact ? (service disruption, malware installed, successful
        C&C communication..etc) '
      type: collection
      version: -1
    taskid: 1de2fa24-7edd-4f30-8b39-120cdfd1bbcf
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1100,
          "y": 8240
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Was there any Impact ? .Answers
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "38"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6972accb-9b17-438b-8284-2badfcb09647
      iscommand: false
      name: Does The CSOC Manager Need To Be Notified ? (auto select if impact is
        'Yes')
      tags:
      - report
      type: condition
      version: -1
    taskid: 6972accb-9b17-438b-8284-2badfcb09647
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1100,
          "y": 8410
        }
      }
  "38":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: emailbody
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter Notification Message To CSOC Manager (give a brief about the
            true positive alert and the impact)
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: ""
      title: Enter Notification Message To CSOC Manager
      totalanswers: 0
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "39"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b523727f-2dd3-4913-8aa1-449599bbd8e6
      iscommand: false
      name: Enter Notification Message To CSOC Manager (give a brief about the true
        positive alert and the impact)
      type: collection
      version: -1
    taskid: b523727f-2dd3-4913-8aa1-449599bbd8e6
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1100,
          "y": 8610
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 2
    scriptarguments:
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          ${incident.emailbody}

          Investigation Link --> https://soar.tcsapps.com/#/Custom/caseinfoid/${incident.id}
      cc:
        simple: ${UserByUsername.email}
      subject:
        simple: '*True Positive Notification* Recorded Future Investigation - Severity
          - ${incident.mailerseverity}'
      to:
        simple: nimisha.prajapati@tcs.com,yogesh.gholap@tcs.com,
      using:
        simple: Mail Sender_instance_CSOC_Mail
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: e1b05fbb-948d-4249-877d-efeac402e391
      iscommand: true
      name: Notify CSOC Manager & Necessary Stakeholders
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: e1b05fbb-948d-4249-877d-efeac402e391
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1100,
          "y": 8800
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: 'Do You Need To Mitigate The Threat By Blocking IoCs or Containing
          Host ? (NOTE: for IP address blocking other than Palo Alto FW, pls connect
          with location FW owner)'
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes - I Want To Block IOC
      - Yes - I Want To Contain Host
      - No - They Are Already Blocked / Contained
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      No - They Are Already Blocked / Contained:
      - "47"
      Yes - I Want To Block IOC:
      - "45"
      Yes - I Want To Contain Host:
      - "41"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 39ea2a6c-b43d-4f53-855f-2d621b6ac34f
      iscommand: false
      name: 'Do You Need To Mitigate The Threat By Blocking IoCs or Containing Host
        ? (NOTE: for IP address blocking other than Palo Alto FW, pls connect with
        location FW owner)'
      tags:
      - report
      type: condition
      version: -1
    taskid: 39ea2a6c-b43d-4f53-855f-2d621b6ac34f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 8990
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f49a0384-d95c-4401-828b-17d79c9fa131
      iscommand: false
      name: Start Contain Host SLA\Timer (Inside Sub Playbook)
      type: title
      version: -1
    taskid: f49a0384-d95c-4401-828b-17d79c9fa131
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 840,
          "y": 9210
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      containmachine:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 6b4a8d60-e392-4b6b-819d-056bd09fd2cb
      iscommand: true
      name: Set Contain Machine Context To - YES
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6b4a8d60-e392-4b6b-819d-056bd09fd2cb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 840,
          "y": 9450
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bc4f8ff8-4f5c-41f0-89ed-c3863a67fc43
      iscommand: false
      name: 'Sub Playbook: Contain Host via CrowdStrike'
      playbookId: a4d833cf-d2ae-4de1-846a-992f5293b414
      type: playbook
      version: -1
    taskid: bc4f8ff8-4f5c-41f0-89ed-c3863a67fc43
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 840,
          "y": 9625
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      iocblockrequest:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f5f90153-5286-4d4e-8dda-8af63c04ab2d
      iscommand: true
      name: Set Context IOC Block Request To - Yes
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f5f90153-5286-4d4e-8dda-8af63c04ab2d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 9325
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8494ff3a-b538-4b06-8e47-f34a65d41e01
      iscommand: false
      name: Start Block IOC\Mitigation SLA Timer (Inside Sub Playbook)
      type: title
      version: -1
    taskid: 8494ff3a-b538-4b06-8e47-f34a65d41e01
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 9200
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7ed1fc72-d8d9-4260-8f03-8ab4d186395a
      iscommand: false
      name: TCS-Select IOC To Block_RF Playbook v1.0_PG_WIP
      playbookId: 53aac6f0-1166-4697-8ab3-ec16faab7575
      type: playbook
      version: -1
    taskid: 7ed1fc72-d8d9-4260-8f03-8ab4d186395a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 9510
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      iocblockrequest:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: cbc27c40-f322-4185-8016-b75b87d1fc64
      iscommand: true
      name: Set Context Block IOC To  - No
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: cbc27c40-f322-4185-8016-b75b87d1fc64
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 10080
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e8b0c6a-9eb0-4698-8fa5-6c8eaa1c6c61
      iscommand: false
      name: Stop Mitigation SLA (Inside Sub Playbook)
      type: title
      version: -1
    taskid: 1e8b0c6a-9eb0-4698-8fa5-6c8eaa1c6c61
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 10320
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0edb1733-f29e-40f1-8858-230a0fab39dc
      iscommand: false
      name: Stop Threat Response SLA
      type: title
      version: -1
    taskid: 0edb1733-f29e-40f1-8858-230a0fab39dc
    timertriggers:
    - action: stop
      fieldname: threatresponsesla
    type: title
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 10460
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Review The Alert - Check If You Need To Raise an IMT ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No -  IMT Not Required
      - Yes - I Have Raised an IMT
      - I'm Not Sure - Will Do It later
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      I'm Not Sure - Will Do It later:
      - "55"
      No -  IMT Not Required:
      - "51"
      Yes - I Have Raised an IMT:
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e32da664-3fd1-42bb-8f3b-f972728b69e6
      iscommand: false
      name: Review The Alert - Check If You Need To Raise an IMT ?
      type: condition
      version: -1
    taskid: e32da664-3fd1-42bb-8f3b-f972728b69e6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 10700
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 834d3033-7365-4f52-834b-056605f450ed
      iscommand: true
      name: Update IMT Context To - No
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 834d3033-7365-4f52-834b-056605f450ed
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 11030
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "Yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: d707765c-e245-4c25-8696-9f6852790d81
      iscommand: true
      name: Update IMT Context To - Yes
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: d707765c-e245-4c25-8696-9f6852790d81
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 11020
        }
      }
  "53":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtnumber
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Number
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: ""
      title: Enter The IMT Number
      totalanswers: 0
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6f4ee0e2-9a27-4d76-8d6d-5c7c21e81da4
      iscommand: false
      name: Enter The IMT Number
      type: collection
      version: -1
    taskid: 6f4ee0e2-9a27-4d76-8d6d-5c7c21e81da4
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 11180
        }
      }
  "54":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtlocation
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Location
        options: []
        optionsarg: []
        placeholder: 'Enter Branch and Location.  Eg: TCS-Mumbai-Olympus'
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: Your SOC team
      title: Enter The IMT Location
      totalanswers: 0
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: ""
      headerfontcolor: ""
      isexternalrtl: false
      sender: ""
      submitbuttonbackgroundcolor: ""
      submitbuttonfontcolor: ""
      submittext: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ac6fae40-72fc-42b1-807b-49c499c14ba1
      iscommand: false
      name: Enter The IMT Location
      type: collection
      version: -1
    taskid: ac6fae40-72fc-42b1-807b-49c499c14ba1
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 11330
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ca1ec2a0-495a-4639-8ffb-23af7402f0cf
      iscommand: false
      name: 'Sub Playbook: Check With Investigator for Lift Containment'
      playbookId: 67fdcc7f-387d-4349-825a-597ed003e264
      type: playbook
      version: -1
    taskid: ca1ec2a0-495a-4639-8ffb-23af7402f0cf
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 11500
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Taken Down is required?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "59"
      "Yes":
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5feb1367-6b91-4d85-8bff-690ca17ad50e
      iscommand: false
      name: Take down is required?
      type: condition
      version: -1
    taskid: 5feb1367-6b91-4d85-8bff-690ca17ad50e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 11885
        }
      }
  "57":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Please provide the Incident ID
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Please mention the domain which is required for take down
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: ""
      title: Please provide the Incident ID
      totalanswers: 0
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7d1d430a-6cd2-44b7-8b7b-cb4b9f5541d1
      iscommand: false
      name: Please provide the Incident ID
      type: collection
      version: -1
    taskid: 7d1d430a-6cd2-44b7-8b7b-cb4b9f5541d1
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1090,
          "y": 12080
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      bcc:
        simple: porkodi.g@tcs.com
      body:
        simple: "Hi ,\n\nThis IOC required for take down \n${Please provide the Incident
          ID.Answers.1}\n\nPlease find the incident  ID ${Please provide the Incident
          ID.Answers.0}\n\nThanks and Regards,\nCyberautobot  \n"
      cc:
        simple: yogesh.gholap@tcs.com ,nimisha.prajapati@tcs.com,kunal.krushev@tcs.com
      subject:
        simple: Recorded Future Taken Down -${incident.id}
      to:
        simple: csocanalyst@tcscomprod.onmicrosoft.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 03e10eeb-0c60-4ea3-8f64-31eec811db3d
      iscommand: true
      name: Notify to L3
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 03e10eeb-0c60-4ea3-8f64-31eec811db3d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": 12250
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 168695fb-a965-4c03-86d3-cd3ffba68448
      iscommand: false
      name: Document & Close Investigation
      type: title
      version: -1
    taskid: 168695fb-a965-4c03-86d3-cd3ffba68448
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 400,
          "y": 12530
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9880ee52-5b02-45ba-83e7-c0fe76b71b06
      iscommand: false
      name: 'Sub Playbook: Document & Close'
      playbookId: 4a46e3dc-82da-4b3a-86ca-eb2f9dfd589f
      type: playbook
      version: -1
    taskid: 9880ee52-5b02-45ba-83e7-c0fe76b71b06
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 400,
          "y": 12705
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bf434359-b1f3-4c70-84b3-c24b8ef789b3
      iscommand: false
      name: TCS-Severity Domain abuse_v1.0_PG_WIP
      playbookId: 8c3eb9ed-89b3-4d14-8e7a-6fdd43322c3b
      type: playbook
      version: -1
    taskid: bf434359-b1f3-4c70-84b3-c24b8ef789b3
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 370,
          "y": 4780
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5f97916d-cec1-40a0-8b46-97222c33e8e5
      iscommand: false
      name: END
      type: title
      version: -1
    taskid: 5f97916d-cec1-40a0-8b46-97222c33e8e5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 400,
          "y": 12880
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      alert_ids:
        simple: ${incident.alertid}
      new_status:
        simple: dismissed
    separatecontext: false
    skipunavailable: false
    task:
      brand: RecordedFuturePlaybookAlerts
      description: Update the status of one or multiple Playbook alerts.
      id: 0dd24d08-d842-4429-8c02-1df769781f14
      iscommand: true
      name: Set Status to Dismissed
      script: RecordedFuturePlaybookAlerts|||recordedfuture-playbook-alerts-update
      type: regular
      version: -1
    taskid: 0dd24d08-d842-4429-8c02-1df769781f14
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -560,
          "y": 7340
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      alert_ids:
        simple: ${incident.alertid}
      new_status:
        simple: resolved
    separatecontext: false
    skipunavailable: false
    task:
      brand: RecordedFuturePlaybookAlerts
      description: Update the status of one or multiple Playbook alerts.
      id: 90cbb7df-b37f-4ab3-8553-f74695f747f5
      iscommand: true
      name: Set Status to Resolved
      script: RecordedFuturePlaybookAlerts|||recordedfuture-playbook-alerts-update
      type: regular
      version: -1
    taskid: 90cbb7df-b37f-4ab3-8553-f74695f747f5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 11670
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: rawCloseReason
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: duplicate
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "1"
      "yes":
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4798f621-365e-4e04-8cbc-d4757503ae70
      iscommand: false
      name: Is This a Re-Opened Duplicate Alert
      type: condition
      version: -1
    taskid: 4798f621-365e-4e04-8cbc-d4757503ae70
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2730
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "67"
    note: false
    quietmode: 1
    scriptarguments:
      closeNotes:
        simple: Duplicate - Auto Close
      closingnote:
        simple: Duplicate - Auto Close
      duplicateticketnumber:
        simple: NA. This is Duplicate - Auto Close incident.
      forensicsdone:
        simple: Not Applicable
      incidentclosingreason:
        simple: Duplicate
      investigationanalysis:
        simple: Not Applicable
      investigationconclusion:
        simple: Duplicate
      remediationrequired:
        simple: Not Applicable
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 503e2e08-132d-46a7-8b74-d32895a92911
      iscommand: true
      name: Set Incident Closing Reason Context - Duplicate
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 503e2e08-132d-46a7-8b74-d32895a92911
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -840,
          "y": 2970
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: fbe85944-9e99-4062-87b9-e5eaf71e4359
      iscommand: true
      name: Closing Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: fbe85944-9e99-4062-87b9-e5eaf71e4359
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": 12705
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      alert_ids:
        simple: ${incident.alertid}
      new_status:
        simple: resolved
    separatecontext: false
    skipunavailable: false
    task:
      brand: RecordedFuturePlaybookAlerts
      description: Update the status of one or multiple Playbook alerts.
      id: 5affe5d1-4825-4c51-8746-b809f8b5457d
      iscommand: true
      name: Set Status to Resolved
      script: RecordedFuturePlaybookAlerts|||recordedfuture-playbook-alerts-update
      type: regular
      version: -1
    taskid: 5affe5d1-4825-4c51-8746-b809f8b5457d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -220,
          "y": 7590
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 10355,
        "width": 2720,
        "x": -840,
        "y": 2590
      }
    }
  }
