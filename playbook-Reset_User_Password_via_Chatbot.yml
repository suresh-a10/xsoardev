contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.8.0
    itemVersion: 1.0.0
    packID: PasswordResetViaChatbot
    packName: Password Reset via Chatbot
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: "This playbook resets the password of an Active Directory or Okta user.
  The process is as follows:\n1. A user requests a password reset using a chatbot
  in Slack or in Microsoft Teams.\n2. The playbook optionally seeks approval to reset
  the user's password from the relevant stakeholder, or from the user's manager. The
  request will be available for approval/disapproval for 1 hour. If not processed
  within that time, it will be disapproved.\n3. If the reset was approved, the playbook
  optionally verifies the user using 2-factor authentication, from the user's available
  2FA methods on Okta.\n4. If the reset is verified, a new password will be created
  while meeting the complexity requirements of the organization.\n5. The user's password
  will be reset and set to the newly generated password. The user will be forced to
  change their password on next login.\n6. The new user's password will be placed
  inside a password-protected ZIP (protected by a different password).\n7. The encrypted
  ZIP file that contains the new password for the user will be sent to the user via
  email. \n8. The password for the ZIP file that contains the new user's password,
  will be sent to the requesting user through Slack or Teams.\n\nThis playbook is
  intended for use with Slack or Teams. In order to use it, please make sure that
  you have a classifier and mapper in place. The classifier should create a Password
  Reset via Chatbot incident, while the mapper should map the email of the user to
  the Reporter Email Address field.\nThis playbook assumes that the user requesting
  the password reset has the same email in Slack / Teams, and in Active Directory
  / Okta."
id: Reset User Password via Chatbot
inputs:
- description: The maximum number of digits in the generated password. If no value
    is specified, a value of 10 will be used.
  key: PasswordMaxDigits
  playbookInputQuery: null
  required: false
  value:
    simple: "4"
- description: Maximum number of lower case characters to include in the password.
    If no value is specified, a value of 10 will be used.
  key: PasswordMaxLowercase
  playbookInputQuery: null
  required: false
  value:
    simple: "4"
- description: Maximum number of symbols to include in the password. If no value is
    specified, a value of 10 will be used.
  key: PasswordMaxSymbols
  playbookInputQuery: null
  required: false
  value:
    simple: "4"
- description: Maximum number of upper case characters to include in the password.
    If no value is specified, a value of 10 will be used.
  key: PasswordMaxUppercase
  playbookInputQuery: null
  required: false
  value:
    simple: "4"
- description: Minimum number of digits to include in the password. If no value is
    specified, a value of 0 will be used.
  key: PasswordMinDigits
  playbookInputQuery: null
  required: false
  value:
    simple: "2"
- description: Minimum number of lower case characters to include in the password.
    If no value is specified, a value of 0 will be used.
  key: PasswordMinLowercase
  playbookInputQuery: null
  required: false
  value:
    simple: "2"
- description: Minimum number of symbols to include in the password. If no value is
    specified, a value of 0 will be used.
  key: PasswordMinSymbols
  playbookInputQuery: null
  required: false
  value:
    simple: "2"
- description: Minimum number of upper case characters to include in the password.
    If no value is specified, a value of 0 will be used.
  key: PasswordMinUppercase
  playbookInputQuery: null
  required: false
  value:
    simple: "2"
- description: |-
    Optional - determines who will approve or disapprove the password reset. Possible values are: no value specified, email address of the user who will receive the reset request, or "Manager".

    If no value is specified - approval will not be required when resetting the password.

    If the value of "Manager" is specified - the user's manager email will be retrieved from Active Directory, and an approval email will be sent to the manager to allow or decline the password reset.

    If an email is specified  - an approval email will be sent to the email specified to allow or decline the password reset.
  key: ApprovalTarget
  playbookInputQuery: null
  required: false
  value:
    simple: Manager
- description: |-
    Optional - applicable only if the "ApprovalTarget" input is not blank.
    The subject of the email that will be sent to approve or disapprove the password reset. This email would be sent to the user's manager, IT staff or anyone else specified.
  key: ApprovalEmailSubject
  playbookInputQuery: null
  required: false
  value:
    simple: Action Required - User Password Reset
- description: |-
    Optional - applicable only if the "ApprovalTarget" input is not empty.
    The body of the email that will be sent to approve or disapprove the password reset. This email would be sent to the user's manager, IT staff or anyone else specified.
  key: ApprovalEmailBody
  playbookInputQuery: null
  required: false
  value:
    simple: |-
      User [PLACEHOLDER] asked to reset their password.
      Please allow or decline the password reset.
- description: |-
    Determines where the user password will be reset. Some organizations provision the data from Okta to Active Directory, so they may choose to reset the password in Okta instead of Active Directory.
    Possible values are (choose one):
    - Active Directory
    - Okta
  key: TargetProduct
  playbookInputQuery: null
  required: false
  value:
    simple: Active Directory
- description: |-
    Whether to require that the user authenticates using an available authentication method.
    Currently, this only supports the Extra Verification methods available in Okta (Okta Verify, SMS, Security Question or Google Authenticator).
  key: Require2FA
  playbookInputQuery: null
  required: false
  value:
    simple: "True"
- description: The subject of the email with the password that will be sent to the
    user.
  key: UserEmailSubject
  playbookInputQuery: null
  required: false
  value:
    simple: Password Reset
- description: 'The body of the email with the password that will be sent to the user.
    Note: The password will not be included in the email body, but in a protected
    ZIP file instead.'
  key: UserEmailBody
  playbookInputQuery: null
  required: false
  value:
    simple: |-
      Following your request to reset your password, we've changed your password to a new temporary password.
      After logging in, you will be required to change the password to a new one.
      You can find the password in the ZIP file attached to this email. The password to the ZIP file was sent to you in a direct message in Slack or in Teams.
- description: |
    The message that will be sent to the user in Slack/Teams after their password was reset. The value of this input will be appended to the beginning of the the ZIP password that will be sent in the following manner:
    "The zip file password is: [zip_password_will_be_here]".

    Note: There is no need to actually write the placeholder for the ZIP password. It will simply appear after your message.
  key: ZipPasswordMessage
  playbookInputQuery: null
  required: false
  value:
    simple: "Following your request to reset your password, we've sent you an email
      with the new password. The password is protected inside an encrypted ZIP file.\nThe
      password to the ZIP file is: "
- description: The subject of the email that will be sent to the requesting user in
    case the reset was disapproved or could not be approved.
  key: ResetNotApprovedEmailSubject
  playbookInputQuery: null
  required: false
  value:
    simple: Password Reset Not Approved
- description: The body of the email that will be sent to the requesting user in case
    the reset was not approved or could not be approved.
  key: ResetNotApprovedEmailBody
  playbookInputQuery: null
  required: false
  value:
    simple: |-
      Your request for a password reset could not be approved or was disapproved. Please contact the helpdesk for assistance with resetting your password.

      If you did not ask to reset your password, please change your password immediately and report the incident.
- description: |-
    Optional - applicable only if the ApprovalTarget input is not empty.
    Determines whether the person approving the reset request must have access to the XSOAR server's network. Possible values are "True" or "False".
    If set to True - the person approving the request will receive and email with a link that takes them to a form hosted on this XSOAR server. This means that the approver must be able to access the network either through a VPN or directly.
    If set to False - the approver will get an email where they can simply reply with "yes" or "no", without having to click on a link that requires them to have access to the network of this server.

    You may want to set this to False to make it easier for the stakeholder to approve the request even if they are on vacation or cannot access this network for any reason.

    Note: Enabling this option requires you to have an email sender integration and an email listener integration enabled with the same email address configured on both. In addition, this option does not support disapproving the request automatically if a reply was not received within the 1 hour time window.
  key: RequireAccessForApprover
  playbookInputQuery: null
  required: false
  value:
    simple: "True"
name: Reset User Password via Chatbot
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c7a0b000-0e23-4a2f-802a-a77ae62a7b41
      iscommand: false
      name: ""
      version: -1
    taskid: c7a0b000-0e23-4a2f-802a-a77ae62a7b41
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 380
        }
      }
  "1":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Password Reset Successfully
      output:
        complex:
          accessor: success
          root: IAM.InitADUser
    - incidentfield: Email Sent Successfully
      output:
        complex:
          accessor: sentMail
          root: IAM.InitADUser
    - incidentfield: Error Message
      output:
        complex:
          accessor: errorDetails
          root: IAM.InitADUser
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: |2+

            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: IAM.InitADUser.sendMailError
            operator: concat
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      ZipProtectWithPassword:
        complex:
          root: NEW_PASSWORD
      displayname:
        complex:
          accessor: displayName
          root: ActiveDirectory.Users
      email:
        complex:
          accessor: reporteremailaddress
          root: incident
      email_body:
        complex:
          root: inputs.UserEmailBody
      email_subject:
        complex:
          root: inputs.UserEmailSubject
      max_digits:
        complex:
          root: inputs.PasswordMaxDigits
      max_lcase:
        complex:
          root: inputs.PasswordMaxLowercase
      max_symbols:
        complex:
          root: inputs.PasswordMaxSymbols
      max_ucase:
        complex:
          root: inputs.PasswordMaxUppercase
      min_digits:
        complex:
          root: inputs.PasswordMinDigits
      min_lcase:
        complex:
          root: inputs.PasswordMinLowercase
      min_symbols:
        complex:
          root: inputs.PasswordMinSymbols
      min_ucase:
        complex:
          root: inputs.PasswordMinUppercase
      sAMAccountName:
        complex:
          accessor: sAMAccountName
          root: ActiveDirectory.Users
      to_email:
        complex:
          accessor: reporteremailaddress
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Generates password.
        Set an AD user account with this password.
        Enable the account.
        Send mail to the user with tha account information.
        This script runs the `send-mail` command. Make sure there is a matching Integration configurated.
      id: b8cccbdb-15c7-4600-89f7-c8d64607223d
      iscommand: false
      name: Reset user password in AD & send email
      script: IAMInitADUser
      type: regular
      version: -1
    taskid: b8cccbdb-15c7-4600-89f7-c8d64607223d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 4900
        }
      }
  "5":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.ApprovalTarget
          operator: isEqualString
          right:
            value:
              simple: Manager
      label: Yes, from manager
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.ApprovalTarget
          operator: containsString
          right:
            value:
              simple: '@'
      label: Yes, from specified user
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      Yes, from manager:
      - "6"
      Yes, from specified user:
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the password reset should be approved by a specific
        user or by the manager of the user who asked to reset their password. This
        is configurable through the ApprovalTarget playbook input.
      id: 55a829e4-02a5-4298-8f35-f9acdc507dab
      iscommand: false
      name: Is approval required for the password reset?
      type: condition
      version: -1
    taskid: 55a829e4-02a5-4298-8f35-f9acdc507dab
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 530
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      UserEmail:
        complex:
          accessor: reporteremailaddress
          root: incident
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Takes an email address or a username of a user account in Active
        Directory, and returns the email address of the user's manager.
      id: 54004008-8086-46c7-8089-f7863a07ad7f
      iscommand: false
      name: Active Directory - Get User Manager Details
      playbookId: Active Directory - Get User Manager Details
      type: playbook
      version: -1
    taskid: 54004008-8086-46c7-8089-f7863a07ad7f
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -300,
          "y": 700
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: UserManagerEmail
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the email of the user's manager was retrieved from
        Active Directory.
      id: 58f62f7d-b7df-4eea-8f46-76adfaca48a9
      iscommand: false
      name: Was the manager email retrieved?
      type: condition
      version: -1
    taskid: 58f62f7d-b7df-4eea-8f46-76adfaca48a9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -300,
          "y": 860
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        complex:
          root: inputs.ApprovalEmailBody
          transformers:
          - args:
              limit: {}
              replaceWith:
                iscontext: true
                value:
                  simple: incident.reporteremailaddress
              toReplace:
                value:
                  simple: '[PLACEHOLDER]'
            operator: replace
      cc: null
      defaultOption: Disapprove Reset
      format: ""
      methods:
      - email
      replyOptions:
      - Approve Reset
      - Disapprove Reset
      subject:
        complex:
          root: inputs.ApprovalEmailSubject
      timings:
        completeafterreplies: 1
        completeaftersla: true
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        complex:
          root: UserManagerEmail
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.ApprovalTarget
            operator: SetIfEmpty
    nexttasks:
      Approve Reset:
      - "25"
      Disapprove Reset:
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    sla:
      days: 0
      hours: 1
      minutes: 0
      weeks: 0
    task:
      brand: ""
      description: Asks the user's manager or the user specified in the ApprovalTarget
        playbook input through email, whether the password reset is approved or not.
      id: 331e954c-42a1-407c-81c8-c1e230a52a56
      iscommand: false
      name: Ask - is the reset approved or disapproved?
      type: condition
      version: -1
    taskid: 331e954c-42a1-407c-81c8-c1e230a52a56
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 260,
          "y": 1570
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        complex:
          root: inputs.ResetNotApprovedEmailBody
      subject:
        complex:
          root: inputs.ResetNotApprovedEmailSubject
      to:
        complex:
          accessor: reporteremailaddress
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends an email to the user saying the password reset has not been
        approved.
      id: 39a32fb7-736d-4621-843e-e49e52f4a15e
      iscommand: true
      name: Send email to the user saying reset was not approved
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 39a32fb7-736d-4621-843e-e49e52f4a15e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 5380
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Closes the current incident.
      id: 56c79667-eb38-4d73-8cd5-bf7bf48cf962
      iscommand: true
      name: Close the incident
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 56c79667-eb38-4d73-8cd5-bf7bf48cf962
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 5550
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      email:
        complex:
          accessor: reporteremailaddress
          root: incident
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Retrieves detailed information about a user account. The user can
        be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filter is specified, all users are returned.
      id: b5302ffb-028f-43b3-895b-cd5fd4189634
      iscommand: true
      name: Get user's sAMAccountName from Active Directory
      script: '|||ad-get-user'
      tags:
      - user_information
      type: regular
      version: -1
    taskid: b5302ffb-028f-43b3-895b-cd5fd4189634
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 4480
        }
      }
  "13":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sAMAccountName
                root: ActiveDirectory.Users
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the user was found in Active Directory.
      id: 53cbf1cc-c3d0-40cc-835f-d9800c9077a5
      iscommand: false
      name: Was a user found in Active Directory?
      type: condition
      version: -1
    taskid: 53cbf1cc-c3d0-40cc-835f-d9800c9077a5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 4640
        }
      }
  "14":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.TargetProduct
          operator: isEqualString
          right:
            value:
              simple: Active Directory
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Active Directory Query v2
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isNotEmpty
      label: Active Directory
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.TargetProduct
          operator: isEqualString
          right:
            value:
              simple: Okta
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Okta v2
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isNotEmpty
      label: Okta
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      Active Directory:
      - "12"
      Okta:
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks where the user's password should be reset according to the
        playbook inputs. Some organizations have Okta provisioning in place, in which
        case they may prefer to reset the password in Okta. Other organizations may
        use Active Directory directly.
      id: 3757152b-f855-4971-8837-e3ebcac13608
      iscommand: false
      name: Where should the password be reset?
      type: condition
      version: -1
    taskid: 3757152b-f855-4971-8837-e3ebcac13608
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 4280
        }
      }
  "15":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Password Reset Successfully
      output:
        complex:
          accessor: success
          root: IAM.InitOktaUser
    - incidentfield: Email Sent Successfully
      output:
        complex:
          accessor: sentMail
          root: IAM.InitOktaUser
    - incidentfield: Error Message
      output:
        complex:
          accessor: errorDetails
          root: IAM.InitOktaUser
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: |2+

            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: IAM.InitOktaUser.sendMailError
            operator: concat
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      ZipProtectWithPassword:
        complex:
          root: NEW_PASSWORD
      displayname:
        complex:
          accessor: DisplayName
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Account.Type
              operator: isEqualString
              right:
                value:
                  simple: Okta
          root: Account
      email_body:
        complex:
          root: inputs.UserEmailBody
      email_subject:
        complex:
          root: inputs.UserEmailSubject
      max_digits:
        complex:
          root: inputs.PasswordMaxDigits
      max_lcase:
        complex:
          root: inputs.PasswordMaxLowercase
      max_symbols:
        complex:
          root: inputs.PasswordMaxSymbols
      max_ucase:
        complex:
          root: inputs.PasswordMaxUppercase
      min_digits:
        complex:
          root: inputs.PasswordMinDigits
      min_lcase:
        complex:
          root: inputs.PasswordMinLowercase
      min_symbols:
        complex:
          root: inputs.PasswordMinSymbols
      min_ucase:
        complex:
          root: inputs.PasswordMinUppercase
      temporary_password:
        simple: "true"
      to_email:
        complex:
          accessor: Email
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Account.Type
              operator: isEqualString
              right:
                value:
                  simple: Okta
          root: Account
      username:
        complex:
          accessor: Username
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Account.Type
              operator: isEqualString
              right:
                value:
                  simple: Okta
          root: Account
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: |-
        Generates a password and sets an Okta user account with that password.
        Enables the account.
        Sends an  email to the user with the account information.
        This script runs the `send-mail` command. Make sure there is a mail sender integration configured.
      id: d91445fa-e415-4653-84a8-36aaf8d899d9
      iscommand: false
      name: Reset user password in Okta & send email
      script: IAMInitOktaUser
      type: regular
      version: -1
    taskid: d91445fa-e415-4653-84a8-36aaf8d899d9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 4900
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      username:
        complex:
          accessor: reporteremailaddress
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Fetches information for a single user. You must enter one or more
        parameters for the command to run.
      id: 133709ec-ca09-4580-87ae-383d67d6d2dd
      iscommand: true
      name: Get Okta user information
      script: '|||okta-get-user'
      tags:
      - user_information
      type: regular
      version: -1
    taskid: 133709ec-ca09-4580-87ae-383d67d6d2dd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 4480
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Username
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: Account.Type
                    operator: isEqualString
                    right:
                      value:
                        simple: Okta
                root: Account
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the user was found in Okta.
      id: 47ac33b6-07c2-4426-81a1-a0d184446da6
      iscommand: false
      name: Was a user found in Okta?
      type: condition
      version: -1
    taskid: 47ac33b6-07c2-4426-81a1-a0d184446da6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 4640
        }
      }
  "19":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: IAM.InitADUser.success
          operator: isEqualString
          right:
            value:
              simple: "True"
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: IAM.InitADUser.sentMail
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the password reset was successful, and whether an
        email with the new password was sent successfully.
      id: 49e6e22e-c11b-4a11-84a6-5f11ff64344f
      iscommand: false
      name: Was the password reset successful?
      type: condition
      version: -1
    taskid: 49e6e22e-c11b-4a11-84a6-5f11ff64344f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 5090
        }
      }
  "20":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: IAM.InitOktaUser.success
          operator: isEqualString
          right:
            value:
              simple: "True"
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: IAM.InitOktaUser.sentMail
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the password reset was successful, and whether an
        email with the new password was sent successfully.
      id: e34ffc40-ea90-4aa5-8f38-b013c9eea367
      iscommand: false
      name: Was the password reset successful?
      type: condition
      version: -1
    taskid: e34ffc40-ea90-4aa5-8f38-b013c9eea367
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 5090
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      approvalstatus:
        simple: Not required
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: c5cac7e4-76ad-491d-8322-0a975db2e182
      iscommand: true
      name: Update approval status - not required
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: c5cac7e4-76ad-491d-8322-0a975db2e182
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1260,
          "y": 700
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      approvalstatus:
        simple: Required, but could not be obtained
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Updates the approval status to "could not be obtained".
      id: 154c139a-5482-4541-8dad-70e16f0c0783
      iscommand: true
      name: Update approval status to could not be obtained
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 154c139a-5482-4541-8dad-70e16f0c0783
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 1230
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      approvalstatus:
        simple: Awaiting approval
      approver:
        complex:
          root: UserManagerEmail
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.ApprovalTarget
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Updates the Approver field with the email of the user who is approving
        the reset request, and updates the Approval Status field to "Awaiting approval".
      id: 6e51d23d-2d3b-4fbd-824e-1fd539906580
      iscommand: true
      name: Update approver, and approval status - awaiting approval
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6e51d23d-2d3b-4fbd-824e-1fd539906580
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1035
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      approvalstatus:
        simple: Approved
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Updates the Approval Status field to "Approved".
      id: c87853e6-9c40-4a78-83e6-f243bc1509b4
      iscommand: true
      name: Update approval status - approved
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: c87853e6-9c40-4a78-83e6-f243bc1509b4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 2050
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      approvalstatus:
        simple: Disapproved
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Updates the Approval Status field to "Disapproved".
      id: 372f5506-4ac0-4355-86fd-4a14c698260b
      iscommand: true
      name: Update approval status - disapproved
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 372f5506-4ac0-4355-86fd-4a14c698260b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 2060
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d292b099-cac6-4e53-855a-cd54a6a3a4e6
      iscommand: false
      name: Approval Granted
      type: title
      version: -1
    taskid: d292b099-cac6-4e53-855a-cd54a6a3a4e6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 2230
        }
      }
  "29":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Require2FA
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether 2-Factor Authentication is required for the password
        reset process. This is determined by the "Require2FA" playbook input.
      id: ee3ceeb7-cf11-4ba0-85b4-22b5f66e9150
      iscommand: false
      name: Is 2-Factor Authentication required?
      type: condition
      version: -1
    taskid: ee3ceeb7-cf11-4ba0-85b4-22b5f66e9150
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 2390
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8e375b07-dc1d-4ba5-89fd-f600f05d2f74
      iscommand: false
      name: 2-Factor Authentication
      type: title
      version: -1
    taskid: 8e375b07-dc1d-4ba5-89fd-f600f05d2f74
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 700,
          "y": 2580
        }
      }
  "33":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Verification Status
      output:
        simple: Required
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      username:
        complex:
          accessor: reporteremailaddress
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Returns all the enrolled factors for the specified user.
        Also sets the "Verification Status" as "Required".
      id: c69938e0-afc6-4537-89e0-123d90bdd000
      iscommand: true
      name: Get user verification methods
      script: '|||okta-get-user-factors'
      type: regular
      version: -1
    taskid: c69938e0-afc6-4537-89e0-123d90bdd000
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 700,
          "y": 2710
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ID
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: Account.Factor.Status
                    operator: isEqualString
                    right:
                      value:
                        simple: ACTIVE
                root: Account.Factor
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether an active 2FA method is available for the user who
        requested the password reset.
      id: 382d452a-fd04-4adf-80d5-b8695bc674ea
      iscommand: false
      name: Was a verification method found?
      type: condition
      version: -1
    taskid: 382d452a-fd04-4adf-80d5-b8695bc674ea
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 700,
          "y": 2880
        }
      }
  "35":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Verification Status
      output:
        simple: In Progress
    - incidentfield: Verification Method
      output:
        complex:
          accessor: FactorType
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Account.Factor.Provider
              operator: isEqualString
              right:
                value:
                  simple: OKTA
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Account.Factor.Status
              operator: isEqualString
              right:
                value:
                  simple: ACTIVE
          root: Account.Factor
          transformers:
          - args:
              index:
                value:
                  simple: "0"
            operator: atIndex
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      factorId:
        complex:
          accessor: ID
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Account.Factor.Status
              operator: isEqualString
              right:
                value:
                  simple: ACTIVE
          root: Account.Factor
          transformers:
          - args:
              index:
                value:
                  simple: "0"
            operator: atIndex
      userId:
        complex:
          accessor: ID
          root: Account
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Enrolls and verifies a push factor for the specified user.
        Also sets the "Verification Status" as "In Progress", and the "Verification Method" field with the method that was used for the 2-factor authentication.
      id: b2488f8f-f409-461b-82bf-e7c6af1d004a
      iscommand: true
      name: Verify user
      script: '|||okta-verify-push-factor'
      type: regular
      version: -1
    taskid: b2488f8f-f409-461b-82bf-e7c6af1d004a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 700,
          "y": 3060
        }
      }
  "36":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: VerifyPushResult
                root: Account
          operator: isEqualString
          right:
            value:
              simple: SUCCESS
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the user passed the 2-factor authentication.
      id: 27a82491-8396-4938-8285-08c89c51980a
      iscommand: false
      name: Did the user verify successfully?
      type: condition
      version: -1
    taskid: 27a82491-8396-4938-8285-08c89c51980a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 700,
          "y": 3240
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    scriptarguments:
      verificationstatus:
        simple: Not Required
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Updates the Verification Status field to "Not required".
      id: faaa867c-a86f-4999-82af-b369ec05e487
      iscommand: true
      name: Update verification status - not required
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: faaa867c-a86f-4999-82af-b369ec05e487
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 2710
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    scriptarguments:
      verificationstatus:
        simple: Verified
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Updates the Verification Status field to "Verified".
      id: ba0b5c9a-fe26-4c48-8b1e-907b4594405c
      iscommand: true
      name: Update verification status - verified
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ba0b5c9a-fe26-4c48-8b1e-907b4594405c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 990,
          "y": 3410
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      verificationstatus:
        simple: Failed To Verify
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Updates the Verification Status field to "Failed to verify".
      id: 435a0dd1-5885-46ff-8e24-3ec4680a1e6e
      iscommand: true
      name: Update verification status - failed to verify
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 435a0dd1-5885-46ff-8e24-3ec4680a1e6e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 520,
          "y": 3410
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a86e3b7c-4c8d-4d94-8fb5-947f9a66e1c1
      iscommand: false
      name: Password Protect ZIP
      type: title
      version: -1
    taskid: a86e3b7c-4c8d-4d94-8fb5-947f9a66e1c1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 3620
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      max_digits:
        complex:
          root: inputs.PasswordMaxDigits
      max_lcase:
        complex:
          root: inputs.PasswordMaxLowercase
      max_symbols:
        complex:
          root: inputs.PasswordMaxSymbols
      max_ucase:
        complex:
          root: inputs.PasswordMaxUppercase
      min_digits:
        complex:
          root: inputs.PasswordMinDigits
      min_lcase:
        complex:
          root: inputs.PasswordMinLowercase
      min_symbols:
        complex:
          root: inputs.PasswordMinSymbols
      min_ucase:
        complex:
          root: inputs.PasswordMinUppercase
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Generates a password to protect the ZIP file that contains the user's new password.
        Note: the ZIP file's password is NOT the same as the user's new password.
      id: def2922a-86c4-4bfb-8a90-5db051bf6bf2
      iscommand: false
      name: Generate password for ZIP that will contain the user password
      script: GeneratePassword
      type: regular
      version: -1
    taskid: def2922a-86c4-4bfb-8a90-5db051bf6bf2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 3750
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      ignoreAddURL:
        simple: "true"
      message:
        complex:
          root: NEW_PASSWORD
          transformers:
          - args:
              prefix:
                iscontext: true
                value:
                  simple: inputs.ZipPasswordMessage
              suffix: {}
            operator: concat
      to:
        complex:
          accessor: reporteremailaddress
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends the ZIP file password to the user along with the message
        specified in the "ZipPasswordMessage" playbook input.
      id: 44a45381-22a0-4547-88f1-5b51f229bcf8
      iscommand: true
      name: Send ZIP password to the user on Slack / Teams
      script: '|||send-notification'
      type: regular
      version: -1
    taskid: 44a45381-22a0-4547-88f1-5b51f229bcf8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 3960
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2e76d6c6-5f7d-4426-84be-17f230917bc9
      iscommand: false
      name: Reset & Send Email
      type: title
      version: -1
    taskid: 2e76d6c6-5f7d-4426-84be-17f230917bc9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 4130
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    scriptarguments:
      bodyType:
        simple: text
      email:
        complex:
          root: UserManagerEmail
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.ApprovalTarget
            operator: SetIfEmpty
      message:
        complex:
          root: inputs.ApprovalEmailBody
          transformers:
          - args:
              limit: {}
              replaceWith:
                iscontext: true
                value:
                  simple: incident.reporteremailaddress
              toReplace:
                value:
                  simple: '[PLACEHOLDER]'
            operator: replace
      subject:
        complex:
          root: inputs.ApprovalEmailSubject
      task:
        simple: ApprovalReply
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Asks the approver whether we can proceed with the password reset
        process, in a way that the approver can reply directly to the email without
        needing to access a special link.
      id: 4d93e157-e329-44a3-85d4-48249155e465
      iscommand: false
      name: Ask - is the reset approved?
      script: EmailAskUser
      type: regular
      version: -1
    taskid: 4d93e157-e329-44a3-85d4-48249155e465
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1570
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "No":
      - "26"
      "Yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    sla:
      days: 0
      hours: 0
      minutes: 0
      weeks: 0
    task:
      brand: ""
      description: Waits for the reply from the approver of the password reset. This
        task auto-completes when a reply is received.
      id: 390faa7c-9828-45da-8d44-1cec8dec8f02
      iscommand: false
      name: Was the reset approved? (task auto-completes)
      tags:
      - ApprovalReply
      type: condition
      version: -1
    taskid: 390faa7c-9828-45da-8d44-1cec8dec8f02
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1740
        }
      }
  "48":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.RequireAccessForApprover
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: Email Link (XSOAR Hosted)
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "50"
      Email Link (XSOAR Hosted):
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the person approving the password reset request
        should have access to the XSOAR server's network and thus receive a link to
        approve/disapprove the request, or they should be contacted in a way that
        they can approve/disapprove the request with a simple email reply, without
        needing to have any special network access.
      id: 337b01a8-8330-4189-87bc-9853960d7e7e
      iscommand: false
      name: How should the approver be contacted?
      type: condition
      version: -1
    taskid: 337b01a8-8330-4189-87bc-9853960d7e7e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1230
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5934d2ea-5f5f-4cae-88cc-9c6688773202
      iscommand: false
      name: Approver Has Access For Approval
      type: title
      version: -1
    taskid: 5934d2ea-5f5f-4cae-88cc-9c6688773202
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 260,
          "y": 1440
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 89974cfa-1e4c-4b91-8df3-02aa9275e82e
      iscommand: false
      name: XSOAR not open to internet / Approver missing VPN
      type: title
      version: -1
    taskid: 89974cfa-1e4c-4b91-8df3-02aa9275e82e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1440
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "13_10_#default#": 0.1,
      "13_1_yes": 0.46,
      "14_10_#default#": 0.21,
      "14_12_Active Directory": 0.65,
      "18_10_#default#": 0.1,
      "18_15_yes": 0.42,
      "19_10_#default#": 0.1,
      "19_11_yes": 0.1,
      "20_10_#default#": 0.1,
      "20_11_yes": 0.1,
      "29_31_yes": 0.44,
      "34_10_#default#": 0.15,
      "34_35_yes": 0.51,
      "5_24_Yes, from specified user": 0.53,
      "5_6_Yes, from manager": 0.6,
      "7_23_#default#": 0.2,
      "7_24_yes": 0.53,
      "8_25_Approve Reset": 0.46,
      "8_26_Disapprove Reset": 0.63
    },
    "paper": {
      "dimensions": {
        "height": 5265,
        "width": 2480,
        "x": -300,
        "y": 380
      }
    }
  }
