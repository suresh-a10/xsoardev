category: Vulnerability Management
commonfields:
  id: Rapid7 Nexpose_Developer_Instance
  version: -1
configuration:
- display: Server URL (e.g. https://192.168.0.1:8080)
  name: server
  required: true
  type: 0
- display: Username
  name: credentials
  required: true
  type: 9
- display: Trust any certificate (not secure)
  name: unsecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: 2FA token
  name: token
  required: false
  type: 0
- display: ""
  name: sitename
  required: false
  type: 0
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: Rapid7's on-premise vulnerability management solution, Nexpose, helps
  you reduce your threat exposure by enabling you to assess and respond to changes
  in your environment real time and prioritizing risk across vulnerabilities, configurations,
  and controls.
detaileddescription: ' '
display: Rapid7 Nexpose_Developer_Instance
image: data:image/png;base64,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
name: Rapid7 Nexpose_Developer_Instance
script:
  commands:
  - arguments:
    - description: integer <int64> The identifier of the asset.
      name: id
      required: true
    description: Returns the specified asset.
    name: nexpose-get-asset
    outputs:
    - contextPath: Nexpose.Asset.Addresses
      description: All addresses discovered on the asset.
      type: unknown
    - contextPath: Nexpose.Asset.AssetId
      description: Id of the asset.
      type: number
    - contextPath: Nexpose.Asset.Hardware
      description: The primary Media Access Control (MAC) address of the asset. The
        format is six groups of two hexadecimal digits separated by colons.
      type: string
    - contextPath: Nexpose.Asset.Aliases
      description: All host names or aliases discovered on the asset.
      type: unknown
    - contextPath: Nexpose.Asset.HostType
      description: The type of asset, Valid values are unknown, guest, hypervisor,
        physical, mobile
      type: string
    - contextPath: Nexpose.Asset.Site
      description: Asset site name.
      type: string
    - contextPath: Nexpose.Asset.OperatingSystem
      description: Operating system of the asset.
      type: string
    - contextPath: Nexpose.Asset.Vulnerabilities
      description: The total number of vulnerabilities on the asset.
      type: number
    - contextPath: Nexpose.Asset.CPE
      description: The Common Platform Enumeration (CPE) of the operating system.
      type: string
    - contextPath: Nexpose.Asset.LastScanDate
      description: Last scan date of the asset.
      type: date
    - contextPath: Nexpose.Asset.LastScanId
      description: Id of the asset's last scan.
      type: number
    - contextPath: Nexpose.Asset.RiskScore
      description: The risk score (with criticality adjustments) of the asset.
      type: number
    - contextPath: Nexpose.Asset.Software.Software
      description: The description of the software.
      type: string
    - contextPath: Nexpose.Asset.Software.Version
      description: The version of the software.
      type: string
    - contextPath: Nexpose.Asset.Services.Name
      description: The name of the service.
      type: string
    - contextPath: Nexpose.Asset.Services.Port
      description: The port of the service.
      type: number
    - contextPath: Nexpose.Asset.Services.Product
      description: The product running the service.
      type: string
    - contextPath: Nexpose.Asset.Services.protocol
      description: The protocol of the service, valid values are ip, icmp, igmp, ggp,
        tcp, pup, udp, idp, esp, nd, raw
      type: string
    - contextPath: Nexpose.Asset.Users.FullName
      description: The full name of the user account.
      type: string
    - contextPath: Nexpose.Asset.Users.Name
      description: The name of the user account.
      type: string
    - contextPath: Nexpose.Asset.Users.UserId
      description: The identifier of the user account.
      type: number
    - contextPath: Nexpose.Asset.Vulnerability.Id
      description: The identifier of the vulnerability.
      type: number
    - contextPath: Nexpose.Asset.Vulnerability.Instances
      description: The number of vulnerable occurrences of the vulnerability. This
        does not include invulnerable instances.
      type: number
    - contextPath: Nexpose.Asset.Vulnerability.Title
      description: The title (summary) of the vulnerability.
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.Malware
      description: The malware kits that are known to be used to exploit the vulnerability.
      type: number
    - contextPath: Nexpose.Asset.Vulnerability.Exploit
      description: The exploits that can be used to exploit a vulnerability.
      type: number
    - contextPath: Nexpose.Asset.Vulnerability.CVSS
      description: The CVSS exploit score.
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.Risk
      description: The risk score of the vulnerability, rounded to a maximum of to
        digits of precision. If using the default Rapid7 Real Risk™ model, this value
        ranges from 0-1000.
      type: number
    - contextPath: Nexpose.Asset.Vulnerability.PublishedOn
      description: The date the vulnerability was first published or announced. The
        format is an ISO 8601 date, YYYY-MM-DD.
      type: date
    - contextPath: Nexpose.Asset.Vulnerability.ModifiedOn
      description: The last date the vulnerability was modified. The format is an
        ISO 8601 date, YYYY-MM-DD.
      type: date
    - contextPath: Nexpose.Asset.Vulnerability.Severity
      description: 'The severity of the vulnerability, one of: "Moderate", "Severe",
        "Critical".'
      type: string
    - contextPath: Endpoint.IP
      description: Endpoint IP address.
      type: string
    - contextPath: Endpoint.HostName
      description: Endpoint host name.
      type: string
    - contextPath: Endpoint.OS
      description: Endpoint operating system.
      type: string
    - contextPath: CVE.ID
      description: Common Vulnerabilities and Exposures ids
      type: string
  - arguments:
    - description: 'Multiple criteria of <string> The criteria to sort the records
        by, in the format: property[,ASC|DESC]. The default sort order is ascending.
        Multiple sort criteria can be specified using multiple sort query parameters
        separated by a '';''. For example: ''riskScore,DESC;hostName,ASC'''
      name: sort
    - description: integer <int32> The number of records retrieve.
      name: limit
    description: Returns all assets for which you have access.
    name: nexpose-get-assets
    outputs:
    - contextPath: Nexpose.Asset.AssetId
      description: The identifier of the asset.
      type: number
    - contextPath: Nexpose.Asset.Address
      description: The primary IPv4 or IPv6 address of the asset.
      type: string
    - contextPath: Nexpose.Asset.Name
      description: The primary host name (local or FQDN) of the asset.
      type: string
    - contextPath: Nexpose.Asset.Site
      description: Asset site name.
      type: string
    - contextPath: Nexpose.Asset.Exploits
      description: The number of distinct exploits that can exploit any of the vulnerabilities
        on the asset.
      type: number
    - contextPath: Nexpose.Asset.Malware
      description: The number of distinct malware kits that vulnerabilities on the
        asset are susceptible to.
      type: number
    - contextPath: Nexpose.Asset.OperatingSystem
      description: Operating system of the asset.
      type: string
    - contextPath: Nexpose.Asset.Vulnerabilities
      description: The total number of vulnerabilities.
      type: number
    - contextPath: Nexpose.Asset.RiskScore
      description: The risk score (with criticality adjustments) of the asset.
      type: number
    - contextPath: Nexpose.Asset.Assessed
      description: Whether the asset has been assessed for vulnerabilities at least
        once.
      type: boolean
    - contextPath: Nexpose.Asset.LastScanDate
      description: Last scan date of the asset.
      type: date
    - contextPath: Nexpose.Asset.LastScanId
      description: Id of the asset's last scan.
      type: number
    - contextPath: Endpoint.IP
      description: Endpoint IP address.
      type: string
    - contextPath: Endpoint.HostName
      description: Endpoint host name.
      type: string
    - contextPath: Endpoint.OS
      description: Endpoint operating system.
      type: string
  - arguments:
    - description: 'Multiple criteria of <string> Filter to match assets, according
        to the Search Criteria API standard. multiple filters can be provided using
        '';'' separator. For example: ''ip-address in range 1.2.3.4,1.2.3.8;host-name
        is myhost''. For more information regarding Search Criteria, refer to https://help.rapid7.com/insightvm/en-us/api/index.html#section/Overview/Responses'
      name: query
    - description: integer <int32> The number of records retrieve.
      name: limit
    - description: 'Multiple criteria of <string> The criteria to sort the records
        by, in the format: property[,ASC|DESC]. The default sort order is ascending.
        Multiple sort criteria can be specified using multiple sort query parameters
        separated by a '';''. For example: ''riskScore,DESC;hostName,ASC'''
      name: sort
    - description: <string> Search by a specific IP address
      name: ipAddressIs
    - description: <string> Search by a specific host name
      name: hostNameIs
    - description: <float> Get all assets whose risk score is higher
      name: riskScoreHigherThan
    - description: <string> Search by vulnerability title
      name: vulnerabilityTitleContains
    - description: Multiple criteria of integer<int32> Search by site ids
      name: siteIdIn
    - auto: PREDEFINED
      defaultValue: all
      description: <string> Operator to determine how to match filters. all requires
        that all filters match for an asset to be included. any requires only one
        filter to match for an asset to be included.
      name: match
      predefined:
      - all
      - any
    description: Returns all assets for which you have access that match the given
      search criteria.
    name: nexpose-search-assets
    outputs:
    - contextPath: Nexpose.Asset.AssetId
      description: The identifier of the asset.
      type: number
    - contextPath: Nexpose.Asset.Address
      description: The primary IPv4 or IPv6 address of the asset.
      type: string
    - contextPath: Nexpose.Asset.Name
      description: The primary host name (local or FQDN) of the asset.
      type: string
    - contextPath: Nexpose.Asset.Site
      description: Asset site name.
      type: string
    - contextPath: Nexpose.Asset.Exploits
      description: The number of distinct exploits that can exploit any of the vulnerabilities
        on the asset.
      type: number
    - contextPath: Nexpose.Asset.Malware
      description: The number of distinct malware kits that vulnerabilities on the
        asset are susceptible to.
      type: number
    - contextPath: Nexpose.Asset.OperatingSystem
      description: Operating system of the asset.
      type: string
    - contextPath: Nexpose.Asset.Vulnerabilities
      description: The total number of vulnerabilities.
      type: number
    - contextPath: Nexpose.Asset.RiskScore
      description: The risk score (with criticality adjustments) of the asset.
      type: number
    - contextPath: Nexpose.Asset.Assessed
      description: Whether the asset has been assessed for vulnerabilities at least
        once.
      type: boolean
    - contextPath: Nexpose.Asset.LastScanDate
      description: Last scan date of the asset.
      type: date
    - contextPath: Nexpose.Asset.LastScanId
      description: Id of the asset's last scan.
      type: number
    - contextPath: Endpoint.IP
      description: Endpoint IP address.
      type: string
    - contextPath: Endpoint.HostName
      description: Endpoint host name.
      type: string
    - contextPath: Endpoint.OS
      description: Endpoint operating system.
      type: string
  - arguments:
    - description: Multiple criteria of integer <int64> Identifiers of scans
      isArray: true
      name: id
      required: true
    description: Returns the specified scan.
    name: nexpose-get-scan
    outputs:
    - contextPath: Nexpose.Scan.Id
      description: The identifier of the scan.
      type: number
    - contextPath: Nexpose.Scan.ScanType
      description: The scan type (automated, manual, scheduled).
      type: string
    - contextPath: Nexpose.Scan.StartedBy
      description: The name of the user that started the scan.
      type: string
    - contextPath: Nexpose.Scan.Assets
      description: The number of assets found in the scan
      type: number
    - contextPath: Nexpose.Scan.TotalTime
      description: The duration of the scan in minutes.
      type: string
    - contextPath: Nexpose.Scan.Status
      description: The scan status. Valid values are aborted, unknown, running, finished,
        stopped, error, paused, dispatched, integrating
      type: string
    - contextPath: Nexpose.Scan.Completed
      description: The end time of the scan in ISO8601 format.
      type: date
    - contextPath: Nexpose.Scan.Vulnerabilities.Critical
      description: The number of critical vulnerabilities.
      type: number
    - contextPath: Nexpose.Scan.Vulnerabilities.Moderate
      description: The number of moderate vulnerabilities.
      type: number
    - contextPath: Nexpose.Scan.Vulnerabilities.Severe
      description: The number of severe vulnerabilities.
      type: number
    - contextPath: Nexpose.Scan.Vulnerabilities.Total
      description: The total number of vulnerabilities.
      type: number
  - arguments:
    - description: integer <int64> The identifier of the asset.
      name: id
      required: true
    - description: <string> The identifier of the vulnerability.
      name: vulnerabilityId
      required: true
    description: Returns the details and possible remediations for an asset's given
      vulnerability.
    name: nexpose-get-asset-vulnerability
    outputs:
    - contextPath: Nexpose.Asset.AssetId
      description: Identifier of the asset.
      type: number
    - contextPath: Nexpose.Asset.Vulnerability.Id
      description: The identifier of the vulnerability.
      type: number
    - contextPath: Nexpose.Asset.Vulnerability.Title
      description: The title (summary) of the vulnerability.
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.Severity
      description: 'The severity of the vulnerability, one of: "Moderate", "Severe",
        "Critical".'
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.RiskScore
      description: The risk score of the vulnerability, rounded to a maximum of to
        digits of precision. If using the default Rapid7 Real Risk™ model, this value
        ranges from 0-1000.
      type: number
    - contextPath: Nexpose.Asset.Vulnerability.CVSS
      description: The CVSS vector(s) for the vulnerability.
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.CVSSV3
      description: The CVSS v3 vector.
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.Published
      description: The date the vulnerability was first published or announced. The
        format is an ISO 8601 date, YYYY-MM-DD.
      type: date
    - contextPath: Nexpose.Asset.Vulnerability.Added
      description: The date the vulnerability coverage was added. The format is an
        ISO 8601 date, YYYY-MM-DD.
      type: date
    - contextPath: Nexpose.Asset.Vulnerability.Modified
      description: The last date the vulnerability was modified. The format is an
        ISO 8601 date, YYYY-MM-DD.
      type: date
    - contextPath: Nexpose.Asset.Vulnerability.CVSSScore
      description: The CVSS score, which ranges from 0-10.
      type: number
    - contextPath: Nexpose.Asset.Vulnerability.CVSSV3Score
      description: The CVSS3 score, which ranges from 0-10.
      type: number
    - contextPath: Nexpose.Asset.Vulnerability.Categories
      description: All vulnerability categories assigned to this vulnerability.
      type: unknown
    - contextPath: Nexpose.Asset.Vulnerability.CVES
      description: All CVEs assigned to this vulnerability.
      type: unknown
    - contextPath: Nexpose.Asset.Vulnerability.Check.Port
      description: The port of the service the result was discovered on.
      type: number
    - contextPath: Nexpose.Asset.Vulnerability.Check.Protocol
      description: The protocol of the service the result was discovered on, valid
        values ip, icmp, igmp, ggp, tcp, pup, udp, idp, esp, nd, raw
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.Check.Since
      description: The date and time the result was first recorded, in the ISO8601
        format. If the result changes status this value is the date and time of the
        status change.
      type: date
    - contextPath: Nexpose.Asset.Vulnerability.Check.Proof
      description: The proof explaining why the result was found vulnerable.
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.Check.Status
      description: The status of the vulnerability check result. Valid values are,
        unknown, not-vulnerable, vulnerable, vulnerable-version, vulnerable-potential,
        vulnerable-with-exception-applied, vulnerable-version-with-exception-applied,
        vulnerable-potential-with-exception-applied
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.Solution.Type
      description: 'The type of the solution. One of: "Configuration", "Rollup patch",
        "Patch".'
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.Solution.Summary
      description: The summary of the solution.
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.Solution.Steps
      description: The steps required to remediate the vulnerability.
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.Solution.Estimate
      description: The estimated duration to apply the solution, in minutes.
      type: string
    - contextPath: Nexpose.Asset.Vulnerability.Solution.AdditionalInformation
      description: Additional information or resources that can assist in applying
        the remediation
      type: string
    - contextPath: CVE.ID
      description: Common Vulnerabilities and Exposures ids
      type: string
  - arguments:
    - description: <string> The site name. Name must be unique.
      name: name
      required: true
    - description: <string> The site's description.
      name: description
    - description: Multiple criteria of <string> Specify asset addresses to be included
        in site scans
      isArray: true
      name: assets
      required: true
    - description: '<string> The identifier of a scan template. Use nexpose-get-report-templates
        to get all templates,  default scan template is selected when not specified. '
      name: scanTemplateId
    - auto: PREDEFINED
      description: <string> The site importance. Defaults to "normal" if not specified.
      name: importance
      predefined:
      - very_low
      - low
      - normal
      - high
      - very_high
    description: Creates a new site with the specified configuration.
    name: nexpose-create-site
    outputs:
    - contextPath: Nexpose.Site.Id
      description: The created site Id
      type: number
  - arguments:
    - description: Id of the site to delete
      name: id
      required: true
    description: Deletes a site.
    name: nexpose-delete-site
  - arguments:
    - description: integer <int32> The number of records retrieve.
      name: limit
    - description: 'Multiple criteria of <string> The criteria to sort the records
        by, in the format: property[,ASC|DESC]. The default sort order is ascending.
        Multiple sort criteria can be specified using multiple sort query parameters
        separated by a '';''. For example: ''riskScore,DESC;hostName,ASC'''
      name: sort
    description: Retrieves accessible sites.
    name: nexpose-get-sites
    outputs:
    - contextPath: Nexpose.Site.Id
      description: The identifier of the site.
      type: number
    - contextPath: Nexpose.Site.Name
      description: The site name.
      type: string
    - contextPath: Nexpose.Site.Assets
      description: The number of assets that belong to the site.
      type: number
    - contextPath: Nexpose.Site.Type
      description: The type of the site. Valid values are agent, dynamic, static
      type: string
    - contextPath: Nexpose.Site.Vulnerabilities
      description: The total number of vulnerabilities.
      type: number
    - contextPath: Nexpose.Site.Risk
      description: The risk score (with criticality adjustments) of the site.
      type: number
    - contextPath: Nexpose.Site.LastScan
      description: The date and time of the site's last scan.
      type: date
  - arguments: []
    description: Returns all available report templates.
    name: nexpose-get-report-templates
    outputs:
    - contextPath: Nexpose.Template.Id
      description: The identifier of the report template.
      type: number
    - contextPath: Nexpose.Template.Name
      description: The name of the report template.
      type: string
    - contextPath: Nexpose.Template.Description
      description: The description of the report template.
      type: string
    - contextPath: Nexpose.Template.Type
      description: The type of the report template. document is a templatized, typically
        printable, report that has various sections of content. export is data-oriented
        output, typically CSV. file is a printable report template using a report
        template file.
      type: string
  - arguments:
    - description: Multiple criteria of integer<int64> Asset ids to create the report
        on, comma separated.
      name: assets
      required: true
    - description: <string> Report template id to create the report with. If none
        is provided, the first template available will be used.
      name: template
    - description: <string> The report name
      name: name
    - auto: PREDEFINED
      description: <string> The report format, default is PDF
      name: format
      predefined:
      - pdf
      - rtf
      - xml
      - html
      - text
    description: Generates a new report on given assets according to a template and
      arguments.
    name: nexpose-create-assets-report
    outputs:
    - contextPath: InfoFile.EntryId
      description: Entry Id of the report file
      type: string
    - contextPath: InfoFile.Name
      description: Name of the report file
      type: string
    - contextPath: InfoFile.Extension
      description: File extension of the report file
      type: string
    - contextPath: InfoFile.Info
      description: Info about the report file
      type: string
    - contextPath: InfoFile.Size
      description: Size of the report file
      type: number
    - contextPath: InfoFile.Type
      description: Type of the report file
      type: string
  - arguments:
    - description: Multiple criteria of integer<int32> Site ids to create the report
        on, comma separated.
      name: sites
      required: true
    - description: <string> Report template id to create the report with. If none
        is provided, the first template available will be used.
      name: template
    - description: <string> The report name
      name: name
    - auto: PREDEFINED
      description: <string> The report format, default is PDF
      name: format
      predefined:
      - pdf
      - rtf
      - xml
      - html
      - text
    description: Generates a new report on given sites according to a template and
      arguments.
    name: nexpose-create-sites-report
    outputs:
    - contextPath: InfoFile.EntryId
      description: Entry Id of the report file
      type: string
    - contextPath: InfoFile.Name
      description: Name of the report file
      type: string
    - contextPath: InfoFile.Extension
      description: File extension of the report file
      type: string
    - contextPath: InfoFile.Info
      description: Info about the report file
      type: string
    - contextPath: InfoFile.Size
      description: Size of the report file
      type: number
    - contextPath: InfoFile.Type
      description: Type of the report file
      type: string
  - arguments:
    - description: integer <int64> The identifier of the scan.
      name: scan
      required: true
    - description: <string> Report template id to create the report with. If none
        is provided, the first template available will be used.
      name: template
    - description: <string> The report name
      name: name
    - auto: PREDEFINED
      description: <string> The report format, default is PDF
      name: format
      predefined:
      - pdf
      - rtf
      - xml
      - html
      - text
    description: Generates a new report for a specified scan.
    name: nexpose-create-scan-report
    outputs:
    - contextPath: InfoFile.EntryId
      description: Entry Id of the report file
      type: string
    - contextPath: InfoFile.Name
      description: Name of the report file
      type: string
    - contextPath: InfoFile.Extension
      description: File extension of the report file
      type: string
    - contextPath: InfoFile.Info
      description: Info about the report file
      type: string
    - contextPath: InfoFile.Size
      description: Size of the report file
      type: number
    - contextPath: InfoFile.Type
      description: Type of the report file
      type: string
  - arguments:
    - description: integer <int32> The identifier of the site.
      name: site
      required: true
    - description: Multiple criteria of <string> The hosts that should be included
        as a part of the scan. This should be a mixture of IP Addresses and host names
        as a comma separated string array.
      isArray: true
      name: hosts
    - description: <string> The user-driven scan name for the scan.
      name: name
    description: Starts a scan for the specified site.
    name: nexpose-start-site-scan
    outputs:
    - contextPath: Nexpose.Scan.Id
      description: The identifier of the scan.
      type: number
    - contextPath: Nexpose.Scan.ScanType
      description: The scan type (automated, manual, scheduled).
      type: string
    - contextPath: Nexpose.Scan.StartedBy
      description: The name of the user that started the scan.
      type: date
    - contextPath: Nexpose.Scan.Assets
      description: The number of assets found in the scan
      type: number
    - contextPath: Nexpose.Scan.TotalTime
      description: The duration of the scan in minutes.
      type: string
    - contextPath: Nexpose.Scan.Completed
      description: The end time of the scan in ISO8601 format.
      type: date
    - contextPath: Nexpose.Scan.Status
      description: The scan status. Valid values are aborted, unknown, running, finished,
        stopped, error, paused, dispatched, integrating
      type: string
    - contextPath: Nexpose.Scan.Vulnerabilities.Critical
      description: The number of critical vulnerabilities.
      type: number
    - contextPath: Nexpose.Scan.Vulnerabilities.Moderate
      description: The number of moderate vulnerabilities.
      type: number
    - contextPath: Nexpose.Scan.Vulnerabilities.Severe
      description: The number of severe vulnerabilities.
      type: number
    - contextPath: Nexpose.Scan.Vulnerabilities.Total
      description: The total number of vulnerabilities.
      type: number
  - arguments:
    - description: Multiple criteria of <string> IP addresses of assets, comma separated.
      name: IPs
    - description: Multiple criteria of <string> Host names of assets, comma separated.
      name: hostNames
    - description: <string> The user-driven scan name for the scan.
      name: name
    description: Starts a scan for specified asset IP addresses and host names.
    name: nexpose-start-assets-scan
    outputs:
    - contextPath: Nexpose.Scan.Id
      description: The identifier of the scan.
      type: number
    - contextPath: Nexpose.Scan.ScanType
      description: The scan type (automated, manual, scheduled).
      type: string
    - contextPath: Nexpose.Scan.StartedBy
      description: The name of the user that started the scan.
      type: date
    - contextPath: Nexpose.Scan.Assets
      description: The number of assets found in the scan
      type: number
    - contextPath: Nexpose.Scan.TotalTime
      description: The duration of the scan in minutes.
      type: string
    - contextPath: Nexpose.Scan.Completed
      description: The end time of the scan in ISO8601 format.
      type: date
    - contextPath: Nexpose.Scan.Status
      description: The scan status. Valid values are aborted, unknown, running, finished,
        stopped, error, paused, dispatched, integrating
      type: string
    - contextPath: Nexpose.Scan.Vulnerabilities.Critical
      description: The number of critical vulnerabilities.
      type: number
    - contextPath: Nexpose.Scan.Vulnerabilities.Moderate
      description: The number of moderate vulnerabilities.
      type: number
    - contextPath: Nexpose.Scan.Vulnerabilities.Severe
      description: The number of severe vulnerabilities.
      type: number
    - contextPath: Nexpose.Scan.Vulnerabilities.Total
      description: The total number of vulnerabilities.
      type: number
  - arguments:
    - description: integer <int64> ID of the scan to stop.
      name: id
      required: true
    description: Stop the specified scan
    name: nexpose-stop-scan
  - arguments:
    - description: integer <int64> ID of the scan to pause.
      name: id
      required: true
    description: Pause the specified scan
    name: nexpose-pause-scan
  - arguments:
    - description: integer <int64> ID of the scan to resume.
      name: id
      required: true
    description: Resume the specified scan
    name: nexpose-resume-scan
  - arguments:
    - auto: PREDEFINED
      defaultValue: "true"
      description: <boolean> Return active or past scans.
      name: active
      predefined:
      - "true"
      - "false"
    - defaultValue: "10"
      description: integer <int32> The number of records retrieve.
      name: limit
    - description: 'Multiple criteria of <string> The criteria to sort the records
        by, in the format: property[,ASC|DESC]. The default sort order is ascending.
        Multiple sort criteria can be specified using multiple sort query parameters
        separated by a '';''. For example: ''riskScore,DESC;hostName,ASC'''
      name: sort
    description: Returns a list of scans.
    name: nexpose-get-scans
    outputs:
    - contextPath: Nexpose.Scan.Id
      description: The identifier of the scan.
      type: number
    - contextPath: Nexpose.Scan.ScanType
      description: The scan type (automated, manual, scheduled).
      type: string
    - contextPath: Nexpose.Scan.StartedBy
      description: The name of the user that started the scan.
      type: date
    - contextPath: Nexpose.Scan.Assets
      description: The number of assets found in the scan
      type: number
    - contextPath: Nexpose.Scan.TotalTime
      description: The duration of the scan in minutes.
      type: string
    - contextPath: Nexpose.Scan.Completed
      description: The end time of the scan in ISO8601 format.
      type: date
    - contextPath: Nexpose.Scan.Status
      description: The scan status. Valid values are aborted, unknown, running, finished,
        stopped, error, paused, dispatched, integrating
      type: string
  - arguments: []
    description: Returns site details
    name: nexpose-get-site-details
    outputs:
    - contextPath: site_id
      description: Returns site id
      type: number
    - contextPath: scan_engine
      type: string
    - contextPath: scan_template
      type: string
  runonce: false
  script: |-
    import time
    import re
    import requests
    import json



    # disable insecure warnings
    requests.packages.urllib3.disable_warnings()



    def get_server_url():
        url = demisto.params()['server']
        url=re.sub('/[\/]+$/','',url)
        url=re.sub('\/$','',url)
        #print(url)
        return url



    BASE_URL=get_server_url()
    SERVER_URL=BASE_URL + '/api/3'
    USERNAME = demisto.params()['credentials']['identifier']
    PASSWORD = demisto.params()['credentials']['password']
    VERIFY_SSL=not demisto.params().get('unsecure', False)
    site_name=demisto.params()['sitename']
    def get_login_headers():
        userpass=USERNAME+":"+PASSWORD
        #print(userpass)
        credentials=base64.b64encode(userpass.encode('ascii')).decode()
        #print(credentials)
        headers={
            "Authorization":"Basic %s" % credentials,
            "Content-Type":"application/json"
        }
        return headers

    def test_module():
        headers=get_login_headers()
        url = SERVER_URL + '/sites'
        res = requests.request("GET", url, headers=headers,verify=VERIFY_SSL)
        if res.status_code <= 200 or res.status_code >= 300:
            return 'ok'
        else:
            return res

    def get_site_id():
        site_id=''
        headers=get_login_headers()
        url = SERVER_URL + '/sites'
        res = requests.request("GET", url, headers=headers,verify=VERIFY_SSL)
        if res.status_code < 200 or res.status_code >= 300:
            return ''
        response=res.json()
        for doc in response['resources']:
            getSiteName=doc["name"]
            if(getSiteName==site_name):
                site_id=doc["id"]
                scan_engine=doc["scanEngine"]
                scan_template=doc["scanTemplate"]
                break
        return {
            'site_id':site_id,
            'scan_engine':scan_engine,
            'scan_template':scan_template
        }
    def main():
        #print("Hello")
        if demisto.command() =='nexpose-get-site-details':
            demisto.results(get_site_id())
        if demisto.command() =='test-module':
            result = test_module()
            return_results(result)



    if __name__ == "__builtin__" or __name__ == "__main__" or __name__ == "builtins":
        main()
  subtype: python2
  type: python
sourcemoduleid: Rapid7 Nexpose
