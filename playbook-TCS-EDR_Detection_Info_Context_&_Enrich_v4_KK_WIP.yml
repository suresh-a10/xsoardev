contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 35247a17-7794-4dbc-887a-06b29a527216
inputs: []
name: TCS-EDR Detection Info Context & Enrich v4_KK_WIP
outputs: []
quiet: true
sourceplaybookid: 58a33f37-14f8-4fae-8ec5-ee4d39f9ff19
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
      - "53"
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 572914dd-c6f8-4c44-8867-2fbf41f82c81
      iscommand: false
      name: ""
      version: -1
    taskid: 572914dd-c6f8-4c44-8867-2fbf41f82c81
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 410,
          "y": -1505
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ParentProcessID
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ParentProcessID
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ff09805b-6962-4b71-8a16-9e69bb610df3
      iscommand: false
      name: Is There Context ParentProcessID ?
      type: condition
      version: -1
    taskid: ff09805b-6962-4b71-8a16-9e69bb610df3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": 190
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeparentprocessid:
        complex:
          accessor: ParentProcessID
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: a9419377-dd73-4682-88be-7b187b8262a5
      iscommand: true
      name: Set Context ParentProcessID
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: a9419377-dd73-4682-88be-7b187b8262a5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 400
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: FileName
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: FileName
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3baa85f4-0982-438d-8f8c-56d19d4149c0
      iscommand: false
      name: Is There Context FileName ?
      type: condition
      version: -1
    taskid: 3baa85f4-0982-438d-8f8c-56d19d4149c0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 190
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikefilename:
        complex:
          accessor: FileName
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f50df65a-8ff4-4ecd-80ec-74de8f94fff2
      iscommand: true
      name: Set Context FileName
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f50df65a-8ff4-4ecd-80ec-74de8f94fff2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 400
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6264e60c-0fbc-4d29-8351-9c1fba3f1357
      iscommand: false
      name: Check If There Are Any Reports
      type: title
      version: -1
    taskid: 6264e60c-0fbc-4d29-8351-9c1fba3f1357
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1195
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: SHA256
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: SHA256
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b73dd8ea-320d-42c2-8fde-a9d30aa08c12
      iscommand: false
      name: Is There Context SHA256?
      type: condition
      version: -1
    taskid: b73dd8ea-320d-42c2-8fde-a9d30aa08c12
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 190
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      crowdstrikefilehash:
        complex:
          accessor: SHA256
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: '"'
            operator: split
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 153025a8-497e-4d17-8d5b-aed27cfade4c
      iscommand: true
      name: Set Context SHA256
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 153025a8-497e-4d17-8d5b-aed27cfade4c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 400
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: UserName
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: UserName
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e4c63d51-840e-4266-8144-ba43d6b7e00e
      iscommand: false
      name: Is There Context UserName?
      type: condition
      version: -1
    taskid: e4c63d51-840e-4266-8144-ba43d6b7e00e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 190
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeusername:
        complex:
          accessor: UserName
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 967279c5-c89f-43ae-81ea-eef83681addd
      iscommand: true
      name: Set Context UserName
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 967279c5-c89f-43ae-81ea-eef83681addd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 400
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LocalIP
                root: CrowdStrike.Device
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LocalIP
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 97c5d611-573e-4699-876c-90902f80c512
      iscommand: false
      name: Is There Context LocalIP ?
      type: condition
      version: -1
    taskid: 97c5d611-573e-4699-876c-90902f80c512
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2640,
          "y": 190
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeinternalipaddress:
        complex:
          accessor: LocalIP
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8708ee2a-6f24-40ad-82de-3674f93a5bb9
      iscommand: true
      name: Set Context LocalIP
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8708ee2a-6f24-40ad-82de-3674f93a5bb9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2640,
          "y": 390
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ExternalIP
                root: CrowdStrike.Device
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ExternalIP
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 369376df-4b40-4602-885b-a594131e6b1d
      iscommand: false
      name: Is There Context ExternalIP ?
      type: condition
      version: -1
    taskid: 369376df-4b40-4602-885b-a594131e6b1d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3090,
          "y": 190
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeexternalipaddress:
        complex:
          accessor: ExternalIP
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 14677e59-4f53-4024-8d07-fd7c622072b6
      iscommand: true
      name: Set Context ExternalIP
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 14677e59-4f53-4024-8d07-fd7c622072b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3090,
          "y": 390
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: CommandLine
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: CommandLine
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c49c3021-24a9-41dd-8709-a12d6cec855e
      iscommand: false
      name: Is There Context CommandLine ?
      type: condition
      version: -1
    taskid: c49c3021-24a9-41dd-8709-a12d6cec855e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3540,
          "y": 190
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikecmdline:
        complex:
          accessor: CommandLine
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fd4eb1ad-1cb1-45ba-8531-795312ce1a3c
      iscommand: true
      name: 'Set Context CommandLine '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: fd4eb1ad-1cb1-45ba-8531-795312ce1a3c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3540,
          "y": 390
        }
      }
  "16":
    continueonerror: true
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        complex:
          accessor: crowdstrikeusername
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: Active Directory Query v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a user account. The user can
        be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filter is specified, all users are returned.
      id: 0bba5173-e17e-4e45-8cb4-796b849d217e
      iscommand: true
      name: Get User Information From AD
      script: Active Directory Query v2|||ad-get-user
      tags:
      - ADRESULT
      type: regular
      version: -1
    taskid: 0bba5173-e17e-4e45-8cb4-796b849d217e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 780
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: System
                root: CrowdStrike.Detection
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: System
                root: CrowdStrike.Detection
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 860442d1-e2dc-451f-84da-47c9439dc0ae
      iscommand: false
      name: Is There Context System ?
      type: condition
      version: -1
    taskid: 860442d1-e2dc-451f-84da-47c9439dc0ae
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3980,
          "y": 190
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikehostname:
        complex:
          accessor: System
          root: CrowdStrike.Detection
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 4f484c23-3986-4f44-8d68-45ae253322aa
      iscommand: true
      name: Set Context System
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 4f484c23-3986-4f44-8d68-45ae253322aa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3980,
          "y": 400
        }
      }
  "19":
    continueonerror: true
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        complex:
          accessor: crowdstrikehostname
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: Active Directory Query v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a computer account. The computer
        can be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filters are provided, all computers are returned.
      id: fd0998c2-faa9-48bb-866c-f32c518c4a2a
      iscommand: true
      name: Get Computer Info From AD
      script: Active Directory Query v2|||ad-get-computer
      tags:
      - ADRESULT
      type: regular
      version: -1
    taskid: fd0998c2-faa9-48bb-866c-f32c518c4a2a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": -170
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOCValue
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOCValue
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 070b1e2b-c7b5-4673-8d1e-e74377aaf470
      iscommand: false
      name: Is There Context IOCValue
      type: condition
      version: -1
    taskid: 070b1e2b-c7b5-4673-8d1e-e74377aaf470
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4440,
          "y": 190
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Scenario
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Scenario
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 217a1a64-19d5-489e-80c4-aec1163b7b6b
      iscommand: false
      name: Is There Context Scenario
      type: condition
      version: -1
    taskid: 217a1a64-19d5-489e-80c4-aec1163b7b6b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4870,
          "y": 190
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      csiocvalue:
        complex:
          accessor: IOCValue
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: InnerServicesModule
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 3acf8863-c6df-4383-8833-14a64c742806
      iscommand: true
      name: Set Context IOCValue
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 3acf8863-c6df-4383-8833-14a64c742806
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4440,
          "y": 380
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: csiocvalue
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 1e891e68-bae6-4b73-83e7-0384f11b8854
      iscommand: true
      name: Enrich IOC
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 1e891e68-bae6-4b73-83e7-0384f11b8854
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4440,
          "y": 570
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: SHA256
          root: CrowdStrike.Detection.Behavior
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 7c77e30f-487f-434d-811b-cc18c5fa8da3
      iscommand: true
      name: Enrich IOC
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 7c77e30f-487f-434d-811b-cc18c5fa8da3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 570
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      csscenario:
        complex:
          accessor: Scenario
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: InnerServicesModule
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 5069014f-25ca-4e99-84e4-5e05f1d20e22
      iscommand: true
      name: Set Context Scenario
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 5069014f-25ca-4e99-84e4-5e05f1d20e22
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4870,
          "y": 380
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: description
                root: CrowdStrike.Detections.behaviors
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: description
                root: CrowdStrike.Detections.behaviors
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ade49a3c-180d-4dc4-804a-6ea5436a5994
      iscommand: false
      name: Is There description ?
      type: condition
      version: -1
    taskid: ade49a3c-180d-4dc4-804a-6ea5436a5994
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 0,
          "y": 190
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      descriptionoffense:
        complex:
          accessor: description
          root: CrowdStrike.Detections.behaviors
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: dcfe46e2-3757-412a-853d-2184c9bfda9e
      iscommand: true
      name: Set Context Description
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: dcfe46e2-3757-412a-853d-2184c9bfda9e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 0,
          "y": 400
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tactic
                root: CrowdStrike.Detections.behaviors
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tactic
                root: CrowdStrike.Detections.behaviors
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5e329ee3-6c85-4bc0-843b-4bed25e595f3
      iscommand: false
      name: Is There tactic?
      type: condition
      version: -1
    taskid: 5e329ee3-6c85-4bc0-843b-4bed25e595f3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -440,
          "y": 190
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstriketactic:
        complex:
          accessor: tactic
          root: CrowdStrike.Detections.behaviors
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      descriptionoffense:
        complex:
          accessor: description
          root: CrowdStrike.Detections.behaviors
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fde3078b-a9b3-4dc2-8ad0-04d2896387f6
      iscommand: true
      name: Set Context tactic
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: fde3078b-a9b3-4dc2-8ad0-04d2896387f6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -440,
          "y": 400
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: technique
                root: CrowdStrike.Detections.behaviors
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: technique
                root: CrowdStrike.Detections.behaviors
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 08490366-eb98-4cbb-8867-c9dfc46f858e
      iscommand: false
      name: Is There technique?
      type: condition
      version: -1
    taskid: 08490366-eb98-4cbb-8867-c9dfc46f858e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -880,
          "y": 190
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstriketechnique:
        complex:
          accessor: technique
          root: CrowdStrike.Detections.behaviors
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 9184e5fa-6601-4013-8506-a3e9a7f1e111
      iscommand: true
      name: Set Context technique
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 9184e5fa-6601-4013-8506-a3e9a7f1e111
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -880,
          "y": 400
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: parent_cmdline
                root: CrowdStrike.Detections.behaviors.parent_details
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: parent_cmdline
                root: CrowdStrike.Detections.behaviors.parent_details
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c8e7f661-f6d6-45fc-8c7f-998cd859b2cd
      iscommand: false
      name: Is There parent_cmdline?
      type: condition
      version: -1
    taskid: c8e7f661-f6d6-45fc-8c7f-998cd859b2cd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1320,
          "y": 190
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      csparentcmdline:
        complex:
          accessor: parent_cmdline
          root: CrowdStrike.Detections.behaviors.parent_details
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 74df9a13-9f2d-4d57-8d2a-efc1e66fb033
      iscommand: true
      name: Set Context parent_cmdline
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 74df9a13-9f2d-4d57-8d2a-efc1e66fb033
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1320,
          "y": 400
        }
      }
  "36":
    continueonerror: true
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      retry-count:
        simple: "3"
      using:
        simple: Active Directory Query v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a user account. The user can
        be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filter is specified, all users are returned.
      id: c016dff0-796f-4af4-80e3-206923ecfa95
      iscommand: true
      name: Get User Information From AD
      script: Active Directory Query v2|||ad-get-user
      tags:
      - ADRESULT
      type: regular
      version: -1
    taskid: c016dff0-796f-4af4-80e3-206923ecfa95
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 780
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikeusername
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: '@'
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      - "59"
      - "63"
      - "67"
      "yes":
      - "36"
      - "58"
      - "62"
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 89634a3b-9f17-4812-819f-a72baacf3c9b
      iscommand: false
      name: Does The Username Contain @ ?
      type: condition
      version: -1
    taskid: 89634a3b-9f17-4812-819f-a72baacf3c9b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 570
        }
      }
  "38":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Status
                root: WildFire.Report
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Status
                root: WildFire.Report
          operator: isEqualString
          right:
            value:
              simple: Success
      label: "yes"
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a944e4c0-5d2a-4866-80e8-f0122fd7b673
      iscommand: false
      name: Is There Context WildFire ?
      type: condition
      version: -1
    taskid: a944e4c0-5d2a-4866-80e8-f0122fd7b673
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1320
        }
      }
  "39":
    continueonerror: true
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Wild Fire Report
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 2
    scriptarguments:
      sha256:
        complex:
          accessor: SHA256
          root: WildFire.Report
      using:
        simple: WildFire-v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: WildFire-v2
      description: Retrieves results for a file hash using WildFire.
      id: a94c71ac-546e-4e49-8bb7-5c24dc612b6c
      iscommand: true
      name: Get Wild Fire Report
      script: WildFire-v2|||wildfire-report
      tags:
      - sandboxreport
      type: regular
      version: -1
    taskid: a94c71ac-546e-4e49-8bb7-5c24dc612b6c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1550
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8001d87e-f025-4040-85c6-95d6ac4cd896
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 8001d87e-f025-4040-85c6-95d6ac4cd896
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1770
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        simple: ${incident.crowdstrikedetectionid}
      retry-count:
        simple: "3"
      using:
        simple: ${incident.sourceInstance}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Search for details of specific detections, either using a filter
        query, or by providing the IDs of the detections.
      id: 1c6c776a-c6c3-4f64-8a99-97fca9c2eeff
      iscommand: true
      name: Fetch Detection Details CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-search-detection
      type: regular
      version: -1
    taskid: 1c6c776a-c6c3-4f64-8a99-97fca9c2eeff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": -1150
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        simple: ${incident.crowdstrikedetectionid}
      retry-count:
        simple: "3"
      using:
        simple: ${incident.sourceInstance}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Lists detection summaries.
      id: f04a3a67-99d1-4a48-88e7-d531dac52c70
      iscommand: true
      name: Fetch Detection Summary CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-list-detection-summaries
      type: regular
      version: -1
    taskid: f04a3a67-99d1-4a48-88e7-d531dac52c70
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": -950
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
      - "33"
      - "31"
      - "29"
      - "27"
      - "3"
      - "6"
      - "8"
      - "10"
      - "12"
      - "14"
      - "19"
      - "20"
      - "22"
      - "50"
      - "48"
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          accessor: crowdstrikehostname
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: ${incident.sourceInstance}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: 05854b0c-5bfe-468e-8b84-6cb31dd9a246
      iscommand: true
      name: Fetch Host Details
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: 05854b0c-5bfe-468e-8b84-6cb31dd9a246
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": -640
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikedetectionid
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e9f93ead-90da-4e0e-82b5-47d73272beed
      iscommand: false
      name: Is There A CrowdStrike Detection ?
      type: condition
      version: -1
    taskid: e9f93ead-90da-4e0e-82b5-47d73272beed
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": -1330
        }
      }
  "48":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketacticid
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a17aef56-70bb-46a3-8cd5-5064e75db1d3
      iscommand: false
      name: Is There Tactic id ?
      type: condition
      version: -1
    taskid: a17aef56-70bb-46a3-8cd5-5064e75db1d3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1760,
          "y": 190
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: crowdstriketacticid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: efadc168-d8e0-41c3-8548-e69f35b4a898
      iscommand: true
      name: Enrich MITRE Id
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: efadc168-d8e0-41c3-8548-e69f35b4a898
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1760,
          "y": 400
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketechniqueid
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8f876789-af78-430f-8397-8e0a8f63ffea
      iscommand: false
      name: Is There Technique id ?
      type: condition
      version: -1
    taskid: 8f876789-af78-430f-8397-8e0a8f63ffea
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2170,
          "y": 190
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: crowdstriketechniqueid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 2e5b5bc7-2f66-45a1-823c-831998321c59
      iscommand: true
      name: Enrich MITRE Id
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 2e5b5bc7-2f66-45a1-823c-831998321c59
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2170,
          "y": 400
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      playbookrepository:
        simple: https://tcscomprod.sharepoint.com/:f:/r/sites/CSOC/Shared%20Documents/General/Usecases%20Information/Usecase%20Documentation/Knowledge%20Repository?csf=1&web=1&e=V9To8P
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: a8a2aa2c-255e-4f8e-83bc-202f221bb21d
      iscommand: true
      name: 'Set Playbook Repository Link '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: a8a2aa2c-255e-4f8e-83bc-202f221bb21d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2600,
          "y": 400
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      prioritymatrix:
        simple: |-
          <table style="height: 212px; border-style: solid; width: 658px; background-color: #ffffff;" width="658">
          <tbody>
          <tr style="height: 46px;">
          <td style="height: 92px; width: 199.688px; border-style: solid;" colspan="2" rowspan="2">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Priority</span><span style="color: #0000ff;"> Matrix</span></strong></h3>
          </td>
          <td style="height: 46px; width: 442.312px; border-style: solid;" colspan="3">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Impact</span></strong></h3>
          </td>
          </tr>
          <tr style="height: 46px;">
          <td style="height: 46px; width: 124.094px; border-style: solid;">
          <h3><strong>&nbsp;1 - High</strong></h3>
          </td>
          <td style="height: 46px; width: 120.297px; border-style: solid;">
          <h3><strong>&nbsp;2 - Medium</strong></h3>
          </td>
          <td style="height: 46px; width: 185.922px; border-style: solid;">
          <h3><strong>&nbsp;3 - Low</strong></h3>
          </td>
          </tr>
          <tr style="height: 46px;">
          <td style="height: 120px; width: 93.25px; border-style: solid;" rowspan="3">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Urgency</span></strong></h3>
          </td>
          <td style="height: 46px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;1 - High</strong></h3>
          </td>
          <td style="height: 46px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff0000;">0- Critical</span></strong></h3>
          </td>
          <td style="height: 46px; width: 120.297px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff9900;">1 - High</span></strong></h3>
          </td>
          <td style="height: 46px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #00ccff;">2 - Medium</span></strong></h3>
          </td>
          </tr>
          <tr style="height: 64px;">
          <td style="height: 64px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;2 - Medium</strong></h3>
          </td>
          <td style="height: 64px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff9900;">1 - High</span></strong></h3>
          </td>
          <td style="height: 64px; width: 120.297px; border-style: solid;">
          <h3><strong><span style="color: #00ccff;">&nbsp;2 - Medium</span></strong></h3>
          </td>
          <td style="height: 64px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<span style="color: #ff00ff;"><strong>3 - Low</strong></span></h3>
          </td>
          </tr>
          <tr style="height: 10px;">
          <td style="height: 10px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;3 - Low</strong></h3>
          </td>
          <td style="height: 10px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<span style="color: #00ccff;"><strong>2 - Medium</strong></span></h3>
          </td>
          <td style="height: 10px; width: 120.297px; border-style: solid;">
          <h3><span style="color: #ff00ff;">&nbsp;<strong>3 - Low</strong></span></h3>
          </td>
          <td style="height: 10px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #339966;">4 - Informational</span></strong></h3>
          </td>
          </tr>
          </tbody>
          </table>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f300beae-0eae-4d66-87b4-f2414fcf8eee
      iscommand: true
      name: Set Priority Matrix Table
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f300beae-0eae-4d66-87b4-f2414fcf8eee
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -3030,
          "y": 400
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: true
    quietmode: 0
    scriptarguments:
      fieldExactMatch:
        simple: incident.crowdstrikehostname
      fromDate:
        simple: 12 months ago
      similarTextField:
        simple: incident.crowdstrikehostname
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Find past similar incidents based on incident fields' similarity.
        Includes an option to also display indicators similarity.
      id: 60997e11-f892-4735-853f-ef2fd44ad534
      iscommand: false
      name: Find Past Detection For Same Host
      script: DBotFindSimilarIncidents
      tags:
      - Note
      - pastevents
      type: regular
      version: -1
    taskid: 60997e11-f892-4735-853f-ef2fd44ad534
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 5310,
          "y": 190
        }
      }
  "57":
    continueonerror: true
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      hostname:
        complex:
          accessor: crowdstrikehostname
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: 762755b2-d75f-47ad-82b8-ef7d5db4a7a2
      iscommand: true
      name: Get Computer Info From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: 762755b2-d75f-47ad-82b8-ef7d5db4a7a2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": 10
        }
      }
  "58":
    continueonerror: true
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      empid:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: fa402daa-9883-45ab-8d84-ac5f2c4fea78
      iscommand: true
      name: Get User Information From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: fa402daa-9883-45ab-8d84-ac5f2c4fea78
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2570,
          "y": 780
        }
      }
  "59":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikeusername
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsGeneral
          right:
            value:
              simple: ad.
      label: "yes"
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b9ff47f5-6324-4075-8494-74713afc41e7
      iscommand: false
      name: Does The Username Contain "ad."?
      type: condition
      version: -1
    taskid: b9ff47f5-6324-4075-8494-74713afc41e7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 780
        }
      }
  "60":
    continueonerror: true
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      empid:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              from:
                value:
                  simple: .
            operator: substringFrom
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: 8f925fbe-190e-45d9-837e-1fc11737edb4
      iscommand: true
      name: Get User Information From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: 8f925fbe-190e-45d9-837e-1fc11737edb4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": 960
        }
      }
  "61":
    continueonerror: true
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      empid:
        complex:
          accessor: crowdstrikeusername
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: 99760542-a77f-4739-86b6-3cae8c77c936
      iscommand: true
      name: Get User Information From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: 99760542-a77f-4739-86b6-3cae8c77c936
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 960
        }
      }
  "62":
    continueonerror: true
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      employee_id:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      retry-count:
        simple: "3"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Gurucul-GRA
      description: Get details of the user
      id: cd98b3ee-1f8a-4a8b-8e8f-bda03e8dd2cb
      iscommand: true
      name: Get User From UEBA
      script: Gurucul-GRA|||gra-fetch-users-details
      tags:
      - userueba
      type: regular
      version: -1
    taskid: cd98b3ee-1f8a-4a8b-8e8f-bda03e8dd2cb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2980,
          "y": 780
        }
      }
  "63":
    continueonerror: true
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      employee_id:
        complex:
          accessor: crowdstrikeusername
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Gurucul-GRA
      description: Get details of the user
      id: bb315cd3-64ea-4d4e-8300-6e520c9d76b0
      iscommand: true
      name: Get User From UEBA
      script: Gurucul-GRA|||gra-fetch-users-details
      tags:
      - userueba
      type: regular
      version: -1
    taskid: bb315cd3-64ea-4d4e-8300-6e520c9d76b0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 780
        }
      }
  "65":
    continueonerror: true
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      relateToIncident:
        simple: "true"
      tags:
        simple: ${incident.id}
      type:
        simple: TCS Employee Id
      value:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 23d779c9-9de7-473f-88aa-c74b80e29fde
      iscommand: true
      name: Create username Indicator and link to incident
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 23d779c9-9de7-473f-88aa-c74b80e29fde
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 1440
        }
      }
  "66":
    continueonerror: true
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      relateToIncident:
        simple: "true"
      tags:
        simple: ${incident.id}
      type:
        simple: TCS Employee Id
      value:
        complex:
          accessor: crowdstrikeusername
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 877d7e1c-0f68-4586-8055-e1afa98cebd6
      iscommand: true
      name: Create username Indicator and link to incident
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 877d7e1c-0f68-4586-8055-e1afa98cebd6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1720,
          "y": 1440
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      emp:
        complex:
          accessor: crowdstrikeusername
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7e4c805d-bc68-4f35-851d-e795e2c00acc
      iscommand: false
      name: TCS-Create User Indicator & Relate To Incident v1.0
      playbookId: a8f14eae-50f0-476d-84bb-1c0d7fb01027
      type: playbook
      version: -1
    taskid: 7e4c805d-bc68-4f35-851d-e795e2c00acc
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 960
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      emp:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9448cd28-526f-4aab-861e-b07da698f600
      iscommand: false
      name: TCS-Create User Indicator & Relate To Incident v1.0
      playbookId: a8f14eae-50f0-476d-84bb-1c0d7fb01027
      type: playbook
      version: -1
    taskid: 9448cd28-526f-4aab-861e-b07da698f600
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 960
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        simple: ${incident.crowdstrikedetectionid}
      retry-count:
        simple: "3"
      using:
        simple: CrowdstrikeFalcon_Detections
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Search for details of specific detections, either using a filter
        query, or by providing the IDs of the detections.
      id: 9b2c2168-4059-4f46-8d05-1f0108597934
      iscommand: true
      name: Fetch Detection Details CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-search-detection
      type: regular
      version: -1
    taskid: 9b2c2168-4059-4f46-8d05-1f0108597934
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1170,
          "y": -1140
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "37_36_yes": 0.47,
      "44_40_#default#": 0.1,
      "59_60_yes": 0.53
    },
    "paper": {
      "dimensions": {
        "height": 3340,
        "width": 8720,
        "x": -3030,
        "y": -1505
      }
    }
  }
