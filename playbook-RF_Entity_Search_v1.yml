contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: c3278d1c-6aee-4db0-8ef7-a264834d5662
inputs:
- description: ""
  key: usernameArray
  playbookInputQuery: null
  required: false
  value:
    complex:
      root: usernameArray
name: RF Entity Search_v1
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2c6cb303-173f-40d2-89e2-3e4b57c62d72
      iscommand: false
      name: ""
      version: -1
    taskid: 2c6cb303-173f-40d2-89e2-3e4b57c62d72
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 2620,
          "y": 560
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: cf1edc14-3ca4-4ef4-8d48-fcf1fe1d1587
      iscommand: false
      name: Read The Text Attachment
      script: ReadFile
      type: regular
      version: -1
    taskid: cf1edc14-3ca4-4ef4-8d48-fcf1fe1d1587
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1480,
          "y": 855
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: username
      value:
        complex:
          root: FileData
          transformers:
          - operator: trim
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: afcd0ddf-cb9e-40d3-8ee3-c6e97918f9a1
      iscommand: false
      name: Set Data To Context
      script: Set
      type: regular
      version: -1
    taskid: afcd0ddf-cb9e-40d3-8ee3-c6e97918f9a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1480,
          "y": 1025
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${username}
      contextKey:
        simple: usernameArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: b64cf673-a53d-4c98-864c-69d401fedc31
      iscommand: false
      name: Create Array of Input Data
      script: CreateArray
      type: regular
      version: -1
    taskid: b64cf673-a53d-4c98-864c-69d401fedc31
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1480,
          "y": 1200
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: true
    quietmode: 2
    scriptarguments:
      extend-context:
        simple: 'IncidentsWithIndicator=.={"name": val.name}'
      ignore-outputs:
        simple: "false"
      indicator:
        complex:
          root: inputs.usernameArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Lookup incidents with specified indicator. Use currentIncidentId to omit the existing incident from output.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 788818a9-8adb-4477-8e7b-99441c3a5595
      iscommand: false
      name: Find Entities
      script: findIncidentsWithIndicator
      tags:
      - Indicators
      type: regular
      version: -1
    taskid: 788818a9-8adb-4477-8e7b-99441c3a5595
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2630,
          "y": 1105
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: IncidentsWithIndicator
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "6"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6ab82267-57af-4238-884d-b2ec5e35f0eb
      iscommand: false
      name: Is FoundIndicators custom Key defined
      type: condition
      version: -1
    taskid: 6ab82267-57af-4238-884d-b2ec5e35f0eb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2620,
          "y": 730
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: IncidentsWithIndicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: ccb5df23-bbcc-41a2-86da-efa8b5749dff
      iscommand: false
      name: Delete  Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: ccb5df23-bbcc-41a2-86da-efa8b5749dff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2620,
          "y": 910
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FoundIndicatorsReport
      value:
        complex:
          root: inputs.usernameArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 1c7459ec-1b87-42de-8a73-33d703fa00e7
      iscommand: false
      name: Create array for Entities found
      script: Set
      type: regular
      version: -1
    taskid: 1c7459ec-1b87-42de-8a73-33d703fa00e7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2310,
          "y": 1490
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0bdc7400-8d0e-41ef-8f07-8d055546e9b7
      iscommand: false
      name: end
      type: title
      version: -1
    taskid: 0bdc7400-8d0e-41ef-8f07-8d055546e9b7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2630,
          "y": 1730
        }
      }
  "9":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: IncidentsWithIndicator
          operator: isNotExists
          right:
            value: {}
        - left:
            iscontext: true
            value:
              complex:
                accessor: name
                root: IncidentsWithIndicator
          operator: notContainsGeneral
          right:
            value:
              simple: TCS Leaked Credential Monitoring
      label: "yes"
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "10"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ae21768a-0cc9-4007-86a6-e29006d94084
      iscommand: false
      name: 'check if entity present '
      type: condition
      version: -1
    taskid: ae21768a-0cc9-4007-86a6-e29006d94084
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2630,
          "y": 1295
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: entitynotfound
      value:
        complex:
          root: inputs.usernameArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 11b2d2cc-d2dc-4d0f-8021-ede2c2b8a9e9
      iscommand: false
      name: Create array for Entities not found
      script: Set
      type: regular
      version: -1
    taskid: 11b2d2cc-d2dc-4d0f-8021-ede2c2b8a9e9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2970,
          "y": 1490
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1540f91f-99ef-44e2-8952-d1d8c9cefe53
      iscommand: false
      name: Untitled Task
      type: regular
      version: -1
    taskid: 1540f91f-99ef-44e2-8952-d1d8c9cefe53
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4120,
          "y": 1190
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1235,
        "width": 3020,
        "x": 1480,
        "y": 560
      }
    }
  }
