contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 60bd3c76-fac5-41f2-829d-ef7f32d7d0a1
inputs:
- description: ""
  key: IP
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Temp Add New CSOC IP Indicator_WAF_v1.0
outputs: []
sourceplaybookid: e653e5ab-6658-4f7a-806d-6a79d92d5d98
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 363f1977-a537-43cd-81e8-b553af82378c
      iscommand: false
      name: ""
      version: -1
    taskid: 363f1977-a537-43cd-81e8-b553af82378c
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -560,
          "y": -1310
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 512a46ed-b436-4f05-82e2-93168c51b52b
      iscommand: true
      name: Check If Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 512a46ed-b436-4f05-82e2-93168c51b52b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -560,
          "y": -590
        }
      }
  "11":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0b9f3b06-4d9f-486d-8e62-d06647c118ad
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 0b9f3b06-4d9f-486d-8e62-d06647c118ad
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -560,
          "y": -420
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b7464f0b-1662-461f-80b7-dd3b42c308c8
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: b7464f0b-1662-461f-80b7-dd3b42c308c8
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    type: title
    view: |-
      {
        "position": {
          "x": -380,
          "y": 910
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      expirationdate:
        simple: ${expirydate}
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: QradarSuspiciousIP
      type:
        simple: IP
      value:
        simple: ${inputs.IP}
      verdict:
        simple: Suspicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 4a8386d4-17fd-4d53-8a78-82d8d600b53e
      iscommand: true
      name: Tag The Indicator With 'QradarSuspiciousIP'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 4a8386d4-17fd-4d53-8a78-82d8d600b53e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 95
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      expirationdate:
        simple: ${expirydate}
      tags:
        simple: QradarSuspiciousIP
      value:
        simple: ${inputs.IP}
      verdict:
        simple: Suspicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 5c6fa247-5a59-4f49-81d6-7f0c32a65d89
      iscommand: true
      name: Add New CSOC Tag - QradarSuspiciousIP
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 5c6fa247-5a59-4f49-81d6-7f0c32a65d89
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 420
        }
      }
  "19":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e223f4c3-aa26-45ce-8c5f-f37437de6ba4
      iscommand: false
      name: Is Indicator Context Set ?
      type: condition
      version: -1
    taskid: e223f4c3-aa26-45ce-8c5f-f37437de6ba4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -560,
          "y": -1120
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: indicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 91ed6736-af20-4cc0-890e-7620e35259de
      iscommand: false
      name: Delete 'Indicator' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 91ed6736-af20-4cc0-890e-7620e35259de
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -560,
          "y": -900
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: expirydate
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: in 2 hours
            operator: ModifyDateTime
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e13cef5d-c0c8-4bc6-8a0b-5315f43a15c7
      iscommand: false
      name: Calculate Expiry Date
      script: Set
      type: regular
      version: -1
    taskid: e13cef5d-c0c8-4bc6-8a0b-5315f43a15c7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": -160
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d3489fb8-7233-4886-8482-42c0d2266e7c
      iscommand: false
      name: Is The Indicator Tagged ?
      type: condition
      version: -1
    taskid: d3489fb8-7233-4886-8482-42c0d2266e7c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -260,
          "y": -160
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: expirydate
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: in 2 hours
            operator: ModifyDateTime
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e43c3c69-a38e-4f34-881b-857307a90099
      iscommand: false
      name: Calculate Expiry Date
      script: Set
      type: regular
      version: -1
    taskid: e43c3c69-a38e-4f34-881b-857307a90099
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 270
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      expirationdate:
        simple: ${expirydate}
      tags:
        simple: QradarSuspiciousIP
      value:
        simple: ${inputs.IP}
      verdict:
        simple: Suspicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 071654c3-15a5-453e-8efd-048b082c2d1f
      iscommand: true
      name: Update Expiry Field
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 071654c3-15a5-453e-8efd-048b082c2d1f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 305
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: QradarSuspiciousIP
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 36525cd6-a594-4a1b-84b8-07d302a95e8f
      iscommand: false
      name: Is Indicator Tag QradarSuspiciousIP ?
      type: condition
      version: -1
    taskid: 36525cd6-a594-4a1b-84b8-07d302a95e8f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -260,
          "y": 95
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h1 style="text-align: center;"><span style="color: #0000ff;"><strong>IP
          ${incident.labels.offense_source} Has Been Temporarily Blocked on Firewall</strong></span></h1>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: d8aecd9f-4e40-4d1a-8b9e-95ee977a1b3e
      iscommand: true
      name: Set 'Action Notification' Context - IP Temp Blocked
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: d8aecd9f-4e40-4d1a-8b9e-95ee977a1b3e
    timertriggers:
    - action: stop
      fieldname: responsesla
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 485
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h1 style="text-align: center;"><span style="color: #ff00ff;"><strong>IP
          ${incident.labels.offense_source} Already Blocked With Tag ${indicator.tag}</strong></span></h1>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 2a10d0b6-d054-4d8e-8382-3dd2508cbdbb
      iscommand: true
      name: 'Set ''Action Notification'' Context - IP Already Blocked '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 2a10d0b6-d054-4d8e-8382-3dd2508cbdbb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -260,
          "y": 485
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h1 style="text-align: center;"><span style="color: #ff0000;"><strong>IP
          ${incident.labels.offense_source} Already Blocked - Extended Expiry Date
          By 2 Hours</strong></span></h1>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 9bbde8c3-043f-4168-85d2-840faf419dec
      iscommand: true
      name: Set 'Action Notification' Context - IP Already Blocked Expiry Extended
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 9bbde8c3-043f-4168-85d2-840faf419dec
    timertriggers:
    - action: stop
      fieldname: responsesla
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 600
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: inputs.IP
      listName:
        simple: WAF_IP's_Needtobeblock
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: a54f5535-f2d6-4f2d-8571-1a7779d64ad6
      iscommand: true
      name: Append IP to the WAF list
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: a54f5535-f2d6-4f2d-8571-1a7779d64ad6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 850
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: expirydate
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: in 2 hours
            operator: ModifyDateTime
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 0601d85b-73bb-4dc3-8165-5fedfa5cbc00
      iscommand: false
      name: Calculate Expiry Date
      script: Set
      type: regular
      version: -1
    taskid: 0601d85b-73bb-4dc3-8165-5fedfa5cbc00
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 660,
          "y": 250
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      expirationdate:
        simple: ${expirydate}
      tags:
        simple: QradarSuspiciousIP
      value:
        simple: ${inputs.IP}
      verdict:
        simple: Suspicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 6240ceb3-41b3-4f04-871c-4e32696def80
      iscommand: true
      name: Add New CSOC Tag - QradarSuspiciousIP
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 6240ceb3-41b3-4f04-871c-4e32696def80
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 660,
          "y": 400
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h1 style="text-align: center;"><span style="color: #ff0000;"><strong>IP
          ${incident.labels.offense_source}Has Been Temporarily Blocked on Firewall</strong></span></h1>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: da3492ca-0537-43ca-8328-ada8bf6d7ff3
      iscommand: true
      name: Set 'Action Notification' Context - IP Already Blocked Expiry Extended
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: da3492ca-0537-43ca-8328-ada8bf6d7ff3
    timertriggers:
    - action: stop
      fieldname: responsesla
    type: regular
    view: |-
      {
        "position": {
          "x": 660,
          "y": 600
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "23_35_yes": 0.74,
      "35_24_yes": 0.37
    },
    "paper": {
      "dimensions": {
        "height": 2285,
        "width": 1940,
        "x": -900,
        "y": -1310
      }
    }
  }
