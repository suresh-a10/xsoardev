contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: f7080490-9fc4-4fbc-8db0-96f110313fcd
inputs: []
name: TCS- RF/Tor Report communication  v1.1
outputs: []
quiet: true
sourceplaybookid: b3d1ecc4-8713-42f2-8d79-00287a09a048
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 77b1cb5a-8b78-4e03-840e-4881fda12d8d
      iscommand: false
      name: ""
      version: -1
    taskid: 77b1cb5a-8b78-4e03-840e-4881fda12d8d
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 30,
          "y": -1060
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6d9b67d7-59ff-4b0c-85b9-552d40f32673
      iscommand: false
      name: Are there any extracted indicators?
      type: condition
      version: -1
    taskid: 6d9b67d7-59ff-4b0c-85b9-552d40f32673
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": -340
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      column:
        simple: A
      entryID:
        complex:
          accessor: EntryID
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Extracts indicators only from specific columns within an excel
        with single sheet
      id: cb1e6daa-8cf0-4d88-8bb2-0a234502c027
      iscommand: false
      name: Extract Indicators from the Source IP column of the RF report
      script: 70947ac9-0b08-4a10-8af4-e41a568e1e80
      type: regular
      version: -1
    taskid: cb1e6daa-8cf0-4d88-8bb2-0a234502c027
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 300,
          "y": -540
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.IP
          operator: greaterThanOrEqual
          right:
            value:
              simple: "65"
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d485bb23-49ca-4185-88bf-da4e23844e7f
      iscommand: false
      name: Are There Any IoCs With Risk Score > 65
      type: condition
      version: -1
    taskid: d485bb23-49ca-4185-88bf-da4e23844e7f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -310,
          "y": 30
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: RecordedFuture.IP.riskScore
          operator: lessThanOrEqual
          right:
            value:
              simple: "64"
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 82fe0692-6216-4ecf-80c9-8e9f285809d1
      iscommand: false
      name: ' IoCs With Risk Score < 65'
      type: condition
      version: -1
    taskid: 82fe0692-6216-4ecf-80c9-8e9f285809d1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 440,
          "y": 30
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RiskScorebelow65
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.IP.riskScore
              operator: lessThanOrEqual
              right:
                value:
                  simple: "64"
          root: RecordedFuture.IP.riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: eb6199f1-a3b1-4274-82c2-a0017acac538
      iscommand: false
      name: Set IOC less Than 65 To Context
      script: Set
      type: regular
      version: -1
    taskid: eb6199f1-a3b1-4274-82c2-a0017acac538
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 210
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 2
    scriptarguments:
      csvArray:
        simple: $RiskScorebelow65}
      fileName:
        simple: IOC_below_64_RiskScore.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 8aaa2c08-09ca-4d72-8412-9acdaac3a088
      iscommand: false
      name: Create Risk Score Report less than 65
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 8aaa2c08-09ca-4d72-8412-9acdaac3a088
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 380
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fc59b678-ea5d-4edc-899b-13bf87fc6fc2
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: fc59b678-ea5d-4edc-899b-13bf87fc6fc2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 30,
          "y": 1460
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "7"
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5fbe0c93-7db0-4611-80bf-c5be3deff335
      iscommand: false
      name: TCS-Recorded Future IP Reputation_v2.1_WIP
      playbookId: 568f580b-75f1-446e-83cf-fcda64e1f791
      type: playbook
      version: -1
    taskid: 5fbe0c93-7db0-4611-80bf-c5be3deff335
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 30,
          "y": -140
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${SIXFIVE.IP}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 9a02b1ba-93e2-4b81-8001-ae7ae1de3e1f
      iscommand: false
      name: TCS-Blacklist Report CyberSOC_Shared IOC Above RiskScore 65 v3.0_KK_WIP
      playbookId: 0145ce32-f60e-409a-89b4-ee2311a9ac51
      type: playbook
      version: -1
    taskid: 9a02b1ba-93e2-4b81-8001-ae7ae1de3e1f
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -310,
          "y": 210
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${RiskScorebelow65}
      contextKey:
        simple: BelowIP64
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: 5e6cbfa6-41eb-4c1d-82c3-5f0c738a96e3
      iscommand: false
      name: Create the IP in array format
      script: CreateArray
      type: regular
      version: -1
    taskid: 5e6cbfa6-41eb-4c1d-82c3-5f0c738a96e3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 530
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        complex:
          root: BelowIP64
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e62b37d6-1e11-4600-88d9-c70e73888f42
      iscommand: false
      name: TCS-Subplaybook for Report autoassign_WIP
      playbookId: 8ff40011-bd19-434c-8bb6-c46741b161b9
      type: playbook
      version: -1
    taskid: e62b37d6-1e11-4600-88d9-c70e73888f42
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1230
        }
      }
  "21":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: owner
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "14"
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6611572d-d1e8-4b27-8440-9d86c3bdd5a0
      iscommand: false
      name: Is Owner Assigned ?
      type: condition
      version: -1
    taskid: 6611572d-d1e8-4b27-8440-9d86c3bdd5a0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 30,
          "y": -910
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get the Server URL.
      id: 93c027a9-0dc4-4b2b-89cb-28ab19e8d2cb
      iscommand: false
      name: Get server URL
      script: GetServerURL
      type: regular
      version: -1
    taskid: 93c027a9-0dc4-4b2b-89cb-28ab19e8d2cb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 700
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: incidentlink
      value:
        simple: https://${ServerURL.Host}/#/Custom/caseinfoid/${incident.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 40232a48-0b1a-4aa4-8a8d-8175a76b41d5
      iscommand: false
      name: Set Server link In Context
      script: Set
      type: regular
      version: -1
    taskid: 40232a48-0b1a-4aa4-8a8d-8175a76b41d5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 870
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      incidentlink:
        simple: ${incidentlink}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 5de3dcb4-2bbb-4917-8575-6cbaba33e88e
      iscommand: true
      name: Set Incident Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 5de3dcb4-2bbb-4917-8575-6cbaba33e88e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1050
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: subject
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: Tor Communication Report
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea9f6339-8274-4014-8ee9-35cab8889aa3
      iscommand: false
      name: Check whether it is Tor report or Not?
      type: condition
      version: -1
    taskid: ea9f6339-8274-4014-8ee9-35cab8889aa3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 20,
          "y": -730
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      column:
        simple: F
      entryID:
        complex:
          accessor: EntryID
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Extracts indicators only from specific columns within an excel
        with single sheet
      id: 96e86349-9808-45d7-8589-b0311f348a77
      iscommand: false
      name: Extract Indicators from the Source IP column of the Tor report
      script: 70947ac9-0b08-4a10-8af4-e41a568e1e80
      type: regular
      version: -1
    taskid: 96e86349-9808-45d7-8589-b0311f348a77
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -240,
          "y": -540
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2585,
        "width": 1140,
        "x": -310,
        "y": -1060
      }
    }
  }
