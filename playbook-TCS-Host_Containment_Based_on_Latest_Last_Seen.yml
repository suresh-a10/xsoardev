contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 2fcc0312-3a92-4098-8e05-60568462eb35
inputs:
- description: ""
  key: host
  playbookInputQuery: null
  required: false
  value:
    simple: ${TCSHostnameArray}
name: TCS-Host Containment Based on Latest Last Seen
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e71c06fb-4ee1-410e-870c-e3d4969c161b
      iscommand: false
      name: ""
      version: -1
    taskid: e71c06fb-4ee1-410e-870c-e3d4969c161b
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 400,
          "y": 60
        }
      }
  "12":
    continueonerror: true
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.LastSeen
              operator: isEqualString
              right:
                iscontext: true
                value:
                  simple: ${LastSeenArraySorted.[0]}
          root: CrowdStrike.Device
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Contains containment for a specified host. When contained, a host
        can only communicate with the CrowdStrike cloud and any IPs specified in your
        containment policy.
      id: 6212ce6f-a308-47f0-8b40-bb56339c6ec6
      iscommand: true
      name: Contain Host with Latest Last Seen Entry
      script: '|||cs-falcon-contain-host'
      type: regular
      version: -1
    taskid: 6212ce6f-a308-47f0-8b40-bb56339c6ec6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1510
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3e973a3c-353a-4dee-89ba-7442982b4d35
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: 3e973a3c-353a-4dee-89ba-7442982b4d35
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 400,
          "y": 2240
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: CrowdStrike
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "27"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ca7d731d-fb30-4800-8f8b-3ca803fc0b0d
      iscommand: false
      name: Is CrowdStrike custom Key defined
      type: condition
      version: -1
    taskid: ca7d731d-fb30-4800-8f8b-3ca803fc0b0d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 200
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: CrowdStrike
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: e3b4d683-76e3-4bc0-8f30-e52894531ad5
      iscommand: false
      name: Delete CS Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: e3b4d683-76e3-4bc0-8f30-e52894531ad5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 370
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          root: inputs.host
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: 1d6a209c-972b-4e74-853c-1a9f1d029f7f
      iscommand: true
      name: Search Host On CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: 1d6a209c-972b-4e74-853c-1a9f1d029f7f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 560
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: CrowdStrike
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Hostname
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6f0eed77-1a4b-49b0-8e1b-711e2efe5022
      iscommand: false
      name: Is Host Found on CrowdStrike?
      type: condition
      version: -1
    taskid: 6f0eed77-1a4b-49b0-8e1b-711e2efe5022
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 725
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: LastSeenArraySorted
      value:
        complex:
          root: ${CrowdStrike.Device.LastSeen}
          transformers:
          - args:
              descending:
                value:
                  simple: "true"
            operator: sort
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a90655d3-3cdc-45f2-823f-20212253ab86
      iscommand: false
      name: Create sorted array for last seen
      script: Set
      type: regular
      version: -1
    taskid: a90655d3-3cdc-45f2-823f-20212253ab86
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1320
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      relateToIncident:
        simple: "true"
      tags:
        simple: hostcontaincompliance
      type:
        simple: Host
      value:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: c536f32c-7dca-43c4-8d3c-5e9403d1e13e
      iscommand: true
      name: Create Host Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: c536f32c-7dca-43c4-8d3c-5e9403d1e13e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1690
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostContainedReport
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.LastSeen
              operator: isEqualString
              right:
                value:
                  simple: ${LastSeenArraySorted.[0]}
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 4454463e-3121-4688-8c8e-df4f905abac6
      iscommand: false
      name: Create array for contained hosts report
      script: Set
      type: regular
      version: -1
    taskid: 4454463e-3121-4688-8c8e-df4f905abac6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1860
        }
      }
  "40":
    continueonerror: true
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          root: CrowdStrike.Device
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Contains containment for a specified host. When contained, a host
        can only communicate with the CrowdStrike cloud and any IPs specified in your
        containment policy.
      id: eeef06bd-c70d-429f-8c8a-f1352349ee60
      iscommand: true
      name: 'Contain Host '
      script: '|||cs-falcon-contain-host'
      type: regular
      version: -1
    taskid: eeef06bd-c70d-429f-8c8a-f1352349ee60
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": 1310
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostContainedReport
      value:
        complex:
          accessor: Device
          root: CrowdStrike
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: f08db388-e890-4144-89f4-e5a0cf3a96d5
      iscommand: false
      name: Create array for contained hosts report
      script: Set
      type: regular
      version: -1
    taskid: f08db388-e890-4144-89f4-e5a0cf3a96d5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": 1880
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: LastSeenArraySorted
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: f1f6c6c4-5b94-453a-85f9-fc46d02d785a
      iscommand: false
      name: Delete Context Key LastSeenArraySorted
      script: DeleteContext
      type: regular
      version: -1
    taskid: f1f6c6c4-5b94-453a-85f9-fc46d02d785a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 2040
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostNotFound
      value:
        complex:
          root: inputs.host
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 13f90c6f-9d36-4410-8737-c26bccb271ff
      iscommand: false
      name: Create array for hosts not found report
      script: Set
      type: regular
      version: -1
    taskid: 13f90c6f-9d36-4410-8737-c26bccb271ff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1905
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${CrowdStrike.Device.ID}
          operator: hasLength
          right:
            value:
              simple: "1"
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "32"
      "yes":
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: c32735a1-bbfe-4869-88ca-c5dbcf3099d2
      iscommand: false
      name: Is the Count of CS Host ID 1?
      type: condition
      version: -1
    taskid: c32735a1-bbfe-4869-88ca-c5dbcf3099d2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 980
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      relateToIncident:
        simple: "true"
      tags:
        simple: hostcontaincompliance
      type:
        simple: Host
      value:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: dc62c2a1-5627-4e07-8db3-7798678bc551
      iscommand: true
      name: Create Host Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: dc62c2a1-5627-4e07-8db3-7798678bc551
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": 1620
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2245,
        "width": 1380,
        "x": -70,
        "y": 60
      }
    }
  }
