contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.2.0
    itemVersion: 4.11.4
    packID: ""
    packName: Cortex XDR by Palo Alto Networks
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: This playbook accepts an XDR endpoint ID and isolates it using the 'Palo
  Alto Networks Cortex XDR - Investigation and Response' integration.
id: e9b1859d-ac63-4dd5-833b-fde4a411aef1
inputs: []
name: TCS-Cortex XDR - Isolate Endpoint
outputs:
- contextPath: PaloAltoNetworksXDR.Endpoint.endpoint_id
  description: The endpoint ID.
- contextPath: PaloAltoNetworksXDR.Endpoint.endpoint_name
  description: The endpoint name.
- contextPath: PaloAltoNetworksXDR.Endpoint.endpoint_status
  description: The status of the endpoint.
- contextPath: PaloAltoNetworksXDR.Endpoint.ip
  description: A list of IP addresses.
- contextPath: PaloAltoNetworksXDR.Endpoint.is_isolated
  description: Whether the endpoint is isolated.
- contextPath: Endpoint.Hostname
  description: The hostname that is mapped to this endpoint.
sourceplaybookid: Cortex XDR - Isolate Endpoint
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 96c37e63-b809-4edb-846d-b0b107e8df1d
      iscommand: false
      name: ""
      version: -1
    taskid: 96c37e63-b809-4edb-846d-b0b107e8df1d
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 30,
          "y": -520
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      endpoint_id:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
              operator: isNotEmpty
          root: PaloAltoNetworksXDR.Endpoint.endpoint_id
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Isolates the specified endpoint.
      id: 3163abb5-067c-4e01-8015-4a2acb10db46
      iscommand: true
      name: Cortex XDR - isolate endpoint
      script: '|||xdr-endpoint-isolate'
      type: regular
      version: -1
    taskid: 3163abb5-067c-4e01-8015-4a2acb10db46
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1070,
          "y": 930
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: xdrhostnames
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Checks if the ''Palo Alto Networks Cortex XDR - Investigation
        and Response'' integration is enabled. '
      id: 13f0f950-f88c-42ce-8588-a63327eb90a9
      iscommand: false
      name: Is Host Context Defined ?
      type: condition
      version: -1
    taskid: 13f0f950-f88c-42ce-8588-a63327eb90a9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 30,
          "y": 40
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4e93c476-5087-4909-8aa6-7e11be9f345d
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 4e93c476-5087-4909-8aa6-7e11be9f345d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -300,
          "y": 1190
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.endpoint_id
          operator: isNotEmpty
          right:
            value: {}
      label: Endpoint ID
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.ip_list
          operator: isNotEmpty
        - left:
            iscontext: true
            value:
              complex:
                root: inputs.hostname
          operator: isNotEmpty
      label: IP or Hostname
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Endpoint ID:
      - "10"
      IP or Hostname:
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is any endpoint to isolate.
      id: 2a052308-03e5-4f8c-88b2-df0fa8c6dacd
      iscommand: false
      name: Is there an endpoint to isolate?
      type: condition
      version: -1
    taskid: 2a052308-03e5-4f8c-88b2-df0fa8c6dacd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1070,
          "y": 370
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          root: inputs.hostname
          transformers:
          - args:
              delimiter: {}
            operator: split
          - operator: uniq
      ip_list:
        complex:
          root: inputs.ip_list
          transformers:
          - args:
              delimiter: {}
            operator: split
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a list of endpoints, according to the passed filters. Filtering
        by multiple fields is concatenated using the AND condition (OR is not supported).
        Maximum result set size is 100. Offset is the zero-based number of the endpoint
        from the start of the result set (start by counting from 0).
      id: f76e2f58-8245-430c-8697-f2464e51dc16
      iscommand: true
      name: Cortex XDR - get endpoint ID
      script: '|||xdr-get-endpoints'
      type: regular
      version: -1
    taskid: f76e2f58-8245-430c-8697-f2464e51dc16
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 540
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      endpoint_id_list:
        complex:
          root: inputs.endpoint_id
          transformers:
          - args:
              delimiter: {}
            operator: split
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of the endpoint from the
        start of the result set (start by counting from 0).
      id: 01227934-2d5f-4276-837a-fa0f7ade0a2b
      iscommand: true
      name: Get endpoint status
      script: '|||xdr-get-endpoints'
      type: regular
      version: -1
    taskid: 01227934-2d5f-4276-837a-fa0f7ade0a2b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": 540
        }
      }
  "11":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: is_isolated
                root: PaloAltoNetworksXDR.Endpoint
          operator: isEqualString
          right:
            value:
              simple: AGENT_UNISOLATED
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: endpoint_id
                root: PaloAltoNetworksXDR.Endpoint
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is any endpoint ready for isolation.
      id: 0d950da3-f743-40a7-8b61-b0cbce73603c
      iscommand: false
      name: Is the endpoint ready for isolation?
      type: condition
      version: -1
    taskid: 0d950da3-f743-40a7-8b61-b0cbce73603c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1070,
          "y": 710
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4b31b551-40ff-48b8-8614-d7d0baa03b59
      iscommand: false
      name: Start Mitigation &  Contain Host SLA Timer
      type: title
      version: -1
    taskid: 4b31b551-40ff-48b8-8614-d7d0baa03b59
    timertriggers:
    - action: start
      fieldname: mitigationsla
    - action: start
      fieldname: containhosttimer
    type: title
    view: |-
      {
        "position": {
          "x": 30,
          "y": -380
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      endpoint_id:
        complex:
          accessor: deviceid
          root: incident
      using:
        simple: Cortex XDR - IR_instance_Corp
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex XDR - IR
      description: Isolates the specified endpoint.
      id: 831d8fb3-66ba-4490-8b8d-71889180e54a
      iscommand: true
      name: Contain Host (Stop Mitigation SLA Timer)
      script: Cortex XDR - IR|||xdr-endpoint-isolate
      type: regular
      version: -1
    taskid: 831d8fb3-66ba-4490-8b8d-71889180e54a
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: containhosttimer
    type: regular
    view: |-
      {
        "position": {
          "x": -400,
          "y": 600
        }
      }
  "14":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: xdrhostnames
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: What is The Hostname ?
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: ""
      title: Host Contain
      totalanswers: 0
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b0ec393f-51dc-4a53-843b-4a973518da82
      iscommand: false
      name: Input Hostname (If Host Has XDR)
      type: collection
      version: -1
    taskid: b0ec393f-51dc-4a53-843b-4a973518da82
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 260,
          "y": 210
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      endpoint_id:
        complex:
          accessor: ID
          root: Endpoint
      using:
        simple: Cortex XDR - IR_instance_Corp
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex XDR - IR
      description: Isolates the specified endpoint.
      id: 00d73686-e724-46c4-82b7-6a34f1a57bb7
      iscommand: true
      name: Contain Host (Stop Mitigation SLA Timer)
      script: Cortex XDR - IR|||xdr-endpoint-isolate
      type: regular
      version: -1
    taskid: 00d73686-e724-46c4-82b7-6a34f1a57bb7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 805
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: Host ${incident.xdrhostnames} is Contained  Please Verify on The XDR
          Console
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: c2932c98-9f46-4916-80b9-37b446e5fa96
      iscommand: false
      name: Notify The Host is Contained -${incident.xdrhostnames} -XDR
      script: Print
      type: regular
      version: -1
    taskid: c2932c98-9f46-4916-80b9-37b446e5fa96
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 990
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: Host ${incident.xdrhostnames} is Contained Please Verify on The XDR
          Console
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: f0fdb7e6-a149-48ce-8b6d-e51ae20d2a67
      iscommand: false
      name: Notify The Host is Contained -${incident.investigationId} -XDR
      script: Print
      type: regular
      version: -1
    taskid: f0fdb7e6-a149-48ce-8b6d-e51ae20d2a67
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -400,
          "y": 975
        }
      }
  "19":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: deviceid
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a8952e19-b6cc-4835-80f3-a053714132bc
      iscommand: false
      name: Is The Device Id Available ?
      type: condition
      version: -1
    taskid: a8952e19-b6cc-4835-80f3-a053714132bc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 30,
          "y": -225
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          accessor: xdrhostnames
          root: incident
      using:
        simple: Cortex XDR - IR_instance_Corp
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex XDR - IR
      description: Returns information about an endpoint.
      id: 3407bc3d-75f7-4312-89ae-0cc7046df7bc
      iscommand: true
      name: Get Host Data From XDR
      script: Cortex XDR - IR|||endpoint
      type: regular
      version: -1
    taskid: 3407bc3d-75f7-4312-89ae-0cc7046df7bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 30,
          "y": 390
        }
      }
  "21":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ID
                root: Endpoint
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Status
                root: Endpoint
          operator: isEqualString
          right:
            value:
              simple: Online
      label: "yes"
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aead1cac-e267-4647-8c86-7bf774273cc7
      iscommand: false
      name: Host Found on XDR?
      type: condition
      version: -1
    taskid: aead1cac-e267-4647-8c86-7bf774273cc7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 30,
          "y": 560
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: No Hosts Found on XDR
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: 34d8ecf2-ae7e-45b7-8128-7ba90359370e
      iscommand: false
      name: Notify 'No Hosts Found or Host is Offline on XDR'
      script: Print
      type: regular
      version: -1
    taskid: 34d8ecf2-ae7e-45b7-8128-7ba90359370e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 880
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "11_1_yes": 0.61,
      "4_10_Endpoint ID": 0.56,
      "4_8_IP or Hostname": 0.57
    },
    "paper": {
      "dimensions": {
        "height": 1775,
        "width": 2060,
        "x": -400,
        "y": -520
      }
    }
  }
