contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 53aac6f0-1166-4697-8ab3-ec16faab7575
inputs: []
name: TCS-Select IOC To Block_RF Playbook_PG_v1.0
outputs: []
sourceplaybookid: 769b58c8-170a-499a-82e1-3d8942cfa39e
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5924b657-6f99-49dd-86d0-9e9e7673daa7
      iscommand: false
      name: ""
      version: -1
    taskid: 5924b657-6f99-49dd-86d0-9e9e7673daa7
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -430,
          "y": 0
        }
      }
  "3":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Select The IoC(s) You'd Like To Block
        options: []
        optionsarg:
        - simple: ${ExtractedIndicators.IP}
        - simple: ${ExtractedIndicators.Domain}
        - simple: ${ExtractedIndicators.File}
        - simple: ${ExtractedIndicators.URL}
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Which IOC(s) To Block
      totalanswers: 0
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 341497c9-aa65-4cba-88e4-ae6716687d8e
      iscommand: false
      name: Select The IoC(s) You'd Like To Block
      type: collection
      version: -1
    taskid: 341497c9-aa65-4cba-88e4-ae6716687d8e
    timertriggers:
    - action: start
      fieldname: blockioctimer
    type: collection
    view: |-
      {
        "position": {
          "x": -430,
          "y": 150
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 1ec10031-416c-43fa-87f9-69172f297b6b
      iscommand: false
      name: Delete Extracted Indicators Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 1ec10031-416c-43fa-87f9-69172f297b6b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": 480
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${Which IOC.Answers}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: acf0da8d-32a6-4289-80cc-ca01408142f3
      iscommand: true
      name: 'Extract New User Selection '
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: acf0da8d-32a6-4289-80cc-ca01408142f3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": 645
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get the Server URL.
      id: 550ff92f-7b74-4895-81df-fda970aad7e8
      iscommand: false
      name: GetServerURL
      script: GetServerURL
      type: regular
      version: -1
    taskid: 550ff92f-7b74-4895-81df-fda970aad7e8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": 1025
        }
      }
  "42":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Select Name of The Reviewer
        options: []
        optionsarg:
        - simple: Yogesh Gholap
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Select Name of The Reviewer
      totalanswers: 0
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7a585821-73a9-4318-8c4a-4c31c6d8945d
      iscommand: false
      name: Select Name of The Reviewer
      type: collection
      version: -1
    taskid: 7a585821-73a9-4318-8c4a-4c31c6d8945d
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -430,
          "y": 1210
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      blockrequestfrom:
        simple: ${incident.owner}
      blockrequestreviewer:
        simple: ${Select Name of The Reviewer.Answers.0}
      emailbodyhtml:
        simple: ${HTMLBody}
      investigationanalysis:
        simple: ${incident.investigationanalysis}
      iocvalue:
        complex:
          accessor: IOC
          root: Blacklist
          transformers:
          - operator: Stringify
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      justificationfortheiocblockrequest:
        simple: ${incident.justificationfortheiocblockrequest}
      name:
        simple: IoC Block Review - ${incident.id} - ${incident.rawType} - ${incident.owner}
      parentincidentlink:
        simple: ${incidentlink}
      ticketnumber:
        simple: HT-${incident.id}
      type:
        simple: Threat Intel IOC review
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.create.inc
      id: 310a6300-ef4a-4b0a-8d5e-c45f96ac6672
      iscommand: true
      name: Create a New Ticket To Track IoC Blocking
      script: Builtin|||createNewIncident
      type: regular
      version: -1
    taskid: 310a6300-ef4a-4b0a-8d5e-c45f96ac6672
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": 1580
        }
      }
  "44":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: justificationfortheiocblockrequest
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Please justify why this IoC needs to be blocked
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: Your SOC team
      title: Please justify why this IoC needs to be blocked
      totalanswers: 0
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ignore-outputs:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: caddb366-2c3c-4b60-8786-31d1b973185e
      iscommand: false
      name: Please Justify Why This IoC Needs To Be Blocked (Will be shared with L2
        for review)
      type: collection
      version: -1
    taskid: caddb366-2c3c-4b60-8786-31d1b973185e
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -430,
          "y": 310
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #ff00ff;">Notified
          to Manager</span><br /></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f2397039-42af-4d06-8047-af5e9abcacfa
      iscommand: true
      name: Set Action Notification
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f2397039-42af-4d06-8047-af5e9abcacfa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": 1750
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: db8942f1-4229-4c95-80fb-989ad49df694
      iscommand: false
      name: END
      type: title
      version: -1
    taskid: db8942f1-4229-4c95-80fb-989ad49df694
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -430,
          "y": 1930
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6418f452-a821-47ad-8130-dfa532fd827b
      iscommand: false
      name: TCS-Preprocessing Playbook For Block IOC Review Request v1.0_KK
      playbookId: 45310316-33ad-43c8-8d62-e52d24af459e
      type: playbook
      version: -1
    taskid: 6418f452-a821-47ad-8130-dfa532fd827b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -430,
          "y": 1390
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Blacklist.IOC
      value:
        complex:
          accessor: "0"
          root: Which IOC.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d9dcf38b-7528-444d-8c03-3ad67e10872a
      iscommand: false
      name: Set The Blacklist value
      script: Set
      type: regular
      version: -1
    taskid: d9dcf38b-7528-444d-8c03-3ad67e10872a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": 830
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1995,
        "width": 380,
        "x": -430,
        "y": 0
      }
    }
  }
