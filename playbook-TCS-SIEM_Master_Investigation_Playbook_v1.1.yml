contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 8c04b88f-60c2-440d-8514-461c2ad2b3ef
inputs: []
name: TCS-SIEM Master Investigation Playbook v1.1
outputs: []
sourceplaybookid: a9ccaf94-6e1b-48f1-8caf-1e79462ef409
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d7eb7cd3-5d93-497e-8fa2-3db150e767e3
      iscommand: false
      name: ""
      version: -1
    taskid: d7eb7cd3-5d93-497e-8fa2-3db150e767e3
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 420,
          "y": -1160
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: rawCloseReason
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: duplicate
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "2"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c480314e-bf1e-4d6a-89c4-cd9782587021
      iscommand: false
      name: Is This a Re-Opened Duplicate Alert
      type: condition
      version: -1
    taskid: c480314e-bf1e-4d6a-89c4-cd9782587021
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 420,
          "y": -1010
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 1
    scriptarguments:
      closeNotes:
        simple: Duplicate - Auto Close
      closingnote:
        simple: Duplicate - Auto Close
      duplicateticketnumber:
        simple: NA. This is Duplicate - Auto Close incident
      forensicsdone:
        simple: Not Applicable
      incidentclosingreason:
        simple: Duplicate
      investigationanalysis:
        simple: Not Applicable
      investigationconclusion:
        simple: Duplicate
      remediationrequired:
        simple: Not Applicable
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 98de70dd-6560-4315-8b68-86189a422db4
      iscommand: true
      name: Set Incident Closing Reason Context - Duplicate
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 98de70dd-6560-4315-8b68-86189a422db4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -630,
          "y": 840
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: alertid
                root: incident
          operator: inList
          right:
            iscontext: true
            value:
              simple: lists.SIEM_C&C_Rule
      label: Command & Control
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: alertid
                root: incident
          operator: inList
          right:
            iscontext: true
            value:
              simple: lists.SIEM_WebApplicationAttacks_Rule
      label: Web Application Attacks
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: alertid
                root: incident
          operator: inList
          right:
            iscontext: true
            value:
              simple: lists.SIEM_Reconnaisance_Rule
      label: Reconnaissance
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: alertid
                root: incident
          operator: inList
          right:
            iscontext: true
            value:
              simple: lists.SIEM_Dos/Ddos Attack_Rule
      label: DoS
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: alertid
                root: incident
          operator: inList
          right:
            value:
              simple: lists.SIEM_CSS_Rule
      label: Cross site scripting
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      Command & Control:
      - "10"
      Cross site scripting:
      - "16"
      DoS:
      - "15"
      Reconnaissance:
      - "14"
      Web Application Attacks:
      - "12"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6ff9c0e1-a2e8-4f7f-8e4d-5da110064f37
      iscommand: false
      name: What Is The SIEM Attack Vector ?
      type: condition
      version: -1
    taskid: 6ff9c0e1-a2e8-4f7f-8e4d-5da110064f37
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 420,
          "y": 590
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 409b00ea-fd58-43a4-81e8-2eca597499ca
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 409b00ea-fd58-43a4-81e8-2eca597499ca
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 420,
          "y": 1060
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 48451eb6-63ad-4625-8373-c02516f7f750
      iscommand: false
      name: 'Sub Playbook : Does Offence Belongs to citi Project'
      playbookId: 5f927e50-cf6b-4d54-837b-d3ade76bc624
      type: playbook
      version: -1
    taskid: 48451eb6-63ad-4625-8373-c02516f7f750
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 420,
          "y": -440
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7892a2bb-fef9-42c3-8ca8-0dd563886f3d
      iscommand: false
      name: 'Sub Playbook: SIEM Case And Severity Assignment'
      playbookId: 295ecc0c-df2f-4462-8ee5-1986387919f2
      type: playbook
      version: -1
    taskid: 7892a2bb-fef9-42c3-8ca8-0dd563886f3d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 420,
          "y": 390
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1c0a763a-540a-4ed4-892d-29b7dd15cb3e
      iscommand: false
      name: 'Sub Playbook: C&C Attack Vector Investigation Playbook'
      playbookId: f0626514-aaf7-4ffa-827b-2bf61e13885a
      type: playbook
      version: -1
    taskid: 1c0a763a-540a-4ed4-892d-29b7dd15cb3e
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 660,
          "y": 840
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4f7209c1-7474-42a0-8280-b7659fbec6a9
      iscommand: false
      name: 'Sub Playbook: Generic Attack Vector Investigation Playbook'
      playbookId: d82c63d5-b2a6-4453-86de-9d8b0f479441
      type: playbook
      version: -1
    taskid: 4f7209c1-7474-42a0-8280-b7659fbec6a9
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 200,
          "y": 840
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3be91a60-f69d-4592-80d3-b6d5e65b0699
      iscommand: false
      name: 'Sub Playbook: Web Exploits Attack Vector Investigation Playbook'
      playbookId: 6746e62f-12b0-42bf-8292-bb8efdac16bc
      type: playbook
      version: -1
    taskid: 3be91a60-f69d-4592-80d3-b6d5e65b0699
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 840
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 834467a1-192f-4715-8e6f-0f5c2283b873
      iscommand: false
      name: Start Detection and Closure SLA Timers
      type: title
      version: -1
    taskid: 834467a1-192f-4715-8e6f-0f5c2283b873
    timertriggers:
    - action: start
      fieldname: closuresla
    - action: start
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 420,
          "y": -770
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 12332cbb-6ebe-4525-83c8-410266fc843f
      iscommand: false
      name: 'Sub Playbook: Recon Attack Vector Investigation Playbook'
      playbookId: 890aeb75-42cc-45ce-8892-c3d34332269f
      type: playbook
      version: -1
    taskid: 12332cbb-6ebe-4525-83c8-410266fc843f
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 840
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: efd533d6-858f-4de7-8af6-1daec7d20502
      iscommand: false
      name: TCS-Investigation Playbook-Attack Vector-DOS/DDOS
      playbookId: b52f98e9-dfcf-4251-8023-c6188b5c2ee8
      type: playbook
      version: -1
    taskid: efd533d6-858f-4de7-8af6-1daec7d20502
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -220,
          "y": 840
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 90c490e5-203e-491b-85f9-f56d229e7d8c
      iscommand: false
      name: TCS-Investigation Playbook-Attack Vector-Cross site scripting
      playbookId: 6279f151-9f6e-46e4-8baf-2d3e1babac94
      type: playbook
      version: -1
    taskid: 90c490e5-203e-491b-85f9-f56d229e7d8c
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2060,
          "y": 840
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      tenant:
        complex:
          accessor: name
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: '- '
            operator: split
          - operator: LastArrayElement
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 9e509b2e-c20a-478e-83b7-abcfd126ee92
      iscommand: true
      name: Set Tenant in Incident Field
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 9e509b2e-c20a-478e-83b7-abcfd126ee92
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 420,
          "y": -600
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.alertid
          operator: isEqualString
          right:
            value:
              simple: "115376"
        - left:
            iscontext: true
            value:
              simple: incident.alertid
          operator: isEqualString
          right:
            value:
              simple: "115375"
        - left:
            iscontext: true
            value:
              simple: incident.alertid
          operator: isEqualString
          right:
            value:
              simple: "109262"
        - left:
            iscontext: true
            value:
              simple: incident.alertid
          operator: isEqualString
          right:
            value:
              simple: "111716"
        - left:
            iscontext: true
            value:
              simple: incident.alertid
          operator: isEqualString
          right:
            value:
              simple: "104219"
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2918a717-2213-442b-83f2-44519f9b0ff6
      iscommand: false
      name: Check if rule matches for waf
      type: condition
      version: -1
    taskid: 2918a717-2213-442b-83f2-44519f9b0ff6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 420,
          "y": -260
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      suspiciousiocs:
        simple: ${incident.offensesource}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 58f913e4-cb87-40aa-8919-8ebbcd5e431f
      iscommand: false
      name: TCS-Blacklist IOC_WAF
      playbookId: 1868ae4f-ca32-4b19-83ef-c20f82fe1911
      type: playbook
      version: -1
    taskid: 58f913e4-cb87-40aa-8919-8ebbcd5e431f
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 200,
          "y": 150
        }
      }
  "21":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: offensesource
                root: incident
          operator: IsInCidrRanges
          right:
            value:
              simple: 10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
      label: "yes"
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "20"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 390fcef8-2535-4e03-8481-31456c634b7e
      iscommand: false
      name: 'Exclude the Private IP '
      type: condition
      version: -1
    taskid: 390fcef8-2535-4e03-8481-31456c634b7e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 200,
          "y": -80
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "18_9_#default#": 0.39,
      "1_13_#default#": 0.51,
      "1_2_yes": 0.1,
      "21_9_yes": 0.22,
      "3_11_#default#": 0.89,
      "3_12_Web Application Attacks": 0.84,
      "3_14_Reconnaissance": 0.9,
      "3_16_Cross site scripting": 0.9
    },
    "paper": {
      "dimensions": {
        "height": 2285,
        "width": 3070,
        "x": -630,
        "y": -1160
      }
    }
  }
