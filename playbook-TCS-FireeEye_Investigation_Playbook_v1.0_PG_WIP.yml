contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 2e3e340e-4aa6-4335-88d1-a67a48181f2f
inputs: []
name: TCS-FireeEye Investigation Playbook_v1.0_PG_WIP
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fc1e1079-0fa6-4008-8355-f684c802208b
      iscommand: false
      name: ""
      version: -1
    taskid: fc1e1079-0fa6-4008-8355-f684c802208b
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 430,
          "y": -750
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: true
    quietmode: 0
    scriptarguments:
      alert_id:
        complex:
          accessor: alertid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: FireEye Central Management
      description: Searches and retrieves the details of a single alert.
      id: acce224e-6eb4-4d94-8f07-f4691304de59
      iscommand: true
      name: Fetch the alert from Fireeye Console
      script: FireEye Central Management|||fireeye-cm-get-alert-details
      type: regular
      version: -1
    taskid: acce224e-6eb4-4d94-8f07-f4691304de59
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": -620
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0563d4c7-ce47-476c-8e6b-1075ccac031d
      iscommand: false
      name: Start Acknowledgement SLA
      type: title
      version: -1
    taskid: 0563d4c7-ce47-476c-8e6b-1075ccac031d
    timertriggers:
    - action: start
      fieldname: acknowledgementsla
    type: title
    view: |-
      {
        "position": {
          "x": 430,
          "y": -450
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.owner
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 905f6b3e-c81e-4751-859e-1249f3e379f4
      iscommand: false
      name: Is Owner assigned?
      type: condition
      version: -1
    taskid: 905f6b3e-c81e-4751-859e-1249f3e379f4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 430,
          "y": -305
        }
      }
  "4":
    continueonerror: true
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      name:
        simple: AutoAssignment_Lock
      timeout:
        simple: "600"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Demisto Lock
      description: Gets a specific lock. If the lock doesn't exist, it creates one.
        If the lock is already in use, the command waits until the lock is released
        or until timeout is reached. If timeout is reached and the lock hasn't been
        released, the command fails to get the lock.
      id: b7496165-5612-41db-8ba4-97ddb23eab49
      iscommand: true
      name: Locking the Assignment Task
      script: Demisto Lock|||demisto-lock-get
      type: regular
      version: -1
    taskid: b7496165-5612-41db-8ba4-97ddb23eab49
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": -135
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      desc:
        complex:
          accessor: name
          root: incident
      incidentid:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a44f925e-ed1a-4a8d-8bdd-e9fd7cc729bb
      iscommand: false
      name: AutoAssign Analyst To Incident
      script: 0021cb92-321d-4754-81a1-66fc6a41635d
      type: regular
      version: -1
    taskid: a44f925e-ed1a-4a8d-8bdd-e9fd7cc729bb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 50
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      name:
        simple: AutoAssignment_Lock
    separatecontext: false
    skipunavailable: false
    task:
      brand: Demisto Lock
      description: Release a lock
      id: 0f581802-f67e-4e39-864e-efba0ad8f6fa
      iscommand: true
      name: Release the Assignment Task
      script: Demisto Lock|||demisto-lock-release
      type: regular
      version: -1
    taskid: 0f581802-f67e-4e39-864e-efba0ad8f6fa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 245
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Expose the incident owner into IncidentOwner context key
      id: 9a0627c7-90f4-4020-834e-63fa8ae3631a
      iscommand: false
      name: Populate Incident Owner Context
      script: ExposeIncidentOwner
      type: regular
      version: -1
    taskid: 9a0627c7-90f4-4020-834e-63fa8ae3631a
    timertriggers:
    - action: start
      fieldname: closuresla
    - action: start
      fieldname: detectionsla
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 425
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      username:
        complex:
          accessor: owner
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.get.user.by.username
      id: 4cb01193-1f61-4039-87f7-185de265944c
      iscommand: true
      name: Get Incident Owner Details
      script: Builtin|||getUserByUsername
      type: regular
      version: -1
    taskid: 4cb01193-1f61-4039-87f7-185de265944c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 600
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      selectshift:
        complex:
          accessor: roles
          root: UserByUsername
          transformers:
          - args:
              from:
                value:
                  simple: '['
            operator: substringFrom
          - args:
              to:
                value:
                  simple: ']'
            operator: substringTo
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ' '
            operator: join
          - args:
              regex:
                value:
                  simple: ' CSOC-XSOAR-Admin'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Read-Only'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Operator'
              replaceWith: {}
            operator: replaceMatch
          - args:
              delimiter: {}
            operator: splitAndTrim
      shift:
        complex:
          accessor: roles
          root: UserByUsername
          transformers:
          - args:
              from:
                value:
                  simple: '['
            operator: substringFrom
          - args:
              to:
                value:
                  simple: ']'
            operator: substringTo
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ' '
            operator: join
          - args:
              regex:
                value:
                  simple: ' CSOC-XSOAR-Admin'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Read-Only'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Operator'
              replaceWith: {}
            operator: replaceMatch
          - args:
              delimiter: {}
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 5b644b67-fe12-4f1f-811b-a860aa4d7834
      iscommand: true
      name: Set Investigator Role In Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 5b644b67-fe12-4f1f-811b-a860aa4d7834
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 770
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: runStatus
                root: incident.acknowledgementsla
          operator: isEqualString
          right:
            value:
              simple: running
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3a6c4396-219e-451f-8987-940b8c1d67d6
      iscommand: false
      name: Is Acknowledgement SLA Still Running ?
      type: condition
      version: -1
    taskid: 3a6c4396-219e-451f-8987-940b8c1d67d6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 430,
          "y": 1850
        }
      }
  "11":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Have You Completed This Task
        options: []
        optionsarg:
        - {}
        - simple: Yes - Move To The Next Task
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Please Click The 'Lets Get Started!' Button
      totalanswers: 0
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 816a9ffe-fd45-463e-8dde-fcdae2508819
      iscommand: false
      name: Please Click The 'Lets Get Started!' Button
      type: collection
      version: -1
    taskid: 816a9ffe-fd45-463e-8dde-fcdae2508819
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 430,
          "y": 2025
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 11aed170-7907-4611-8f7f-e69e6735f97d
      iscommand: false
      name: Stop Acknowledgement SLA
      type: title
      version: -1
    taskid: 11aed170-7907-4611-8f7f-e69e6735f97d
    timertriggers:
    - action: stop
      fieldname: responsesla
    - action: stop
      fieldname: acknowledgementsla
    - action: start
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 430,
          "y": 2215
        }
      }
  "13":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: whichslabreached
                root: incident
          operator: isEqualString
          right:
            value:
              simple: acknowledgementsla
        - left:
            iscontext: true
            value:
              complex:
                accessor: whichslabreached
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: acknowledgementsla
      label: "yes"
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bb1a1038-264d-4d0a-88db-afdd32578bff
      iscommand: false
      name: Is response sla breached?
      type: condition
      version: -1
    taskid: bb1a1038-264d-4d0a-88db-afdd32578bff
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 430,
          "y": 2350
        }
      }
  "14":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: justificationforacknowledgementslabreached
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Provide justification for response sla violated
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: Your SOC team
      title: Provide justification for response sla violated
      totalanswers: 0
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Provide justification for acknowledgement sla violated
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 1b5e89a4-c902-4292-83f5-e407adb883be
      iscommand: false
      name: Provide justification for acknowledgement sla violated
      type: collection
      version: -1
    taskid: 1b5e89a4-c902-4292-83f5-e407adb883be
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 430,
          "y": 2525
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7fd4a6af-b50e-4e05-8774-24d12b0c2b8a
      iscommand: false
      name: TCS-Triage-Case Management v3_KK
      playbookId: b82a6df1-9a17-4fae-889e-c6f7bde37df1
      type: playbook
      version: -1
    taskid: 7fd4a6af-b50e-4e05-8774-24d12b0c2b8a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 430,
          "y": 2705
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: "Is This a True Positive Alert ?\n(Study The IoC Threat Intelligence
          Report. Are IoCs Part of The XSOAR Block List ? Check if the indicators
          have block tags and the expiration status. Also check for 'Related Incidents') "
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No, Its a Confirmed - False Positive
      - No / Not Sure - To Be Determined
      - No, Its a Benign-True Positive
      - Yes, It is True Positive
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      Benign-True Positive:
      - "29"
      Confirmed - False Positive:
      - "27"
      No / Not Sure - To Be Determined:
      - "17"
      Yes, It is True Positive:
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 92236d17-9014-468a-8116-2efd07d7b71f
      iscommand: false
      name: "Is This a True Positive Alert ?\n(Study The IoC Threat Intelligence Report.
        Are IoCs Part of The XSOAR Block List ? Check if the indicators have block
        tags and the expiration status. Also check for 'Related Incidents') "
      type: condition
      version: -1
    taskid: 92236d17-9014-468a-8116-2efd07d7b71f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 407.5,
          "y": 2900
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 652b73d7-2339-4816-89d1-8b87e6140c5e
      iscommand: false
      name: Investigate - Not Sure To Be Determined
      type: title
      version: -1
    taskid: 652b73d7-2339-4816-89d1-8b87e6140c5e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 407.5,
          "y": 3190
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: "Would You Like To Contain The Host While You Investigate ? \n(NOTE:
          if the alert looks suspicious its recommended to contain the machine) "
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "21"
      "Yes":
      - "19"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e431f359-e89a-4d0d-84d0-db0269a5e5b7
      iscommand: false
      name: "Would You Like To Contain The Host While You Investigate ? \n(NOTE: if
        the alert looks suspicious its recommended to contain the machine) "
      tags:
      - report
      type: condition
      version: -1
    taskid: e431f359-e89a-4d0d-84d0-db0269a5e5b7
    timertriggers:
    - action: stop
      fieldname: threatresponsesla
    type: condition
    view: |-
      {
        "position": {
          "x": 407.5,
          "y": 3350
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      containmachine:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 06d8a9f6-f777-4d96-8d3a-3012707a59b8
      iscommand: true
      name: Set Contain Machine Context To - YES
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 06d8a9f6-f777-4d96-8d3a-3012707a59b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 407.5,
          "y": 3580
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1ee87653-c77e-4551-8cec-9da1198b2b75
      iscommand: false
      name: 'Sub Playbook: Contain Host via CrowdStrike'
      playbookId: a4d833cf-d2ae-4de1-846a-992f5293b414
      type: playbook
      version: -1
    taskid: 1ee87653-c77e-4551-8cec-9da1198b2b75
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 407.5,
          "y": 3750
        }
      }
  "21":
    continueonerrortype: ""
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: ""
      headerfontcolor: ""
      isexternalrtl: false
      sender: ""
      submitbuttonbackgroundcolor: ""
      submitbuttonfontcolor: ""
      submittext: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: 'Study The IoC Threat Intelligence Report. Are IoCs Part of The XSOAR
          Block List ? (check if the indicators have block tags and the expiration
          status. Also check for ''Related Incidents'') '
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes - SOME IoCs Are Part of The Block List
      - Yes - ALL IoCs Are Part of The Block List
      - No - NONE of The IoCs are Part of The Block List
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      No - NONE of The IoCs are Part of The Block List:
      - "23"
      Yes - ALL IoCs Are Part of The Block List:
      - "24"
      Yes - SOME IoCs Are Part of The Block List:
      - "22"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 653f2548-34a3-483e-87a1-ad210da7d99a
      iscommand: false
      name: 'Study The IoC Threat Intelligence Report. Are IoCs Part of The XSOAR
        Block List ? (check if the indicators have block tags and the expiration status.
        Also check for ''Related Incidents'') '
      tags:
      - report
      type: condition
      version: -1
    taskid: 653f2548-34a3-483e-87a1-ad210da7d99a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 407.5,
          "y": 3930
        }
      }
  "22":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Review The IoC Intel To Assess The Threat Severity of The IoCs That
            Are Not Blocked. Once Your Ready - Move To The Next Task
        options: []
        optionsarg:
        - {}
        - simple: I'm Ready - Move To The Next Task
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Investigation Guide
      totalanswers: 0
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Investigation Guide
      cc: null
      format: ""
      methods: []
      replyOptions:
      - I'm Ready - Procced To Next Task
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d2316d68-d8ff-469c-89bb-9cbafc8fcc85
      iscommand: false
      name: Review The IoC Intel To Assess The Threat Severity of The IoCs That Are
        Not Blocked. Once Your Ready - Move To The Next Task
      tags:
      - report
      type: collection
      version: -1
    taskid: d2316d68-d8ff-469c-89bb-9cbafc8fcc85
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 80,
          "y": 4110
        }
      }
  "23":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Review The IoC Intel To Assess The Threat. Once Your Ready - Move
            To The Next Task
        options: []
        optionsarg:
        - {}
        - simple: I'm Ready - Procced To Next Task
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Investigation Guide
      totalanswers: 0
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Investigation Guide
      cc: null
      format: ""
      methods: []
      replyOptions:
      - I'm Ready - Procced To Next Task
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f8a1ce7a-be78-4399-859e-07c1bb69f60d
      iscommand: false
      name: Review The IoC Intel To Assess The Threat. Once Your Ready - Move To The
        Next Task
      tags:
      - report
      type: collection
      version: -1
    taskid: f8a1ce7a-be78-4399-859e-07c1bb69f60d
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 720,
          "y": 4110
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Based on The IoC Intel, Do You Need To Change The Alert Severity ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "26"
      "Yes":
      - "25"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 17f5ea60-74ce-439c-87e5-6005cec779f6
      iscommand: false
      name: Based on The IoC Intel, Do You Need To Change The Alert Severity ?
      tags:
      - report
      type: condition
      version: -1
    taskid: 17f5ea60-74ce-439c-87e5-6005cec779f6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 407.5,
          "y": 4300
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: acfb660a-f8d8-41aa-85fa-6232aef0b958
      iscommand: false
      name: 'Sub Playbook: Triage The Alert'
      playbookId: b82a6df1-9a17-4fae-889e-c6f7bde37df1
      type: playbook
      version: -1
    taskid: acfb660a-f8d8-41aa-85fa-6232aef0b958
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 407.5,
          "y": 4515
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Is This a True Positive Alert ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No, Its a Confirmed - False Positive
      - No, Its a Benign-True Positive
      - Yes, it is True Positive
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      No, Its a Benign-True Positive:
      - "29"
      No, Its a Confirmed - False Positive:
      - "27"
      Yes, it is True Positive:
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5a777edc-d322-47aa-8ab0-6701a8a96349
      iscommand: false
      name: Is This a True Positive Alert ?
      type: condition
      version: -1
    taskid: 5a777edc-d322-47aa-8ab0-6701a8a96349
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 407.5,
          "y": 4680
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 42dcd2c5-471d-49ed-8ec3-e17e6251728a
      iscommand: false
      name: False Positive (Stop Detection Timer)
      type: title
      version: -1
    taskid: 42dcd2c5-471d-49ed-8ec3-e17e6251728a
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": -200,
          "y": 4930
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2433f159-5ad9-4e86-8fbc-172c16fa59d6
      iscommand: false
      name: True Positive (Stop Detection SLA & Start Threat Response SLA)
      type: title
      version: -1
    taskid: 2433f159-5ad9-4e86-8fbc-172c16fa59d6
    timertriggers:
    - action: stop
      fieldname: detectionsla
    - action: start
      fieldname: threatresponsesla
    type: title
    view: |-
      {
        "position": {
          "x": 410,
          "y": 4940
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e3e43822-95dd-4870-8b64-e46c3cd8e57c
      iscommand: false
      name: Benign True Positive (Stop Detection Timer)
      type: title
      version: -1
    taskid: e3e43822-95dd-4870-8b64-e46c3cd8e57c
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 4930
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: True Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: af670739-c77e-4773-8ef6-bb5ed7f9de70
      iscommand: true
      name: Set 'Investigation Conclusion' To True Positive
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: af670739-c77e-4773-8ef6-bb5ed7f9de70
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 5090
        }
      }
  "31":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: anyimpact
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Was there any Impact ? (service disruption, malware installed,
            successful C&C communication..etc) '
        options: []
        optionsarg:
        - {}
        - simple: "No"
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Was there any Impact ? (service disruption, malware installed, successful
        C&C communication..etc)
      totalanswers: 0
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "32"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: db263dcd-0d88-4ee3-8a35-1c3487935f71
      iscommand: false
      name: 'Was there any Impact ? (service disruption, malware installed, successful
        C&C communication..etc) '
      type: collection
      version: -1
    taskid: db263dcd-0d88-4ee3-8a35-1c3487935f71
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 410,
          "y": 5260
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Was there any Impact ? .Answers
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "35"
      "yes":
      - "33"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aa62090c-0926-4dfd-831e-94679b7b28c6
      iscommand: false
      name: Does The CSOC Manager Need To Be Notified ? (auto select if impact is
        'Yes')
      tags:
      - report
      type: condition
      version: -1
    taskid: aa62090c-0926-4dfd-831e-94679b7b28c6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": 5430
        }
      }
  "33":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: emailbody
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter Notification Message To CSOC Manager (give a brief about the
            true positive alert and the impact)
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: ""
      title: Enter Notification Message To CSOC Manager
      totalanswers: 0
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "34"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f8eace10-92a2-468c-89be-5dfab2954be5
      iscommand: false
      name: Enter Notification Message To CSOC Manager (give a brief about the true
        positive alert and the impact)
      type: collection
      version: -1
    taskid: f8eace10-92a2-468c-89be-5dfab2954be5
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 410,
          "y": 5630
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 2
    scriptarguments:
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          ${incident.emailbody}

          Investigation Link --> https://soar.tcsapps.com/#/Custom/caseinfoid/${incident.id}
      cc:
        simple: ${UserByUsername.email}
      subject:
        simple: '*True Positive Notification* EDR Investigation - Severity - ${incident.mailerseverity}'
      to:
        simple: kunal.krushev@tcs.com,yogesh.gholap@tcs.com,csocsenioroperator@tcscomprod.onmicrosoft.com,csocanalyst@tcscomprod.onmicrosoft.com,badrinath.sivakumar@tcs.com
      using:
        simple: Mail Sender_instance_CSOC_Mail
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 51d79226-d965-4331-885b-6ae44d443cfb
      iscommand: true
      name: Notify CSOC Manager & Necessary Stakeholders
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 51d79226-d965-4331-885b-6ae44d443cfb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 5820
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: 'Do You Need To Mitigate The Threat By Blocking IoCs or Containing
          Host ? (NOTE: for IP address blocking other than Palo Alto FW, pls connect
          with location FW owner)'
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes - I Want To Block IOC
      - Yes - I Want To Contain Host
      - No - They Are Already Blocked / Contained
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      No - They Are Already Blocked / Contained:
      - "48"
      Yes - I Want To Block IOC:
      - "37"
      Yes - I Want To Contain Host:
      - "36"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ab72a4c2-40ee-4431-8e3b-96e802b4c1f9
      iscommand: false
      name: 'Do You Need To Mitigate The Threat By Blocking IoCs or Containing Host
        ? (NOTE: for IP address blocking other than Palo Alto FW, pls connect with
        location FW owner)'
      tags:
      - report
      type: condition
      version: -1
    taskid: ab72a4c2-40ee-4431-8e3b-96e802b4c1f9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": 6010
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c47c9b5a-26dd-4e37-8fce-6fb46f6fd6d3
      iscommand: false
      name: Start Contain Host SLA\Timer (Inside Sub Playbook)
      type: title
      version: -1
    taskid: c47c9b5a-26dd-4e37-8fce-6fb46f6fd6d3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 160,
          "y": 6200
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1afecdd2-ebed-433d-8b6f-9df28ccf2c1d
      iscommand: false
      name: Start Block IOC\Mitigation SLA Timer (Inside Sub Playbook)
      type: title
      version: -1
    taskid: 1afecdd2-ebed-433d-8b6f-9df28ccf2c1d
    timertriggers:
    - action: start
      fieldname: mitigationsla
    type: title
    view: |-
      {
        "position": {
          "x": 660,
          "y": 6200
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      containmachine:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: de749f91-d756-4dff-8741-d72429640f2d
      iscommand: true
      name: Set Contain Machine Context To - YES
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: de749f91-d756-4dff-8741-d72429640f2d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 160,
          "y": 6490
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d7c14524-c4f8-4c82-85cc-8526a44b01d3
      iscommand: false
      name: 'Sub Playbook: Contain Host via CrowdStrike'
      playbookId: a4d833cf-d2ae-4de1-846a-992f5293b414
      type: playbook
      version: -1
    taskid: d7c14524-c4f8-4c82-85cc-8526a44b01d3
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 160,
          "y": 6655
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      iocblockrequest:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 27e4ddf2-d90e-4249-8d79-bbb7ee5fa08c
      iscommand: true
      name: Set Context IOC Block Request To - Yes
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 27e4ddf2-d90e-4249-8d79-bbb7ee5fa08c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 660,
          "y": 6330
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a155f257-7dff-44bb-8e9b-e74fd28ac27d
      iscommand: false
      name: TCS-Select IOC To Block_CM Playbook v1_KK
      playbookId: 9dacaaf8-64e7-4758-822e-694b991ee19c
      type: playbook
      version: -1
    taskid: a155f257-7dff-44bb-8e9b-e74fd28ac27d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 660,
          "y": 6510
        }
      }
  "42":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "1"
                root: Which IOC.Answers
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 533402fe-36f1-4db7-85e6-290f6791c1cf
      iscommand: false
      name: Check condition if extra IOC are selected
      type: condition
      version: -1
    taskid: 533402fe-36f1-4db7-85e6-290f6791c1cf
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 660,
          "y": 6695
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${Which IOC.Answers.1},${Which IOC.Answers.0}
      contextKey:
        simple: SelectedIOCAnswer
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: d6b81cd6-9e06-4055-89ac-99e128e7a9f0
      iscommand: false
      name: Set in array for context value
      script: CreateArray
      type: regular
      version: -1
    taskid: d6b81cd6-9e06-4055-89ac-99e128e7a9f0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 660,
          "y": 6890
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalselectedIOC
      value:
        complex:
          root: SelectedIOCAnswer
          transformers:
          - args:
              chars:
                value:
                  simple: '[]'
            operator: StripChars
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f1d54680-6e6f-4659-845b-9eecce77bbe6
      iscommand: false
      name: Set Final Selected IOC in context
      script: Set
      type: regular
      version: -1
    taskid: f1d54680-6e6f-4659-845b-9eecce77bbe6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 660,
          "y": 7030
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 13c11cc2-7f4a-4493-8d5c-12b9da6d2062
      iscommand: false
      name: TCS-Blacklist IOC v3.0_PG
      playbookId: 72dda1e2-ca72-42c4-8232-4592b180eb04
      type: playbook
      version: -1
    taskid: 13c11cc2-7f4a-4493-8d5c-12b9da6d2062
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 660,
          "y": 7225
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalselectedIOC
      value:
        complex:
          accessor: "0"
          root: Which IOC.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b94398ad-622f-4733-8f0c-82f7b6fe7430
      iscommand: false
      name: Set Context Value
      script: Set
      type: regular
      version: -1
    taskid: b94398ad-622f-4733-8f0c-82f7b6fe7430
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1100,
          "y": 6935
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8bbe5cc9-0a53-4282-844f-9b34df89ad33
      iscommand: false
      name: Stop Mitigation SLA (Inside Sub Playbook)
      type: title
      version: -1
    taskid: 8bbe5cc9-0a53-4282-844f-9b34df89ad33
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    type: title
    view: |-
      {
        "position": {
          "x": 650,
          "y": 7445
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      iocblockrequest:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 40dbcc92-7bc3-4f23-89b1-dfaef9dae50b
      iscommand: true
      name: Set Context Block IOC To  - No
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 40dbcc92-7bc3-4f23-89b1-dfaef9dae50b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 7665
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 87b45438-acc0-4ecb-8cb9-468b37c01a56
      iscommand: false
      name: Stop Threat Response SLA
      type: title
      version: -1
    taskid: 87b45438-acc0-4ecb-8cb9-468b37c01a56
    timertriggers:
    - action: stop
      fieldname: threatresponsesla
    type: title
    view: |-
      {
        "position": {
          "x": 370,
          "y": 7930
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Review The Alert - Check If You Need To Raise an IMT ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No -  IMT Not Required
      - Yes - I Have Raised an IMT
      - I'm Not Sure - Will Do It later
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      I'm Not Sure - Will Do It later:
      - "55"
      No -  IMT Not Required:
      - "51"
      Yes - I Have Raised an IMT:
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 81fcd52e-148e-4d96-8d6a-60deb5ae6a97
      iscommand: false
      name: Review The Alert - Check If You Need To Raise an IMT ?
      type: condition
      version: -1
    taskid: 81fcd52e-148e-4d96-8d6a-60deb5ae6a97
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": 8080
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 077efbf7-5e24-4539-81a7-d3a0c493ceaa
      iscommand: true
      name: Update IMT Context To - No
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 077efbf7-5e24-4539-81a7-d3a0c493ceaa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 8330
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: ad10e908-2704-4f35-8d15-50093ecb65a3
      iscommand: true
      name: Update IMT Context To - Yes
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ad10e908-2704-4f35-8d15-50093ecb65a3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 780,
          "y": 8330
        }
      }
  "53":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtnumber
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Number
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: ""
      title: Enter The IMT Number
      totalanswers: 0
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 110aaa57-78e5-4ad8-80d0-b8627806f629
      iscommand: false
      name: Enter The IMT Number
      type: collection
      version: -1
    taskid: 110aaa57-78e5-4ad8-80d0-b8627806f629
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 840,
          "y": 8470
        }
      }
  "54":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtlocation
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Location
        options: []
        optionsarg: []
        placeholder: 'Enter Branch and Location.  Eg: TCS-Mumbai-Olympus'
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: Your SOC team
      title: Enter The IMT Location
      totalanswers: 0
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: ""
      headerfontcolor: ""
      isexternalrtl: false
      sender: ""
      submitbuttonbackgroundcolor: ""
      submitbuttonfontcolor: ""
      submittext: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d4c58443-b59a-48eb-8a51-a6dfb19f0ecf
      iscommand: false
      name: Enter The IMT Location
      type: collection
      version: -1
    taskid: d4c58443-b59a-48eb-8a51-a6dfb19f0ecf
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 840,
          "y": 8610
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 00a97bdd-6790-42fd-87a0-947289b6ec7b
      iscommand: false
      name: 'Sub Playbook: Check With Investigator for Lift Containment'
      playbookId: 67fdcc7f-387d-4349-825a-597ed003e264
      type: playbook
      version: -1
    taskid: 00a97bdd-6790-42fd-87a0-947289b6ec7b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 370,
          "y": 8670
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7599cc4a-b963-4bd9-8d32-aabd4b07c154
      iscommand: false
      name: Document & Close Investigation
      type: title
      version: -1
    taskid: 7599cc4a-b963-4bd9-8d32-aabd4b07c154
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 370,
          "y": 8870
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 2
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 806f61f2-040d-4094-81ac-2922f4ce8516
      iscommand: false
      name: 'Sub Playbook: Document & Close'
      playbookId: 4a46e3dc-82da-4b3a-86ca-eb2f9dfd589f
      type: playbook
      version: -1
    taskid: 806f61f2-040d-4094-81ac-2922f4ce8516
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 370,
          "y": 9005
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bb426cc8-88cb-4237-848a-08e2ef5de34a
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: bb426cc8-88cb-4237-848a-08e2ef5de34a
    timertriggers:
    - action: stop
      fieldname: closuresla
    type: title
    view: |-
      {
        "position": {
          "x": 370,
          "y": 9190
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 98ccaeb5-c834-4cc7-8ad1-360e968c4762
      iscommand: false
      name: TCS-Severity Fireeye_v1.0_PG_WIP
      playbookId: 8562462e-26bc-4122-803c-0de317ff7f0e
      type: playbook
      version: -1
    taskid: 98ccaeb5-c834-4cc7-8ad1-360e968c4762
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 430,
          "y": 1690
        }
      }
  "60":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: alertname
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: malware_object
      label: "yes"
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "59"
      "yes":
      - "61"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 708d7842-2240-4966-8464-0cd1691a303c
      iscommand: false
      name: Check if the alert is "Malware Object"
      type: condition
      version: -1
    taskid: 708d7842-2240-4966-8464-0cd1691a303c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 430,
          "y": 950
        }
      }
  "61":
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Eml File
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      queue_id:
        complex:
          accessor: fireeyequeueid
          root: incident
      sensor_name:
        complex:
          accessor: fireeyesensor
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: FireEye Central Management
      description: Download quarantined emails.
      id: b20bf7f6-294a-4a73-8e8f-6bc8b7ecf209
      iscommand: true
      name: 'Download the email from Fireeye '
      script: FireEye Central Management|||fireeye-cm-download-quarantined-emails
      type: regular
      version: -1
    taskid: b20bf7f6-294a-4a73-8e8f-6bc8b7ecf209
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 1280
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 10005,
        "width": 1680,
        "x": -200,
        "y": -750
      }
    }
  }
