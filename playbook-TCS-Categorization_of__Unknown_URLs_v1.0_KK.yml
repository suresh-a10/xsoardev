contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 2d1ca7c9-97b9-495c-8296-ca6185ca5703
inputs: []
name: TCS-Categorization of  Unknown URLs v1.0_KK
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fc208239-975a-461d-8867-b51057844f09
      iscommand: false
      name: ""
      version: -1
    taskid: fc208239-975a-461d-8867-b51057844f09
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 640,
          "y": -180
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: Zscalar uncategorized URLs
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Information about the reference set that had data added or updated.
        This returns the information set, but not the contained data. This feature
        is supported from version 8.1 and upward.
      id: 1dd941af-2de9-4bb8-8ce3-5028d7014f42
      iscommand: true
      name: Read reference set
      script: QRadar_v2_copy|||qradar-get-reference-by-name
      type: regular
      version: -1
    taskid: 1dd941af-2de9-4bb8-8ce3-5028d7014f42
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": -50
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_136
      url:
        complex:
          root: ${StorageURLs}
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds URLs to the specified category.
      id: 09805a4d-483d-4268-8ddc-000ff2e8f011
      iscommand: true
      name: Block URL in zscaler
      script: '|||zscaler-category-add-url'
      type: regular
      version: -1
    taskid: 09805a4d-483d-4268-8ddc-000ff2e8f011
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 270,
          "y": 1450
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${StorageURLs}
      listName:
        simple: New File Sharing or Storage URLs
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: f0f6099f-df25-4746-8dd9-30aa98f38c80
      iscommand: true
      name: Update  list of File sharing in Demsito
      script: Builtin|||addToList
      tags:
      - proxystorageblock
      type: regular
      version: -1
    taskid: f0f6099f-df25-4746-8dd9-30aa98f38c80
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 270,
          "y": 1290
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain.ContentCategories
          operator: containsString
          right:
            value:
              simple: File
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3c943668-aab3-445b-8be0-fe35390b60d3
      iscommand: false
      name: Is there a file sharing category
      type: condition
      version: -1
    taskid: 3c943668-aab3-445b-8be0-fe35390b60d3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 880
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: commands.local.cmd.close.inv
      id: 6458569f-7d97-4049-8955-69b840a9b045
      iscommand: false
      name: Close
      type: title
      version: -1
    taskid: 6458569f-7d97-4049-8955-69b840a9b045
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 700,
          "y": 1780
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: de4cf569-adfc-435e-8550-883cd3f0caac
      iscommand: true
      name: CloseInvestigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: de4cf569-adfc-435e-8550-883cd3f0caac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 720,
          "y": 2020
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8a874d01-7f8a-4ecb-811b-89c3de051f65
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 8a874d01-7f8a-4ecb-811b-89c3de051f65
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 720,
          "y": 2190
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: StorageURLs
      value:
        complex:
          accessor: Name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain.ContentCategories
              operator: containsString
              right:
                value:
                  simple: File
          root: Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1cc7986a-b5c0-4cc9-8f8a-fc0f34a977fc
      iscommand: false
      name: Filter File sharing and storage domains
      script: Set
      type: regular
      version: -1
    taskid: 1cc7986a-b5c0-4cc9-8f8a-fc0f34a977fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 270,
          "y": 1120
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      reputation:
        simple: None
      tags:
        simple: BlockNewFileshareDomains
      type:
        simple: Domain
      value:
        simple: ${StorageURLs}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: fb943ade-5f13-4e44-88c1-bde4bc86fef9
      iscommand: true
      name: Tag  newly discovered File sharing domains
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: fb943ade-5f13-4e44-88c1-bde4bc86fef9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 1610
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      purge_only:
        simple: "true"
      ref_name:
        simple: Zscalar uncategorized URLs
      using:
        simple: QRadar v3_Typosquat Offences
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Removes a reference set or purges its contents.
      id: abc19188-cc25-4890-8816-9ffd6e089467
      iscommand: true
      name: Purge Reference Set Value
      script: '|||qradar-reference-set-delete'
      type: regular
      version: -1
    taskid: abc19188-cc25-4890-8816-9ffd6e089467
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 270
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${QRadar.Reference.Data.Value}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: 'Will create an array object in context from given string input '
      id: 081915be-e167-4857-8641-e17fe04860cd
      iscommand: false
      name: Store reference set value
      script: CreateArray
      type: regular
      version: -1
    taskid: 081915be-e167-4857-8641-e17fe04860cd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 430
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_.[0]}
      retry-count:
        simple: "5"
      retry-interval:
        simple: "10"
      using:
        simple: Cisco Umbrella Investigate_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns the category of a domain. e.g. domain=amazon.com returns
        Ecommerce/Shopping
      id: 17751b46-247a-42ce-8126-73e5c19943c8
      iscommand: true
      name: Check Umbrella Categorization  of URL
      script: '|||umbrella-domain-categorization'
      type: regular
      version: -1
    taskid: 17751b46-247a-42ce-8126-73e5c19943c8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 740
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          root: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 6ba7a1f8-f8d9-4872-84e3-c32f574b3c7f
      iscommand: true
      name: extract domain
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 6ba7a1f8-f8d9-4872-84e3-c32f574b3c7f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 580
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${QRadar.Reference.NumberOfElements}
          operator: isEqualNumber
          right:
            value:
              simple: "0"
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1208d4fd-4f48-4243-8b76-82c113b4da28
      iscommand: false
      name: Is Reference set Empty
      type: condition
      version: -1
    taskid: 1208d4fd-4f48-4243-8b76-82c113b4da28
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 640,
          "y": 90
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2435,
        "width": 840,
        "x": 260,
        "y": -180
      }
    }
  }
