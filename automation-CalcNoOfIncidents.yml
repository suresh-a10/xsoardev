args:
- isArray: true
  name: my_list
  required: true
- isArray: true
  name: my_dict_list
commonfields:
  id: 501d9489-63e2-4f90-8c4f-7b183584e997
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.10.13.80014
enabled: true
engineinfo: {}
mainengineinfo: {}
name: CalcNoOfIncidents
pswd: ""
runas: DBotWeakRole
runonce: false
script: |-
  my_list = demisto.args().get('my_list')
  my_dict_list = demisto.args().get('my_dict_list')

  item_count = {}

  for item in my_list:
      item_count[item] = 0

  for my_dict in my_dict_list:
      for key, value in my_dict.items():
          if value in my_list:
              item_count[value] += 1
  results = [{"name": item, "count": count} for item, count in item_count.items()]
  entry_context = {"incidentsNo" : results}

  # return_results(item_count)
  return_outputs(
          readable_output="number of incidents calculated",
          outputs=entry_context)
scripttarget: 0
subtype: python3
tags: []
type: python
