comment: |-
  This is a pre-processing script that is used to create the attachments of incoming incidents in an existing incident, then drop the incoming incident.
  It should be configured as a pre-processing rule, and the logic for finding the right incident should be added to the code manually.
  The automation collects the paths and names of the attachments of the incoming incident and passes it to the "CreateFileFromPathObject" automation that is being executed on the existing incident
commonfields:
  id: GetFilePathPreProcessing
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.2.0
    itemVersion: 1.3.8
    packID: CommunityCommonScripts
    packName: Community Common Scripts
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
dockerimage: demisto/python3:3.11.10.115186
enabled: true
engineinfo: {}
mainengineinfo: {}
name: GetFilePathPreProcessing
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  register_module_line('GetFilePathPreProcessing', 'start', __line__())
  demisto.debug('pack name = Community Common Scripts, pack version = 1.3.8')


  import time


  attachments = demisto.incidents()[0].get("attachment")
  files = []
  if attachments is not None:
      for attachment in attachments:
          files.append({"path": attachment["path"], "name": attachment["name"]})

      # The logic for finding the incident that we want to drop the new files to should be here
      incident = "123"
      demisto.executeCommand("executeCommandAt", {"command": "CreateFileFromPathObject",
                             "arguments": {"object": files}, "incidents": incident})
      time.sleep(10)
  demisto.results(False)

  register_module_line('GetFilePathPreProcessing', 'end', __line__())
scripttarget: 0
subtype: python3
system: true
tags:
- preProcessing
type: python
