contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: fbf6c0cc-4739-4e97-8c65-718475c32287
inputs:
- description: ""
  key: URL
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: validatedurl
      root: incident
- description: ""
  key: domain
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: validateddomain
      root: incident
- description: ""
  key: IP
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: validatedipaddress
      root: incident
- description: ""
  key: Hash
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: validatedhash
      root: incident
name: TCS-Validate Submitted IOC v3.1_KK_WIP
outputs: []
quiet: true
sourceplaybookid: 7e0105f5-2558-456a-85df-77c9558ebba6
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
      - "4"
      - "6"
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fdb8ab45-2579-4062-877d-be27409abd7a
      iscommand: false
      name: ""
      version: -1
    taskid: fdb8ab45-2579-4062-877d-be27409abd7a
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 960,
          "y": 340
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.domain
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 306f1258-c967-44d3-8c2c-dbc80788ce3d
      iscommand: false
      name: Is There a URL in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 306f1258-c967-44d3-8c2c-dbc80788ce3d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 620
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.URL
      value:
        complex:
          root: inputs.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 58f736a7-3dfd-436b-8c57-a6136eec2d88
      iscommand: false
      name: Set Blacklist URL in 'Blacklist.URL' Context
      script: Set
      type: regular
      version: -1
    taskid: 58f736a7-3dfd-436b-8c57-a6136eec2d88
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 870
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: BlacklistIOC
          operator: match
          right:
            value:
              simple: (?i)(?:[-[A-Za-z0-9_\p{L}]+\[?\.\]?)+[-\p{L}]+(?::\d+)?(?:((\/)|(\*|\?))+[-\d\p{L}+&@#\/%=~_$?!\-:,.\(\);\\*–—―|]+)?|\b[A-Za-z0-_%=+\p{L}-]+@[A-Za-z0-9\p{L}.-]+\.[A-Za-z]{2,}\b
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 711c779e-dd36-458e-8328-9ba11e566d0c
      iscommand: false
      name: Is There a Web Domain in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 711c779e-dd36-458e-8328-9ba11e566d0c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 620
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.Domain
      value:
        complex:
          root: inputs.domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6dc8a461-0f1c-4234-8c47-f815bb677fe7
      iscommand: false
      name: Set Blacklist Domain in 'Blacklist.Domain' Context
      script: Set
      type: regular
      version: -1
    taskid: 6dc8a461-0f1c-4234-8c47-f815bb677fe7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 870
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.IP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e9d40970-6497-452a-88b5-8a35aa9e72df
      iscommand: false
      name: Is There an IPv4 IP Address in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: e9d40970-6497-452a-88b5-8a35aa9e72df
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 20,
          "y": 620
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.IPV4
      value:
        complex:
          root: inputs.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f31f035e-0e25-4b04-850a-1ea2cb37601d
      iscommand: false
      name: Set Blacklist IPv4 IP Address in 'Blacklist.IPV4' Context
      script: Set
      type: regular
      version: -1
    taskid: f31f035e-0e25-4b04-850a-1ea2cb37601d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 870
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Hash
          operator: isExists
      label: "Yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "Yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9d72e45e-0f6c-4787-87a5-940b3d29547e
      iscommand: false
      name: Is There a MD5 Hash in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 9d72e45e-0f6c-4787-87a5-940b3d29547e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 620
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.MD5
      value:
        complex:
          root: inputs.Hash
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f93e1d10-1d22-4338-8fde-bf7b3e63a8c8
      iscommand: false
      name: Set Blacklist MD5 Hash in 'Blacklist.MD5' Context
      script: Set
      type: regular
      version: -1
    taskid: f93e1d10-1d22-4338-8fde-bf7b3e63a8c8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 870
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: BlacklistIOC
          operator: match
          right:
            value:
              simple: ^[a-f0-9]{64}$
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a41e1c00-9b8c-4e39-800b-1d747fc6b27d
      iscommand: false
      name: Is There a SHA256 Hash in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: a41e1c00-9b8c-4e39-800b-1d747fc6b27d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1750,
          "y": 620
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.SHA256
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: match
              right:
                value:
                  simple: ^[a-f0-9]{64}$
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c5a98f8a-1849-42e3-841d-184ee600b6fc
      iscommand: false
      name: Set Blacklist SHA256 Hash in 'Blacklist.SHA256' Context
      script: Set
      type: regular
      version: -1
    taskid: c5a98f8a-1849-42e3-841d-184ee600b6fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1750,
          "y": 870
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d6b4ae4d-e236-4c3a-8805-ff449bd40d12
      iscommand: false
      name: Check If Submitted IoC(s) Are Part of The Trusted Domain List
      type: title
      version: -1
    taskid: d6b4ae4d-e236-4c3a-8805-ff449bd40d12
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2180,
          "y": 1090
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      domains:
        simple: ${lists.TCS_Customer_Domain_List}
      urls:
        complex:
          accessor: URL
          root: Blacklist
          transformers:
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the supplied URLs are in the specified domains.
      id: 3943ffb6-d5e3-43d6-8f66-25ad675e7df3
      iscommand: false
      name: Is The URL Part of The Trusted List
      script: IsUrlPartOfDomain
      type: regular
      version: -1
    taskid: 3943ffb6-d5e3-43d6-8f66-25ad675e7df3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1280
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.URL
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Blacklist.URL
              operator: inList
              right:
                iscontext: true
                value:
                  simple: lists.TCS_Customer_Domain_List
          root: Blacklist.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1f22db36-6d61-4218-81ba-253ce9d78668
      iscommand: false
      name: Set Identified Trusted URL in Context
      script: Set
      type: regular
      version: -1
    taskid: 1f22db36-6d61-4218-81ba-253ce9d78668
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1650
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 2
    scriptarguments:
      main_domains:
        complex:
          accessor: Domain
          root: Blacklist
      possible_sub_domains_to_test:
        simple: ${lists.TCS_Customer_Domain_List}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script accepts multiple values for both arguments and will
        iterate through each of the domains to check if the specified subdomains are
        located in at least one of the specified main domains. If the tested subdomain
        is in one of the main domains, the result will be true. For example, if the
        domain_to_check values are apps.paloaltonetworks.com and apps.paloaltonetworks.bla
        and the domains_to_compare values are paloaltonetworks.com and demisto.com,
        the result for apps.paloaltonetworks.com will be true since it is a part of
        the paloaltonetworks.com domain. The result for apps.paloaltonetworks.bla
        will be false since it is not a part of the paloaltonetworks.com or demisto.com
        domain.
      id: a441301f-cb40-4421-8816-2299ac16263d
      iscommand: false
      name: Is The Domain Part of The Trusted List
      script: IsInternalDomainName
      type: regular
      version: -1
    taskid: a441301f-cb40-4421-8816-2299ac16263d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1280
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: Blacklist
          operator: notIn
          right:
            iscontext: true
            value:
              simple: Trusted.URL
      label: "yes"
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bf02cc67-cabf-4733-8761-e4f23218c03b
      iscommand: false
      name: Are There Any URLs For Blacklisting ?
      type: condition
      version: -1
    taskid: bf02cc67-cabf-4733-8761-e4f23218c03b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2130
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.URL
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Blacklist.URL
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: Trusted.URL
          root: Blacklist.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a1571e88-0a55-4529-8aca-46fb97f4fca8
      iscommand: false
      name: Set The Filtered Blacklisting URLs in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: a1571e88-0a55-4529-8aca-46fb97f4fca8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2380
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsInternal
                root: IsInternalDomain
          operator: containsGeneral
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7db49205-dfa1-4f3e-8bac-3852bbff3309
      iscommand: false
      name: Are There Domain(s) Part of The Trusted List
      type: condition
      version: -1
    taskid: 7db49205-dfa1-4f3e-8bac-3852bbff3309
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1450
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.Domain
      value:
        complex:
          accessor: DomainToTest
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IsInternalDomain.DomainToTest
              operator: in
              right:
                iscontext: true
                value:
                  simple: Blacklist.Domain
          - - left:
                iscontext: true
                value:
                  simple: IsInternalDomain.IsInternal
              operator: isEqualString
              right:
                value:
                  simple: "true"
          root: IsInternalDomain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 0a6a005e-91fe-4f2b-834b-b2f005728f29
      iscommand: false
      name: Set Identified Trusted Domain in Context
      script: Set
      type: regular
      version: -1
    taskid: 0a6a005e-91fe-4f2b-834b-b2f005728f29
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1650
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: Blacklist
          operator: notIn
          right:
            iscontext: true
            value:
              simple: Trusted.Domain
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2ba64f76-b073-4cfc-8b9f-8d5b77f32d2e
      iscommand: false
      name: Are There Any Domains For Blacklisting ?
      type: condition
      version: -1
    taskid: 2ba64f76-b073-4cfc-8b9f-8d5b77f32d2e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 2130
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Blacklist.Domain
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: Trusted.Domain
          root: Blacklist.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 843e98ab-40ea-4c21-82c3-2dc5797bc599
      iscommand: false
      name: Set The Filtered Blacklisting Domains in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: 843e98ab-40ea-4c21-82c3-2dc5797bc599
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 2380
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "31"
      "yes":
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IPV4
          root: Blacklist
      ipRanges:
        simple: ${lists.Google Public IP Addresses},${lists.Microsoft Public IP Addresses},${lists.TCS
          Public IP Addresses},${lists.MasterIOC_IP Address},${lists.ZscalerIPAddresses}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: e7eaa2ac-086e-4ac8-8719-89d4acebf630
      iscommand: false
      name: Is The IP Address Part of The Trusted List
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: e7eaa2ac-086e-4ac8-8719-89d4acebf630
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 20,
          "y": 1280
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.IPV4
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: ae7de0cf-2872-4ea0-8790-3d67be2e2fe6
      iscommand: false
      name: Set Identified Trusted IP Address in Context
      script: Set
      type: regular
      version: -1
    taskid: ae7de0cf-2872-4ea0-8790-3d67be2e2fe6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 1650
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: InRange
                root: IP
          operator: isEqualString
          right:
            value:
              simple: "no"
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e0f5c318-d0cf-4bc3-8c82-e1cb48526c58
      iscommand: false
      name: Are There Any IP Addresses For Blacklisting ?
      type: condition
      version: -1
    taskid: e0f5c318-d0cf-4bc3-8c82-e1cb48526c58
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 20,
          "y": 2130
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.IPV4
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d9ee781f-23bc-40fd-8c26-83917fd2dd4b
      iscommand: false
      name: Set The Filtered Blacklisting IP Address in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: d9ee781f-23bc-40fd-8c26-83917fd2dd4b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 2380
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.Hash
      value:
        complex:
          accessor: MD5
          root: Blacklist
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 344a4e3a-8318-40e4-8a75-6e47ce4e4050
      iscommand: false
      name: Set The Combined Blacklisting Hash in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: 344a4e3a-8318-40e4-8a75-6e47ce4e4050
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 1280
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.Hash
      value:
        complex:
          accessor: SHA256
          root: Blacklist
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: fccda5d1-79b6-4b65-8ab2-3a15aff664b3
      iscommand: false
      name: Set The Combined Blacklisting Hash in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: fccda5d1-79b6-4b65-8ab2-3a15aff664b3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1750,
          "y": 1280
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 47de2479-7516-4fa9-8c31-17833c16ac0b
      iscommand: false
      name: Update Widgets For Trusted & Validated IoC(s)
      type: title
      version: -1
    taskid: 47de2479-7516-4fa9-8c31-17833c16ac0b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2180,
          "y": 2730
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Trusted
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 01cbaf52-be3f-4c83-892d-8ab5085e587d
      iscommand: false
      name: Are There Trusted IoC(s)?
      type: condition
      version: -1
    taskid: 01cbaf52-be3f-4c83-892d-8ab5085e587d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1940,
          "y": 2900
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4e939af3-03a4-405b-8e43-0710775e8c13
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 4e939af3-03a4-405b-8e43-0710775e8c13
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2180,
          "y": 3320
        }
      }
  "40":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: FinalBlacklist
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: e9349551-d889-435c-8e74-70002aa86aa2
      iscommand: false
      name: 'Are There Validated IoC(s)? '
      type: condition
      version: -1
    taskid: e9349551-d889-435c-8e74-70002aa86aa2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2420,
          "y": 2900
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      trustediocs:
        complex:
          root: Trusted
          transformers:
          - operator: Stringify
          - args:
              chars:
                value:
                  simple: '{}'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 89c177a7-6d4d-471d-83df-23ac73a34949
      iscommand: true
      name: Set The Trusted IoC(s) Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 89c177a7-6d4d-471d-83df-23ac73a34949
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1940,
          "y": 3080
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      validatediocsforblacklisting:
        complex:
          root: FinalBlacklist
          transformers:
          - operator: Stringify
          - args:
              chars:
                value:
                  simple: '{}'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: e7f5aa28-72e3-40dc-8557-33ac724a2e1f
      iscommand: true
      name: Set The Trusted IoC(s) Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: e7f5aa28-72e3-40dc-8557-33ac724a2e1f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2420,
          "y": 3080
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      validatedurl:
        complex:
          accessor: URL
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 33b89e55-d49f-45ca-8927-3d4aad7e37e2
      iscommand: true
      name: Set Incident Context ' Validated URL'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 33b89e55-d49f-45ca-8927-3d4aad7e37e2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2550
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      validatedipaddress:
        complex:
          accessor: IPV4
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 11bc9097-26a2-4cb1-862d-a4b2510cf781
      iscommand: true
      name: Set Incident Context ' Validated IP Address'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 11bc9097-26a2-4cb1-862d-a4b2510cf781
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 2550
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      validateddomain:
        complex:
          accessor: Domain
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f1a5d6ee-45b5-4a3d-8f55-994767b19ca6
      iscommand: true
      name: Set Incident Context ' Validated Domain'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f1a5d6ee-45b5-4a3d-8f55-994767b19ca6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 2550
        }
      }
  "46":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Hash
                root: FinalBlacklist
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 368069e1-76cd-42dc-83b8-b6d4b7414085
      iscommand: false
      name: Check If Context 'FinalBlacklist.Hash' is Set
      type: condition
      version: -1
    taskid: 368069e1-76cd-42dc-83b8-b6d4b7414085
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1530,
          "y": 1650
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      validatedhash:
        complex:
          accessor: Hash
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 5d766c79-30df-4ff3-804b-543b89a4d823
      iscommand: true
      name: Set Incident Context ' Validated Hash'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 5d766c79-30df-4ff3-804b-543b89a4d823
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1530,
          "y": 2550
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      trustedipaddress:
        complex:
          accessor: IPV4
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 224703ec-85c7-4075-87ba-498c3ba4f393
      iscommand: true
      name: Set Incident Context ' Trusted IP Address'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 224703ec-85c7-4075-87ba-498c3ba4f393
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 1870
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      trustedurl:
        complex:
          accessor: URL
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fe93a832-37cf-475e-8258-e51054fc5ad2
      iscommand: true
      name: Set Incident Context ' Trusted URL'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: fe93a832-37cf-475e-8258-e51054fc5ad2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1870
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      trusteddomain:
        complex:
          accessor: Domain
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 48b5fa0d-a33e-41b4-87c0-cbab45eb8dd5
      iscommand: true
      name: Set Incident Context ' Trusted Domain'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 48b5fa0d-a33e-41b4-87c0-cbab45eb8dd5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1870
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "10_11_Yes": 0.46,
      "10_14_#default#": 0.24,
      "12_14_#default#": 0.41,
      "23_24_yes": 0.45,
      "23_36_#default#": 0.1,
      "25_26_yes": 0.5,
      "27_28_yes": 0.46,
      "27_36_#default#": 0.11,
      "29_30_yes": 0.47,
      "31_32_yes": 0.48,
      "31_36_#default#": 0.1,
      "4_14_#default#": 0.13,
      "4_5_yes": 0.48,
      "6_14_#default#": 0.17,
      "6_7_yes": 0.5,
      "8_14_#default#": 0.1,
      "8_9_yes": 0.49
    },
    "paper": {
      "dimensions": {
        "height": 3045,
        "width": 2780,
        "x": 20,
        "y": 340
      }
    }
  }
