contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
hidden: true
id: 2a227a44-e082-4a09-8c7c-1ca85c5a2e8c
inputs:
- description: ""
  key: InternalIs.CyberSecurityOps@tcs.com
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-IP blocking_received from email
outputs: []
sourceplaybookid: 3a37bf98-d8e9-4ab9-8889-dba63691e69c
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e7d4231f-9ba9-42d2-8b6a-e8c89c595e28
      iscommand: false
      name: ""
      version: -1
    taskid: e7d4231f-9ba9-42d2-8b6a-e8c89c595e28
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 280,
          "y": -230
        }
      }
  "3":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: ${File}
        options:
        - ""
        - "Yes"
        - "No"
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: List of IPs for blocking
      totalanswers: 0
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: Check this ip list
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to:
        simple: v.ghule@tcs.com
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: 'Approve above list before sending mail to Firewall team: ${recorded-future-get-ip-risklist}'
      subject:
        simple: 'Approve IOC list '
      to:
        simple: p.godse@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 0f876ecd-a5ba-4334-8a3b-1531f328209a
      iscommand: false
      name: SOC Admin Review the IOC list and Approve it before sending mail
      type: collection
      version: -1
    taskid: 0f876ecd-a5ba-4334-8a3b-1531f328209a
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 280,
          "y": 140
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: List of IPs for blocking.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    - condition:
      - - left:
            iscontext: true
            value:
              simple: List of IPs for blocking.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "No"
      label: "no"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "19"
      "yes":
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 952f530b-2c81-4d21-84be-998f4b696a62
      iscommand: false
      name: Check approval
      type: condition
      version: -1
    taskid: 952f530b-2c81-4d21-84be-998f4b696a62
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 280,
          "y": 320
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          root: File
      file:
        simple: ${File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script will parse a CSV file and place the unique IPs, Domains
        and Hashes into the context.
      id: 540574c2-620f-4b4c-8f6a-bba76e7398b6
      iscommand: false
      name: Parse the attachment received.
      script: ParseCSV
      type: regular
      version: -1
    taskid: 540574c2-620f-4b4c-8f6a-bba76e7398b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 280,
          "y": -40
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      dest-dir:
        simple: /var/lib/tomcat6/webapps/ROOT
      fileID:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: remoteaccess
      description: commands.server.remoteacess.copyto.description
      id: 61d74c6d-4f47-4c41-8eef-d71b12139fb2
      iscommand: true
      name: copy to
      script: remoteaccess|||copy-to
      type: regular
      version: -1
    taskid: 61d74c6d-4f47-4c41-8eef-d71b12139fb2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 30,
          "y": 500
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      cmd:
        simple: echo "${FileData}" >> /var/lib/tomcat6/webapps/ROOT/Demisto_Block2.txt
          && cat /var/lib/tomcat6/webapps/ROOT/Demisto_Block2.txt | sort -u -o /var/lib/tomcat6/webapps/ROOT/Demisto_Block2.txt
    separatecontext: false
    skipunavailable: false
    task:
      brand: remoteaccess
      description: commands.server.remoteacess.ssh.description
      id: 7afc08a7-39d6-4e62-88ae-e740b804d110
      iscommand: true
      name: SSH
      script: remoteaccess|||ssh
      type: regular
      version: -1
    taskid: 7afc08a7-39d6-4e62-88ae-e740b804d110
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 30,
          "y": 670
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0b9ff70f-893c-477d-8452-d3efe322043d
      iscommand: false
      name: close investigation
      type: regular
      version: -1
    taskid: 0b9ff70f-893c-477d-8452-d3efe322043d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 290,
          "y": 900
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1225,
        "width": 640,
        "x": 30,
        "y": -230
      }
    }
  }
