contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 659ee34a-0a3c-4a41-88ad-cc7b47f17b2b
inputs: []
name: TCS-Create Recorded Future_Bad Indicator Domain_v1.0_Vrushali_WIP
outputs: []
sourceplaybookid: 3a37bf98-d8e9-4ab9-8889-dba63691e69c
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4ef7075c-b3e5-44b4-8550-822a299fe37c
      iscommand: false
      name: ""
      version: -1
    taskid: 4ef7075c-b3e5-44b4-8550-822a299fe37c
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -900,
          "y": -730
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "36000000"
      retry-count:
        simple: "3"
      retry-interval:
        simple: "20"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets the domain risk list as a CSV file from Recorded Future.
      id: a61ea2bc-4390-4312-8e5b-ae3ac7e2e313
      iscommand: true
      name: Fetch recorded future domain risk list via Integration
      script: Recorded Future v2.1|||recorded-future-get-domain-risklist
      type: regular
      version: -1
    taskid: a61ea2bc-4390-4312-8e5b-ae3ac7e2e313
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": -475
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: domain_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: domain
      threshold:
        simple: "80"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cd2a12ce-5774-4acc-878f-f44fe838aaaf
      iscommand: false
      name: Retrieve Domain with reputation >=80 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: cd2a12ce-5774-4acc-878f-f44fe838aaaf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": -310
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_domain.csv
          root: File
      extend-context:
        simple: extractedDomainList=FileData
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 953f1cfa-c494-401e-83b3-402d07596a28
      iscommand: false
      name: Read extracted list (only Domain Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: 953f1cfa-c494-401e-83b3-402d07596a28
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 60
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2e1a923f-629f-49db-8102-d8f1c6bc1014
      iscommand: false
      name: Download Recorded Future IP List and Save to Demisto Lists
      type: title
      version: -1
    taskid: 2e1a923f-629f-49db-8102-d8f1c6bc1014
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -900,
          "y": -600
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d37927c6-b1ab-42d9-8197-f0de3492a4c8
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: d37927c6-b1ab-42d9-8197-f0de3492a4c8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -900,
          "y": 1870
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "72000000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future
      description: Gets the URL risk list as a CSV file from Recorded Future.
      id: d2b16441-4cff-4c07-81b6-b9c4e5c7b547
      iscommand: true
      name: Fetch recorded future URL risk list via Integration
      script: Recorded Future|||recorded-future-get-url-risklist
      type: regular
      version: -1
    taskid: d2b16441-4cff-4c07-81b6-b9c4e5c7b547
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": -270
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: url_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: url
      threshold:
        simple: "80"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c3745d49-322f-4cfa-89dc-e067662b90d4
      iscommand: false
      name: Retrieve URLs with reputation >=80 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: c3745d49-322f-4cfa-89dc-e067662b90d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": -120
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_url.csv
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 427fe228-f6f7-45b6-8fda-f07fe615562f
      iscommand: false
      name: Read extracted list (only URL Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: 427fe228-f6f7-45b6-8fda-f07fe615562f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 200
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e941faf2-c41f-42ff-87fc-3c93542b390f
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: e941faf2-c41f-42ff-87fc-3c93542b390f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 20,
          "y": 520
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6e790752-7619-4f39-8710-29f4f7380574
      iscommand: false
      name: Download Recorded Future URL List and Save to Demisto Lists
      type: title
      version: -1
    taskid: 6e790752-7619-4f39-8710-29f4f7380574
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 20,
          "y": -390
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b99f907b-2e17-4fbc-805a-c1895c77aac6
      iscommand: false
      name: Download Recorded Future Domain List and Save to Demisto Lists
      type: title
      version: -1
    taskid: b99f907b-2e17-4fbc-805a-c1895c77aac6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 470,
          "y": -390
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "72000000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future
      description: Gets the domain risk list as a CSV file from Recorded Future.
      id: dfea174c-df85-4a10-8e07-b6f4eeaae1c2
      iscommand: true
      name: Fetch recorded future Domain risk list via Integration
      script: Recorded Future|||recorded-future-get-domain-risklist
      type: regular
      version: -1
    taskid: dfea174c-df85-4a10-8e07-b6f4eeaae1c2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": -270
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: domain_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: domain
      threshold:
        simple: "80"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 09844f46-050e-4cdb-8897-a553310beb46
      iscommand: false
      name: Retrieve Domains with reputation >=80 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: 09844f46-050e-4cdb-8897-a553310beb46
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": -120
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_domain.csv
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: c3479f35-b29d-478a-827f-660aab2364b4
      iscommand: false
      name: Read extracted list (only Domain Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: c3479f35-b29d-478a-827f-660aab2364b4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 200
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: efef5f08-80c8-417d-8402-4d2a23ce2398
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: efef5f08-80c8-417d-8402-4d2a23ce2398
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 470,
          "y": 520
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a64e01e3-8cb3-4410-8ee2-102b1173d5b6
      iscommand: false
      name: Download Recorded Future Hash List and Save to Demisto Lists
      type: title
      version: -1
    taskid: a64e01e3-8cb3-4410-8ee2-102b1173d5b6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": -390
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "72000000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future
      description: Gets the hash risk list from Recorded Future.
      id: 35587eb5-b587-4cb3-87fa-46a51bbb285f
      iscommand: true
      name: Fetch recorded future Hash risk list via Integration
      script: Recorded Future|||recorded-future-get-hash-risklist
      type: regular
      version: -1
    taskid: 35587eb5-b587-4cb3-87fa-46a51bbb285f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": -280
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: hash_list.csv
          root: InfoFile
      extend-context:
        simple: CSVReputationToList.count=HashAddressCount
      ioc_type:
        simple: hash
      threshold:
        simple: "80"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3ca1540e-547a-4a97-86c4-ac7240101b9c
      iscommand: false
      name: Retrieve Hashs with reputation > =80 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: 3ca1540e-547a-4a97-86c4-ac7240101b9c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": -120
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_hash.csv
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 738958c8-f813-4303-8746-03305d185642
      iscommand: false
      name: Read extracted list (only HASH Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: 738958c8-f813-4303-8746-03305d185642
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 200
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[a-fA-F\d]{32}\b
            operator: RegexExtractAll
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      listName:
        simple: RecordedFutureHashRiskList-MD5
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: f79c359e-42c6-4745-835d-9d729d9a3fab
      iscommand: true
      name: Overwrite Recorded Future MD5 HashRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: f79c359e-42c6-4745-835d-9d729d9a3fab
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 350
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 41708ae0-7b8b-4cbf-8728-805be2c128fe
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 41708ae0-7b8b-4cbf-8728-805be2c128fe
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 820
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
      listName:
        simple: RecordedFutureDomainRiskList
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 752ef269-fc59-4038-8eb0-f9a7389eeb74
      iscommand: true
      name: Overwrite Recorded Future DomainRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 752ef269-fc59-4038-8eb0-f9a7389eeb74
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 350
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
      listName:
        simple: RecordedFutureURLRiskList
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: b375a83e-5b03-44de-8953-a21f6c39e9fb
      iscommand: true
      name: Overwrite Recorded Future URLRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: b375a83e-5b03-44de-8953-a21f6c39e9fb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 360
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
      listName:
        simple: RecordedFutureDomainRiskList
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 22397185-f6a7-4838-814e-cbf6d0f5c870
      iscommand: true
      name: Overwrite Recorded Future Domain RiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 22397185-f6a7-4838-814e-cbf6d0f5c870
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 230
        }
      }
  "46":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: Hashs Exist
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "42"
      Hashs Exist:
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b9d736a7-af92-4a0d-8237-1ef051a9eaea
      iscommand: false
      name: Are there any Hashs witth replutation >=80?
      type: condition
      version: -1
    taskid: b9d736a7-af92-4a0d-8237-1ef051a9eaea
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 910,
          "y": 40
        }
      }
  "48":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: URLs Exist
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      URLs Exist:
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cc5320c4-42ac-4dbb-8053-352a7f9cef69
      iscommand: false
      name: Are there any URLs with replutation >=80?
      type: condition
      version: -1
    taskid: cc5320c4-42ac-4dbb-8053-352a7f9cef69
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 20,
          "y": 40
        }
      }
  "49":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: Domains Exist
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      Domains Exist:
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 33fd886c-0994-45c6-83c0-21c89cacb4fe
      iscommand: false
      name: Are there any Domains with replutation >=80?
      type: condition
      version: -1
    taskid: 33fd886c-0994-45c6-83c0-21c89cacb4fe
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -900,
          "y": -145
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[a-fA-F\d]{40}\b
            operator: RegexExtractAll
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      listName:
        simple: RecordedFutureHashRiskList-SHA1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: ad441808-dabe-443a-8ca2-73cd8abf727e
      iscommand: true
      name: Overwrite Recorded Future SHA1 HashRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: ad441808-dabe-443a-8ca2-73cd8abf727e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 505
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[a-fA-F\d]{64}\b
            operator: RegexExtractAll
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      listName:
        simple: RecordedFutureHashRiskList-SHA256
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: a2241076-7655-4371-840e-b8b7b52a0889
      iscommand: true
      name: Overwrite Recorded Future SHA256 HashRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: a2241076-7655-4371-840e-b8b7b52a0889
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 660
        }
      }
  "52":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: Domains Exist
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      Domains Exist:
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ff0d6e75-ee8a-4ef0-8fc4-41774cd812e3
      iscommand: false
      name: Are there any Domains with reputation >=80?
      type: condition
      version: -1
    taskid: ff0d6e75-ee8a-4ef0-8fc4-41774cd812e3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 470,
          "y": 40
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "64"
      - "65"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "10000000"
      tags:
        simple: rfdomainblocked80
      type:
        simple: Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ListCompare.RightOnly
              operator: isNotEmpty
          root: ListCompare.RightOnly
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 568abf1c-d7d9-4a72-8088-4b080047ffca
      iscommand: true
      name: Create New Indicator With Tag 'rfdomainblocked80'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 568abf1c-d7d9-4a72-8088-4b080047ffca
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 1290
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "43200"
      extend-context:
        simple: indicator.domain=value
      ignore-outputs:
        simple: "true"
      query:
        simple: tags:rfdomainblocked80  and expirationStatus:active
      retry-count:
        simple: "3"
      size:
        simple: "100000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 38b4998e-60ae-4ccc-8224-56e3937b44f4
      iscommand: true
      name: Fetch Indicators With Tag 'rfdomainblocked80'
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 38b4998e-60ae-4ccc-8224-56e3937b44f4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 585
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${TaggedIndicator}
      right:
        simple: ${RFSCORE80}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 83220534-9b6a-46ad-82b1-5b2c20d620e9
      iscommand: false
      name: Compare Context 'Extracted Indicator' and 'Indicator.domain'
      script: CompareLists
      type: regular
      version: -1
    taskid: 83220534-9b6a-46ad-82b1-5b2c20d620e9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 920
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RFSCORE80
      value:
        complex:
          root: FileData
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 290b19c1-831b-478d-8afb-4d6053394dbe
      iscommand: false
      name: Set Domain Risk List Into Context
      script: Set
      type: regular
      version: -1
    taskid: 290b19c1-831b-478d-8afb-4d6053394dbe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 410
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TaggedIndicator
      value:
        complex:
          accessor: domain
          root: indicator
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 655eb3ee-9f12-4ce2-8ef4-5ea1325ed074
      iscommand: false
      name: Set Tagged Indictor In Context
      script: Set
      type: regular
      version: -1
    taskid: 655eb3ee-9f12-4ce2-8ef4-5ea1325ed074
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 755
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "67"
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "100000"
      indicatorsValues:
        complex:
          root: ListCompare.LeftOnly
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: 4be8db4a-dd39-478f-8dfa-770e382292b4
      iscommand: true
      name: Expire Indicator With Tag 'rfdomainblocked80' With Threshold < 80
      script: Builtin|||expireIndicators
      type: regular
      version: -1
    taskid: 4be8db4a-dd39-478f-8dfa-770e382292b4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1340,
          "y": 1290
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      doNotWhitelist:
        simple: "true"
      execution-timeout:
        simple: "1000000"
      query:
        simple: expirationStatus:expired and tags:rfdomainblocked80
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.delete.indicators
      id: 454ab01b-2128-4ef5-828b-b2bfd4346bde
      iscommand: true
      name: Delete Expired Domain Indicators
      script: Builtin|||deleteIndicators
      type: regular
      version: -1
    taskid: 454ab01b-2128-4ef5-828b-b2bfd4346bde
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1360,
          "y": 1670
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 741c4c42-dedc-45b0-805b-5630f02f2f08
      iscommand: true
      name: Close Automation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 741c4c42-dedc-45b0-805b-5630f02f2f08
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 2020
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 47497be3-f5e0-46f9-8fc3-ad69100de226
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 47497be3-f5e0-46f9-8fc3-ad69100de226
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -900,
          "y": 2170
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: RightOnly
          root: ListCompare
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 053d46da-8241-44de-84c8-ec9e48f2e31e
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 053d46da-8241-44de-84c8-ec9e48f2e31e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 1505
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: RightOnly
          root: ListCompare
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: f1d02662-1a8c-44cd-8702-f277aa643e61
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: f1d02662-1a8c-44cd-8702-f277aa643e61
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -460,
          "y": 1505
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes URLs from the specified category.
      id: 15dd5dcc-aa4c-4715-8f41-7b07f666d0d1
      iscommand: true
      name: Unblock Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-remove-url
      type: regular
      version: -1
    taskid: 15dd5dcc-aa4c-4715-8f41-7b07f666d0d1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1790,
          "y": 1480
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes URLs from the specified category.
      id: ab85c37d-340f-452f-8df2-102286ca6068
      iscommand: true
      name: Unblock Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-remove-url
      type: regular
      version: -1
    taskid: ab85c37d-340f-452f-8df2-102286ca6068
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1340,
          "y": 1490
        }
      }
  "68":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f5f20d40-dc62-408a-814d-2d172e5e072a
      iscommand: false
      name: Is There An Indicator To Expire ?
      type: condition
      version: -1
    taskid: f5f20d40-dc62-408a-814d-2d172e5e072a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -900,
          "y": 1090
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2965,
        "width": 3080,
        "x": -1790,
        "y": -730
      }
    }
  }
