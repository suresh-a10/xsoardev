contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 46b6eef0-d4db-462e-843b-2f8d80824353
inputs:
- description: ""
  key: saved search name
  playbookInputQuery: null
  required: false
  value:
    simple: High Or Critical Priority Host With Malware - 15 min
name: Splunk Fetch Saved Search Results
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2dd8d38c-7633-4143-8ae3-c1d837787c9a
      iscommand: false
      name: ""
      version: -1
    taskid: 2dd8d38c-7633-4143-8ae3-c1d837787c9a
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 2
    reputationcalc: 1
    scriptarguments:
      earliest_time:
        simple: -1h
      extend-context:
        simple: sid=
      query:
        simple: "| rest /services/search/jobs count=0 | search isDone=1 isSavedSearch=1
          \n| table earliestTime label sid eventCount\n| search label=\"${inputs.saved
          search name}\"\n| sort earliestTime\n| head 1"
      update_context:
        simple: "false"
    separatecontext: false
    skipunavailable: false
    task:
      brand: SplunkPy
      description: Searches Splunk for events.
      id: c950a7bc-bf09-409e-8432-d3205d26ec4a
      iscommand: true
      name: Get SID
      script: SplunkPy|||splunk-search
      type: regular
      version: -1
    taskid: c950a7bc-bf09-409e-8432-d3205d26ec4a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: Splunk.Results=
      sid:
        simple: ${sid.sid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: SplunkPy
      description: Returns the results of a previous Splunk search. You can use this
        command in conjunction with the splunk-job-create command.
      id: 1bcc2234-033d-415f-8a91-b8921af451c6
      iscommand: true
      name: Fetch Results
      script: SplunkPy|||splunk-results
      type: regular
      version: -1
    taskid: 1bcc2234-033d-415f-8a91-b8921af451c6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      dest_ip:
        simple: ${Splunk.Results.dest_ip}
      host:
        simple: ${Splunk.Results.host}
      user:
        simple: ${Splunk.Results.user}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 6d3f632f-0e38-4bff-8760-d1aaba9834e1
      iscommand: false
      name: Playbook to perform rest of task
      playbookId: 99788f3d-2a74-4f71-86ed-63a27a121154
      type: playbook
      version: -1
    taskid: 6d3f632f-0e38-4bff-8760-d1aaba9834e1
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 550
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 595,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
