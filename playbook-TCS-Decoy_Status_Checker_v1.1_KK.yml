contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 06a92ded-b40e-4ab0-8609-f2571cb9ae23
inputs: []
name: TCS-Decoy Status Checker v1.1_KK
outputs: []
sourceplaybookid: 316c93e8-c6d2-4189-86f3-17738792313c
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 70b62e39-1586-493f-8778-139250c7b07b
      iscommand: false
      name: ""
      version: -1
    taskid: 70b62e39-1586-493f-8778-139250c7b07b
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      options:
        simple: -pT:80,443,8080,8443,22,445,3389 --scan-delay 10s
      targets:
        simple: ${lists.Decoy IP Addresses}
    separatecontext: false
    skipunavailable: false
    task:
      brand: nmap
      description: Scan targets with the given parameters
      id: 8ddfd7ad-1259-4d23-8051-4cdb77363c73
      iscommand: true
      name: Scan Decoy IP Addresses
      script: nmap|||nmap-scan
      type: regular
      version: -1
    taskid: 8ddfd7ad-1259-4d23-8051-4cdb77363c73
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 9ca70dbc-9110-40f7-8b90-b6866e4465b2
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 9ca70dbc-9110-40f7-8b90-b6866e4465b2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2130
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b062d55f-5cd0-4666-8e4a-883713dfea1d
      iscommand: false
      name: Close
      type: title
      version: -1
    taskid: b062d55f-5cd0-4666-8e4a-883713dfea1d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Smokescreen IllusionBLACK
      description: Gets events from IllusionBLACK.
      id: d01b0c0c-4b26-4191-8b27-ee46fff4393f
      iscommand: true
      name: Get Detection Events From Smokescreen
      script: Smokescreen IllusionBLACK|||illusionblack-get-events
      type: regular
      version: -1
    taskid: d01b0c0c-4b26-4191-8b27-ee46fff4393f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 1100
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      context_key:
        simple: DecoyIPAccess
      file_name:
        simple: Decoys_Scanned.csv
      header:
        simple: Decoy IP Address
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7077d3aa-6383-4cdd-863c-c14704e977a3
      iscommand: false
      name: Export Scanned IP Address To List
      script: 98fd7176-124d-4739-8f9d-2f1edb20aa55
      type: regular
      version: -1
    taskid: 7077d3aa-6383-4cdd-863c-c14704e977a3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: DecoyIPAccess
      retry-count:
        simple: "5"
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: NMAP.Scan.Hosts.Status
              operator: isNotEqualString
              right:
                value:
                  simple: down
          root: NMAP.Scan.Hosts
          transformers:
          - operator: toLowerCase
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2603a5db-dab8-4820-8f72-401457e370ef
      iscommand: false
      name: Set Successfully Scanned Decoy IPs in Context
      script: Set
      type: regular
      version: -1
    taskid: 2603a5db-dab8-4820-8f72-401457e370ef
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      context_key:
        simple: NotScannedIP
      file_name:
        simple: Decoys_Not_Scanned.csv
      header:
        simple: Decoy IP Address
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a19f3746-aa32-4bfb-87de-79b911ce1095
      iscommand: false
      name: Export Not Scanned IP Address To List
      script: 98fd7176-124d-4739-8f9d-2f1edb20aa55
      type: regular
      version: -1
    taskid: a19f3746-aa32-4bfb-87de-79b911ce1095
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: NotScannedIP
      retry-count:
        simple: "5"
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: NMAP.Scan.Hosts.Status
              operator: isEqualString
              right:
                value:
                  simple: down
          root: NMAP.Scan.Hosts
          transformers:
          - operator: toLowerCase
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e09a3c24-cfee-433a-8658-61a472e3a527
      iscommand: false
      name: Set Decoy IPs Not Scanned in Context
      script: Set
      type: regular
      version: -1
    taskid: e09a3c24-cfee-433a-8658-61a472e3a527
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SmokeDecoyIP
      value:
        complex:
          accessor: Event
          root: IllusionBlack
          transformers:
          - args:
              field:
                value:
                  simple: decoy.ip
            operator: getField
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 573b7423-387d-4b72-8547-89841d289803
      iscommand: false
      name: Set Smokescreen Decoy IPs To Context
      script: Set
      type: regular
      version: -1
    taskid: 573b7423-387d-4b72-8547-89841d289803
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 1265
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${SmokeDecoyIP}
      right:
        simple: ${lists.Smokscreen Decoy IP Addresses}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 97e9780c-e353-469f-8039-d9402548636c
      iscommand: false
      name: Compare Scanned IP List With Smokescreen Decoy IP
      script: CompareLists
      type: regular
      version: -1
    taskid: 97e9780c-e353-469f-8039-d9402548636c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 1430
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "15"
      "yes":
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${ListCompare.RightOnly}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 8e6ddbd3-d128-4808-8afc-94d5aeb7e69e
      iscommand: false
      name: Any Smokescreen Decoy's Not Detect The Scan ?
      script: Exists
      type: condition
      version: -1
    taskid: 8e6ddbd3-d128-4808-8afc-94d5aeb7e69e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 820,
          "y": 1605
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      body:
        simple: |-
          Hello Human,

          I have performed an NMAP scan on the ${TotalDecoyIPs} decoy IP address in my list. PFB The scan summary:

          1. Out of the ${TotalDecoyIPs} decoys, I could successfully scan ${ScannedDecoyIPs} decoys. I could not scan the others  either because the decoy was down or the IP address was not reachable. (refer attached reports)



          Regards,
          Cyber AutoBot
          Internal IT Security, Infrastructure Services
      cc:
        simple: kunal.krushev@tcs.com, yogesh.gholap@tcs.com
      subject:
        simple: Decoy Health Check Scan Report
      to:
        simple: rekha1.yadav@tcs.com,Rahool.doshi@tcs.com,csocanalyst@tcscomprod.onmicrosoft.com,nimisha.prajapati@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 6c2ef038-8c53-4333-85e7-ee0f1ce761c6
      iscommand: true
      name: Notify Scan Performed On Decoy IP Address
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 6c2ef038-8c53-4333-85e7-ee0f1ce761c6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1810
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TotalDecoyIPs
      value:
        complex:
          accessor: Decoy IP Addresses}
          root: ${lists
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
          - operator: count
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: bd589750-91a5-4e9a-85d1-2e5b3ad23193
      iscommand: false
      name: Set Total Decoy Count in Context
      script: Set
      type: regular
      version: -1
    taskid: bd589750-91a5-4e9a-85d1-2e5b3ad23193
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        complex:
          root: DecoyIPAccess
      contextKey:
        simple: ScannedDecoyIPs
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 498a7dc0-7d3b-45a4-87a6-16a786e55e24
      iscommand: false
      name: Set Successfully Scanned Decoy Count in Context
      script: CountArraySize
      type: regular
      version: -1
    taskid: 498a7dc0-7d3b-45a4-87a6-16a786e55e24
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      body:
        simple: |-
          Hello Human,

          I have performed an NMAP scan on the ${TotalDecoyIPs} decoy IP address in my list. PFB The scan summary:

          1. Out of the ${TotalDecoyIPs} decoys, I could successfully scan ${ScannedDecoyIPs} decoys. I could not scan the others either because the decoy was down or the IP address was not reachable. (refer attached reports)

          2. Not all the Smokescreen decoys detected the Nmap scan (refer report SS_Decoy_Notscanned.csv)


          Regards,
          Cyber AutoBot
          Internal IT Security, Infrastructure Services
      cc:
        simple: kunal.krushev@tcs.com, yogesh.gholap@tcs.com
      subject:
        simple: Decoy Health Check Scan Report
      to:
        simple: rekha1.yadav@tcs.com,Rahool.doshi@tcs.com,csocanalyst@tcscomprod.onmicrosoft.com,nimisha.prajapati@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 546257ea-d742-4392-883e-36d73504c037
      iscommand: true
      name: Notify Scan Performed On Decoy IP Address
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 546257ea-d742-4392-883e-36d73504c037
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 1985
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      context_key:
        simple: ListCompare.RightOnly
      file_name:
        simple: SS_Decoy_Notscanned.csv
      header:
        simple: Decoy IP Address
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4aa57d86-8332-47b3-89b4-018c4228d7f6
      iscommand: false
      name: Export Not Scanned IP Address To List
      script: 98fd7176-124d-4739-8f9d-2f1edb20aa55
      type: regular
      version: -1
    taskid: 4aa57d86-8332-47b3-89b4-018c4228d7f6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 1820
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2310,
        "width": 1150,
        "x": 50,
        "y": 50
      }
    }
  }
