contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: a71c67b9-57f4-4c05-8c1a-93692221ad37
inputs: []
name: TCS-CSP Alerts automation playbook_KR
outputs: []
sourceplaybookid: 988d87a9-fb4c-4d7b-82cd-f2fbfa1b2070
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "117"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7e7312e8-58f4-46db-8325-bccc35bb7ce6
      iscommand: false
      name: ""
      version: -1
    taskid: 7e7312e8-58f4-46db-8325-bccc35bb7ce6
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 755,
          "y": -1220
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Expose the incident owner into IncidentOwner context key
      id: efc1519e-aaec-463a-8bcc-7dd714c096e9
      iscommand: false
      name: Populate Incident Owner Context
      script: ExposeIncidentOwner
      type: regular
      version: -1
    taskid: efc1519e-aaec-463a-8bcc-7dd714c096e9
    timertriggers:
    - action: start
      fieldname: closuresla
    - action: start
      fieldname: detectionsla
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 865
        }
      }
  "41":
    continueonerror: true
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        simple: AutoAssignment_Lock
      timeout:
        simple: "600"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Demisto Lock
      description: Gets a specific lock. If the lock doesn't exist, it creates one.
        If the lock is already in use, the command waits until the lock is released
        or until timeout is reached. If timeout is reached and the lock hasn't been
        released, the command fails to get the lock.
      id: 2978bb58-ecc1-4956-8482-fed8a8c6cd76
      iscommand: true
      name: Locking the Assignment Task
      script: Demisto Lock|||demisto-lock-get
      type: regular
      version: -1
    taskid: 2978bb58-ecc1-4956-8482-fed8a8c6cd76
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 360
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 2
    scriptarguments:
      desc:
        complex:
          accessor: subject
          root: incident
      incidentid:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 153ab1d0-8e49-4299-8b18-a9e290dc32ee
      iscommand: false
      name: AutoAssign Analyst To Incident
      script: 0021cb92-321d-4754-81a1-66fc6a41635d
      type: regular
      version: -1
    taskid: 153ab1d0-8e49-4299-8b18-a9e290dc32ee
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 515
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        simple: AutoAssignment_Lock
    separatecontext: false
    skipunavailable: false
    task:
      brand: Demisto Lock
      description: Release a lock
      id: 8259baae-91f1-4d4d-80a8-e545b4030054
      iscommand: true
      name: Release the Assignment Task
      script: Demisto Lock|||demisto-lock-release
      type: regular
      version: -1
    taskid: 8259baae-91f1-4d4d-80a8-e545b4030054
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 690
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      selectshift:
        complex:
          accessor: roles
          root: UserByUsername
          transformers:
          - args:
              from:
                value:
                  simple: '['
            operator: substringFrom
          - args:
              to:
                value:
                  simple: ']'
            operator: substringTo
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ' '
            operator: join
          - args:
              regex:
                value:
                  simple: ' CSOC-XSOAR-Admin'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Read-Only'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Operator'
              replaceWith: {}
            operator: replaceMatch
          - args:
              delimiter: {}
            operator: splitAndTrim
      shift:
        complex:
          accessor: roles
          root: UserByUsername
          transformers:
          - args:
              from:
                value:
                  simple: '['
            operator: substringFrom
          - args:
              to:
                value:
                  simple: ']'
            operator: substringTo
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ' '
            operator: join
          - args:
              regex:
                value:
                  simple: ' CSOC-XSOAR-Admin'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Read-Only'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Operator'
              replaceWith: {}
            operator: replaceMatch
          - args:
              delimiter: {}
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 41203b4a-d185-4071-8304-e9ba2872f219
      iscommand: true
      name: Set Investigator Role In Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 41203b4a-d185-4071-8304-e9ba2872f219
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 1360
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    scriptarguments:
      username:
        complex:
          accessor: owner
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.get.user.by.username
      id: eb926e97-ab71-4456-8355-5abea422dce6
      iscommand: true
      name: Get Incident Owner Details
      script: Builtin|||getUserByUsername
      type: regular
      version: -1
    taskid: eb926e97-ab71-4456-8355-5abea422dce6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 1040
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "97"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: df683efc-3eaf-44f1-8daf-d1911e22b344
      iscommand: false
      name: Start Detection and Closure SLA Timers
      type: title
      version: -1
    taskid: df683efc-3eaf-44f1-8daf-d1911e22b344
    timertriggers:
    - action: start
      fieldname: closuresla
    - action: start
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 45
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d3423a71-b35b-45b9-8549-352d58550de8
      iscommand: false
      name: Start Acknowledgement SLA
      type: title
      version: -1
    taskid: d3423a71-b35b-45b9-8549-352d58550de8
    timertriggers:
    - action: start
      fieldname: responsesla
    - action: start
      fieldname: acknowledgementsla
    type: title
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 1215
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 63d559de-e4f4-4d86-85aa-a33ff2bbe4ea
      iscommand: false
      name: Set Severity
      type: title
      version: -1
    taskid: 63d559de-e4f4-4d86-85aa-a33ff2bbe4ea
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 1535
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: OrignalSeverity
      value:
        simple: ${incident.severity}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 21c209aa-e3c9-4e3b-8bed-c3d058f45152
      iscommand: false
      name: Set Orignal Severity to Context
      script: Set
      type: regular
      version: -1
    taskid: 21c209aa-e3c9-4e3b-8bed-c3d058f45152
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 1680
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "0.5"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8919dd52-a64c-44e2-82c7-b197f3025aba
      iscommand: true
      name: Set Severity to Informational
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8919dd52-a64c-44e2-82c7-b197f3025aba
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 1855
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: ${OrignalSeverity}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 5f4b4e25-a942-4174-8a90-3f90cf9f2558
      iscommand: true
      name: 'Set Original Severity to Incident '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 5f4b4e25-a942-4174-8a90-3f90cf9f2558
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 2030
        }
      }
  "52":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: runStatus
                root: incident.responsesla
          operator: isEqualString
          right:
            value:
              simple: running
      label: "yes"
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "54"
      "yes":
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f54995ce-1e95-4cd0-82d3-8f847c8b0f5b
      iscommand: false
      name: Is Response SLA Still Running ?
      type: condition
      version: -1
    taskid: f54995ce-1e95-4cd0-82d3-8f847c8b0f5b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 2205
        }
      }
  "53":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Have You Completed This Task
        options: []
        optionsarg:
        - {}
        - simple: Yes - Move To The Next Task
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Please Click The 'Lets Get Started!' Button
      totalanswers: 0
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d8bf5a25-5807-4e8d-83e3-8bd6cf69bb66
      iscommand: false
      name: Please Click The 'Lets Get Started!' Button
      type: collection
      version: -1
    taskid: d8bf5a25-5807-4e8d-83e3-8bd6cf69bb66
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2380
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "92"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3604dc71-b3d7-431b-86d4-d0ffc6a7ed8e
      iscommand: false
      name: Stop Acknowledgement SLA
      type: title
      version: -1
    taskid: 3604dc71-b3d7-431b-86d4-d0ffc6a7ed8e
    timertriggers:
    - action: stop
      fieldname: responsesla
    - action: stop
      fieldname: acknowledgementsla
    type: title
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 2555
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5840326f-9f79-4ccc-809c-1d2fae4cd384
      iscommand: false
      name: False Positive (Stop Detection Timer)
      type: title
      version: -1
    taskid: 5840326f-9f79-4ccc-809c-1d2fae4cd384
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 3225
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Is This a True Positive Alert ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No, Its a Confirmed - False Positive
      - No, Its a Benign-True Positive
      - Yes, it is True Positive
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      No, Its a Benign-True Positive:
      - "58"
      No, Its a Confirmed - False Positive:
      - "55"
      Yes, it is True Positive:
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a9599866-a732-4e0d-8cd3-4d9edfad3058
      iscommand: false
      name: Is This a True Positive Alert ?
      type: condition
      version: -1
    taskid: a9599866-a732-4e0d-8cd3-4d9edfad3058
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 3040
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "101"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4f5c4c91-cd81-439f-82b5-3962773a936a
      iscommand: false
      name: True Positive (Stop Detection SLA & Start Threat Response SLA)
      type: title
      version: -1
    taskid: 4f5c4c91-cd81-439f-82b5-3962773a936a
    timertriggers:
    - action: stop
      fieldname: detectionsla
    - action: start
      fieldname: threatresponsesla
    type: title
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 3225
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "98"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 774b4d8d-1fbf-4a0f-8806-597813f0a2b3
      iscommand: false
      name: Benign True Positive (Stop Detection Timer)
      type: title
      version: -1
    taskid: 774b4d8d-1fbf-4a0f-8806-597813f0a2b3
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 3225
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3187a32a-1241-43e8-8b54-28da9f4dd652
      iscommand: false
      name: Document & Close Investigation
      type: title
      version: -1
    taskid: 3187a32a-1241-43e8-8b54-28da9f4dd652
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2170,
          "y": 3650
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 2
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 179b63f6-524c-402c-8aba-a1921951ac25
      iscommand: false
      name: 'Sub Playbook: Document & Close'
      playbookId: 4a46e3dc-82da-4b3a-86ca-eb2f9dfd589f
      type: playbook
      version: -1
    taskid: 179b63f6-524c-402c-8aba-a1921951ac25
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2190,
          "y": 3820
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ca90e8c5-b48d-42b1-8939-d4e6db0c21ce
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: ca90e8c5-b48d-42b1-8939-d4e6db0c21ce
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2247.5,
          "y": 4035
        }
      }
  "64":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: anyimpact
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Was there any Impact ? (service disruption, malware installed,
            successful C&C communication..etc) '
        options: []
        optionsarg:
        - {}
        - simple: "No"
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Was there any Impact ? (service disruption, malware installed, successful
        C&C communication..etc)
      totalanswers: 0
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "65"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3d2ea7f7-bb63-4299-80ed-9fb0cda97bbd
      iscommand: false
      name: 'Was there any Impact ? ( malware installed, successful C&C communication..etc) '
      type: collection
      version: -1
    taskid: 3d2ea7f7-bb63-4299-80ed-9fb0cda97bbd
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 3570
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Was there any Impact ? .Answers
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "66"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b5d5cc25-1eca-41e7-8fff-393397b4735d
      iscommand: false
      name: Does The CSOC Manager Need To Be Notified ? (auto select if impact is
        'Yes')
      tags:
      - report
      type: condition
      version: -1
    taskid: b5d5cc25-1eca-41e7-8fff-393397b4735d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 3735
        }
      }
  "66":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: emailbody
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter Notification Message To CSOC Manager (give a brief about the
            true positive alert and the impact)
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: Your SOC team
      title: Enter Notification Message To CSOC Manager
      totalanswers: 0
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "67"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0caae2f4-af40-4b81-842e-9c2f7677ca24
      iscommand: false
      name: Enter Notification Message To CSOC Manager (give a brief about the true
        positive alert and the impact)
      type: collection
      version: -1
    taskid: 0caae2f4-af40-4b81-842e-9c2f7677ca24
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1135,
          "y": 3940
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 2
    scriptarguments:
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          ${incident.emailbody}

          Investigation Link --> https://soar.tcsapps.com/#/Custom/caseinfoid/${incident.id}
      cc:
        simple: ${UserByUsername.email}
      subject:
        simple: '*True Positive Notification* EDR Investigation - Severity - ${incident.mailerseverity}'
      to:
        simple: 'nimisha.prajapati@tcs.com,yogesh.gholap@tcs.com,csocsenioroperator@tcscomprod.onmicrosoft.com,csocanalyst@tcscomprod.onmicrosoft.com '
      using:
        simple: Mail Sender_instance_CSOC_Mail
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: f9b483a0-eeb6-4c5e-89e9-9a3eb7697c83
      iscommand: true
      name: Notify CSOC Manager & Necessary Stakeholders
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: f9b483a0-eeb6-4c5e-89e9-9a3eb7697c83
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1135,
          "y": 4125
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Review The Alert - Check If You Need To Raise an IMT ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No -  IMT Not Required
      - Yes - I Have Raised an IMT
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      No -  IMT Not Required:
      - "84"
      Yes - I Have Raised an IMT:
      - "85"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4091106d-685a-4481-868c-9c81c6bc9506
      iscommand: false
      name: Review The Alert - Check If You Need To Raise an IMT ?
      type: condition
      version: -1
    taskid: 4091106d-685a-4481-868c-9c81c6bc9506
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1135,
          "y": 4310
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: bb8b1812-75ed-4ef7-8b70-8bb63b8e2dc3
      iscommand: true
      name: Update IMT Context To - No
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: bb8b1812-75ed-4ef7-8b70-8bb63b8e2dc3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": 4500
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: d3c029c8-d193-467c-8ef2-3a8eb97e4f31
      iscommand: true
      name: Update IMT Context To - Yes
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: d3c029c8-d193-467c-8ef2-3a8eb97e4f31
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 4490
        }
      }
  "86":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtnumber
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Number
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: ""
      title: Enter The IMT Number
      totalanswers: 0
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5afeb6e0-bd75-4275-8582-80fc8e84cc28
      iscommand: false
      name: Enter The IMT Number
      type: collection
      version: -1
    taskid: 5afeb6e0-bd75-4275-8582-80fc8e84cc28
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 4640
        }
      }
  "89":
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 037ace3b-17d6-441d-8dd1-c05f8df23838
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 037ace3b-17d6-441d-8dd1-c05f8df23838
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 520,
          "y": 7030
        }
      }
  "90":
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "89"
    note: false
    quietmode: 2
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: c136698c-d5eb-49a4-8fb4-d251550c00bb
      iscommand: false
      name: 'Sub Playbook: Document & Close'
      playbookId: 4a46e3dc-82da-4b3a-86ca-eb2f9dfd589f
      type: playbook
      version: -1
    taskid: c136698c-d5eb-49a4-8fb4-d251550c00bb
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 520,
          "y": 6600
        }
      }
  "91":
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "118"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6e37ac73-7a63-4eed-85a2-06af42cc18fb
      iscommand: false
      name: Share response to CSP team
      type: title
      version: -1
    taskid: 6e37ac73-7a63-4eed-85a2-06af42cc18fb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 400,
          "y": 4820
        }
      }
  "92":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: whichslabreached
                root: incident
          operator: isEqualString
          right:
            value:
              simple: acknowledgementsla
        - left:
            iscontext: true
            value:
              complex:
                accessor: whichslabreached
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: acknowledgementsla
      label: "yes"
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "93"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c7c5d246-178d-4833-84b1-f50fcc2ea056
      iscommand: false
      name: Is response sla breached?
      type: condition
      version: -1
    taskid: c7c5d246-178d-4833-84b1-f50fcc2ea056
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 2700
        }
      }
  "93":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: justificationforacknowledgementslabreached
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Provide justification for response sla violated
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: Your SOC team
      title: Provide justification for response sla violated
      totalanswers: 0
    id: "93"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Provide justification for response sla violated
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 249cceb0-f34d-4227-8c7f-dae56eadc83f
      iscommand: false
      name: Provide justification for response sla violated
      type: collection
      version: -1
    taskid: 249cceb0-f34d-4227-8c7f-dae56eadc83f
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 2880
        }
      }
  "97":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: owner
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9a448b43-102d-4557-8d82-1f883eb7e775
      iscommand: false
      name: Has Owner Been Assigned
      type: condition
      version: -1
    taskid: 9a448b43-102d-4557-8d82-1f883eb7e775
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 180
        }
      }
  "98":
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: Benign-True positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 894bde5a-1103-404c-8583-5ff69bd7b464
      iscommand: true
      name: Set incident as 'Benign-True positive'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 894bde5a-1103-404c-8583-5ff69bd7b464
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 3410
        }
      }
  "99":
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: e6371f0f-c138-4e6f-8102-356ea38577ae
      iscommand: true
      name: Set incident as 'False Positive'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: e6371f0f-c138-4e6f-8102-356ea38577ae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 3410
        }
      }
  "101":
    continueonerrortype: ""
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: True Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: e43c9919-0f6a-4f1d-88f0-810b32a951db
      iscommand: true
      name: set incident as 'True Positive'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: e43c9919-0f6a-4f1d-88f0-810b32a951db
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 3400
        }
      }
  "102":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationanalysis
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationconclusion
                root: incident
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "104"
      "yes":
      - "105"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3af3ee2a-b9c3-4fd8-8524-7c98fdef9bde
      iscommand: false
      name: Check Report summary is not empty
      type: condition
      version: -1
    taskid: 3af3ee2a-b9c3-4fd8-8524-7c98fdef9bde
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 5420
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          root: Report
      bcc:
        simple: porkodi.g@tcs.com,komal.lugade@tcs.com,keerthana.ramesh@tcs.com
      body:
        simple: |-
          Hi Team,

                Please find the above sheet for  analysis of ${incident.name}

          Thanks & Regards,
          Cyberautobot.
      cc:
        simple: madhhura.r@tcs.com,sri.sudhakar@tcs.com,ajithkumar.s5@tcs.com,akshitha.suram@tcs.com,praveenhariharan.ar@tcs.com,syamkiran.c@tcs.com,saisudheer.bandi@tcs.com,lavanya.mundru@tcs.com,internalis.cybersecurityops@tcs.com
      subject:
        simple: ${incident.name} -${incident.occurred}
      to:
        simple: ${incident.emailfrom},TCS.ISOCteam@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: da815182-9049-406b-8bb8-81336bd69185
      iscommand: true
      name: share report to CSP team
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: da815182-9049-406b-8bb8-81336bd69185
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 130,
          "y": 6420
        }
      }
  "104":
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "115"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h1 style="text-align: center;"><span style="color: #ffffff; background-color:
          #ff0000;"><strong>Oops!!You''ve Missed Filling a Mandatory Field. Double
          Check The ''Report Summary'' Tab</strong></span></h1>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 3cd28e42-93d9-4b86-81dd-10758535cc25
      iscommand: true
      name: Notify Mandatory Field Not Filled
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 3cd28e42-93d9-4b86-81dd-10758535cc25
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 780,
          "y": 5700
        }
      }
  "105":
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: CSP
      stringify:
        simple: "true"
      value:
        simple: ${incident.investigationanalysis}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 0ff1c050-6881-4495-8cb3-a50bcf5a6c44
      iscommand: false
      name: Set context (Investigation Analysis)
      script: Set
      type: regular
      version: -1
    taskid: 0ff1c050-6881-4495-8cb3-a50bcf5a6c44
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 130,
          "y": 5690
        }
      }
  "106":
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "107"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: CSP
      stringify:
        simple: "true"
      value:
        simple: ${incident.investigationconclusion}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 17d13c15-7630-42b4-8ef1-51594d619ba2
      iscommand: false
      name: Set context (investigation conclusion)
      script: Set
      type: regular
      version: -1
    taskid: 17d13c15-7630-42b4-8ef1-51594d619ba2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 130,
          "y": 5865
        }
      }
  "107":
    continueonerrortype: ""
    id: "107"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "113"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${CSP}
      fileName:
        simple: Analysis Report.csv
      headers:
        simple: Investigation Analysis, Conclusion
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 947405f5-ab5a-4df5-85fa-3271bfc52d1f
      iscommand: false
      name: Generate Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 947405f5-ab5a-4df5-85fa-3271bfc52d1f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 130,
          "y": 6040
        }
      }
  "108":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "108"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "111"
      "yes":
      - "109"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: de70b39e-a6ff-47cd-859b-511cafed21ce
      iscommand: false
      name: Is there any  file ?
      type: condition
      version: -1
    taskid: de70b39e-a6ff-47cd-859b-511cafed21ce
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 755,
          "y": -785
        }
      }
  "109":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Name
                root: File.[0]
                transformers:
                - operator: toLowerCase
          operator: AnyMatch
          right:
            value:
              simple: analysis sheet
        - left:
            iscontext: true
            value:
              complex:
                accessor: Name
                root: File.[1]
          operator: AnyMatch
          right:
            value:
              simple: analysis sheet
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Name
                root: File.[2]
                transformers:
                - operator: toLowerCase
          operator: AnyMatch
          right:
            value:
              simple: analysis sheet
      label: "yes"
    continueonerrortype: ""
    id: "109"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "97"
      "yes":
      - "110"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 549b2c65-3eb1-4119-8731-39dbc891ed80
      iscommand: false
      name: Check file with Name "Analysis Sheet" and Extension
      type: condition
      version: -1
    taskid: 549b2c65-3eb1-4119-8731-39dbc891ed80
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": -420
        }
      }
  "110":
    continueonerrortype: ""
    id: "110"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: true
    quietmode: 0
    scriptarguments:
      entryId:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: xlsx
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: The automation takes Excel file (entryID) as an input and parses
        its content to the war room and context.
      id: 1d70105f-c5bf-4f0a-8577-b1310c8d57da
      iscommand: false
      name: Parseexcel
      script: ParseExcel
      type: regular
      version: -1
    taskid: 1d70105f-c5bf-4f0a-8577-b1310c8d57da
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": -190
        }
      }
  "111":
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "120"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |
          Hi team,

          There is no attachment present in the email. ${incident.rawName}
          Please attach relevant artifacts and share the mail to autobot.


          Thanks and Regards,
          Cyberbot

          Thanks & Regards,
          Cyberautobot
      cc:
        simple: internalis.cybersecurityops@tcs.com,CyberAutoBotGrp@tcscomprod.onmicrosoft.com
      subject:
        simple: No attachment present -${incident.rawName}
      to:
        simple: ${incident.emailfrom}
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: a5600e05-6db3-4339-854f-f8363e40812a
      iscommand: true
      name: Inform team to CSP team there is no attachment present
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: a5600e05-6db3-4339-854f-f8363e40812a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1505,
          "y": -440
        }
      }
  "112":
    continueonerrortype: ""
    id: "112"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "89"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello Human,

          You are not in my authorized list of senders . Please contact Your XSOAR Support team.

          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: internalis.cybersecurityops@tcs.com,CyberAutoBotGrp@tcscomprod.onmicrosoft.com
      subject:
        simple: Not Authorized To Send Mail-CSP
      to:
        complex:
          accessor: emailfrom}
          root: ${incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 215e9483-2b8b-4c9a-83ce-fa88723289c4
      iscommand: true
      name: Send Email Notification - Not Authorized User
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 215e9483-2b8b-4c9a-83ce-fa88723289c4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -30,
          "y": -800
        }
      }
  "113":
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "103"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 17a581bb-a013-4ff1-846f-858e282dad4f
      iscommand: false
      name: Set IOC Report To Context
      script: Set
      type: regular
      version: -1
    taskid: 17a581bb-a013-4ff1-846f-858e282dad4f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 130,
          "y": 6220
        }
      }
  "114":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationanalysis
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationconclusion
                root: incident
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "114"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "116"
      "yes":
      - "105"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b73a5fe5-b37c-495a-84f2-fbfe12b3e823
      iscommand: false
      name: Check Report summary is not empty
      type: condition
      version: -1
    taskid: b73a5fe5-b37c-495a-84f2-fbfe12b3e823
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 790,
          "y": 6040
        }
      }
  "115":
    continueonerrortype: ""
    id: "115"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Oops!!You've Missed Filling a Mandatory Field. Double Check The 'Report
          Summary'
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes, I've finished Writing My Report summary
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Yes, I've finished Writing My Report summary:
      - "114"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a84632f3-7c92-4e82-8d58-0b9fb18538c4
      iscommand: false
      name: Oops!!You've Missed Filling a Mandatory Field. Double Check The 'Report
        Summary'
      type: condition
      version: -1
    taskid: a84632f3-7c92-4e82-8d58-0b9fb18538c4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 780,
          "y": 5875
        }
      }
  "116":
    continueonerrortype: ""
    id: "116"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "89"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hi Team,

               The report summary is blank Please check
      subject:
        simple: Blank report summary-${incident.name} -{incident.id}
      to:
        simple: internalis.cyberautobot@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 59fdf384-cfc6-4942-8066-15dd26f36e8a
      iscommand: true
      name: 'Notify to Auto-bot Group '
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 59fdf384-cfc6-4942-8066-15dd26f36e8a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 6230
        }
      }
  "117":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: inList
          right:
            value:
              simple: ${lists.CSP-Authorizedsenders}
      label: "yes"
    continueonerrortype: ""
    id: "117"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "112"
      "yes":
      - "108"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9514ed0e-a0e6-466f-853f-6d737d65b8a4
      iscommand: false
      name: Is user is part of CSP-authorized sender list?
      type: condition
      version: -1
    taskid: 9514ed0e-a0e6-466f-853f-6d737d65b8a4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 755,
          "y": -1060
        }
      }
  "118":
    continueonerrortype: ""
    id: "118"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Please make sure to add investigation analysis in paragaraph, Dont
          give line in between also don't attach artifacts in analysis column.
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes, I've finished My analysis
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Yes, I've finished My analysis:
      - "119"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d6c4451a-251b-447f-8189-635a7371b8a6
      iscommand: false
      name: Have you Concluded The Investigation Analysis and  Conclusion?
      type: condition
      version: -1
    taskid: d6c4451a-251b-447f-8189-635a7371b8a6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 5000
        }
      }
  "119":
    continueonerrortype: ""
    id: "119"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Please male sure to update Investigation analysis and conclusion without
          fail
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes,Please share
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Yes,Please share:
      - "102"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f6ebe613-fa33-4c79-85da-664a2bdfcec2
      iscommand: false
      name: Are You Ready To share report to CSP team?
      type: condition
      version: -1
    taskid: f6ebe613-fa33-4c79-85da-664a2bdfcec2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": 5230
        }
      }
  "120":
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 5483a0b7-30ee-4acf-8c4d-4fffd38d4ca1
      iscommand: true
      name: Closeinvestigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 5483a0b7-30ee-4acf-8c4d-4fffd38d4ca1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1505,
          "y": 2500
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 8315,
        "width": 2657.5,
        "x": -30,
        "y": -1220
      }
    }
  }
