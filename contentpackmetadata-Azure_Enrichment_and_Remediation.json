{
	"author": "Cortex XSOAR",
	"authorImage": "content/packs/Base/Author_image.png",
	"beta": false,
	"cacheVersn": 0,
	"categories": [
		"Data Enrichment \u0026 Threat Intelligence"
	],
	"certification": "certified",
	"contentItemTypes": [
		"automation",
		"playbook"
	],
	"contentItems": {
		"automation": [
			{
				"description": "This script takes in a list of numbers that represent Azure priorities for NSG rules, a target priority number, and a number available priorities to return available priorities from the provided list.",
				"name": "AzureFindAvailableNSGPriorities",
				"tags": []
			}
		],
		"classifier": null,
		"dashboard": null,
		"genericfield": null,
		"generictype": null,
		"incidentfield": null,
		"incidenttype": null,
		"indicatorfield": null,
		"integration": null,
		"layoutscontainer": null,
		"list": null,
		"playbook": [
			{
				"description": "Given an IP address, this playbook enriches Azure Compute, Microsoft Graph User, and IAM information and outputs Azure Compute, Microsoft Graph User, and IAM information.",
				"name": "Azure - Enrichment"
			},
			{
				"description": "## **Azure Credentials Rotation Playbook**\n\n### **IAM Remediation**\nProtect your identity and access management:\n- **Reset Password**: Resets the user password to halt any unauthorized access.\n\n- **Revoke Session**: Terminates current active sessions to ensure the malicious actor is locked out.\n\n- **Combo Action**: Resets the password and terminates all active sessions.\n\n### **Service Principal Remediation**\nGuard your applications:\n- **Password Regeneration**: Generate a new password for the service principal, making sure the old one becomes obsolete.",
				"name": "Cloud Credentials Rotation - Azure"
			},
			{
				"description": "This playbook provides response actions to Azure. The following are available for execution automatically/manually:\n- Resource remediation    \n   - Delete the instance\n   - Power off the instance\n- Identity remediation:\n   - Disable the user\n   - Delete the user\n- Block indicators.",
				"name": "Cloud Response - Azure"
			},
			{
				"description": "This playbook performs an investigation on a specific user in Azure environments, using queries and logs from Azure Log Analytics to locate the following activities performed by the user:\n- Script-based user agent usage\n- Administrative user activities\n- Security rules and policies changes\n- Failed login attempt\n- MFA failed login attempt\n- Login attempt from an uncommon country\n- Anomalies activities\n- Risky users\n- Uncommon high volume of actions\n- Action uncommonly performed by the user",
				"name": "Azure - User Investigation"
			},
			{
				"description": "This playbook adds new Azure Network Security Groups (NSG) rules to NSGs attached to a NIC. The new rules will give access only to a private IP address range and block traffic that's exposed to the public internet ([using the private IP of the VM as stated in Azure documentation](https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview)). For example, if RDP is exposed to the public internet, this playbook adds new firewall rules that only allow traffic from private IP addresses and blocks the rest of the RDP traffic.\n\nConditions and limitations:\n- Limited to one resource group.\n- 200 Azure rules viewed at once to find offending rule.\n- 2 priorities lower than the offending rule priority must be available.\n- Adds rules to NSGs associated to NICs.",
				"name": "Azure - Network Security Group Remediation"
			}
		],
		"report": null,
		"reputation": null,
		"widget": null,
		"wizard": null
	},
	"currentVersion": "1.1.19",
	"definitionId": "",
	"dependencies": {
		"AzureCompute": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": true,
			"minVersion": "1.2.28",
			"name": "Azure Compute"
		},
		"AzureLogAnalytics": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "1.1.36",
			"name": "Azure Log Analytics"
		},
		"AzureNetworkSecurityGroups": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "1.2.33",
			"name": "Azure Network Security Groups"
		},
		"AzureResourceGraph": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "1.0.2",
			"name": "Azure Resource Graph"
		},
		"Base": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": true,
			"minVersion": "1.34.33",
			"name": "Base"
		},
		"CommonPlaybooks": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "2.6.37",
			"name": "Common Playbooks"
		},
		"CommonScripts": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": true,
			"minVersion": "1.15.44",
			"name": "Common Scripts"
		},
		"FiltersAndTransformers": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": true,
			"minVersion": "1.2.76",
			"name": "Filters And Transformers"
		},
		"MicrosoftGraphApplications": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "1.2.45",
			"name": "Microsoft Graph Applications"
		},
		"MicrosoftGraphIdentityandAccess": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "1.2.53",
			"name": "Microsoft Graph Identity and Access"
		},
		"MicrosoftGraphUser": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": true,
			"minVersion": "1.5.38",
			"name": "Microsoft Graph User"
		}
	},
	"deprecated": false,
	"description": "Playbooks using multiple Azure content packs for enrichment and remediation purposes",
	"disabledMonthly": false,
	"downloads": 696,
	"eulaLink": "https://github.com/demisto/content/blob/master/LICENSE",
	"fromServerVersion": "6.5.0",
	"general": [
		"generalFieldCertified",
		"generalFieldByCortexXSOAR",
		"generalFieldFree",
		"generalFieldSupportIncluded"
	],
	"id": "Azure-Enrichment-Remediation",
	"installMessage": "",
	"integrations": [
		{
			"imagePath": "content/packs/MicrosoftGraphUser/MicrosoftGraphUser_image.png",
			"name": "Azure Active Directory Users"
		},
		{
			"imagePath": "content/packs/MicrosoftGraphIdentityandAccess/MicrosoftGraphIdentityandAccess_image.png",
			"name": "Azure Active Directory Identity And Access"
		},
		{
			"imagePath": "content/packs/AzureNetworkSecurityGroups/AzureNetworkSecurityGroups_image.png",
			"name": "Azure Network Security Groups"
		},
		{
			"imagePath": "content/packs/MicrosoftGraphApplications/MicrosoftGraphApplications_image.png",
			"name": "Azure Active Directory Applications"
		},
		{
			"imagePath": "content/packs/AzureLogAnalytics/AzureLogAnalytics_image.png",
			"name": "Azure Log Analytics"
		},
		{
			"imagePath": "content/packs/AzureCompute/AzureComputev2_image.png",
			"name": "Azure Compute v2"
		},
		{
			"imagePath": "content/packs/AzureResourceGraph/AzureResourceGraph_image.png",
			"name": "Azure Resource Graph"
		}
	],
	"itemVersion": "1.1.19",
	"keywords": [],
	"legacy": true,
	"name": "Azure Enrichment and Remediation",
	"packID": "Azure-Enrichment-Remediation",
	"packName": "",
	"premium": false,
	"previewOnly": false,
	"price": 0,
	"propagationLabels": [
		"all"
	],
	"rawKeywords": null,
	"rawTags": null,
	"rawUseCases": null,
	"readme": "##### What does this pack do?\n\nThe pack contains Azure playbooks and scripts that conduct enrichment and/or remediation and can use multiple other Azure \ncontent packs.\n\nThere are multiple Azure content packs for multiple Azure products (Compute, MSGraphUsers, etc).  The intent was so that \nusers can install and use only the packs they need.  However, if an Azure playbook uses multiple pack integrations (such \nas Compute and MSGraphUsers), they can't reside in one of the current packs because they include content from multiple integrations.  This pack was created as a place to put Azure playbooks that use Azure integrations from multiple packs with a focus on enrichment and remediation.\n\n### Scripts\n\n#### AzureFindAvailableNSGPriorities\n\nThis script takes in a list of numbers that represent Azure priorities for NSG rules, a target priority number, and a number of available priorities to return available priorities from the provided list.\n\n### Playbooks\n\nUsers are only able to run playbooks in v6.5.0 or higher as it requires commands to execute the task.\nThis content pack includes the following playbook:\n\n#### Azure - Enrichment\n\n![Azure - Enrichment](https://storage.googleapis.com/marketplace-dist/content/packs/Azure-Enrichment-Remediation/readme_images/Azure_-_Enrichment.png)\n\n#### Azure - Network Security Group Remediation\n\n![Azure - Network Security Group Remediation](https://storage.googleapis.com/marketplace-dist/content/packs/Azure-Enrichment-Remediation/readme_images/Azure_-_Network_Security_Group_Remediation.png)\n\n#### Azure - User Investigation\n\n![Azure - User Investigation](https://storage.googleapis.com/marketplace-dist/content/packs/Azure-Enrichment-Remediation/readme_images/Azure_-_User_Investigation.png)\n\n#### Cloud Credentials Rotation - Azure\n\n![Cloud Credentials Rotation - Azure](https://storage.googleapis.com/marketplace-dist/content/packs/Azure-Enrichment-Remediation/readme_images/Cloud_Credentials_Rotation_-_Azure.png)\n\n\n#### Cloud Response - Azure\n\n![Cloud Response - Azure](https://storage.googleapis.com/marketplace-dist/content/packs/Azure-Enrichment-Remediation/readme_images/Cloud_Response_-_Azure.png)\n",
	"searchRank": 10,
	"serverMaxVersion": "",
	"serverMinVersion": "6.5.0",
	"support": "xsoar",
	"supportDetails": {
		"email": "",
		"url": "https://www.paloaltonetworks.com/cortex"
	},
	"tags": [],
	"toServerVersion": "",
	"updated": "2024-09-23T19:27:34Z",
	"useCases": [],
	"version": -1,
	"versionInfo": "1244506",
	"videos": []
}