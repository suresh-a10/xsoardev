contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: a9ccaf94-6e1b-48f1-8caf-1e79462ef409
inputs: []
name: TCS-SIEM Master Investigation Playbook v1.0_KK
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2d687fbd-c044-4330-8988-7afb01a4a0be
      iscommand: false
      name: ""
      version: -1
    taskid: 2d687fbd-c044-4330-8988-7afb01a4a0be
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 460,
          "y": -520
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: rawCloseReason
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: duplicate
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "2"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a34c188d-4f64-48b8-8c26-c79ae5c8353f
      iscommand: false
      name: Is This a Re-Opened Duplicate Alert
      type: condition
      version: -1
    taskid: a34c188d-4f64-48b8-8c26-c79ae5c8353f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": -380
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 1
    scriptarguments:
      closeNotes:
        simple: Duplicate - Auto Close
      closingnote:
        simple: Duplicate - Auto Close
      duplicateticketnumber:
        simple: NA. This is Duplicate - Auto Close incident
      forensicsdone:
        simple: Not Applicable
      incidentclosingreason:
        simple: Duplicate
      investigationanalysis:
        simple: Not Applicable
      investigationconclusion:
        simple: Duplicate
      remediationrequired:
        simple: Not Applicable
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 93e419f8-6544-4485-8d29-77784ea894cb
      iscommand: true
      name: Set Incident Closing Reason Context - Duplicate
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 93e419f8-6544-4485-8d29-77784ea894cb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -580,
          "y": 690
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: alertid
                root: incident
          operator: inList
          right:
            iscontext: true
            value:
              simple: lists.SIEM_C&C_Rule
      label: Command & Control
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: alertid
                root: incident
          operator: inList
          right:
            iscontext: true
            value:
              simple: lists.SIEM_WebApplicationAttacks_Rule
      label: Web Application Attacks
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: alertid
                root: incident
          operator: inList
          right:
            iscontext: true
            value:
              simple: lists.SIEM_Reconnaisance_Rule
      label: Reconnaissance
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: alertid
                root: incident
          operator: inList
          right:
            iscontext: true
            value:
              simple: lists.SIEM_Dos/Ddos Attack_Rule
      label: DoS
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: alertid
                root: incident
          operator: inList
          right:
            value:
              simple: lists.SIEM_CSS_Rule
      label: Cross site scripting
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      Command & Control:
      - "10"
      Cross site scripting:
      - "16"
      DoS:
      - "15"
      Reconnaissance:
      - "14"
      Web Application Attacks:
      - "12"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e7ee8d29-aa08-486d-87d2-45139732c8f9
      iscommand: false
      name: What Is The SIEM Attack Vector ?
      type: condition
      version: -1
    taskid: e7ee8d29-aa08-486d-87d2-45139732c8f9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": 450
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8269ef54-4c47-457b-8f6e-79bf67746a3e
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 8269ef54-4c47-457b-8f6e-79bf67746a3e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 970
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6a8e505e-b7cc-48a6-88b2-5f465b27b9b8
      iscommand: false
      name: 'Sub Playbook : Does Offence Belongs to citi Project'
      playbookId: 5f927e50-cf6b-4d54-837b-d3ade76bc624
      type: playbook
      version: -1
    taskid: 6a8e505e-b7cc-48a6-88b2-5f465b27b9b8
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 460,
          "y": 100
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e57196d0-b320-44e6-807e-e68178b273f9
      iscommand: false
      name: 'Sub Playbook: SIEM Case And Severity Assignment'
      playbookId: 295ecc0c-df2f-4462-8ee5-1986387919f2
      type: playbook
      version: -1
    taskid: e57196d0-b320-44e6-807e-e68178b273f9
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 460,
          "y": 270
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d2dc8a29-a28b-4d00-8fe0-78243e488f74
      iscommand: false
      name: 'Sub Playbook: C&C Attack Vector Investigation Playbook'
      playbookId: f0626514-aaf7-4ffa-827b-2bf61e13885a
      type: playbook
      version: -1
    taskid: d2dc8a29-a28b-4d00-8fe0-78243e488f74
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 710,
          "y": 690
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a1ee1987-604c-4155-88b6-f992cac5ace7
      iscommand: false
      name: 'Sub Playbook: Generic Attack Vector Investigation Playbook'
      playbookId: d82c63d5-b2a6-4453-86de-9d8b0f479441
      type: playbook
      version: -1
    taskid: a1ee1987-604c-4155-88b6-f992cac5ace7
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 250,
          "y": 690
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cbc2893f-83ed-4fa6-8aa0-e51855e0edf5
      iscommand: false
      name: 'Sub Playbook: Web Exploits Attack Vector Investigation Playbook'
      playbookId: 6746e62f-12b0-42bf-8292-bb8efdac16bc
      type: playbook
      version: -1
    taskid: cbc2893f-83ed-4fa6-8aa0-e51855e0edf5
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1240,
          "y": 690
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 56295f20-05c3-45af-8db3-a6a712677399
      iscommand: false
      name: Start Detection and Closure SLA Timers
      type: title
      version: -1
    taskid: 56295f20-05c3-45af-8db3-a6a712677399
    timertriggers:
    - action: start
      fieldname: closuresla
    - action: start
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": -170
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4e908042-91b6-4b8e-8b1e-8fb71a3f3041
      iscommand: false
      name: 'Sub Playbook: Recon Attack Vector Investigation Playbook'
      playbookId: 890aeb75-42cc-45ce-8892-c3d34332269f
      type: playbook
      version: -1
    taskid: 4e908042-91b6-4b8e-8b1e-8fb71a3f3041
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1680,
          "y": 690
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4f106981-39eb-4685-8c3e-58f1e26c2256
      iscommand: false
      name: TCS-Investigation Playbook-Attack Vector-DOS/DDOS
      playbookId: b52f98e9-dfcf-4251-8023-c6188b5c2ee8
      type: playbook
      version: -1
    taskid: 4f106981-39eb-4685-8c3e-58f1e26c2256
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -170,
          "y": 690
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cd1879f4-ae6a-45f6-837c-0ad16443fcf7
      iscommand: false
      name: TCS-Investigation Playbook-Attack Vector-Cross site scripting
      playbookId: 6279f151-9f6e-46e4-8baf-2d3e1babac94
      type: playbook
      version: -1
    taskid: cd1879f4-ae6a-45f6-837c-0ad16443fcf7
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2110,
          "y": 690
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      tenant:
        complex:
          accessor: name
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: '- '
            operator: split
          - operator: LastArrayElement
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 6d9b69ff-7ec9-40cb-894c-b0258f8f59f8
      iscommand: true
      name: Set Tenant in Incident Field
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6d9b69ff-7ec9-40cb-894c-b0258f8f59f8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": -50
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "1_13_#default#": 0.51,
      "1_2_yes": 0.1,
      "3_11_#default#": 0.89,
      "3_12_Web Application Attacks": 0.84,
      "3_14_Reconnaissance": 0.9,
      "3_16_Cross site scripting": 0.9
    },
    "paper": {
      "dimensions": {
        "height": 1555,
        "width": 3070,
        "x": -580,
        "y": -520
      }
    }
  }
