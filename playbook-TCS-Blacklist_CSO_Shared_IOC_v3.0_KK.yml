contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 71e9b7f6-fe01-4655-8cf3-8240c7153c57
inputs:
- description: ""
  key: IP
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: Domain
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: URL
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: Hash
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Blacklist CSO Shared IOC v3.0_KK
outputs: []
sourceplaybookid: 0a608f75-4154-430b-81e0-3a7bc08ad2e0
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "82"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1bb03a95-7ef8-4a15-8f70-8156bf83faee
      iscommand: false
      name: ""
      version: -1
    taskid: 1bb03a95-7ef8-4a15-8f70-8156bf83faee
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 910,
          "y": -280
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f1166032-7688-46ce-83b1-300ac75f0dad
      iscommand: false
      name: Report & Notify
      type: title
      version: -1
    taskid: f1166032-7688-46ce-83b1-300ac75f0dad
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1510
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6ae6f6ad-f7fe-4cde-8f6a-266d2645a1af
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 6ae6f6ad-f7fe-4cde-8f6a-266d2645a1af
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1770
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.IP
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: df02336c-f38f-4b47-8d14-f12ba4c75804
      iscommand: false
      name: Is There IP Address For Blocking?
      type: condition
      version: -1
    taskid: df02336c-f38f-4b47-8d14-f12ba4c75804
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 70,
          "y": 500
        }
      }
  "11":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Domain
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "66"
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2772be54-bc92-4290-87e4-9af701ece3ca
      iscommand: false
      name: Is There Domains For Blocking?
      type: condition
      version: -1
    taskid: 2772be54-bc92-4290-87e4-9af701ece3ca
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 910,
          "y": 500
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      reputation:
        simple: Bad
      source:
        simple: CSO
      tags:
        simple: CERTBlockDomain,emailblock
      type:
        simple: Domain
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 1a82bbc3-8995-40c0-8597-945b07448221
      iscommand: true
      name: Tag 'CERT' and 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - CERTDomainBlock
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 1a82bbc3-8995-40c0-8597-945b07448221
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1130
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.URL
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "41"
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 239c6971-482a-4414-8651-4a161ebfd6cc
      iscommand: false
      name: Is There URL For Blocking?
      type: condition
      version: -1
    taskid: 239c6971-482a-4414-8651-4a161ebfd6cc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1920,
          "y": 500
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    scriptarguments:
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: CERTBlockURL
      type:
        simple: URL
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 18af23ca-c067-4fb8-8a99-0b7403e58306
      iscommand: true
      name: Tag 'CERT' Bad URL Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 18af23ca-c067-4fb8-8a99-0b7403e58306
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 1105
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "85"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_134
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: e8fb39a4-a18d-4001-8b5d-32a35ab335aa
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: e8fb39a4-a18d-4001-8b5d-32a35ab335aa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 680
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_134
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              chars:
                value:
                  simple: hXXp://
            operator: StripChars
          - args:
              chars:
                value:
                  simple: hXXps://
            operator: StripChars
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 37c39edc-110e-446e-8454-2e4982645e9e
      iscommand: true
      name: Blacklist CSO Shared URL on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 37c39edc-110e-446e-8454-2e4982645e9e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2170,
          "y": 695
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "87"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 57a37d17-2d07-49a7-8a95-f39ff85ca174
      iscommand: false
      name: TCS-Tag New CERT Indicator v1.0_Kunal
      playbookId: ea428224-a443-408f-82ea-be094d71220d
      type: playbook
      version: -1
    taskid: 57a37d17-2d07-49a7-8a95-f39ff85ca174
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 70,
          "y": 790
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Hash
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 72c06b7d-7540-432a-82d9-8e4d100f7049
      iscommand: false
      name: Is There Hash For Blocking ?
      type: condition
      version: -1
    taskid: 72c06b7d-7540-432a-82d9-8e4d100f7049
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2700,
          "y": 500
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 5
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        complex:
          root: inputs.Hash
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4661e513-288d-40cf-8815-2bbf5d067544
      iscommand: false
      name: TCS-CERT Block Malicious Hash on CS v1.0_Kunal
      playbookId: cd88db09-7d3a-4efe-8dc8-d18dac3a9036
      type: playbook
      version: -1
    taskid: 4661e513-288d-40cf-8815-2bbf5d067544
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2700,
          "y": 790
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_CSO ip list
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        complex:
          root: inputs.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: 6dbb2786-50f7-4584-8851-ead84e05567e
      iscommand: true
      name: Update IP address Reference set "TCS_CSO ip list"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: 6dbb2786-50f7-4584-8851-ead84e05567e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 1190
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_CSO_Domains
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        complex:
          root: inputs.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: 5d9e4e06-b509-4ed2-8b51-23e2742bf17e
      iscommand: true
      name: Update Domain Reference set "TCS_CSO_Domains"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: 5d9e4e06-b509-4ed2-8b51-23e2742bf17e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1285
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_CSO_URLs
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        simple: ${ExtractedIndicators.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: 1c786a32-1610-4b54-8bb4-7caaf6c3d574
      iscommand: true
      name: Update Domain Reference set "TCS_CSO_URLs"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: 1c786a32-1610-4b54-8bb4-7caaf6c3d574
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 1300
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_CSO_Hashes
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        simple: ${inputs.Hash}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: b583d6c0-662e-4229-8c70-aa08c7693493
      iscommand: true
      name: Update Domain Reference set "TCS_CSO_Hashes"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: b583d6c0-662e-4229-8c70-aa08c7693493
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2700,
          "y": 1190
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "73"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_238
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: d5abfa4e-1f15-4b69-8502-2d195094dd18
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: d5abfa4e-1f15-4b69-8502-2d195094dd18
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 680
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_134
      ip:
        simple: ${Address2.IP}
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 3e1f0cbc-9d0f-484d-8bf9-ecfd5eaa200c
      iscommand: true
      name: block IP on Zscaler Corporate tenant
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 3e1f0cbc-9d0f-484d-8bf9-ecfd5eaa200c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -630,
          "y": 840
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_238
      ip:
        simple: ${Address2.IP}
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 2aa4ed9c-a1bb-4666-8651-f8e2a1556805
      iscommand: true
      name: Block IP from Zscaler BPS tenant
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 2aa4ed9c-a1bb-4666-8651-f8e2a1556805
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -640,
          "y": 1260
        }
      }
  "72":
    continueonerror: true
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${Address2.IP}
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: f094170c-0852-4720-8881-1cd85dc8eb3d
      iscommand: true
      name: Block IP on GNDM tenant
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: f094170c-0852-4720-8881-1cd85dc8eb3d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -630,
          "y": 1050
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_66
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 5526ed41-8bf5-4144-80c3-89bfa6219dc6
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 5526ed41-8bf5-4144-80c3-89bfa6219dc6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 910
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_66
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              chars:
                value:
                  simple: hXXp://
            operator: StripChars
          - args:
              chars:
                value:
                  simple: hXXps://
            operator: StripChars
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 07434aca-ef22-42d7-81c2-f8bf829766d3
      iscommand: true
      name: Blacklist CSO Shared URL on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 07434aca-ef22-42d7-81c2-f8bf829766d3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2170,
          "y": 885
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      alert_time:
        complex:
          accessor: created
          root: incident
          transformers:
          - operator: 8726aa62-638b-41b0-8fd7-8d8892145289
          - args:
              delimiter:
                value:
                  simple: .
              fields:
                value:
                  simple: "1"
            operator: Cut
          - args:
              prefix: {}
              suffix:
                value:
                  simple: .0Z
            operator: concat
      destination_domain:
        complex:
          root: inputs.Domain
      destination_url:
        simple: http://abc.com
      device_id:
        simple: abcdefghij
      device_version:
        simple: "1.0"
      retry-count:
        simple: "3"
      using:
        simple: Cisco Umbrella Enforcement Block Domain_instance,Cisco Umbrella Enforcement
          Block Domain GNDM,Cisco Umbrella Enforcement Block Domain_TCSION
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Enforcement Block Domain
      description: Posts a malware event to the API for processing and optionally
        adding to a customer's domain lists.
      id: 77aeb707-4c95-4894-83de-9c755da39cc3
      iscommand: true
      name: Block Domain on Cisco Umbrella (opendns)
      script: Cisco Umbrella Enforcement Block Domain|||umbrella-domain-event-add
      type: regular
      version: -1
    taskid: 77aeb707-4c95-4894-83de-9c755da39cc3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 1080
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_238
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              chars:
                value:
                  simple: hXXp://
            operator: StripChars
          - args:
              chars:
                value:
                  simple: hXXps://
            operator: StripChars
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: dd396795-f122-4faf-8be0-fef6c7fe8607
      iscommand: true
      name: Blacklist CSO Shared URL on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: dd396795-f122-4faf-8be0-fef6c7fe8607
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 680
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: ISO
      dateFormat:
        simple: ISO
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: 5bb0d5f1-f09d-4b49-8716-2ab138a12dec
      iscommand: false
      name: Set Current Time In Context
      script: GetTime
      type: regular
      version: -1
    taskid: 5bb0d5f1-f09d-4b49-8716-2ab138a12dec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -610,
          "y": 500
        }
      }
  "82":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ISOTimeNow
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "84"
      "yes":
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ae4ab3d9-69ad-4b8a-8f7c-8a9753a102dc
      iscommand: false
      name: Is ISO Time Context Set?
      type: condition
      version: -1
    taskid: ae4ab3d9-69ad-4b8a-8f7c-8a9753a102dc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 910,
          "y": -120
        }
      }
  "83":
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "84"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ISOTimeNow
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 3b5f2022-2175-45d1-8082-5bbef27a4730
      iscommand: false
      name: Delete Old Time Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 3b5f2022-2175-45d1-8082-5bbef27a4730
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 80
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
      - "10"
      - "11"
      - "32"
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: ISO
      dateFormat:
        simple: ISO
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: 5f7ea318-e23a-4998-8819-61120717d49f
      iscommand: false
      name: Set Current Date In Context
      script: GetTime
      type: regular
      version: -1
    taskid: 5f7ea318-e23a-4998-8819-61120717d49f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 270
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_19
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_ion
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: d6b32ef0-3838-4958-8257-e5faa1efca9c
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - ION
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: d6b32ef0-3838-4958-8257-e5faa1efca9c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 900
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_19
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              chars:
                value:
                  simple: hXXp://
            operator: StripChars
          - args:
              chars:
                value:
                  simple: hXXps://
            operator: StripChars
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: ecd68d62-f3c3-4dcb-8e9d-16f35571d171
      iscommand: true
      name: Blacklist CSO Shared URL on ZScalar Proxy - ION
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: ecd68d62-f3c3-4dcb-8e9d-16f35571d171
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 885
        }
      }
  "87":
    continueonerrortype: ""
    id: "87"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_18
      ip:
        complex:
          root: inputs.IP
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_ion
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 12c319c9-4e0d-4291-80ca-8a003f4c1391
      iscommand: true
      name: block IP on Zscaler Corporate ION
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 12c319c9-4e0d-4291-80ca-8a003f4c1391
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 980
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "10_3_#default#": 0.17,
      "10_44_yes": 0.62,
      "11_38_yes": 0.38,
      "11_3_#default#": 0.12,
      "11_66_yes": 0.39,
      "32_3_#default#": 0.31,
      "32_41_yes": 0.34,
      "32_80_yes": 0.34,
      "45_3_#default#": 0.1,
      "45_59_yes": 0.47
    },
    "paper": {
      "dimensions": {
        "height": 2115,
        "width": 3720,
        "x": -640,
        "y": -280
      }
    }
  }
