contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 59c34b62-e11e-4b22-8844-c1d11e5d7a0a
inputs: []
name: TCS-OnDemand FireEye Sandbox v1.0_KK
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f01fd2eb-998e-4b35-843e-d66cff4581c0
      iscommand: false
      name: ""
      version: -1
    taskid: f01fd2eb-998e-4b35-843e-d66cff4581c0
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 50,
          "y": -650
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: inList
              right:
                value:
                  simple: zip,7z
          root: File
      nonsensitive_password:
        simple: ${incident.unzippassword}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Unzip a file using fileName or entryID to specify a file. Unzipped
        files will be loaded to the War Room and names will be put into the context.
      id: 5301feba-9e6a-4a24-806f-1b8f7613ba07
      iscommand: false
      name: Unzip File
      script: UnzipFile
      type: regular
      version: -1
    taskid: 5301feba-9e6a-4a24-806f-1b8f7613ba07
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -580,
          "y": 565
        }
      }
  "2":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: artifacts
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Upload File For Sandbox Analysis
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: attachments
      sender: Your SOC team
      title: Upload File For Sandboxing
      totalanswers: 0
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3888c4e1-e9d1-485e-83e6-81ee0b35ab5d
      iscommand: false
      name: Upload File For Sandboxing (the password protected file in standard format)
      type: collection
      version: -1
    taskid: 3888c4e1-e9d1-485e-83e6-81ee0b35ab5d
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 420,
          "y": -100
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Type
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                  - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Info
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                  - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Extension
                    operator: match
                    right:
                      value:
                        simple: .*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM|JPG|JPEG|GIF|PNG|XLSX)\b
                root: File
          operator: isExists
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: File.Extension
          operator: notEndWith
          right:
            value:
              simple: eml
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Asserts the file type is supported
      id: 44185465-22cc-493c-890a-bd93d544e322
      iscommand: false
      name: Is the file type supported in FireEye?
      type: condition
      version: -1
    taskid: 44185465-22cc-493c-890a-bd93d544e322
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 645
        }
      }
  "4":
    continueonerrortype: ""
    form:
      description: Enter the required inputs for Sandboxing on FireEye
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Select analysis mode - live or sandbox '
        options: []
        optionsarg:
        - {}
        - simple: 1—Live
        - simple: 2—Sandbox
        placeholder: ""
        readonly: false
        required: true
        tooltip: 'Specify live or sandbox analysis mode. 1—Live: analyze suspected
          URLs live within the Malware Analysis Multi-Vector Virtual Execution (MVX)
          analysis engine. 2—Sandbox: analyze suspected URLs in a closed, protected
          environment.'
        type: singleSelect
      - defaultrows: []
        fieldassociated: fireeyeapplication
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Select the application to be used for the analysis.
        options: []
        optionsarg:
        - simple: 0— Allows the Malware Analysis appliance to choose the application
            for you
        placeholder: ""
        readonly: false
        required: true
        tooltip: Specifies the application to be used for the analysis.
        type: singleSelect
      - defaultrows: []
        fieldassociated: fireeyeprofiles
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Select Malware Analysis Profile to use for analysis
        options: []
        optionsarg:
        - {}
        - simple: 30 — centos-7.2
        - simple: 43 — winxp-sp3m
        - simple: 66 — win7x64-sp1m
        - simple: 68 — win10x64m
        - simple: 65 — win7-sp1m
        - simple: 90 — osx-10.8.2
        - simple: 93 — osx-10.11.3
        placeholder: ""
        readonly: false
        required: true
        tooltip: Selects the Malware Analysis profile to use for analysis
        type: singleSelect
      sender: ""
      title: Enter details for Sandboxing
      totalanswers: 0
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eb274fa7-14b0-4806-8da5-64fbfa1cf842
      iscommand: false
      name: Enter details for File Sandboxing
      type: collection
      version: -1
    taskid: eb274fa7-14b0-4806-8da5-64fbfa1cf842
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 50,
          "y": 825
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: true
    quietmode: 0
    scriptarguments:
      value:
        simple: The File Type is not supported by Fire Eye
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Prints text to war room (Markdown supported)
      id: a729231d-413b-4588-8e0e-4dbf14089fb3
      iscommand: false
      name: Notify -File Type Not Supported
      script: Print
      type: regular
      version: -1
    taskid: a729231d-413b-4588-8e0e-4dbf14089fb3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -590,
          "y": 1755
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File.EntryID
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b03a96e9-a316-4b65-8f28-4d6596f05f73
      iscommand: false
      name: Is File Uploaded?
      type: condition
      version: -1
    taskid: b03a96e9-a316-4b65-8f28-4d6596f05f73
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": -480
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        complex:
          accessor: "0"
          root: Enter details for Sandboxing.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      application:
        complex:
          accessor: fireeyeapplication
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      force:
        simple: "false"
      prefetch:
        simple: "1"
      priority:
        simple: "0"
      profiles:
        simple: ${incident.fireeyeprofiles}
      timeout:
        simple: "10000"
      urls:
        simple: ${Enter the URL to Sandbox.Answers.0}
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: Submit a url for analysis by FireEye
      id: 24196b7e-c15a-497e-8297-89a4e4ad2104
      iscommand: true
      name: Automated Task - Uploading the URL on Fire Eye for analysis
      script: fireeye|||fe-submit-url
      type: regular
      version: -1
    taskid: 24196b7e-c15a-497e-8297-89a4e4ad2104
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1120,
          "y": 680
        }
      }
  "9":
    continueonerrortype: ""
    form:
      description: Enter Password to unzip File
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: unzippassword
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter Password to unzip File
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: Enter Password to unzip File
        type: shortText
      sender: ""
      title: Enter Password to unzip File
      totalanswers: 0
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0f298883-9af3-448d-8eb6-06657fc98bb6
      iscommand: false
      name: Enter the Password
      type: collection
      version: -1
    taskid: 0f298883-9af3-448d-8eb6-06657fc98bb6
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -580,
          "y": 420
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Enter details for Sandboxing.Answers
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: —
                    fields:
                      value:
                        simple: "1"
                  operator: Cut
          operator: isEqualString
          right:
            value:
              simple: "1"
      label: Live
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Enter details for Sandboxing.Answers
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: —
                    fields:
                      value:
                        simple: "1"
                  operator: Cut
          operator: isEqualString
          right:
            value:
              simple: "2"
      label: Sandbox
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Live:
      - "14"
      Sandbox:
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fa7df452-f44f-4975-8b4b-a4bf832cb3c7
      iscommand: false
      name: Check mode of Sandbox.
      type: condition
      version: -1
    taskid: fa7df452-f44f-4975-8b4b-a4bf832cb3c7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 360
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Select the type of analysis
      cc: null
      format: ""
      methods: []
      replyOptions:
      - File Analysis
      - URL Analysis
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      File Analysis:
      - "2"
      URL Analysis:
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bc2ae1a0-3b61-45a1-8464-a70200d6eca7
      iscommand: false
      name: Select the type of analysis
      type: condition
      version: -1
    taskid: bc2ae1a0-3b61-45a1-8464-a70200d6eca7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 620,
          "y": -290
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        complex:
          accessor: "0"
          root: Enter details for Sandboxing.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      application:
        complex:
          accessor: fireeyeapplication
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      force:
        simple: "false"
      prefetch:
        simple: "0"
      priority:
        simple: "0"
      profiles:
        simple: ${incident.fireeyeprofiles}
      timeout:
        simple: "10000"
      urls:
        simple: ${Enter the URL to Sandbox.Answers.0}
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: Submit a url for analysis by FireEye
      id: d4e8bf63-9f5f-4349-82f0-f184b55a7597
      iscommand: true
      name: Automated Task - Uploading the URL on Fire Eye for analysis
      script: fireeye|||fe-submit-url
      type: regular
      version: -1
    taskid: d4e8bf63-9f5f-4349-82f0-f184b55a7597
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 620,
          "y": 660
        }
      }
  "15":
    continueonerrortype: ""
    form:
      description: Enter the required inputs for Sandboxing on FireEye
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Select analysis mode - live or sandbox '
        options: []
        optionsarg:
        - {}
        - simple: 1—Live
        - simple: 2—Sandbox
        placeholder: ""
        readonly: false
        required: true
        tooltip: 'Specify live or sandbox analysis mode. 1—Live: analyze suspected
          URLs live within the Malware Analysis Multi-Vector Virtual Execution (MVX)
          analysis engine. 2—Sandbox: analyze suspected URLs in a closed, protected
          environment.'
        type: singleSelect
      - defaultrows: []
        fieldassociated: fireeyeapplication
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Select the application to be used for the analysis.
        options: []
        optionsarg:
        - simple: 0— Allows the Malware Analysis appliance to choose the application
            for you
        placeholder: ""
        readonly: false
        required: true
        tooltip: Specifies the application to be used for the analysis.
        type: singleSelect
      - defaultrows: []
        fieldassociated: fireeyeprofiles
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Select Malware Analysis Profile to use for analysis
        options: []
        optionsarg:
        - {}
        - simple: 30 — centos-7.2
        - simple: 43 — winxp-sp3m
        - simple: 66 — win7x64-sp1m
        - simple: 68 — win10x64m
        - simple: 65 — win7-sp1m
        - simple: 90 — osx-10.8.2
        - simple: 93 — osx-10.11.3
        placeholder: ""
        readonly: false
        required: true
        tooltip: Selects the Malware Analysis profile to use for analysis
        type: singleSelect
      sender: ""
      title: Enter details for Sandboxing
      totalanswers: 0
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dd986f1d-efb6-47a7-8ec2-9ec1c589c3d4
      iscommand: false
      name: Enter details for URL Sandboxing
      type: collection
      version: -1
    taskid: dd986f1d-efb6-47a7-8ec2-9ec1c589c3d4
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 900,
          "y": 150
        }
      }
  "16":
    continueonerrortype: ""
    form:
      description: Enter the URL to Sandbox
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter the URL to Sandbox. If there are more than one url, add them
            as a parameter using a comma to separate them. For example, "www.demisto.com,www.google.com"
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: Enter the URL to Sandbox
        type: shortText
      sender: ""
      title: Enter the URL to Sandbox
      totalanswers: 0
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3cd7a025-2260-4a32-8a7b-2d73e36824f7
      iscommand: false
      name: Enter the URL to Sandbox
      type: collection
      version: -1
    taskid: 3cd7a025-2260-4a32-8a7b-2d73e36824f7
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 900,
          "y": -40
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 82d4e298-373b-406b-883a-280a5fef4242
      iscommand: false
      name: Polling
      type: title
      version: -1
    taskid: 82d4e298-373b-406b-883a-280a5fef4242
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 880,
          "y": 920
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        complex:
          accessor: "0"
          root: Enter details for Sandboxing.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      application:
        complex:
          accessor: fireeyeapplication
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      force:
        simple: "false"
      prefetch:
        simple: ${prefetch}
      priority:
        simple: "0"
      profiles:
        simple: ${incident.fireeyeprofiles}
      timeout:
        simple: "10000"
      uploadFile:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: inList
              right:
                iscontext: true
                value:
                  simple: ExtractedFiles
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: commands.server.feSubmit.description
      id: 3ce927ab-723d-4951-8d81-b2661d6867bc
      iscommand: true
      name: Automated Task - Uploading the Extracted Files on Fire Eye for analysis
      script: fireeye|||fe-submit
      type: regular
      version: -1
    taskid: 3ce927ab-723d-4951-8d81-b2661d6867bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1580
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      Ids:
        complex:
          accessor: Key
          root: FireEyeAX.Submissions.URL
      Interval:
        simple: "7"
      PollingCommandArgName:
        simple: submission_Key
      PollingCommandName:
        simple: fe-submit-url-status
      Timeout:
        simple: "360"
      dt:
        simple: FireEyeAX.Submissions.URL(val.Status != 'Submission Done').Key
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      id: b223dfd7-6cdd-4722-8f11-8788c213c933
      iscommand: false
      name: GenericPolling
      playbookId: GenericPolling
      type: playbook
      version: -1
    taskid: b223dfd7-6cdd-4722-8f11-8788c213c933
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1080
        }
      }
  "20":
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Sand Box Result Files
      tags:
        simple: results
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: true
    quietmode: 0
    scriptarguments:
      submissionID:
        simple: ${subplaybook-19.FireEyeAX.Submissions.URL.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      id: 01426de2-db68-4bf3-8c08-dee13338c1f0
      iscommand: false
      name: AX-result
      script: ca07fab8-8b93-431f-8946-ad2b007a145e
      type: regular
      version: -1
    taskid: 01426de2-db68-4bf3-8c08-dee13338c1f0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1380
        }
      }
  "21":
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Sand Box Result Files
      tags:
        simple: results
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: true
    quietmode: 0
    scriptarguments:
      submissionKey:
        simple: ${FireEyeAX.Submissions.Key}
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      id: a2d7eb50-0a1d-4931-89f1-ad01db2d560c
      iscommand: false
      name: AX-result
      script: ca07fab8-8b93-431f-8946-ad2b007a145e
      type: regular
      version: -1
    taskid: a2d7eb50-0a1d-4931-89f1-ad01db2d560c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -50,
          "y": 1895
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      Ids:
        complex:
          accessor: Submissions.Key
          root: FireEyeAX
      Interval:
        simple: "7"
      PollingCommandArgName:
        simple: submission_Key
      PollingCommandName:
        simple: fe-submit-status
      Timeout:
        simple: "3600"
      dt:
        simple: FireEyeAX.Submissions(val.Status != 'Done').Key
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      id: 5634619b-3ad8-4852-84c8-3f470e15e7c0
      iscommand: false
      name: GenericPolling
      playbookId: GenericPolling
      type: playbook
      version: -1
    taskid: 5634619b-3ad8-4852-84c8-3f470e15e7c0
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -50,
          "y": 1755
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b0b5404f-3bb8-481d-8512-ad7cbf1142a7
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
    taskid: b0b5404f-3bb8-481d-8512-ad7cbf1142a7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2210
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 203dc9c6-8979-4241-8b51-7ef4b707a24b
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 203dc9c6-8979-4241-8b51-7ef4b707a24b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2330
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a861bef0-898b-43f3-8b30-98f9403c966d
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: a861bef0-898b-43f3-8b30-98f9403c966d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2480
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File.Extension
          operator: isEqualString
          right:
            value:
              simple: zip
        - left:
            iscontext: true
            value:
              simple: File.Extension
          operator: isEqualString
          right:
            value:
              simple: 7z
      label: "yes"
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4530717d-e6b0-47e8-8feb-1fd8407d9ced
      iscommand: false
      name: Check If File is a ZIP File
      type: condition
      version: -1
    taskid: 4530717d-e6b0-47e8-8feb-1fd8407d9ced
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 70
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: "Malicious: ${FireEyeAXReport.alerts.alert.-malicious} \nSeverity:
          ${FireEyeAXReport.alerts.alert.-severity}"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: bb053419-78ac-4e35-8a0a-b47c455c55d4
      iscommand: false
      name: Display Malicious and Severity Status
      script: Print
      type: regular
      version: -1
    taskid: bb053419-78ac-4e35-8a0a-b47c455c55d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -50,
          "y": 2030
        }
      }
  "28":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedFiles
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8b5d7e25-c193-4ab6-8463-5a30d633eb21
      iscommand: false
      name: Checking if there are any extracted files
      type: condition
      version: -1
    taskid: 8b5d7e25-c193-4ab6-8463-5a30d633eb21
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -60,
          "y": 1400
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      analysistype:
        complex:
          accessor: "0"
          root: Enter details for Sandboxing.Answers
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      application:
        complex:
          accessor: fireeyeapplication
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: —
              fields:
                value:
                  simple: "1"
            operator: Cut
      force:
        simple: "false"
      prefetch:
        simple: ${prefetch}
      priority:
        simple: "0"
      profiles:
        simple: ${incident.fireeyeprofiles}
      timeout:
        simple: "10000"
      uploadFile:
        complex:
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
      using:
        simple: fireeye_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: fireeye
      description: commands.server.feSubmit.description
      id: f79ccdb9-4a54-40b5-841b-9d2f55de8625
      iscommand: true
      name: Automated Task - Uploading the File on Fire Eye for analysis
      script: fireeye|||fe-submit
      type: regular
      version: -1
    taskid: f79ccdb9-4a54-40b5-841b-9d2f55de8625
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 160,
          "y": 1570
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: "Malicious: ${FireEyeAXReport.alerts.alert.-malicious} \nSeverity:
          ${FireEyeAXReport.alerts.alert.-severity}"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: 5658efd3-bb76-4aff-8c9a-2bfb4d3d19ec
      iscommand: false
      name: Display Malicious and Severity Status
      script: Print
      type: regular
      version: -1
    taskid: 5658efd3-bb76-4aff-8c9a-2bfb4d3d19ec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1580
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: How would you like to proceed?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Submit Zip File as it is
      - Unzip the file first and then submit
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Submit Zip File:
      - "3"
      Unzip the file:
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eda21115-75f3-4104-86eb-85111f994923
      iscommand: false
      name: How would you like to proceed?
      type: condition
      version: -1
    taskid: eda21115-75f3-4104-86eb-85111f994923
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -270,
          "y": 245
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Enter details for Sandboxing.Answers
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: —
                    fields:
                      value:
                        simple: "1"
                  operator: Cut
          operator: isEqualString
          right:
            value:
              simple: "1"
      label: Live
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Enter details for Sandboxing.Answers
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: —
                    fields:
                      value:
                        simple: "1"
                  operator: Cut
          operator: isEqualString
          right:
            value:
              simple: "2"
      label: Sandbox
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Live:
      - "33"
      Sandbox:
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8cf6cecb-6bd4-4fcd-8bbf-f4bd7cbaca97
      iscommand: false
      name: Check mode of Sandbox.
      type: condition
      version: -1
    taskid: 8cf6cecb-6bd4-4fcd-8bbf-f4bd7cbaca97
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 985
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: prefetch
      value:
        simple: "0"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c6fe7754-2698-4cd8-87d5-bee77735f89d
      iscommand: false
      name: Set Prefetch 0
      script: Set
      type: regular
      version: -1
    taskid: c6fe7754-2698-4cd8-87d5-bee77735f89d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 1175
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: prefetch
      value:
        simple: "1"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3d2b33c6-2ddc-4172-8914-58c510dce582
      iscommand: false
      name: Set Prefetch 1
      script: Set
      type: regular
      version: -1
    taskid: 3d2b33c6-2ddc-4172-8914-58c510dce582
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1165
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "10_14_Live": 0.56,
      "10_8_Sandbox": 0.44,
      "13_2_File Analysis": 0.57,
      "28_18_yes": 0.55,
      "31_3_Submit Zip File": 0.23,
      "3_4_yes": 0.57,
      "6_26_yes": 0.41
    },
    "paper": {
      "dimensions": {
        "height": 3195,
        "width": 2090,
        "x": -590,
        "y": -650
      }
    }
  }
