category: Utilities
commonfields:
  id: OpenAI
  version: -1
configuration:
- defaultvalue: https://api.openai.com/
  display: OpenAI API URL(e.g. https://api.openai.com/)
  name: url
  required: true
  type: 0
- display: API Key
  name: apikey
  required: true
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.5.0
    itemVersion: 2.0.0
    packID: OpenAI
    packName: OpenAI
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
deprecated: true
description: Deprecated. Use `OpenAI GPT` instead.
detaileddescription: "## OpenAI\n- Create an API key in OpenAI.com: \n  - Open user
  settings\n  - Open \"View API Keys\"\n  - Click Create new secret key\n- Use default
  value https://api.openai.com/ as Open AI API URL\n- Add OpenAI API key in API key\n\n---\n[View
  Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/open-ai)"
display: OpenAI (Deprecated)
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAQAAAA9rtdTAAAC7HpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHja7ZZRkuQmDIbfOUWOYEkIieNgMFV7gxw/vzDdme6ZrcpkXwfKgIUsCX1Ad7r+/jXTXyiU6UhZzUst5UDJNVduGPhxl7ZaOvJqV7HHHL3Kk/CeYIgEvdyvXrb+Q05PA3fXMNIPhrzvifN1ouZt398MbccSEcV4bEN1GxK+J2gbaPeyjlLdPi7hvO5+f3+nAU+KJvtr2J/eDdkbCj/CfAnJgVZkByDxcJKGCUZ7iEKRRJekolWp2xgS8lWengV6aUao+UulFyrP0RutslOQ3mll3iryluTy7L+UJ9K3CXn654+es+8Rv8qRqnxH9Jb9eOYcPteasYqWC1Jd9qIeS1wj6J1wEa49IbRyGB6FCVu1ojp2dcdWGEc/TtROlRi4Jo7DoEaTrtV36ggx85XYMGDuLEvoYly5S/DLUWmygeEQB9u+sGfhZyy03Najp+XN4XkQVJlgLLbDt2v67gdzxlEgilyWtnKFuJgj2QgjyEULNTCguZOqK8GP+l6CazDTyHIckYrEnreJU+nfm0AWaIGior/PINnYBpAiuFYEQwICoIZTQYUOYzYiJNIBqCF0lswnCJAqDwTJWaSAjXO4xidGS5WVIU6Q4zIDCZUiBjY4ZYCVs2L/WHbsoaaiWVWLmrpWbUVKLlpKsRKXYjOxnEytmJlbtebi2dWLm7tXb5Wr4NLUWqpVr7W2Bp8Nlhu+blBo7eRTznxqOstpp5/1bB3bp+euvXTr3mtvg4cM3B+jDBs+6mgXXdhKV770KpddftWrTWy1KWnmqbNMmz7rbE9qG+un+g1qtKnxIhWK9qQGqdnDBMV1osEMwDhlAnELBNjQHMwOp5w5yAWzozJOhTKC1GA2KIiBYL6IddKDXeKbaJD7I27J8gs3/r/kUqD7JrnP3L6iNuIO7ovYfQojqYfg9GH+8sbe4sfuU59+N/Hd/sfQj6EfQ//B0MRhjX9d/wD0sozpdVfjlAAAASRpQ0NQSUNDIHByb2ZpbGUAAHicnZC/SsNQFMZ/qX+R6qDiIA4ZXAsuzeRSFYKgEGMFq1OapFhMYkhSim/gm+jDdBAEH8EHUHD2u9HBwSxeOHw/Dud8370XWnYSpuX8HqRZVbh+b3A5uLKX3mizwBrrdIOwzHued0Lj+XzFMvrSMV7Nc3+exSguQ+lMlYV5UYG1L3amVW5YxeZt3z8UP4jtKM0i8ZN4N0ojw2bXT5NJ+ONpbtOOs4tz01ft4HLMKR42QyaMSajoSDN1jnDoSl0KAu4pCaUJsXpTzVTciEo5uRyI+iLdpiFvu87zlDKUx1heJuGOVJ4mD/O/32sfZ/WmtTXLgyKoW3Oq1mgE74+wOoCNZ1i5bsha/v22hhmnnvnnG78A9ntQbHCFARIAAA0aaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjExZWVlMTlmLWRhNjEtNDliNi05MjEwLTcxM2UwOTFiMWViNiIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4MGRiNGZhMS1lYWRmLTQ2MjQtOTM3MS1kNjY3MTI4ZjFkMDYiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpiMGJhYmZlYy1mNDk1LTRlMDQtODYzYS05ZjQ0OWM4NDg5YjQiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJMaW51eCIKICAgR0lNUDpUaW1lU3RhbXA9IjE2NzAyNTAwMDEyMzI1MTgiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMCIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpiYjY4ZjJmOC1lNGUwLTRiNGItYmM5Ni1jMWIxNTcwYTk0NDEiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoTGludXgpIgogICAgICBzdEV2dDp3aGVuPSIyMDIyLTEyLTA1VDE1OjIwOjAxKzAxOjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PljaFOkAAAACYktHRAD/h4/MvwAAAAlwSFlzAAALEwAACxMBAJqcGAAA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
name: OpenAI
script:
  commands:
  - arguments:
    - description: Instruction
      name: prompt
      required: true
    - auto: PREDEFINED
      defaultValue: text-davinci-003
      description: The model which will generate the completion. Some models are suitable
        for natural language tasks, others specialize in code
      name: model
      predefined:
      - text-davinci-003
      - text-curie-001
      - text-babbage-001
      - text-ada-001
      - code-davinci-002
      - code-cushman-001
      type: textArea
    - defaultValue: "0.7"
      description: 'Controls randomness: Lowering results in less random completions.'
      name: temperature
    - defaultValue: "256"
      description: The maximum number of tokens to generate.
      name: max_tokens
    - defaultValue: "1"
      description: 'Controls Diversity via nucleus sampling: 0.5 means half of all
        likihood-weighted options are considered.'
      name: top_p
    - defaultValue: "0"
      description: How much to penalize new tokens based on their existing frequency
        in the text so far. Decreases the model's likelihood to repeat the same line
        verbatim.
      name: frequency_penalty
    - defaultValue: "0"
      description: How much to penalize new tokens based on whether they appear in
        the text so far. Increases the model's likelihood to talk about new topics.
      name: presence_penalty
    description: Enter an instruction and watch the API respond with a completion
      that attempts to match the context or pattern you provided.
    name: openai-completions
    outputs:
    - contextPath: OpenAI.Completions.id
      description: Id of the returned completion.
      type: string
    - contextPath: OpenAI.Completions.model
      description: The model which will generate the completion.
      type: string
    - contextPath: OpenAI.Completions.text
      description: Completed text generated by OpenAI?
      type: string
  dockerimage: demisto/python3:3.10.12.63474
  runonce: false
  script: |
    register_module_line('OpenAI', 'start', __line__())
    ### pack version: 2.0.0


    import traceback

    import requests


    # Disable insecure warnings
    requests.packages.urllib3.disable_warnings()  # type: ignore[attr-defined]  # pylint: disable=no-member


    ''' CLIENT CLASS '''


    class Client(BaseClient):
        """Client class to interact with the OpenAI API
        """

        def __init__(self, base_url: str, api_key: str, proxy: bool, verify: bool):
            super().__init__(base_url=base_url, proxy=proxy, verify=verify)
            self.api_key = api_key
            self.headers = {'Authorization': f'Bearer {self.api_key}',
                            'Content-Type': 'application/json'}

        def completions(self, prompt: str, model: str = "text-davinci-003", temperature: float = 0.7,
                        max_tokens: int = 256, top_p: float = 1, frequency_penalty: int = 0,
                        presence_penalty: int = 0) -> dict:
            """Enter an instruction and watch the OpenAI API respond with a completion that attempts to match the context
            or pattern you provided.

            :type prompt: ``str``
            :param prompt: Instruction
            :type model: ``str``
            :param model: The model which will generate the completion.
            :type temperature: ``float``
            :param temperature: Controls randomness: Lowering results in less random completions.
            :type max_tokens: ``int``
            :param max_tokens: The maximum number of tokens to generate.
            :type top_p: ``float``
            :param top_p: Controls Diversity via nucleus sampling
            :type frequency_penalty: ``int``
            :param frequency_penalty: How much to penalize new tokens based on their existing frequency in the text so far.
            :type presence_penalty: ``int``
            :param presence_penalty: How much to penalize new tokens based on whether they appear in the text so far.

            :return: response of the OpenAI Completion API
            :rtype: ``dict``
            """

            data = {
                "model": model,
                "prompt": prompt,
                "temperature": temperature,
                "max_tokens": max_tokens,
                "top_p": top_p,
                "frequency_penalty": frequency_penalty,
                "presence_penalty": presence_penalty
            }

            return self._http_request(method='POST', url_suffix='v1/completions', json_data=data, headers=self.headers,
                                      resp_type='json', ok_codes=(200,), )


    ''' COMMAND FUNCTIONS '''


    def test_module_command(client):
        """
        Tests OpenAPI connectivity
        """
        result = client.completions(prompt="Can I connect to the OpenAI api?")
        if result:
            return 'ok'
        else:
            return 'Did not receive a response from OpenAI API'


    def reputations_command(client: Client, args: dict) -> CommandResults:
        """Enter an instruction and watch the OpenAI API respond with a completion that attempts to match the context
        or pattern you provided.

        :type client: ``Client``
        :param client: instance of Client class to interact with OpenAI API
        :type args: ``dict``
        :param args:  arguments

        :return: CommandResults instance of the OpenAI Completion API response
        :rtype: ``CommandResults``
        """

        prompt = args.get('prompt', False)

        if not prompt:
            raise ValueError('No prompt argument was provided')

        model = args.get('model', 'text-davinci-003')
        temperature = args.get('temperature') or 0.7
        max_tokens = args.get('max_tokens') or 256
        top_p = args.get('top_p') or 1
        frequency_penalty = args.get('frequency_penalty') or 0
        presence_penalty = args.get('presence_penalty') or 0

        response = client.completions(prompt=prompt, model=model, temperature=float(temperature),
                                      max_tokens=int(max_tokens), top_p=int(top_p),
                                      frequency_penalty=int(frequency_penalty), presence_penalty=int(presence_penalty))

        meta = None
        context = None

        if response and isinstance(response, dict):
            model = response.get('model')
            id = response.get('id')
            choices = response.get('choices', [])
            meta = f"Model {response.get('model')} generated {len(choices)} possible text completion(s)."
            context = [{'id': id, 'model': model, 'text': choice.get('text')} for choice in choices]

        return CommandResults(
            readable_output=tableToMarkdown('OpenAI - Completions', context, metadata=meta, removeNull=True),
            outputs_prefix='OpenAI.Completions',
            outputs_key_field='id',
            outputs=context,
            raw_response=response
        )


    ''' MAIN FUNCTION '''


    def main() -> None:
        """main function, parses params and runs command functions

        """
        params = demisto.params()
        args = demisto.args()
        command = demisto.command()

        base_url = params.get('url')
        api_key = params.get('apikey')
        verify = not params.get('insecure', False)
        proxy = params.get('proxy', False)

        try:
            client = Client(
                base_url=base_url,
                api_key=api_key,
                verify=verify,
                proxy=proxy
            )

            if command == 'test-module':
                return_results(test_module_command(client))
            elif command == 'openai-completions':
                return_results(reputations_command(client=client, args=args))
        except Exception as e:
            demisto.error(traceback.format_exc())  # print the traceback
            return_error(f'Failed to execute {demisto.command()} command. Error: {str(e)}')


    ''' ENTRY POINT '''


    if __name__ in ('__main__', 'builtin', 'builtins'):
        main()

    register_module_line('OpenAI', 'end', __line__())
  subtype: python3
  type: python
system: true
