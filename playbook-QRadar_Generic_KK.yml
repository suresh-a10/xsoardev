contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 2.1.39
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: The QRadar Generic playbook is executed for the QRadar Generic incident
  type. It performs all the common parts of the investigation, including notifying
  the SOC, enriching data for indicators and users, calculating severity, assigning
  incidents, and notifying the SIEM admin about false positives.
id: 6a9f97f1-0721-4d9b-80ab-d5443b5c0cc5
inputs:
- description: Determines whether to enrich all indicators in the incident.
  key: Enrich
  playbookInputQuery: null
  required: false
  value:
    simple: "true"
- description: Set to true to assign only the user that is currently on shift. Requires
    Cortex XSOAR v5.5 or later.
  key: OnCall
  playbookInputQuery: null
  required: false
  value:
    simple: "false"
- description: The SOC team's email address.
  key: SocEmailAddress
  playbookInputQuery: null
  required: false
  value: {}
- description: The subject of the email to send to the SOC.
  key: SocMailSubject
  playbookInputQuery: null
  required: false
  value:
    simple: 'XSOAR Summary report, ID - '
- description: The SIEM admin's email address.
  key: SiemAdminEmailAddress
  playbookInputQuery: null
  required: false
  value: {}
- description: Determines whether to use the Calculate Severity playbook to calculate
    the incident severity. If the playbook isn't used, the severity is determined
    by the QRadar magnitude value.
  key: UseCalculateSeverity
  playbookInputQuery: null
  required: false
  value:
    simple: "true"
- description: The subject of the email to send to the SIEM admin.
  key: SiemAdminMailSubject
  playbookInputQuery: null
  required: false
  value:
    simple: 'Adjustment/Exclusion for offense '
- description: Determines whether to use the default mapping in the QRadar generic
    mapper to set the XSOAR incident severity, or set the severity using the FieldToSetSeverityFrom
    and ScaleToSetSeverityFrom playbook inputs. Any value other than false is considered
    as true and causes the playbook inputs to be used.
  key: UseCustomSeveritySettings
  playbookInputQuery: null
  required: false
  value:
    simple: "false"
- description: |
    Specifies the field to use for calculating the incident severity, for example the severity field.
  key: FieldToSetSeverityFrom
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: magnitude
      root: incident.labels
- description: "The range of values of FieldToSetSeverityFrom is 1-10. The XSOAR incident
    severity field value range is 0-4 where\n0 - Informational\n1 - Low\n2 - Medium\n3
    - High\n4 - Critical\n\nThe scale translates the value of FieldToSetSeverityFrom
    to a valid incident severity value. The default scale is 1,1,1,2,2,2,2,3,3,3 \nThis
    means that values 1-3 of FieldToSetSeverityFrom are translated to low severity
    (positions 1-3 in the scale), values 4-7 are translated to medium severity (positions
    4-7 in the scale) and values 8-10 are translated to high severity (positions 8-10
    in the scale)."
  key: ScaleToSetSeverityFrom
  playbookInputQuery: null
  required: false
  value:
    simple: 1,1,1,2,2,2,2,3,3,3
- description: By default the incident fetches the events defined in the integration
    instance settings (default is 20 events). To fetch additional events, change this
    setting to true.
  key: RunAdditionalSeach
  playbookInputQuery: null
  required: false
  value:
    simple: "true"
- description: Maximum number of log entires to query from QRadar. Used for the QRadar
    - Get Offense Logs subplaybook.
  key: MaxLogsCount
  playbookInputQuery: null
  required: false
  value:
    simple: "50"
- description: |
    If this value is "OnlyCRE", get only events made by CRE. Values can be "OnlyCRE", "OnlyNotCRE", "All". Used for the QRadar - Get Offense Logs subplaybook.
  key: GetOnlyCREEvents
  playbookInputQuery: null
  required: false
  value:
    simple: All
- description: |
    A comma-separated list of extra fields to get from each event. You can use different fields or rename the existing fields. Used for the QRadar - Get Offense Logs subplaybook.
  key: Fields
  playbookInputQuery: null
  required: false
  value:
    simple: QIDNAME(qid), LOGSOURCENAME(logsourceid), CATEGORYNAME(highlevelcategory),
      CATEGORYNAME(category), PROTOCOLNAME(protocolid), sourceip, sourceport, destinationip,
      destinationport, QIDDESCRIPTION(qid), username, PROTOCOLNAME(protocolid), RULENAME("creEventList"),
      sourcegeographiclocation, sourceMAC, sourcev6, destinationgeographiclocation,
      destinationv6, LOGSOURCETYPENAME(devicetype), credibility, severity, magnitude,
      eventcount, eventDirection, postNatDestinationIP, postNatDestinationPort, postNatSourceIP,
      postNatSourcePort, preNatDestinationPort, preNatSourceIP, preNatSourcePort,
      UTF8(payload), starttime, devicetime
- description: The tag to provide for true positive indicators, for example to use
    the indicators in an EDL (External Dynamic List).
  key: IndicatorTag
  playbookInputQuery: null
  required: false
  value:
    simple: block
- description: If this value is not false, add indicators to the XSOAR exclude list.
    The excluded indicators won't be created in XSOAR anymore.
  key: ExcludeIndicatorsInXSOAR
  playbookInputQuery: null
  required: false
  value:
    simple: "false"
name: QRadar Generic_KK
outputs: []
sourceplaybookid: QRadar Generic
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 911b0718-333e-4f36-8242-3054d50b03c8
      iscommand: false
      name: ""
      version: -1
    taskid: 911b0718-333e-4f36-8242-3054d50b03c8
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 210,
          "y": -1920
        }
      }
  "1":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Enrich
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the Enrich playbook input is set to True.
      id: 0c638fd2-ee16-445d-8855-86a06c5afc50
      iscommand: false
      name: Should indicators be extracted and enriched?
      type: condition
      version: -1
    taskid: 0c638fd2-ee16-445d-8855-86a06c5afc50
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 210,
          "y": -1105
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assigns a random analyst to this incident.
      id: 6ca41070-9b00-4c50-80fe-2ee87f86a67d
      iscommand: false
      name: Start Remediation SLA Timer
      type: title
      version: -1
    taskid: 6ca41070-9b00-4c50-80fe-2ee87f86a67d
    timertriggers:
    - action: start
      fieldname: remediationsla
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": -110
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b42653f1-b628-4d1f-85f5-590f1f14bcea
      iscommand: false
      name: Enrich Data
      type: title
      version: -1
    taskid: b42653f1-b628-4d1f-85f5-590f1f14bcea
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": -920
        }
      }
  "7":
    continueonerrortype: ""
    form:
      description: Provide notes regarding the investigation.
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Investigation Notes
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: longText
      sender: ""
      title: Investigation Notes
      totalanswers: 0
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manually review and investigate this incident.
      id: c4bb9f60-f6aa-4c9c-83c0-caf73f6d4d88
      iscommand: false
      name: Manually review the incident
      type: collection
      version: -1
    taskid: c4bb9f60-f6aa-4c9c-83c0-caf73f6d4d88
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 210,
          "y": 395
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      closeNotes:
        simple: |-
          Closed By: ${Investigation Notes.Answers.name}
          ${Investigation Notes.Answers.0}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Closes the current incident.
      id: 266b3507-9c64-41b7-858a-fbec97ea8d1a
      iscommand: true
      name: Close investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 266b3507-9c64-41b7-858a-fbec97ea8d1a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 220,
          "y": 3740
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Extracts all indicators from the incident and enriches the indicators
        by using the reputation command defined for each indicator type.
      id: 5ea5436c-5b22-4c90-89c4-b88b562a9f0e
      iscommand: true
      name: Extract indicators from incident
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 5ea5436c-5b22-4c90-89c4-b88b562a9f0e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": -790
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 9df0babe-5f21-4446-817b-9fcdfc1cb15d
      iscommand: false
      name: Entity Enrichment - Generic v2
      playbookId: Entity Enrichment - Generic v2
      type: playbook
      version: -1
    taskid: 9df0babe-5f21-4446-817b-9fcdfc1cb15d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": -630
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5041d8f2-27e3-433d-893c-597f136008ce
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 5041d8f2-27e3-433d-893c-597f136008ce
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 220,
          "y": 3880
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: containsGeneral
              right:
                value:
                  simple: report_Investigation_Summary
          root: InfoFile
      body:
        complex:
          accessor: investigation}
          root: ${demistoUrls
          transformers:
          - args:
              prefix:
                value:
                  simple: |
                    Link to the incident
              suffix: {}
            operator: concat
      subject:
        complex:
          root: inputs.SocMailSubject
          transformers:
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: incident.id
            operator: concat
      to:
        simple: ${inputs.SocEmailAddress}
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Sends an email using EWS.
      id: f6d3f039-b601-49b8-87a7-698799c92a22
      iscommand: true
      name: Send investigation report to SOC
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: f6d3f039-b601-49b8-87a7-698799c92a22
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -110,
          "y": 3570
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      False Positive:
      - "29"
      True Positive:
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9bc97c76-f63b-48ca-8880-03c10a475245
      iscommand: false
      name: Was this a true positive?
      type: condition
      version: -1
    taskid: 9bc97c76-f63b-48ca-8880-03c10a475245
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 210,
          "y": 1540
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        A script to generate the investigation summary report automatically
        can be used in the post-processing flow as well.
      id: 76d85e6e-6f87-4875-8f25-3c21ba82dda9
      iscommand: false
      name: Generate Investigation Summary Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: 76d85e6e-6f87-4875-8f25-3c21ba82dda9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 220,
          "y": 2880
        }
      }
  "16":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.UseCalculateSeverity
          operator: isEqualString
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 35de15f2-6203-4b92-836c-710ce8264421
      iscommand: false
      name: Use Calculate Severity?
      type: condition
      version: -1
    taskid: 35de15f2-6203-4b92-836c-710ce8264421
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": -450
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.SocEmailAddress
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 08a3c7b5-8998-498a-8392-869fc267f07f
      iscommand: false
      name: Was the SOC email address provided?
      type: condition
      version: -1
    taskid: 08a3c7b5-8998-498a-8392-869fc267f07f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 220,
          "y": 3030
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.SiemAdminEmailAddress
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 482c7b26-291e-4d27-82f3-aa687f57ddac
      iscommand: false
      name: Was the SIEM admin email address provided?
      type: condition
      version: -1
    taskid: 482c7b26-291e-4d27-82f3-aa687f57ddac
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -60,
          "y": 2040
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      assignBy:
        simple: random
      onCall:
        complex:
          root: inputs.OnCall
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assigns a random analyst to this incident.
      id: 0c5691ff-ea38-4314-8fdb-a9745ba73159
      iscommand: false
      name: Assign an analyst to the incident
      script: AssignAnalystToIncident
      type: regular
      version: -1
    taskid: 0c5691ff-ea38-4314-8fdb-a9745ba73159
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 215
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d40e7d15-32a4-4047-8d62-93d2502a80a6
      iscommand: false
      name: XSOAR Exclude Indicators
      type: title
      version: -1
    taskid: d40e7d15-32a4-4047-8d62-93d2502a80a6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": 560
        }
      }
  "22":
    continueonerrortype: ""
    form:
      description: Provide what should be adjusted in the rule
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Which rules need to be adjusted?
        options: []
        optionsarg:
        - {}
        - simple: ${incident.listofrulesoffense}
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Which indicators need to be excluded in QRadar?
        options: []
        optionsarg:
        - {}
        - complex:
            root: ExtractedIndicators
            transformers:
            - args:
                field:
                  value:
                    simple: Domain
              operator: getField
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.IP
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.URL
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.Email
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
              operator: append
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Data for rule adjustment by the SIEM admin
      totalanswers: 0
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Provide data to adjust the rule in order to avoid similar false
        positives in the future.
      id: eedc53da-cdb5-40aa-81bd-ea2fcdc2fb6e
      iscommand: false
      name: Provide data for rule adjustment
      type: collection
      version: -1
    taskid: eedc53da-cdb5-40aa-81bd-ea2fcdc2fb6e
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -60,
          "y": 1870
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        complex:
          root: inputs.FieldToSetSeverityFrom
          transformers:
          - args:
              input_values:
                value:
                  simple: 1,2,3,4,5,6,7,8,9,10
              mapped_values:
                iscontext: true
                value:
                  simple: inputs.ScaleToSetSeverityFrom
            operator: MapValuesTransformer
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Sets the incident severity according to the FieldToSetSeverityFrom
        and ScaleToSetSeverityFrom playbook inputs, which specify the relevant offense
        field and the scale for the severity translation.
      id: 75003d07-60be-49b7-86c5-b404b4c73435
      iscommand: true
      name: Determine incident severity according to offense info
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 75003d07-60be-49b7-86c5-b404b4c73435
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -20,
          "y": -1620
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 993f7a3a-1b98-49fc-89ba-2ed8a5bb86b2
      iscommand: false
      name: Investigation
      type: title
      version: -1
    taskid: 993f7a3a-1b98-49fc-89ba-2ed8a5bb86b2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": 60
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Sets the incident status as false positive.
      id: 2e98d7a3-b69d-4265-821c-6e74c906f291
      iscommand: true
      name: Set as false positive
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 2e98d7a3-b69d-4265-821c-6e74c906f291
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -60,
          "y": 1710
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e36cec0e-9630-428e-8b45-1c5eab1111fd
      iscommand: false
      name: SIEM Admin
      type: title
      version: -1
    taskid: e36cec0e-9630-428e-8b45-1c5eab1111fd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -60,
          "y": 2390
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: caeb7a4d-de19-4e39-8dd3-791a9b556e53
      iscommand: false
      name: SOC Summary
      type: title
      version: -1
    taskid: caeb7a4d-de19-4e39-8dd3-791a9b556e53
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -110,
          "y": 3250
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: dba5c8af-19e9-46fe-8abf-6cf5ff1f33fd
      iscommand: false
      name: Calculate Severity - Standard
      playbookId: Calculate Severity - Standard
      type: playbook
      version: -1
    taskid: dba5c8af-19e9-46fe-8abf-6cf5ff1f33fd
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 760,
          "y": -280
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.UseCustomSeveritySettings
          operator: isNotEqualString
          right:
            value:
              simple: "false"
      label: use custom
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 917f3a48-1fb8-4320-8b87-9812cccaff88
      iscommand: false
      name: Use custom severity?
      type: condition
      version: -1
    taskid: 917f3a48-1fb8-4320-8b87-9812cccaff88
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 210,
          "y": -1750
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.RunAdditionalSeach
          operator: isEqualString
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "1"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 65efdfe8-cde4-4341-804d-432cd44817f5
      iscommand: false
      name: Run additional searches?
      type: condition
      version: -1
    taskid: 65efdfe8-cde4-4341-804d-432cd44817f5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 210,
          "y": -1450
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    scriptarguments:
      Fields:
        simple: ${inputs.Fields}
      GetOnlyCREEvents:
        simple: ${inputs.GetOnlyCREEvents}
      ID:
        complex:
          accessor: idoffense
          root: incident
      MaxLogsCount:
        simple: ${inputs.MaxLogsCount}
      StartTime:
        complex:
          accessor: starttime
          root: incident
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "Works for QRadar integrations versions 2 and 3, v1 is deprecated.\n\nNote:
        For QRadar v2 and v3 you can use the integration to fetch the events according
        to the limit defined in the instance settings. Using this playbook you can
        define you can define an additional search to query a larger number of logs.\n\nDefault
        playbook inputs use the QRadar incident fields such as idoffense, starttime.
        These fields can be replaced, but need to point to relevant offense ID and
        starttime fields. "
      id: a4c1d790-7c77-418c-8039-dd19bcc7f896
      iscommand: false
      name: QRadar - Get Offense Logs
      playbookId: QRadar - Get Offense Logs
      type: playbook
      version: -1
    taskid: a4c1d790-7c77-418c-8039-dd19bcc7f896
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -20,
          "y": -1280
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Provide closing reason and tag indicators.Answers
                transformers:
                - operator: count
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Checks if one number(float) as bigger than the other(float)
        Returns yes: if first > second
        Returns no: if first <= second
        Returns exception if one of the inputs is not a number
      id: 65421656-1937-483e-8f08-2529244b7d36
      iscommand: false
      name: Any indicators to tag?
      type: condition
      version: -1
    taskid: 65421656-1937-483e-8f08-2529244b7d36
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 510,
          "y": 2040
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: ${inputs.IndicatorTag}
      value:
        simple: ${Provide closing reason and tag indicators.Answers.0}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 3be73105-a9ae-4070-873f-21ace063b677
      iscommand: true
      name: Tag Indicators
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 3be73105-a9ae-4070-873f-21ace063b677
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 2700
        }
      }
  "39":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ExcludeIndicatorsInXSOAR
          operator: isNotEqualString
          right:
            value:
              simple: "false"
      label: "yes"
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5ffd0d9a-2f55-4278-8ecd-34734c1d24d2
      iscommand: false
      name: Is Indicator exclusion allowed in XSOAR?
      type: condition
      version: -1
    taskid: 5ffd0d9a-2f55-4278-8ecd-34734c1d24d2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 210,
          "y": 710
        }
      }
  "41":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Indicators to exclude in XSOAR.Answers
                transformers:
                - operator: count
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: "yes"
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8bb7f442-a949-402a-87b5-61962ab5e3cd
      iscommand: false
      name: Any indicators to exclude?
      type: condition
      version: -1
    taskid: 8bb7f442-a949-402a-87b5-61962ab5e3cd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 0,
          "y": 1030
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d2436699-3a38-45ce-86a2-000447c76bfd
      iscommand: false
      name: True/False Positive tuning
      type: title
      version: -1
    taskid: d2436699-3a38-45ce-86a2-000447c76bfd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": 1400
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        simple: ${Indicators to exclude in XSOAR.Answers.0}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.exclude.indicators
      id: 11c6dff4-71ef-491b-8294-39de44db55eb
      iscommand: true
      name: Exclude Indicators
      script: Builtin|||excludeIndicators
      type: regular
      version: -1
    taskid: 11c6dff4-71ef-491b-8294-39de44db55eb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -170,
          "y": 1220
        }
      }
  "44":
    continueonerrortype: ""
    form:
      description: Provide what should be adjusted in the rule
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Which indicators need to be excluded in XSOAR?
        options: []
        optionsarg:
        - {}
        - complex:
            root: ExtractedIndicators
            transformers:
            - args:
                field:
                  value:
                    simple: Domain
              operator: getField
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.IP
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.URL
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.Email
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
              operator: append
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Indicators to exclude in XSOAR
      totalanswers: 0
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Provide data to adjust the rule in order to avoid similar false
        positives in the future.
      id: fe92d53d-1b62-4d2b-8716-ed84dacbd2dd
      iscommand: false
      name: Select indicators to exclude
      type: collection
      version: -1
    taskid: fe92d53d-1b62-4d2b-8716-ed84dacbd2dd
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 0,
          "y": 880
        }
      }
  "45":
    continueonerrortype: ""
    form:
      description: Provide what should be adjusted in the rule
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Which indicators need to be tagged? '
        options: []
        optionsarg:
        - {}
        - complex:
            root: ExtractedIndicators
            transformers:
            - args:
                field:
                  value:
                    simple: Domain
              operator: getField
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.IP
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.URL
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.Email
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
              operator: append
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: What is the closing reason?
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: shortText
      sender: ""
      title: Provide closing reason and tag indicators
      totalanswers: 0
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Provide data to adjust the rule in order to avoid similar false
        positives in the future.
      id: fdd1da15-12b1-4384-8f8c-77caa0aec2d7
      iscommand: false
      name: Provide closing reason and tag indicators
      type: collection
      version: -1
    taskid: fdd1da15-12b1-4384-8f8c-77caa0aec2d7
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 510,
          "y": 1710
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: ${Provide closing reason and tag indicators.Answers.1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 6dbf28d2-c822-483e-8a6f-a088be4f748b
      iscommand: true
      name: Set closing reason
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6dbf28d2-c822-483e-8a6f-a088be4f748b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 1870
        }
      }
  "52":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Were the rules adjusted?
        options: []
        optionsarg:
        - {}
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Were the indicators adjusted?
        options: []
        optionsarg:
        - {}
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Adjustments to SIEM
      totalanswers: 0
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: |
          Dear ${inputs.SocEmailAddress}
          please adjust the following rules
          ${Data for rule adjustment by the SIEM admin.Answers.0}

          And the following indicators
          ${Data for rule adjustment by the SIEM admin.Answers.1}
      cc: null
      format: ""
      methods:
      - email
      subject:
        complex:
          root: inputs.SiemAdminMailSubject
          transformers:
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: incident.idoffense
            operator: concat
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${inputs.SiemAdminEmailAddress}
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        complex:
          accessor: Answers
          root: Data for rule adjustment by the SIEM admin
          transformers:
          - operator: Stringify
          - args:
              regex:
                value:
                  simple: (.*)
              replaceWith:
                value:
                  simple: |
                    Link to offense
            operator: replaceMatch
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: incident.linktooffense
            operator: concat
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "\nRules to adjust - "
            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: Data for rule adjustment by the SIEM admin.Answers.0
            operator: concat
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "\nValues to exclude - "
            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: Data for rule adjustment by the SIEM admin.Answers.1
            operator: concat
      subject:
        complex:
          root: inputs.SiemAdminMailSubject
          transformers:
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: incident.idoffense
            operator: concat
      to:
        simple: ${inputs.SiemAdminEmailAddress}
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Sends an email using EWS.
      id: 149ff213-4655-4a85-886f-36093eae0704
      iscommand: false
      name: Send email to SIEM admin
      type: collection
      version: -1
    taskid: 149ff213-4655-4a85-886f-36093eae0704
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -60,
          "y": 2710
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "14_29_False Positive": 0.56,
      "14_45_True Positive": 0.66,
      "18_15_#default#": 0.3,
      "37_15_#default#": 0.3
    },
    "paper": {
      "dimensions": {
        "height": 5865,
        "width": 1310,
        "x": -170,
        "y": -1920
      }
    }
  }
