contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 3cbf011e-2688-4e25-8aa0-ef51e8124dd9
inputs: []
name: TCS - Report for Citi Incidents v1.0_KK
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2579106a-4641-4c5a-854a-7e9ca16cd678
      iscommand: false
      name: ""
      version: -1
    taskid: 2579106a-4641-4c5a-854a-7e9ca16cd678
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 670,
          "y": -150
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: csv
          root: File
      body:
        simple: "Hi All , \n\nThe list of incidents triggered for Citi Project is
          as follows : ${lists.List of Citi Offences Triggered}. \n\nNote: Severity
          is represented as numbers in the sheet. \n1-Low \n2-Medium \n3-High \n4-Critical\n\nRegards\nCyberBot"
      subject:
        simple: List of Citi Offences Triggered
      to:
        simple: nimisha.prajapati@tcs.com,internalis.cybersecurity@tcs.com,TCSCiti.MIS@tcs.com
      using:
        simple: EWS Mail Sender_Autobot
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 31f94c98-f290-4d04-8e78-5025fa82f244
      iscommand: true
      name: Email report for citi offences triggered
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 31f94c98-f290-4d04-8e78-5025fa82f244
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: ffd5fed1-c64d-4e99-88e0-7f04dff4a848
      iscommand: true
      name: Close investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: ffd5fed1-c64d-4e99-88e0-7f04dff4a848
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e46f3d28-902c-43e7-8575-2e5df41dab61
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: e46f3d28-902c-43e7-8575-2e5df41dab61
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 670,
          "y": 720
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      entryid:
        simple: ${File.EntryID}
      filename:
        simple: CitiIncidentDetails.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Script to convert a War Room output JSON File to a CSV file.
      id: 2bde3113-ac52-4c2d-8d02-33219b4bd048
      iscommand: false
      name: convert to CSV
      script: JSONFileToCSV
      type: regular
      version: -1
    taskid: 2bde3113-ac52-4c2d-8d02-33219b4bd048
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: CitiID
      value:
        complex:
          accessor: List of Citi Offences Triggered
          root: lists
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' or id:'
              toReplace:
                value:
                  simple: ','
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3e4269b8-ca75-4700-83e1-529ef3de73bb
      iscommand: false
      name: CitiID Format
      script: Set
      type: regular
      version: -1
    taskid: 3e4269b8-ca75-4700-83e1-529ef3de73bb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 20
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      outputFormat:
        simple: json
      populateFields:
        simple: id,name,type,owner,status,severity,occurred,closed,investigationconclusion,investigationanalysis
      query:
        simple: id:${CitiID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a list of incident objects and the associated incident outputs
        that match the specified query and filters. The results are returned in a
        structured data file.
      id: 54317721-6fe5-4b2f-8879-c6a5de23c11e
      iscommand: false
      name: Generate Report
      script: 49d7a09e-d349-4c1a-8eb1-67ef241b3cd1
      type: regular
      version: -1
    taskid: 54317721-6fe5-4b2f-8879-c6a5de23c11e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 210
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: csv
          root: File
      body:
        simple: "Hi All , \n\nThe list of incidents triggered for Citi Project is
          as follows : ${lists.List of Citi Offences Triggered}. \n\nNote: Severity
          and Status of the incidents are represented as numbers in the sheet.\nSeverity:
          1-Low, 2-Medium, 3-High, 4-Critical\nStatus: 1-Active, 2-Closed\n\nRegards\nCyberBot"
      subject:
        simple: List of Citi Offences Triggered
      to:
        simple: internalis.cybersecurity@tcs.com,TCSCiti.MIS@tcs.com
      using:
        simple: EWS Mail Sender_Autobot
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 48216b05-3141-4277-8450-fe3e4318a2f3
      iscommand: true
      name: Email report for citi offences triggered
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 48216b05-3141-4277-8450-fe3e4318a2f3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 360
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      add_fields_to_context:
        simple: occurred,crowdstrikehostname,investigationconclusion,investigationanalysis,imtraised,imtnumber
      id:
        complex:
          accessor: List of Citi Offences Triggered
          root: lists
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Searches Cortex XSOAR Incidents and returnrs the most relevant
        fields. Default search range is the last 30 days, if you want to change this,
        use the fromDate argument. \n\nReturns the id, name, type, severity, status,
        owner, and created/closed times to context.  You can add additional fields
        using the add_field_to_context argument.\n\nThis automation runs using the
        default Limited User role, unless you explicitly change the permissions.  Based
        on the SearchIncidentsV2 from the Common Scripts pack, but more efficient."
      id: 9f31afae-cf71-4f23-8ac0-5c0ba1665340
      iscommand: false
      name: Get Report of Citi Incidents
      script: SearchIncidentsSummary
      type: regular
      version: -1
    taskid: 9f31afae-cf71-4f23-8ac0-5c0ba1665340
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 10
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${foundIncidents}
      fileName:
        simple: CitiIncidentDetails.csv
      headers:
        simple: id,name,type,severity,status,occurred,crowdstrikehostname,investigationconclusion,investigationanalysis,imtraised,imtnumber,closed
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 6706ebca-79dc-468e-8065-e44ffbeaa8fb
      iscommand: false
      name: Export Required Fields To CSV
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 6706ebca-79dc-468e-8065-e44ffbeaa8fb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 180
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 315368ad-d43d-4cb7-8ff3-e900fbb17655
      iscommand: true
      name: Close investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 315368ad-d43d-4cb7-8ff3-e900fbb17655
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 545
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 965,
        "width": 1000,
        "x": 50,
        "y": -150
      }
    }
  }
