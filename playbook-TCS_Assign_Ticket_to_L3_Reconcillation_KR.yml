contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 189e6e9a-40ff-4ce5-8645-f75fb2cb7227
inputs: []
name: TCS_Assign Ticket to L3_Reconcillation_KR
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3105408c-5f9f-459d-8588-714cd047c506
      iscommand: false
      name: ""
      version: -1
    taskid: 3105408c-5f9f-459d-8588-714cd047c506
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 560,
          "y": -2700
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        complex:
          accessor: id
          root: incident
      linkedIncidentIDs:
        complex:
          accessor: ticketnumber
          root: incident
          transformers:
          - args:
              from:
                value:
                  simple: '-'
            operator: substringFrom
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.linkIncidents
      id: 4e57c230-8d0a-40ac-880e-0c393c6f6c3b
      iscommand: true
      name: Link To Parent Incident
      script: Builtin|||linkIncidents
      type: regular
      version: -1
    taskid: 4e57c230-8d0a-40ac-880e-0c393c6f6c3b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 560,
          "y": -2560
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get the Server URL.
      id: 49df5448-e1af-4264-8968-782e7e1e1c01
      iscommand: false
      name: Get Server URL
      script: GetServerURL
      type: regular
      version: -1
    taskid: 49df5448-e1af-4264-8968-782e7e1e1c01
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 560,
          "y": -2370
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: incidentlink
      value:
        simple: https://${ServerURL.Host}/#/Custom/caseinfoid/${incident.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8cf211f0-45b2-4217-8b0b-db1d09c7e926
      iscommand: false
      name: Set Server link In Context
      script: Set
      type: regular
      version: -1
    taskid: 8cf211f0-45b2-4217-8b0b-db1d09c7e926
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 560,
          "y": -2190
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      incidentlink:
        simple: ${incidentlink}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 72905c32-3d40-4eaf-8ab5-8a9512b32d17
      iscommand: true
      name: Set Incident Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 72905c32-3d40-4eaf-8ab5-8a9512b32d17
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 560,
          "y": -2010
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      roles:
        simple: CSOC-Threat-Hunter
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.get.users
      id: 94f90685-96ab-4f40-868b-ef75d849ede5
      iscommand: true
      name: 'Set All L3 Members In Context '
      script: Builtin|||getUsers
      type: regular
      version: -1
    taskid: 94f90685-96ab-4f40-868b-ef75d849ede5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 560,
          "y": -1820
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      assignBy:
        simple: machine-learning
      roles:
        simple: CSOC-Threat-Hunter
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Assign analyst to incident.
        By default,  the analyst is picked randomly from the available users, according to the provided roles (if no roles provided, will fetch all users).
        Otherwise, the analyst will be picked according to the 'assignBy' arguments.
        machine-learning: DBot will calculated and decide who is the best analyst for the job.
        top-user: The user that is most commonly owns this type of incident
        less-busy-user: The less busy analyst will be picked to be the incident owner.
        online: The analyst is picked randomly from all online analysts, according to the provided roles (if no roles provided, will fetch all users).
        current: The user that executed the command
      id: 4ad6b7bf-2b3c-445e-844a-ff0c58209d87
      iscommand: false
      name: Assign Ticket To L3 via Machine Learning
      script: AssignAnalystToIncident_V2
      type: regular
      version: -1
    taskid: 4ad6b7bf-2b3c-445e-844a-ff0c58209d87
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 560,
          "y": -1650
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: IncidentOwner.username=IncidentOwner.username
      ignore-outputs:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Expose the incident owner into IncidentOwner context key
      id: f80c4f21-e797-4dac-8c5b-328679d8ef21
      iscommand: false
      name: Expose The Incident Owner
      script: ExposeIncidentOwner
      type: regular
      version: -1
    taskid: f80c4f21-e797-4dac-8c5b-328679d8ef21
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 560,
          "y": -1450
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 85bd7122-4bc6-4f82-81c9-b18ef3fe08ad
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: 85bd7122-4bc6-4f82-81c9-b18ef3fe08ad
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 560,
          "y": -1290
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1475,
        "width": 380,
        "x": 560,
        "y": -2700
      }
    }
  }
