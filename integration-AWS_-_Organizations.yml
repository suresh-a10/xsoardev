category: Identity and Access Management
commonfields:
  id: AWS - Organizations
  version: -1
configuration:
- additionalinfo: The Amazon Resource Name (ARN) of the role to assume.
  display: Role Arn
  name: role_arn
  required: false
  section: Connect
  type: 0
- additionalinfo: An identifier for the assumed role session.
  display: Role Session Name
  name: role_session_name
  required: false
  section: Connect
  type: 0
- additionalinfo: The duration, in seconds, of the role session. The value can range
    from 900 seconds (15 minutes) up to the maximum session duration setting for the
    role.
  advanced: true
  display: Role Session Duration
  name: role_session_duration
  required: false
  section: Connect
  type: 0
- display: Access Key
  displaypassword: Secret Key
  name: credentials
  required: false
  section: Connect
  type: 9
- additionalinfo: The time in seconds until a timeout exception is reached. You can
    specify just the read timeout (for example 60) or also the connect timeout followed
    after a comma (for example 60,10). If a connect timeout is not specified, a default
    of 10 seconds will be used.
  defaultvalue: 60,10
  display: Timeout
  name: timeout
  required: false
  section: Connect
  type: 0
- additionalinfo: 'The maximum number of retry attempts when connection or throttling
    errors are encountered. Set to 0 to disable retries. The default value is 5 and
    the limit is 10. Note: Increasing the number of retries will increase the execution
    time.'
  defaultvalue: "5"
  display: Retries
  name: retries
  required: false
  section: Connect
  type: 0
- additionalinfo: Sets the AWS_STS_REGIONAL_ENDPOINTS environment variable to specify
    the AWS STS endpoint resolution logic. By default, this option is set to “legacy”
    in AWS. Leave empty if the environment variable is already set using server configuration.
  display: AWS STS Regional Endpoints
  name: sts_regional_endpoint
  options:
  - legacy
  - regional
  required: false
  section: Connect
  type: 15
- advanced: true
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  section: Connect
  type: 8
- advanced: true
  display: Use system proxy settings
  name: proxy
  required: false
  section: Connect
  type: 8
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.10.0
    itemVersion: 1.0.2
    packID: AWS-Organizations
    packName: AWS Organizations
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: Manage Amazon Web Services accounts and their resources.
detaileddescription: "Before using AWS Organizations, you need to perform several
  configuration steps in your AWS environment.\n\n### Prerequisites\n- Attach an instance
  profile with the required permissions to the Cortex XSOAR server or engine that
  is running \non your AWS environment.\n- The instance profile requires the following
  minimum permission: sts:AssumeRole.\n- The instance profile requires permission
  to assume the roles needed by the AWS integrations.\n\n### Configure AWS Settings\n1.
  Create an IAM role for the instance profile.\n2. Attach a role to the instance profile.\n3.
  Configure the necessary IAM roles that the AWS integration can assume.\n\nFor detailed
  instructions, see [AWS Integrations - Authentication](https://xsoar.pan.dev/docs/reference/articles/aws-integrations---authentication).\n\nFor
  AWS Organizations quotas, guidelines and restrictions, see [AWS Organizations Quotas](https://docs.aws.amazon.com/organizations/latest/userguide/orgs_reference_limits.html).\n\n---\n[View
  Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/aws---organizations)"
display: AWS - Organizations
image: data:image/png;base64,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
name: AWS - Organizations
script:
  commands:
  - arguments:
    - defaultValue: "50"
      description: The number of roots to return.
      name: limit
    - description: The number of roots to return per page. The maximum is 1000.
      name: page_size
    - description: The token denoting the next page of roots, as given by the response
        of the previous run of this command under the context key "AWS.Organizations.RootNextToken".
      name: next_token
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: List the roots that are defined in the current organization.
    name: aws-org-root-list
    outputs:
    - contextPath: AWS.Organizations.Root.Id
      description: The unique identifier (ID) of the root.
      type: String
    - contextPath: AWS.Organizations.Root.Arn
      description: The Amazon Resource Name (ARN) of the root.
      type: String
    - contextPath: AWS.Organizations.Root.Name
      description: The friendly name of the root.
      type: String
    - contextPath: AWS.Organizations.Root.PolicyTypes.Type
      description: The name of the policy type.
      type: String
    - contextPath: AWS.Organizations.Root.PolicyTypes.Status
      description: The status of the policy type as it relates to the associated root.
      type: String
    - contextPath: AWS.Organizations.RootNextToken
      description: If not null, indicates that more output is available than is included
        in the current response. Use this value as the next_token argument in a subsequent
        call of the command to get the next part of the output.
      type: String
  - arguments:
    - description: The unique identifier (ID) for the parent root or organizational
        unit (OU) whose children are to be listed.
      name: parent_id
      required: true
    - auto: PREDEFINED
      description: Filters the output to include only the specified child type.
      name: child_type
      predefined:
      - Account
      - OrganizationalUnit
      required: true
    - defaultValue: "50"
      description: The number of children to return.
      name: limit
    - description: The number of children to return per page. The maximum is 1000.
      name: page_size
    - description: The token denoting the next page of children as given by the response
        of the previous run of this command under the context key "AWS.Organizations.ChildrenNextToken".
      name: next_token
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: List all of the organizational units (OUs) or accounts that are contained
      in the specified parent OU or root.
    name: aws-org-children-list
    outputs:
    - contextPath: AWS.Organizations.Children.Id
      description: The unique identifier (ID) of the child entity.
      type: String
    - contextPath: AWS.Organizations.Children.Type
      description: The type of the child entity.
      type: String
    - contextPath: AWS.Organizations.Children.ParentId
      description: The unique identifier (ID) for the parent root or organizational
        unit of the child entity.
      type: String
    - contextPath: AWS.Organizations.ChildrenNextToken
      description: If not null, indicates that more output is available than is included
        in the current response. Use this value as the next_token argument in a subsequent
        call of the command to get the next part of the output.
      type: String
  - arguments:
    - description: |
        The unique identifier (ID) of the organizational unit or account whose parent containers you want to list. Don't specify a root.
        This value can be retrieved by running the command "aws-org-account-list".
      name: child_id
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: |
      Lists all of the organizational units (OUs) or accounts that are a parent OU or root of the specified child.
      This command returns only the immediate parents in the hierarchy.
    name: aws-org-parent-list
    outputs:
    - contextPath: AWS.Organizations.Parent.Id
      description: The unique identifier (ID) of the parent entity.
      type: String
    - contextPath: AWS.Organizations.Parent.Type
      description: The type of the parent entity.
      type: String
    - contextPath: AWS.Organizations.Parent.ChildId
      description: The unique identifier (ID) of the organizational unit or account
        of the child of the parent entity.
      type: String
  - arguments:
    - description: The unique identifier (ID) of the organizational unit to retrieve
        details about.
      name: organization_unit_id
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: |
      Retrieve information about an organizational unit (OU).
      This command can be called only from the organization's management account or by a member account that is a delegated administrator for an Amazon Web Services service.
    name: aws-org-organization-unit-get
    outputs:
    - contextPath: AWS.Organizations.OrganizationUnit.Id
      description: The unique identifier (ID) associated with the organizational unit.
      type: String
    - contextPath: AWS.Organizations.OrganizationUnit.Arn
      description: The Amazon Resource Name (ARN) of the organizational unit.
      type: String
    - contextPath: AWS.Organizations.OrganizationUnit.Name
      description: The friendly name of the organizational unit.
      type: String
  - arguments:
    - description: Get a specific account by ID.
      name: account_id
    - defaultValue: "50"
      description: The number of accounts to return.
      name: limit
    - description: The number of accounts to return per page. The maximum is 1000.
      name: page_size
    - description: The token denoting the next page of accounts, as given by the response
        of the previous run of this command under the context key "AWS.Organizations.AccountNextToken".
      name: next_token
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Lists all the accounts in the organization or a specific account
      by ID.
    name: aws-org-account-list
    outputs:
    - contextPath: AWS.Organizations.Account.Id
      description: The unique identifier (ID) of the account.
      type: String
    - contextPath: AWS.Organizations.Account.Arn
      description: The Amazon Resource Name (ARN) of the account.
      type: String
    - contextPath: AWS.Organizations.Account.Email
      description: The email address associated with the Amazon Web Services account.
      type: String
    - contextPath: AWS.Organizations.Account.Name
      description: The friendly name of the account.
      type: String
    - contextPath: AWS.Organizations.Account.Status
      description: The status of the account in the organization.
      type: String
    - contextPath: AWS.Organizations.Account.JoinedMethod
      description: The method by which the account joined the organization.
      type: String
    - contextPath: AWS.Organizations.Account.JoinedTimestamp
      description: The date the account became a part of the organization.
      type: Date
    - contextPath: AWS.Organizations.AccountNextToken
      description: If not null, indicates that more output is available than is included
        in the current response. Use this value as the next_token argument in a subsequent
        call of the command to get the next part of the output.
      type: String
  - arguments:
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Retrieves information about the organization that the user's account
      belongs to.
    name: aws-org-organization-get
    outputs:
    - contextPath: AWS.Organizations.Organization.Id
      description: The unique identifier (ID) of the organization.
      type: String
    - contextPath: AWS.Organizations.Organization.Arn
      description: The Amazon Resource Name (ARN) of the organization.
      type: String
    - contextPath: AWS.Organizations.Organization.FeatureSet
      description: |
        Specifies the functionality that currently is available to the organization.
        If set to “ALL”, then all features are enabled and policies can be applied to accounts in the organization.
        If set to “CONSOLIDATED_BILLING”, then only consolidated billing functionality is available.
      type: String
    - contextPath: AWS.Organizations.Organization.MasterAccountArn
      description: The Amazon Resource Name (ARN) of the account that is designated
        as the management account for the organization.
      type: String
    - contextPath: AWS.Organizations.Organization.MasterAccountId
      description: The unique identifier (ID) of the management account of the organization.
      type: String
    - contextPath: AWS.Organizations.Organization.MasterAccountEmail
      description: The email address that is associated with the Amazon Web Services
        account that is designated as the management account for the organization.
      type: String
  - arguments:
    - description: The unique identifier (ID) of the member account to be removed
        from the organization. This can be obtained with the command "aws-organizations-account-list".
      name: account_id
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: 'Removes an account from the organization. For more information on
      this action: https://docs.aws.amazon.com/organizations/latest/APIReference/API_RemoveAccountFromOrganization.html'
    name: aws-org-account-remove
  - arguments:
    - description: The unique identifier (ID) of the member account move. This value
        can be retrieved by running the command "aws-org-account-list".
      name: account_id
      required: true
    - description: |
        The unique identifier (ID) of the root or organizational unit to move the account to.
        This value can be retrieved by running the command "aws-org-root-list".
      name: destination_parent_id
      required: true
    - description: |
        The unique identifier (ID) of the root or organizational unit to move the account from.
        This value can be retrieved by running the command "aws-org-parent-list" with the child_id set to the account_id.
      name: source_parent_id
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Moves an account from one parent to another.
    name: aws-org-account-move
  - arguments:
    - description: The friendly name of the member account.
      name: account_name
      required: true
    - description: The email address of the owner to assign to the new member account.
        This email address must not already be associated with another Amazon Web
        Services account. Use a valid email address to complete account creation.
      name: email
      required: true
    - auto: PREDEFINED
      defaultValue: Allow
      description: If set to ALLOW, the new account enables IAM users to access account
        billing information if they have the required permissions. If set to DENY,
        only the root user of the new account can access account billing information.
      name: iam_user_access_to_billing
      predefined:
      - Allow
      - Deny
    - defaultValue: OrganizationAccountAccessRole
      description: The name of an IAM role that AWS Organizations automatically pre-configures
        in the new member account. This role trusts the management account, allowing
        users in the management account to assume the role, as permitted by the management
        account administrator. The role has administrator permissions in the new member
        account.
      name: role_name
    - description: 'A comma-separated list of tags to attach to the newly created
        account. Each tag should be in the format: "key=value".'
      isArray: true
      name: tags
    - description: The ID of the create request that is used for polling.
      hidden: true
      name: request_id
    - defaultValue: "30"
      description: Indicates how long to wait between command executions (in seconds)
        when the 'polling' argument is true. Minimum value is 10 seconds.
      name: interval_in_seconds
    - defaultValue: "600"
      description: Indicates the time in seconds until the polling sequence times
        out.
      name: timeout
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - hidden: true
      name: hide_polling_output
    description: Creates an AWS Account that is automatically a member of the organization.
    name: aws-org-account-create
    outputs:
    - contextPath: AWS.Organizations.Account.Id
      description: The unique identifier (ID) of the account.
      type: String
    - contextPath: AWS.Organizations.Account.Arn
      description: The Amazon Resource Name (ARN) of the account.
      type: String
    - contextPath: AWS.Organizations.Account.Email
      description: The email address associated with the Amazon Web Services account.
      type: String
    - contextPath: AWS.Organizations.Account.Name
      description: The friendly name of the account.
      type: String
    - contextPath: AWS.Organizations.Account.Status
      description: The status of the account in the organization.
      type: String
    - contextPath: AWS.Organizations.Account.JoinedMethod
      description: The method by which the account joined the organization.
      type: String
    - contextPath: AWS.Organizations.Account.JoinedTimestamp
      description: The date the account became a part of the organization.
      type: Date
    polling: true
  - arguments:
    - description: The unique identifier (ID) of the member account to close. This
        can be obtained with the command "aws-organizations-account-list".
      name: account_id
      required: true
    - defaultValue: "30"
      description: Indicates how long to wait between command executions (in seconds)
        when the 'polling' argument is true. Minimum value is 10 seconds.
      name: interval_in_seconds
    - defaultValue: "600"
      description: Indicates the time in seconds until the polling sequence times
        out.
      name: timeout
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - defaultValue: "false"
      description: whether the initial API call to close the account has been executed.
      hidden: true
      name: is_closed
    - hidden: true
      name: hide_polling_output
    description: Closes an AWS member account within an organization.
    name: aws-org-account-close
    polling: true
  - arguments:
    - description: The friendly name to assign to the new organizational unit.
      name: name
      required: true
    - description: The unique identifier (ID) of the parent root or organizational
        unit to create the new organizational unit in. This value can be retrieved
        by running the command "aws-org-root-list".
      name: parent_id
      required: true
    - description: 'A comma-separated list of tags to attach to the newly created
        organizational unit. Each tag should be in the format: "key=value".'
      isArray: true
      name: tags
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Creates an organizational unit (OU) within a root or parent OU. An
      OU is a container for accounts that enables the organization of accounts to
      apply policies according to business requirements. The number of levels deep
      that OUs can be nested is dependent upon the policy types enabled for that root.
      For service control policies, the limit is five.
    name: aws-org-organization-unit-create
    outputs:
    - contextPath: AWS.Organizations.OrganizationUnit.Id
      description: The unique identifier (ID) associated with this organizational
        unit.
      type: String
    - contextPath: AWS.Organizations.OrganizationUnit.Arn
      description: The Amazon Resource Name (ARN) of this organizational unit.
      type: String
    - contextPath: AWS.Organizations.OrganizationUnit.Name
      description: The friendly name of this organizational unit.
      type: String
  - arguments:
    - description: The unique identifier (ID) of the organizational unit that you
        want to delete.
      name: organizational_unit_id
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deletes an organizational unit (OU) from a root or another OU. All
      accounts and child OUs must first be removed.
    name: aws-org-organization-unit-delete
  - arguments:
    - description: The unique identifier (ID) of the OU to rename. This value can
        be retrieved by running the command "aws-org-parent-list".
      name: organizational_unit_id
      required: true
    - description: The new name to assign to the organizational unit.
      name: name
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Renames the specified organizational unit (OU). The ID and ARN don't
      change. The child OUs and accounts remain in place, and any attached policies
      of the OU remain attached.
    name: aws-org-organization-unit-rename
  - arguments:
    - auto: PREDEFINED
      description: Specifies the type of policy to include in the response.
      name: policy_type
      predefined:
      - Service Control Policy
      - Tag Policy
      - Backup Policy
      - AI Services Opt Out Policy
      required: true
    - defaultValue: "50"
      description: The number of policies to return.
      name: limit
    - description: The number of policies to return per page. The maximum is 1000.
      name: page_size
    - description: The token denoting the next page of policies, as given by the response
        of the previous run of this command under the context key "AWS.Organizations.PolicyNextToken".
      name: next_token
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Retrieves the list of all policies in an organization of a specified
      type.
    name: aws-org-policy-list
    outputs:
    - contextPath: AWS.Organizations.Policy.Id
      description: The unique identifier (ID) of the policy.
      type: String
    - contextPath: AWS.Organizations.Policy.Arn
      description: The Amazon Resource Name (ARN) of the policy.
      type: String
    - contextPath: AWS.Organizations.Policy.Name
      description: The friendly name of the policy.
      type: String
    - contextPath: AWS.Organizations.Policy.Description
      description: The description of the policy.
      type: String
    - contextPath: AWS.Organizations.Policy.Type
      description: The type of policy.
      type: String
    - contextPath: AWS.Organizations.Policy.AwsManaged
      description: Indicates whether the specified policy is an Amazon Web Services
        managed policy. If true, the policy can be attached to roots, organizational
        units, or accounts, but cannot be edited.
      type: Boolean
    - contextPath: AWS.Organizations.PolicyNextToken
      description: If not null, indicates that more output is available than is included
        in the current response. Use this value as the next_token argument in a subsequent
        call of the command to get the next part of the output.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: The type of policy to include in the returned list.
      name: policy_type
      predefined:
      - Service Control Policy
      - Tag Policy
      - Backup Policy
      - AI Services Opt Out Policy
      required: true
    - description: The unique identifier (ID) of the root, organizational unit, or
        account whose policies are to be listed.
      name: target_id
      required: true
    - defaultValue: "50"
      description: The number of policies to return.
      name: limit
    - description: The number of policies to return per page. The maximum is 1000.
      name: page_size
    - description: The token denoting the next page of policies, as given by the response
        of the previous run of this command under the context key "AWS.Organizations.PolicyNextToken".
      name: next_token
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Lists the policies that are directly attached to the specified target
      root, organizational unit (OU), or account.
    name: aws-org-target-policy-list
    outputs:
    - contextPath: AWS.Organizations.TargetPolicy.Id
      description: The unique identifier (ID) of the policy.
      type: String
    - contextPath: AWS.Organizations.TargetPolicy.Arn
      description: The Amazon Resource Name (ARN) of the policy.
      type: String
    - contextPath: AWS.Organizations.TargetPolicy.Name
      description: The friendly name of the policy.
      type: String
    - contextPath: AWS.Organizations.TargetPolicy.Description
      description: The description of the policy.
      type: String
    - contextPath: AWS.Organizations.TargetPolicy.Type
      description: The type of policy.
      type: String
    - contextPath: AWS.Organizations.TargetPolicy.AwsManaged
      description: Indicates whether the specified policy is an Amazon Web Services
        managed policy. If true, the policy can be attached to roots, organizational
        units, or accounts, but cannot be edited.
      type: Boolean
    - contextPath: AWS.Organizations.TargetId
      description: The unique identifier (ID) of the target.
      type: String
    - contextPath: AWS.Organizations.TargetPolicyNextToken
      description: If not null, indicates that more output is available than is included
        in the current response. Use this value as the next_token argument in a subsequent
        call of the command to get the next part of the output.
      type: String
  - arguments:
    - description: The unique identifier (ID) of the policy that you want details
        about. This value can be retrieved by running the command "aws-org-policy-list".
      name: policy_id
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Retrieves information about a policy.
    name: aws-org-policy-get
    outputs:
    - contextPath: AWS.Organizations.Policy.Id
      description: The unique identifier (ID) of the policy.
      type: String
    - contextPath: AWS.Organizations.Policy.Arn
      description: The Amazon Resource Name (ARN) of the policy.
      type: String
    - contextPath: AWS.Organizations.Policy.Name
      description: The friendly name of the policy.
      type: String
    - contextPath: AWS.Organizations.Policy.Description
      description: The description of the policy.
      type: String
    - contextPath: AWS.Organizations.Policy.Type
      description: The type of policy.
      type: String
    - contextPath: AWS.Organizations.Policy.AwsManaged
      description: Indicates whether the specified policy is an Amazon Web Services
        managed policy. If true, the policy can be attached to roots, organizational
        units, or accounts, but cannot be edited.
      type: Boolean
  - arguments:
    - description: The unique identifier (ID) of the policy that you want to delete.
        This value can be retrieved by running the command "aws-org-policy-list".
      name: policy_id
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Deletes the specified policy from the organization. Before performing
      this operation, the policy must be detached from all organizational units (OUs),
      roots, and accounts.
    name: aws-org-policy-delete
  - arguments:
    - description: The unique identifier (ID) of the policy to attach to the target.
        This value can be retrieved by running the command "aws-org-policy-list".
      name: policy_id
      required: true
    - description: The unique identifier (ID) of the root, organizational unit, or
        account to attach the policy to. This value can be retrieved by running the
        command "aws-org-root-list" or "aws-org-account-list".
      name: target_id
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Attaches a policy to a root, an organizational unit (OU), or an individual
      account.
    name: aws-org-policy-attach
  - arguments:
    - description: The unique identifier (ID) of the policy whose attachments are
        to be listed.
      name: policy_id
      required: true
    - defaultValue: "50"
      description: The number of policies to return.
      name: limit
    - description: The number of policies to return per page. The maximum is 1000.
      name: page_size
    - description: The token denoting the next page of policies, as given by the response
        of the previous run of this command under the context key "AWS.Organizations.PolicyTargetNextToken".
      name: next_token
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Lists all the roots, organizational units (OUs), and accounts that
      the specified policy is attached to.
    name: aws-org-policy-target-list
    outputs:
    - contextPath: AWS.Organizations.PolicyTarget.TargetId
      description: The unique identifier (ID) of the policy target.
      type: String
    - contextPath: AWS.Organizations.PolicyTarget.Arn
      description: The Amazon Resource Name (ARN) of the policy target.
      type: String
    - contextPath: AWS.Organizations.PolicyTarget.Name
      description: The friendly name of the policy target.
      type: String
    - contextPath: AWS.Organizations.PolicyTarget.Type
      description: The type of the policy target.
      type: String
    - contextPath: AWS.Organizations.PolicyTarget.PolicyId
      description: The unique identifier (ID) of the policy.
      type: String
    - contextPath: AWS.Organizations.PolicyTargetNextToken
      description: If not null, indicates that more output is available than is included
        in the current response. Use this value as the next_token argument in a subsequent
        call of the command to get the next part of the output.
      type: String
  - arguments:
    - description: The ID of the resource to add a tag to. This value can be retrieved
        by running the command "aws-org-root-list", "aws-org-account-list", "aws-org-root-list",
        or "aws-org-policy-list".
      name: resource_id
      required: true
    - description: 'A comma-separated list of tags to attach to the resource. Each
        tag should be in the format: "key=value".'
      isArray: true
      name: tags
      required: true
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Adds one or more tags to the specified resource.
    name: aws-org-resource-tag-add
  - arguments:
    - description: The ID of the resource with the tags to list. This value can be
        retrieved by running the command "aws-org-root-list", "aws-org-account-list",
        "aws-org-root-list" or "aws-org-policy-list".
      name: resource_id
      required: true
    - description: The token denoting the next page of tags, as given by the response
        of the previous run of this command under the context key "AWS.Organizations.TagNextToken".
      name: next_token
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    description: Lists tags that are attached to the specified resource.
    name: aws-org-resource-tag-list
    outputs:
    - contextPath: AWS.Organizations.Tag.Key
      description: The key identifier, or name, of the tag.
      type: String
    - contextPath: AWS.Organizations.Tag.Value
      description: The string value that's associated with the key of the tag.
      type: String
    - contextPath: AWS.Organizations.Tag.ResourceId
      description: The unique identifier (ID) of the resource.
      type: String
    - contextPath: AWS.Organizations.TagNextToken
      description: If not null, indicates that more output is available than is included
        in the current response. Use this value as the next_token argument in a subsequent
        call of the command to get the next part of the output.
      type: String
  dockerimage: demisto/boto3py3:1.0.0.84645
  runonce: false
  script: |
    register_module_line('AWS - Organizations', 'start', __line__())
    ### pack version: 1.0.2
    from typing import TYPE_CHECKING
    from collections.abc import Callable



    ### GENERATED CODE ###: from AWSApiModule import *
    # This code was inserted in place of an API module.
    register_module_line('AWSApiModule', 'start', __line__(), wrapper=-3)


    import boto3
    from botocore.config import Config


    def validate_params(aws_default_region, aws_role_arn, aws_role_session_name, aws_access_key_id, aws_secret_access_key):
        """
        Validates that the provided parameters are compatible with the appropriate authentication method.
        """
        if not aws_default_region:
            raise DemistoException('You must specify AWS default region.')

        if bool(aws_access_key_id) != bool(aws_secret_access_key):
            raise DemistoException('You must provide Access Key id and Secret key id to configure the instance with '
                                   'credentials.')
        if bool(aws_role_arn) != bool(aws_role_session_name):
            raise DemistoException('Role session name is required when using role ARN.')


    def extract_session_from_secret(secret_key, session_token):
        """
        Extract the session token from the secret_key field.
        """
        if secret_key and '@@@' in secret_key and not session_token:
            return secret_key.split('@@@')[0], secret_key.split('@@@')[1]
        else:
            return secret_key, session_token


    class AWSClient:

        def __init__(self, aws_default_region, aws_role_arn, aws_role_session_name, aws_role_session_duration,
                     aws_role_policy, aws_access_key_id, aws_secret_access_key, verify_certificate, timeout, retries,
                     aws_session_token=None, sts_endpoint_url=None, endpoint_url=None):

            self.sts_endpoint_url = sts_endpoint_url
            self.endpoint_url = endpoint_url
            self.aws_default_region = aws_default_region
            self.aws_role_arn = aws_role_arn
            self.aws_role_session_name = aws_role_session_name
            # handle cases where aws_role_session_duration can be also empty string
            self.aws_role_session_duration = aws_role_session_duration if aws_role_session_duration else None
            self.aws_role_policy = aws_role_policy
            self.aws_access_key_id = aws_access_key_id
            self.aws_secret_access_key, self.aws_session_token = extract_session_from_secret(aws_secret_access_key, aws_session_token)
            self.verify_certificate = verify_certificate

            sts_regional_endpoint = demisto.params().get("sts_regional_endpoint") or None
            if sts_regional_endpoint:
                demisto.debug(f"Sets the environment variable AWS_STS_REGIONAL_ENDPOINTS={sts_regional_endpoint}")
                os.environ["AWS_STS_REGIONAL_ENDPOINTS"] = sts_regional_endpoint.lower()

            proxies = handle_proxy(proxy_param_name='proxy', checkbox_default_value=False)
            (read_timeout, connect_timeout) = AWSClient.get_timeout(timeout)
            if int(retries) > 10:
                retries = 10
            self.config = Config(
                connect_timeout=connect_timeout,
                read_timeout=read_timeout,
                retries=dict(
                    max_attempts=int(retries)
                ),
                proxies=proxies
            )

        def update_config(self):
            command_config = {}
            retries = demisto.getArg('retries')  # Supports retries and timeout parameters on the command execution level
            if retries is not None:
                command_config['retries'] = dict(max_attempts=int(retries))
            timeout = demisto.getArg('timeout')
            if timeout is not None:
                (read_timeout, connect_timeout) = AWSClient.get_timeout(timeout)
                command_config['read_timeout'] = read_timeout
                command_config['connect_timeout'] = connect_timeout
            if retries or timeout:
                demisto.debug('Merging client config settings: {}'.format(command_config))
                self.config = self.config.merge(Config(**command_config))  # type: ignore[arg-type]

        def aws_session(self, service, region=None, role_arn=None, role_session_name=None, role_session_duration=None,
                        role_policy=None):
            kwargs = {}

            self.update_config()

            if role_arn and role_session_name is not None:
                kwargs.update({
                    'RoleArn': role_arn,
                    'RoleSessionName': role_session_name,
                })
            elif self.aws_role_arn and self.aws_role_session_name is not None:
                kwargs.update({
                    'RoleArn': self.aws_role_arn,
                    'RoleSessionName': self.aws_role_session_name,
                })

            if role_session_duration is not None:
                kwargs.update({'DurationSeconds': int(role_session_duration)})
            elif self.aws_role_session_duration is not None:
                kwargs.update({'DurationSeconds': int(self.aws_role_session_duration)})

            if role_policy is not None:
                kwargs.update({'Policy': role_policy})
            elif self.aws_role_policy is not None:
                kwargs.update({'Policy': self.aws_role_policy})

            demisto.debug('{kwargs}='.format(kwargs=kwargs))

            if kwargs and not self.aws_access_key_id:  # login with Role ARN
                if not self.aws_access_key_id:
                    sts_client = boto3.client('sts', config=self.config, verify=self.verify_certificate,
                                              region_name=region if region else self.aws_default_region,
                                              endpoint_url=self.sts_endpoint_url)
                    sts_response = sts_client.assume_role(**kwargs)
                    client = boto3.client(
                        service_name=service,
                        region_name=region if region else self.aws_default_region,
                        aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                        aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                        aws_session_token=sts_response['Credentials']['SessionToken'],
                        verify=self.verify_certificate,
                        config=self.config,
                        endpoint_url=self.endpoint_url
                    )
            elif self.aws_access_key_id and (role_arn or self.aws_role_arn):  # login with Access Key ID and Role ARN
                sts_client = boto3.client(
                    service_name='sts',
                    aws_access_key_id=self.aws_access_key_id,
                    aws_secret_access_key=self.aws_secret_access_key,
                    verify=self.verify_certificate,
                    config=self.config,
                    endpoint_url=self.sts_endpoint_url
                )
                kwargs.update({
                    'RoleArn': role_arn or self.aws_role_arn,
                    'RoleSessionName': role_session_name or self.aws_role_session_name,
                })
                sts_response = sts_client.assume_role(**kwargs)
                client = boto3.client(
                    service_name=service,
                    region_name=region if region else self.aws_default_region,
                    aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                    aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                    aws_session_token=sts_response['Credentials']['SessionToken'],
                    verify=self.verify_certificate,
                    config=self.config,
                    endpoint_url=self.endpoint_url
                )
            elif self.aws_session_token and not self.aws_role_arn:  # login with session token
                client = boto3.client(
                    service_name=service,
                    region_name=region if region else self.aws_default_region,
                    aws_access_key_id=self.aws_access_key_id,
                    aws_secret_access_key=self.aws_secret_access_key,
                    aws_session_token=self.aws_session_token,
                    verify=self.verify_certificate,
                    config=self.config,
                    endpoint_url=self.endpoint_url
                )
            elif self.aws_access_key_id and not self.aws_role_arn:  # login with access key id
                client = boto3.client(
                    service_name=service,
                    region_name=region if region else self.aws_default_region,
                    aws_access_key_id=self.aws_access_key_id,
                    aws_secret_access_key=self.aws_secret_access_key,
                    verify=self.verify_certificate,
                    config=self.config,
                    endpoint_url=self.endpoint_url
                )
            else:  # login with default permissions, permissions pulled from the ec2 metadata
                client = boto3.client(service_name=service,
                                      region_name=region if region else self.aws_default_region,
                                      endpoint_url=self.endpoint_url)

            return client

        @staticmethod
        def get_timeout(timeout):
            if not timeout:
                timeout = "60,10"  # default values
            try:

                if isinstance(timeout, int):
                    read_timeout = timeout
                    connect_timeout = 10

                else:
                    timeout_vals = timeout.split(',')
                    read_timeout = int(timeout_vals[0])
                    # the default connect timeout is 10
                    connect_timeout = 10 if len(timeout_vals) == 1 else int(timeout_vals[1])

            except ValueError:
                raise DemistoException("You can specify just the read timeout (for example 60) or also the connect "
                                       "timeout followed after a comma (for example 60,10). If a connect timeout is not "
                                       "specified, a default of 10 second will be used.")
            return read_timeout, connect_timeout

    register_module_line('AWSApiModule', 'end', __line__(), wrapper=1)
    ### END GENERATED CODE ###  # noqa

    # The following imports are used only for type hints and autocomplete.
    # They are not used at runtime, and are not in the docker image.
    if TYPE_CHECKING:
        from mypy_boto3_organizations import OrganizationsClient
        from mypy_boto3_organizations.literals import (
            PolicyTypeType,
            CreateAccountFailureReasonType
        )

    ''' CONSTANTS '''

    SERVICE_NAME = 'organizations'
    REGION = 'us-east-1'
    MAX_PAGINATION = 20
    POLICY_TYPE_MAP: dict[str, 'PolicyTypeType'] = {
        'Service Control Policy': 'SERVICE_CONTROL_POLICY',
        'Tag Policy': 'TAG_POLICY',
        'Backup Policy': 'BACKUP_POLICY',
        'AI Services Opt Out Policy': 'AISERVICES_OPT_OUT_POLICY'
    }
    CREATE_ACCOUNT_FAILURE_MAP: dict['CreateAccountFailureReasonType', str] = {
        "ACCOUNT_LIMIT_EXCEEDED":
            "The account couldn't be created because you reached the limit on the number of accounts in your organization.",
        "CONCURRENT_ACCOUNT_MODIFICATION":
            "You already submitted a request with the same information.",
        "EMAIL_ALREADY_EXISTS":
            "The account could not be created because another Amazon Web Services account with that email address already exists.",
        "FAILED_BUSINESS_VALIDATION":
            "The Amazon Web Services account that owns your organization failed to receive business license validation.",
        "GOVCLOUD_ACCOUNT_ALREADY_EXISTS":
            "The account in the Amazon Web Services GovCloud (US) Region could not be created because this"
            " Region already includes an account with that email address.",
        "INVALID_IDENTITY_FOR_BUSINESS_VALIDATION":
            "The Amazon Web Services account that owns your organization can't complete business license validation"
            "because it doesn't have valid identity data.",
        "INVALID_ADDRESS": "The account could not be created because the address you provided is not valid.",
        "INVALID_EMAIL": "The account could not be created because the email address you provided is not valid.",
        "INVALID_PAYMENT_INSTRUMENT":
            "The Amazon Web Services account that owns your organization does not have a "
            "supported payment method associated with the account.",
        "INTERNAL_FAILURE":
            "The account could not be created because of an internal failure. Try again later."
            " If the problem persists, contact Amazon Web Services Customer Support.",
        "MISSING_BUSINESS_VALIDATION":
            "The Amazon Web Services account that owns your organization has not received Business Validation.",
        "MISSING_PAYMENT_INSTRUMENT": "You must configure the management account with a valid payment method, such as a credit card.",
        "PENDING_BUSINESS_VALIDATION":
            "The Amazon Web Services account that owns your organization is still in the"
            " process of completing business license validation.",
        "UNKNOWN_BUSINESS_VALIDATION":
            "The Amazon Web Services account that owns your organization"
            " has an unknown issue with business license validation.",
    }

    ''' HELPER FUNCTIONS '''


    def create_client(args: dict, params: dict) -> 'OrganizationsClient':
        '''Creates the AWS Organizations client and initiates a session.'''

        aws_access_key_id = dict_safe_get(params, ('credentials', 'identifier'))
        aws_secret_access_key = dict_safe_get(params, ('credentials', 'password'))
        aws_default_region = REGION
        aws_role_arn = params.get('role_arn')
        aws_role_session_name = params.get('role_session_name')
        aws_role_session_duration = params.get('role_session_duration')
        aws_role_policy = None

        validate_params(
            aws_default_region,
            aws_role_arn,
            aws_role_session_name,
            aws_access_key_id,
            aws_secret_access_key,
        )

        return AWSClient(
            aws_default_region,
            aws_role_arn,
            aws_role_session_name,
            aws_role_session_duration,
            aws_role_policy,
            aws_access_key_id,
            aws_secret_access_key,
            not params.get('insecure', True),
            params.get('timeout'),
            params.get('retries')
        ).aws_session(
            service=SERVICE_NAME,
            region=REGION,
            role_arn=args.get('roleArn'),
            role_session_name=args.get('roleSessionName'),
            role_session_duration=args.get('roleSessionDuration'),
        )


    def paginate(
        client_func: Callable,
        key_to_pages: str, limit=None, page_size=None,
        next_token=None, **kwargs
    ) -> tuple[list, str | None]:
        '''This function exists because AWS doesn't guarantee that the client functions will
        return all results specified in a single call.
        This function also handles the XSOAR pagination conventions such as the limit, page_size and next_token args.
        '''

        if not page_size and not next_token:
            next_token = None
            page_size = limit
        page_size = arg_to_number(page_size) or 50
        pages: list = []

        while page_size:
            response: dict = client_func(
                **assign_params(NextToken=next_token),
                MaxResults=min(page_size, MAX_PAGINATION),
                **kwargs,
            )
            page = response.get(key_to_pages, [])
            next_token = response.get('NextToken')
            pages.extend(page)
            page_size -= len(page)
            if next_token is None:
                break

        return pages, next_token


    def next_token_output_dict(outputs_prefix: str, next_token: str | None, page_outputs: Any, page_outputs_key: str = 'Id') -> dict:
        """Creates a dict for CommandResults.output with the next token.
        """
        return {
            (f'AWS.Organizations.{outputs_prefix}(val.{page_outputs_key} && val.{page_outputs_key} == obj.{page_outputs_key})'):
                page_outputs,
            'AWS.Organizations(true)': {f'{outputs_prefix}NextToken': next_token},
        }


    def dict_values_to_str(d: dict, *keys) -> dict:
        '''Converts values in a dict to strings and returns the dict.
            Used mainly when a client function output contains a datetime.
        '''
        for key in keys:
            if key in d:
                d[key] = str(d[key])
        return d


    def build_tags(tags: str | None) -> list:
        '''Turns the tags provided by the args in the format "key=value" into the format expected by AWS'''
        result = []
        for tag in argToList(tags):
            key, eq, value = tag.partition('=')
            if not eq:
                raise DemistoException('Tags must be provided in the format "key=value".')
            result.append(
                {
                    'Key': key,
                    'Value': value
                }
            )
        return result


    ''' COMMAND FUNCTIONS '''


    def test_module(aws_client: 'OrganizationsClient') -> str:
        aws_client.describe_organization()
        return 'ok'


    def root_list_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        roots, next_token = paginate(
            aws_client.list_roots,
            'Roots',
            limit=args.get('limit'),
            next_token=args.get('next_token'),
            page_size=args.get('page_size'),
        )

        return CommandResults(
            outputs=next_token_output_dict(
                'Root', next_token, roots, 'Id',
            ),
            readable_output=tableToMarkdown(
                'AWS Organization Roots',
                roots, ['Id', 'Arn', 'Name'],
                removeNull=True,
            )
        )


    def children_list_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        children, next_token = paginate(
            aws_client.list_children,
            'Children',
            limit=args.get('limit'),
            next_token=args.get('next_token'),
            page_size=args.get('page_size'),
            ParentId=args['parent_id'],
            ChildType={  # type: ignore
                'Account': 'ACCOUNT',
                'OrganizationalUnit': 'ORGANIZATIONAL_UNIT',
            }[args['child_type']],
        )

        return CommandResults(
            outputs=next_token_output_dict(
                'Children',
                next_token,
                [
                    child | {'ParentId': args['parent_id']}
                    for child in children
                ],
                'Id',
            ),
            readable_output=tableToMarkdown(
                f'AWS Account *{args["parent_id"]}* Children',
                children, removeNull=True,
            )
        )


    def parent_list_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        parents, _ = paginate(
            aws_client.list_parents,
            'Parents',
            limit=1,  # at of the time of this writing, an account can have only one parent
            ChildId=args['child_id']
        )

        return CommandResults(
            outputs_key_field='Id',
            outputs_prefix='AWS.Organizations.Parent',
            outputs=[
                parent | {'ChildId': args['child_id']}
                for parent in parents
            ],
            readable_output=tableToMarkdown(
                f'AWS Account *{args["child_id"]}* Parent',
                parents, removeNull=True,
            )
        )


    def organization_unit_get_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        ou = aws_client.describe_organizational_unit(
            OrganizationalUnitId=args['organization_unit_id']
        )

        return CommandResults(
            outputs_key_field='Id',
            outputs_prefix='AWS.Organizations.OrganizationUnit',
            outputs=ou.get('OrganizationalUnit', {}),
            readable_output=tableToMarkdown(
                'AWS Organization Unit',
                ou.get('OrganizationalUnit', {}),
                ['Id', 'Arn', 'Name'],
                removeNull=True,
            )
        )


    def account_list_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        def response_to_readable(accounts) -> str:
            return tableToMarkdown(
                'AWS Organization Accounts',
                accounts,
                [
                    'Id', 'Arn', 'Name', 'Email',
                    'JoinedMethod', 'JoinedTimestamp', 'Status',
                ],
                removeNull=True
            )

        def account_get() -> CommandResults:

            description = aws_client.describe_account(
                AccountId=args['account_id']
            )

            account = dict_values_to_str(
                description.get('Account', {}),
                'JoinedTimestamp'
            )

            return CommandResults(
                readable_output=response_to_readable(account),
                outputs_key_field='Id',
                outputs_prefix='AWS.Organizations.Account',
                outputs=account,
            )

        def account_list() -> CommandResults:

            accounts, next_token = paginate(
                aws_client.list_accounts,
                'Accounts',
                limit=args.get('limit'),
                next_token=args.get('next_token'),
                page_size=args.get('page_size'),
            )

            accounts = [
                dict_values_to_str(account, 'JoinedTimestamp')
                for account in accounts
            ]

            return CommandResults(
                outputs=next_token_output_dict(
                    'Account', next_token, accounts, 'Id',
                ),
                readable_output=response_to_readable(accounts)
            )

        if args.get('account_id'):
            return account_get()
        else:
            return account_list()


    def organization_get_command(aws_client: 'OrganizationsClient') -> CommandResults:

        organization = aws_client.describe_organization()

        return CommandResults(
            outputs=organization.get('Organization', {}),
            outputs_prefix='AWS.Organizations.Organization',
            outputs_key_field='Id',
            readable_output=tableToMarkdown(
                'AWS Organization',
                organization.get('Organization', {}),
                [
                    'Id', 'Arn', 'FeatureSet', 'MasterAccountArn',
                    'MasterAccountId', 'MasterAccountEmail'
                ],
                removeNull=True
            )
        )


    def account_remove_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        aws_client.remove_account_from_organization(
            AccountId=args['account_id']
        )

        return CommandResults(
            readable_output=f'AWS account *{args["account_id"]}* removed successfully.'
        )


    def account_move_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        aws_client.move_account(
            AccountId=args['account_id'],
            SourceParentId=args['source_parent_id'],
            DestinationParentId=args['destination_parent_id'],
        )

        return CommandResults(
            readable_output=f'AWS account *{args["account_id"]}* moved successfully.'
        )


    @polling_function(
        'aws-org-account-create',
        interval=arg_to_number(demisto.getArg('interval_in_seconds')),
        timeout=arg_to_number(demisto.getArg('timeout')),
        poll_message='Creating account:',
        requires_polling_arg=False
    )
    def account_create_command(args: dict, aws_client: 'OrganizationsClient') -> PollResult:

        def initial_call() -> dict:
            account = aws_client.create_account(
                Email=args['email'],
                AccountName=args['account_name'],
                RoleName=args['role_name'],
                IamUserAccessToBilling=args['iam_user_access_to_billing'].upper(),
                **assign_params(Tags=build_tags(args.get('tags')))
            )
            args['request_id'] = account['CreateAccountStatus']['Id']
            return account['CreateAccountStatus']

        def polling_call() -> dict:
            account = aws_client.describe_create_account_status(
                CreateAccountRequestId=args['request_id']
            )
            return account['CreateAccountStatus']

        def create_response(account: dict) -> PollResult:

            match account['State']:
                case 'SUCCEEDED':
                    return PollResult(
                        response=account_list_command(
                            {'account_id': account['AccountId']},
                            aws_client
                        ),
                        continue_to_poll=False
                    )
                case 'FAILED':
                    reason = account.get('FailureReason')
                    raise DemistoException(f'Failed to create account. Reason: {CREATE_ACCOUNT_FAILURE_MAP.get(reason, reason)}')
                case _:
                    return PollResult(
                        response=None,
                        continue_to_poll=True
                    )

        if not args.get('request_id'):
            account = initial_call()
        else:
            account = polling_call()

        return create_response(account)


    @polling_function(
        'aws-org-account-close',
        interval=arg_to_number(demisto.getArg('interval_in_seconds')),
        timeout=arg_to_number(demisto.getArg('timeout')),
        poll_message='Closing account:',
        requires_polling_arg=False
    )
    def account_close_command(args: dict, aws_client: 'OrganizationsClient') -> PollResult:

        if not argToBoolean(args['is_closed']):
            aws_client.close_account(
                AccountId=args['account_id']
            )
            args['is_closed'] = True

        account = aws_client.describe_account(
            AccountId=args['account_id']
        )

        return PollResult(
            response=CommandResults(
                readable_output=f'AWS account *{args["account_id"]}* closed successfully.'
            ),
            continue_to_poll=(dict_safe_get(account, ['Account', 'Status']) != 'SUSPENDED'),
        )


    def organization_unit_create_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        ou = aws_client.create_organizational_unit(
            ParentId=args['parent_id'],
            Name=args['name'],
            **assign_params(Tags=build_tags(args.get('tags')))
        )

        return CommandResults(
            outputs_prefix='AWS.Organizations.OrganizationUnit',
            outputs_key_field='Id',
            outputs=ou['OrganizationalUnit'],
            readable_output=tableToMarkdown(
                'AWS Organization Unit',
                ou['OrganizationalUnit'],
                ['Id', 'Name', 'Arn'],
                removeNull=True
            )
        )


    def organization_unit_delete_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        aws_client.delete_organizational_unit(
            OrganizationalUnitId=args['organizational_unit_id']
        )

        return CommandResults(
            readable_output=f'AWS organizational unit *{args["organizational_unit_id"]}* deleted successfully.'
        )


    def organization_unit_rename_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        aws_client.update_organizational_unit(
            OrganizationalUnitId=args['organizational_unit_id'],
            Name=args['name']
        )

        return CommandResults(
            readable_output=f'AWS organization unit *{args["organizational_unit_id"]}* successfully renamed to *{args["name"]}*.'
        )


    def policy_list_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        policies, next_token = paginate(
            aws_client.list_policies,
            'Policies',
            limit=args.get('limit'),
            next_token=args.get('next_token'),
            page_size=args.get('page_size'),
            Filter=POLICY_TYPE_MAP[args['policy_type']]
        )

        return CommandResults(
            outputs=next_token_output_dict(
                'Policy', next_token, policies,
            ),
            readable_output=tableToMarkdown(
                'AWS Organization Policies',
                policies,
                [
                    'Id', 'Arn', 'Name',
                    'Description', 'Type', 'AwsManaged'
                ],
                removeNull=True,
            )
        )


    def target_policy_list_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        policies, next_token = paginate(
            aws_client.list_policies_for_target,
            'Policies',
            limit=args.get('limit'),
            next_token=args.get('next_token'),
            page_size=args.get('page_size'),
            TargetId=args['target_id'],
            Filter=POLICY_TYPE_MAP[args['policy_type']]
        )

        return CommandResults(
            outputs=next_token_output_dict(
                'TargetPolicy',
                next_token,
                [
                    policy | {'TargetId': args['target_id']}
                    for policy in policies
                ],
            ),
            readable_output=tableToMarkdown(
                f'AWS Organization *{args["target_id"]}* Policies',
                policies,
                [
                    'Id', 'Arn', 'Name',
                    'Description', 'Type', 'AwsManaged'
                ],
                removeNull=True,
            )
        )


    def policy_get_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        response = aws_client.describe_policy(
            PolicyId=args['policy_id']
        )

        policy = dict_safe_get(response, ['Policy', 'PolicySummary'])

        return CommandResults(
            raw_response=response,
            outputs=policy,
            outputs_key_field='Id',
            outputs_prefix='AWS.Organizations.Policy',
            readable_output=tableToMarkdown(
                'AWS Organization Policies',
                policy,
                [
                    'Id', 'Arn', 'Name',
                    'Description', 'Type', 'AwsManaged'
                ],
                removeNull=True,
            )
        )


    def policy_delete_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        aws_client.delete_policy(
            PolicyId=args['policy_id']
        )

        return CommandResults(
            readable_output=f'AWS Organizations policy *{args["policy_id"]}* successfully deleted.'
        )


    def policy_attach_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        aws_client.attach_policy(
            PolicyId=args['policy_id'],
            TargetId=args['target_id']
        )

        return CommandResults(
            readable_output=f'AWS Organizations policy *{args["policy_id"]}* successfully attached.'
        )


    def policy_target_list_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        targets, next_token = paginate(
            aws_client.list_targets_for_policy,
            'Targets',
            limit=args.get('limit'),
            next_token=args.get('next_token'),
            page_size=args.get('page_size'),
            PolicyId=args['policy_id']
        )

        return CommandResults(
            outputs=next_token_output_dict(
                'PolicyTarget',
                next_token,
                [
                    target | {'PolicyId': args['policy_id']}
                    for target in targets
                ],
                'TargetId'
            ),
            readable_output=tableToMarkdown(
                f'AWS Organization *{args["policy_id"]}* Targets',
                targets,
                ['TargetId', 'Arn', 'Name', 'Type'],
                removeNull=True
            )
        )


    def resource_tag_add_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        aws_client.tag_resource(
            ResourceId=args['resource_id'],
            Tags=build_tags(args['tags'])
        )

        return CommandResults(
            readable_output=f'AWS Organizations resource *{args["resource_id"]}* successfully tagged.'
        )


    def resource_tag_list_command(args: dict, aws_client: 'OrganizationsClient') -> CommandResults:

        tags = aws_client.list_tags_for_resource(
            ResourceId=args['resource_id'],
            **assign_params(NextToken=args.get('next_token'))
        )

        return CommandResults(
            outputs=next_token_output_dict(
                'Tag',
                tags.get('NextToken'),
                [
                    tag | {'ResourceId': args['resource_id']}
                    for tag in tags.get('Tags', [])
                ],
                'Key'
            ),
            readable_output=tableToMarkdown(
                f'AWS Organization *{args["resource_id"]}* Tags',
                tags.get('Tags', []), ['Key', 'Value'],
            )
        )


    ''' MAIN FUNCTION '''


    def main():

        command = demisto.command()
        params = demisto.params()
        args = demisto.args()

        aws_client = create_client(args, params)

        demisto.debug(f'Command being called is {command}')

        try:
            if command == 'test-module':
                return_results(test_module(aws_client))
            elif command == 'aws-org-root-list':
                return_results(root_list_command(args, aws_client))
            elif command == 'aws-org-children-list':
                return_results(children_list_command(args, aws_client))
            elif command == 'aws-org-parent-list':
                return_results(parent_list_command(args, aws_client))
            elif command == 'aws-org-organization-unit-get':
                return_results(organization_unit_get_command(args, aws_client))
            elif command == 'aws-org-account-list':
                return_results(account_list_command(args, aws_client))
            elif command == 'aws-org-organization-get':
                return_results(organization_get_command(aws_client))
            elif command == 'aws-org-account-remove':
                return_results(account_remove_command(args, aws_client))
            elif command == 'aws-org-account-move':
                return_results(account_move_command(args, aws_client))
            elif command == 'aws-org-account-create':
                return_results(account_create_command(args, aws_client))
            elif command == 'aws-org-account-close':
                return_results(account_close_command(args, aws_client))
            elif command == 'aws-org-organization-unit-create':
                return_results(organization_unit_create_command(args, aws_client))
            elif command == 'aws-org-organization-unit-delete':
                return_results(organization_unit_delete_command(args, aws_client))
            elif command == 'aws-org-organization-unit-rename':
                return_results(organization_unit_rename_command(args, aws_client))
            elif command == 'aws-org-policy-list':
                return_results(policy_list_command(args, aws_client))
            elif command == 'aws-org-target-policy-list':
                return_results(target_policy_list_command(args, aws_client))
            elif command == 'aws-org-policy-get':
                return_results(policy_get_command(args, aws_client))
            elif command == 'aws-org-policy-delete':
                return_results(policy_delete_command(args, aws_client))
            elif command == 'aws-org-policy-attach':
                return_results(policy_attach_command(args, aws_client))
            elif command == 'aws-org-policy-target-list':
                return_results(policy_target_list_command(args, aws_client))
            elif command == 'aws-org-resource-tag-add':
                return_results(resource_tag_add_command(args, aws_client))
            elif command == 'aws-org-resource-tag-list':
                return_results(resource_tag_list_command(args, aws_client))
            else:
                raise NotImplementedError(f'AWS-Organizations error: command {command!r} is not implemented')

        except Exception as error:
            demisto.debug(f'{error.args=}')
            return_error(f'Failed to execute {command!r}.\n{error}')


    ''' ENTRY POINT '''

    if __name__ in ('__main__', '__builtin__', 'builtins'):  # pragma: no cover
        main()

    register_module_line('AWS - Organizations', 'end', __line__())
  subtype: python3
  type: python
system: true
