contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: b3d1ecc4-8713-42f2-8d79-00287a09a048
inputs: []
name: TCS-Tor communication report v1.1
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d0e8360e-c931-4578-83ef-bd2144121ece
      iscommand: false
      name: ""
      version: -1
    taskid: d0e8360e-c931-4578-83ef-bd2144121ece
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 70,
          "y": -580
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a2117820-58f6-4039-83f1-c960ecbac45e
      iscommand: false
      name: Are there any extracted indicators?
      type: condition
      version: -1
    taskid: a2117820-58f6-4039-83f1-c960ecbac45e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 70,
          "y": -50
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      column:
        simple: F
      entryID:
        complex:
          accessor: EntryID
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Extracts indicators only from specific columns within an excel
        with single sheet
      id: 4d6563ab-4856-4216-8bb7-26c7d8b4dadb
      iscommand: false
      name: Extract Indicators from the Source IP column of the report
      script: 70947ac9-0b08-4a10-8af4-e41a568e1e80
      type: regular
      version: -1
    taskid: 4d6563ab-4856-4216-8bb7-26c7d8b4dadb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": -230
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.IP
          operator: greaterThanOrEqual
          right:
            value:
              simple: "65"
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 03b4f42f-76d6-4546-8dcc-a8acfa16514d
      iscommand: false
      name: Are There Any IoCs With Risk Score > 65
      type: condition
      version: -1
    taskid: 03b4f42f-76d6-4546-8dcc-a8acfa16514d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -160,
          "y": 320
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: RecordedFuture.IP.riskScore
          operator: lessThanOrEqual
          right:
            value:
              simple: "64"
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d11b34ec-35a2-4ded-892a-e3d4bea1dcae
      iscommand: false
      name: ' IoCs With Risk Score < 65'
      type: condition
      version: -1
    taskid: d11b34ec-35a2-4ded-892a-e3d4bea1dcae
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 350,
          "y": 320
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RiskScorebelow65
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.IP.riskScore
              operator: lessThanOrEqual
              right:
                value:
                  simple: "64"
          root: RecordedFuture.IP.riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f51b19ec-434d-4129-8fdf-e10ca88399c1
      iscommand: false
      name: Set IOC less Than 65 To Context
      script: Set
      type: regular
      version: -1
    taskid: f51b19ec-434d-4129-8fdf-e10ca88399c1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 490
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 2
    scriptarguments:
      csvArray:
        simple: $RiskScorebelow65}
      fileName:
        simple: IOC_below_64_RiskScore.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 4b761d13-bf60-401f-8c3d-116fc3cf1eb2
      iscommand: false
      name: Create Risk Score Report less than 65
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 4b761d13-bf60-401f-8c3d-116fc3cf1eb2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 670
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: db30f0eb-9a94-4d72-8c3d-3651772e1601
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: db30f0eb-9a94-4d72-8c3d-3651772e1601
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1790
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "7"
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ca5e1645-7b8a-4e98-8e6f-6dccb354f70f
      iscommand: false
      name: TCS-Recorded Future IP Reputation_v2.1_WIP
      playbookId: 568f580b-75f1-446e-83cf-fcda64e1f791
      type: playbook
      version: -1
    taskid: ca5e1645-7b8a-4e98-8e6f-6dccb354f70f
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 70,
          "y": 130
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${SIXFIVE.IP}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 82556fc7-2f40-4804-88e0-824728bd2aa3
      iscommand: false
      name: TCS-Blacklist Report CyberSOC_Shared IOC Above RiskScore 65 v3.0_KK_WIP
      playbookId: 0145ce32-f60e-409a-89b4-ee2311a9ac51
      type: playbook
      version: -1
    taskid: 82556fc7-2f40-4804-88e0-824728bd2aa3
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -160,
          "y": 520
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${RiskScorebelow65}
      contextKey:
        simple: BelowIP64
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: 19530312-433b-4114-819a-8aa50d5ebfd0
      iscommand: false
      name: Create the IP in array format
      script: CreateArray
      type: regular
      version: -1
    taskid: 19530312-433b-4114-819a-8aa50d5ebfd0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 840
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        complex:
          root: BelowIP64
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c3b694d9-7298-4357-8b0f-2b399e88059a
      iscommand: false
      name: TCS-Subplaybook for Report autoassign_WIP
      playbookId: 8ff40011-bd19-434c-8bb6-c46741b161b9
      type: playbook
      version: -1
    taskid: c3b694d9-7298-4357-8b0f-2b399e88059a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 350,
          "y": 1540
        }
      }
  "21":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: owner
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ed38250d-cddd-4c5c-80bf-49a5c14508ae
      iscommand: false
      name: Is Owner Assigned ?
      type: condition
      version: -1
    taskid: ed38250d-cddd-4c5c-80bf-49a5c14508ae
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 70,
          "y": -410
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get the Server URL.
      id: 632fcfcf-58bc-446f-81fe-0f5d59a7b8ce
      iscommand: false
      name: Get server URL
      script: GetServerURL
      type: regular
      version: -1
    taskid: 632fcfcf-58bc-446f-81fe-0f5d59a7b8ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 1020
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: incidentlink
      value:
        simple: https://${ServerURL.Host}/#/Custom/caseinfoid/${incident.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 63cf889b-4bf7-4f33-81dd-5126b7faf4e0
      iscommand: false
      name: Set Server link In Context
      script: Set
      type: regular
      version: -1
    taskid: 63cf889b-4bf7-4f33-81dd-5126b7faf4e0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 1200
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      incidentlink:
        simple: ${incidentlink}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: b6cd250c-fb56-4a4b-8c1b-c1ee749e1624
      iscommand: true
      name: Set Incident Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: b6cd250c-fb56-4a4b-8c1b-c1ee749e1624
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 1370
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2435,
        "width": 890,
        "x": -160,
        "y": -580
      }
    }
  }
