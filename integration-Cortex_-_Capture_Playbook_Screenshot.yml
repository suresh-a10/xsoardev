category: Utilities
commonfields:
  id: Cortex - Capture Playbook Screenshot
  version: -1
configuration:
- defaultvalue: "false"
  display: Return Errors
  name: with_error
  required: false
  type: 8
- defaultvalue: "0"
  display: Time to wait before taking a screen shot (in seconds)
  name: wait_time
  required: false
  type: 0
- defaultvalue: "180"
  display: Maximum time to wait for a page to load (in seconds)
  name: max_page_load_time
  required: false
  type: 0
- display: Chrome options (Advanced. See [?])
  name: chrome_options
  required: false
  type: 0
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- defaultvalue: https://localhost
  display: ""
  name: server
  required: true
  type: 0
- display: Username
  displaypassword: Password
  name: user
  required: false
  type: 9
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: Cortex - Generate Playbook Documentation
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: This integration captures playbook screenshot and returns an image in
  context
detaileddescription: |-
  ## Cortex - Capture Playbook Screenshot
  Capture playbook image seamlessly using this integration. This playbook is a modified version of rasterize integration.

  **Security Note:**
  If you are using the integration to rasterize un-trusted URLs or HTML content, such as those obtained via external emails, we recommend following the instructions at the [Docker Network Hardening](https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/docker/docker-hardening-guide/docker-network-hardening.html) under the Block Internal Network Access section.


  **Configuration Notes:**
  * Return Errors: If this checkbox is not selected, a warning will be returned instead of an error entry.
  * Use system proxy settings: Select this checkbox to use the system's proxy settings. **Important**: this integration does not support proxies which require authentication.
  * Chrome options: Add or remove Chrome options used to rasterize. Supports a comma-separated list. If a value contains a comma (for example, when setting the user agent value), escape it with the backslash (**\\**) character. To remove a default option being used, put the option in square brackets. For example, to add the option *--disable-auto-reload* and remove the option *--disable-dev-shm-usage*, set the following value:
  ```
  --disable-auto-reload,[--disable-dev-shm-usage]
  ```


  ---
  [View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/rasterize)
display: Cortex - Capture Playbook Screenshot
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABQAAAADwCAYAAABfTslJAAAEEmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTYzODU4LCAyMDE5LzAzLzA2LTAzOjE4OjM2ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6ZGFtPSJodHRwOi8vd3d3LmRheS5jb20vZGFtLzEuMCIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICBkYW06UGh5c2ljYWxoZWlnaHRpbmluY2hlcz0iMy4zMzQwOTI4NTU0NTM0OTEiCiAgIGRhbTpQaHlzaWNhbHdpZHRoaW5pbmNoZXM9IjE3Ljc4MTgyNzkyNjYzNTc0MiIKICAgZGFtOkZpbGVmb3JtYXQ9IlBORyIKICAgZGFtOlByb2dyZXNzaXZlPSJubyIKICAgZGFtOmV4dHJhY3RlZD0iMjAyMS0wNi0xN1QwMDoxNDozNC40MTUtMDc6MDAiCiAgIGRhbTpCaXRzcGVycGl4ZWw9IjMyIgogICBkYW06TUlNRXR5cGU9ImltYWdlL3BuZyIKICAgZGFtOlBoeXNpY2Fsd2lkdGhpbmRwaT0iNzIiCiAgIGRhbTpQaHlzaWNhbGhlaWdodGluZHBpPSI3MiIKICAgZGFtOk51bWJlcm9maW1hZ2VzPSIxIgogICBkYW06TnVtYmVyb2Z0ZXh0dWFsY29tbWVudHM9IjAiCiAgIGRhbTpzaGExPSJlYzVjNmQ1YzIwOTM1NTUyOTk3OTcwYTVkYzkzYWU2ZGIzYWNmYjQ0IgogICBkYW06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
name: Cortex - Capture Playbook Screenshot
script:
  commands:
  - arguments:
    - description: Time in seconds to wait before taking a screenshot
      name: wait_time
    - description: Maximum time to wait for a page to load (in seconds)
      name: max_page_load_time
    - defaultValue: 1920px
      description: The page width, for example, 1024px. Specify with or without the
        px suffix.
      name: width
    - defaultValue: 1080px
      description: The page height, for example, 800px. Specify with or without the
        px suffix.
      name: height
    - auto: PREDEFINED
      description: The file type to which to convert the contents of the URL. Can
        be "pdf" or "png". Default is "png".
      name: type
      predefined:
      - pdf
      - png
      - json
    - description: The name the file will be saved as.
      name: file_name
    - description: Exact name of the playbook for which screenshot should be caputred
      name: playbook_name
    description: Converts the contents of a URL to an image file or a PDF file.
    name: cortex-capture-playbook-screenshot
  dockerimage: demisto/chromium:1.0.0.30170
  runonce: false
  script: |
    from selenium import webdriver
    from selenium.common.exceptions import NoSuchElementException, InvalidArgumentException, TimeoutException
    from selenium.webdriver.common.keys import Keys
    from selenium.webdriver.common.by import By
    from PyPDF2 import PdfFileReader
    from pdf2image import convert_from_path
    import numpy as np
    from PIL import Image
    import tempfile
    from io import BytesIO
    import base64
    import time
    import subprocess
    import traceback
    import re
    import os

    # Chrome respects proxy env params
    handle_proxy()
    # Make sure our python code doesn't go through a proxy when communicating with chrome webdriver
    os.environ['no_proxy'] = 'localhost,127.0.0.1'

    WITH_ERRORS = demisto.params().get('with_error', True)
    DEFAULT_WAIT_TIME = max(int(demisto.params().get('wait_time', 0)), 0)
    DEFAULT_PAGE_LOAD_TIME = int(demisto.params().get('max_page_load_time', 180))

    URL_ERROR_MSG = "Can't access the URL. It might be malicious, or unreachable for one of several reasons. " \
                    "You can choose to receive this message as error/warning in the instance settings\n"
    EMPTY_RESPONSE_ERROR_MSG = "There is nothing to render. This can occur when there is a refused connection." \
                               " Please check your URL."
    DEFAULT_W, DEFAULT_H = '1920', '1080'
    DEFAULT_W_WIDE = '1920'
    CHROME_USER_AGENT = 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.164 Safari/537.36'  # noqa
    DRIVER_LOG = f'{tempfile.gettempdir()}/chromedriver.log'
    DEFAULT_CHROME_OPTIONS = [
        '--no-sandbox',
        '--headless',
        '--disable-gpu',
        '--hide-scrollbars',
        '--disable_infobars',
        '--start-maximized',
        '--start-fullscreen',
        '--ignore-certificate-errors',
        '--disable-dev-shm-usage',
        f'--user-agent={CHROME_USER_AGENT}'
    ]

    USER_CHROME_OPTIONS = demisto.params().get('chrome_options', "")
    PAGES_LIMITATION = 20


    def return_err_or_warn(msg):
        return_error(msg) if WITH_ERRORS else return_warning(msg, exit=True)


    def opt_name(opt):
        return opt.split('=', 1)[0]


    def merge_options(default_options, user_options):
        """merge the defualt options and user options

        Arguments:
            default_options {list} -- list of options to use
            user_options {string} -- user configured options comma seperated (comma value can be escaped with \\)

        Returns:
            list -- merged options
        """
        user_options = re.split(r'(?<!\\),', user_options) if user_options else list()
        if not user_options:  # nothing to do
            return default_options
        demisto.debug(f'user chrome options: {user_options}')
        options = []
        remove_opts = []
        for opt in user_options:
            opt = opt.strip()
            if opt.startswith('[') and opt.endswith(']'):
                remove_opts.append(opt[1:-1])
            else:
                options.append(opt.replace(r'\,', ','))
        # remove values (such as in user-agent)
        option_names = [opt_name(x) for x in options]
        # add filtered defaults only if not in removed and we don't have it already
        options.extend([x for x in default_options if (opt_name(x) not in remove_opts and opt_name(x) not in option_names)])
        return options


    def check_response(driver):
        EMPTY_PAGE = '<html><head></head><body></body></html>'
        if driver.page_source == EMPTY_PAGE:
            return_err_or_warn(EMPTY_RESPONSE_ERROR_MSG)


    def init_driver(offline_mode=False):
        """
        Creates headless Google Chrome Web Driver
        """
        demisto.debug(f'Creating chrome driver. Mode: {"OFFLINE" if offline_mode else "ONLINE"}')
        try:
            chrome_options = webdriver.ChromeOptions()
            for opt in merge_options(DEFAULT_CHROME_OPTIONS, USER_CHROME_OPTIONS):
                chrome_options.add_argument(opt)
            driver = webdriver.Chrome(options=chrome_options, service_args=[
                f'--log-path={DRIVER_LOG}',
            ])
            if offline_mode:
                driver.set_network_conditions(offline=True, latency=5, throughput=500 * 1024)
        except Exception as ex:
            return_error(f'Unexpected exception: {ex}\nTrace:{traceback.format_exc()}')

        demisto.debug('Creating chrome driver - COMPLETED')
        return driver


    def find_zombie_processes():
        """find zombie proceses
        Returns:
            ([process ids], raw ps output) -- return a tuple of zombie process ids and raw ps output
        """
        ps_out = subprocess.check_output(['ps', '-e', '-o', 'pid,ppid,state,stime,cmd'],
                                         stderr=subprocess.STDOUT, universal_newlines=True)
        lines = ps_out.splitlines()
        pid = str(os.getpid())
        zombies = []
        if len(lines) > 1:
            for line in lines[1:]:
                pinfo = line.split()
                if pinfo[2] == 'Z' and pinfo[1] == pid:  # zombie process
                    zombies.append(pinfo[0])
        return zombies, ps_out


    def quit_driver_and_reap_children(driver):
        """
        Quits the driver's session and reaps all of zombie child processes
        :param driver: The driver
        :return: None
        """
        demisto.debug(f'Quitting driver session: {driver.session_id}')
        driver.quit()
        try:
            zombies, ps_out = find_zombie_processes()
            if zombies:
                demisto.info(f'Found zombie processes will waitpid: {ps_out}')
                for pid in zombies:
                    waitres = os.waitpid(int(pid), os.WNOHANG)[1]
                    demisto.info(f'waitpid result: {waitres}')
            else:
                demisto.debug(f'No zombie processes found for ps output: {ps_out}')
        except Exception as e:
            demisto.error(f'Failed checking for zombie processes: {e}. Trace: {traceback.format_exc()}')


    def get_image(driver, width: int, height: int):
        """
        Uses the Chrome driver to generate an image out of a currently loaded path
        :return: .png file of the loaded path
        """
        demisto.debug('Capturing screenshot')

        # Set windows size
        driver.set_window_size(width, height)

        image = driver.get_screenshot_as_png()

        demisto.debug('Capturing screenshot - COMPLETED')

        return image

    def capture_playbook(driver, playbook_name):
        root = demisto.params().get("server")
        driver.get(f"{root}/#/login")
        username = driver.find_element(By.NAME,"user")
        password = driver.find_element(By.NAME,"password")
        user = demisto.params().get("user").get("identifier")
        passwd = demisto.params().get("user").get("password")
        username.send_keys(user)
        password.send_keys(passwd)
        driver.find_element(By.CLASS_NAME,"login-button").click()
        time.sleep(10)
        #print(base64.b64encode(get_image(driver, 1920, 1080)).decode('utf8'))
        driver.find_element(By.CLASS_NAME,"icon-menu-playbooks-24-r").click()
        time.sleep(2)
        search = driver.find_element(By.NAME,"search")
        search.clear()
        search.send_keys(playbook_name)
        driver.find_element(By.CLASS_NAME,"demisto-search-icon").click()
        driver.find_element(By.CLASS_NAME,"playbook-full-view-link").click()
        time.sleep(2)
        return driver



    def rasterize(width: int, height: int, r_type: str = 'png', wait_time: int = 0,
                  offline_mode: bool = False, max_page_load_time: int = 180, playbook_name:str = "Default"):
        """
        Capturing a snapshot of a path (url/file), using Chrome Driver
        :param offline_mode: when set to True, will block any outgoing communication
        :param path: file path, or website url
        :param width: desired snapshot width in pixels
        :param height: desired snapshot height in pixels
        :param r_type: result type: .png/.pdf
        :param wait_time: time in seconds to wait before taking a screenshot
        """
        driver = init_driver(offline_mode)
        page_load_time = max_page_load_time if max_page_load_time > 0 else DEFAULT_PAGE_LOAD_TIME
        try:
            demisto.debug(f'Capturing playbook: {playbook_name}. Mode: {"OFFLINE" if offline_mode else "ONLINE"}. page load: {page_load_time}')
            driver.set_page_load_timeout(page_load_time)
            #driver.get(path)
            driver = capture_playbook(driver, playbook_name)
            driver.implicitly_wait(5)
            if wait_time > 0 or DEFAULT_WAIT_TIME > 0:
                time.sleep(wait_time or DEFAULT_WAIT_TIME)
            check_response(driver)
            demisto.debug('Navigating to path - COMPLETED')
            if r_type.lower() == 'json':
                html = driver.page_source
                url = driver.current_url
                output = {'image_b64': base64.b64encode(get_image(driver, width, height)).decode('utf8'), 'current_url': url, "playbook_name":playbook_name}
            else:
                output = get_image(driver, width, height)
            return output

        except (InvalidArgumentException, NoSuchElementException) as ex:
            if 'invalid argument' in str(ex):
                err_msg = URL_ERROR_MSG + str(ex)
                return_err_or_warn(err_msg)
            else:
                return_err_or_warn(f'Invalid exception: {ex}\nTrace:{traceback.format_exc()}')
        except TimeoutException as ex:
            return_err_or_warn(f'Timeout exception with max load time of: {page_load_time} seconds. {ex}')
        except Exception as ex:
            err_str = f'General error: {ex}\nTrace:{traceback.format_exc()}'
            demisto.error(err_str)
            return_err_or_warn(err_str)
        finally:
            quit_driver_and_reap_children(driver)


    def rasterize_command():
        w = demisto.args().get('width', DEFAULT_W_WIDE).rstrip('px')
        h = demisto.args().get('height', DEFAULT_H).rstrip('px')
        r_type = demisto.args().get('type', 'png')
        playbook_name = demisto.args().get('playbook_name')
        wait_time = int(demisto.args().get('wait_time', 0))
        page_load = int(demisto.args().get('max_page_load_time', DEFAULT_PAGE_LOAD_TIME))
        file_name = demisto.args().get('file_name', f"{playbook_name}")

        file_name = f'{file_name}.{"pdf" if r_type == "pdf" else "png"}'  # type: ignore

        output = rasterize(r_type=r_type, width=w, height=h, wait_time=wait_time, max_page_load_time=page_load, playbook_name=playbook_name)
        if r_type == 'json':
            context = {
                "cortex-playbook-screenshot": output
            }
            md = tableToMarkdown(f"Playbook Screenshot for: {playbook_name}", output)
            demisto.results({
                'Type' : entryTypes['note'],
                'Contents': output,
                'ContentsFormat' : formats['json'],
                'HumanReadable': md,
                'ReadableContentsFormat' : formats['markdown'],
                'EntryContext' : context
            })
        else:
            res = fileResult(filename=file_name, data=output)
            if r_type == 'png':
                res['Type'] = entryTypes['image']

            demisto.results(res)


    def module_test():
        # setting up a mock email file
        with tempfile.NamedTemporaryFile('w+') as test_file:
            w = 1920
            h = 1080
            r_type = 'png'
            playbook_name = 'GenericPolling'
            wait_time = int(0)
            page_load = int(20)
            file_name = f'{playbook_name}.{"pdf" if r_type == "pdf" else "png"}'  # type: ignore
            output = rasterize(r_type=r_type, width=w, height=h, wait_time=wait_time, max_page_load_time=page_load, playbook_name=playbook_name)
            demisto.results('ok')


    def main():
        try:
            with open(DRIVER_LOG, 'w'):
                pass  # truncate the log file
            if demisto.command() == 'test-module':
                module_test()
            elif demisto.command() == 'cortex-capture-playbook-screenshot':
                rasterize_command()
            else:
                return_error('Unrecognized command')

        except Exception as ex:
            return_err_or_warn(f'Unexpected exception: {ex}\nTrace:{traceback.format_exc()}')
        finally:
            if is_debug_mode():
                demisto.debug(f'os.environ: {os.environ}')
                with open(DRIVER_LOG, 'r') as log:
                    demisto.debug('Driver log:' + log.read())


    if __name__ in ["__builtin__", "builtins", '__main__']:
        main()

    register_module_line('Rasterize', 'end', __line__())
  subtype: python3
  type: python
sourcemoduleid: Rasterize
