contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: b6922792-57cb-4498-803b-9997163413eb
inputs: []
name: TCS-Create Recorded Future_Bad Indicator Domain_v1.0_KomalNaeema
outputs: []
sourceplaybookid: 3a37bf98-d8e9-4ab9-8889-dba63691e69c
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cbd2ffaa-6c1e-43cc-8690-2c96a6360766
      iscommand: false
      name: ""
      version: -1
    taskid: cbd2ffaa-6c1e-43cc-8690-2c96a6360766
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -900,
          "y": -730
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "36000000"
      retry-count:
        simple: "3"
      retry-interval:
        simple: "20"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets the domain risk list as a CSV file from Recorded Future.
      id: abaff342-4840-4d73-88dc-2c87ccda07f8
      iscommand: true
      name: Fetch recorded future domain risk list via Integration
      script: Recorded Future v2.1|||recorded-future-get-domain-risklist
      type: regular
      version: -1
    taskid: abaff342-4840-4d73-88dc-2c87ccda07f8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": -375
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: domain_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: domain
      threshold:
        simple: "80"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b5a079d4-bbc8-4add-81fd-ea5987b873a4
      iscommand: false
      name: Retrieve IPs with reputation >=80 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: b5a079d4-bbc8-4add-81fd-ea5987b873a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": -200
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_domain.csv
          root: File
      extend-context:
        simple: extractedDomainList=FileData
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 3b3a0944-cef9-4c14-8234-0881c60202b8
      iscommand: false
      name: Read extracted list (only Domain Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: 3b3a0944-cef9-4c14-8234-0881c60202b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 170
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f8377f30-bbe0-49eb-828c-f9ffb0dc511b
      iscommand: false
      name: Download Recorded Future IP List and Save to Demisto Lists
      type: title
      version: -1
    taskid: f8377f30-bbe0-49eb-828c-f9ffb0dc511b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -900,
          "y": -540
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ad4ea2bd-86f0-4720-8735-2f32fb98b5b7
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: ad4ea2bd-86f0-4720-8735-2f32fb98b5b7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -900,
          "y": 1770
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "72000000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future
      description: Gets the URL risk list as a CSV file from Recorded Future.
      id: 7cf2e653-58b4-45bd-87e7-ccab73de8673
      iscommand: true
      name: Fetch recorded future URL risk list via Integration
      script: Recorded Future|||recorded-future-get-url-risklist
      type: regular
      version: -1
    taskid: 7cf2e653-58b4-45bd-87e7-ccab73de8673
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": -270
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: url_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: url
      threshold:
        simple: "80"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 296f91df-48ec-49e4-83b7-96246ee5a20e
      iscommand: false
      name: Retrieve URLs with reputation >=80 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: 296f91df-48ec-49e4-83b7-96246ee5a20e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": -120
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_url.csv
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: ee2e27d9-1804-4bf8-83c9-8afe83c35220
      iscommand: false
      name: Read extracted list (only URL Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: ee2e27d9-1804-4bf8-83c9-8afe83c35220
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 200
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 10550772-da76-4bca-81f3-3d9c12a29c89
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 10550772-da76-4bca-81f3-3d9c12a29c89
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 20,
          "y": 520
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cece147b-a603-4c13-851c-aea30c3a81ea
      iscommand: false
      name: Download Recorded Future URL List and Save to Demisto Lists
      type: title
      version: -1
    taskid: cece147b-a603-4c13-851c-aea30c3a81ea
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 20,
          "y": -390
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a00c31e4-5b41-49b1-8565-9fbbc8a5b5a6
      iscommand: false
      name: Download Recorded Future Domain List and Save to Demisto Lists
      type: title
      version: -1
    taskid: a00c31e4-5b41-49b1-8565-9fbbc8a5b5a6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 470,
          "y": -390
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "72000000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future
      description: Gets the domain risk list as a CSV file from Recorded Future.
      id: e69ae071-1c5d-4a0f-84f8-3653b741035d
      iscommand: true
      name: Fetch recorded future Domain risk list via Integration
      script: Recorded Future|||recorded-future-get-domain-risklist
      type: regular
      version: -1
    taskid: e69ae071-1c5d-4a0f-84f8-3653b741035d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": -270
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: domain_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: domain
      threshold:
        simple: "80"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 81a0f89d-0039-46c6-82bb-f770a38a4303
      iscommand: false
      name: Retrieve Domains with reputation >=80 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: 81a0f89d-0039-46c6-82bb-f770a38a4303
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": -120
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_domain.csv
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: a8518958-773a-4237-8d18-bf51ec29b2c3
      iscommand: false
      name: Read extracted list (only Domain Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: a8518958-773a-4237-8d18-bf51ec29b2c3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 200
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 635e4893-f36d-4be7-803e-ee5520c754f4
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 635e4893-f36d-4be7-803e-ee5520c754f4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 470,
          "y": 520
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aefdf914-460b-4b19-80e1-e98527cae03b
      iscommand: false
      name: Download Recorded Future Hash List and Save to Demisto Lists
      type: title
      version: -1
    taskid: aefdf914-460b-4b19-80e1-e98527cae03b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": -390
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "72000000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future
      description: Gets the hash risk list from Recorded Future.
      id: 2652c2e4-8b4a-4376-8348-9891a3dca8c0
      iscommand: true
      name: Fetch recorded future Hash risk list via Integration
      script: Recorded Future|||recorded-future-get-hash-risklist
      type: regular
      version: -1
    taskid: 2652c2e4-8b4a-4376-8348-9891a3dca8c0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": -280
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: hash_list.csv
          root: InfoFile
      extend-context:
        simple: CSVReputationToList.count=HashAddressCount
      ioc_type:
        simple: hash
      threshold:
        simple: "80"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4c4ee270-61a5-4ae5-8ce3-2415285a83ea
      iscommand: false
      name: Retrieve Hashs with reputation > =80 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: 4c4ee270-61a5-4ae5-8ce3-2415285a83ea
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": -120
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_hash.csv
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: f0f6a562-362d-4f6f-87f6-c32eb724930c
      iscommand: false
      name: Read extracted list (only HASH Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: f0f6a562-362d-4f6f-87f6-c32eb724930c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 200
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[a-fA-F\d]{32}\b
            operator: RegexExtractAll
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      listName:
        simple: RecordedFutureHashRiskList-MD5
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 38cae648-821a-497b-8973-c2e27d0f833f
      iscommand: true
      name: Overwrite Recorded Future MD5 HashRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 38cae648-821a-497b-8973-c2e27d0f833f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 350
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c30fe3d1-0ee9-40e2-83a5-6f182f6ff91a
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: c30fe3d1-0ee9-40e2-83a5-6f182f6ff91a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 820
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
      listName:
        simple: RecordedFutureDomainRiskList
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 21889df1-39df-431e-8c97-ba390c913cdd
      iscommand: true
      name: Overwrite Recorded Future DomainRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 21889df1-39df-431e-8c97-ba390c913cdd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 350
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
      listName:
        simple: RecordedFutureURLRiskList
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: afefe78d-ce52-4df9-8b1c-977826b37023
      iscommand: true
      name: Overwrite Recorded Future URLRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: afefe78d-ce52-4df9-8b1c-977826b37023
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 360
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
      listName:
        simple: RecordedFutureDomainRiskList
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: ce460b31-e947-45dc-8120-f8c169288d8a
      iscommand: true
      name: Overwrite Recorded Future Domain RiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: ce460b31-e947-45dc-8120-f8c169288d8a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 350
        }
      }
  "46":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: Hashs Exist
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "42"
      Hashs Exist:
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d5b1a780-ab74-491f-87cb-2fd565b85f0a
      iscommand: false
      name: Are there any Hashs witth replutation >=80?
      type: condition
      version: -1
    taskid: d5b1a780-ab74-491f-87cb-2fd565b85f0a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 910,
          "y": 40
        }
      }
  "48":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: URLs Exist
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      URLs Exist:
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 539890ba-c925-4c25-885b-0809a9359fe3
      iscommand: false
      name: Are there any URLs with replutation >=80?
      type: condition
      version: -1
    taskid: 539890ba-c925-4c25-885b-0809a9359fe3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 20,
          "y": 40
        }
      }
  "49":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: Domains Exist
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      Domains Exist:
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6b4ae2cc-08b5-4241-893e-3735c316f9fe
      iscommand: false
      name: Are there any Domains with replutation >=80?
      type: condition
      version: -1
    taskid: 6b4ae2cc-08b5-4241-893e-3735c316f9fe
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -900,
          "y": -25
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[a-fA-F\d]{40}\b
            operator: RegexExtractAll
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      listName:
        simple: RecordedFutureHashRiskList-SHA1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 2106cd47-3ae1-4f8f-807a-62968e3dd52c
      iscommand: true
      name: Overwrite Recorded Future SHA1 HashRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 2106cd47-3ae1-4f8f-807a-62968e3dd52c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 505
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[a-fA-F\d]{64}\b
            operator: RegexExtractAll
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      listName:
        simple: RecordedFutureHashRiskList-SHA256
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 8a7e4d41-3304-4b18-8fe9-37fa78e1332d
      iscommand: true
      name: Overwrite Recorded Future SHA256 HashRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 8a7e4d41-3304-4b18-8fe9-37fa78e1332d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 660
        }
      }
  "52":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: Domains Exist
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      Domains Exist:
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 44f986e7-18a6-4699-8c81-9f99d2d39187
      iscommand: false
      name: Are there any Domains with reputation >=80?
      type: condition
      version: -1
    taskid: 44f986e7-18a6-4699-8c81-9f99d2d39187
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 470,
          "y": 40
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "64"
      - "65"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "10000000"
      tags:
        simple: rfdomainblocked80
      type:
        simple: Domain
      value:
        complex:
          accessor: RightOnly
          root: ListCompare
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 1deae8e0-8b65-477d-8299-3f683615c72a
      iscommand: true
      name: Create New Indicator With Tag 'rfdomainblocked80'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 1deae8e0-8b65-477d-8299-3f683615c72a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 1260
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "43200"
      extend-context:
        simple: indicator.domain=value
      ignore-outputs:
        simple: "true"
      query:
        simple: tags:rfdomainblocked80  and expirationStatus:active
      retry-count:
        simple: "3"
      size:
        simple: "100000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 40ef5d62-69c1-44cd-8be8-995654d218ef
      iscommand: true
      name: Fetch Indicators With Tag 'rfdomainblocked80'
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 40ef5d62-69c1-44cd-8be8-995654d218ef
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 710
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${TaggedIndicator}
      right:
        simple: ${RFSCORE80}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 3b880402-996c-4009-83db-e16e9c8d5503
      iscommand: false
      name: Compare Context 'Extracted Indicator' and 'Indicator.domain'
      script: CompareLists
      type: regular
      version: -1
    taskid: 3b880402-996c-4009-83db-e16e9c8d5503
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 1040
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RFSCORE80
      value:
        complex:
          root: FileData
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1eff4980-33f8-43ae-8187-eb248f2b9204
      iscommand: false
      name: Set Domain Risk List Into Context
      script: Set
      type: regular
      version: -1
    taskid: 1eff4980-33f8-43ae-8187-eb248f2b9204
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 520
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TaggedIndicator
      value:
        complex:
          accessor: domain
          root: indicator
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9584947e-0d88-4496-8bfa-36b4d1573b67
      iscommand: false
      name: Set Tagged Indictor In Context
      script: Set
      type: regular
      version: -1
    taskid: 9584947e-0d88-4496-8bfa-36b4d1573b67
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 870
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "67"
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "100000"
      indicatorsValues:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: 1006901c-bcff-456e-801a-f263bb9810ab
      iscommand: true
      name: Expire Indicator With Tag 'rfdomainblocked80' With Threshold < 80
      script: Builtin|||expireIndicators
      type: regular
      version: -1
    taskid: 1006901c-bcff-456e-801a-f263bb9810ab
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1340,
          "y": 1260
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      doNotWhitelist:
        simple: "true"
      execution-timeout:
        simple: "1000000"
      query:
        simple: expirationStatus:expired and tags:rfdomainblocked80
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.delete.indicators
      id: 652d5c7c-c4d5-4b72-8dba-af9beed5aafa
      iscommand: true
      name: Delete Expired Domain Indicators
      script: Builtin|||deleteIndicators
      type: regular
      version: -1
    taskid: 652d5c7c-c4d5-4b72-8dba-af9beed5aafa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1340,
          "y": 1585
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: e99fd8a0-efa5-4878-8e8b-5bc1400562b6
      iscommand: true
      name: Close Automation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: e99fd8a0-efa5-4878-8e8b-5bc1400562b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 1910
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d95e419a-0e67-42ac-8dfc-48397f6982e2
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: d95e419a-0e67-42ac-8dfc-48397f6982e2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -900,
          "y": 2130
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      url:
        simple: ${ListCompare.RightOnly}
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: d82aa694-4d18-4c87-885d-3a13caf574f6
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: d82aa694-4d18-4c87-885d-3a13caf574f6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -900,
          "y": 1440
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: RightOnly
          root: ListCompare
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 58fbb6f5-6157-4a10-85e6-184cd9c35438
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 58fbb6f5-6157-4a10-85e6-184cd9c35438
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -450,
          "y": 1450
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes URLs from the specified category.
      id: 3f3c050c-dbc3-4137-8556-cf7d96ef3784
      iscommand: true
      name: Unblock Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-remove-url
      type: regular
      version: -1
    taskid: 3f3c050c-dbc3-4137-8556-cf7d96ef3784
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1790,
          "y": 1410
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes URLs from the specified category.
      id: a4dd117c-e51a-4f46-87e4-83fdc9f5694f
      iscommand: true
      name: Unblock Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-remove-url
      type: regular
      version: -1
    taskid: a4dd117c-e51a-4f46-87e4-83fdc9f5694f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1340,
          "y": 1420
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2925,
        "width": 3080,
        "x": -1790,
        "y": -730
      }
    }
  }
