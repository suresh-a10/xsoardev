contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 0ce0eaac-5967-4947-8a41-0ec43c598353
inputs: []
name: TCS-EDR Detection Info Context & Enrich v3.1_KK_WIP
outputs: []
quiet: true
sourceplaybookid: 58a33f37-14f8-4fae-8ec5-ee4d39f9ff19
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
      - "53"
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ccee0bdc-6262-4eab-86f3-83ee52653ec7
      iscommand: false
      name: ""
      version: -1
    taskid: ccee0bdc-6262-4eab-86f3-83ee52653ec7
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 410,
          "y": -1505
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ParentProcessID
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ParentProcessID
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c27a4af6-5f5d-4723-81de-a8ccbe25a961
      iscommand: false
      name: Is There Context ParentProcessID ?
      type: condition
      version: -1
    taskid: c27a4af6-5f5d-4723-81de-a8ccbe25a961
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": 190
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeparentprocessid:
        complex:
          accessor: ParentProcessID
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 79b69fb6-0515-479e-8dd4-ee4d93b725fc
      iscommand: true
      name: Set Context ParentProcessID
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 79b69fb6-0515-479e-8dd4-ee4d93b725fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 400
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: FileName
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: FileName
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f8f1456f-7124-43fe-8c8f-e8cd819d8123
      iscommand: false
      name: Is There Context FileName ?
      type: condition
      version: -1
    taskid: f8f1456f-7124-43fe-8c8f-e8cd819d8123
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 190
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikefilename:
        complex:
          accessor: FileName
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 9d237916-32f0-455c-832b-457a27b3fc69
      iscommand: true
      name: Set Context FileName
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 9d237916-32f0-455c-832b-457a27b3fc69
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 400
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: efb48beb-b531-417a-8516-21e2f25d0010
      iscommand: false
      name: Check If There Are Any Reports
      type: title
      version: -1
    taskid: efb48beb-b531-417a-8516-21e2f25d0010
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 670,
          "y": 1270
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: SHA256
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: SHA256
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5650bfd0-c971-4b73-8d1d-53b22363a5a9
      iscommand: false
      name: Is There Context SHA256?
      type: condition
      version: -1
    taskid: 5650bfd0-c971-4b73-8d1d-53b22363a5a9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 190
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      crowdstrikefilehash:
        complex:
          accessor: SHA256
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: '"'
            operator: split
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: ae19dd45-6eb4-4d25-8598-f1e808232205
      iscommand: true
      name: Set Context SHA256
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ae19dd45-6eb4-4d25-8598-f1e808232205
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 400
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: UserName
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: UserName
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 437089dc-bb6a-47f0-86f8-d60db27c0a26
      iscommand: false
      name: Is There Context UserName?
      type: condition
      version: -1
    taskid: 437089dc-bb6a-47f0-86f8-d60db27c0a26
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2910,
          "y": 190
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeusername:
        complex:
          accessor: UserName
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 6bccddab-ac22-4907-8ea5-05c68caa59ac
      iscommand: true
      name: Set Context UserName
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6bccddab-ac22-4907-8ea5-05c68caa59ac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2910,
          "y": 400
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LocalIP
                root: CrowdStrike.Device
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LocalIP
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9bc2fce0-f651-48dc-8267-0ae789a21eb7
      iscommand: false
      name: Is There Context LocalIP ?
      type: condition
      version: -1
    taskid: 9bc2fce0-f651-48dc-8267-0ae789a21eb7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3600,
          "y": 190
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeinternalipaddress:
        complex:
          accessor: LocalIP
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 03fbfaec-5d9e-41b6-8733-4d8c8ae04080
      iscommand: true
      name: Set Context LocalIP
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 03fbfaec-5d9e-41b6-8733-4d8c8ae04080
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3600,
          "y": 410
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ExternalIP
                root: CrowdStrike.Device
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ExternalIP
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6475e0b5-c221-472f-81ed-ecc5c6ec91ab
      iscommand: false
      name: Is There Context ExternalIP ?
      type: condition
      version: -1
    taskid: 6475e0b5-c221-472f-81ed-ecc5c6ec91ab
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4050,
          "y": 190
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeexternalipaddress:
        complex:
          accessor: ExternalIP
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 53fea814-cf1b-4c40-8925-28e550d1807f
      iscommand: true
      name: Set Context ExternalIP
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 53fea814-cf1b-4c40-8925-28e550d1807f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4050,
          "y": 410
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: CommandLine
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: CommandLine
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d497e6fb-77f0-41a0-8130-bc252e384e8f
      iscommand: false
      name: Is There Context CommandLine ?
      type: condition
      version: -1
    taskid: d497e6fb-77f0-41a0-8130-bc252e384e8f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4500,
          "y": 190
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikecmdline:
        complex:
          accessor: CommandLine
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: dfb60a20-2dc4-4f97-82a0-6855b1df1482
      iscommand: true
      name: 'Set Context CommandLine '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: dfb60a20-2dc4-4f97-82a0-6855b1df1482
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4500,
          "y": 410
        }
      }
  "16":
    continueonerror: true
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        complex:
          accessor: crowdstrikeusername
          root: incident
      retry-count:
        simple: "1"
      using:
        simple: Active Directory Query v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a user account. The user can
        be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filter is specified, all users are returned.
      id: 58abbefa-21a5-4e15-8092-630397bd78b4
      iscommand: true
      name: Get User Information From AD
      script: Active Directory Query v2|||ad-get-user
      tags:
      - ADRESULT
      type: regular
      version: -1
    taskid: 58abbefa-21a5-4e15-8092-630397bd78b4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2700,
          "y": 800
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: System
                root: CrowdStrike.Detection
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: System
                root: CrowdStrike.Detection
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2207b70f-589c-4de4-82b1-d7109bab78d5
      iscommand: false
      name: Is There Context System ?
      type: condition
      version: -1
    taskid: 2207b70f-589c-4de4-82b1-d7109bab78d5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4940,
          "y": 190
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikehostname:
        complex:
          accessor: System
          root: CrowdStrike.Detection
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 03806e1f-1630-44d1-80eb-462872d80dd4
      iscommand: true
      name: Set Context System
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 03806e1f-1630-44d1-80eb-462872d80dd4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4940,
          "y": 420
        }
      }
  "19":
    continueonerror: true
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        complex:
          accessor: crowdstrikehostname
          root: incident
      retry-count:
        simple: "1"
      using:
        simple: Active Directory Query v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a computer account. The computer
        can be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filters are provided, all computers are returned.
      id: b947360c-fc11-4b44-88f5-31b88dc979fc
      iscommand: true
      name: Get Computer Info From AD
      script: Active Directory Query v2|||ad-get-computer
      tags:
      - ADRESULT
      type: regular
      version: -1
    taskid: b947360c-fc11-4b44-88f5-31b88dc979fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": -330
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOCValue
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOCValue
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 75cfface-0527-4701-8eb8-cc4d2ba6a605
      iscommand: false
      name: Is There Context IOCValue
      type: condition
      version: -1
    taskid: 75cfface-0527-4701-8eb8-cc4d2ba6a605
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 5400,
          "y": 190
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Scenario
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Scenario
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 267713cc-7b8c-4ca8-8378-a7a141f2b627
      iscommand: false
      name: Is There Context Scenario
      type: condition
      version: -1
    taskid: 267713cc-7b8c-4ca8-8378-a7a141f2b627
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 5830,
          "y": 190
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      csiocvalue:
        complex:
          accessor: IOCValue
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: InnerServicesModule
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: a45c5657-f4b5-4930-88f6-a96c0ecafb4a
      iscommand: true
      name: Set Context IOCValue
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: a45c5657-f4b5-4930-88f6-a96c0ecafb4a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 5400,
          "y": 400
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: csiocvalue
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 0e0dad9c-dbc6-4fc6-8a51-7fa348413ddb
      iscommand: true
      name: Enrich IOC
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 0e0dad9c-dbc6-4fc6-8a51-7fa348413ddb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 5400,
          "y": 590
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: SHA256
          root: CrowdStrike.Detection.Behavior
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 433fd72f-b013-4efa-83c4-0bb90a83949d
      iscommand: true
      name: Enrich IOC
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 433fd72f-b013-4efa-83c4-0bb90a83949d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 570
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      csscenario:
        complex:
          accessor: Scenario
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: InnerServicesModule
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 72a526fd-15b8-4a00-8ac8-70a7e5e5bd50
      iscommand: true
      name: Set Context Scenario
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 72a526fd-15b8-4a00-8ac8-70a7e5e5bd50
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 5830,
          "y": 400
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: description
                root: CrowdStrike.Detections.behaviors
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: description
                root: CrowdStrike.Detections.behaviors
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: de3bfa9c-2197-4915-8608-dbb4083123a4
      iscommand: false
      name: Is There description ?
      type: condition
      version: -1
    taskid: de3bfa9c-2197-4915-8608-dbb4083123a4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 0,
          "y": 190
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      descriptionoffense:
        complex:
          accessor: description
          root: CrowdStrike.Detections.behaviors
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 123d24e8-1988-4a84-8fd1-8c73aed525d7
      iscommand: true
      name: Set Context Description
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 123d24e8-1988-4a84-8fd1-8c73aed525d7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 0,
          "y": 400
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tactic
                root: CrowdStrike.Detections.behaviors
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tactic
                root: CrowdStrike.Detections.behaviors
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dd9ca027-8419-4f57-8eb7-547dce8e42aa
      iscommand: false
      name: Is There tactic?
      type: condition
      version: -1
    taskid: dd9ca027-8419-4f57-8eb7-547dce8e42aa
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -440,
          "y": 190
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstriketactic:
        complex:
          accessor: tactic
          root: CrowdStrike.Detections.behaviors
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      descriptionoffense:
        complex:
          accessor: description
          root: CrowdStrike.Detections.behaviors
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 57cc8b4b-9d41-4ab0-887a-60470455fa61
      iscommand: true
      name: Set Context tactic
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 57cc8b4b-9d41-4ab0-887a-60470455fa61
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -440,
          "y": 400
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: technique
                root: CrowdStrike.Detections.behaviors
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: technique
                root: CrowdStrike.Detections.behaviors
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1005e520-dfcc-4d0d-86d4-758e1d9ba706
      iscommand: false
      name: Is There technique?
      type: condition
      version: -1
    taskid: 1005e520-dfcc-4d0d-86d4-758e1d9ba706
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -880,
          "y": 190
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstriketechnique:
        complex:
          accessor: technique
          root: CrowdStrike.Detections.behaviors
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 12f4d0ca-4959-4dae-8941-3828499091e8
      iscommand: true
      name: Set Context technique
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 12f4d0ca-4959-4dae-8941-3828499091e8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -880,
          "y": 400
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: parent_cmdline
                root: CrowdStrike.Detections.behaviors.parent_details
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: parent_cmdline
                root: CrowdStrike.Detections.behaviors.parent_details
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: da4ce889-502a-46d7-8115-b56df0d940f4
      iscommand: false
      name: Is There parent_cmdline?
      type: condition
      version: -1
    taskid: da4ce889-502a-46d7-8115-b56df0d940f4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1320,
          "y": 190
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      csparentcmdline:
        complex:
          accessor: parent_cmdline
          root: CrowdStrike.Detections.behaviors.parent_details
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 870a597a-ba5e-4e06-83ba-d4dbbdba3b03
      iscommand: true
      name: Set Context parent_cmdline
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 870a597a-ba5e-4e06-83ba-d4dbbdba3b03
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1320,
          "y": 400
        }
      }
  "36":
    continueonerror: true
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      retry-count:
        simple: "3"
      using:
        simple: Active Directory Query v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a user account. The user can
        be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filter is specified, all users are returned.
      id: c1a93d85-fa17-4896-8541-b4231bdcd30a
      iscommand: true
      name: Get User Information From AD
      script: Active Directory Query v2|||ad-get-user
      tags:
      - ADRESULT
      type: regular
      version: -1
    taskid: c1a93d85-fa17-4896-8541-b4231bdcd30a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3120,
          "y": 800
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikeusername
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: '@'
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      - "59"
      - "63"
      - "67"
      "yes":
      - "36"
      - "58"
      - "62"
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8ebeb636-edfb-49b4-882b-a9ac8b30323a
      iscommand: false
      name: Does The Username Contain @ ?
      type: condition
      version: -1
    taskid: 8ebeb636-edfb-49b4-882b-a9ac8b30323a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2910,
          "y": 590
        }
      }
  "38":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Status
                root: WildFire.Report
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Status
                root: WildFire.Report
          operator: isEqualString
          right:
            value:
              simple: Success
      label: "yes"
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5a48925c-d4ee-42a2-8bcd-76bda05386a3
      iscommand: false
      name: Is There Context WildFire ?
      type: condition
      version: -1
    taskid: 5a48925c-d4ee-42a2-8bcd-76bda05386a3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 670,
          "y": 1420
        }
      }
  "39":
    continueonerror: true
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Wild Fire Report
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 2
    scriptarguments:
      sha256:
        complex:
          accessor: SHA256
          root: WildFire.Report
      using:
        simple: WildFire-v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: WildFire-v2
      description: Retrieves results for a file hash using WildFire.
      id: f5363c8e-2830-401c-80cc-61fbb4f6062d
      iscommand: true
      name: Get Wild Fire Report
      script: WildFire-v2|||wildfire-report
      tags:
      - sandboxreport
      type: regular
      version: -1
    taskid: f5363c8e-2830-401c-80cc-61fbb4f6062d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 1650
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a65e5008-33b1-4ebe-858f-0a071770d281
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: a65e5008-33b1-4ebe-858f-0a071770d281
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1890
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        simple: ${incident.crowdstrikedetectionid}
      retry-count:
        simple: "3"
      using:
        simple: ${incident.sourceInstance}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Search for details of specific detections, either using a filter
        query, or by providing the IDs of the detections.
      id: 90b07da1-e0d0-42ae-83d2-5b0ae6ca98d8
      iscommand: true
      name: Fetch Detection Details CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-search-detection
      type: regular
      version: -1
    taskid: 90b07da1-e0d0-42ae-83d2-5b0ae6ca98d8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": -1150
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        simple: ${incident.crowdstrikedetectionid}
      retry-count:
        simple: "3"
      using:
        simple: ${incident.sourceInstance}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Lists detection summaries.
      id: 32942aa9-5072-4fe4-8cce-95f4ce7e6170
      iscommand: true
      name: Fetch Detection Summary CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-list-detection-summaries
      type: regular
      version: -1
    taskid: 32942aa9-5072-4fe4-8cce-95f4ce7e6170
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": -950
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
      - "33"
      - "31"
      - "29"
      - "27"
      - "3"
      - "6"
      - "8"
      - "10"
      - "12"
      - "14"
      - "19"
      - "20"
      - "22"
      - "50"
      - "48"
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          accessor: crowdstrikehostname
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: ${incident.sourceInstance}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: b8837db3-9bb4-4c3c-8707-00aca24617ed
      iscommand: true
      name: Fetch Host Details
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: b8837db3-9bb4-4c3c-8707-00aca24617ed
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": -740
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikedetectionid
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ec1507f2-294a-499d-836e-c56a3493ca49
      iscommand: false
      name: Is There A CrowdStrike Detection ?
      type: condition
      version: -1
    taskid: ec1507f2-294a-499d-836e-c56a3493ca49
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": -1330
        }
      }
  "48":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketacticid
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9196452e-017e-4663-8b3f-39201fddb6df
      iscommand: false
      name: Is There Tactic id ?
      type: condition
      version: -1
    taskid: 9196452e-017e-4663-8b3f-39201fddb6df
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1760,
          "y": 190
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: crowdstriketacticid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: ca2505d9-3d60-4753-89ec-89b5418face6
      iscommand: true
      name: Enrich MITRE Id
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: ca2505d9-3d60-4753-89ec-89b5418face6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1760,
          "y": 400
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketechniqueid
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 845190c5-b809-4921-808c-4638b64d4ca2
      iscommand: false
      name: Is There Technique id ?
      type: condition
      version: -1
    taskid: 845190c5-b809-4921-808c-4638b64d4ca2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2170,
          "y": 190
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: crowdstriketechniqueid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 05b640b0-4bc3-44e9-883c-c7324d395d6c
      iscommand: true
      name: Enrich MITRE Id
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 05b640b0-4bc3-44e9-883c-c7324d395d6c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2170,
          "y": 400
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      playbookrepository:
        simple: https://tcscomprod.sharepoint.com/sites/CSOC/Shared%20Documents/Forms/AllItems.aspx?csf=1&web=1&e=KYjw1j&cid=921a35a0%2D0000%2D4c6c%2D8408%2Dba87b58b62ce&RootFolder=%2Fsites%2FCSOC%2FShared%20Documents%2FGeneral%2FInvestigation%20Steps&FolderCTID=0x0120000CB0DB63BA83C14C9572FB2178E87F0B
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: b1cd0dac-08e8-4c97-8880-cfa6e71fb2f2
      iscommand: true
      name: 'Set Playbook Repository Link '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: b1cd0dac-08e8-4c97-8880-cfa6e71fb2f2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2600,
          "y": 400
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      prioritymatrix:
        simple: |-
          <table style="height: 212px; border-style: solid; width: 658px; background-color: #ffffff;" width="658">
          <tbody>
          <tr style="height: 46px;">
          <td style="height: 92px; width: 199.688px; border-style: solid;" colspan="2" rowspan="2">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Priority</span><span style="color: #0000ff;"> Matrix</span></strong></h3>
          </td>
          <td style="height: 46px; width: 442.312px; border-style: solid;" colspan="3">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Impact</span></strong></h3>
          </td>
          </tr>
          <tr style="height: 46px;">
          <td style="height: 46px; width: 124.094px; border-style: solid;">
          <h3><strong>&nbsp;1 - High</strong></h3>
          </td>
          <td style="height: 46px; width: 120.297px; border-style: solid;">
          <h3><strong>&nbsp;2 - Medium</strong></h3>
          </td>
          <td style="height: 46px; width: 185.922px; border-style: solid;">
          <h3><strong>&nbsp;3 - Low</strong></h3>
          </td>
          </tr>
          <tr style="height: 46px;">
          <td style="height: 120px; width: 93.25px; border-style: solid;" rowspan="3">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Urgency</span></strong></h3>
          </td>
          <td style="height: 46px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;1 - High</strong></h3>
          </td>
          <td style="height: 46px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff0000;">0- Critical</span></strong></h3>
          </td>
          <td style="height: 46px; width: 120.297px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff9900;">1 - High</span></strong></h3>
          </td>
          <td style="height: 46px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #00ccff;">2 - Medium</span></strong></h3>
          </td>
          </tr>
          <tr style="height: 64px;">
          <td style="height: 64px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;2 - Medium</strong></h3>
          </td>
          <td style="height: 64px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff9900;">1 - High</span></strong></h3>
          </td>
          <td style="height: 64px; width: 120.297px; border-style: solid;">
          <h3><strong><span style="color: #00ccff;">&nbsp;2 - Medium</span></strong></h3>
          </td>
          <td style="height: 64px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<span style="color: #ff00ff;"><strong>3 - Low</strong></span></h3>
          </td>
          </tr>
          <tr style="height: 10px;">
          <td style="height: 10px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;3 - Low</strong></h3>
          </td>
          <td style="height: 10px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<span style="color: #00ccff;"><strong>2 - Medium</strong></span></h3>
          </td>
          <td style="height: 10px; width: 120.297px; border-style: solid;">
          <h3><span style="color: #ff00ff;">&nbsp;<strong>3 - Low</strong></span></h3>
          </td>
          <td style="height: 10px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #339966;">4 - Informational</span></strong></h3>
          </td>
          </tr>
          </tbody>
          </table>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 1b274fdf-86de-4cbf-8caf-3fd056de14a8
      iscommand: true
      name: Set Priority Matrix Table
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 1b274fdf-86de-4cbf-8caf-3fd056de14a8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -3030,
          "y": 400
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: true
    quietmode: 0
    scriptarguments:
      fieldExactMatch:
        simple: incident.crowdstrikehostname
      fromDate:
        simple: 12 months ago
      similarTextField:
        simple: incident.crowdstrikehostname
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Find past similar incidents based on incident fields' similarity.
        Includes an option to also display indicators similarity.
      id: a85f436e-7a62-42e8-88f7-585e6abd14ab
      iscommand: false
      name: Find Past Detection For Same Host
      script: DBotFindSimilarIncidents
      tags:
      - Note
      - pastevents
      type: regular
      version: -1
    taskid: a85f436e-7a62-42e8-88f7-585e6abd14ab
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 6280,
          "y": 190
        }
      }
  "57":
    continueonerror: true
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      hostname:
        complex:
          accessor: crowdstrikehostname
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: ee5ab651-a0cb-44aa-8061-3801a25eb450
      iscommand: true
      name: Get Computer Info From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: ee5ab651-a0cb-44aa-8061-3801a25eb450
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": -150
        }
      }
  "58":
    continueonerror: true
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      empid:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: eebf7439-e312-4283-8d02-0e44e59eec09
      iscommand: true
      name: Get User Information From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: eebf7439-e312-4283-8d02-0e44e59eec09
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3530,
          "y": 800
        }
      }
  "59":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikeusername
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsGeneral
          right:
            value:
              simple: ad.
      label: "yes"
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 094e63c8-bbf6-4775-84ac-8c864d76023d
      iscommand: false
      name: Does The Username Contain "ad."?
      type: condition
      version: -1
    taskid: 094e63c8-bbf6-4775-84ac-8c864d76023d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2290,
          "y": 800
        }
      }
  "60":
    continueonerror: true
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      empid:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              from:
                value:
                  simple: .
            operator: substringFrom
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: 1a82f719-08e6-4bc3-808d-dc9a3180bcd0
      iscommand: true
      name: Get User Information From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: 1a82f719-08e6-4bc3-808d-dc9a3180bcd0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1880,
          "y": 980
        }
      }
  "61":
    continueonerror: true
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      empid:
        complex:
          accessor: crowdstrikeusername
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: a4166ce8-eb6d-4285-8596-0043e4e73e15
      iscommand: true
      name: Get User Information From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: a4166ce8-eb6d-4285-8596-0043e4e73e15
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2290,
          "y": 980
        }
      }
  "62":
    continueonerror: true
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      employee_id:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      retry-count:
        simple: "3"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Gurucul-GRA
      description: Get details of the user
      id: 14dd9cb4-3ee5-43c3-80b2-cb00340320b6
      iscommand: true
      name: Get User From UEBA
      script: Gurucul-GRA|||gra-fetch-users-details
      tags:
      - userueba
      type: regular
      version: -1
    taskid: 14dd9cb4-3ee5-43c3-80b2-cb00340320b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3940,
          "y": 800
        }
      }
  "63":
    continueonerror: true
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      employee_id:
        complex:
          accessor: crowdstrikeusername
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Gurucul-GRA
      description: Get details of the user
      id: fc4e946a-4bb9-4ffb-8e28-2ced410a0803
      iscommand: true
      name: Get User From UEBA
      script: Gurucul-GRA|||gra-fetch-users-details
      tags:
      - userueba
      type: regular
      version: -1
    taskid: fc4e946a-4bb9-4ffb-8e28-2ced410a0803
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1880,
          "y": 800
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      emp:
        complex:
          accessor: crowdstrikeusername
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f1b8db0c-e0a2-4b2b-81b7-12ef9145357d
      iscommand: false
      name: TCS-Create User Indicator & Relate To Incident v1.0
      playbookId: a8f14eae-50f0-476d-84bb-1c0d7fb01027
      type: playbook
      version: -1
    taskid: f1b8db0c-e0a2-4b2b-81b7-12ef9145357d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2700,
          "y": 980
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      emp:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0e532b5b-c75b-42a4-89b3-413484883a44
      iscommand: false
      name: TCS-Create User Indicator & Relate To Incident v1.0
      playbookId: a8f14eae-50f0-476d-84bb-1c0d7fb01027
      type: playbook
      version: -1
    taskid: 0e532b5b-c75b-42a4-89b3-413484883a44
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 3120,
          "y": 980
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "37_36_yes": 0.47,
      "44_40_#default#": 0.1,
      "59_60_yes": 0.53
    },
    "paper": {
      "dimensions": {
        "height": 3460,
        "width": 9690,
        "x": -3030,
        "y": -1505
      }
    }
  }
