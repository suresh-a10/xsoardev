contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 3fe6c4d4-fe79-4aa2-8cc2-d165a46109bd
inputs: []
name: TCS-Create Recorded Future Bad Indicator URL v1.0_KK
outputs: []
quiet: true
sourceplaybookid: 3a37bf98-d8e9-4ab9-8889-dba63691e69c
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8a513227-4bb5-4769-8be0-01c02c852db3
      iscommand: false
      name: ""
      version: -1
    taskid: 8a513227-4bb5-4769-8be0-01c02c852db3
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -300,
          "y": -230
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "36000000"
      retry-count:
        simple: "3"
      retry-interval:
        simple: "20"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets the URL risk list as a CSV file from Recorded Future.
      id: d8897966-3212-4fe5-8429-f8f64f13520c
      iscommand: true
      name: Fetch recorded future URL risk list via Integration
      script: Recorded Future v2.1|||recorded-future-get-url-risklist
      type: regular
      version: -1
    taskid: d8897966-3212-4fe5-8429-f8f64f13520c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 100
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: url_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: url
      threshold:
        simple: "80"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 070ba0d3-73aa-4a5e-85cb-4b0209e565fe
      iscommand: false
      name: Retrieve URLs with reputation >=80 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: 070ba0d3-73aa-4a5e-85cb-4b0209e565fe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 275
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_url.csv
          root: File
      extend-context:
        simple: extractedIPList=FileData
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 8bb3b8c5-e392-48d9-8f2c-3e55814f4016
      iscommand: false
      name: Read extracted list (only IP Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: 8bb3b8c5-e392-48d9-8f2c-3e55814f4016
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 620
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 18bc62c8-e041-43e7-8550-6bf6ecfe7566
      iscommand: false
      name: Download Recorded Future URL List and Save to Demisto Lists
      type: title
      version: -1
    taskid: 18bc62c8-e041-43e7-8550-6bf6ecfe7566
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -300,
          "y": -65
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8f87efcf-b0cc-462d-8895-83e9c198fc2f
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 8f87efcf-b0cc-462d-8895-83e9c198fc2f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3050
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
      listName:
        simple: RecordedFutureURLRiskList
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: c4080628-cbb6-4e85-8838-e50ce5010031
      iscommand: true
      name: Overwrite Recorded Future IPRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: c4080628-cbb6-4e85-8838-e50ce5010031
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 790
        }
      }
  "49":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: "Yes"
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "Yes":
      - "21"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f93d9f50-bd9f-4b9d-81ae-c165b3f2f722
      iscommand: false
      name: Are there any URL's with reputation >=80?
      type: condition
      version: -1
    taskid: f93d9f50-bd9f-4b9d-81ae-c165b3f2f722
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -300,
          "y": 440
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "43200"
      extend-context:
        simple: indicator.URL=value
      ignore-outputs:
        simple: "false"
      query:
        simple: tags:rfblockedURL and expirationStatus:active
      retry-count:
        simple: "3"
      size:
        simple: "100000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 6dc47529-2402-4eac-8058-70e37d1a6889
      iscommand: true
      name: Fetch Indicators With Tag 'rfblockedURL'
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 6dc47529-2402-4eac-8058-70e37d1a6889
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1160
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${TaggedIndicator}
      right:
        simple: ${RFSCORE80}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 9fc57c75-816a-4d67-824e-b002da9dd655
      iscommand: false
      name: Compare Context 'Extracted Indicator' and 'Indicator.URL'
      script: CompareLists
      type: regular
      version: -1
    taskid: 9fc57c75-816a-4d67-824e-b002da9dd655
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1760
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RFSCORE80
      value:
        complex:
          root: FileData
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 43e9a022-91ee-46aa-87c7-1d565a9a466e
      iscommand: false
      name: Set URL Risk List Into Context
      script: Set
      type: regular
      version: -1
    taskid: 43e9a022-91ee-46aa-87c7-1d565a9a466e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 985
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TaggedIndicator
      value:
        complex:
          accessor: URL
          root: indicator
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9068c05f-4abb-4ac7-8c1b-7ad9b53b24b7
      iscommand: false
      name: Set Tagged Indictor In Context
      script: Set
      type: regular
      version: -1
    taskid: 9068c05f-4abb-4ac7-8c1b-7ad9b53b24b7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1575
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 2
    scriptarguments:
      execution-timeout:
        simple: "100000"
      indicatorsValues:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: 8f53a375-4e63-4e10-8647-29efb1537f11
      iscommand: true
      name: Expire Indicator With Tag 'rfblockedURL' With Threshold < 80
      script: Builtin|||expireIndicators
      type: regular
      version: -1
    taskid: 8f53a375-4e63-4e10-8647-29efb1537f11
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 2
    scriptarguments:
      doNotWhitelist:
        simple: "true"
      execution-timeout:
        simple: "1000000"
      query:
        simple: expirationStatus:expired and tags:rfipblocked80
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.delete.indicators
      id: e760feb4-9eb6-4291-88f4-a11c25c0805f
      iscommand: true
      name: Delete Expired Indicators
      script: Builtin|||deleteIndicators
      type: regular
      version: -1
    taskid: e760feb4-9eb6-4291-88f4-a11c25c0805f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 02e0ed86-c87c-4087-80b1-ec03784b821b
      iscommand: true
      name: Close Automation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 02e0ed86-c87c-4087-80b1-ec03784b821b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3215
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2d88cc72-0095-40fe-8e81-d9839580ffae
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 2d88cc72-0095-40fe-8e81-d9839580ffae
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3410
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: RightOnly
                root: ListCompare
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: RightOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0f375b66-71ff-40e3-8784-abcdb29c0cd3
      iscommand: false
      name: Is  There A New Indicator ?
      type: condition
      version: -1
    taskid: 0f375b66-71ff-40e3-8784-abcdb29c0cd3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2500
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "65"
      "yes":
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4fe8473d-bc7d-4966-81bd-1bfa83e60cb4
      iscommand: false
      name: Is  There An Indicator To Expire ?
      type: condition
      version: -1
    taskid: 4fe8473d-bc7d-4966-81bd-1bfa83e60cb4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1935
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      URL:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ListCompare.RightOnly
              operator: isNotEmpty
          root: ListCompare.RightOnly
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 174a3075-86b7-44ad-84aa-b2d9be0efc7e
      iscommand: false
      name: TCS-Add New RF80 URL Indicator v1.0_Kunal
      playbookId: 0a5ef012-0b42-45c7-87e6-2295cb107ebe
      type: playbook
      version: -1
    taskid: 174a3075-86b7-44ad-84aa-b2d9be0efc7e
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2705
        }
      }
  "68":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "70"
      "yes":
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 132329c1-bb09-491a-8e33-6b016232df0d
      iscommand: false
      name: Any Indicators With Tag 'rfblockedURL' ?
      type: condition
      version: -1
    taskid: 132329c1-bb09-491a-8e33-6b016232df0d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1340
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      URL:
        complex:
          root: URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cbaed4af-96eb-4cc1-8066-845a21cb06d6
      iscommand: false
      name: TCS-Add New RF80 URL Indicator v1.0_Kunal
      playbookId: 0a5ef012-0b42-45c7-87e6-2295cb107ebe
      type: playbook
      version: -1
    taskid: cbaed4af-96eb-4cc1-8066-845a21cb06d6
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 530,
          "y": 2705
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: URL
      value:
        complex:
          root: RFSCORE80
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - args:
              empty_values: {}
              remove_keys:
                value:
                  simple: "true"
            operator: RemoveEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f4893c33-2858-490f-8cdc-37efd4f8c8bb
      iscommand: false
      name: set new key
      script: Set
      type: regular
      version: -1
    taskid: f4893c33-2858-490f-8cdc-37efd4f8c8bb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 530,
          "y": 2490
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "49_21_Yes": 0.51,
      "49_24_#default#": 0.1,
      "65_24_#default#": 0.77,
      "65_67_yes": 0.62,
      "68_59_yes": 0.42
    },
    "paper": {
      "dimensions": {
        "height": 3705,
        "width": 1210,
        "x": -300,
        "y": -230
      }
    }
  }
