contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.5.0
    itemVersion: 2.0.12
    packID: MalwareInvestigationAndResponse
    packName: Malware Investigation and Response
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: |-
  This playbook handles incident ingestion from the SIEM.
    The user provides which EDR system to use, the field containing the incident ID or detection ID, and the field indicating whether the ingested item is an incident or detection.
id: Malware SIEM Ingestion - Get Incident Data
inputs:
- description: Sets the EDR used to fetch data. Values can be CrowdStrike or MSDE.
  key: EDRProductToUse
  playbookInputQuery: null
  required: true
  value: {}
- description: The name of the field specifying the alert type. For example, for CrowdStrike
    this field specifies a detection or an incident.
  key: SIEMincidentFieldForType
  playbookInputQuery: null
  required: false
  value:
    simple: ${incident.externalcategoryname}
- description: The name of the field that provides the external ID of the alert or
    incident in the EDR.
  key: SIEMincidentFieldForID
  playbookInputQuery: null
  required: false
  value:
    simple: ${incident.externalsystemid}
- description: Whether to set the severity according to the EDR severity scale and
    its mapping to Cortex XSOAR (True) or keep the original severity scale as mapped
    by the SIEM (False).
  key: OverrideSIEMSeverity
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
name: Malware SIEM Ingestion - Get Incident Data
outputs:
- contextPath: CrowdStrike.Detection.Behavior.FileName
  description: The file name of the behavior.
- contextPath: CrowdStrike.Detection.Behavior.Scenario
  description: The scenario name of the behavior.
- contextPath: CrowdStrike.Detection.Behavior.MD5
  description: The MD5 hash of the IOC of the behavior.
- contextPath: CrowdStrike.Detection.Behavior.SHA256
  description: The SHA256 hash of the IOC of the behavior.
- contextPath: CrowdStrike.Detection.Behavior.IOCType
  description: The type of the IOC.
- contextPath: CrowdStrike.Detection.Behavior.IOCValue
  description: The value of the IOC.
- contextPath: CrowdStrike.Detection.Behavior.CommandLine
  description: The command line executed in the behavior.
- contextPath: CrowdStrike.Detection.Behavior.UserName
  description: The user name related to the behavior.
- contextPath: CrowdStrike.Detection.Behavior.SensorID
  description: The sensor ID related to the behavior.
- contextPath: CrowdStrike.Detection.Behavior.ParentProcessID
  description: The ID of the parent process.
- contextPath: CrowdStrike.Detection.Behavior.ProcessID
  description: The process ID of the behavior.
- contextPath: CrowdStrike.Detection.Behavior.ID
  description: The ID of the behavior.
- contextPath: CrowdStrike.Detection.System
  description: The system name of the detection.
- contextPath: CrowdStrike.Detection.CustomerID
  description: The ID of the customer (CID).
- contextPath: CrowdStrike.Detection.MachineDomain
  description: The name of the domain of the detection machine.
- contextPath: CrowdStrike.Detection.ID
  description: The detection ID.
- contextPath: CrowdStrike.Detection.ProcessStartTime
  description: The start time of the process that generated the detection.
- contextPath: CrowdStrike.FoundDetections
  description: Indicates whether detections were found.
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a70b8a21-3c8e-491c-8644-eacb985f5be4
      iscommand: false
      name: ""
      version: -1
    taskid: a70b8a21-3c8e-491c-8644-eacb985f5be4
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 80
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      OverrideSIEMSeverity:
        simple: "False"
      SIEMincidentFieldForID:
        simple: ${incident.externalsystemid}
      SIEMincidentFieldForType:
        simple: ${incident.externalcategoryname}
      ScaleToSetSeverity:
        simple: 0-20,21-40,41-60,61-80,81-100
      SeverityValuesMapping:
        simple: 0.5, 1, 2, 3,4
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: This playbook handles incident ingestion from the SIEM. The user
        provides the field for the incident ID or detection ID as well as the field
        indicating whether the ingested item is an incident or detection. This playbook
        enables changing the severity scale in Cortex XSOAR as well as fetching CrowdStrike
        detections based on the CrowdStrike incident type.
      id: 316cb436-a2f9-4ecb-84a8-4ad63948f871
      iscommand: false
      name: CrowdStrike Falcon - SIEM ingestion Get Incident Data
      playbookName: CrowdStrike Falcon - SIEM ingestion Get Incident Data
      type: playbook
      version: -1
    taskid: 316cb436-a2f9-4ecb-84a8-4ad63948f871
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 230,
          "y": 390
        }
      }
  "2":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.EDRProductToUse
          operator: containsGeneral
          right:
            value:
              simple: Crowdstrike
      label: Crowdstrike Falcon
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.EDRProductToUse
          operator: containsGeneral
          right:
            value:
              simple: Microsoft Defender
      label: Microsoft Defender For Endpoint
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Crowdstrike Falcon:
      - "1"
      Microsoft Defender For Endpoint:
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a90d3df8-482a-4d65-8dbd-6dca063dc081
      iscommand: false
      name: 'Which EDR Brand Should be used? '
      type: condition
      version: -1
    taskid: a90d3df8-482a-4d65-8dbd-6dca063dc081
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 220
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a67db56c-6e36-4e2b-854f-47a396846e4e
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: a67db56c-6e36-4e2b-854f-47a396846e4e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 560
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      OverrideSIEMSeverity:
        simple: "False"
      SIEMincidentFieldForID:
        simple: ${incident.externalsystemid}
      ScaleToSetSeverity:
        simple: Informational,Low,Medium,High
      SeverityValuesMapping:
        simple: 0.5, 1, 2, 3
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: This playbook handles incident ingestion from the SIEM. The user
        provides the incident field containing the alert ID. This playbook also enables
        changing the severity scale in Cortex XSOAR.
      id: 1fa9140b-c17f-4d50-8c66-e8ca0d782d6b
      iscommand: false
      name: MDE SIEM ingestion - Get Incident Data
      playbookName: MDE SIEM ingestion - Get Incident Data
      type: playbook
      version: -1
    taskid: 1fa9140b-c17f-4d50-8c66-e8ca0d782d6b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 680,
          "y": 390
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 545,
        "width": 830,
        "x": 230,
        "y": 80
      }
    }
  }
