contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 2891a9c5-a1a6-4797-80a5-d64d28120ff9
inputs: []
name: TCS-Crowdstrike Hash Removal from detection list
outputs: []
sourceplaybookid: 4cba8e1c-b958-4629-8ecf-b7cddccf9ec0
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e6b64685-131a-499a-8dda-d4d516f17c77
      iscommand: false
      name: ""
      version: -1
    taskid: e6b64685-131a-499a-8dda-d4d516f17c77
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 800,
          "y": -300
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: v.ghule@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: yogesh.gholap@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: kunal.krushev@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: internalis.cybersecurityops@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: rupesh.sane@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: nishanth.dharuman@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6b0fb442-fe25-4e0e-883b-979d6bc2a2bb
      iscommand: false
      name: Is Email From Authorized Sender ?
      type: condition
      version: -1
    taskid: 6b0fb442-fe25-4e0e-883b-979d6bc2a2bb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1300,
          "y": -135
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 86898b81-d1cc-485c-8dff-55f59fbb7388
      iscommand: true
      name: Extract Indicators From Text File
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 86898b81-d1cc-485c-8dff-55f59fbb7388
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 540,
          "y": 320
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello Human,

          You are not on my authorized list of senders to block these Hashes. Please contact Your XSOAR Support team.

          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: v.ghule@tcs.com
      subject:
        simple: Not Authorized To Send Mail For Hash blocking on CS
      to:
        complex:
          accessor: labels.Email/from
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: fb3915dc-a47e-4ac4-8191-4bc316bef8a4
      iscommand: true
      name: Send Email Notification - Not Authorized User
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: fb3915dc-a47e-4ac4-8191-4bc316bef8a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1980,
          "y": 610
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
      - "9"
      - "11"
      - "12"
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4576e2cb-e8ec-4bbb-8095-13f4f47e6890
      iscommand: false
      name: Crowdstrike  Detection
      type: title
      version: -1
    taskid: 4576e2cb-e8ec-4bbb-8095-13f4f47e6890
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 740,
          "y": 500
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      ioc_type:
        simple: domain
      policy:
        simple: none
      share_level:
        simple: red
      value:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Uploads an indicator for CrowdStrike to monitor.
      id: d176650c-2161-4a98-807e-321b8ffcfc3b
      iscommand: true
      name: Remove Domain  from Crowdstrike detection list
      script: CrowdstrikeFalcon|||cs-falcon-upload-ioc
      type: regular
      version: -1
    taskid: d176650c-2161-4a98-807e-321b8ffcfc3b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 320,
          "y": 855
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "16"
      "yes":
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${ExtractedIndicators.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 7b516667-f442-4562-8d78-a76a015acb89
      iscommand: false
      name: Are there IP to remove Detection from CS?
      script: Exists
      type: condition
      version: -1
    taskid: 7b516667-f442-4562-8d78-a76a015acb89
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -90,
          "y": 680
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      ioc_type:
        simple: ipv4
      policy:
        simple: none
      share_level:
        simple: red
      value:
        simple: ${ExtractedIndicators.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Uploads an indicator for CrowdStrike to monitor.
      id: 55fc95e4-ddfc-42b0-8bcf-a2ddc6859d59
      iscommand: true
      name: Remove  IP's  from Crowdstrike detection list
      script: CrowdstrikeFalcon|||cs-falcon-upload-ioc
      type: regular
      version: -1
    taskid: 55fc95e4-ddfc-42b0-8bcf-a2ddc6859d59
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -90,
          "y": 855
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "16"
      "yes":
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: a5cb6d91-4788-44e7-82a7-8c87df3b59f4
      iscommand: false
      name: Are there Domain to remove Detect from CS?
      script: Exists
      type: condition
      version: -1
    taskid: a5cb6d91-4788-44e7-82a7-8c87df3b59f4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 320,
          "y": 680
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      ioc_type:
        simple: md5
      policy:
        simple: none
      share_level:
        simple: red
      value:
        simple: ${ExtractedIndicators.File_MD5}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Uploads an indicator for CrowdStrike to monitor.
      id: cbd4b2cf-5751-4f3b-8d8b-9c41ee9d21f3
      iscommand: true
      name: Remove MD5  from Crowdstrike detection list
      script: CrowdstrikeFalcon|||cs-falcon-upload-ioc
      type: regular
      version: -1
    taskid: cbd4b2cf-5751-4f3b-8d8b-9c41ee9d21f3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 855
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "16"
      "yes":
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${ExtractedIndicators.File_MD5}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 7ccf435b-7dcc-4047-8358-cb721957c0f4
      iscommand: false
      name: Are there MD5 to remove Detection from CS?
      script: Exists
      type: condition
      version: -1
    taskid: 7ccf435b-7dcc-4047-8358-cb721957c0f4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 740,
          "y": 665
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "16"
      "yes":
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${ExtractedIndicators.File_SHA1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: e0dff976-c526-4bda-8623-f6bc428e11cd
      iscommand: false
      name: Are there SHA1 to remove Detection from CS?
      script: Exists
      type: condition
      version: -1
    taskid: e0dff976-c526-4bda-8623-f6bc428e11cd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 670
        }
      }
  "13":
    continueonerror: true
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      ioc_type:
        simple: SHA1
      policy:
        simple: none
      share_level:
        simple: red
      value:
        simple: ${ExtractedIndicators.File_SHA1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Uploads an indicator for CrowdStrike to monitor.
      id: e7e8551e-3440-42df-8502-508371b6fa6c
      iscommand: true
      name: Remove SHA1 from Crowdstrike detection list
      script: CrowdstrikeFalcon|||cs-falcon-upload-ioc
      type: regular
      version: -1
    taskid: e7e8551e-3440-42df-8502-508371b6fa6c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 860
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "16"
      "yes":
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${ExtractedIndicators.File_SHA256}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 465c820a-faf9-4c17-8c04-fc950dcabc2a
      iscommand: false
      name: Are there SHA256 to remove Detection from CS?
      script: Exists
      type: condition
      version: -1
    taskid: 465c820a-faf9-4c17-8c04-fc950dcabc2a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1540,
          "y": 670
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      ioc_type:
        simple: sha256
      policy:
        simple: none
      share_level:
        simple: red
      value:
        simple: ${ExtractedIndicators.File_SHA256}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Uploads an indicator for CrowdStrike to monitor.
      id: 3ed2ce38-627b-4671-867d-7ae162be8870
      iscommand: true
      name: Remove SHA256 from Crowdstrike detection list
      script: CrowdstrikeFalcon|||cs-falcon-upload-ioc
      type: regular
      version: -1
    taskid: 3ed2ce38-627b-4671-867d-7ae162be8870
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1540,
          "y": 855
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello Human,

          I have removed below IOC from crowdstrike detection list_${incident.attachment.name}

          XSOAR Investigation id - ${incident.id}


          Regards,
          Cyber AutoBot
      cc:
        simple: v.ghule@tcs.com
      subject:
        simple: IOC remove detection from Crowdstrike List  - ${incident.attachment.name}
      to:
        complex:
          accessor: labels.Email/from
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: e8abae49-0a42-4827-89e6-78b5d9babc7a
      iscommand: true
      name: Send Notification Mail
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: e8abae49-0a42-4827-89e6-78b5d9babc7a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1170
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fac99eef-d3af-48c6-8791-b751ed4a6bf7
      iscommand: false
      name: Close
      type: title
      version: -1
    taskid: fac99eef-d3af-48c6-8791-b751ed4a6bf7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1350
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 07db9db3-e165-41c8-8abe-dd477d43b8a9
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 07db9db3-e165-41c8-8abe-dd477d43b8a9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 750,
          "y": 1480
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 07ae664c-b099-4baa-8250-16feb219318a
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: 07ae664c-b099-4baa-8250-16feb219318a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 750,
          "y": 1650
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: v.ghule@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: yogesh.gholap@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: kunal.krushev@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: internalis.cybersecurityops@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: rupesh.sane@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: komal.lugade@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f439c54f-462f-4d39-8a88-8551176a1adf
      iscommand: false
      name: Is Email From Authorized Sender ?
      type: condition
      version: -1
    taskid: f439c54f-462f-4d39-8a88-8551176a1adf
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1320,
          "y": 150
        }
      }
  "21":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: inList
          right:
            value:
              simple: ${lists.AuthorizedSenders}
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: internalis.cybersecurityops@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      - "20"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 23cc206c-133e-4df0-801f-e01653d9bbeb
      iscommand: false
      name: check if sender is present in  list of authorize senders.
      type: condition
      version: -1
    taskid: 23cc206c-133e-4df0-801f-e01653d9bbeb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 800,
          "y": -95
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2015,
        "width": 2450,
        "x": -90,
        "y": -300
      }
    }
  }
