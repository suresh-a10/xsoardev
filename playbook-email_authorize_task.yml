contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 4bbb92a9-249a-4b10-8517-0c20533baeb2
inputs: []
name: email authorize task
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 286abcde-8e97-4e50-804f-0ea81a90e9bb
      iscommand: false
      name: ""
      version: -1
    taskid: 286abcde-8e97-4e50-804f-0ea81a90e9bb
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${incident.emailfrom}
      right:
        simple: ${lists.AuthorizedSenders}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 3b67e7ad-ce27-41e6-80f4-e6c90b07593b
      iscommand: false
      name: compare sender with list
      script: CompareLists
      type: regular
      version: -1
    taskid: 3b67e7ad-ce27-41e6-80f4-e6c90b07593b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 600,
          "y": 220
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ListCompare.Both
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 637532c2-988c-4bff-82df-a209ab0cd585
      iscommand: false
      name: check if sender is present in  list of authorize senders.
      type: condition
      version: -1
    taskid: 637532c2-988c-4bff-82df-a209ab0cd585
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 620,
          "y": 360
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ce5b758d-cd13-4bf9-8025-535bcc0bd531
      iscommand: false
      name: main playbook
      type: regular
      version: -1
    taskid: ce5b758d-cd13-4bf9-8025-535bcc0bd531
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -80,
          "y": 580
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello,

          You are not on my authorized list of senders to IP addition . Please contact Your XSOAR Support team.

          Regards,
          CSOC Cyber AutoBot
      subject:
        simple: 'Not Authorized ueser  for sending mail '
      to:
        complex:
          accessor: Email/from
          root: incident.labels
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 29dff15f-256b-40f5-8a6f-a7fa0fd18ceb
      iscommand: true
      name: |
        Send email notification to user-Email address is not authorized
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 29dff15f-256b-40f5-8a6f-a7fa0fd18ceb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 550
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: inList
          right:
            value:
              simple: ${lists.AuthorizedSenders}
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2aa5cfcb-fe80-4229-8b87-66f782dc003d
      iscommand: false
      name: check if sender is present in  list of authorize senders.
      type: condition
      version: -1
    taskid: 2aa5cfcb-fe80-4229-8b87-66f782dc003d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 0,
          "y": 220
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: inList
          right:
            value:
              simple: ${lists.AuthorizedSenders}
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: InternalIS.LogForensics@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: InternalIS.SecurityLogReview@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: internalis.cybersecurityops@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 00474356-c919-41d0-8d72-6254abedfa87
      iscommand: false
      name: check if sender is present in  list of authorize senders.
      type: condition
      version: -1
    taskid: 00474356-c919-41d0-8d72-6254abedfa87
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 550,
          "y": -120
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 795,
        "width": 1080,
        "x": -80,
        "y": -120
      }
    }
  }
