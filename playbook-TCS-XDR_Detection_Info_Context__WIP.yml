contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: b442d97c-fbf4-4727-8f8c-2bf025eb0f88
inputs: []
name: TCS-XDR Detection Info Context _WIP
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 49c82cd9-fb5f-4593-8666-faf36ccb3f8e
      iscommand: false
      name: ""
      version: -1
    taskid: 49c82cd9-fb5f-4593-8666-faf36ccb3f8e
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": -310
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      playbookrepository:
        simple: https://tcscomprod.sharepoint.com/:f:/r/sites/CSOC/Shared%20Documents/General/Usecases%20Information/Usecase%20Documentation/Knowledge%20Repository?csf=1&web=1&e=V9To8P
      prioritymatrix:
        simple: |-
          <table style="height: 212px; border-style: solid; width: 658px; background-color: #ffffff;" width="658">
          <tbody>
          <tr style="height: 46px;">
          <td style="height: 92px; width: 199.688px; border-style: solid;" colspan="2" rowspan="2">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Priority</span><span style="color: #0000ff;"> Matrix</span></strong></h3>
          </td>
          <td style="height: 46px; width: 442.312px; border-style: solid;" colspan="3">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Impact</span></strong></h3>
          </td>
          </tr>
          <tr style="height: 46px;">
          <td style="height: 46px; width: 124.094px; border-style: solid;">
          <h3><strong>&nbsp;1 - High</strong></h3>
          </td>
          <td style="height: 46px; width: 120.297px; border-style: solid;">
          <h3><strong>&nbsp;2 - Medium</strong></h3>
          </td>
          <td style="height: 46px; width: 185.922px; border-style: solid;">
          <h3><strong>&nbsp;3 - Low</strong></h3>
          </td>
          </tr>
          <tr style="height: 46px;">
          <td style="height: 120px; width: 93.25px; border-style: solid;" rowspan="3">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Urgency</span></strong></h3>
          </td>
          <td style="height: 46px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;1 - High</strong></h3>
          </td>
          <td style="height: 46px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff0000;">0- Critical</span></strong></h3>
          </td>
          <td style="height: 46px; width: 120.297px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff9900;">1 - High</span></strong></h3>
          </td>
          <td style="height: 46px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #00ccff;">2 - Medium</span></strong></h3>
          </td>
          </tr>
          <tr style="height: 64px;">
          <td style="height: 64px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;2 - Medium</strong></h3>
          </td>
          <td style="height: 64px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff9900;">1 - High</span></strong></h3>
          </td>
          <td style="height: 64px; width: 120.297px; border-style: solid;">
          <h3><strong><span style="color: #00ccff;">&nbsp;2 - Medium</span></strong></h3>
          </td>
          <td style="height: 64px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<span style="color: #ff00ff;"><strong>3 - Low</strong></span></h3>
          </td>
          </tr>
          <tr style="height: 10px;">
          <td style="height: 10px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;3 - Low</strong></h3>
          </td>
          <td style="height: 10px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<span style="color: #00ccff;"><strong>2 - Medium</strong></span></h3>
          </td>
          <td style="height: 10px; width: 120.297px; border-style: solid;">
          <h3><span style="color: #ff00ff;">&nbsp;<strong>3 - Low</strong></span></h3>
          </td>
          <td style="height: 10px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #339966;">4 - Informational</span></strong></h3>
          </td>
          </tr>
          </tbody>
          </table>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: a0d13dd0-d055-4665-8e13-89984489bd24
      iscommand: true
      name: 'Set Priority Matrix Table & Playbook Repository Link '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: a0d13dd0-d055-4665-8e13-89984489bd24
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 160
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsIsolated
                root: Endpoint
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex XDR - IR
      description: Set a value in context under the key you entered.
      id: 5eb749e6-1c8c-4b9d-81ec-18ad0badb339
      iscommand: false
      name: Check the Host contained Status
      type: condition
      version: -1
    taskid: 5eb749e6-1c8c-4b9d-81ec-18ad0badb339
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 320
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h1 style="text-align: center;"><em><span style="text-decoration:
          underline;"><strong><span style="color: #ff0000; text-decoration: underline;">Host
          Contained</span></strong></span></em></h1>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: b9b051c0-fe18-482c-88d9-423c267e7fa0
      iscommand: true
      name: Set 'Action Notification' Context - Host Contained
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: b9b051c0-fe18-482c-88d9-423c267e7fa0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 490
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: |
          <h1 style="text-align: center;"><span style="text-decoration: underline;"><em><strong><span style="color: #008000; text-decoration: underline;">Host Not Contained</span></strong></em></span></h1>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 585cd7af-6c58-4764-872a-dd88d48815c4
      iscommand: true
      name: Set 'Action Notification' Context - Host Not Contained
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 585cd7af-6c58-4764-872a-dd88d48815c4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 650
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c8203a0e-5ac1-4ab2-859a-5889dec54c1d
      iscommand: false
      name: 'Get WildFire Report '
      type: title
      version: -1
    taskid: c8203a0e-5ac1-4ab2-859a-5889dec54c1d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 820
        }
      }
  "7":
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Wild Fire Report
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      format:
        simple: pdf
      sha256:
        complex:
          accessor: xdrfilesha256
          root: incident
      using:
        simple: WildFire-v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: WildFire-v2
      description: Retrieves results for a file hash using WildFire.
      id: ee5ed13d-54c7-4d56-8d64-a72cb7906e2a
      iscommand: true
      name: Get Wild Fire Report
      script: WildFire-v2|||wildfire-report
      type: regular
      version: -1
    taskid: ee5ed13d-54c7-4d56-8d64-a72cb7906e2a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 1140
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5fb10ab6-9a32-4438-8a4a-01a1b4aa33c7
      iscommand: false
      name: END
      type: title
      version: -1
    taskid: 5fb10ab6-9a32-4438-8a4a-01a1b4aa33c7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1370
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: true
    quietmode: 0
    scriptarguments:
      fieldExactMatch:
        simple: incident.xdrhostnames
      fromDate:
        simple: 12 months ago
      similarTextField:
        simple: incident.xdrhostnames
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Find past similar incidents based on incident fields' similarity.
        Includes an option to also display indicators similarity.
      id: 171df713-d64f-4bcd-8fed-4fed247a07d8
      iscommand: false
      name: Find Past Detection For Same Host
      script: DBotFindSimilarIncidents
      type: regular
      version: -1
    taskid: 171df713-d64f-4bcd-8fed-4fed247a07d8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": -10
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "11"
      "yes":
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      brandname:
        simple: WildFire-v2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'.
      id: d6f06ab2-2f20-42de-8a9f-017483ae7e76
      iscommand: false
      name: Is WildFire enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: d6f06ab2-2f20-42de-8a9f-017483ae7e76
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 960
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e67eb25b-b726-47c1-8d2f-14c44223058a
      iscommand: false
      name: Integration is not available
      type: title
      version: -1
    taskid: e67eb25b-b726-47c1-8d2f-14c44223058a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 650,
          "y": 1155
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      emp:
        complex:
          accessor: xdrhostnames
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 168eccf4-e849-4e61-8f32-79d5277eee81
      iscommand: false
      name: TCS-Create User Indicator & Relate To Incident v1.0
      playbookId: a8f14eae-50f0-476d-84bb-1c0d7fb01027
      type: playbook
      version: -1
    taskid: 168eccf4-e849-4e61-8f32-79d5277eee81
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1070,
          "y": -245
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      emp:
        complex:
          accessor: xdrhostnames
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 977b861e-cf4d-475a-89ff-35c7a0bbbf6b
      iscommand: false
      name: TCS-XDR Create User Indicator & Relate To Incident v1.0_WIP
      playbookId: 2fcbbdea-c94f-4797-8fbc-af4490002453
      type: playbook
      version: -1
    taskid: 977b861e-cf4d-475a-89ff-35c7a0bbbf6b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 450,
          "y": -170
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1745,
        "width": 1240,
        "x": 210,
        "y": -310
      }
    }
  }
