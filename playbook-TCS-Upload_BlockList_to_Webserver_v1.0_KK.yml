contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: dbc273f1-c131-4e07-80e6-4babc78a9e03
inputs:
- description: ""
  key: File
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: EmailedFileData
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Upload BlockList to Webserver v1.0_KK
outputs:
- contextPath: EmailedDomains
  description: Global Context Key for Domains received by Email
  type: unknown
- contextPath: EmailedIPs
  description: Global Context Key for IPs received by Email
  type: unknown
- contextPath: EmailedHashs-MD5
  description: Global Context Key for MD5 Hashs received by Email
  type: unknown
- contextPath: EmailedHashs-SHA1
  description: Global Context Key for SHA1 Hashs received by Email
  type: unknown
- contextPath: EmailedHashs-SHA256
  description: Global Context Key for SHA256 Hashs received by Email
  type: unknown
- contextPath: JoinedFilesUnique
  description: Global Context Key for emailed IP's joined with IP Blocklist EDL and
    deduped
  type: unknown
- contextPath: EmailedDomainsURLsUnique
  description: Global Context Key for emailed Domains/URL's joined and deduped
  type: unknown
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ac34f05a-b09a-42f1-8bee-ae381f4c4662
      iscommand: false
      name: ""
      version: -1
    taskid: ac34f05a-b09a-42f1-8bee-ae381f4c4662
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 70,
          "y": -440
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.File.Name
          operator: isEqualString
          right:
            value:
              simple: Demisto_Block1.txt
      label: Recorded Future
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.File.Name
          operator: isEqualString
          right:
            value:
              simple: MaliciousIPAddr.txt
        - left:
            iscontext: true
            value:
              simple: inputs.File.Name
          operator: isEqualString
          right:
            value:
              simple: MaliciousDomain.txt
        - left:
            iscontext: true
            value:
              simple: inputs.File.Name
          operator: isEqualString
          right:
            value:
              simple: MaliciousURL.txt
        - left:
            iscontext: true
            value:
              simple: inputs.File.Name
          operator: isEqualString
          right:
            value:
              simple: MaliciousHash.txt
      label: Emailed Malicious IOC's
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Emailed Malicious IOC's:
      - "16"
      Recorded Future:
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 35c70dd2-7347-4cae-8846-be076f112522
      iscommand: false
      name: Is this incident from a Recorded Furture or Email trigger
      type: condition
      version: -1
    taskid: 35c70dd2-7347-4cae-8846-be076f112522
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 70,
          "y": -300
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      dest-dir:
        simple: /var/lib/tomcat6/webapps/ROOT
      fileID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.File.Name
              operator: isEqualString
              right:
                value:
                  simple: Demisto_Block1.txt
          root: inputs.File
      using:
        simple: remoteaccess_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: remoteaccess
      description: commands.server.remoteacess.copyto.description
      id: fd074838-2d31-4f4f-8bd1-0965d331b3ba
      iscommand: true
      name: Upload recordedfuture.csv (overwrite existing)
      script: remoteaccess|||copy-to
      type: regular
      version: -1
    taskid: fd074838-2d31-4f4f-8bd1-0965d331b3ba
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -560,
          "y": 640
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      file:
        simple: /var/lib/tomcat6/webapps/ROOT/Demisto_Block2.txt
      using:
        simple: remoteaccess_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: remoteaccess
      description: commands.server.remoteacess.copyfrom.description
      id: fca2aba9-c553-405d-8f1f-e4c468365ba7
      iscommand: true
      name: Download Email Block list from Webserver
      script: remoteaccess|||copy-from
      type: regular
      version: -1
    taskid: fca2aba9-c553-405d-8f1f-e4c468365ba7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 475
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: /var/lib/tomcat6/webapps/ROOT/Demisto_Block2.txt
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 9768dbf3-b004-490a-85f3-73e4ef57ebae
      iscommand: false
      name: Read downloaded Email blocklist into context
      script: ReadFile
      type: regular
      version: -1
    taskid: 9768dbf3-b004-490a-85f3-73e4ef57ebae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 630
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      dest-dir:
        simple: /var/lib/tomcat6/webapps/ROOT
      entry:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: Demisto_Block2.txt
          root: File
      using:
        simple: remoteaccess_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: remoteaccess
      description: commands.server.remoteacess.copyto.description
      id: b10eb7a5-525d-4668-8ed9-b90b3d486e05
      iscommand: true
      name: Upload updated Block Email file to Webserver
      script: remoteaccess|||copy-to
      type: regular
      version: -1
    taskid: b10eb7a5-525d-4668-8ed9-b90b3d486e05
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1100
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: JoinedFiles
      value:
        simple: |-
          ${FileData}
          ${inputs.EmailedFileData}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: 836b6b90-1fd5-4500-8e58-a73985c79e89
      iscommand: false
      name: Append the list of IOC's from the email to the Email Block List
      script: Set
      type: regular
      version: -1
    taskid: 836b6b90-1fd5-4500-8e58-a73985c79e89
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 630
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7c72158f-20d2-4e19-8765-820fc3bbc5d0
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 7c72158f-20d2-4e19-8765-820fc3bbc5d0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1260
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      data:
        complex:
          root: ${JoinedFilesUnique}
          transformers:
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      filename:
        simple: Demisto_Block2.txt
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Will create a file (using the given data input or entry ID) and upload it to current investigation war room.
      id: db21c3ad-5bd3-4cd0-8ea7-4276fa275164
      iscommand: false
      name: Create final block ip file to be uploaded to webserver
      script: FileCreateAndUpload
      type: regular
      version: -1
    taskid: db21c3ad-5bd3-4cd0-8ea7-4276fa275164
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 950
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      data:
        simple: ${FileData}
      filename:
        simple: Demisto_Block2-${incident.id}.txt
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Will create a file (using the given data input or entry ID) and upload it to current investigation war room.
      id: 6cfe05e8-a5fa-4b54-858c-ac8b0056a250
      iscommand: false
      name: Create backup of downloaded Blocklist (appending IncidentID)
      script: FileCreateAndUpload
      type: regular
      version: -1
    taskid: 6cfe05e8-a5fa-4b54-858c-ac8b0056a250
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 950
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      dest-dir:
        simple: /var/lib/tomcat6/webapps/ROOT/backup
      entry:
        complex:
          accessor: EntryID
          root: File
          transformers:
          - operator: LastArrayElement
      using:
        simple: remoteaccess_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: remoteaccess
      description: commands.server.remoteacess.copyto.description
      id: 11663f34-f5c5-401d-8c19-7a27d692522c
      iscommand: true
      name: Upload backup Block  copy of Email file to Webserver
      script: remoteaccess|||copy-to
      type: regular
      version: -1
    taskid: 11663f34-f5c5-401d-8c19-7a27d692522c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 1100
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: JoinedFilesUnique
      value:
        complex:
          root: JoinedFiles
          transformers:
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:\[\.\]|\.)){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\b
            operator: RegexExtractAll
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: 2ab36415-6c5f-462c-83ab-ef4ffd19d4d5
      iscommand: false
      name: Deduplicate new joined file
      script: Set
      type: regular
      version: -1
    taskid: 2ab36415-6c5f-462c-83ab-ef4ffd19d4d5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 800
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 774377fb-8947-4750-8377-be2831d806bb
      iscommand: false
      name: 'Trigger#1: Recorded Future '
      type: title
      version: -1
    taskid: 774377fb-8947-4750-8377-be2831d806bb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -560,
          "y": 140
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f83590da-4bc0-4b0a-875e-24984c4de93d
      iscommand: false
      name: 'Trigger#2: Emailed IP IOC''s'
      type: title
      version: -1
    taskid: f83590da-4bc0-4b0a-875e-24984c4de93d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 520,
          "y": -110
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4fd1eadf-4402-49fd-81a8-040f3519068b
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 4fd1eadf-4402-49fd-81a8-040f3519068b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -560,
          "y": 795
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5485115e-d800-408f-8729-a305d1867586
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 5485115e-d800-408f-8729-a305d1867586
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 1560
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      data:
        simple: ${lists.RecordedFutureIPRiskList}
      filename:
        simple: Demisto_Block1.txt
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Will create a file (using the given data input or entry ID) and upload it to current investigation war room.
      id: e9b4ea20-4639-4928-88f2-4612fc0d3970
      iscommand: false
      name: Grab Recorded Future IP Risk List and place into context
      script: FileCreateAndUpload
      type: regular
      version: -1
    taskid: e9b4ea20-4639-4928-88f2-4612fc0d3970
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -560,
          "y": 475
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.File.Name
          operator: isEqualString
          right:
            value:
              simple: MaliciousIPAddr.txt
      label: Emailed IP IOC's
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "31"
      Emailed IP IOC's:
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5fd18e65-9c13-4174-884d-628a5b66e3b6
      iscommand: false
      name: Is this incident from a Recorded Furture or Email trigger
      type: condition
      version: -1
    taskid: 5fd18e65-9c13-4174-884d-628a5b66e3b6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 510,
          "y": 185
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ca3ca945-03c4-4a9b-85b7-839bef364242
      iscommand: false
      name: Process MaliciousIPAddr.txt
      type: title
      version: -1
    taskid: ca3ca945-03c4-4a9b-85b7-839bef364242
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 510,
          "y": 360
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f93612c9-1b11-4891-8ba0-378b07723715
      iscommand: false
      name: Process MaliciousDomain.txt and MaliciousURL.txt
      type: title
      version: -1
    taskid: f93612c9-1b11-4891-8ba0-378b07723715
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 360
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.File.Name
          operator: isEqualString
          right:
            value:
              simple: MaliciousDomain.txt
        - left:
            iscontext: true
            value:
              simple: inputs.File.Name
          operator: isEqualString
          right:
            value:
              simple: MaliciousURL.txt
      label: Emailed Domain IOC's
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "32"
      Emailed Domain IOC's:
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: cc3e7d37-3ced-4448-8ca1-7eb2f5cc2fd9
      iscommand: false
      name: Is this incident from a Recorded Furture or Email trigger
      type: condition
      version: -1
    taskid: cc3e7d37-3ced-4448-8ca1-7eb2f5cc2fd9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 205
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.File.Name
          operator: isEqualString
          right:
            value:
              simple: MaliciousHash.txt
      label: Emailed Hash IOC's
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "43"
      Emailed Hash IOC's:
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a086b12f-c1d2-484f-852d-5f48b077d537
      iscommand: false
      name: Is this incident from a Recorded Furture or Email trigger
      type: condition
      version: -1
    taskid: a086b12f-c1d2-484f-852d-5f48b077d537
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2360,
          "y": 185
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3ed15af1-f1b5-4a8b-8826-3f86c3ecb073
      iscommand: false
      name: Process MaliciousHash.txt
      type: title
      version: -1
    taskid: 3ed15af1-f1b5-4a8b-8826-3f86c3ecb073
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2360,
          "y": 345
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedDomains
      value:
        complex:
          root: FileData
          transformers:
          - operator: LastArrayElement
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: 062fa667-1f2d-4ae2-8abe-973c109840a9
      iscommand: false
      name: Set Malicious Domain FileData into it's own key
      script: Set
      type: regular
      version: -1
    taskid: 062fa667-1f2d-4ae2-8abe-973c109840a9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 650
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.File.Name
              operator: isEqualString
              right:
                value:
                  simple: MaliciousDomain.txt
          root: inputs.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 6f054270-1659-4602-8855-e6e54b3c41bf
      iscommand: false
      name: Read Emailed Malicious Domain File into context
      script: ReadFile
      type: regular
      version: -1
    taskid: 6f054270-1659-4602-8855-e6e54b3c41bf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 500
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6d00ca1f-994a-4e77-87df-6fb4f8eb8fb1
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 6d00ca1f-994a-4e77-87df-6fb4f8eb8fb1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1890,
          "y": 1270
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      encoding:
        simple: utf-8
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.File.Name
              operator: isEqualString
              right:
                value:
                  simple: MaliciousHash.txt
          root: inputs.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: fab77b6a-b733-4553-8421-0a0fa6739b4c
      iscommand: false
      name: Read Emailed Malicious Hash File into context
      script: ReadFile
      type: regular
      version: -1
    taskid: fab77b6a-b733-4553-8421-0a0fa6739b4c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2360,
          "y": 470
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedHashs-SHA256
      value:
        complex:
          root: FileData
          transformers:
          - operator: LastArrayElement
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[a-fA-F\d]{64}\b
            operator: RegexExtractAll
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: 6cbed276-7bab-40fa-85d3-c40c02224739
      iscommand: false
      name: Set Malicious SHA-256 Hash FileData into it's own key
      script: Set
      type: regular
      version: -1
    taskid: 6cbed276-7bab-40fa-85d3-c40c02224739
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2360,
          "y": 1100
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
      - "9"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.File.Name
              operator: isEqualString
              right:
                value:
                  simple: MaliciousIPAddr.txt
          root: inputs.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 5a2fbcf2-870b-4aa0-8c02-97f8dba64734
      iscommand: false
      name: Read Emailed Malicious IP File into context
      script: ReadFile
      type: regular
      version: -1
    taskid: 5a2fbcf2-870b-4aa0-8c02-97f8dba64734
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 800
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedIPs
      value:
        complex:
          root: FileData
          transformers:
          - operator: LastArrayElement
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: de10da92-e8ea-47b5-8710-6e263fefef98
      iscommand: false
      name: Set Malicious Domain FileData into it's own key
      script: Set
      type: regular
      version: -1
    taskid: de10da92-e8ea-47b5-8710-6e263fefef98
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 480
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedHashs-MD5
      value:
        complex:
          root: FileData
          transformers:
          - operator: LastArrayElement
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[a-fA-F\d]{32}\b
            operator: RegexExtractAll
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: f28475ef-0578-41a9-838e-2c1e5830a994
      iscommand: false
      name: Set Malicious MD5 Hash FileData into it's own key
      script: Set
      type: regular
      version: -1
    taskid: f28475ef-0578-41a9-838e-2c1e5830a994
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2360,
          "y": 675
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedHashs-SHA1
      value:
        complex:
          root: FileData
          transformers:
          - operator: LastArrayElement
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[a-fA-F\d]{40}\b
            operator: RegexExtractAll
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: be15daea-6751-436a-88a8-7599a2a48aff
      iscommand: false
      name: Set Malicious SHA-1 Hash FileData into it's own key
      script: Set
      type: regular
      version: -1
    taskid: be15daea-6751-436a-88a8-7599a2a48aff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2360,
          "y": 895
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a0908422-d528-4fb0-83f8-8b72aeda3024
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: a0908422-d528-4fb0-83f8-8b72aeda3024
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2350,
          "y": 1390
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.File.Name
              operator: isEqualString
              right:
                value:
                  simple: MaliciousURL.txt
          root: inputs.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: cc0372f2-d7d3-4386-8f77-381f57abe59a
      iscommand: false
      name: Read Emailed Malicious URL File into context
      script: ReadFile
      type: regular
      version: -1
    taskid: cc0372f2-d7d3-4386-8f77-381f57abe59a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 800
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedURLs
      value:
        complex:
          root: FileData
          transformers:
          - operator: LastArrayElement
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: 001ab926-65ff-400e-86e4-d01d6af61f4a
      iscommand: false
      name: Set Malicious URL FileData into it's own key
      script: Set
      type: regular
      version: -1
    taskid: 001ab926-65ff-400e-86e4-d01d6af61f4a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 950
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedDomainsURLsJoined
      value:
        simple: |-
          ${EmailedDomains}
          ${EmailedURLsReduced}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: 4cca0f5b-4f7d-439d-8796-6e440788ed67
      iscommand: false
      name: Append the list of IOC's from the email to the Email Block List
      script: Set
      type: regular
      version: -1
    taskid: 4cca0f5b-4f7d-439d-8796-6e440788ed67
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1890,
          "y": 630
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedDomainsURLsUnique
      value:
        complex:
          root: EmailedDomainsURLsJoined
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: 9f5cb5c8-6197-4075-8958-2895839514fb
      iscommand: false
      name: Deduplicate new joined file
      script: Set
      type: regular
      version: -1
    taskid: 9f5cb5c8-6197-4075-8958-2895839514fb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1890,
          "y": 800
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedURLsReduced
      value:
        complex:
          root: EmailedURLs
          transformers:
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: https?:\/\/([-\d\p{L}+&@#%=~_$?!\-:,.;*–—―|]+)
            operator: RegexExtractAll
          - operator: uniq
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: c1f12fdd-3773-4e10-807b-7e217fc8b75e
      iscommand: false
      name: Set Reduced Malicious URL FileData into it's own key
      script: Set
      type: regular
      version: -1
    taskid: c1f12fdd-3773-4e10-807b-7e217fc8b75e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1890,
          "y": 475
        }
      }
  "49":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: FileData.[4]
          operator: match
          right:
            value:
              simple: \b[a-fA-F\d]{32}\b
      label: MD5 Hashs Exist
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "50"
      MD5 Hashs Exist:
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5efaf556-6ad1-4045-8fa0-4cafd343aead
      iscommand: false
      name: Are there any MD5 hashs?
      type: condition
      version: -1
    taskid: 5efaf556-6ad1-4045-8fa0-4cafd343aead
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2780,
          "y": 640
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: FileData.[4]
          operator: match
          right:
            value:
              simple: \b[a-fA-F\d]{40}\b
      label: SHA1 Hashs Exist
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "51"
      SHA1 Hashs Exist:
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 93640ff6-591e-426e-8c99-74f8cfabbd69
      iscommand: false
      name: Are there any SHA1 hashs?
      type: condition
      version: -1
    taskid: 93640ff6-591e-426e-8c99-74f8cfabbd69
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2780,
          "y": 870
        }
      }
  "51":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: FileData.[4]
          operator: match
          right:
            value:
              simple: \b[a-fA-F\d]{64}\b
      label: SHA256 Hashs Exist
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "43"
      SHA256 Hashs Exist:
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7f28e0e3-1b63-41bc-8999-a87819dfbd0c
      iscommand: false
      name: Are there any SHA256 hashs?
      type: condition
      version: -1
    taskid: 7f28e0e3-1b63-41bc-8999-a87819dfbd0c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2780,
          "y": 1080
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3e7acf0b-9e24-4e48-8946-e24803c907ba
      iscommand: false
      name: Process Recorded Future IP Recorded Future IOC List
      type: title
      version: -1
    taskid: 3e7acf0b-9e24-4e48-8946-e24803c907ba
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -560,
          "y": 335
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c729f289-5118-4cbe-8ee2-acd153192284
      iscommand: false
      name: Process Domain/URL Recorded Future IOC Lists
      type: title
      version: -1
    taskid: c729f289-5118-4cbe-8ee2-acd153192284
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -120,
          "y": 360
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedDomains
      value:
        simple: ${lists.RecordedFutureDomainRiskList}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: bd22e185-ae5f-4c1b-8f55-cba6f1782bb0
      iscommand: false
      name: Set Malicious Domain XSOAR list into it's own key
      script: Set
      type: regular
      version: -1
    taskid: bd22e185-ae5f-4c1b-8f55-cba6f1782bb0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 485
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedURLs
      value:
        simple: ${lists.RecordedFutureURLRiskList}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: 657c08d1-7059-4df2-8175-82b616d7c339
      iscommand: false
      name: Set Malicious URL XSOAR List into it's own key
      script: Set
      type: regular
      version: -1
    taskid: 657c08d1-7059-4df2-8175-82b616d7c339
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 640
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedDomainsURLsUnique
      value:
        complex:
          root: EmailedDomainsURLsJoined
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: 313c7b28-7df7-476d-8819-bcbedc0fc36b
      iscommand: false
      name: Deduplicate new joined file
      script: Set
      type: regular
      version: -1
    taskid: 313c7b28-7df7-476d-8819-bcbedc0fc36b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 1090
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2a16a548-78a9-4f93-84ca-25a51c8bd3d7
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 2a16a548-78a9-4f93-84ca-25a51c8bd3d7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -120,
          "y": 1410
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedURLsReduced
      value:
        complex:
          root: EmailedURLs
          transformers:
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: https?:\/\/([-\d\p{L}+&@#%=~_$?!\-:,.;*–—―|]+)
            operator: RegexExtractAll
          - operator: uniq
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: 6e7f6ac4-6390-47e8-89d4-ac8e3f278815
      iscommand: false
      name: Set combined Malicious URL/Domain list into it's own key
      script: Set
      type: regular
      version: -1
    taskid: 6e7f6ac4-6390-47e8-89d4-ac8e3f278815
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 790
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      listData:
        complex:
          root: ${EmailedDomainsURLsUnique}
      listName:
        simple: RecordedFutureURLDomainRiskList
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 98273ecd-ce48-4d9b-8f83-16ea8b26e533
      iscommand: true
      name: Overwrite Recorded Future URLDomainRiskList List
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 98273ecd-ce48-4d9b-8f83-16ea8b26e533
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 1250
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: EmailedDomainsURLsJoined
      value:
        simple: ${EmailedDomains}${EmailedURLsReduced}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets a value into the context with the given context key
      id: 699740ef-fb8c-4aa6-876c-80f85e2268c4
      iscommand: false
      name: Append the list of IOC's from the email to the Email Block List
      script: Set
      type: regular
      version: -1
    taskid: 699740ef-fb8c-4aa6-876c-80f85e2268c4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 940
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: internalis.cybersecurityops@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c8071a5c-4563-4950-85a2-4e2710557296
      iscommand: false
      name: IS  this incident for authorized email id
      type: condition
      version: -1
    taskid: c8071a5c-4563-4950-85a2-4e2710557296
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 520,
          "y": 30
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "32_33_Emailed Hash IOC's": 0.42,
      "32_43_#default#": 0.39
    },
    "paper": {
      "dimensions": {
        "height": 2065,
        "width": 3720,
        "x": -560,
        "y": -440
      }
    }
  }
