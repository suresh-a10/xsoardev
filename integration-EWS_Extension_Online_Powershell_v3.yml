category: Email
commonfields:
  id: EWS Extension Online Powershell v3
  version: -1
configuration:
- defaultvalue: https://outlook.office365.com
  display: Exchange Online URL
  name: url
  required: true
  section: Connect
  type: 0
- additionalinfo: A pfx certificate encoded in Base64.
  display: ""
  displaypassword: Certificate
  hiddenusername: true
  name: certificate
  required: true
  section: Connect
  type: 9
- display: ""
  displaypassword: Password
  hiddenusername: true
  name: password
  required: true
  section: Connect
  type: 9
- display: The organization used in app-only authentication.
  name: organization
  required: true
  section: Connect
  type: 0
- display: The application ID from the Azure portal
  name: app_id
  required: true
  section: Connect
  type: 0
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.5.0
    itemVersion: 1.5.1
    packID: MicrosoftExchangeOnline
    packName: Microsoft Exchange Online
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: Use the EWS Extension Online Powershell v3 integration to get information
  about mailboxes and users in your organization.  This integration can also retrieve
  and modify Tenant Allow/Block Lists.
detaileddescription: "## EWS Extension Online Powershell v3\n\n### App authentication\nTo
  use this integration, you need to connect an application with a certificate.\n1.
  Create the application:\n   1. Access **portal.azure.com**.\n   2. Navigate to **Home**
  > **App registrations** > **EWS**\n   3. In the left menu, click **API permissions**.\n
  \  4. Click **Add a permission**.\n   5. In the Request API permissions page, click
  **APIs my organization uses**.\n   6. Search for **Office 365 Exchange Online**.\n
  \  7. Click **Application permissions**.\n   8. Under Exchange, click the **ExchangeManageAsApp**
  checkbox.\n   9. Click **Add permissions**.\n   10. Click **Grant admin consent
  for XSOAR**.\n2. Create the certificate in Cortex XSOAR.\n   1. Run the **CreateCertificate**
  command in the Playground to acquire the certificate. \n\n      ***!CreateCertificate
  days=<# of days> password=\\<password>***\n\n     *Note: Remember your password
  since you will need it to create your integration instance.*\n\n   2. Download the
  certificateBase34.txt file.\n   3. Open the downloaded txt file and copy the text.\n
  \  4. In the integration instance configuration, paste the text in the **Certificate**
  field.\n\n\n3. Attach the .cer file to your Azure app.\n    1. In the Cortex XSOAR
  Playground, download the publickey.cer file\n    2. In the Azure application, in
  the left menu, click **Certificates & secrets**.\n    3. In the Certificates tab,
  upload the publickey.cer file.\n\n\n4. Assign Azure AD roles to the application.\n
  \   1. You have two options:\n        - Assign Azure AD roles to the application.\n
  \       - Assign custom role groups to the application using service principals.\n
  \   2. In the Azure AD portal at https://portal.azure.com/, start typing roles and
  administrators in the Search box at the\n       top of the page, and then select
  Azure AD roles and administrators from the results in the Services section.\n    3.
  On the Roles and administrators page that opens, find and select one of the supported
  roles by clicking on the\n       name of the role (not the checkbox) in the results.\n
  \   4. On the Assignments page that opens, select **Add assignments**.\n    5. In
  the Add assignments flyout that opens, find and select the app that you created
  in Step 1.\n\n\nNote: The information in the Playground is sensitive information.
  You should delete the information by running the following command:\n\n   ***!DeleteContext
  all=yes***\n\n5. In Cortex XSOAR, in the integration instance configuration, enter
  your saved password in the **Password** field.\n6. In Azure, go to Azure Active
  Directory (Overview blade) and copy the **Primary domain** field.\n7. In Cortex
  XSOAR, in the integration instance configuration, paste the Domain name in **The
  organization used in app-only authentication** field.\n8. In the Azure app, navigate
  to **Home** > **App registration** > **\\<application name>** and copy the Application
  (client) ID.\n9. In Cortex XSOAR, in the integration instance configuration, paste
  the application ID in **The application ID from the Azure portal** field.\n\n\n\n\n---\n[View
  Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/ews-extension-online-powershell-v3)"
display: EWS Extension Online Powershell v3
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAYAAACXpx/YAAAAAXNSR0IArs4c6QAADIVJREFUeAHtXHt0FNUZv/fOYzebJ3k1CQ8THiaBBLAEiuIRAu2hoqinSrR6xIqeoq1gRast2rr8UThYPT5QKigeDvScUkCl1lePWiggL4MYFWMMLxMgaTYk2WR3Z+dx7+13JxGBJmQ3BJgN+U4mMztzHzPf737f/b7vfjMYXQLEEcJos1ea21SWUdUSzg1o+PKcZNeiIQr62Uu3jfy0L7NA7ksPZwM5BUmPPeSLqzrRMPh4IDysNmiMzOB0tL6djKC8ZRjjPJViBVWeCKH7ipNpX3r+zp4lZgEGMAniXJr28s7MFtM1tMGkBUMYv0K3+KhARVUuZySLEqJSJEExghADLDmDDWoiHbkUAj/6PjkeYFsqvUiae3lVylet5sCmkJ7fRq3R2RYr1hbvHGoYbBDF4RQmKYhxDEACbgz2Akza5wW02xHqKICFVK6tqI/72z5fVnMofHlDiBRkWdaoMLVGWQdP5FFK0ylRJQpTajuIUEMIpACV6t0+7KVYwDEAZyz5+Pl0JuVbbx8YYZhYqFdPu3oVYIKKtdUrHFPjUsSpx8/sGIBPGMp8G0RbvYJYUgseSmz9dC4ccAzAyOpXsecCZFd1Qff1U1/mgHMk+CJyGSYEmNzB7eoFElZCLzTTa030AwysnLyi/OffhMhcFu65AUdgjGAiaWNUa/1n/vdXY6/XEX52HwIYZEfIYfu/dqs7Qjlo0HFug4avQYbwuXpKoi5HfpNMn5o1swUh7xs9bak368UQwICerNr4EQzH4DYRsQNrW+wwYjpIURh+BCBaxUyGIbAVIWAYGrN96W6sdtyFFrf7ae8rbCKUlpSyGkDqBzjykYqRR0XNOfFog85oYxxRmjjiTUR1t0im0ZzgSWpNdfMADVttlw0YEPq2pWn81nrrA93sBrCOG4jjKKQS1GxJ0gDWWfQLgJUFtpw3wQA6Y9TACYaSKIcAt7gEYDMuJ0b+bOe3ZGxIMCEoXiGHqhZMeACkFWTk7PST5XtMGABnL3TK1fEu9Gp6Bt54pF564ts26X7LFF101AdwVRlrYzKUB5BO35FMelrDASiZlOC6fo/PXGWZHfaVCMo4hGIDYGAWhdUDWPLjqNTbLessiiMT3Y6WVs4tCcFhiM9C8/LG7/LVIemPZof0KyC6eUl83u77x7/WVcelK8r3d6G8u6pywc7HDMBncsTr9ZKjRTcXyUx1n3mtJqgV86ZuBf1ktVXbfYl+PZyEpg0+fnjDxEVjn9+buL8FP4RBegtT2Cv75l+5GjQHWry1OkOicS5RkWqavnDGCJ/dCOhke+/Af469se54lTrhjoSVn/ve9VtkIFhapxSHORHmQdOKXE2+9kXNvZUh6cmnl2xf+eLU3KUN/67N58SFBrv0TxYWJy2Axjm4UvOf2dn0OKXMDf4QSnPxCl6+YhoumRv5SDrlLi/UYcwCHAoQ3GoyosFsa8ewz4FjPoO7WkJWssyk387/T81Mn44KXFhvGJul3jWrdFSwdOW++Xsa9Gd1g4rRY4dEMOcp59DlBavq1KkjIgaAW3SawRNRpU4KSQAb/CHLstDxAC8gkoRyEvnCN2ePq5wM4O4W4OoWFBFaQXTJERauVQxQzEpwWGkVmLgRLPTDemI7q2kHAOfAe0xklC7TD6sXXLVmwrJdd++pDz1jmCKT4IyxxL+fd1VFMTF3pqaOWYCTTE0fkqxuqg/hzKBuIsqYlJWgZPtNKzWg4yFiHo6eMHJJNDxjROLDE5fvufWLRrbCsCDnxw6sfN8egUGV5eZfo7fr7Mm/uiU01U5CiL7D814jZgFeUHaVBiy/FzgkDNx27r87T82vuqMsRPEaakYeV6aMSzanJRllx7F/VjUG8z73sVcNisBL4m2AsGZgNZNbIKXgkw+KY7tfmzl8Dhrh5WNe2DXnqya+CLJNzjtYPekgpudgoTdhs1ME7OMZy3S/haPmdKab1Kki7gkg1Qf5tPJ66+865eAOcZQaLx+bOyZj+tB4ssyjyiYCFd4YZtnz3jv446v/su/2b/x8BWgPiKF+L+E9AeJ81YlpgDtjCqMsqiCHaGNb6sE1RSn4adWlIM3iqTpFLtuggrm8McgLNh3wP7t8Suofpg2Mn5Kqsu0aUoZ82Wy9vrc+tAYsa/lcrfjOnqO3zsWsivau369WmujGD462tRimruclxKHBKW50rNUobhER/yjocVdh+p4hrz9ZYFznO8KUpeYp6p2BZV0bIlNmf/Tfd2bnqdf9YbQ89fZtaFFNK3/U4BhUu7ON6ZgFGCmG56MD2gpYnhuAwaCt8luoujUImpKBpo2O6Zvr9DlDtRsmX53tfkTmAfJ1q7SYU/B5Yb71SJyGTZM06OqkVdXGO1/V6DdVPVL6+I9e3Lujus1c4ddJDqLRDagoxt45F41ZFe02k7hBuQZAQE47Ax+WIgPix0YUEazvuNdiIFajSdPXVzXt+DZoXI+gLQxLkyky33/zsJQ5qkJMbupiuWnSNt21acYLW9P3PDDu7Ruz5GlZHrxTlHUqxSzAvc5QSMeFxaDEkEUmcVnBCTKtunek/NNtxwMFBpJsBLlloDYAeWeb/OaUlzZnrb675Os7c6VrM1T6vvCfnUgxC7AIdBDMPUgBY1dIkAh4EJgSIU58MqsjWo4L3xl83niJVhV76Iwqf2JSncYeZPbyYXtjNshUmXSo1f0KX79eWlpW4i9KUv+ktDta0fZ43ss7c9hF8NgjTTU0PJktqWzS0xNceHDAYImShDMYJymMsR+AnZUctesCUpiisNpJGcrNb6X8+ejwmoe36EzynGlIcZhzgwrPQ0ObxWiiTBHpIM50k2IW4LKyUSKS8ZQYC7DoDk4sbLNm4S1PrVdu+evOe3RZflFIW0Qk4BHgqqz2mgz3DZt+ecX+0c+VP1ar8StVrGscQt7gAMed6g5BcOSkv82pCHU5k2JLRfu8nYqJHeQQAY8NG2hpHg6fCJhtsBwQMcddYIZnqbz+6kzP9QDuZzNe/fSaA23WkyLhqyQr7jeFae5b4t2K3wV6WIUEAFWWkCdG3k6MIQnG0sejfR7unaUh7xYRverSF5JkFtUy08RsZXVynLJ26cxRNfetqcjceDS4SqdSnEeix2/KSXjjkZn5jbPXVU5o0klKyIQwh6IgjxFuQyVzow6qRDzqeqlgbAAM7/b6NVJ47YbqClVZ7CNL0LFsjGrcRD6a4SE+i9PaAYpSn+NJavzduGEtEzZuJ1oUDHq5bOwxURwWKNx5T+9e3WxKw8VLbmEk5yz5vHHdnWsqbl9zW+E3Zzb5nY4gWMzBzqTYABh4BzlZStAkeUGM89qtZUg0h/NHdYYwDAAMKwES0VrfONLQoBCcEDaMiM0eYQ2vHDAuYeyyT547HibX8o73pBik5LZgddpH9eF/3bq6/JZ1d42r6QzG6as+TT+LQumsygU7FzMA2xwR67xiFhZv6wOJw5OWDsIK5EKnAeppYBXBLnKhmuwf/ouKw/4nQpqVe+aqkDDU6oPy2LeOmDtSF+9s/H8gCSRbsgwT8gFOku2qnfx1UQ9iC+CzsgrgFn6sQB2oY9f+o5v/9SGW2WaS3C6/CADrFzommbrOM9v97FMbFH0CuN8lGQiDmrK2U0tczOM+BHDP2QivNUBlcCgikbyuEglEXdhUt4p8geCven43vVuzH2Dg52XxUpOGpIMUXn7pKREYIEGLN+bFm//Yer+2DjsE4n6AAdEP7/nhqjpUtzYbZUej2U8bC3V1CGevLDXwwi0WfvC0Sxf1Rz/AwH6M7TchHO/T9mSk9Fwn9aS3/joXnAOOkWAMq0K2/XLaB8t6rDEvOCOd2qFjAIZVnF+7JFwEHzMrChg8lzL4lBKWFWp/0A6APg14p7LTefflGIBP/H7icoARI/jW5KJHqz2fHDeHHNNCw5tCKD9IaTFHpChM8SDOWJoFr+LaAQ57lQ6OmJD0fmnvbHg5BmBxcyJcgLbAx7G2jGiFn192bAI6jMrL5bsPpaXVBAJDj7Vp+ZCdM7rVRPmagYZZBA2E96/jYRBASBNqnZT2yKNZUKtPkqMA7orDNvAlJSKzrb5j2yHKApZk0ebD6vbDjTmBsJTfEDALwpwXBy1WCEDnQfgwnRFZYvYHSQFskVF7iUl7TAAswOyMAHiGSvPCcO1Qx/aeLe3w8dKFoyuTdzXQQbUBbYRu0TGgEgogEaOQUTzYQiRJUmBB11Khib5NMQ1wZ9DY0u4V30AsPAHXxVYB20Yh7WCmS2Vr92YfaFVzMzx8wqB4ubmzNvrSuf8BON13AZrf558AAAAASUVORK5CYII=
name: EWS Extension Online Powershell v3
script:
  commands:
  - arguments:
    - description: The identity of the mailbox you want to view.
      name: identity
    - defaultValue: Minimum
      description: 'A comma-separated list of property sets to fetch. These property
        sets will supplement the outputs of this integration.  Available properties
        are: "All", "Minimum", "AddressList", "Archive", "Audit", "Delivery", "Hold",
        "Moderation", "Move", "Policy", "PublicFolder", "Quota", "Resource", "Retention",
        "SCL", "SoftDelete", "StatisticsSeed".'
      isArray: true
      name: property_sets
    - description: The object's location in Active Directory by which to filter the
        results.
      name: organizational_unit
    - description: The primary SMTP email address of the mailbox you want to view.
        Cannot be used with the user_principal_name argument. Can be retrieved using
        the ews-user-list command.
      name: primary_smtp_address
    - description: The UPN of the mailbox you want to view. Cannot be used with the
        primary_smtp_address argument. Can be retrieved using the ews-user-list command.
      name: user_principal_name
    - defaultValue: "10"
      description: The maximum number of results to retrieve. Default is 10.
      name: limit
    description: Displays mailbox objects and attributes, populate property pages,
      or supplies mailbox information to other tasks.
    name: ews-mailbox-list
    outputs:
    - contextPath: EWS.Mailbox.EmailAddresses
      description: Email addresses of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.AuditBypassEnabled
      description: Whether audit bypass is enabled.
      type: Boolean
    - contextPath: EWS.Mailbox.DistinguishedName
      description: Distinguished name of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.ExchangeObjectId
      description: Exchange object ID of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.ExchangeVersion
      description: Exchange version of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.Guid
      description: GUID of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.Id
      description: ID of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.Identity
      description: Identity of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.IsValid
      description: Whether the mailbox is valid.
      type: Boolean
    - contextPath: EWS.Mailbox.Name
      description: Name of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.ObjectCategory
      description: Object category of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.ObjectClass
      description: Object class of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.ObjectId
      description: Object ID of the of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.ObjectState
      description: Object state of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.OrganizationId
      description: Organization ID of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.OriginatingServer
      description: Originating server of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.PSComputerName
      description: PowerShell computer name of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.PSShowComputerName
      description: PowerShell show computer name of the mailbox.
      type: Boolean
    - contextPath: EWS.Mailbox.RunspaceId
      description: Run space ID of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.WhenChanged
      description: Local time of when the mailbox was last changed.
      type: Date
    - contextPath: EWS.Mailbox.WhenChangedUTC
      description: UTC time of when the mailbox was last changed.
      type: Date
    - contextPath: EWS.Mailbox.WhenCreated
      description: Local time of when the mailbox was created.
      type: Date
    - contextPath: EWS.Mailbox.WhenCreatedUTC
      description: UTC time of when the mailbox was created.
      type: Date
  - arguments:
    - description: The identity of the mailbox you want to view.
      name: identity
    - description: The object's location in Active Directory by which to filter the
        results.
      name: organizational_unit
    - description: The primary SMTP email address of the mailbox you want to view.
        Cannot be used with the user_principal_name argument. Can be retrieved using
        the ews-user-list command.
      name: primary_smtp_address
    - description: The UPN of the mailbox you want to view. Cannot be used with the
        primary_smtp_address argument. Can be retrieved using the ews-user-list command.
      name: user_principal_name
    - defaultValue: "10"
      description: The maximum number of results to retrieve. Default is 10.
      name: limit
    description: Displays Client Access settings that are configured on mailboxes.
    name: ews-cas-mailbox-list
    outputs:
    - contextPath: EWS.CASMailbox.ActiveSyncEnabled
      description: Whether active sync is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.DisplayName
      description: The display name of the mailbox.
      type: String
    - contextPath: EWS.CASMailbox.ECPEnabled
      description: Whether the Exchange Control Panel (ECP) is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.EmailAddresses
      description: The email addresses retrieved.
      type: String
    - contextPath: EWS.CASMailbox.EwsEnabled
      description: Whether the Exchange Web Services (EWS) is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.ExchangeVersion
      description: Exchange version of the client access server mailbox.
      type: String
    - contextPath: EWS.CASMailbox.ExternalDirectoryObjectId
      description: External directory object ID of the client access server mailbox.
      type: String
    - contextPath: EWS.CASMailbox.Guid
      description: The GUID of the client access server mailbox.
      type: String
    - contextPath: EWS.CASMailbox.Identity
      description: Identity of the client access server mailbox.
      type: String
    - contextPath: EWS.CASMailbox.ImapEnabled
      description: Whether the Internet Message Access Protocol (IMAP) is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.MAPIEnabled
      description: Whether the Messaging Application Programming Interface is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.Name
      description: Name of the client access server mailbox.
      type: String
    - contextPath: EWS.CASMailbox.OWAEnabled
      description: Whether Outlook on the web (OWA) is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.OrganizationId
      description: Organization ID.
      type: String
    - contextPath: EWS.CASMailbox.PopEnabled
      description: Whether Post Office Protocol (POP) is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.PrimarySmtpAddress
      description: Primary SMTP address.
      type: String
    - contextPath: EWS.CASMailbox.ServerLegacyDN
      description: Server legacy distinguished name (DN).
      type: String
  - arguments:
    - description: The identity of the mailbox you want to view.
      name: identity
      required: true
    description: Retrieves permissions on a mailbox.
    name: ews-mailbox-permission-list
    outputs:
    - contextPath: EWS.MailboxPermission.Identity
      description: The specified identity of the mailbox.
      type: String
    - contextPath: EWS.MailboxPermission.Permission.AccessRights
      description: Access rights of the mailbox.
      type: String
    - contextPath: EWS.MailboxPermission.Permission.Deny.IsPresent
      description: Whether permission is denied.
      type: Boolean
    - contextPath: EWS.MailboxPermission.Permission.Identity
      description: The permission identity.
      type: String
    - contextPath: EWS.MailboxPermission.Permission.InheritanceType
      description: Permission inheritance type.
      type: String
    - contextPath: EWS.MailboxPermission.Permission.IsInherited
      description: Whether permission is inherited.
      type: Boolean
    - contextPath: EWS.MailboxPermission.Permission.User
      description: The permission of the user.
      type: String
  - arguments:
    - description: The identity of the mailbox you want to view.
      name: identity
    - defaultValue: "10"
      description: The maximum number of results to retrieve. Default is 10.
      name: limit
    description: Displays information about SendAs permissions that are configured
      for users.
    name: ews-recipient-permission-list
    outputs:
    - contextPath: EWS.RecipientPermission.AccessControlType
      description: Access control type of the recipient permission.
      type: String
    - contextPath: EWS.RecipientPermission.AccessRights
      description: Access rights of the recipient permission.
      type: Number
    - contextPath: EWS.RecipientPermission.Identity
      description: Identity of the recipient permission.
      type: String
    - contextPath: EWS.RecipientPermission.InheritanceType
      description: Inheritance type of the recipient permission.
      type: String
    - contextPath: EWS.RecipientPermission.IsInherited
      description: Whether the recipient permission is inherited.
      type: Boolean
    - contextPath: EWS.RecipientPermission.Trustee
      description: Trustee of the recipient permission.
      type: String
  - arguments:
    - description: The identity of the mailbox you want to view.
      name: identity
    - defaultValue: "10"
      description: The maximum number of results to retrieve. Default is 10.
      name: limit
    description: Displays existing recipient objects in your organization. This command
      returns all mail-enabled objects (for example, mailboxes, mail users, mail contacts,
      and distribution groups).
    name: ews-recipient-list
    outputs:
    - contextPath: EWS.Recipient.Alias
      description: Recipient alias.
      type: String
    - contextPath: EWS.Recipient.DisplayName
      description: Recipient display name.
      type: String
    - contextPath: EWS.Recipient.DistinguishedName
      description: Recipient distinguished name.
      type: String
    - contextPath: EWS.Recipient.EmailAddresses
      description: Recipient email addresses.
      type: String
    - contextPath: EWS.Recipient.ExchangeVersion
      description: Recipient exchange version.
      type: String
    - contextPath: EWS.Recipient.ExternalDirectoryObjectId
      description: Recipient external directory object ID.
      type: String
    - contextPath: EWS.Recipient.Identity
      description: Recipient identity.
      type: String
    - contextPath: EWS.Recipient.Name
      description: Recipient name.
      type: String
    - contextPath: EWS.Recipient.OrganizationId
      description: Recipient organization ID.
      type: String
    - contextPath: EWS.Recipient.PrimarySmtpAddress
      description: Recipient primary SMTP address.
      type: String
    - contextPath: EWS.Recipient.RecipientType
      description: Recipient type.
      type: String
    - contextPath: EWS.Recipient.RecipientTypeDetails
      description: Recipient type details.
      type: String
  - arguments:
    - description: A comma-separated list of entries to add to the list (e.g. "Item1,Item2").
      isArray: true
      name: entries
      required: true
    - auto: PREDEFINED
      description: List type to add items to.
      name: list_type
      predefined:
      - sender
      - filehash
      - url
      required: true
    - auto: PREDEFINED
      defaultValue: Tenant
      description: List subtype to add items to.
      name: list_subtype
      predefined:
      - Tenant
      - AdvancedDelivery
      - Submission
    - auto: PREDEFINED
      description: Action to set for new entries.
      name: action
      predefined:
      - Block
      - Allow
      required: true
    - description: Notes to include on new list entries.
      name: notes
    - description: Enter a specific date and time for the new entries to expire using
        ISO format "YYYY-MM-DDTHH:MM:SSZ" for UTC time.  Alternately, a PowerShell
        **GetDate** statement can be used.
      name: expiration_date
    - auto: PREDEFINED
      defaultValue: "false"
      description: Specify whether to create list entries with no expiration date.  Cannot
        be used with "expiration_date".  If left false and no expiration date is set,
        default of 30 days will be used.
      name: no_expiration
      predefined:
      - "false"
      - "true"
    description: Add new items to the Tenant Allow/Block Lists.  Uses PowerShell New-TenantAllowBlockListItems
      cmdlet.
    execution: true
    name: ews-new-tenant-allow-block-list-items
    outputs:
    - contextPath: EWS.NewTenantBlocks.Action
      description: List type ('Block' or 'Allow').
      type: string
    - contextPath: EWS.NewTenantBlocks.EntryValueHash
      description: Entry Value Hash.
      type: string
    - contextPath: EWS.NewTenantBlocks.Error
      description: Error (if any) returned by remote command.
    - contextPath: EWS.NewTenantBlocks.ExpirationDate
      description: DateTime the entry will expire and be removed.
      type: string
    - contextPath: EWS.NewTenantBlocks.Identity
      description: Unique identifier for the entry.
      type: string
    - contextPath: EWS.NewTenantBlocks.LastModifiedDateTime
      description: DateTime of last modification.
      type: string
    - contextPath: EWS.NewTenantBlocks.ListSubType
      description: List sub type (Tenant or AdvancedDelivery).
      type: string
    - contextPath: EWS.NewTenantBlocks.ModifiedBy
      description: User / App Registration which last modified this entry.
      type: string
    - contextPath: EWS.NewTenantBlocks.Notes
      description: Custom notes added to the entry.
      type: string
    - contextPath: EWS.NewTenantBlocks.ObjectState
      description: State of the object (e.g. New/Modified/Deleted).
      type: string
    - contextPath: EWS.NewTenantBlocks.PSComputerName
      description: Name of Remote Powershell endpoint.
      type: string
    - contextPath: EWS.NewTenantBlocks.PSShowComputerName
      description: Flag whether or not remote computer name is shown in PS prompt.
      type: boolean
    - contextPath: EWS.NewTenantBlocks.RunspaceId
      description: RunspaceID of the entry.
      type: string
    - contextPath: EWS.NewTenantBlocks.SubmissionID
      description: SubmissionID of the entry.
      type: string
    - contextPath: EWS.NewTenantBlocks.SysManaged
      description: SysManaged property of the entry.
      type: boolean
    - contextPath: EWS.NewTenantBlocks.Value
      description: The value of the new entry created.
      type: string
  - arguments:
    - auto: PREDEFINED
      description: List type to retrieve items from.
      name: list_type
      predefined:
      - sender
      - filehash
      - url
      required: true
    - auto: PREDEFINED
      defaultValue: Tenant
      description: List subtype to retrieve items from.
      name: list_subtype
      predefined:
      - Tenant
      - AdvancedDelivery
      - Submission
    - auto: PREDEFINED
      description: Action to filter entries by.
      name: action
      predefined:
      - Block
      - Allow
      required: true
    - description: Enter a specific date and time to filter entries by using ISO format
        "YYYY-MM-DDTHH:MM:SSZ" for UTC time.  Alternately, a PowerShell **GetDate**
        statement can be used.
      name: expiration_date
    - auto: PREDEFINED
      defaultValue: "false"
      description: Filter list items that are set to never expire.
      name: no_expiration
      predefined:
      - "false"
      - "true"
    - description: Specific entry value to retrieve.
      name: entry
    description: Retrieve current Tenant Allow/Block List items.  Uses Get-TenantAllowBlockListItems
      cmdlet.
    name: ews-get-tenant-allow-block-list-items
    outputs:
    - contextPath: EWS.CurrentTenantBlocks.Action
      description: List type ('Block' or 'Allow').
      type: string
    - contextPath: EWS.CurrentTenantBlocks.EntryValueHash
      description: Entry Value Hash.
      type: string
    - contextPath: EWS.CurrentTenantBlocks.Error
      description: Error (if any) returned by remote command.
      type: boolean
    - contextPath: EWS.CurrentTenantBlocks.ExpirationDate
      description: DateTime the entry will expire and be removed.
      type: string
    - contextPath: EWS.CurrentTenantBlocks.Identity
      description: Unique identifier for the entry.
      type: string
    - contextPath: EWS.CurrentTenantBlocks.LastModifiedDateTime
      description: DateTime of last modification.
      type: string
    - contextPath: EWS.CurrentTenantBlocks.ListSubType
      description: List sub type (Tenant or AdvancedDelivery).
      type: string
    - contextPath: EWS.CurrentTenantBlocks.ModifiedBy
      description: User / App Registration which last modified this entry.
      type: string
    - contextPath: EWS.CurrentTenantBlocks.Notes
      description: Custom notes added to the entry.
      type: string
    - contextPath: EWS.CurrentTenantBlocks.ObjectState
      description: State of the object (e.g. New/Modified/Deleted).
      type: string
    - contextPath: EWS.CurrentTenantBlocks.PSComputerName
      description: Name of Remote Powershell endpoint.
    - contextPath: EWS.CurrentTenantBlocks.PSShowComputerName
      description: Flag whether or not remote computer name is shown in PS prompt.
      type: boolean
    - contextPath: EWS.CurrentTenantBlocks.RunspaceId
      description: RunspaceID of the entry.
      type: string
    - contextPath: EWS.CurrentTenantBlocks.SubmissionID
      description: SubmissionID of the entry.
      type: string
    - contextPath: EWS.CurrentTenantBlocks.SysManaged
      description: SysManaged property of the entry.
      type: boolean
    - contextPath: EWS.CurrentTenantBlocks.Value
      description: The value of the new entry created.
      type: string
  - arguments:
    - auto: PREDEFINED
      description: List type to retrieve items from.
      name: list_type
      predefined:
      - sender
      - filehash
      - url
    - auto: PREDEFINED
      defaultValue: Tenant
      description: List subtype to retrieve items from.
      name: list_subtype
      predefined:
      - Tenant
      - AdvancedDelivery
      - Submission
    description: Retrieve current count of defined Tenant Allow/Block List items.  Uses
      Get-TenantAllowBlockListItems cmdlet.
    name: ews-get-tenant-allow-block-list-count
    outputs:
    - contextPath: EWS.CurrentListCount.Count
      description: Number of entries presently in the specified list.
      type: number
    - contextPath: EWS.CurrentListCount.ListSubType
      description: List sub type (Tenant or AdvancedDelivery).
      type: string
    - contextPath: EWS.CurrentListCount.ListType
      description: List type.
      type: string
  - arguments:
    - description: ID of the mailbox for which to get junk rules.
      name: mailbox
      required: true
    description: Gets junk rules for the specified mailbox.
    name: ews-junk-rules-get
    outputs:
    - contextPath: EWS.Rule.Junk.BlockedSendersAndDomains
      description: List of blocked senders and domains.
      type: String
    - contextPath: EWS.Rule.Junk.ContactsTrusted
      description: If true, contacts are trusted by default.
      type: Boolean
    - contextPath: EWS.Rule.Junk.Email
      description: Junk rule mailbox.
      type: String
    - contextPath: EWS.Rule.Junk.Enabled
      description: If true, junk rule is enabled.
      type: Boolean
    - contextPath: EWS.Rule.Junk.Identity
      description: Junk rule identity.
      type: String
    - contextPath: EWS.Rule.Junk.MailboxOwnerId
      description: ID of the mailbox owner.
      type: String
    - contextPath: EWS.Rule.Junk.TrustedListsOnly
      description: If true, only a list defined in the trusted lists are trusted.
      type: Boolean
    - contextPath: EWS.Rule.Junk.TrustedRecipientsAndDomains
      description: List of trusted recipients and domains.
      type: String
    - contextPath: EWS.Rule.Junk.TrustedSendersAndDomains
      description: List of trusted senders and domains.
      type: String
  - arguments:
    - description: ID of the mailbox for which to set junk rules.
      name: mailbox
      required: true
    - description: Comma-separated list of blocked senders and domains to add to the
        mailbox.
      isArray: true
      name: add_blocked_senders_and_domains
    - description: Comma-separated list of blocked senders and domains to remove from
        the mailbox.
      isArray: true
      name: remove_blocked_senders_and_domains
    - description: Comma-separated list of trusted senders and domains to add to the
        mailbox.
      isArray: true
      name: add_trusted_senders_and_domains
    - description: Comma-separated list of trusted senders and domains to remove from
        the mailbox.
      isArray: true
      name: remove_trusted_senders_and_domains
    - auto: PREDEFINED
      description: If true, trust only lists defined in the trusted lists. Can be
        "true" or "false".
      name: trusted_lists_only
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: If true, contacts are trusted by default. Can be "true" or "false".
      name: contacts_trusted
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: If true, the junk rule is enabled. Can be "true" or "false".
      name: enabled
      predefined:
      - "true"
      - "false"
    description: Sets junk rules for the specified mailbox.
    name: ews-junk-rules-set
  - arguments:
    - description: Comma-separated list of blocked senders and domains to add to the
        mailbox.
      isArray: true
      name: add_blocked_senders_and_domains
    - description: Comma-separated list of blocked senders and domains to remove from
        the mailbox.
      isArray: true
      name: remove_blocked_senders_and_domains
    - description: Comma-separated list of trusted senders and domains to add to the
        mailbox.
      isArray: true
      name: add_trusted_senders_and_domains
    - description: Comma-separated list of trusted senders and domains to remove from
        the mailbox.
      isArray: true
      name: remove_trusted_senders_and_domains
    - auto: PREDEFINED
      description: If true, trust only lists defined in the trusted lists. Can be
        "true" or "false".
      name: trusted_lists_only
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: If true, contacts are trusted by default. Can be "true" or "false".
      name: contacts_trusted
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: If true, the junk rule is enabled. Can be "true" or "false".
      name: enabled
      predefined:
      - "true"
      - "false"
    description: Sets junk rules in all managed accounts.
    name: ews-global-junk-rules-set
  - arguments:
    - description: A comma-separated list of sender email addresses by which to filter
        the results.
      isArray: true
      name: sender_address
    - description: A comma-separated list of recipient email addresses by which to
        filter the results.
      isArray: true
      name: recipient_address
    - description: The source IP address by which to filter the results. For incoming
        messages, the value of from_ip is the public IP address of the SMTP email
        server that sent the message. For outgoing messages from Exchange Online,
        the value is blank.
      isArray: true
      name: from_ip
    - description: The destination IP address by which to filter the results. For
        outgoing messages, the value of to_ip is the public IP address in the resolved
        MX record for the destination domain. For incoming messages to Exchange Online,
        the value is blank.
      isArray: true
      name: to_ip
    - description: The Message-ID header field of the message by which to filter the
        results. This value is also known as the Client ID. The format of the Message-ID
        depends on the messaging server that sent the message. The value should be
        unique for each message. However, not all messaging servers create values
        for the Message-ID in the same way. Be sure to include the full Message ID
        string (which may include angle brackets) and enclose the value in quotation
        marks (for example,"d9683b4c-127b-413a-ae2e-fa7dfb32c69d@DM3NAM06BG401.Eop-nam06.prod.protection.outlook.com").
      name: message_id
    - description: The message trace ID to be used with the recipient address to uniquely
        identify a message trace and obtain more details. A message trace ID is generated
        for every message that''s processed by the system.
      name: message_trace_id
    - defaultValue: "1"
      description: The page number of the results you want to view. Can be an integer
        between 1 and 1000.
      name: page
    - defaultValue: "100"
      description: The maximum number of entries per page. Can be an integer between
        1 and 5000.
      name: page_size
    - description: |-
        The start date of the date range. Use the short date format that''s defined in the Regional Options settings on the computer where you''re running the command. For example, if the computer is configured to use the short date format mm/dd/yyyy, enter 09/01/2018 to specify September 1, 2018.
        You can enter the date only, or you can enter the date and time of day.
        If you enter the date and time of day, enclose the value in quotation marks ("), for example, "09/01/2018 5:00 PM".
        Valid input for this parameter is from 10 days ago until now. Default is 48 hours ago.
      name: start_date
    - description: |-
        The end date of the date range. Use the short date format that''s defined in the Regional Options settings on the computer where you''re running the command. For example, if the computer is configured to use the short date format mm/dd/yyyy, enter 09/01/2018 to specify September 1, 2018.
        You can enter the date only, or you can enter the date and time of day.
        If you enter the date and time of day, enclose the value in quotation marks ("), for example, "09/01/2018 5:00 PM".
        Valid input for this parameter is from the start_date - now. Default is now.
      name: end_date
    - auto: PREDEFINED
      description: |
        The status of the message. Can be one of the following:
          * GettingStatus: The message is waiting for status update.
          * Failed: Message delivery was attempted and it failed or the message was filtered as spam or malware, or by transport rules.
          * Pending: Message delivery is underway or was deferred and is being retried.
          * Delivered: The message was delivered to its destination.
          * Expanded: There was no message delivery because the message was addressed to a distribution group and the membership of the distribution was expanded.
          * Quarantined: The message was quarantined.
          * FilteredAsSpam: The message was marked as spam.
      name: status
      predefined:
      - GettingStatus
      - Failed
      - Pending
      - Delivered
      - Expanded
      - Quarantined
      - FilteredAsSpam
    description: |-
      Searches message data for the last 10 days. If you run this command without any arguments, only data from the last 48 hours is returned.
      If you enter a start date that is older than 10 days, you will receive an error and the command will return no results.
      This command returns a maximum of 1,000,000 results, and will timeout on very large queries. If your query returns too many results, consider splitting it up using shorter start_date and end_date intervals.
    name: ews-message-trace-get
    outputs:
    - contextPath: EWS.MessageTrace.FromIP
      description: The public IP address of the SMTP email server that sent the message.
      type: String
    - contextPath: EWS.MessageTrace.ToIP
      description: The public IP address in the resolved MX record for the destination
        domain. For incoming messages to Exchange Online, the value is blank.
      type: String
    - contextPath: EWS.MessageTrace.Index
      description: Message index in pagination. (Index starts from 0.)
      type: Number
    - contextPath: EWS.MessageTrace.MessageId
      description: Message-ID header field of the message.
      type: String
    - contextPath: EWS.MessageTrace.MessageTraceId
      description: Message trace ID of the message.
      type: String
    - contextPath: EWS.MessageTrace.Organization
      description: Message trace organization source.
      type: String
    - contextPath: EWS.MessageTrace.Received
      description: Message receive time.
      type: Date
    - contextPath: EWS.MessageTrace.RecipientAddress
      description: Message recipient address.
      type: String
    - contextPath: EWS.MessageTrace.SenderAddress
      description: Message sender address.
      type: String
    - contextPath: EWS.MessageTrace.Size
      description: Message size in bytes.
      type: Number
    - contextPath: EWS.MessageTrace.StartDate
      description: Message trace start date.
      type: Date
    - contextPath: EWS.MessageTrace.EndDate
      description: Message trace end date.
      type: Date
    - contextPath: EWS.MessageTrace.Status
      description: Message status.
      type: String
    - contextPath: EWS.MessageTrace.Subject
      description: Message subject.
      type: String
  - arguments:
    - description: The domain controller identified by its fully qualified domain
        name (FQDN). For example, dc01.contoso.com. This argument is available only
        in on-premises Exchange.
      name: domain_controller
    - description: The federation trust ID. If not specified, the command returns
        all federation trusts configured for the Exchange organization.
      name: identity
    description: Displays the federation trust configured for the Exchange organization.
    name: ews-federation-trust-get
    outputs:
    - contextPath: EWS.FederationTrust.AdminDisplayName
      description: Administrator display name of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.ApplicationIdentifier
      description: Application identifier of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.ApplicationUri
      description: Application URI of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.DistinguishedName
      description: Distinguished name of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.ExchangeObjectId
      description: Exchange object ID of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.ExchangeVersion
      description: Exchange version of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.Guid
      description: GUID of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.Id
      description: ID of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.Identity
      description: Identity of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.IsValid
      description: Whether the federation trust is valid.
      type: Boolean
    - contextPath: EWS.FederationTrust.MetadataEpr
      description: Metadata EPR of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.MetadataPollInterval
      description: Metadata poll interval of the federation trust.
      type: Date
    - contextPath: EWS.FederationTrust.MetadataPutEpr
      description: Metadata put EPR of the federation trust.
      type: Unknown
    - contextPath: EWS.FederationTrust.Name
      description: Name of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.NamespaceProvisioner
      description: Namespace provisioner of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.ObjectCategory
      description: Object category of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.ObjectClass
      description: Object class of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.ObjectState
      description: Object state of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.Archived
      description: Whether the organization certificate of the federation trust is
        archived.
      type: Boolean
    - contextPath: EWS.FederationTrust.OrgCertificate.Extensions.Critical
      description: Whether the extensions of the organization certificate are critical.
      type: Boolean
    - contextPath: EWS.FederationTrust.OrgCertificate.Extensions.Oid.FriendlyName
      description: Friendly name of the OID of the organization certificate extensions.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.Extensions.Oid.Value
      description: Value of the OID of the organization certificate extensions.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.Extensions.RawData
      description: Raw data of the organization certificate extensions.
      type: Number
    - contextPath: EWS.FederationTrust.OrgCertificate.Extensions.SubjectKeyIdentifier
      description: Subject key identifier of the organization certificate extensions.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.Extensions.KeyUsages
      description: Key usages of the organization certificate extensions.
      type: Number
    - contextPath: EWS.FederationTrust.OrgCertificate.Extensions.EnhancedKeyUsages.FriendlyName
      description: Friendly name of the enhanced key usages of the organization certificate
        extensions.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.Extensions.EnhancedKeyUsages.Value
      description: Value of the enhanced key usages of the organization certificate
        extensions.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.Extensions.CertificateAuthority
      description: Whether the organization certificate extensions have a certificate
        authority.
      type: Boolean
    - contextPath: EWS.FederationTrust.OrgCertificate.Extensions.HasPathLengthConstraint
      description: Whether the organization certificate extensions have a path length
        constraint.
      type: Boolean
    - contextPath: EWS.FederationTrust.OrgCertificate.Extensions.PathLengthConstraint
      description: Path length constraint of the organization certificate extensions.
      type: Number
    - contextPath: EWS.FederationTrust.OrgCertificate.FriendlyName
      description: Friendly name of the organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.Handle.value
      description: The handle value of the organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgCertificate.HasPrivateKey
      description: Whether the organization certificate has a private key.
      type: Boolean
    - contextPath: EWS.FederationTrust.OrgCertificate.Issuer
      description: Issuer of the organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.IssuerName.Name
      description: Name of the issuer of the organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.IssuerName.Oid.FriendlyName
      description: Friendly Name of the OID of the issuer name of the organization
        certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.OrgCertificate.IssuerName.Oid.Value
      description: Value of the OID of the issuer name of the organization certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.OrgCertificate.IssuerName.RawData
      description: Raw data of the issuer name of the organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgCertificate.NotAfter
      description: The date until when the organization certificate is valid.
      type: Date
    - contextPath: EWS.FederationTrust.OrgCertificate.NotBefore
      description: The date the organization certificate became valid.
      type: Date
    - contextPath: EWS.FederationTrust.OrgCertificate.PrivateKey
      description: Private key of the organization certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.EncodedKeyValue.Oid.FriendlyName
      description: Friendly name of the OID of the encoded key value of the public
        key.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.EncodedKeyValue.Oid.Value
      description: Value of the OID of the encoded key value of the public key.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.EncodedKeyValue.RawData
      description: Raw data of the encoded key value of the public key.
      type: Number
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.EncodedParameters.Oid.FriendlyName
      description: Friendly name of the OID of the encoded parameters of the public
        key.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.EncodedParameters.Oid.Value
      description: Value of the OID of the encoded parameters of the public key.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.EncodedParameters.RawData
      description: Raw data of the encoded parameters of the public key.
      type: Number
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.Key.KeyExchangeAlgorithm
      description: Key exchange algorithm of the public key.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.Key.LegalKeySizes.MaxSize
      description: Maximum size of the public key.
      type: Number
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.Key.LegalKeySizes.MinSize
      description: Minimum size of the public key.
      type: Number
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.Key.LegalKeySizes.SkipSize
      description: SkipSize of the public key.
      type: Number
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.Key.SignatureAlgorithm
      description: Signature algorithm of the public key.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.Oid.FriendlyName
      description: Friendly name of the OID of the public key.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.PublicKey.Oid.Value
      description: Value of the OID of the public key.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.RawData
      description: Raw data of the organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgCertificate.SerialNumber
      description: Serial number of the organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.SignatureAlgorithm.FriendlyName
      description: Friendly name of the signature algorithm.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.SignatureAlgorithm.Value
      description: Value of the signature algorithm.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.Subject
      description: Subject of the organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.SubjectName.Name
      description: Name of the subject of the organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.SubjectName.Oid.FriendlyName
      description: Friendly name of the OID of the subject name.
      type: Unknown
    - contextPath: EWS.FederationTrust.OrgCertificate.SubjectName.Oid.Value
      description: Value of the OID of the subject name.
      type: Unknown
    - contextPath: EWS.FederationTrust.OrgCertificate.SubjectName.RawData
      description: Raw Data of the subject name.
      type: Number
    - contextPath: EWS.FederationTrust.OrgCertificate.Thumbprint
      description: Thumbprint of the organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgCertificate.Version
      description: Version of the organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgNextCertificate
      description: Next organization certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.OrgNextPrivCertificate
      description: Next organization private certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Archived
      description: Whether to archive the previous organization certificate.
      type: Boolean
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Extensions.Critical
      description: Whether the extensions of the previous organization certificate
        are critical.
      type: Boolean
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Extensions.Oid.FriendlyName
      description: Friendly name of the OID of the previous organization certificate
        extensions.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Extensions.Oid.Value
      description: Value of the OID of the previous organization certificate extensions.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Extensions.RawData
      description: Raw data of the previous organization certificate extensions.
      type: Number
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Extensions.SubjectKeyIdentifier
      description: Subject key identifier of the previous organization certificate
        extensions.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Extensions.KeyUsages
      description: Key usages of the previous organization certificate extensions.
      type: Number
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Extensions.EnhancedKeyUsages.FriendlyName
      description: Friendly name of the enhanced key usages of the previous organization
        certificate extensions.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Extensions.EnhancedKeyUsages.Value
      description: Value of the enhanced key usages of the previous organization certificate
        extensions.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.FriendlyName
      description: Friendly name of the previous organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Handle.value
      description: Value of the handle of the previous organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.HasPrivateKey
      description: Whether the previous organization certificate has a private key.
      type: Boolean
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Issuer
      description: Issuer of the previous organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.IssuerName.Name
      description: Name of the issuer of the previous organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.IssuerName.Oid.FriendlyName
      description: Friendly name of the OID of the issuer of the previous organization
        certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.IssuerName.Oid.Value
      description: Value of the OID of the issuer of the previous organization certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.IssuerName.RawData
      description: Raw data of the issuer of the previous organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.NotAfter
      description: The date until when the previous organization certificate is valid.
      type: Date
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.NotBefore
      description: The date the previous organization certificate became valid.
      type: Date
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PrivateKey
      description: Private Key of the previous organization certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.EncodedKeyValue.Oid.FriendlyName
      description: Friendly Name of the OID of the encoded key value of the public
        key of the previous organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.EncodedKeyValue.Oid.Value
      description: Value of the OID of the encoded key value of the public key of
        the previous organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.EncodedKeyValue.RawData
      description: Raw Data of the encoded key value of the public key of the previous
        organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.EncodedParameters.Oid.FriendlyName
      description: Friendly name of the OID of the encoded parameters of the public
        key of the previous organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.EncodedParameters.Oid.Value
      description: Value of the OID of the encoded parameters of the public key of
        the previous organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.EncodedParameters.RawData
      description: Raw Data of the encoded parameters of the public key of the previous
        organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.Key.KeyExchangeAlgorithm
      description: Key exchange algorithm of the public key of the previous organization
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.Key.LegalKeySizes.MaxSize
      description: Maximum size of the public key of the previous organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.Key.LegalKeySizes.MinSize
      description: Minimum size of the public key of the previous organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.Key.LegalKeySizes.SkipSize
      description: SkiPSize of the public key of the previous organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.Key.SignatureAlgorithm
      description: Signature algorithm of the public key of the previous organization
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.Oid.FriendlyName
      description: Friendly name of the OID of the public key of the previous organization
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.PublicKey.Oid.Value
      description: Value of the OID of the public key of the previous organization
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.RawData
      description: Raw Data of the previous organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.SerialNumber
      description: Serial number of the previous organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.SignatureAlgorithm.FriendlyName
      description: Friendly name of the signature algorithm of the previous organization
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.SignatureAlgorithm.Value
      description: Value of the signature algorithm of the previous organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Subject
      description: Subject of the previous organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.SubjectName.Name
      description: Name of the subject of the previous organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.SubjectName.Oid.FriendlyName
      description: Friendly name of the OID of the subject of the previous organization
        certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.SubjectName.Oid.Value
      description: Value of the OID of the subject name of the previous organization
        certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.SubjectName.RawData
      description: Raw Data of the subject name of the previous organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Thumbprint
      description: Thumbprint of the previous organization certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrevCertificate.Version
      description: Version of the previous organization certificate.
      type: Number
    - contextPath: EWS.FederationTrust.OrgPrevPrivCertificate
      description: Organization previous private certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrgPrivCertificate
      description: Organization private certificate.
      type: String
    - contextPath: EWS.FederationTrust.OrganizationId
      description: Organization ID.
      type: String
    - contextPath: EWS.FederationTrust.OriginatingServer
      description: Originating server.
      type: String
    - contextPath: EWS.FederationTrust.PSComputerName
      description: PowerShell computer name.
      type: String
    - contextPath: EWS.FederationTrust.PSShowComputerName
      description: Whether to show the PowerShell computer name.
      type: Boolean
    - contextPath: EWS.FederationTrust.PolicyReferenceUri
      description: Policy Reference URI.
      type: String
    - contextPath: EWS.FederationTrust.RunspaceId
      description: Runspace ID.
      type: String
    - contextPath: EWS.FederationTrust.TimesOfUnmatchPartner
      description: Times Of unmatch partner.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerCertReference
      description: Token issuer certificate reference.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.Archived
      description: Whether the token issuer certificate is archived.
      type: Boolean
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.Extensions.Critical
      description: Whether the extensions of the token issuer certificate are critical.
      type: Boolean
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.Extensions.Oid.FriendlyName
      description: Friendly name of the OID of the extensions of the token issuer
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.Extensions.Oid.Value
      description: Value of the OID of the extensions of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.Extensions.RawData
      description: Raw Data of the extensions of the token issuer certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.Extensions.SubjectKeyIdentifier
      description: Subject key identifier of the extensions of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.Extensions.KeyUsages
      description: Key usages of the extensions of the token issuer certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.FriendlyName
      description: Friendly name of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.Handle.value
      description: Value of the handle of the token issuer certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.HasPrivateKey
      description: Whether the token issuer certificate has a private key.
      type: Boolean
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.Issuer
      description: Issuer of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.IssuerName.Name
      description: Name of the issuer of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.IssuerName.Oid.FriendlyName
      description: Friendly name of the OID of the token issuer certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.IssuerName.Oid.Value
      description: Value of the OID of the issuer of the token issuer certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.IssuerName.RawData
      description: Raw data of the issuer of the token issuer certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.NotAfter
      description: The date until when the token issuer certificate is valid.
      type: Date
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.NotBefore
      description: The date the token issuer certificate became valid.
      type: Date
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PrivateKey
      description: Private key of the token issuer certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.EncodedKeyValue.Oid.FriendlyName
      description: Friendly name of the OID of the encoded key value of the public
        key of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.EncodedKeyValue.Oid.Value
      description: Value of the OID of the encoded key value of the public key of
        the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.EncodedKeyValue.RawData
      description: Raw data of the encoded key value of the public key of the token
        issuer certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.EncodedParameters.Oid.FriendlyName
      description: Friendly name of the OID of the encoded parameters of the public
        key of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.EncodedParameters.Oid.Value
      description: Value of the OID of the encoded parameters of the public key of
        the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.EncodedParameters.RawData
      description: Raw Data of the encoded parameters of the public key of the token
        issuer certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.Key.KeyExchangeAlgorithm
      description: Key exchange algorithm of the public key of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.Key.LegalKeySizes.MaxSize
      description: Maximum size of the public key of the token issuer certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.Key.LegalKeySizes.MinSize
      description: Minimum size of the public key of the token issuer certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.Key.LegalKeySizes.SkipSize
      description: SkiPSize of the public key of the token issuer certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.Key.SignatureAlgorithm
      description: Signature algorithm of the public key of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.Oid.FriendlyName
      description: Friendly name of the OID of the public key of the token issuer
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.PublicKey.Oid.Value
      description: Value of the OID of the public key of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.RawData
      description: Raw Data of the token issuer certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.SerialNumber
      description: Serial number of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.SignatureAlgorithm.FriendlyName
      description: Friendly name of the signature algorithm of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.SignatureAlgorithm.Value
      description: Value of the signature algorithm of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.Subject
      description: Subject of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.SubjectName.Name
      description: Name of the subject of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.SubjectName.Oid.FriendlyName
      description: Friendly name of the OID of the subject of the token issuer certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.SubjectName.Oid.Value
      description: Value of the OID of the subject of the token issuer certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.SubjectName.RawData
      description: Raw data of the subject of the token issuer certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.Thumbprint
      description: Thumbprint of the token issuer certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerCertificate.Version
      description: Version of the token issuer certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerEpr
      description: Token issuer EPR.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerMetadataEpr
      description: Token issuer metadata EPR.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertReference
      description: Token issuer previous certificate reference.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.Archived
      description: Whether the token issuer previous certificate was archived.
      type: Boolean
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.Extensions.Critical
      description: Whether the extensions of the token issuer previous certificate
        was critical.
      type: Boolean
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.Extensions.Oid.FriendlyName
      description: Friendly name of the OID of the extensions of the token issuer
        previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.Extensions.Oid.Value
      description: Value of the OID of the extensions of the token issuer previous
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.Extensions.RawData
      description: Raw data of the extensions of the token issuer previous certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.Extensions.SubjectKeyIdentifier
      description: Subject key identifier of the extensions of the token issuer previous
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.Extensions.KeyUsages
      description: Key usages of the extensions of the token issuer previous certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.FriendlyName
      description: Friendly name of the token issuer previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.Handle.value
      description: The handle value of the token issuer previous certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.HasPrivateKey
      description: Whether the token issuer previous certificate has a private key.
      type: Boolean
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.Issuer
      description: Issuer of the token issuer previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.IssuerName.Name
      description: Name of the issuer of the token issuer previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.IssuerName.Oid.FriendlyName
      description: Friendly name of the OID of the issuer name of the token issuer
        previous certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.IssuerName.Oid.Value
      description: Value of the OID of the issuer name of the token issuer previous
        certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.IssuerName.RawData
      description: Raw Data of the issuer name of the token issuer previous certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.NotAfter
      description: The date until when the token issuer previous certificate is valid.
      type: Date
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.NotBefore
      description: The date the token issuer previous certificate became valid.
      type: Date
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PrivateKey
      description: Private Key of the token issuer previous certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.EncodedKeyValue.Oid.FriendlyName
      description: Friendly name of the OID of the encoded key value of the public
        key of the token issuer previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.EncodedKeyValue.Oid.Value
      description: Value of the OID of the encoded key value of the public key of
        the token issuer previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.EncodedKeyValue.RawData
      description: Raw data of the encoded key value of the public key of the token
        issuer previous certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.EncodedParameters.Oid.FriendlyName
      description: Friendly name of the OID of the encoded parameters of the public
        key of the token issuer previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.EncodedParameters.Oid.Value
      description: Value of the OID of the encoded parameters of the public key of
        the token issuer previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.EncodedParameters.RawData
      description: Raw data of the encoded parameters of the public key of the token
        issuer previous certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.Key.KeyExchangeAlgorithm
      description: Key exchange algorithm of the public key of the token issuer previous
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.Key.LegalKeySizes.MaxSize
      description: Maximum size of the public key of the token issuer previous certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.Key.LegalKeySizes.MinSize
      description: Minimum size of the public key of the token issuer previous certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.Key.LegalKeySizes.SkipSize
      description: SkiPSize of the public key of the token issuer previous certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.Key.SignatureAlgorithm
      description: Signature algorithm of the public key of the token issuer previous
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.Oid.FriendlyName
      description: Friendly Name of the OID of the public key of the token issuer
        previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.PublicKey.Oid.Value
      description: Value of the OID of teh public key of the token issuer previous
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.RawData
      description: Raw Data of the token issuer previous certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.SerialNumber
      description: Serial number of the token issuer previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.SignatureAlgorithm.FriendlyName
      description: Friendly name of the signature algorithm of the token issuer previous
        certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.SignatureAlgorithm.Value
      description: Value of the signature algorithm of the token issuer previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.Subject
      description: Subject of the token issuer previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.SubjectName.Name
      description: Name of the subject of the token issuer previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.SubjectName.Oid.FriendlyName
      description: Friendly Name of the OID of the subject of the token issuer previous
        certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.SubjectName.Oid.Value
      description: Value of the OID of the subject name of the token issuer previous
        certificate.
      type: Unknown
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.SubjectName.RawData
      description: Raw data of the subject name of the token issuer previous certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.Thumbprint
      description: Thumbprint of the token issuer previous certificate.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerPrevCertificate.Version
      description: Version of the token issuer previous certificate.
      type: Number
    - contextPath: EWS.FederationTrust.TokenIssuerType
      description: Token issuer type of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.TokenIssuerUri
      description: Token Issuer UIR of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.WebRequestorRedirectEpr
      description: Web requestor redirect EPR of the federation trust.
      type: String
    - contextPath: EWS.FederationTrust.WhenChanged
      description: The date the federation trust was changed.
      type: Date
    - contextPath: EWS.FederationTrust.WhenChangedUTC
      description: The date in UTC format of when the federation trust was changed.
      type: Date
    - contextPath: EWS.FederationTrust.WhenCreated
      description: The date the federation trust was created.
      type: Date
    - contextPath: EWS.FederationTrust.WhenCreatedUTC
      description: The date in UTC format of when the federation trust was created.
      type: Date
  - arguments:
    - description: The fully qualified domain name (FQDN) of the domain controller.
        For example, dc01.contoso.com. This argument is available only in on-premises
        Exchange.
      name: domain_controller
    - description: The federation trust ID. If not specified, all federation trusts
        configured for the Exchange organization are returned.
      name: identity
    - auto: PREDEFINED
      defaultValue: "false"
      description: 'The IncludeExtendedDomainInfo switch specifies that the command
        query Microsoft Federation Gateway for the status of each accepted domain
        that''s federated. The status is returned with each domain in the Domains
        property. Possible values: "true" and "false".'
      name: include_extended_domain_info
      predefined:
      - "true"
      - "false"
    description: Retrieves the Exchange organization's federated organization identifier
      and related details, such as federated domains, organization contact, and status.
    name: ews-federation-configuration-get
    outputs:
    - contextPath: EWS.FederationConfiguration.AccountNamespace
      description: Account namespace of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.DefaultDomain
      description: Default domain of the federation configuration.
      type: Unknown
    - contextPath: EWS.FederationConfiguration.DelegationTrustLink
      description: Delegation trust link of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.DistinguishedName
      description: Distinguished name of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.Domains
      description: Domains of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.Enabled
      description: Whether the federation configuration is enabled.
      type: Boolean
    - contextPath: EWS.FederationConfiguration.ExchangeObjectId
      description: Exchange object ID of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.ExchangeVersion
      description: Exchange version of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.Guid
      description: GUID of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.Id
      description: ID of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.Identity
      description: Identity of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.IsValid
      description: Whether the federation configration is valid.
      type: Boolean
    - contextPath: EWS.FederationConfiguration.Name
      description: Name of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.ObjectCategory
      description: Object category of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.ObjectClass
      description: Object class of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.ObjectState
      description: Object state of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.OrganizationContact
      description: Organization contact of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.OrganizationId
      description: Organization ID of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.OriginatingServer
      description: Originating server of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.PSComputerName
      description: PowerShell computer name of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.PSShowComputerName
      description: Whether to show the PowerShell computer name of the federation
        configuration.
      type: Boolean
    - contextPath: EWS.FederationConfiguration.RunspaceId
      description: Runspace ID of the federation configuration.
      type: String
    - contextPath: EWS.FederationConfiguration.WhenChanged
      description: The date the federation configuration was changed.
      type: Date
    - contextPath: EWS.FederationConfiguration.WhenChangedUTC
      description: The date in UTC format of when the federation configuration was
        changed.
      type: Date
    - contextPath: EWS.FederationConfiguration.WhenCreated
      description: The date the federation configuration was created.
      type: Date
    - contextPath: EWS.FederationConfiguration.WhenCreatedUTC
      description: The date in UTC format of when the federation configuration was
        created.
      type: Date
  - arguments:
    - description: |-
        The fully qualified domain name (FQDN) of the domain controller. For example, dc01.contoso.com.
        This argument is available only in on-premises Exchange.
      name: domain_controller
    - description: The remote domain that you want to view. You can use the GUID,
        ID, or any other identifier.
      name: identity
    description: Gets the configuration information for the remote domains configured
      in your organization. This command is available only in the Exchange Online
      PowerShell V2 module.
    name: ews-remote-domain-get
    outputs:
    - contextPath: EWS.RemoteDomain.AdminDisplayName
      description: Admin display name of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.AllowedOOFType
      description: Allowed OOF type of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.AutoForwardEnabled
      description: Whether auto forward is enabled for the remote domain.
      type: Boolean
    - contextPath: EWS.RemoteDomain.AutoReplyEnabled
      description: Whether auto reply is enabled for the remote domain..
      type: Boolean
    - contextPath: EWS.RemoteDomain.ByteEncoderTypeFor7BitCharsets
      description: Byte encoder type For 7-bit charsets of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.CharacterSet
      description: Character set of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.ContentType
      description: Content type of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.DeliveryReportEnabled
      description: Whether delivery report is enabled for the remote domain.
      type: Boolean
    - contextPath: EWS.RemoteDomain.DisplaySenderName
      description: Whether to display the sender name for the remote domain.
      type: Boolean
    - contextPath: EWS.RemoteDomain.DistinguishedName
      description: Distinguished name of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.DomainName
      description: Domain name of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.ExchangeObjectId
      description: Exchange object ID of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.ExchangeVersion
      description: Exchange version of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.Guid
      description: GUID of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.Id
      description: ID of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.Identity
      description: Identity of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.IsInternal
      description: Whether the remote domain is internal.
      type: Boolean
    - contextPath: EWS.RemoteDomain.IsValid
      description: Whether the remote domain is valid.
      type: Boolean
    - contextPath: EWS.RemoteDomain.LineWrapSize
      description: Line wrap size for the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.MeetingForwardNotificationEnabled
      description: Whether meeting forward notification is enabled for the remote
        domain.
      type: Boolean
    - contextPath: EWS.RemoteDomain.MessageCountThreshold
      description: Message count threshold  of the remote domain.
      type: Number
    - contextPath: EWS.RemoteDomain.NDRDiagnosticInfoEnabled
      description: Whether NDR diagnostic information is enabled for the remote domain.
      type: Boolean
    - contextPath: EWS.RemoteDomain.NDREnabled
      description: Whether NDR is enabled for the remote domain.
      type: Boolean
    - contextPath: EWS.RemoteDomain.Name
      description: Name of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.NonMimeCharacterSet
      description: Non-mime character set of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.ObjectCategory
      description: Object category of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.ObjectClass
      description: Object class of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.ObjectState
      description: Object state of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.OrganizationId
      description: Organization ID of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.OriginatingServer
      description: Originating server of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.PSComputerName
      description: PowerShell computer name of the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.PSShowComputerName
      description: Whether to show the PowerShell computer name for the remote domain.
      type: Boolean
    - contextPath: EWS.RemoteDomain.PreferredInternetCodePageForShiftJis
      description: Preferred internet code page for shift JIS for the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.RequiredCharsetCoverage
      description: Required charset coverage for the remote domain.
      type: Unknown
    - contextPath: EWS.RemoteDomain.RunspaceId
      description: Runspace ID for the remote domain.
      type: String
    - contextPath: EWS.RemoteDomain.TNEFEnabled
      description: Whether TNEF is enabled for the remote domain.
      type: Unknown
    - contextPath: EWS.RemoteDomain.TargetDeliveryDomain
      description: Whether the remote domain is used for the target email address
        of mail users that represent the users in the other forest.
      type: Boolean
    - contextPath: EWS.RemoteDomain.TrustedMailInboundEnabled
      description: Whether inbound trusted mail is enabled.
      type: Boolean
    - contextPath: EWS.RemoteDomain.TrustedMailOutboundEnabled
      description: Whether outbound trusted mail is enabled.
      type: Boolean
    - contextPath: EWS.RemoteDomain.UseSimpleDisplayName
      description: Whether to use the simple display name.
      type: Boolean
    - contextPath: EWS.RemoteDomain.WhenChanged
      description: The date the remote domain was changed.
      type: Date
    - contextPath: EWS.RemoteDomain.WhenChangedUTC
      description: The date in UTC format of when the remote domain was changed.
      type: Date
    - contextPath: EWS.RemoteDomain.WhenCreated
      description: The date the remote domain was created.
      type: Date
    - contextPath: EWS.RemoteDomain.WhenCreatedUTC
      description: The date in UTC format of when the remote domain was created.
      type: Date
  - arguments:
    - description: The mailbox you want to view.
      name: identity
    - description: The object's location in Active Directory by which to filter the
        results.
      name: organizational_unit
    - defaultValue: "10"
      description: Maximum number of users to get. A value of 0 means to get all users.
      name: limit
    description: Displays the existing user objects in your organization.
    name: ews-user-list
    outputs:
    - contextPath: EWS.User.AccountDisabled
      description: Whether the user account is disabled.
      type: Boolean
    - contextPath: EWS.User.AllowUMCallsFromNonUsers
      description: Whether to allow Unified Messaging calls from non-users.
      type: Boolean
    - contextPath: EWS.User.ArchiveRelease
      description: The archive release of the user object.
      type: String
    - contextPath: EWS.User.AssistantName
      description: The assistant name of the user object.
      type: String
    - contextPath: EWS.User.AuthenticationPolicy
      description: The authentication policy of the user object.
      type: Unknown
    - contextPath: EWS.User.CanHaveCloudCache
      description: Whether the user object can have cloud cache.
      type: Boolean
    - contextPath: EWS.User.City
      description: The city of the user object.
      type: String
    - contextPath: EWS.User.CloudCacheAccountType
      description: Cloud cache account type of the user object.
      type: String
    - contextPath: EWS.User.CloudCacheProvider
      description: Cloud cache provider of the user object.
      type: Number
    - contextPath: EWS.User.CloudCacheRemoteEmailAddress
      description: Cloud cache remote email address of the user object.
      type: String
    - contextPath: EWS.User.CloudCacheScope
      description: Cloud cache scope of the user object.
      type: Number
    - contextPath: EWS.User.CloudCacheUserName
      description: Cloud cache user name of the user object.
      type: String
    - contextPath: EWS.User.Company
      description: Company of the user object.
      type: String
    - contextPath: EWS.User.ConsumerNetID
      description: Consumer net ID of the user object.
      type: Unknown
    - contextPath: EWS.User.CountryOrRegion
      description: Country or region of the .
      type: String
    - contextPath: EWS.User.DefaultMailboxWorkloadsMask
      description: Default mailbox workloads mask of the user object.
      type: Unknown
    - contextPath: EWS.User.Department
      description: Department of the user object.
      type: String
    - contextPath: EWS.User.DesiredMailboxWorkloads
      description: Desired mailbox workloads of the user object.
      type: Unknown
    - contextPath: EWS.User.DesiredMailboxWorkloadsGracePeriod
      description: Desired mailbox workloads grace period of the user object.
      type: Unknown
    - contextPath: EWS.User.DesiredMailboxWorkloadsModified
      description: Modified desired mailbox workloads of the user object.
      type: Unknown
    - contextPath: EWS.User.DisplayName
      description: Display name of the user object.
      type: String
    - contextPath: EWS.User.DistinguishedName
      description: Distinguished name of the user object.
      type: String
    - contextPath: EWS.User.ExchangeObjectId
      description: Exchange object ID of the user object.
      type: String
    - contextPath: EWS.User.ExchangeVersion
      description: Exchange version of the user object.
      type: String
    - contextPath: EWS.User.ExternalDirectoryObjectId
      description: External Directory Object ID of the user object.
      type: String
    - contextPath: EWS.User.Fax
      description: Fax of the user object.
      type: String
    - contextPath: EWS.User.FirstName
      description: First name of the user object.
      type: String
    - contextPath: EWS.User.GeoCoordinates
      description: Geo coordinates of the user object.
      type: Unknown
    - contextPath: EWS.User.Guid
      description: GUID of the user object.
      type: String
    - contextPath: EWS.User.HomePhone
      description: Home phone of the user object.
      type: String
    - contextPath: EWS.User.Id
      description: ID of the user object.
      type: String
    - contextPath: EWS.User.Identity
      description: Identity of the user object.
      type: String
    - contextPath: EWS.User.Initials
      description: Initials of the user object.
      type: String
    - contextPath: EWS.User.IsCloudCache
      description: Whether there is a cloud cache for the user object.
      type: Boolean
    - contextPath: EWS.User.IsCloudCacheBlocked
      description: Whether the cloud cache is blocked.
      type: Boolean
    - contextPath: EWS.User.IsCloudCacheProvisioningComplete
      description: Whether cloud cache provisioning is complete.
      type: Boolean
    - contextPath: EWS.User.IsDirSynced
      description: Whether the directory is synched.
      type: Boolean
    - contextPath: EWS.User.IsInactiveMailbox
      description: Whether the mailbox is inactive.
      type: Boolean
    - contextPath: EWS.User.IsLinked
      description: Whether the user object is linked.
      type: Boolean
    - contextPath: EWS.User.IsSecurityPrincipal
      description: Whether there is a security principal.
      type: Boolean
    - contextPath: EWS.User.IsSoftDeletedByDisable
      description: Whether soft delete is disabled and hard (permanent) delete occurs.
      type: Boolean
    - contextPath: EWS.User.IsSoftDeletedByRemove
      description: When the Exchange Online mailbox is deleted (soft delete), this
        property is set to True.
      type: Boolean
    - contextPath: EWS.User.IsValid
      description: Whether the user object is valid.
      type: Boolean
    - contextPath: EWS.User.LastName
      description: Last name of the user object.
      type: String
    - contextPath: EWS.User.LegacyExchangeDN
      description: Legacy exchange distinguished name of the user object.
      type: String
    - contextPath: EWS.User.LegalAgeGroup
      description: Legal age group of the user object.
      type: Unknown
    - contextPath: EWS.User.LinkedMasterAccount
      description: Linked master account of the user object.
      type: String
    - contextPath: EWS.User.MailboxLocations
      description: Mailbox locations of the user object.
      type: String
    - contextPath: EWS.User.MailboxProvisioningConstraint
      description: Mailbox provisioning constraint of the user object.
      type: Unknown
    - contextPath: EWS.User.MailboxRegion
      description: Mailbox region of the user object.
      type: Unknown
    - contextPath: EWS.User.MailboxRegionLastUpdateTime
      description: Last time the mailbox region  of the user object was updated.
      type: Unknown
    - contextPath: EWS.User.MailboxRegionSuffix
      description: Mailbox region suffix of the user object.
      type: String
    - contextPath: EWS.User.MailboxRelease
      description: Mailbox release of the user object.
      type: String
    - contextPath: EWS.User.MailboxWorkloads
      description: Mailbox workloads of the user object.
      type: String
    - contextPath: EWS.User.Manager
      description: Manager of the user object.
      type: Unknown
    - contextPath: EWS.User.MicrosoftOnlineServicesID
      description: Microsoft Online Services ID of the user object.
      type: String
    - contextPath: EWS.User.MobilePhone
      description: Mobile phone of the user object.
      type: String
    - contextPath: EWS.User.Name
      description: Name of the user object.
      type: String
    - contextPath: EWS.User.NetID
      description: Network ID of the user object.
      type: String
    - contextPath: EWS.User.Notes
      description: Notes for the user object.
      type: String
    - contextPath: EWS.User.ObjectCategory
      description: Object category of the user object.
      type: String
    - contextPath: EWS.User.ObjectClass
      description: Object class of the user object.
      type: String
    - contextPath: EWS.User.ObjectState
      description: Object state of the user object.
      type: String
    - contextPath: EWS.User.Office
      description: Office of the user object.
      type: String
    - contextPath: EWS.User.OrganizationId
      description: Organization ID of the user object.
      type: String
    - contextPath: EWS.User.OrganizationalUnit
      description: Organizational unit of the user object.
      type: String
    - contextPath: EWS.User.OriginatingServer
      description: Originating server of the user object.
      type: String
    - contextPath: EWS.User.PSComputerName
      description: PowerShell computer name of the user object.
      type: String
    - contextPath: EWS.User.PSShowComputerName
      description: Whether to show the PowerShell computer name of the user object.
      type: Boolean
    - contextPath: EWS.User.Pager
      description: Pager of the user object.
      type: String
    - contextPath: EWS.User.Phone
      description: Phone of the user object.
      type: String
    - contextPath: EWS.User.PhoneticDisplayName
      description: Phonetic display name of the user object.
      type: String
    - contextPath: EWS.User.PostalCode
      description: Postal Code of the user object.
      type: String
    - contextPath: EWS.User.PreviousRecipientTypeDetails
      description: Details of the previous recipient type of the user object.
      type: String
    - contextPath: EWS.User.RecipientType
      description: Recipient type of the user object.
      type: String
    - contextPath: EWS.User.RecipientTypeDetails
      description: Details of the recipient type of the user object.
      type: String
    - contextPath: EWS.User.RemotePowerShellEnabled
      description: Whether remote PowerShell is enabled for the user object.
      type: Boolean
    - contextPath: EWS.User.ResetPasswordOnNextLogon
      description: Whether to reset the password on next logon.
      type: Boolean
    - contextPath: EWS.User.RunspaceId
      description: Runspace ID of the user object.
      type: String
    - contextPath: EWS.User.SKUAssigned
      description: Whether SKU is assigned.
      type: Boolean
    - contextPath: EWS.User.SamAccountName
      description: sAMAccountName of the user object.
      type: String
    - contextPath: EWS.User.SeniorityIndex
      description: Seniority index of the user object.
      type: Unknown
    - contextPath: EWS.User.Sid
      description: SID of the user object.
      type: String
    - contextPath: EWS.User.SimpleDisplayName
      description: Simple display name of the user object.
      type: String
    - contextPath: EWS.User.StateOrProvince
      description: State or province of the user object.
      type: String
    - contextPath: EWS.User.StreetAddress
      description: Street address of the user object.
      type: String
    - contextPath: EWS.User.StsRefreshTokensValidFrom
      description: The validation start date for the Security Token Service (STS)
        refresh tokens of the user object.
      type: Date
    - contextPath: EWS.User.TelephoneAssistant
      description: Telephone assistant of the user object.
      type: String
    - contextPath: EWS.User.Title
      description: Title of the user object.
      type: String
    - contextPath: EWS.User.UMDialPlan
      description: Unified Messaging (UM) dial plan of the user object.
      type: Unknown
    - contextPath: EWS.User.UMDtmfMap
      description: Unified Messaging (UM) dual tone multi-frequency (DTMF) map of
        the user object.
      type: String
    - contextPath: EWS.User.UpgradeDetails
      description: Upgrade details of the user object.
      type: Unknown
    - contextPath: EWS.User.UpgradeMessage
      description: Upgrade message of the user object.
      type: Unknown
    - contextPath: EWS.User.UpgradeRequest
      description: Upgrade request of the user object.
      type: String
    - contextPath: EWS.User.UpgradeStage
      description: Upgrade stage of the user object.
      type: Unknown
    - contextPath: EWS.User.UpgradeStageTimeStamp
      description: Upgrade stage time stamp of the user object.
      type: Unknown
    - contextPath: EWS.User.UpgradeStatus
      description: Upgrade status of the user object.
      type: String
    - contextPath: EWS.User.UserAccountControl
      description: User account control of the user object.
      type: String
    - contextPath: EWS.User.UserPrincipalName
      description: User principal name of the user object.
      type: String
    - contextPath: EWS.User.WebPage
      description: Web page of the user object.
      type: String
    - contextPath: EWS.User.WhenChanged
      description: The date the user object was changed.
      type: Date
    - contextPath: EWS.User.WhenChangedUTC
      description: The date in UTC format of when the user object was changed.
      type: Date
    - contextPath: EWS.User.WhenCreated
      description: The date the user object was created.
      type: Date
    - contextPath: EWS.User.WhenCreatedUTC
      description: The date in UTC format of when the user object was created.
      type: Date
    - contextPath: EWS.User.WhenSoftDeleted
      description: When the user object was soft deleted.
      type: Unknown
    - contextPath: EWS.User.WindowsEmailAddress
      description: Windows email address of the user object.
      type: String
    - contextPath: EWS.User.WindowsLiveID
      description: Windows live ID of the user object.
      type: String
    - contextPath: EWS.User.DirectReports
      description: Direct reports of the user object.
      type: String
  - arguments:
    - description: The mailbox you want to view.
      name: identity
    - description: The domain controller that's used by this cmdlet to read data from
        or write data to Active Directory. You identify the domain controller by its
        fully qualified domain name (FQDN). This argument is available only in on-premises
        Exchange.
      name: domain_controller
    - defaultValue: "10"
      description: Maximum number of users to get. A value of 0 means to get all users.
      name: limit
    description: Retrieves information about the AuditBypassEnabled property value
      for user accounts (on-premises Exchange and the cloud) and computer accounts
      (on-premises Exchange only).
    name: ews-mailbox-audit-bypass-association-list
    outputs:
    - contextPath: EWS.MailboxAuditBypassAssociation.AuditBypassEnabled
      description: Whether the mailbox audit bypass association is enabled.
      type: Boolean
    - contextPath: EWS.MailboxAuditBypassAssociation.DistinguishedName
      description: Distinguished name of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.ExchangeObjectId
      description: Exchange object ID of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.ExchangeVersion
      description: The version of the exchanged server.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.Guid
      description: The GUID of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.Id
      description: ID of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.Identity
      description: The unique identity of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.IsValid
      description: Whether the mailbox audit bypass association property is enabled.
      type: Boolean
    - contextPath: EWS.MailboxAuditBypassAssociation.Name
      description: Name of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.ObjectCategory
      description: Object category of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.ObjectClass
      description: Object class of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.ObjectId
      description: Object ID of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.ObjectState
      description: Object state of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.OrganizationId
      description: Organization ID of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.OriginatingServer
      description: Originating server of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.PSComputerName
      description: PowerShell computer name of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.PSShowComputerName
      description: Whether to show the computer name of the mailbox audit bypass association.
      type: Boolean
    - contextPath: EWS.MailboxAuditBypassAssociation.RunspaceId
      description: Runspace ID of the mailbox audit bypass association.
      type: String
    - contextPath: EWS.MailboxAuditBypassAssociation.WhenChanged
      description: The date the mailbox audit bypass association was changed.
    - contextPath: EWS.MailboxAuditBypassAssociation.WhenChangedUTC
      description: The date in UTC of when the mailbox audit bypass association was
        changed.
      type: Date
    - contextPath: EWS.MailboxAuditBypassAssociation.WhenCreated
      description: The date the mailbox audit bypass association was created.
      type: Date
    - contextPath: EWS.MailboxAuditBypassAssociation.WhenCreatedUTC
      description: The date in UTC format of when the mailbox audit bypass association
        was created.
      type: Date
  - arguments:
    - description: A comma-separated list of identities of the messages to export.
      isArray: true
      name: identities
    - description: The identity of a single message to export.
      name: identity
    - auto: PREDEFINED
      description: Specify whether the output should be compressed.
      name: compress_output
      predefined:
      - "false"
      - "true"
    - description: The type of entity being exported.
      name: entity_type
    - auto: PREDEFINED
      description: Specify whether to force conversion to MIME format.
      name: force_conversion_to_mime
      predefined:
      - "false"
      - "true"
    - description: Password to encrypt the exported file.
      name: password
    - description: Reason for exporting the message.
      name: reason_for_export
    - description: Email address to send the exported message to.
      name: recipient_address
    description: Export quarantine messages. Uses PowerShell Export-QuarantineMessage
      cmdlet.
    execution: true
    name: ews-export-quarantinemessage
    outputs:
    - contextPath: EWS.ExportQuarantineMessage.BodyEncoding
      description: Encoding used for the body of the message.
      type: string
    - contextPath: EWS.ExportQuarantineMessage.Eml
      description: The email message in Base64 encoding.
      type: string
    - contextPath: EWS.ExportQuarantineMessage.Identity
      description: Unique identifier for the retrieved message.
      type: string
    - contextPath: EWS.ExportQuarantineMessage.Organization
      description: Identifier for the organization associated with the message.
      type: string
  - arguments:
    - description: The identity of a single message to retrieve.
      name: identity
    - description: The type of entity being retrieved.
      name: entity_type
    - description: Email address of the recipient.
      name: recipient_address
    - description: Email address of the sender.
      name: sender_address
    - description: Types of Teams conversations to retrieve.
      name: teams_conversation_types
    - description: Direction of the message (Inbound/Outbound).
      name: direction
    - description: Domain associated with the message.
      name: domain
    - description: End date for the message expiration.
      name: end_expires_date
    - description: End date for when the message was received.
      name: end_received_date
    - auto: PREDEFINED
      description: Include messages from blocked sender addresses.
      name: include_messages_from_blocked_sender_address
      predefined:
      - "false"
      - "true"
    - description: ID of the message.
      name: message_id
    - auto: PREDEFINED
      description: Include only items belonging to the user.
      name: my_items
      predefined:
      - "false"
      - "true"
    - description: Page number for pagination.
      name: page
    - description: Number of items per page.
      name: page_size
    - description: Name of the policy associated with the message.
      name: policy_name
    - description: Types of policies associated with the message.
      name: policy_types
    - description: Types of quarantine associated with the message.
      name: quarantine_types
    - description: Tag associated with the recipient.
      name: recipient_tag
    - description: Release status of the message.
      name: release_status
    - auto: PREDEFINED
      description: Include only reported messages.
      name: reported
      predefined:
      - "false"
      - "true"
    - description: Start date for the message expiration.
      name: start_expires_date
    - description: Start date for when the message was received.
      name: start_received_date
    - description: Subject of the message.
      name: subject
    - description: Type of the message.
      name: type
    description: Retrieve quarantine messages. Uses PowerShell Get-QuarantineMessage
      cmdlet.
    execution: true
    name: ews-get-quarantinemessage
    outputs:
    - contextPath: EWS.GetQuarantineMessage.ApprovalId
      description: Approval ID of the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.ApprovalUPN
      description: User Principal Name (UPN) of the approver.
      type: string
    - contextPath: EWS.GetQuarantineMessage.CustomData
      description: Custom data associated with the message.
      type: unknown
    - contextPath: EWS.GetQuarantineMessage.DeletedForRecipients
      description: List of recipients for whom the message was deleted.
      type: string
    - contextPath: EWS.GetQuarantineMessage.Direction
      description: Direction of the message (Inbound/Outbound).
      type: string
    - contextPath: EWS.GetQuarantineMessage.EntityType
      description: Entity type of the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.Expires
      description: Expiry date of the message.
      type: date
    - contextPath: EWS.GetQuarantineMessage.Identity
      description: Unique identifier for the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.MessageId
      description: Message ID of the email.
      type: string
    - contextPath: EWS.GetQuarantineMessage.MoveToQuarantineAdminActionTakenBy
      description: Admin action taken by.
      type: string
    - contextPath: EWS.GetQuarantineMessage.MoveToQuarantineApprovalId
      description: Approval ID for moving to quarantine.
      type: string
    - contextPath: EWS.GetQuarantineMessage.Organization
      description: Identifier for the organization associated with the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.OverrideReason
      description: Reason for overriding the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.OverrideReasonIntValue
      description: Integer value of the override reason.
      type: number
    - contextPath: EWS.GetQuarantineMessage.PermissionToAllowSender
      description: Permission to allow the sender.
      type: boolean
    - contextPath: EWS.GetQuarantineMessage.PermissionToBlockSender
      description: Permission to block the sender.
      type: boolean
    - contextPath: EWS.GetQuarantineMessage.PermissionToDelete
      description: Permission to delete the message.
      type: boolean
    - contextPath: EWS.GetQuarantineMessage.PermissionToDownload
      description: Permission to download the message.
      type: boolean
    - contextPath: EWS.GetQuarantineMessage.PermissionToPreview
      description: Permission to preview the message.
      type: boolean
    - contextPath: EWS.GetQuarantineMessage.PermissionToRelease
      description: Permission to release the message.
      type: boolean
    - contextPath: EWS.GetQuarantineMessage.PermissionToRequestRelease
      description: Permission to request release of the message.
      type: boolean
    - contextPath: EWS.GetQuarantineMessage.PermissionToViewHeader
      description: Permission to view the header of the message.
      type: boolean
    - contextPath: EWS.GetQuarantineMessage.PolicyName
      description: Name of the policy applied to the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.PolicyType
      description: Type of the policy applied to the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.QuarantineTypes
      description: Types of quarantine applied to the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.QuarantinedUser
      description: List of users quarantined.
      type: string
    - contextPath: EWS.GetQuarantineMessage.ReceivedTime
      description: Time the message was received.
      type: date
    - contextPath: EWS.GetQuarantineMessage.RecipientAddress
      description: List of recipient email addresses.
      type: string
    - contextPath: EWS.GetQuarantineMessage.RecipientCount
      description: Number of recipients.
      type: number
    - contextPath: EWS.GetQuarantineMessage.RecipientTag
      description: Tags associated with the recipient.
      type: string
    - contextPath: EWS.GetQuarantineMessage.ReleaseStatus
      description: Release status of the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.Released
      description: Whether the message was released.
      type: boolean
    - contextPath: EWS.GetQuarantineMessage.ReleasedBy
      description: List of users who released the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.ReleasedCount
      description: Number of times the message was released.
      type: number
    - contextPath: EWS.GetQuarantineMessage.ReleasedUser
      description: List of users who released the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.Reported
      description: Whether the message was reported.
      type: boolean
    - contextPath: EWS.GetQuarantineMessage.SenderAddress
      description: Email address of the sender.
      type: string
    - contextPath: EWS.GetQuarantineMessage.Size
      description: Size of the message in bytes.
      type: number
    - contextPath: EWS.GetQuarantineMessage.SourceId
      description: Source ID of the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.Subject
      description: Subject of the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.SystemReleased
      description: Whether the system released the message.
      type: boolean
    - contextPath: EWS.GetQuarantineMessage.TagName
      description: Tag name associated with the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.TeamsConversationType
      description: Teams conversation type associated with the message.
      type: string
    - contextPath: EWS.GetQuarantineMessage.Type
      description: Type of the message.
      type: string
  - arguments:
    - description: The user associated with the quarantine message.
      name: user
    - description: A comma-separated list of identities of the messages to release.
      isArray: true
      name: identities
    - description: The identity of a single message to release.
      name: identity
    - auto: PREDEFINED
      description: Specify whether to release the message to all recipients.
      name: release_to_all
      predefined:
      - "false"
      - "true"
    - auto: PREDEFINED
      description: Specify whether to allow the sender.
      name: allow_sender
      predefined:
      - "false"
      - "true"
    - description: The type of entity being released.
      name: entity_type
    - auto: PREDEFINED
      description: Specify whether to force the release.
      name: force
      predefined:
      - "false"
      - "true"
    - auto: PREDEFINED
      description: Specify whether to report the message as a false positive.
      name: report_false_positive
      predefined:
      - "false"
      - "true"
    - description: The type of action to take when releasing the message.
      name: action_type
    description: Release quarantine messages. Uses PowerShell Release-QuarantineMessage
      cmdlet.
    execution: true
    name: ews-release-quarantinemessage
  - arguments:
    - description: Entries to remove from the list.  Either use this OR 'ids' to specify
        items to remove.  Separate multiple entries with a comma (e.g. "Item1,Item2").
      isArray: true
      name: entries
    - description: Entry IDs to remove from the list.  Either use this OR 'entries'
        to specify items to remove.  Separate multiple entries with a comma (e.g.
        "Item1,Item2").
      name: ids
    - auto: PREDEFINED
      description: List type to remove items from.
      name: list_type
      predefined:
      - sender
      - filehash
      - url
      required: true
    - auto: PREDEFINED
      defaultValue: Tenant
      description: List subtype to remove items from.
      name: list_subtype
      predefined:
      - Tenant
      - AdvancedDelivery
      - Submission
    description: Remove items from the Tenant Allow/Block Lists.   You can delete
      items by their value or by unique ID.  Uses PowerShell cmdlet Remove-TenantAllowBlockListItems
      cmdlet.
    name: ews-remove-tenant-allow-block-list-items
    outputs:
    - contextPath: EWS.RemovedTenantBlocks.Action
      description: Action.
      type: string
    - contextPath: EWS.RemovedTenantBlocks.EntryValueHash
      description: Null for deleted items.
      type: string
    - contextPath: EWS.RemovedTenantBlocks.Error
      description: Null for deleted items.
      type: string
    - contextPath: EWS.RemovedTenantBlocks.ExpirationDate
      description: Null for deleted items.
      type: string
    - contextPath: EWS.RemovedTenantBlocks.Identity
      description: Blank for deleted items.
      type: string
    - contextPath: EWS.RemovedTenantBlocks.LastModifiedDateTime
      description: Null for deleted items.
      type: string
    - contextPath: EWS.RemovedTenantBlocks.ListSubType
      description: Null for deleted items.
      type: string
    - contextPath: EWS.RemovedTenantBlocks.ModifiedBy
      description: Null for deleted items.
      type: string
    - contextPath: EWS.RemovedTenantBlocks.Notes
      description: Null for deleted items.
      type: string
    - contextPath: EWS.RemovedTenantBlocks.ObjectState
      description: State of the object (Deleted).
      type: string
    - contextPath: EWS.RemovedTenantBlocks.PSComputerName
      description: Name of Remote Powershell endpoint.
      type: string
    - contextPath: EWS.RemovedTenantBlocks.PSShowComputerName
      description: Flag whether or not remote computer name is shown in PS prompt.
      type: boolean
    - contextPath: EWS.RemovedTenantBlocks.RunspaceId
      description: RunspaceID of the entry.
      type: string
    - contextPath: EWS.RemovedTenantBlocks.SubmissionID
      description: SubmissionID of the entry.
      type: string
    - contextPath: EWS.RemovedTenantBlocks.SysManaged
      description: SysManaged property of the entry.
      type: boolean
    - contextPath: EWS.RemovedTenantBlocks.Value
      description: The value of the entry that was removed.
      type: string
  - arguments:
    - description: The mailbox that contains the Inbox rule.
      name: mailbox
      required: true
    - defaultValue: "50"
      description: Maximum number of rules to get. A value of 0 means to get all rules.
      name: limit
    description: Retrieve a list of an Inbox rules.
    name: ews-rule-list
    outputs:
    - contextPath: EWS.Rule.RuleIdentity
      description: The rule identity.
      type: string
    - contextPath: EWS.Rule.Name
      description: The rule name.
      type: string
    - contextPath: EWS.Rule.Enabled
      description: Whether the rule is enabled or not.
      type: string
    - contextPath: EWS.Rule.Priority
      description: The priorty of the rule.
      type: string
  - arguments:
    - description: The mailbox that contains the Inbox rule.
      name: mailbox
      required: true
    - description: The Inbox rule that you want to view.
      name: identity
      required: true
    description: Retrieve information about the Inbox rule properties.
    name: ews-get-rule
    outputs:
    - contextPath: EWS.Rule.Rule
      description: The rule identity.
      type: string
    - contextPath: EWS.Rule.RuleName
      description: The rule name.
      type: string
    - contextPath: EWS.Rule.IsEnabled
      description: Whether the rule is enabled or not.
      type: boolean
    - contextPath: EWS.Rule.Priority
      description: The priorty of the rule.
      type: string
    - contextPath: EWS.Rule.Description
      description: The description of the rule.
      type: string
    - contextPath: EWS.Rule.StopProcessingRules
      description: Stop Processing Rules.
      type: string
    - contextPath: EWS.Rule.IsValid
      description: Whether the rule is valid or not.
      type: boolean
  - arguments:
    - description: The mailbox that contains the Inbox rule.
      name: mailbox
      required: true
    - description: The Inbox rule that you want to remove.
      name: identity
      required: true
    description: Remove an Inbox rule.
    name: ews-remove-rule
  dockerimage: demisto/pwsh-exchangev3:1.0.0.88371
  runonce: false
  script: |-
    ### pack version: 1.5.1

    <# IMPORTANT NOTICE
    # When conencting to ExchangeOnline - only needed command between CreateSession
    # and DisconnectSession and let also the `finally` term to disconnect (it will do nothing if everything is fine).
    # This will reduce the time sessions are opened between Exchange and the server and will create
    # less problems.
    # DO NOT USE ONE FINALLY STATEMENT: we don't know if and when it'll be executed and anyway it the DisconnectSession
    # should be called before returning results to the server.
    #>
    Import-Module ExchangeOnlineManagement

    # Disable PowerShell progress bars, as they aren't helpful in a non-interactive script
    $Global:ProgressPreference = 'SilentlyContinue'

    $script:INTEGRATION_NAME = "EWS extension"
    $script:COMMAND_PREFIX = "ews"
    $script:INTEGRATION_ENTRY_CONTEXT = "EWS"
    $script:JUNK_RULE_ENTRY_CONTEXT = "$script:INTEGRATION_ENTRY_CONTEXT.Rule.Junk(val.Email && val.Email == obj.Email)"
    $script:MESSAGE_TRACE_ENTRY_CONTEXT = "$script:INTEGRATION_ENTRY_CONTEXT.MessageTrace(val.MessageId && val.MessageId == obj.MessageId)"


    function ParseJunkRulesToEntryContext([PSObject]$raw_response) {
        return @{
            $script:JUNK_RULE_ENTRY_CONTEXT = @{
                "MailboxOwnerId"              = $raw_response.MailboxOwnerId
                "Identity"                    = $raw_response.Identity
                "BlockedSendersAndDomains"    = $raw_response.BlockedSendersAndDomains
                "TrustedRecipientsAndDomains" = $raw_response.TrustedRecipientsAndDomains
                "TrustedSendersAndDomains"    = $raw_response.TrustedSendersAndDomains
                "TrustedListsOnly"            = $raw_response.TrustedListsOnly
                "ContactsTrusted"             = $raw_response.ContactsTrusted
                "Enabled"                     = $raw_response.Enabled
            }
        }

        <#
            .DESCRIPTION
            Parse junk rules raw response.

            .PARAMETER raw_response
            Junk rules raw response.

            .EXAMPLE
            ParseJunkRulesToEntryContext $raw_response

            .OUTPUTS
            PSObject - entry context.
        #>
    }


    function ParseMessageTraceToEntryContext([PSObject]$raw_response) {
        $entry_context = @{}
        if ($raw_response) {
            $entry_context = @{
                $script:MESSAGE_TRACE_ENTRY_CONTEXT = $raw_response | ForEach-Object {
                    @{
                        "MessageId"        = $_.MessageId
                        "MessageTraceId"   = $_.MessageTraceId
                        "Organization"     = $_.Organization
                        "Received"         = $_.Received
                        "RecipientAddress" = $_.RecipientAddress
                        "SenderAddress"    = $_.SenderAddress
                        "Size"             = $_.Size
                        "StartDate"        = $_.StartDate
                        "EndDate"          = $_.EndDate
                        "Status"           = $_.Status
                        "Subject"          = $_.Subject
                        "ToIP"             = $_.ToIP
                        "FromIP"           = $_.FromIP
                        "Index"            = $_.Index
                    }
                }
            }
        }

        return $entry_context
        <#
            .DESCRIPTION
            Parse message trace raw response.

            .PARAMETER raw_response
            Message trace raw response.

            .EXAMPLE
            ParseMessageTraceToEntryContext $raw_response

            .OUTPUTS
            PSObject - entry context.
        #>
    }

    function ParseRawResponse([PSObject]$response) {
        $items = @()
        ForEach ($item in $response){
            if ($item -Is [HashTable])
                {
            # Need to convert hashtables to ordered dicts so that the keys/values will be in the same order
                $item = $item | ConvertTo-OrderedDict
                }
            elseif ($item -Is [PsCustomObject]){
                $newItem = @{}
                $item.PSObject.Properties | ForEach-Object { $newItem[$_.Name] = $_.Value }
                $item = $newItem | ConvertTo-OrderedDict
            }

            if($item.Keys -contains "RuleIdentity"){
                $item.RuleIdentity = ($item.RuleIdentity).ToString()
            }
            $items += $item
        }
        return $items
    }


    class ExchangeOnlinePowershellV3Client
    {
        [string]$url
        [System.Security.Cryptography.X509Certificates.X509Certificate2]$certificate
        [string]$organization
        [string]$app_id
        [SecureString]$password
        ExchangeOnlinePowershellV3Client(
                [string]$url,
                [string]$app_id,
                [string]$organization,
                [string]$certificate,
                [SecureString]$password
        )
        {
            $this.url = $url
            try
            {
                $ByteArray = [System.Convert]::FromBase64String($certificate)
            }
            catch
            {
                throw "Could not decode the certificate. Try to re-enter it"
            }
            $this.certificate = [System.Security.Cryptography.X509Certificates.X509Certificate2]::new($ByteArray, $password)

            $this.organization = $organization
            $this.app_id = $app_id
        }
        CreateSession()
        {
            $cmd_params = @{
                "AppID" = $this.app_id
                "Organization" = $this.organization
                "Certificate" = $this.certificate
            }
            Connect-ExchangeOnline @cmd_params -ShowBanner:$false -CommandName New-TenantAllowBlockListItems,Get-TenantAllowBlockListItems,Remove-TenantAllowBlockListItems,Get-RemoteDomain,Get-MailboxAuditBypassAssociation,Get-User,Get-FederatedOrganizationIdentifier,Get-FederationTrust,Get-MessageTrace,Set-MailboxJunkEmailConfiguration,Get-Mailbox,Get-MailboxJunkEmailConfiguration,Get-InboxRule,Remove-InboxRule,Export-QuarantineMessage,Get-QuarantineMessage,Release-QuarantineMessage -WarningAction:SilentlyContinue | Out-Null
        }
        DisconnectSession()
        {
            Disconnect-ExchangeOnline -Confirm:$false -WarningAction:SilentlyContinue 6>$null | Out-Null
        }
        [PSObject]
        GetEXOCASMailbox(
                [string]$identity,
                [string]$organizational_unit,
                [string]$primary_smtp_address,
                [string]$user_principal_name,
                [int]$limit
        )
        {
            $cmd_params = @{ }
            if ($identity)
            {
                $cmd_params.Identity = $identity
            }
            if ($organizational_unit)
            {
                $cmd_params.OrganizationalUnit = $organizational_unit
            }
            if ($primary_smtp_address)
            {
                $cmd_params.PrimarySmtpAddress = $primary_smtp_address
            }
            if ($user_principal_name)
            {
                $cmd_params.UserPrincipalName = $user_principal_name
            }
            $this.CreateSession()
            if ($limit -gt 0)
            {
                $results = Get-EXOCASMailbox @cmd_params -ResultSize $limit
            }
            else
            {
                $results = Get-EXOCASMailbox @cmd_params -ResultSize Unlimited
            }
            $this.DisconnectSession()
            return $results

            <#
            .DESCRIPTION
            This cmdlet returns a variety of client access settings for one or more mailboxes.
            These settings include options for Outlook on the web, Exchange ActiveSync, POP3, and IMAP4.
            This cmdlet is available only in the Exchange Online PowerShell V2 module.

            .PARAMETER identity
            The Identity parameter specifies the mailbox you want to view.
            For the best performance, we recommend using the following values:
                * User ID or user principal name (UPN)
                * GUID

            Otherwise, you can use any value that uniquely identifies the mailbox. For example:
                * Name
                * Alias
                * Distinguished name (DN)
                * Domain\Username
                * Email address
                * LegacyExchangeDN
                * SamAccountName

            .PARAMETER organizational_unit
            The OrganizationalUnit parameter filters the results based on the object's location in Active Directory.

            .PARAMETER primary_smtp_address
            The PrimarySmtpAddress identifies the mailbox that you want to view by primary SMTP email address (for example, navin@contoso.onmicrosoft.com).
            Can't be used with user_principal_name.

            .PARAMETER user_principal_name
            The UserPrincipalName parameter identifies the mailbox that you want to view by UPN (for example, navin@contoso.onmicrosoft.com).
            Can't be used with primary_smtp_address.

            .EXAMPLE
            GetEXOCasMailbox("1254y894-feae-9yn7-a3e1-f2483a154tft")

            .OUTPUTS
            PSObject - Raw response

            .LINK
            https://docs.microsoft.com/en-us/powershell/module/exchange/get-exocasmailbox?view=exchange-ps
            #>
        }

        [PSObject]
        GetEXOMailbox(
                [string]$identity,
                [string]$property_sets,
                [int]$limit
        )
        {
            $cmd_params = @{ }
            if ($identity)
            {
                $cmd_params.Identity = $identity
            }
            if ($property_sets)
            {
                $cmd_params.PropertySets = $property_sets
            }
            $this.CreateSession()
            if ($limit -gt 0)
            {
                $results = Get-EXOMailbox @cmd_params -ResultSize $limit
            }
            else
            {
                $results = Get-EXOMailbox @cmd_params -ResultSize Unlimited
            }
            $this.DisconnectSession()
            return $results
            <#
            .DESCRIPTION
            Use the Get-EXOMailbox cmdlet to view mailbox objects and attributes,
            populate property pages, or supply mailbox information to other tasks.
            This cmdlet is available only in the Exchange Online PowerShell V2 module

            .PARAMETER identity
            The Identity parameter specifies the mailbox you want to view.
            For the best performance, we recommend using the following values:
                * User ID or user principal name (UPN)
                * GUID

            Otherwise, you can use any value that uniquely identifies the mailbox. For example:
                * Name
                * Alias
                * Distinguished name (DN)
                * Domain\Username
                * Email address
                * LegacyExchangeDN
                * SamAccountName

            .EXAMPLE
            GetEXOMailbox("1254y894-feae-9yn7-a3e1-f2483a154tft")

            .OUTPUTS
            PSObject - Raw response

            .LINK
            https://docs.microsoft.com/en-us/powershell/module/exchange/get-exomailbox?view=exchange-ps
            #>
        }

        [PSObject]
        GetEXOMailboxPermission(
                [string]$identity
        )
        {
            # Import and Execute command
            $cmd_params = @{ }
            if ($identity)
            {
                $cmd_params.Identity = $identity
            }
            $this.CreateSession()
            $results = Get-EXOMailboxPermission @cmd_params
            $this.DisconnectSession()
            return $results

            <#
            .DESCRIPTION
            View information about SendAs permissions that are configured for users.
            This command is available only in the Exchange Online PowerShell V2 module.

            .PARAMETER identity
            The Identity parameter the user that you want to view. You can use any value that uniquely identifies the user

            .EXAMPLE
            GetEXOMailboxPermission("1254y894-feae-9yn7-a3e1-f2483a154tft")

            .OUTPUTS
            PSObject - Raw response

            .LINK
            https://docs.microsoft.com/en-us/powershell/module/exchange/get-exomailboxpermission?view=exchange-ps
            #>
        }
        [PSObject]
        GetEXORecipientPermission(
                [string]$identity,
                [int]$limit
        )
        {
            $this.CreateSession()

            $cmd_params = @{ }
            if ($identity) {
                $cmd_params.Identity = $identity
            }
            if ($limit -gt 0) {
                $cmd_params.ResultSize = $limit
            } else  {
                $cmd_params.ResultSize = Unliimited
            }
            $results = Get-EXORecipientPermission @cmd_params

            $this.DisconnectSession()
            return $results
            <#
            .DESCRIPTION
            Use the Get-EXORecipientPermission cmdlet to view information about SendAs permissions that are
            configured for users in a cloud-based organization.
            This command is available only in the Exchange Online PowerShell V2 module

            .PARAMETER identity
            The Identity parameter specifies the mailbox you want to view.
            For the best performance, we recommend using the following values:
                * User ID or user principal name (UPN)
                * GUID

            Otherwise, you can use any value that uniquely identifies the mailbox. For example:
                * Name
                * Alias
                * Distinguished name (DN)
                * Domain\Username
                * Email address
                * LegacyExchangeDN
                * SamAccountName
            #>
        }
        [PSObject]
        GetEXORecipient(
                [string]$identity,
                [int]$limit
        )
        {
            $cmd_params = @{ Properties="Guid" }
            if ($identity)
            {
                $cmd_params.Identity = $identity
            }
            $this.CreateSession()
            if ($limit -gt 0)
            {
                $results = Get-EXORecipient @cmd_params -ResultSize $limit
            }
            else
            {
                $results = Get-EXORecipient @cmd_params -ResultSize Unlimited
            }
            $this.DisconnectSession()
            return $results
            <#
                .DESCRIPTION
                Use the Get-ExORecipient cmdlet to view existing recipient objects in your organization.
                This cmdlet returns all mail-enabled objects (for example,
                mailboxes, mail users, mail contacts, and distribution groups).

                #>
        }

        [PSObject]
        EXONewTenantAllowBlockList(
                [string]$entries,
                [string]$list_type,
                [string]$list_subtype,
                [string]$action,
                [string]$notes,
                [bool]$no_expiration,
                [string]$expiration_date
        )
        {
            $cmd_params = @{ }
            $entries_array = @()
            if ($entries.Contains(','))
            {
                $entries_array = $entries -split ','
            }
            if ($entries -and -not $entries_array)
            {
                $entries_array += $entries
                $cmd_params.Entries = $entries_array
            }
            else
            {
                $cmd_params.Entries = $entries_array
            }
            if ($list_type)
            {
                $cmd_params.ListType = $list_type
            }
            if ($list_subtype)
            {
                $cmd_params.ListSubType = $list_subtype
            }
            if ($notes)
            {
                $cmd_params.Notes = $notes
            }
            if ($no_expiration)
            {
                $cmd_params.NoExpiration = $null
            }
            if ($expiration_date)
            {
                $cmd_params.ExpirationDate = $expiration_date
            }
            if ($action -eq "Block")
            {
                $cmd_params.Block = $null
            }
            if ($action -eq "Allow")
            {
                $cmd_params.Allow = $null
            }
            $this.CreateSession()
            $results = New-TenantAllowBlockListItems @cmd_params
            $this.DisconnectSession()
            return $results
            <#
                .DESCRIPTION
                Use the New-TenantAllowBlockListItems cmdlet to add new entries to the Tenant Allow/Block Lists for your organization.
                This cmdlet returns all new entries created, details about them, and their status

                .LINK
                https://learn.microsoft.com/en-us/powershell/module/exchange/new-tenantallowblocklistitems?view=exchange-ps

            #>
        }

        [PSObject]
        EXOExportQuarantineMessage(
            [string[]]$identities,
            [string]$identity,
            [bool]$compress_output,
            [string]$entity_type,
            [bool]$force_conversion_to_mime,
            [string]$password,
            [string]$reason_for_export,
            [string]$recipient_address
        )
        {
            $results = ""
            try {
                $cmd_params = @{ }
                if ($identities)
                {
                    $cmd_params.Identities = $identities
                }
                if ($identity)
                {
                    $cmd_params.Identity = $identity
                }
                if ($compress_output)
                {
                    $cmd_params.CompressOutput = $null
                }
                if ($entity_type)
                {
                    $cmd_params.EntityType = $entity_type
                }
                if ($force_conversion_to_mime)
                {
                    $cmd_params.ForceConversionToMime = $null
                }
                if ($password)
                {
                    $cmd_params.Password = $password
                }
                if ($reason_for_export)
                {
                    $cmd_params.ReasonForExport = $reason_for_export
                }
                if ($recipient_address)
                {
                    $cmd_params.RecipientAddress = $recipient_address
                }
                $this.CreateSession()
                $results = Export-QuarantineMessage @cmd_params
            }
            finally {
                $this.DisconnectSession()
            }
            if ($null -eq $results) {
                return @{}
            } else {
                return $results
            }
            <#
                .DESCRIPTION
                Use the Export-QuarantineMessage cmdlet to export messages from quarantine in your organization.
                This cmdlet allows you to export one or more messages in various formats.

                .LINK
                https://learn.microsoft.com/en-us/powershell/module/exchange/export-quarantinemessage?view=exchange-ps
            #>
        }

        [PSObject]
        EXOGetQuarantineMessage(
            [hashtable]$params
        )
        {
            $results = ""
            try {
                $cmd_params = @{}
                $param_keys = @("Identity", "EntityType", "RecipientAddress", "SenderAddress", "TeamsConversationTypes",
                                "Direction", "Domain", "EndExpiresDate", "EndReceivedDate", "MessageId", "Page",
                                "PageSize", "PolicyName", "PolicyTypes", "QuarantineTypes", "RecipientTag",
                                "ReleaseStatus", "StartExpiresDate", "StartReceivedDate", "Subject", "Type")

                foreach ($key in $param_keys) {
                    if ($params.$key) {
                        $cmd_params.$key = $params.$key
                    }
                }

                if ($params.IncludeMessagesFromBlockedSenderAddress -eq $true) { $cmd_params.IncludeMessagesFromBlockedSenderAddress = $true }
                if ($params.MyItems -eq $true) { $cmd_params.MyItems = $true }
                if ($params.Reported -eq $true) { $cmd_params.Reported = $true }

                $this.CreateSession()
                $results = Get-QuarantineMessage @cmd_params
            }
            finally {
                $this.DisconnectSession()
            }
            if ($null -eq $results) {
                return @{}
            } else {
                return $results
            }
        }


        [PSObject]
        EXOReleaseQuarantineMessage(
            [string]$user,
            [string[]]$identities,
            [string]$identity,
            [bool]$release_to_all,
            [bool]$allow_sender,
            [string]$entity_type,
            [bool]$force,
            [bool]$report_false_positive,
            [string]$action_type
        )
        {
            if (-not $identities -and -not $identity) {
                return ""
            }
            try {
                $cmd_params = @{ }
                if ($user) {
                    $cmd_params.User = $user
                }
                if ($release_to_all) {
                    $cmd_params.ReleaseToAll = $release_to_all
                }
                if ($identities) {
                    $cmd_params.Identities = $identities
                }
                if ($identity) {
                    $cmd_params.Identity = $identity
                }
                if ($allow_sender) {
                    $cmd_params.AllowSender = $null
                }
                if ($entity_type) {
                    $cmd_params.EntityType = $entity_type
                }
                if ($force) {
                    $cmd_params.Force = $null
                }
                if ($report_false_positive) {
                    $cmd_params.ReportFalsePositive = $null
                }
                if ($action_type) {
                    $cmd_params.ActionType = $action_type
                }
                $this.CreateSession()
                Release-QuarantineMessage @cmd_params
            }
            finally {
                $this.DisconnectSession()
            }
            return ""
            <#
                .DESCRIPTION
                Use the Release-QuarantineMessage cmdlet to release messages from quarantine in your organization.
                This cmdlet allows you to release one or more messages and manage sender allow lists.

                .LINK
                https://learn.microsoft.com/en-us/powershell/module/exchange/release-quarantinemessage?view=exchange-ps
            #>
        }
        [PSObject]
        EXORemoveTenantAllowBlockList(
                [string]$entries,
                [string]$ids,
                [string]$list_type,
                [string]$list_subtype
        )
        {
            $cmd_params = @{ }
            $entries_array = @()
            $ids_array = @()
            if ($entries.Contains(','))
            {
                $entries_array = $entries -split ','
            }
            if ($entries -and -not $entries_array)
            {
                $entries_array += $entries
                $cmd_params.Entries = $entries_array
            }
            elseif ($entries_array)
            {
                $cmd_params.Entries = $entries_array
            }
            if ($ids -and $ids.Contains(','))
            {
                $ids_array = $ids -split ','
            }
            if ($ids_array)
            {
                $cmd_params.Ids = $ids_array
            }
            if ($list_type)
            {
                $cmd_params.ListType = $list_type
            }
            if ($list_subtype)
            {
                $cmd_params.ListSubType = $list_subtype
            }
            $this.CreateSession()
            $results = Remove-TenantAllowBlockListItems @cmd_params
            $this.DisconnectSession()
            return $results
            <#
                .DESCRIPTION
                Use the New-TenantAllowBlockListItems cmdlet to add new entries to the Tenant Allow/Block Lists for your organization.
                This cmdlet returns all new entries created, details about them, and their status

                .LINK
                https://learn.microsoft.com/en-us/powershell/module/exchange/remove-tenantallowblocklistitems?view=exchange-ps

            #>
        }

        [PSObject]
        EXOGetTenantAllowBlockList(
                [string]$entry,
                [string]$list_type,
                [string]$list_subtype,
                [string]$action,
                [bool]$no_expiration,
                [string]$expiration_date
        )
        {
            $results = ""
            try {
                $cmd_params = @{ }
                if ($entry)
                {
                    $cmd_params.Entry = $entry
                }
                if ($list_type)
                {
                    $cmd_params.ListType = $list_type
                }
                if ($list_subtype)
                {
                    $cmd_params.ListSubType = $list_subtype
                }
                if ($no_expiration)
                {
                    $cmd_params.NoExpiration = $null
                }
                if ($expiration_date)
                {
                    $cmd_params.ExpirationDate = $expiration_date
                }
                if ($action -eq "Block")
                {
                    $cmd_params.Block = $null
                }
                if ($action -eq "Allow")
                {
                    $cmd_params.Allow = $null
                }
                $this.CreateSession()
                $results = Get-TenantAllowBlockListItems @cmd_params
            }
            finally {
                $this.DisconnectSession()
            }
            return $results
            <#
                .DESCRIPTION
                Use the Get-TenantAllowBlockListItems cmdlet to retrieve current entries in the Tenant Allow/Block Lists for your organization.
                This cmdlet returns current entries and details about them.

                .LINK
                https://learn.microsoft.com/en-us/powershell/module/exchange/get-tenantallowblocklistitems?view=exchange-ps

            #>
        }
        [psobject]GetJunkRules([string]$mailbox) {
            $response = ''
            try {
                # Establish session to remote
                $this.CreateSession()
                # Import and Execute command
                $cmd_params = @{
                    "Identity" = $mailbox
                }
                $response = Get-MailboxJunkEmailConfiguration @cmd_params
            }
            finally {
                # Close session to remote
                $this.DisconnectSession()
            }
            return $response
            <#
                .DESCRIPTION
                Get junk rules in mailbox.

                .PARAMETER mailbox
                Mailbox ID.

                .EXAMPLE
                $client.GetJunkRules("test@microsoft.com")

                .OUTPUTS
                psobject - Raw response.

                .LINK
                https://docs.microsoft.com/en-us/powershell/module/exchange/get-mailboxjunkemailconfiguration?view=exchange-ps
            #>
        }

        SetJunkRules([string]$mailbox, [string[]]$add_blocked_senders_and_domains, [string[]]$remove_blocked_senders_and_domains,
            [string[]]$add_trusted_senders_and_domains, [string[]]$remove_trusted_senders_and_domains,
            [bool]$trusted_lists_only, [bool]$contacts_trusted, [bool]$enabled) {
            try {
                # Establish session to remote
                $this.CreateSession()
                # Import and Execute command
                $cmd_params = @{
                    "Identity"                 = $mailbox
                    "TrustedListsOnly"         = $trusted_lists_only
                    "ContactsTrusted"          = $contacts_trusted
                    "Enabled"                  = $enabled
                    "Confirm"                  = $false
                }
                $blocked_senders_and_domains = CreateAddAndRemoveSections $add_blocked_senders_and_domains $remove_blocked_senders_and_domains
                if ($blocked_senders_and_domains -ne $null){
                    $cmd_params["BlockedSendersAndDomains"] = $blocked_senders_and_domains
                }
                $trusted_senderns_and_domains = CreateAddAndRemoveSections $add_trusted_senders_and_domains $remove_trusted_senders_and_domains
                if ($trusted_senderns_and_domains -ne $null){
                    $cmd_params["TrustedSendersAndDomains"] = $trusted_senderns_and_domains
                }
                Set-MailboxJunkEmailConfiguration @cmd_params
            }
            finally {
                # Close session to remote
                $this.DisconnectSession()
            }
            <#
                .DESCRIPTION
                Set junk rules in mailbox.

                .PARAMETER mailbox
                Mailbox ID.

                .PARAMETER add_blocked_senders_and_domains
                Blocked senders and domains (Comma separated).

                .PARAMETER remove_blocked_senders_and_domains
                Blocked senders and domains (Comma separated) to remove.

                .PARAMETER add_trusted_senders_and_domains
                Trusted senders and domains (Comma separated).

                .PARAMETER remove_trusted_senders_and_domains
                Trusted senders and domains (Comma separated) to remove.

                .PARAMETER trusted_lists_only
                Whether to trust only list of defined in trusted lists.

                .PARAMETER contacts_trusted
                Whether contacts trusted by default.

                .PARAMETER enabled
                Whether junk rule is enabled.

                .OUTPUTS
                psobject - Raw response.

                .LINK
                https://docs.microsoft.com/en-us/powershell/module/exchange/set-mailboxjunkemailconfiguration?view=exchange-ps
            #>
        }

        SetGlobalJunkRules([string]$mailbox, [string[]]$add_blocked_senders_and_domains, [string[]]$remove_blocked_senders_and_domains,
            [string[]]$add_trusted_senders_and_domains, [string[]]$remove_trusted_senders_and_domains,
            [bool]$trusted_lists_only, [bool]$contacts_trusted, [bool]$enabled) {
            try {
                # Establish session to remote
                $this.CreateSession()
                # Import and Execute command
                $cmd_params = @{
                    "TrustedListsOnly"         = $trusted_lists_only
                    "ContactsTrusted"          = $contacts_trusted
                    "Enabled"                  = $enabled
                    "Confirm"                  = $false
                }
                $blocked_senders_and_domains = CreateAddAndRemoveSections $add_blocked_senders_and_domains $remove_blocked_senders_and_domains
                if ($blocked_senders_and_domains -ne $null){
                    $cmd_params["BlockedSendersAndDomains"] = $blocked_senders_and_domains
                }
                $trusted_senderns_and_domains = CreateAddAndRemoveSections $add_trusted_senders_and_domains $remove_trusted_senders_and_domains
                if ($trusted_senderns_and_domains -ne $null){
                    $cmd_params["TrustedSendersAndDomains"] = $trusted_senderns_and_domains
                }
                Get-Mailbox -RecipientTypeDetails UserMailbox -ResultSize Unlimited | ForEach-Object {
                    Set-MailboxJunkEmailConfiguration -Identity $_.Name @cmd_params
                }
            }
            finally {
                # Close session to remote
                $this.DisconnectSession()
            }
            <#
                .DESCRIPTION
                Set junk rules in all managed accounts.

                .PARAMETER add_blocked_senders_and_domains
                Blocked senders and domains (Comma separated).

                .PARAMETER remove_blocked_senders_and_domains
                Blocked senders and domains (Comma separated) to remove.

                .PARAMETER add_trusted_senders_and_domains
                Trusted senders and domains (Comma separated).

                .PARAMETER remove_trusted_senders_and_domains
                Trusted senders and domains (Comma separated) to remove.

                .PARAMETER trusted_lists_only
                Whether to trust only list of defined in trusted lists.

                .PARAMETER contacts_trusted
                Whether contacts trusted by default.

                .PARAMETER enabled
                Whether junk rule is enabled.

                .PARAMETER mailbox
                Mailbox ID.

                .OUTPUTS
                psobject - Raw response.

                .LINK
                https://docs.microsoft.com/en-us/exchange/antispam-and-antimalware/antispam-protection/configure-antispam-settings?view=exchserver-2019
            #>
        }

        [PSObject]GetMessageTrace([string[]]$sender_address, [string[]]$recipient_address, [string[]]$from_ip, [string[]]$to_ip, [string[]]$message_id,
            [string]$message_trace_id, [int32]$page, [int32]$page_size, [String]$start_date, [String]$end_date, [string]$status) {
            $response = ""
            try {
                # Establish session to remote
                $this.CreateSession()
                # Import and Execute command
                $cmd_params = @{
                    "Page"             = $page
                    "PageSize"         = $page_size
                }
                if ($sender_address) {
                    $cmd_params.SenderAddress = $sender_address
                }
                if ($recipient_address) {
                    $cmd_params.RecipientAddress = $recipient_address
                }
                if ($status) {
                    $cmd_params.Status = $status
                }
                if ($start_date) {
                    $cmd_params.StartDate = $start_date
                    if ($end_date) {
                        $cmd_params.EndDate = $end_date
                    }
                    else {
                        $cmd_params.EndDate = Get-Date -UFormat "%D %I:%M %p"
                    }
                }
                if ($from_ip) {
                    $cmd_params.FromIP = $from_ip
                }
                if ($to_ip) {
                    $cmd_params.ToIP = $to_ip
                }
                if ($message_id) {
                    $cmd_params.MessageId = $message_id
                }
                if ($message_trace_id) {
                    $cmd_params.MessageTraceId = $message_trace_id
                }
                $response = Get-MessageTrace @cmd_params
            }
            finally {
                # Close session to remote
                $this.DisconnectSession()
            }
            return $response
            <#
                .DESCRIPTION
                Search message data for the last 10 days.

                .PARAMETER sender_address
                The sender_address parameter filters the results by the sender's email address.

                .PARAMETER recipient_address
                The recipient_address parameter filters the results by the recipient's email address. You can specify multiple values separated by commas.

                .PARAMETER from_ip
                The from_ip parameter filters the results by the source IP address.
                For incoming messages, the value of from_ip is the public IP address of the SMTP email server that sent the message.
                For outgoing messages from Exchange Online, the value is blank.

                .PARAMETER to_ip
                The to_ip parameter filters the results by the destination IP address.
                For outgoing messages, the value of to_ip is the public IP address in the resolved MX record for the destination domain.
                For incoming messages to Exchange Online, the value is blank.

                .PARAMETER message_id
                The message_id parameter filters the results by the Message-ID header field of the message.
                This value is also known as the Client ID. The format of the Message-ID depends on the messaging server that sent the message.
                The value should be unique for each message. However, not all messaging servers create values for the Message-ID in the same way.
                Besure to include the full Message ID string (which may include angle brackets) and enclose the value in quotation marks (for example,"d9683b4c-127b-413a-ae2e-fa7dfb32c69d@DM3NAM06BG401.Eop-nam06.prod.protection.outlook.com").

                .PARAMETER message_trace_id
                The message_trace_id parameter can be used with the recipient address to uniquely identify a message trace and obtain more details.
                A message trace ID is generated for every message that's processed by the system.

                .PARAMETER page
                The page parameter specifies the page number of the results you want to view.
                Valid input for this parameter is an integer between 1 and 1000. The default value is 1.

                .PARAMETER page_size
                The page_size parameter specifies the maximum number of entries per page.
                Valid input for this parameter is an integer between 1 and 5000. The default value is 100.

                .PARAMETER start_date
                The start_date parameter specifies the start date of the date range.
                Use the short date format that's defined in the Regional Options settings on the computer where you're running the command. For example, if the computer is configured to use the short date format mm/dd/yyyy,
                enter 09/01/2018 to specify September 1, 2018. You can enter the date only, or you can enter the date and time of day.
                If you enter the date and time of day, enclose the value in quotation marks ("), for example, "09/01/2018 5:00 PM".
                Valid input for this parameter is from 10 days - now ago. The default value is 48 hours ago.

                .PARAMETER end_date
                The end_date parameter specifies the end date of the date range.
                Use the short date format that's defined in the Regional Options settings on the computer where you're running the command.
                For example, if the computer is configured to use the short date format mm/dd/yyyy, enter 09/01/2018 to specify September 1, 2018.
                You can enter the date only, or you can enter the date and time of day.
                If you enter the date and time of day, enclose the value in quotation marks ("), for example, "09/01/2018 5:00 PM".
                Valid input for this parameter is from start_date - now. The default value is now.

                .PARAMETER status
                * GettingStatus: The message is waiting for status update.
                * Failed: Message delivery was attempted and it failed or the message was filtered as spam or malware, or by transport rules.
                * Pending: Message delivery is underway or was deferred and is being retried.
                * Delivered: The message was delivered to its destination.
                * Expanded: There was no message delivery because the message was addressed to a distribution group and the membership of the distribution was expanded.
                * Quarantined: The message was quarantined.
                * FilteredAsSpam: The message was marked as spam.

                .OUTPUTS
                psobject - Raw response.

                .LINK
                https://docs.microsoft.com/en-us/powershell/module/exchange/get-messagetrace?view=exchange-ps
            #>
        }

        [PSObject]GetFederationTrust(
                [string]$domain_controller,
                [string]$identity
        )
        {
            $response = ""
            try {
                # Establish session to remote
                $this.CreateSession()
                # Import and Execute command
                $cmd_params = @{}
                if ($identity) {
                    $cmd_params.Identity = $identity
                }
                if ($domain_controller) {
                    $cmd_params.DomainController = $domain_controller
                }
                $response = Get-FederationTrust @cmd_params
            }
            finally {
                $this.DisconnectSession()
            }
            return $response
            <#
            .DESCRIPTION
            Use the Get-FederationTrust cmdlet to view the federation trust configured for the Exchange organization.

            .PARAMETER domain_controller
            This parameter is available only in on-premises Exchange.
            The DomainController parameter specifies the domain controller that's used by this
            cmdlet to read data from or write data to Active Directory. You identify the domain
            controller by its fully qualified domain name (FQDN).
            For example, dc01.contoso.com.

            .PARAMETER identity
            The Identity parameter specifies a federation trust ID. If not specified, the cmdlet returns
            all federation trusts configured for the Exchange organization.

            .EXAMPLE
            GetFederationTrust("dc01.contoso.com", "1254y894-feae-9yn7-a3e1-f2483a154tft")

            .OUTPUTS
            PSObject - Raw response

            .LINK
            https://docs.microsoft.com/en-us/powershell/module/exchange/get-federationtrust?view=exchange-ps
        #>
        }


        [PSObject]GetFederationConfiguration(
            [string]$domain_controller,
            [string]$identity,
            [bool]$include_extended_domain_info
        ) {
            $response = ""
            try {
                # Establish session to remote
                $this.CreateSession()
                # Import and Execute command
                $cmd_params = @{}
                if ($identity) {
                    $cmd_params.Identity = $identity
                }
                if ($domain_controller) {
                    $cmd_params.DomainController = $domain_controller
                }
                if ($include_extended_domain_info) {
                    $cmd_params.IncludeExtendedDomainInfo = $include_extended_domain_info
                }
                $response = Get-FederatedOrganizationIdentifier @cmd_params
            }
            finally {
                $this.DisconnectSession()
            }
            return $response
            <#
            .DESCRIPTION
            Use the Get-FederatedOrganizationIdentifier cmdlet to retrieve the Exchange organization's federated
            organization identifier and related details, such as federated domains, organization contact and status.

            .PARAMETER domain_controller
            This parameter is available only in on-premises Exchange.
            The DomainController parameter specifies the domain controller that's used by this
            cmdlet to read data from or write data to Active Directory. You identify the domain
            controller by its fully qualified domain name (FQDN).
            For example, dc01.contoso.com.

            .PARAMETER identity
            The Identity parameter specifies a federation trust ID. If not specified, the cmdlet returns
            all federation trusts configured for the Exchange organization.

            .PARAMETER include_extended_domain_info
            The IncludeExtendedDomainInfo switch specifies that the command query Microsoft Federation Gateway for the status of each
            accepted domain that's federated. The status is returned with each domain in the Domains property.

            .EXAMPLE
            GetFederationConfiguration("dc01.contoso.com", "1254y894-feae-9yn7-a3e1-f2483a154tft", $true)

            .OUTPUTS
            PSObject - Raw response

            .LINK
            https://docs.microsoft.com/en-us/powershell/module/exchange/get-federatedorganizationidentifier?view=exchange-ps
            #>
        }
        [PSObject]GetUser(
            [string]$identity,
            [string]$organizational_unit,
            [int]$limit
        ) {
            $response = ""
            try
            {
                # Establish session to remote
                $this.CreateSession()
                # Import and Execute command
                $cmd_params = @{ }
                if ($identity)
                {
                    $cmd_params.Identity = $identity
                }
                if ($organizational_unit)
                {
                    $cmd_params.OrganizationalUnit = $organizational_unit
                }
                if ($limit -gt 0)
                {
                    $response = Get-User @cmd_params -ResultSize $limit -WarningAction:SilentlyContinue
                }
                else
                {
                    $response = Get-User @cmd_params -ResultSize Unlimited
                }
            } finally {
                $this.DisconnectSession()
            }
            return $response
            <#
            .DESCRIPTION
            Use the Get-User command to view existing user objects in your organization.

            .PARAMETER identity
            The Identity parameter the user that you want to view. You can use any value that uniquely identifies the user

            .PARAMETER orgranizational_unit
            The OrganizationalUnit parameter filters the results based on the object's location in Active Directory.

            .EXAMPLE
            GetUser("user@microsoft.com")

            .OUTPUTS
            PSObject - Raw response

            .LINK
            https://docs.microsoft.com/en-us/powershell/module/exchange/get-user?view=exchange-ps        #>
        }
        [PSObject]GetMailboxAuditBypassAssociation(
            [string]$identity,
            [string]$domain_controller,
            [int]$limit
        )
        {
            $response = ""
            try {
                # Establish session to remote
                $this.CreateSession()
                # Import and Execute command
                $cmd_params = @{ }
                if ($identity) {
                    $cmd_params.Identity = $identity
                }
                if ($domain_controller) {
                    $cmd_params.DomainController = $domain_controller
                }
                if ($limit -gt 0){
                    $cmd_params.ResultSize = $limit
                }
                $response = Get-MailboxAuditBypassAssociation @cmd_params -WarningAction:SilentlyContinue
            } finally {
                $this.DisconnectSession()
            }
            return $response
            <#
            .DESCRIPTION
            Retrieve information about the AuditBypassEnabled property value for user accounts
            (on-premises Exchange and the cloud) and computer accounts (on-premises Exchange only).

            .PARAMETER identity
            The Identity parameter the user that you want to view. You can use any value that uniquely identifies the user

            .PARAMETER domain_controller
            The DomainController parameter specifies the domain controller that's used by this cmdlet to read data from
            or write data to Active Directory. You identify the domain controller by its fully qualified domain name (FQDN).

            .EXAMPLE

            .OUTPUTS
            PSObject - Raw response

            .LINK
            https://docs.microsoft.com/en-us/powershell/module/exchange/get-mailboxauditbypassassociation?view=exchange-ps
            #>
        }

        [PSCustomObject]GetRemoteDomain(
            [string]$domain_controller,
            [string]$identity
        ) {
            $response = ""
            try {
                # Establish session to remote
                $this.CreateSession()
                # Import and Execute command
                $cmd_params = @{}
                if ($identity) {
                    $cmd_params.Identity = $identity
                }
                if ($domain_controller) {
                    $cmd_params.DomainController = $domain_controller
                }
                return Get-RemoteDomain @cmd_params -WarningAction:SilentlyContinue
            }
            finally {
                $this.DisconnectSession()
            }
            return $response
            <#
            .DESCRIPTION
            Use the Get-RemoteDomain cmdlet to view the configuration information for the remote domains configured in
            your organization.

            .PARAMETER domain_controller
            This parameter is available only in on-premises Exchange.
            The DomainController parameter specifies the domain controller that's used by this
            cmdlet to read data from or write data to Active Directory. You identify the domain
            controller by its fully qualified domain name (FQDN).
            For example, dc01.contoso.com.

            .PARAMETER identity
            The Identity parameter specifies a federation trust ID. If not specified, the cmdlet returns
            all federation trusts configured for the Exchange organization.

            .EXAMPLE
            GetRemoteDomain("1254y894-feae-9yn7-a3e1-f2483a154tft")

            .OUTPUTS
            PSObject - Raw response

            .LINK
            https://docs.microsoft.com/en-us/powershell/module/exchange/get-remotedomain?view=exchange-ps
            #>
        }

        [PSObject]GetRules(
            [string]$mailbox,
            [int]$limit
        )
        {
            $response = ""
            try {
                # Establish session to remote
                $this.CreateSession()
                # Import and Execute command
                $cmd_params = @{ }
                if ($mailbox) {
                    $cmd_params.Mailbox = $mailbox
                }

                if ($limit -gt 0){
                    $cmd_params.ResultSize = $limit
                }
                $response = Get-InboxRule @cmd_params -WarningAction:SilentlyContinue
            } finally {
                $this.DisconnectSession()
            }
            return $response
            <#
            .DESCRIPTION
            Retrieve information about the Inbox rule properties.

            .PARAMETER mailbox
            The mailox that contains the Inbox rules

            .PARAMETER limit
            The amount of rules to return.

            .EXAMPLE

            .OUTPUTS
            PSObject - Raw response

            .LINK
            https://learn.microsoft.com/en-us/powershell/module/exchange/get-inboxrule?view=exchange-ps
            #>
        }

        [PSObject]GetRule(
            [string]$mailbox,
            [string]$identity
        )
        {
            $response = ""
            try {
                # Establish session to remote
                $this.CreateSession()
                # Import and Execute command
                $cmd_params = @{ }
                if ($mailbox) {
                    $cmd_params.Mailbox = $mailbox
                }

                if ($identity) {
                    $cmd_params.Identity = $identity
                }

                $response = Get-InboxRule @cmd_params -WarningAction:SilentlyContinue

            } finally {
                $this.DisconnectSession()
            }
            return $response
            <#
            .DESCRIPTION
            Retrieve information about the Inbox rule properties.

            .PARAMETER mailbox
            The mailox that contains the Inbox rule

            .PARAMETER identity
            The Identity parameter the inbox rule that you want to view.

            .EXAMPLE

            .OUTPUTS
            PSObject - Raw response

            .LINK
            https://learn.microsoft.com/en-us/powershell/module/exchange/get-inboxrule?view=exchange-ps
            #>
        }

        [PSObject]RemoveRule(
            [string]$mailbox,
            [string]$identity
        )
        {
            $response = ""
            try {
                # Establish session to remote
                $this.CreateSession()
                # Import and Execute command
                $cmd_params = @{ }
                if ($mailbox) {
                    $cmd_params.Mailbox = $mailbox
                }

                if ($identity) {
                    $cmd_params.Identity = $identity
                }
                $response = Remove-InboxRule -Confirm:$false @cmd_params -WarningAction:SilentlyContinue
            } finally {
                $this.DisconnectSession()
            }
            return $response
            <#
            .DESCRIPTION
            Remove an Inbox rule.

            .PARAMETER mailbox
            The mailbox that contains the Inbox rule

            .PARAMETER identity
            The Identity parameter the inbox rule that you want to remove.

            .EXAMPLE

            .OUTPUTS
            PSObject - Raw response

            .LINK
            https://learn.microsoft.com/en-us/powershell/module/exchange/remove-inboxrule?view=exchange-ps
            #>
        }

    }

    function GetEXORecipientCommand
    {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $identity = $kwargs.identity
        $limit = $kwargs.limit -as [int]
        $raw_response = $client.GetEXORecipient($identity, $limit)
        $human_readable = TableToMarkdown $raw_response "Results of $command"
        $entry_context = @{ "$script:INTEGRATION_ENTRY_CONTEXT.Recipient(obj.Guid === val.Guid)" = $raw_response }
        Write-Output $human_readable, $entry_context, $raw_response
    }

    function GetEXORecipientPermissionCommand
    {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $identity = $kwargs.identity
        $limit = $kwargs.limit -as [int]
        $raw_response = $client.GetEXORecipientPermission($identity, $limit)
        $human_readable = TableToMarkdown $raw_response "Results of $command"
        $entry_context = @{ "$script:INTEGRATION_ENTRY_CONTEXT.RecipientPermission(obj.Identity === val.Identity)" = $raw_response }
        Write-Output $human_readable, $entry_context, $raw_response
    }

    function GetEXOMailBoxPermissionCommand
    {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $identity = $kwargs.identity
        $raw_response = $client.GetEXOMailBoxPermission($identity)
        $human_readable = TableToMarkdown $raw_response "Results of $command"
        $entry_context = @{
            "$script:INTEGRATION_ENTRY_CONTEXT.MailboxPermission(obj.Identity === val.Identity)" = @{
                "Identity" = $identity
                "Permission" = $raw_response
            }
        }
        Write-Output $human_readable, $entry_context, $raw_response
    }

    function GetEXOMailBoxCommand
    {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $identity = $kwargs.identity
        $limit = $kwargs.limit -as [int]
        $raw_response = $client.GetEXOMailBox($identity, $kwargs.property_sets, $limit)
        $human_readable = TableToMarkdown $raw_response "Results of $command"
        $entry_context = @{
            "$script:INTEGRATION_ENTRY_CONTEXT.Mailbox(obj.Guid === val.Guid)" = $raw_response }
        Write-Output $human_readable, $entry_context, $raw_response
    }

    function GetEXOCASMailboxCommand
    {
        [CmdletBinding()]
        Param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $identity = $kwargs.identity
        $organizational_unit = $kwargs.organizational_unit
        $primary_smtp_address = $kwargs.primary_smtp_address
        $user_principal_name = $kwargs.user_principal_name
        $limit = $kwargs.limit -as [int]
        $raw_response = $client.GetEXOCASMailbox(
                $identity, $organizational_unit, $primary_smtp_address, $user_principal_name, $limit
        )
        $human_readable = TableToMarkdown $raw_response "Results of $command"
        $entry_context = @{ "$script:INTEGRATION_ENTRY_CONTEXT.CASMailbox(obj.Guid === val.Guid)" = $raw_response }
        Write-Output $human_readable, $entry_context, $raw_response
    }

    function EXONewTenantAllowBlockListCommand
    {
        [CmdletBinding()]
        Param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $entries = $kwargs.entries
        $list_type = $kwargs.list_type
        $list_subtype = $kwargs.list_subtype
        $action = $kwargs.action
        $notes = $kwargs.notes
        $no_expiration = if ($kwargs.no_expiration -eq "true") { $true } else { $false }
        $expiration_date = $kwargs.expiration_date
        $raw_response = $client.EXONewTenantAllowBlockList(
            $entries, $list_type, $list_subtype, $action, $notes, $no_expiration, $expiration_date
        )
        if($raw_response -eq $null){
            Write-Output "No Tenant Allow/Block List items were found."
        }
        else{
            $human_readable = TableToMarkdown $raw_response "Results of $command"
            $entry_context = @{ "$script:INTEGRATION_ENTRY_CONTEXT.NewTenantBlocks" = $raw_response }
            Write-Output $human_readable, $entry_context, $raw_response
        }

    }

    function EXOGetTenantAllowBlockListCommand
    {
        [CmdletBinding()]
        Param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $entry = $kwargs.entry
        $list_type = $kwargs.list_type
        $list_subtype = $kwargs.list_subtype
        $action = $kwargs.action
        $no_expiration = if ($kwargs.no_expiration -eq "true") { $true } else { $false }
        $expiration_date = $kwargs.expiration_date
        $raw_response = $client.EXOGetTenantAllowBlockList(
            $entry, $list_type, $list_subtype, $action, $no_expiration, $expiration_date
        )
        if($raw_response -eq $null){
            Write-Output "No Tenant Allow/Block List items were found."
        }
        else{
            $human_readable = TableToMarkdown $raw_response "Results of $command"
            $entry_context = @{ "$script:INTEGRATION_ENTRY_CONTEXT.CurrentTenantBlocks" = $raw_response }
            Write-Output $human_readable, $entry_context, $raw_response
        }
    }

    function EXOCountTenantAllowBlockListCommand
    {
        [CmdletBinding()]
        Param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $list_type = $kwargs.list_type
        $list_subtype = $kwargs.list_subtype
        $m = $client.EXOGetTenantAllowBlockList($null, $list_type, $list_subtype, $null, $null, $null) | Measure-Object
        $raw_response = [PSCustomObject]@{
            ListType = $list_type
            ListSubType = $list_subtype
            Count = $m.Count
        }
        if($raw_response -eq $null){
            Write-Output "No Tenant Allow/Block List items were found."
        }
        else{
            $human_readable = TableToMarkdown $raw_response "Results of $command"
            $entry_context = @{ "$script:INTEGRATION_ENTRY_CONTEXT.CurrentListCount" = $raw_response }
            Write-Output $human_readable, $entry_context, $raw_response
        }

    }

    function EXORemoveTenantAllowBlockListCommand
    {
        [CmdletBinding()]
        Param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $entries = $kwargs.entries
        $ids = $kwargs.ids
        $list_type = $kwargs.list_type
        $list_subtype = $kwargs.list_subtype
        if ($entries -and $ids)
        {
            ReturnError "Error: Please provide either entries by value OR IDs, not both."
        }
        $raw_response = $client.EXORemoveTenantAllowBlockList(
            $entries, $ids, $list_type, $list_subtype
        )
        if($raw_response -eq $null){
            Write-Output "No Tenant Allow/Block List items were found."
        }
        else{
            $human_readable = TableToMarkdown $raw_response "Results of $command"
            $entry_context = @{ "$script:INTEGRATION_ENTRY_CONTEXT.RemovedTenantBlocks" = $raw_response }
            Write-Output $human_readable, $entry_context, $raw_response
        }

    }

    function EXOExportQuarantineMessageCommand
    {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $identities = $kwargs.identities
        $identity = $kwargs.identity
        $compress_output = if ($kwargs.compress_output -eq "true") { $true } else { $false }
        $entity_type = $kwargs.entity_type
        $force_conversion_to_mime = if ($kwargs.force_conversion_to_mime -eq "true") { $true } else { $false }
        $password = $kwargs.password
        $reason_for_export = $kwargs.reason_for_export
        $recipient_address = $kwargs.recipient_address

        $raw_response = $client.EXOExportQuarantineMessage(
            $identities,
            $identity,
            $compress_output,
            $entity_type,
            $force_conversion_to_mime,
            $password,
            $reason_for_export,
            $recipient_address
        )

        $human_readable = TableToMarkdown $raw_response "Results of $command"
        $entry_context = @{"$script:INTEGRATION_ENTRY_CONTEXT.ExportQuarantineMessage(obj.Guid === val.Guid)" = $raw_response }
        Write-Output $human_readable, $entry_context, $raw_response
    }

    function EXOGetQuarantineMessageCommand {
        [CmdletBinding()]
        Param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )

        $params = @{
            Identity = $kwargs.identity
            EntityType = $kwargs.entity_type
            RecipientAddress = $kwargs.recipient_address
            SenderAddress = $kwargs.sender_address
            TeamsConversationTypes = $kwargs.teams_conversation_types
            Direction = $kwargs.direction
            Domain = $kwargs.domain
            EndExpiresDate = $kwargs.end_expires_date
            EndReceivedDate = $kwargs.end_received_date
            IncludeMessagesFromBlockedSenderAddress = if ($kwargs.include_messages_from_blocked_sender_address -eq "true") { $true } else { $false }
            MessageId = $kwargs.message_id
            MyItems = if ($kwargs.my_items -eq "true") { $true } else { $false }
            Page = $kwargs.page
            PageSize = $kwargs.page_size
            PolicyName = $kwargs.policy_name
            PolicyTypes = $kwargs.policy_types
            QuarantineTypes = $kwargs.quarantine_types
            RecipientTag = $kwargs.recipient_tag
            ReleaseStatus = $kwargs.release_status
            Reported = if ($kwargs.reported -eq "true") { $true } else { $false }
            StartExpiresDate = $kwargs.start_expires_date
            StartReceivedDate = $kwargs.start_received_date
            Subject = $kwargs.subject
            Type = $kwargs.type
        }

        $raw_response = $client.EXOGetQuarantineMessage($params)

        $human_readable = TableToMarkdown $raw_response "Results of $command"
        $entry_context = @{"$script:INTEGRATION_ENTRY_CONTEXT.GetQuarantineMessage(obj.Guid === val.Guid)" = $raw_response}
        Write-Output $human_readable, $entry_context, $raw_response
    }


    function EXOReleaseQuarantineMessageCommand
    {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )

        $user = $kwargs.user
        $identities = $kwargs.identities
        $identity = $kwargs.identity
        $release_to_all = if ($kwargs.release_to_all -eq "true") { $true } else { $false }
        $allow_sender = if ($kwargs.allow_sender -eq "true") { $true } else { $false }
        $entity_type = $kwargs.entity_type
        $force = if ($kwargs.force -eq "true") { $true } else { $false }
        $report_false_positive = if ($kwargs.report_false_positive -eq "true") { $true } else { $false }
        $action_type = $kwargs.action_type

        $result = $client.EXOReleaseQuarantineMessage(
            $user,
            $identities,
            $identity,
            $release_to_all,
            $allow_sender,
            $entity_type,
            $force,
            $report_false_positive,
            $action_type
        )

        $raw_response = @{}
        $human_readable = $identities ?
        "The following messages have been sent for release from quarantine: $identities" :
        ($identity ?
            "The message with identity $identity has been sent for release from quarantine." :
            "No identities were provided for release from quarantine.");
        $entry_context = @{}
        Write-Output $human_readable, $entry_context, $raw_response
    }

    function GetJunkRulesCommand([ExchangeOnlinePowershellV3Client]$client, [hashtable]$kwargs) {
        $raw_response = $client.GetJunkRules($kwargs.mailbox)
        $md_columns = $raw_response | Select-Object -Property BlockedSendersAndDomains, TrustedSendersAndDomains, ContactsTrusted, TrustedListsOnly, Enabled
        $human_readable = TableToMarkdown $md_columns  "$script:INTEGRATION_NAME - '$($kwargs.mailbox)' Junk rules"
        $entry_context = ParseJunkRulesToEntryContext $raw_response $kwargs.mailbox

        return $human_readable, $entry_context, $raw_response
    }

    function SetJunkRulesCommand([ExchangeOnlinePowershellV3Client]$client, [hashtable]$kwargs) {
        # Parse arguments
        $add_blocked_senders_and_domains = ArgToList $kwargs.add_blocked_senders_and_domains
        $remove_blocked_senders_and_domains = ArgToList $kwargs.remove_blocked_senders_and_domains
        $add_trusted_senders_and_domains = ArgToList $kwargs.add_trusted_senders_and_domains
        $remove_trusted_senders_and_domains = ArgToList $kwargs.remove_trusted_senders_and_domains
        if ($kwargs.trusted_lists_only) {
            $trusted_lists_only = ConvertTo-Boolean $kwargs.trusted_lists_only
        }
        if ($kwargs.contacts_trusted) {
            $contacts_trusted = ConvertTo-Boolean $kwargs.contacts_trusted
        }
        if ($kwargs.enabled) {
            $enabled = ConvertTo-Boolean $kwargs.enabled
        }

        # Execute commands - No output for the command
        $client.SetJunkRules($kwargs.mailbox, $add_blocked_senders_and_domains, $remove_blocked_senders_and_domains,
            $add_trusted_senders_and_domains, $remove_trusted_senders_and_domains,
            $trusted_lists_only, $contacts_trusted, $enabled)

        $raw_response = @{}
        $human_readable = "$script:INTEGRATION_NAME - '$($kwargs.mailbox)' Junk rules **modified**!"
        $entry_context = @{}

        return $human_readable, $entry_context, $raw_response
    }

    function  CreateAddAndRemoveSections([string[]]$items_to_add, [string[]]$items_to_remove ){
        $params = @{}
        if (-not [string]::IsNullOrEmpty($items_to_add)){
            $params["Add"] = $items_to_add
        }
        if (-not [string]::IsNullOrEmpty($items_to_remove)){
            $params["Remove"] =  $items_to_remove
        }
        return $params
    }

    function SetGlobalJunkRulesCommand([ExchangeOnlinePowershellV3Client]$client, [hashtable]$kwargs) {
        # Parse arguments
        $add_blocked_senders_and_domains = ArgToList $kwargs.add_blocked_senders_and_domains
        $remove_blocked_senders_and_domains = ArgToList $kwargs.remove_blocked_senders_and_domains
        $add_trusted_senders_and_domains = ArgToList $kwargs.add_trusted_senders_and_domains
        $remove_trusted_senders_and_domains = ArgToList $kwargs.remove_trusted_senders_and_domains
        if ($kwargs.trusted_lists_only) {
            $trusted_lists_only = ConvertTo-Boolean $kwargs.trusted_lists_only
        }
        if ($kwargs.contacts_trusted) {
            $contacts_trusted = ConvertTo-Boolean $kwargs.contacts_trusted
        }
        if ($kwargs.enabled) {
            $enabled = ConvertTo-Boolean $kwargs.enabled
        }
        # Execute commands - No output for the command
        $client.SetGlobalJunkRules($kwargs.mailbox, $add_blocked_senders_and_domains, $remove_blocked_senders_and_domains,
            $add_trusted_senders_and_domains, $remove_trusted_senders_and_domains,
            $trusted_lists_only, $contacts_trusted, $enabled)

        $raw_response = @{}
        $human_readable = "$script:INTEGRATION_NAME - Junk rules globally **modified**!"
        $entry_context = @{}

        return $human_readable, $entry_context, $raw_response
    }

    function GetMessageTraceCommand([ExchangeOnlinePowershellV3Client]$client, [hashtable]$kwargs) {
        # Parse arguments
        $sender_address = ArgToList $kwargs.sender_address
        $recipient_address = ArgToList $kwargs.recipient_address
        $from_ip = ArgToList $kwargs.from_ip
        $to_ip = ArgToList $kwargs.to_ip

        $raw_response = $client.GetMessageTrace($sender_address, $recipient_address, $from_ip, $to_ip, $kwargs.message_id,
            $kwargs.message_trace_id, $kwargs.page, $kwargs.page_size, $kwargs.start_date,
            $kwargs.end_date, $kwargs.status)

        $entry_context = ParseMessageTraceToEntryContext $raw_response
        if ($entry_context.($script:MESSAGE_TRACE_ENTRY_CONTEXT)) {
            $human_readable = TableToMarkdown $entry_context.($script:MESSAGE_TRACE_ENTRY_CONTEXT)  "$script:INTEGRATION_NAME - Messages trace"
        }
        else {
            $human_readable = "**No messages trace found**"
        }

        return $human_readable, $entry_context, $raw_response
    }

    function GetFederationTrustCommand([ExchangeOnlinePowershellV3Client]$client, [hashtable]$kwargs) {
        [CmdletBinding()]
        # parse arguments
        $domain_controller = $kwargs.domain_controller
        $identity = $kwargs.identity
        $raw_response = $client.GetFederationTrust(
            $domain_controller, $identity
        )
        $human_readable = TableToMarkdown $raw_response "Results of $command"
        $entry_context = @{
            "$script:INTEGRATION_ENTRY_CONTEXT.FederationTrust(obj.ApplicationIdentifier === val.ApplicationIdentifier)" = $raw_response
        }
        Write-Output $human_readable, $entry_context, $raw_response
    }
    function GetFederationConfigurationCommand {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)]
            [ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        # parse arguments
        $domain_controller = $kwargs.domain_controller
        $identity = $kwargs.identity
        $include_extended_domain_info = ConvertTo-Boolean $kwargs.include_extended_domain_info
        $raw_response = $client.GetFederationConfiguration(
            $domain_controller,
            $identity,
            $include_extended_domain_info
        )
        $human_readable = TableToMarkdown $raw_response "Results of $command"
        $entry_context = @{
            "$script:INTEGRATION_ENTRY_CONTEXT.FederationConfiguration(obj.Guid === val.Guid)" = $raw_response
        }
        Write-Output $human_readable, $entry_context, $raw_response
    }
    function GetRemoteDomainCommand {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $identity = $kwargs.identity
        $domain_controller = $kwargs.domain_controller
        $raw_response = $client.GetRemoteDomain($domain_controller, $identity)
        $human_readable = TableToMarkdown $raw_response "Results of $command"
        $entry_context = @{"$script:INTEGRATION_ENTRY_CONTEXT.RemoteDomain(obj.Guid === val.Guid)" = $raw_response }
        Write-Output $human_readable, $entry_context, $raw_response
    }
    function GetUserCommand {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $identity = $kwargs.identity
        $organizational_unit = $kwargs.organizational_unit
        $limit = ($kwargs.limit -as [int])
        $raw_response = $client.GetUser($identity, $organizational_unit, $limit)
        $human_readable = TableToMarkdown $raw_response "Results of $command"
        $entry_context = @{"$script:INTEGRATION_ENTRY_CONTEXT.User(obj.Guid === val.Guid)" = $raw_response}
        Write-Output $human_readable, $entry_context, $raw_response
    }
    function GetMailboxAuditBypassAssociationCommand {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $identity = $kwargs.identity
        $domain_controller = $kwargs.domain_controller
        $limit = ($kwargs.limit -as [int])
        $raw_response = $client.GetMailboxAuditBypassAssociation($identity, $domain_controller, $limit)
        $human_readable = TableToMarkdown $raw_response "Results of $command"
        $entry_context = @{"$script:INTEGRATION_ENTRY_CONTEXT.MailboxAuditBypassAssociation(obj.Guid === val.Guid)" = $raw_response }
        Write-Output $human_readable, $entry_context, $raw_response
    }
    function ListRulesCommand {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $mailbox = $kwargs.mailbox
        $limit = ($kwargs.limit -as [int])
        $raw_response = $client.GetRules($mailbox, $limit)
        if($raw_response -eq $null){
            Write-Output "No Rules were found."
        }
        else{
            $parsed_raw_response = ParseRawResponse $raw_response
            $md_columns = $raw_response | Select-Object -Property Identity, Name, Enabled, Priority, RuleIdentity
            $human_readable = TableToMarkdown $md_columns "Results of $command"
            $entry_context = @{"$script:INTEGRATION_ENTRY_CONTEXT.Rule(obj.RuleIdentity === val.RuleIdentity)" = $parsed_raw_response }
            Write-Output $human_readable, $entry_context, $parsed_raw_response
        }
    }
    function GetRuleCommand {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $mailbox = $kwargs.mailbox
        $identity = $kwargs.identity
        $raw_response = $client.GetRule($mailbox, $identity)
        if($raw_response -eq $null){
            Write-Output "No Rule with identity $identity was found."
        }
        else{
            $parsed_raw_response = ParseRawResponse $raw_response

            $md_columns = $raw_response | Select-Object -Property RuleIdentity, Name, Enabled, Priority, Description, StopProcessingRules, IsValid
            $human_readable = TableToMarkdown $md_columns "Results of $command"
            $entry_context = @{"$script:INTEGRATION_ENTRY_CONTEXT.Rule(obj.RuleIdentity == val.RuleIdentity)" = $parsed_raw_response }
            Write-Output $human_readable, $entry_context, $parsed_raw_response
        }

    }
    function RemoveRuleCommand {
        [CmdletBinding()]
        param (
            [Parameter(Mandatory)][ExchangeOnlinePowershellV3Client]$client,
            [hashtable]$kwargs
        )
        $mailbox = $kwargs.mailbox
        $identity = $kwargs.identity
        $result = $client.RemoveRule($mailbox, $identity)
        $raw_response = @{}
        $human_readable = "Rule $identity has been deleted successfully"
        $entry_context = @{}
        Write-Output $human_readable, $entry_context, $raw_response
    }
    function TestModuleCommand($client)
    {
        try
        {
            $client.CreateSession()
            $demisto.results("ok")
        }
        finally
        {
            $client.DisconnectSession()
        }

    }
    function Main
    {
        [Diagnostics.CodeAnalysis.SuppressMessageAttribute("PSAvoidUsingConvertToSecureStringWithPlainText", "")]
        param()
        $command = $demisto.GetCommand()
        $command_arguments = $demisto.Args()
        $integration_params = [Hashtable] $demisto.Params()

        if ($integration_params.password.password)
        {
            $password = ConvertTo-SecureString $integration_params.password.password -AsPlainText -Force
        }
        else
        {
            $password = $null
        }

        $exo_client = [ExchangeOnlinePowershellV3Client]::new(
                $integration_params.url,
                $integration_params.app_id,
                $integration_params.organization,
                $integration_params.certificate.password,
                $password
        )
        try
        {
            # Executing command
            $Demisto.Debug("Command being called is $Command")
            switch ($command)
            {
                "test-module" {
                    ($human_readable, $entry_context, $raw_response) = TestModuleCommand $exo_client
                }
                "$script:COMMAND_PREFIX-cas-mailbox-list" {
                    ($human_readable, $entry_context, $raw_response) = GetEXOCASMailboxCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-mailbox-list" {
                    ($human_readable, $entry_context, $raw_response) = GetEXOMailBoxCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-mailbox-permission-list" {
                    ($human_readable, $entry_context, $raw_response) = GetEXOMailBoxPermissionCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-recipient-permission-list" {
                    ($human_readable, $entry_context, $raw_response) = GetEXORecipientPermissionCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-recipient-list" {
                    ($human_readable, $entry_context, $raw_response) = GetEXORecipientCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-new-tenant-allow-block-list-items" {
                    ($human_readable, $entry_context, $raw_response) = EXONewTenantAllowBlockListCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-get-tenant-allow-block-list-items" {
                    ($human_readable, $entry_context, $raw_response) = EXOGetTenantAllowBlockListCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-get-tenant-allow-block-list-count" {
                    ($human_readable, $entry_context, $raw_response) = EXOCountTenantAllowBlockListCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-remove-tenant-allow-block-list-items" {
                    ($human_readable, $entry_context, $raw_response) = EXORemoveTenantAllowBlockListCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-export-quarantinemessage" {
                    ($human_readable, $entry_context, $raw_response) = EXOExportQuarantineMessageCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-get-quarantinemessage" {
                    ($human_readable, $entry_context, $raw_response) = EXOGetQuarantineMessageCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-release-quarantinemessage" {
                    ($human_readable, $entry_context, $raw_response) = EXOReleaseQuarantineMessageCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-junk-rules-get" {
                    ($human_readable, $entry_context, $raw_response) = GetJunkRulesCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-junk-rules-set" {
                    ($human_readable, $entry_context, $raw_response) = SetJunkRulesCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-global-junk-rules-set" {
                    ($human_readable, $entry_context, $raw_response) = SetGlobalJunkRulesCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-message-trace-get" {
                    ($human_readable, $entry_context, $raw_response) = GetMessageTraceCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-federation-trust-get" {
                    ($human_readable, $entry_context, $raw_response) = GetFederationTrustCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-federation-configuration-get" {
                    ($human_readable, $entry_context, $raw_response) = GetFederationConfigurationCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-remote-domain-get" {
                    ($human_readable, $entry_context, $raw_response) = GetRemoteDomainCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-user-list" {
                    ($human_readable, $entry_context, $raw_response) = GetUserCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-mailbox-audit-bypass-association-list" {
                    ($human_readable, $entry_context, $raw_response) = GetMailboxAuditBypassAssociationCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-rule-list" {
                    ($human_readable, $entry_context, $raw_response) = ListRulesCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-get-rule" {
                    ($human_readable, $entry_context, $raw_response) = GetRuleCommand $exo_client $command_arguments
                }
                "$script:COMMAND_PREFIX-remove-rule" {
                    ($human_readable, $entry_context, $raw_response) = RemoveRuleCommand $exo_client $command_arguments
                }
                default {
                    ReturnError "Could not recognize $command"
                }
            }
            # Return results to Demisto Server
            ReturnOutputs $human_readable $entry_context $raw_response | Out-Null
        }
        catch
        {
            $Demisto.debug(
                    "Integration: $script:INTEGRATION_NAME
            Command: $command
            Arguments: $( $command_arguments | ConvertTo-Json )
            Error: $( $_.Exception.Message )"
            )
            if ($command -ne "test-module")
            {
                ReturnError "Error:
                Integration: $script:INTEGRATION_NAME
                Command: $command
                Arguments: $( $command_arguments | ConvertTo-Json )
                Error: $( $_.Exception )"
            }
            else
            {
                ReturnError $_.Exception.Message
            }
        }
        finally
        {
            # Always disconnect the session, even if no sessions available.
            $exo_client.DisconnectSession()
        }
    }

    # Execute Main when not in Tests
    if ($MyInvocation.ScriptName -notlike "*.tests.ps1" -AND -NOT$Test)
    {
        Main
    }
  type: powershell
sectionorder:
- Connect
- Collect
system: true
