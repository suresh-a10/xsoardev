contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.5.0
    itemVersion: 1.2.22
    packID: Rapid7_Nexpose
    packName: Rapid7 InsightVM
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: Given an IP address, this playbook searches Rapid7 Nexpose assets for
  an asset with the associated IP address to retrieve asset information and proceeds
  to return all associated tags with it.
id: Rapid7 - Nexpose - Enrichment
inputs:
- description: IP used to search for asset information and tags.
  key: IP
  playbookInputQuery: null
  required: true
  value: {}
name: Rapid7 - Nexpose - Enrichment
outputs:
- contextPath: Nexpose.Asset
  description: List of asset(s) information from the Nexpose search.
  type: unknown
- contextPath: Nexpose.AssetTag
  description: List of asset tags from the Nexpose tag search.
  type: unknown
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 991113ea-0dcc-41d0-8db7-88878c9240af
      iscommand: false
      name: ""
      version: -1
    taskid: 991113ea-0dcc-41d0-8db7-88878c9240af
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": -130
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      ipAddressIs:
        complex:
          root: inputs.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Rapid7 Nexpose
      description: Search and return all assets matching the IP address. Returns only
        assets the user has access to.
      id: 8fdb21c9-d2af-43ce-8d8d-5a21aa6a6711
      iscommand: true
      name: Search for asset information in Nexpose
      script: Rapid7 Nexpose|||nexpose-search-assets
      type: regular
      version: -1
    taskid: 8fdb21c9-d2af-43ce-8d8d-5a21aa6a6711
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 220
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      asset_id:
        complex:
          accessor: AssetId
          root: Nexpose.Asset
    separatecontext: false
    skipunavailable: false
    task:
      brand: Rapid7 Nexpose
      description: Returns the specified tags for an asset.
      id: 362b2f00-e0f9-4a2e-8cad-c55c67ccb2bd
      iscommand: true
      name: Get asset tags related to asset
      script: Rapid7 Nexpose|||nexpose-get-asset-tags
      type: regular
      version: -1
    taskid: 362b2f00-e0f9-4a2e-8cad-c55c67ccb2bd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 640
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Rapid7 Nexpose
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if the "Rapid7 Nexpose" integration instance is enabled
        in order to find assets and asset tags.
      id: 128307bb-2c48-412e-8a51-e0f0df902ce4
      iscommand: false
      name: Is Rapid7 Nexpose enabled?
      type: condition
      version: -1
    taskid: 128307bb-2c48-412e-8a51-e0f0df902ce4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 10
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1175f95a-8df9-4fd3-8ba5-eb9e8ba8cfc5
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 1175f95a-8df9-4fd3-8ba5-eb9e8ba8cfc5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 880
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Asset
                root: Nexpose
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if an asset was found from Rapid7.
      id: 7597e8b2-f4f2-493d-87cf-1dc207f6c799
      iscommand: false
      name: Was an asset found?
      type: condition
      version: -1
    taskid: 7597e8b2-f4f2-493d-87cf-1dc207f6c799
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 200,
          "y": 400
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "3_1_yes": 0.52,
      "3_4_#default#": 0.19,
      "5_2_yes": 0.6,
      "5_4_#default#": 0.2
    },
    "paper": {
      "dimensions": {
        "height": 1075,
        "width": 630,
        "x": 200,
        "y": -130
      }
    }
  }
