contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 7edb4ef0-ae29-4a85-8df5-6df16b8c3bad
inputs: []
name: TCS-Qradar Hunt for IOC
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a9b7823b-e3a8-4c96-8421-bb644ba91ace
      iscommand: false
      name: ""
      version: -1
    taskid: a9b7823b-e3a8-4c96-8421-bb644ba91ace
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 367.5,
          "y": 20
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 1774c6a1-0181-468b-8c12-d0b3ecab0e3a
      iscommand: true
      name: 'Extract Indicators '
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 1774c6a1-0181-468b-8c12-d0b3ecab0e3a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: OnDemandHuntingIPs
      value:
        simple: ${ExtractedIndicators.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Add or update a value in a reference set.
      id: 5af838bd-4c14-4a8f-8ff5-cf10785aaabc
      iscommand: true
      name: Populate IP to reference set OnDemandHuntingIPs
      script: QRadar_v2_copy|||qradar-create-reference-set-value
      type: regular
      version: -1
    taskid: 5af838bd-4c14-4a8f-8ff5-cf10785aaabc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 315,
          "y": 690
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: OnDemandHuntingDomains
      value:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Add or update a value in a reference set.
      id: fc8e2e72-ef1e-4383-8786-6f131ff8a9c7
      iscommand: true
      name: Populate Domains to reference set OnDemandHuntingDomains
      script: QRadar_v2_copy|||qradar-create-reference-set-value
      type: regular
      version: -1
    taskid: fc8e2e72-ef1e-4383-8786-6f131ff8a9c7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 690
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7e4e9a40-949c-4480-89f9-578ee020a17a
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 7e4e9a40-949c-4480-89f9-578ee020a17a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -210,
          "y": 1280
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: select QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as
          'Log Source',"eventCount" as 'Event Count',"startTime" as 'Time',categoryname(category)
          as 'Low Level Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source
          Port',"destinationIP" as 'Destination IP',"destinationPort" as 'Destination
          Port',"userName" as 'Username',"magnitude" as 'Magnitude' from events where
          ( referencesetcontains('OnDemandHuntingDomains', "BC_ParentDomain") AND
          "deviceGroupList"='100074' ) order by "startTime" desc last 30 days
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 89ac6fd0-44c9-4285-88c9-8d30429f4457
      iscommand: false
      name: QRadarFullSearch_v1.0_Domain
      playbookId: 1af6d691-c912-44b9-8502-2b9b2acc4e74
      type: playbook
      version: -1
    taskid: 89ac6fd0-44c9-4285-88c9-8d30429f4457
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 910,
          "y": 865
        }
      }
  "11":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: sonam.bhandari@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: internalis.cybersecurityops@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: v.ghule@tcs.com
        - left:
            iscontext: true
            value:
              simple: incident.labels.Email/from
          operator: isEqualString
          right:
            value:
              simple: nishanth.dharuman@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 065ded45-147e-4850-83bf-197fd9c47ee2
      iscommand: false
      name: Is Email from Authorised Sender
      type: condition
      version: -1
    taskid: 065ded45-147e-4850-83bf-197fd9c47ee2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 367.5,
          "y": 195
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: select QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as
          'Log Source',"eventCount" as 'Event Count',"startTime" as 'Time',categoryname(category)
          as 'Low Level Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source
          Port',"destinationIP" as 'Destination IP',"destinationPort" as 'Destination
          Port',"userName" as 'Username',"magnitude" as 'Magnitude' from events where
          referencesetcontains('OnDemandHuntingIPs', "sourceIP") order by "startTime"
          desc last 30 days
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: e08a2f60-effb-4327-83bf-f4fe39209821
      iscommand: false
      name: QRadarFullSearch_v1.0_Source
      playbookId: 1af6d691-c912-44b9-8502-2b9b2acc4e74
      type: playbook
      version: -1
    taskid: e08a2f60-effb-4327-83bf-f4fe39209821
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 480,
          "y": 865
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: select QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as
          'Log Source',"eventCount" as 'Event Count',"startTime" as 'Time',categoryname(category)
          as 'Low Level Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source
          Port',"destinationIP" as 'Destination IP',"destinationPort" as 'Destination
          Port',"userName" as 'Username',"magnitude" as 'Magnitude' from events where
          referencesetcontains('OnDemandHuntingIPs', "destinationIP") order by "startTime"
          desc last 30 days
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 985e9d98-53c1-4a98-8862-48fd54a6b1ab
      iscommand: false
      name: QRadarFullSearch_v1.0_Destination
      playbookId: 1af6d691-c912-44b9-8502-2b9b2acc4e74
      type: playbook
      version: -1
    taskid: 985e9d98-53c1-4a98-8862-48fd54a6b1ab
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 865
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      body:
        simple: "Hi Team , \n\nPlease find the attached hunt result .\n\nThanks\nCyberSecurity
          AutoBot\n"
      subject:
        simple: Hunt IOC Report from Qradar
      to:
        simple: ${incident.labels.Email/from}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 5a2631f0-b779-4142-86cd-fe06d77d8180
      iscommand: true
      name: Send report via email
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 5a2631f0-b779-4142-86cd-fe06d77d8180
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1195
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 02986d37-af6f-4ccd-84d8-db12dd190f6f
      iscommand: false
      name: Are there IPs to Hunt
      type: condition
      version: -1
    taskid: 02986d37-af6f-4ccd-84d8-db12dd190f6f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 367.5,
          "y": 540
        }
      }
  "19":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain_Test_
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fc5f781e-10b4-41b5-8331-aae749bc12dc
      iscommand: false
      name: Are there Domains to Hunt
      type: condition
      version: -1
    taskid: fc5f781e-10b4-41b5-8331-aae749bc12dc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 840,
          "y": 540
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        complex:
          accessor: events}
          root: ${subplaybook-13.QRadar.Search.Result
      fileName:
        simple: Presence of IOC in Destination.csv
      headers:
        simple: Destination IP,Destination Port,Event Count,Event Name,Log Source,Low
          Level Category,Magnitude,Source IP,Source Port,Time
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 584cf253-c422-43ad-88e7-40e8e687b6c5
      iscommand: false
      name: Presence of IOC in Destination
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 584cf253-c422-43ad-88e7-40e8e687b6c5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1020
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${subplaybook-12.QRadar.Search.Result.events}
      fileName:
        simple: Presence of IOC in Source.csv
      headers:
        simple: Destination IP,Destination Port,Event Count,Event Name,Log Source,Low
          Level Category,Magnitude,Source IP,Source Port,Time
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 51c6cbed-f45b-4dae-86c0-568bd72c4657
      iscommand: false
      name: Presence of IOC in Source
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 51c6cbed-f45b-4dae-86c0-568bd72c4657
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1020
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${subplaybook-10.QRadar.Search.Result.events}
      fileName:
        simple: Presence of Domain.csv
      headers:
        simple: Destination IP,Destination Port,Event Count,Event Name,Log Source,Low
          Level Category,Magnitude,Source IP,Source Port,Time
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: aea190de-973c-4b1a-8675-216d89cf223a
      iscommand: false
      name: Presence of Domain
      script: ExportToCSV
      type: regular
      version: -1
    taskid: aea190de-973c-4b1a-8675-216d89cf223a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1020
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1325,
        "width": 1500,
        "x": -210,
        "y": 20
      }
    }
  }
