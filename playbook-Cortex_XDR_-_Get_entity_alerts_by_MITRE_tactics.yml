contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.5.0
    itemVersion: 6.1.65
    packID: CortexXDR
    packName: Cortex XDR by Palo Alto Networks
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: |-
  This playbook is part of the Cortex XDR by Palo Alto Networksâ€™ pack. This playbook searches alerts related to specific entities from Cortex XDR, on a given timeframe, based on MITRE tactics.
  Note: The playbook's inputs enable manipulating the execution flow. Read the input descriptions for details.
id: Cortex XDR - Get entity alerts by MITRE tactics
inputs:
- description: Set to True to hunt for identified alerts with MITRE Reconnaissance
    techniques.
  key: HuntReconnaissanceTechniques
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to True to hunt for identified alerts with MITRE Initial Access
    techniques.
  key: HuntInitialAccessTechniques
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to True to hunt for identified alerts with MITRE Execution techniques.
  key: HuntExecutionTechniques
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to True to hunt for identified alerts with MITRE Persistence techniques.
  key: HuntPersistenceTechniques
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to True to hunt for identified alerts with MITRE Privilege Escalation
    techniques.
  key: HuntPrivilegeEscalationTechniques
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to True to hunt for identified alerts with MITRE Defense Evasion
    techniques.
  key: HuntDefenseEvasionTechniques
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to True to hunt for identified alerts with MITRE Discovery techniques.
  key: HuntDiscoveryTechniques
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to True to hunt for identified alerts with MITRE Lateral Movement
    techniques.
  key: HuntLateralMovementTechniques
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to True to hunt for identified alerts with MITRE Collection techniques
    .
  key: HuntCollectionTechniques
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to True to hunt for identified alerts with MITRE Command and Control
    techniques.
  key: HuntCnCTechniques
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to True to hunt for identified alerts with MITRE Impact techniques.
  key: HuntImpactTechniques
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to True to hunt for identified alerts with MITRE Credential Access
    techniques.
  key: HuntCredentialAccessTechniques
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: |-
    A time range to execute the hunting in.
    The input should be in the following format:
    * 1 day
    * 2 minutes
    * 4 hours
    * 8 days
  key: timeRange
  playbookInputQuery: null
  required: false
  value:
    simple: 6 hours
- description: Whether to run all the sub-tasks for Mitre Tactics.
  key: RunAll
  playbookInputQuery: null
  required: false
  value:
    simple: "True"
- description: Entity type to search on xdr-get-alerts custom filters.
  key: EntityType
  playbookInputQuery: null
  required: false
  value: {}
- description: Entity value.
  key: entityID
  playbookInputQuery: null
  required: false
  value: {}
name: Cortex XDR - Get entity alerts by MITRE tactics
outputs:
- contextPath: PaloAltoNetworksXDR.Alert
  description: Alerts found.
  type: unknown
- contextPath: ArraySize
  description: Array size.
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2e7c6fcb-b000-4bd4-8ab8-5c6f537acfa5
      iscommand: false
      name: ""
      version: -1
    taskid: 2e7c6fcb-b000-4bd4-8ab8-5c6f537acfa5
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": -1110
        }
      }
  "1":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.HuntDiscoveryTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to hunt for Discovery techniques.
      id: 1e9ed1f5-77cd-4ba4-8f01-8a13a62bba01
      iscommand: false
      name: Should hunt for Discovery techniques?
      type: condition
      version: -1
    taskid: 1e9ed1f5-77cd-4ba4-8f01-8a13a62bba01
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 820,
          "y": 3260
        }
      }
  "2":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.HuntPersistenceTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "18"
      "yes":
      - "73"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to hunt for Persistence techniques.
      id: f810e7cc-3925-48d5-8c67-19ab08c6c14d
      iscommand: false
      name: Should hunt for Persistence techniques?
      type: condition
      version: -1
    taskid: f810e7cc-3925-48d5-8c67-19ab08c6c14d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 810,
          "y": 1240
        }
      }
  "3":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.HuntInitialAccessTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to hunt for Initial Access techniques.
      id: d2f17286-6208-4346-858f-507dfbd9e43d
      iscommand: false
      name: Should hunt for Initial Access techniques?
      type: condition
      version: -1
    taskid: d2f17286-6208-4346-858f-507dfbd9e43d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 800,
          "y": 210
        }
      }
  "4":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.HuntPrivilegeEscalationTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "19"
      "yes":
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to hunt for Privilege Escalation techniques.
      id: cb705c1c-2be2-4ef9-86b8-ae71f0e3d32a
      iscommand: false
      name: Should hunt for Privilege Escalation techniques?
      type: condition
      version: -1
    taskid: cb705c1c-2be2-4ef9-86b8-ae71f0e3d32a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 300,
          "y": 1765
        }
      }
  "5":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.HuntDefenseEvasionTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "62"
      "yes":
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to hunt for Defense Evasion techniques.
      id: 900a4f23-7a9b-4f86-88cf-e11b4b183ed4
      iscommand: false
      name: Should hunt for Defense Evasion techniques?
      type: condition
      version: -1
    taskid: 900a4f23-7a9b-4f86-88cf-e11b4b183ed4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 810,
          "y": 2245
        }
      }
  "6":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.HuntExecutionTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to hunt for Execution techniques.
      id: 80de9f67-7be4-4f83-8ac5-fdd81cb9c583
      iscommand: false
      name: Should hunt for Execution techniques?
      type: condition
      version: -1
    taskid: 80de9f67-7be4-4f83-8ac5-fdd81cb9c583
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 300,
          "y": 760
        }
      }
  "7":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.HuntLateralMovementTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to hunt for Lateral Movement techniques.
      id: d26b2a4b-ad74-4e63-8b08-d3766ff332b8
      iscommand: false
      name: Should hunt for Lateral Movement techniques?
      type: condition
      version: -1
    taskid: d26b2a4b-ad74-4e63-8b08-d3766ff332b8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 350,
          "y": 3780
        }
      }
  "8":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.HuntCollectionTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "79"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to hunt for Collection techniques.
      id: e09af98a-01ad-494f-8499-a60a75de0fce
      iscommand: false
      name: Should hunt for Collection techniques?
      type: condition
      version: -1
    taskid: e09af98a-01ad-494f-8499-a60a75de0fce
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 820,
          "y": 4255
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 60a731f8-4d6b-43b6-825d-a1c12c5cff20
      iscommand: false
      name: Persistence
      type: title
      version: -1
    taskid: 60a731f8-4d6b-43b6-825d-a1c12c5cff20
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 810,
          "y": 1110
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ecae67cb-2dd0-4cc4-85b6-39d8d1872678
      iscommand: false
      name: Initial Access
      type: title
      version: -1
    taskid: ecae67cb-2dd0-4cc4-85b6-39d8d1872678
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 800,
          "y": 80
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 80c56186-6f82-46e3-81cc-e1f5ca970db2
      iscommand: false
      name: Execution
      type: title
      version: -1
    taskid: 80c56186-6f82-46e3-81cc-e1f5ca970db2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 300,
          "y": 620
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b802ec3d-1047-4584-8815-fa53902a49c0
      iscommand: false
      name: Privilege Escalation
      type: title
      version: -1
    taskid: b802ec3d-1047-4584-8815-fa53902a49c0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 300,
          "y": 1635
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3d02cd98-8ac1-46d4-8d3b-1e865a6dc674
      iscommand: false
      name: Defense Evasion
      type: title
      version: -1
    taskid: 3d02cd98-8ac1-46d4-8d3b-1e865a6dc674
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 810,
          "y": 2115
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f6223898-c3ec-4c04-8795-38c7d3af2541
      iscommand: false
      name: Discovery
      type: title
      version: -1
    taskid: f6223898-c3ec-4c04-8795-38c7d3af2541
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 820,
          "y": 3130
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3a90ced3-1ab4-49fd-8965-a94da7483689
      iscommand: false
      name: Lateral Movement
      type: title
      version: -1
    taskid: 3a90ced3-1ab4-49fd-8965-a94da7483689
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 350,
          "y": 3640
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6d30dcb4-8d06-4a45-84f2-3a0179b75b61
      iscommand: false
      name: Collection
      type: title
      version: -1
    taskid: 6d30dcb4-8d06-4a45-84f2-3a0179b75b61
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 820,
          "y": 4120
        }
      }
  "23":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.HuntCnCTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to hunt for Command and Control techniques.
      id: 0e81b7f2-cc2f-4428-8628-36e075eda2aa
      iscommand: false
      name: Should hunt for CnC techniques?
      type: condition
      version: -1
    taskid: 0e81b7f2-cc2f-4428-8628-36e075eda2aa
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 350,
          "y": 4725
        }
      }
  "24":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.HuntImpactTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "81"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to hunt for Impact techniques.
      id: 30f4c85a-c688-49af-894c-aa8eac50b3ba
      iscommand: false
      name: Should hunt for Impact techniques?
      type: condition
      version: -1
    taskid: 30f4c85a-c688-49af-894c-aa8eac50b3ba
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 820,
          "y": 5230
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0204508c-41df-49b8-8845-8758bbed5fd6
      iscommand: false
      name: Command and Control
      type: title
      version: -1
    taskid: 0204508c-41df-49b8-8845-8758bbed5fd6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 350,
          "y": 4590
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f3226c98-20fe-48b6-8292-5575a7337fb1
      iscommand: false
      name: Impact
      type: title
      version: -1
    taskid: f3226c98-20fe-48b6-8292-5575a7337fb1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 820,
          "y": 5095
        }
      }
  "27":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.HuntReconnaissanceTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "65"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to hunt for Reconnaissance techniques.
      id: 2867df20-0adf-4e4f-8a97-cc0230da2154
      iscommand: false
      name: Should hunt for Reconnaissance techniques?
      type: condition
      version: -1
    taskid: 2867df20-0adf-4e4f-8a97-cc0230da2154
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": -270
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b3c85728-d7d1-4f70-876b-dcd6394d3953
      iscommand: false
      name: Reconnaissance
      type: title
      version: -1
    taskid: b3c85728-d7d1-4f70-876b-dcd6394d3953
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": -410
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d126a4c8-162c-4c28-8d70-449f593d1230
      iscommand: false
      name: Hunt by MITRE Tactics
      type: title
      version: -1
    taskid: d126a4c8-162c-4c28-8d70-449f593d1230
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": -980
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 591149d8-6eba-46cb-874b-bb83eea0c6fe
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 591149d8-6eba-46cb-874b-bb83eea0c6fe
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -490,
          "y": 6300
        }
      }
  "59":
    continueonerror: true
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Alert.severity
              operator: containsGeneral
              right:
                value:
                  simple: low
            - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Alert.severity
              operator: containsGeneral
              right:
                value:
                  simple: medium
            - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Alert.severity
              operator: containsGeneral
              right:
                value:
                  simple: high
            - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Alert.severity
              operator: containsGeneral
              right:
                value:
                  simple: critical
          root: PaloAltoNetworksXDR.Alert
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count the array size.
      id: 0ef03699-2b11-4ca5-8b0c-5b216954d287
      iscommand: false
      name: Get number of alerts
      script: CountArraySize
      type: regular
      version: -1
    taskid: 0ef03699-2b11-4ca5-8b0c-5b216954d287
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 6120
        }
      }
  "61":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.HuntCredentialAccessTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "20"
      "yes":
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Whether to hunt for Credential Access techniques.
      id: e74b3bc4-0d79-4cbe-81cd-916387ac13a5
      iscommand: false
      name: Should hunt for Credential Access techniques?
      type: condition
      version: -1
    taskid: e74b3bc4-0d79-4cbe-81cd-916387ac13a5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2780
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d84fcb11-cf36-4538-8013-a5448145d330
      iscommand: false
      name: Credential Access
      type: title
      version: -1
    taskid: d84fcb11-cf36-4538-8013-a5448145d330
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2650
        }
      }
  "64":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Alert
                root: PaloAltoNetworksXDR
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "52"
      "yes":
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Found any alerts?
      id: 1bbb0772-b213-414d-863d-a40a9f870e69
      iscommand: false
      name: Were any alerts found?
      type: condition
      version: -1
    taskid: 1bbb0772-b213-414d-863d-a40a9f870e69
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 350,
          "y": 5930
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: MITRETactics
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "{\n\t\"SEARCH_FIELD\": \"mitre_tactic_id_and_name\",\n\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\"SEARCH_VALUE\": \"TA0043\"\n},"
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 26e05250-6f57-4c27-85b5-c92d78eb123b
      iscommand: false
      name: Add Reconnaissance to query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 26e05250-6f57-4c27-85b5-c92d78eb123b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": -95
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: MITRETactics
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "{\n\t\"SEARCH_FIELD\": \"mitre_tactic_id_and_name\",\n\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\"SEARCH_VALUE\": \"TA0001\"\n},"
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 68ffc625-0f3b-4425-84dc-236b2c0313b6
      iscommand: false
      name: Add Initial Access to query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 68ffc625-0f3b-4425-84dc-236b2c0313b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 800,
          "y": 395
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "82"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      key:
        simple: FinalQuery
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              ctx_data:
                iscontext: true
                value:
                  simple: .
              ctx_inc: {}
              ctx_inputs:
                iscontext: true
                value:
                  simple: inputs
              keep_symbol_to_null: {}
              prefix: {}
              suffix:
                value:
                  simple: "]\n\t\t},\n\t\t{\n\t\t\t\"SEARCH_FIELD\": \"${inputs.EntityType}\",\n\t\t\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\t\t\"SEARCH_VALUE\": \"${inputs.entityID}\"\n\t\t}\n\t]\n}"
              variable_markers: {}
            operator: ConcatFormat
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: '}]'
              toReplace:
                value:
                  simple: '},]'
            operator: replace
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 573bf529-9645-4d2a-8d13-bc005673129a
      iscommand: false
      name: Finalize Query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 573bf529-9645-4d2a-8d13-bc005673129a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 5580
        }
      }
  "72":
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: MITRETactics
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "{\n\t\"SEARCH_FIELD\": \"mitre_tactic_id_and_name\",\n\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\"SEARCH_VALUE\": \"TA0002\"\n},"
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 09415796-64c3-437b-89df-cf1b46e440e6
      iscommand: false
      name: Add Execution  to query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 09415796-64c3-437b-89df-cf1b46e440e6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 300,
          "y": 935
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: MITRETactics
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "{\n\t\"SEARCH_FIELD\": \"mitre_tactic_id_and_name\",\n\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\"SEARCH_VALUE\": \"TA0003\"\n},"
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 76f63ded-eb8f-464e-85c1-e519e6400bad
      iscommand: false
      name: Add Persistence to query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 76f63ded-eb8f-464e-85c1-e519e6400bad
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 1430
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: MITRETactics
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "{\n\t\"SEARCH_FIELD\": \"mitre_tactic_id_and_name\",\n\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\"SEARCH_VALUE\": \"TA0004\"\n},"
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 2a5e6ddc-c534-4666-8447-500193c75182
      iscommand: false
      name: Add Privilege Escalation to query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 2a5e6ddc-c534-4666-8447-500193c75182
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 300,
          "y": 1945
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: MITRETactics
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "{\n\t\"SEARCH_FIELD\": \"mitre_tactic_id_and_name\",\n\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\"SEARCH_VALUE\": \"TA0005\"\n},"
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 28d083c0-9897-471d-8b95-f674de7e010b
      iscommand: false
      name: Add Defense Evasion to query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 28d083c0-9897-471d-8b95-f674de7e010b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 2435
        }
      }
  "76":
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: MITRETactics
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "{\n\t\"SEARCH_FIELD\": \"mitre_tactic_id_and_name\",\n\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\"SEARCH_VALUE\": \"TA0006\"\n},"
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 67032c34-3141-418a-8a62-98c06859301a
      iscommand: false
      name: Add Credential Access to query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 67032c34-3141-418a-8a62-98c06859301a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2960
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: MITRETactics
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "{\n\t\"SEARCH_FIELD\": \"mitre_tactic_id_and_name\",\n\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\"SEARCH_VALUE\": \"TA0007\"\n},"
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 002d2f5c-6762-41cb-853a-620c3daba597
      iscommand: false
      name: Add Discovery to query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 002d2f5c-6762-41cb-853a-620c3daba597
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 3460
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: MITRETactics
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "{\n\t\"SEARCH_FIELD\": \"mitre_tactic_id_and_name\",\n\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\"SEARCH_VALUE\": \"TA0008\"\n},"
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: ba4f03de-dbe1-40e7-893a-13666a4c466b
      iscommand: false
      name: Add Lateral Movement to query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: ba4f03de-dbe1-40e7-893a-13666a4c466b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 3950
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: MITRETactics
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "{\n\t\"SEARCH_FIELD\": \"mitre_tactic_id_and_name\",\n\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\"SEARCH_VALUE\": \"TA0009\"\n},"
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: df51a7ce-c39a-41c7-8587-5bd9f0934905
      iscommand: false
      name: Add Collection to query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: df51a7ce-c39a-41c7-8587-5bd9f0934905
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 4420
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: MITRETactics
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "{\n\t\"SEARCH_FIELD\": \"mitre_tactic_id_and_name\",\n\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\"SEARCH_VALUE\": \"TA0011\"\n},"
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: f520e571-06f3-4641-8e01-1fc26375f240
      iscommand: false
      name: Add Command and Control to query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: f520e571-06f3-4641-8e01-1fc26375f240
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 4905
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: MITRETactics
      stringify:
        simple: "true"
      value:
        complex:
          root: MITRETactics
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "{\n\t\"SEARCH_FIELD\": \"mitre_tactic_id_and_name\",\n\t\"SEARCH_TYPE\":
                    \"CONTAINS\",\n\t\"SEARCH_VALUE\": \"TA0040\"\n},"
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: b0803020-8ec3-40a7-8bcb-0680b8645b60
      iscommand: false
      name: Add Impact to query
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: b0803020-8ec3-40a7-8bcb-0680b8645b60
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 5390
        }
      }
  "82":
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Hunt Impact techniques - Cortex XDR - Endpoint Investigation
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      custom_filter:
        complex:
          root: FinalQuery
      extend-context:
        simple: Impact_techniques
      time_frame:
        complex:
          root: inputs.timeRange
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Returns a list of alerts and their metadata, which you can filter
        by built-in arguments or use the custom_filter to input a JSON filter object.
        \n Multiple filter arguments will be concatenated using the AND operator,
        while arguments that support a comma-separated list of values will use an
        OR operator between each value."
      id: 99c13cc5-867e-41ca-889d-a3c1f884e005
      iscommand: true
      name: Hunt techniques
      script: '|||xdr-get-alerts'
      type: regular
      version: -1
    taskid: 99c13cc5-867e-41ca-889d-a3c1f884e005
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 5750
        }
      }
  "83":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.RunAll
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: Yes - Hunt All
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.HuntReconnaissanceTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.HuntInitialAccessTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.HuntExecutionTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.HuntPersistenceTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.HuntPrivilegeEscalationTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.HuntDefenseEvasionTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.HuntDiscoveryTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.HuntLateralMovementTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.HuntCollectionTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.HuntCnCTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.HuntImpactTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
        - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.HuntCredentialAccessTechniques
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: Yes - Specified Huntings
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "52"
      Yes - Hunt All:
      - "86"
      Yes - Specified Huntings:
      - "84"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether any hunting should be executed.
      id: 7598b80c-2e7a-4ec6-83fe-24a1d8743823
      iscommand: false
      name: Should hunting be executed?
      type: condition
      version: -1
    taskid: 7598b80c-2e7a-4ec6-83fe-24a1d8743823
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 230,
          "y": -810
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      key:
        simple: MITRETactics
      value:
        simple: "{\n\t\"AND\": [\n\t\t{\n\t\t\t\"OR\": ["
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 53fed46d-0d17-434c-8c8e-b17fd60ced15
      iscommand: false
      name: Set initial query value
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 53fed46d-0d17-434c-8c8e-b17fd60ced15
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": -590
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "82"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      key:
        simple: FinalQuery
      stringify:
        simple: "true"
      value:
        complex:
          root: inputs.EntityType
          transformers:
          - args:
              ctx_data: {}
              ctx_inc: {}
              ctx_inputs:
                iscontext: true
                value:
                  simple: inputs
              keep_symbol_to_null: {}
              prefix:
                value:
                  simple: "{\n\t\"AND\": [\n\t\t{\n\t\t\t\"OR\": [\n\t\t\t\t{\n\t\t\t\t\t\"SEARCH_FIELD\":
                    \"mitre_tactic_id_and_name\",\n\t\t\t\t\t\"SEARCH_TYPE\": \"CONTAINS\",\n\t\t\t\t\t\"SEARCH_VALUE\":
                    \"TA0043\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"SEARCH_FIELD\":
                    \"mitre_tactic_id_and_name\",\n\t\t\t\t\t\"SEARCH_TYPE\": \"CONTAINS\",\n\t\t\t\t\t\"SEARCH_VALUE\":
                    \"TA0001\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"SEARCH_FIELD\":
                    \"mitre_tactic_id_and_name\",\n\t\t\t\t\t\"SEARCH_TYPE\": \"CONTAINS\",\n\t\t\t\t\t\"SEARCH_VALUE\":
                    \"TA0002\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"SEARCH_FIELD\":
                    \"mitre_tactic_id_and_name\",\n\t\t\t\t\t\"SEARCH_TYPE\": \"CONTAINS\",\n\t\t\t\t\t\"SEARCH_VALUE\":
                    \"TA0003\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"SEARCH_FIELD\":
                    \"mitre_tactic_id_and_name\",\n\t\t\t\t\t\"SEARCH_TYPE\": \"CONTAINS\",\n\t\t\t\t\t\"SEARCH_VALUE\":
                    \"TA0004\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"SEARCH_FIELD\":
                    \"mitre_tactic_id_and_name\",\n\t\t\t\t\t\"SEARCH_TYPE\": \"CONTAINS\",\n\t\t\t\t\t\"SEARCH_VALUE\":
                    \"TA0005\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"SEARCH_FIELD\":
                    \"mitre_tactic_id_and_name\",\n\t\t\t\t\t\"SEARCH_TYPE\": \"CONTAINS\",\n\t\t\t\t\t\"SEARCH_VALUE\":
                    \"TA0006\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"SEARCH_FIELD\":
                    \"mitre_tactic_id_and_name\",\n\t\t\t\t\t\"SEARCH_TYPE\": \"CONTAINS\",\n\t\t\t\t\t\"SEARCH_VALUE\":
                    \"TA0007\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"SEARCH_FIELD\":
                    \"mitre_tactic_id_and_name\",\n\t\t\t\t\t\"SEARCH_TYPE\": \"CONTAINS\",\n\t\t\t\t\t\"SEARCH_VALUE\":
                    \"TA0009\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"SEARCH_FIELD\":
                    \"mitre_tactic_id_and_name\",\n\t\t\t\t\t\"SEARCH_TYPE\": \"CONTAINS\",\n\t\t\t\t\t\"SEARCH_VALUE\":
                    \"TA0011\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"SEARCH_FIELD\":
                    \"mitre_tactic_id_and_name\",\n\t\t\t\t\t\"SEARCH_TYPE\": \"CONTAINS\",\n\t\t\t\t\t\"SEARCH_VALUE\":
                    \"TA0040\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"SEARCH_FIELD\":
                    \""
              suffix:
                value:
                  simple: "\",\n\t\t\t\"SEARCH_TYPE\": \"CONTAINS\",\n\t\t\t\"SEARCH_VALUE\":
                    \"${inputs.entityID}\"\n\t\t}\n\t]\n}"
              variable_markers: {}
            operator: ConcatFormat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 821d6640-58ce-4c5b-887f-f23c7e9d1d79
      iscommand: false
      name: Set final query to hunt all
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 821d6640-58ce-4c5b-887f-f23c7e9d1d79
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -150,
          "y": 5580
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "24_81_yes": 0.51,
      "2_18_#default#": 0.32,
      "4_19_#default#": 0.39,
      "64_52_#default#": 0.28,
      "83_52_#default#": 0.1,
      "83_86_Yes - Hunt All": 0.12
    },
    "paper": {
      "dimensions": {
        "height": 7475,
        "width": 1690,
        "x": -490,
        "y": -1110
      }
    }
  }
