contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: e0aec54f-1202-49be-8d7e-1098f2e521d1
inputs:
- description: ""
  key: IP
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: Domain
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: URL
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: Hash
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Blacklist CSO Shared IOC v3.1_KK
outputs: []
sourceplaybookid: 0a608f75-4154-430b-81e0-3a7bc08ad2e0
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "82"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6e7be7ad-315c-4635-8ecc-b03b1c3297c8
      iscommand: false
      name: ""
      version: -1
    taskid: 6e7be7ad-315c-4635-8ecc-b03b1c3297c8
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 910,
          "y": -280
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 486bd6c0-db7a-477d-86ae-c7b3f52b0e37
      iscommand: false
      name: Report & Notify
      type: title
      version: -1
    taskid: 486bd6c0-db7a-477d-86ae-c7b3f52b0e37
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1770
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6f40d6dc-ed76-49a3-8575-a312111c3ccb
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 6f40d6dc-ed76-49a3-8575-a312111c3ccb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1940
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.IP
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "94"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ab67ae4a-432b-44aa-8d64-f294226aa5ca
      iscommand: false
      name: Is There IP Address For Blocking?
      type: condition
      version: -1
    taskid: ab67ae4a-432b-44aa-8d64-f294226aa5ca
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 70,
          "y": 500
        }
      }
  "11":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Domain
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "66"
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c2b851a9-0d92-48fb-8884-45be5a166692
      iscommand: false
      name: Is There Domains For Blocking?
      type: condition
      version: -1
    taskid: c2b851a9-0d92-48fb-8884-45be5a166692
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 910,
          "y": 500
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      reputation:
        simple: Bad
      source:
        simple: CSO
      tags:
        simple: CERTBlockDomain,emailblock
      type:
        simple: Domain
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: b2dac6d3-ff54-4978-8dd2-b83d7a31c09c
      iscommand: true
      name: Tag 'CERT' and 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - CERTDomainBlock
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: b2dac6d3-ff54-4978-8dd2-b83d7a31c09c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1310
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.URL
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "41"
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6b2a514c-e129-43d0-8779-dca067271fdb
      iscommand: false
      name: Is There URL For Blocking?
      type: condition
      version: -1
    taskid: 6b2a514c-e129-43d0-8779-dca067271fdb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1920,
          "y": 500
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    scriptarguments:
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: CERTBlockURL
      type:
        simple: URL
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: f650f8bf-29f9-4428-85a6-3b7434983918
      iscommand: true
      name: Tag 'CERT' Bad URL Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: f650f8bf-29f9-4428-85a6-3b7434983918
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2170,
          "y": 1285
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "85"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_134
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: a0be87e1-c513-405e-87bc-f4c492dce138
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: a0be87e1-c513-405e-87bc-f4c492dce138
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 680
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_134
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              chars:
                value:
                  simple: hXXp://
            operator: StripChars
          - args:
              chars:
                value:
                  simple: hXXps://
            operator: StripChars
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 557b84ef-81c8-4108-8aa4-7b061ab8c39a
      iscommand: true
      name: Blacklist CSO Shared URL on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 557b84ef-81c8-4108-8aa4-7b061ab8c39a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2170,
          "y": 695
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bcaacd06-ffe2-4f29-8cd0-ccb132dd7f19
      iscommand: false
      name: TCS-Tag New CERT Indicator v1.0_Kunal
      playbookId: ea428224-a443-408f-82ea-be094d71220d
      type: playbook
      version: -1
    taskid: bcaacd06-ffe2-4f29-8cd0-ccb132dd7f19
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1380,
          "y": 450
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Hash
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b2d3b94c-38b2-40de-8990-7d4719c2e27e
      iscommand: false
      name: Is There Hash For Blocking ?
      type: condition
      version: -1
    taskid: b2d3b94c-38b2-40de-8990-7d4719c2e27e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2700,
          "y": 500
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 5
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        complex:
          root: inputs.Hash
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bf4b8b53-eda8-4f2f-8f02-b77c65273fe2
      iscommand: false
      name: TCS-CERT Block Malicious Hash on CS v1.0_Kunal
      playbookId: cd88db09-7d3a-4efe-8dc8-d18dac3a9036
      type: playbook
      version: -1
    taskid: bf4b8b53-eda8-4f2f-8f02-b77c65273fe2
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2700,
          "y": 790
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_CSO ip list
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        complex:
          root: inputs.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: 19a1183e-cb8a-47fe-8159-48ec585e92c1
      iscommand: true
      name: Update IP address Reference set "TCS_CSO ip list"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: 19a1183e-cb8a-47fe-8159-48ec585e92c1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 1330
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_CSO_Domains
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        complex:
          root: inputs.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: d3861e0f-946c-4a01-8d7a-77cd9aceb11f
      iscommand: true
      name: Update Domain Reference set "TCS_CSO_Domains"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: d3861e0f-946c-4a01-8d7a-77cd9aceb11f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1490
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_CSO_URLs
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        simple: ${ExtractedIndicators.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: c790ec2b-1d18-4353-8acb-8afcbaf25f5f
      iscommand: true
      name: Update Domain Reference set "TCS_CSO_URLs"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: c790ec2b-1d18-4353-8acb-8afcbaf25f5f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 1490
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_CSO_Hashes
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        simple: ${inputs.Hash}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: 9c949124-9fd1-40bf-8fbd-08925ea34208
      iscommand: true
      name: Update Domain Reference set "TCS_CSO_Hashes"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: 9c949124-9fd1-40bf-8fbd-08925ea34208
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2700,
          "y": 1190
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "73"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_238
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 1759829b-58a7-4db1-8a34-da4b51516172
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 1759829b-58a7-4db1-8a34-da4b51516172
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 680
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_134
      ip:
        simple: ${Address2.IP}
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: bb31b4aa-a9ad-4d87-84db-1fb4d4bc73f7
      iscommand: true
      name: block IP on Zscaler Corporate tenant
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: bb31b4aa-a9ad-4d87-84db-1fb4d4bc73f7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1390,
          "y": 680
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_238
      ip:
        simple: ${Address2.IP}
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 6aa23eff-f055-4648-8dc4-b5129160f129
      iscommand: true
      name: Block IP from Zscaler BPS tenant
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 6aa23eff-f055-4648-8dc4-b5129160f129
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -890,
          "y": 1260
        }
      }
  "72":
    continueonerror: true
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${Address2.IP}
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 7adc4eae-5d2d-4dbe-80aa-e42551d05edd
      iscommand: true
      name: Block IP on GNDM tenant
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 7adc4eae-5d2d-4dbe-80aa-e42551d05edd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1290,
          "y": 860
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_66
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 833733f1-8d5b-4b22-8b46-16ed78bae48a
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 833733f1-8d5b-4b22-8b46-16ed78bae48a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 910
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_66
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              chars:
                value:
                  simple: hXXp://
            operator: StripChars
          - args:
              chars:
                value:
                  simple: hXXps://
            operator: StripChars
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 0173f56c-ec79-4bcd-8853-d4a53aa413d8
      iscommand: true
      name: Blacklist CSO Shared URL on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 0173f56c-ec79-4bcd-8853-d4a53aa413d8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2170,
          "y": 885
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      alert_time:
        complex:
          accessor: created
          root: incident
          transformers:
          - operator: 8726aa62-638b-41b0-8fd7-8d8892145289
          - args:
              delimiter:
                value:
                  simple: .
              fields:
                value:
                  simple: "1"
            operator: Cut
          - args:
              prefix: {}
              suffix:
                value:
                  simple: .0Z
            operator: concat
      destination_domain:
        complex:
          root: inputs.Domain
      destination_url:
        simple: http://abc.com
      device_id:
        simple: abcdefghij
      device_version:
        simple: "1.0"
      retry-count:
        simple: "3"
      using:
        simple: Cisco Umbrella Enforcement Block Domain_instance,Cisco Umbrella Enforcement
          Block Domain GNDM,Cisco Umbrella Enforcement Block Domain_TCSION
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Enforcement Block Domain
      description: Posts a malware event to the API for processing and optionally
        adding to a customer's domain lists.
      id: 0c6b8eb9-16e9-4cd9-882c-2236df434324
      iscommand: true
      name: Block Domain on Cisco Umbrella (opendns)
      script: Cisco Umbrella Enforcement Block Domain|||umbrella-domain-event-add
      type: regular
      version: -1
    taskid: 0c6b8eb9-16e9-4cd9-882c-2236df434324
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 1080
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_238
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              chars:
                value:
                  simple: hXXp://
            operator: StripChars
          - args:
              chars:
                value:
                  simple: hXXps://
            operator: StripChars
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: f8aabf0e-bba3-4b18-89cb-3d5614d5a082
      iscommand: true
      name: Blacklist CSO Shared URL on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: f8aabf0e-bba3-4b18-89cb-3d5614d5a082
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 680
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: ISO
      dateFormat:
        simple: ISO
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: ec1d726d-67ae-4056-8122-da044c299b7d
      iscommand: false
      name: Set Current Time In Context
      script: GetTime
      type: regular
      version: -1
    taskid: ec1d726d-67ae-4056-8122-da044c299b7d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -540,
          "y": 815
        }
      }
  "82":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ISOTimeNow
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "84"
      "yes":
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a71463e0-ae84-44a3-8cb3-ecc9592c4258
      iscommand: false
      name: Is ISO Time Context Set?
      type: condition
      version: -1
    taskid: a71463e0-ae84-44a3-8cb3-ecc9592c4258
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 910,
          "y": -120
        }
      }
  "83":
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "84"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ISOTimeNow
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: de729a76-efb2-4dc4-84e8-423784be29eb
      iscommand: false
      name: Delete Old Time Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: de729a76-efb2-4dc4-84e8-423784be29eb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 80
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
      - "10"
      - "11"
      - "32"
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: ISO
      dateFormat:
        simple: ISO
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: c1b07a7f-3e53-4311-8a04-75750540ddb3
      iscommand: false
      name: Set Current Date In Context
      script: GetTime
      type: regular
      version: -1
    taskid: c1b07a7f-3e53-4311-8a04-75750540ddb3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 270
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_19
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_ion
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 88cc6b64-93f0-4af3-8f79-c932db657112
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - ION
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 88cc6b64-93f0-4af3-8f79-c932db657112
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 900
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_19
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "6"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              chars:
                value:
                  simple: hXXp://
            operator: StripChars
          - args:
              chars:
                value:
                  simple: hXXps://
            operator: StripChars
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 435029ca-40fd-478a-895b-298523d39ff3
      iscommand: true
      name: Blacklist CSO Shared URL on ZScalar Proxy - ION
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 435029ca-40fd-478a-895b-298523d39ff3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 885
        }
      }
  "87":
    continueonerrortype: ""
    id: "87"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_18
      ip:
        complex:
          root: inputs.IP
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      retry-count:
        simple: "6"
      using:
        simple: Zscaler_instance_ion
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 18f8e153-9f4f-43bf-8768-4455f78e7968
      iscommand: true
      name: block IP on Zscaler Corporate ION
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 18f8e153-9f4f-43bf-8768-4455f78e7968
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -510,
          "y": 1055
        }
      }
  "90":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: sampathchandra.1@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: pk.subbaiah@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: mathews.bruno@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "91"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cf6f7494-e5e5-4049-82a4-8bf9ecbc349c
      iscommand: false
      name: Check if email from  sampathchandra.1@tcs.com
      type: condition
      version: -1
    taskid: cf6f7494-e5e5-4049-82a4-8bf9ecbc349c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1650,
          "y": 1060
        }
      }
  "91":
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    scriptarguments:
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: CERTBlockURL,DASA
      type:
        simple: URL
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: c193a6ac-846e-4214-8b29-bd3e9998db06
      iscommand: true
      name: Tag 'CERT' & DASA Bad URL Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: c193a6ac-846e-4214-8b29-bd3e9998db06
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 1285
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      reputation:
        simple: Bad
      source:
        simple: CSO
      tags:
        simple: CERTBlockDomain,emailblock,DASA
      type:
        simple: Domain
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 34d8f278-e98c-4e88-86b6-59b3b4595636
      iscommand: true
      name: Tag 'CERT' and 'emailblock'  & 'DASA' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - CERTDomainBlock
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 34d8f278-e98c-4e88-86b6-59b3b4595636
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": 1320
        }
      }
  "93":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: sampathchandra.1@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: pk.subbaiah@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: mathews.bruno@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "93"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "92"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c79b365f-7fed-4113-87c8-d1699d440e05
      iscommand: false
      name: Check if email from  sampathchandra.1@tcs.com
      type: condition
      version: -1
    taskid: c79b365f-7fed-4113-87c8-d1699d440e05
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1055
        }
      }
  "94":
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "96"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d6085899-dab9-4363-8dad-bc85aab8933b
      iscommand: false
      name: TCS-Tag New CERT Indicator v2.1_Kunal_WIP
      playbookId: dc4e0e4c-588d-496b-8e2c-dfdf024857de
      type: playbook
      version: -1
    taskid: d6085899-dab9-4363-8dad-bc85aab8933b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 70,
          "y": 775
        }
      }
  "95":
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_238
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 37d660d2-f3d4-4faa-8c0d-73517ffcf919
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 37d660d2-f3d4-4faa-8c0d-73517ffcf919
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1460,
          "y": 530
        }
      }
  "96":
    continueonerrortype: ""
    id: "96"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    scriptarguments:
      target_value:
        simple: ${inputs.IP}
      value_type:
        simple: ip
    separatecontext: false
    skipunavailable: false
    task:
      brand: Trend Micro Vision One
      description: Adds a file SHA-1, IP address, domain, or URL object to the User-Defined
        Suspicious Objects List, which blocks the objects on subsequent detections
      id: bf7839b8-dbab-4c89-8528-18dccd665870
      iscommand: true
      name: Blacklist IP on Trendmicro
      script: Trend Micro Vision One|||trendmicro-visionone-add-to-block-list
      type: regular
      version: -1
    taskid: bf7839b8-dbab-4c89-8528-18dccd665870
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 1005
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "10_3_#default#": 0.17,
      "11_38_yes": 0.38,
      "11_3_#default#": 0.12,
      "11_66_yes": 0.39,
      "32_3_#default#": 0.31,
      "32_41_yes": 0.34,
      "45_3_#default#": 0.1,
      "45_59_yes": 0.47
    },
    "paper": {
      "dimensions": {
        "height": 2285,
        "width": 4470,
        "x": -1390,
        "y": -280
      }
    }
  }
