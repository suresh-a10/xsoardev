contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: This playbook will check and close alerts for teams.exe,update.exe,adobearm.exe,squirel.exe
  which are all false positive alert created when the tools is update.
id: 1ab036e9-baeb-46d3-8d3f-fd9cbea6e6d3
inputs: []
name: TCS_DLLSideLoading_FP Cases_v1.0_KL
outputs: []
sourceplaybookid: 9bbf22a5-3e3c-429f-8400-aa946328ebfd
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 251ca44c-7f5a-462f-863f-2b79f28b6828
      iscommand: false
      name: ""
      version: -1
    taskid: 251ca44c-7f5a-462f-863f-2b79f28b6828
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 265,
          "y": 65
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5be6de6e-21a9-4cef-8cc5-ecab84b52e7b
      iscommand: false
      name: close
      type: title
      version: -1
    taskid: 5be6de6e-21a9-4cef-8cc5-ecab84b52e7b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1800
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketactic
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: defense evasion
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketechnique
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: dll side-loading
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikefilename
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: teams.exe
        - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikefilename
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: update.exe
        - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikefilename
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: adobearmhelper.exe
        - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikefilename
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: squirrel.exe
        - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikefilename
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: onedrive.exe
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: de7ceb7f-c4c8-4f19-8b45-d7a9152cc535
      iscommand: false
      name: Is the CS Trigger Logic Satisfied ?(Teams.exe)
      type: condition
      version: -1
    taskid: de7ceb7f-c4c8-4f19-8b45-d7a9152cc535
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 225
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      device_id:
        simple: ${incident.crowdstrikedeviceid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get policy details of host
      id: 63f180e6-b3e3-4bf5-876a-996d2b1f1059
      iscommand: true
      name: Fetch policy details
      script: '|||cs-get-policy-details'
      type: regular
      version: -1
    taskid: 63f180e6-b3e3-4bf5-876a-996d2b1f1059
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 750
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: create Ticket
      value:
        simple: "Yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 7e2266c8-02f3-47fd-83ab-2dea4c938543
      iscommand: false
      name: Ticket creation needed or not
      script: Set
      type: regular
      version: -1
    taskid: 7e2266c8-02f3-47fd-83ab-2dea4c938543
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1625
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AlertTime
      value:
        complex:
          accessor: occurred}
          root: ${incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: T
              fields:
                value:
                  simple: "1"
            operator: Cut
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 02690ced-c314-43a8-8a2b-65b1ea5416df
      iscommand: false
      name: Set CS Alert Time in Context
      script: Set
      type: regular
      version: -1
    taskid: 02690ced-c314-43a8-8a2b-65b1ea5416df
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 925
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: PolicyDateChanged
      value:
        complex:
          accessor: applied_date}
          root: ${PolicyDetails.[0].device_policies.sensor_update
          transformers:
          - args:
              delimiter:
                value:
                  simple: T
              fields:
                value:
                  simple: "1"
            operator: Cut
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e6e0bb75-6bbd-4e76-80cc-324372a6ed9b
      iscommand: false
      name: Set Policy date in Context
      script: Set
      type: regular
      version: -1
    taskid: e6e0bb75-6bbd-4e76-80cc-324372a6ed9b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1275
        }
      }
  "19":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${AlertTime}
          operator: isEqualString
          right:
            value:
              simple: ${PolicyDateChanged}
      label: "yes"
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 110deeeb-cd32-4586-8934-bddad3a22173
      iscommand: false
      name: Check if the date is same for policy update
      type: condition
      version: -1
    taskid: 110deeeb-cd32-4586-8934-bddad3a22173
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1450
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        simple: ${incident.crowdstrikefilehash}
      using:
        simple: Recorded Future v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a file.
      id: be8a03e2-7664-4919-8152-4df3d37e4683
      iscommand: true
      name: get filehash details
      script: Recorded Future v2|||file
      type: regular
      version: -1
    taskid: be8a03e2-7664-4919-8152-4df3d37e4683
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 400
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: RecordedFuture.File.riskScore
          operator: lessThanOrEqual
          right:
            value:
              simple: "5"
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: db0080e5-9452-4da5-86ec-1cd602671ea4
      iscommand: false
      name: Get file score
      type: condition
      version: -1
    taskid: db0080e5-9452-4da5-86ec-1cd602671ea4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 575
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${PolicyDetails.[0].device_policies.sensor_update.applied_date}
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4f4afbdd-720c-410a-8ad0-be4acf206ac9
      iscommand: false
      name: Checks the value presence in context data
      type: condition
      version: -1
    taskid: 4f4afbdd-720c-410a-8ad0-be4acf206ac9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1100
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: PolicyDateChanged
      value:
        complex:
          accessor: assigned_date}
          root: ${PolicyDetails.[0].device_policies.sensor_update
          transformers:
          - args:
              delimiter:
                value:
                  simple: T
              fields:
                value:
                  simple: "1"
            operator: Cut
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6f46dc73-2914-467d-810f-c47b4d9d35cd
      iscommand: false
      name: Set Policy date in Context
      script: Set
      type: regular
      version: -1
    taskid: 6f46dc73-2914-467d-810f-c47b4d9d35cd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1275
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "12_8_#default#": 0.18
    },
    "paper": {
      "dimensions": {
        "height": 1800,
        "width": 810,
        "x": 50,
        "y": 65
      }
    }
  }
