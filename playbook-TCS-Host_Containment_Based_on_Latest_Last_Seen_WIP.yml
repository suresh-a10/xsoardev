contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: c984a9f2-2610-403e-89dc-8fd42f056aa3
inputs:
- description: ""
  key: host
  playbookInputQuery: null
  required: false
  value:
    simple: ${TCSHostnameArray}
name: TCS-Host Containment Based on Latest Last Seen_WIP
outputs: []
sourceplaybookid: 2fcc0312-3a92-4098-8e05-60568462eb35
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8934d121-b357-48f1-8dc3-8f664648a780
      iscommand: false
      name: ""
      version: -1
    taskid: 8934d121-b357-48f1-8dc3-8f664648a780
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 400,
          "y": 60
        }
      }
  "12":
    continueonerror: true
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.LastSeen
              operator: isEqualString
              right:
                iscontext: true
                value:
                  simple: ${LastSeenArraySorted.[0]}
          root: CrowdStrike.Device
      using:
        simple: CrowdstrikeFalcon_Host Contain
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Contains containment for a specified host. When contained, a host
        can only communicate with the CrowdStrike cloud and any IPs specified in your
        containment policy.
      id: 17b3f0bb-37b1-4602-8155-322ac1559d55
      iscommand: true
      name: Contain Host with Latest Last Seen Entry
      script: CrowdstrikeFalcon|||cs-falcon-contain-host
      type: regular
      version: -1
    taskid: 17b3f0bb-37b1-4602-8155-322ac1559d55
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1510
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7dbb7cb1-6d5a-4099-884e-37a7b3b85099
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: 7dbb7cb1-6d5a-4099-884e-37a7b3b85099
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 400,
          "y": 2240
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: CrowdStrike
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "27"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 26279d62-2bd7-4c1d-861a-ba3716b2ff2d
      iscommand: false
      name: Is CrowdStrike custom Key defined
      type: condition
      version: -1
    taskid: 26279d62-2bd7-4c1d-861a-ba3716b2ff2d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 200
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: CrowdStrike
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 9ab5abca-0867-4952-815a-28855ab1743d
      iscommand: false
      name: Delete CS Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 9ab5abca-0867-4952-815a-28855ab1743d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 370
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          root: inputs.host
      using:
        simple: CrowdstrikeFalcon_Host Contain
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: 5a52d323-70c1-4c7a-80fe-8235f0be69fe
      iscommand: true
      name: Search Host On CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: 5a52d323-70c1-4c7a-80fe-8235f0be69fe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 560
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: CrowdStrike
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Hostname
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3a10fd11-e9c1-41a6-8548-1502d1834004
      iscommand: false
      name: Is Host Found on CrowdStrike?
      type: condition
      version: -1
    taskid: 3a10fd11-e9c1-41a6-8548-1502d1834004
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 725
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: LastSeenArraySorted
      value:
        complex:
          root: ${CrowdStrike.Device.LastSeen}
          transformers:
          - args:
              descending:
                value:
                  simple: "true"
            operator: sort
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 201ac527-a47e-4088-83d4-f23b42281b16
      iscommand: false
      name: Create sorted array for last seen
      script: Set
      type: regular
      version: -1
    taskid: 201ac527-a47e-4088-83d4-f23b42281b16
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1320
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      relateToIncident:
        simple: "true"
      tags:
        simple: hostcontaincompliance
      type:
        simple: Host
      value:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 8df680ad-b363-4574-8370-19f573d14569
      iscommand: true
      name: Create Host Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 8df680ad-b363-4574-8370-19f573d14569
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1690
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostContainedReport
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.LastSeen
              operator: isEqualString
              right:
                value:
                  simple: ${LastSeenArraySorted.[0]}
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: c7527ca2-a34e-45c0-8bf2-58cdf14ac5e1
      iscommand: false
      name: Create array for contained hosts report
      script: Set
      type: regular
      version: -1
    taskid: c7527ca2-a34e-45c0-8bf2-58cdf14ac5e1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1860
        }
      }
  "40":
    continueonerror: true
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          root: CrowdStrike.Device
      using:
        simple: CrowdstrikeFalcon_Host Contain
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Contains containment for a specified host. When contained, a host
        can only communicate with the CrowdStrike cloud and any IPs specified in your
        containment policy.
      id: bc0dbf16-970b-4935-8149-3ee61261c125
      iscommand: true
      name: 'Contain Host '
      script: CrowdstrikeFalcon|||cs-falcon-contain-host
      type: regular
      version: -1
    taskid: bc0dbf16-970b-4935-8149-3ee61261c125
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": 1310
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostContainedReport
      value:
        complex:
          accessor: Device
          root: CrowdStrike
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 794b2f65-5d13-4ce9-81dd-79f3807c6e0e
      iscommand: false
      name: Create array for contained hosts report
      script: Set
      type: regular
      version: -1
    taskid: 794b2f65-5d13-4ce9-81dd-79f3807c6e0e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": 1880
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: LastSeenArraySorted
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: d9956de1-0f17-4832-8e22-fb10b0ce759f
      iscommand: false
      name: Delete Context Key LastSeenArraySorted
      script: DeleteContext
      type: regular
      version: -1
    taskid: d9956de1-0f17-4832-8e22-fb10b0ce759f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 2040
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostNotFound
      value:
        complex:
          root: inputs.host
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: b751f42f-4726-4e2e-84f3-2c4ee10eb48e
      iscommand: false
      name: Create array for hosts not found report
      script: Set
      type: regular
      version: -1
    taskid: b751f42f-4726-4e2e-84f3-2c4ee10eb48e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1905
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${CrowdStrike.Device.ID}
          operator: hasLength
          right:
            value:
              simple: "1"
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "32"
      "yes":
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 0f5031eb-26c3-47bf-8b8f-f504748bc3e8
      iscommand: false
      name: Is the Count of CS Host ID 1?
      type: condition
      version: -1
    taskid: 0f5031eb-26c3-47bf-8b8f-f504748bc3e8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 980
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      relateToIncident:
        simple: "true"
      tags:
        simple: hostcontaincompliance
      type:
        simple: Host
      value:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 24018760-d301-403f-883f-b18e4ab9a433
      iscommand: true
      name: Create Host Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 24018760-d301-403f-883f-b18e4ab9a433
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": 1620
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2245,
        "width": 1380,
        "x": -70,
        "y": 60
      }
    }
  }
