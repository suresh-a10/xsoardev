contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: f777c749-f237-480d-88e0-94948572e0ad
inputs:
- description: ""
  key: host
  playbookInputQuery: null
  required: false
  value:
    simple: ${TCSHostnameArray}
name: TCS-Compliance Lift Host Containment Check v1.0_JP
outputs: []
sourceplaybookid: 2fcc0312-3a92-4098-8e05-60568462eb35
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 47ea9764-b4a8-4457-8699-a099cd6bd87e
      iscommand: false
      name: ""
      version: -1
    taskid: 47ea9764-b4a8-4457-8699-a099cd6bd87e
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 400,
          "y": 60
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.LastSeen
              operator: isEqualString
              right:
                iscontext: true
                value:
                  simple: ${LastSeenArraySorted.[0]}
          root: CrowdStrike.Device
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Lifts containment on the host, which returns its network communications
        to normal.
      id: faab02b3-81f7-42c0-8c7c-eb2ea600c5bc
      iscommand: true
      name: Lift Host Contain with Latest Last Seen Entry
      script: CrowdstrikeFalcon|||cs-falcon-lift-host-containment
      type: regular
      version: -1
    taskid: faab02b3-81f7-42c0-8c7c-eb2ea600c5bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1810
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3c0d16e7-76af-4c83-88eb-ba81d14a95c7
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: 3c0d16e7-76af-4c83-88eb-ba81d14a95c7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 400,
          "y": 2600
        }
      }
  "26":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: CrowdStrike
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "27"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3a3d7a95-552f-49c4-8ba1-660945cf6316
      iscommand: false
      name: Is CrowdStrike custom Key defined
      type: condition
      version: -1
    taskid: 3a3d7a95-552f-49c4-8ba1-660945cf6316
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 190
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: CrowdStrike
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 7c4748dd-92bc-4e45-89b0-d799851e320d
      iscommand: false
      name: Delete CS Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 7c4748dd-92bc-4e45-89b0-d799851e320d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 370
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          root: inputs.host
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: dd73e527-63c0-4cb8-8e8f-ba47c4482a59
      iscommand: true
      name: Search Host On CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: dd73e527-63c0-4cb8-8e8f-ba47c4482a59
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 530
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: CrowdStrike
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Hostname
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "54"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ad060859-fe1c-4c54-85c5-3a69b0e3c51b
      iscommand: false
      name: Is Host Found on CrowdStrike?
      type: condition
      version: -1
    taskid: ad060859-fe1c-4c54-85c5-3a69b0e3c51b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 695
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: LastSeenArraySorted
      value:
        complex:
          root: ${CrowdStrike.Device.LastSeen}
          transformers:
          - args:
              descending:
                value:
                  simple: "true"
            operator: sort
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f11a0e24-a7d4-4613-8855-75ecf58d545e
      iscommand: false
      name: Create sorted array for last seen
      script: Set
      type: regular
      version: -1
    taskid: f11a0e24-a7d4-4613-8855-75ecf58d545e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1620
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        complex:
          accessor: ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.LastSeen
              operator: isEqualString
              right:
                value:
                  simple: ${LastSeenArraySorted.[0]}
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: b75e74b8-2940-40bb-8fc4-6ed67029f875
      iscommand: false
      name: Print Host ID for Latest Last Seen Device
      script: Print
      type: regular
      version: -1
    taskid: b75e74b8-2940-40bb-8fc4-6ed67029f875
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2290,
          "y": 1080
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: LastSeenArraySorted
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: ef5fc3d3-6e29-460f-86a9-16ad2f35b045
      iscommand: false
      name: Delete Context Key LastSeenArraySorted(To be deleted)
      script: DeleteContext
      type: regular
      version: -1
    taskid: ef5fc3d3-6e29-460f-86a9-16ad2f35b045
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2290,
          "y": 1270
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      value:
        complex:
          accessor: ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.LastSeen
              operator: isEqualString
              right:
                value:
                  simple: ${LastSeenArraySorted.[0]}
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: 59b672de-a7e1-4e48-8568-d455be1c2a54
      iscommand: false
      name: Print Host ID for Latest Last Seen Device
      script: Print
      type: regular
      version: -1
    taskid: 59b672de-a7e1-4e48-8568-d455be1c2a54
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2310,
          "y": 950
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostLiftedContainReport
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.LastSeen
              operator: isEqualString
              right:
                value:
                  simple: ${LastSeenArraySorted.[0]}
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 80980a1a-b99b-4977-8c3c-86dc1d570e87
      iscommand: false
      name: Create array for HostLiftedContain Report
      script: Set
      type: regular
      version: -1
    taskid: 80980a1a-b99b-4977-8c3c-86dc1d570e87
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 2180
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          root: CrowdStrike.Device
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Lifts containment on the host, which returns its network communications
        to normal.
      id: 8e965f77-c26d-4a68-85b2-0c153a7ced81
      iscommand: true
      name: Lift Host Contain
      script: CrowdstrikeFalcon|||cs-falcon-lift-host-containment
      type: regular
      version: -1
    taskid: 8e965f77-c26d-4a68-85b2-0c153a7ced81
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": 1870
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostLiftedContainReport
      value:
        complex:
          accessor: Device
          root: CrowdStrike
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: d9bef2c1-003e-412c-8777-6425716328ea
      iscommand: false
      name: 'Create array for HostLiftedContain Report '
      script: Set
      type: regular
      version: -1
    taskid: d9bef2c1-003e-412c-8777-6425716328ea
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": 2370
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: LastSeenArraySorted
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 633b5b9d-5ae2-4a1d-8bc0-de8e2703cce9
      iscommand: false
      name: Delete Context Key LastSeenArraySorted
      script: DeleteContext
      type: regular
      version: -1
    taskid: 633b5b9d-5ae2-4a1d-8bc0-de8e2703cce9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 2350
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostNotFound
      value:
        complex:
          root: inputs.host
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 5e4e20c6-80f5-496e-80ae-6f345bf9b97f
      iscommand: false
      name: Create array for hosts not found report
      script: Set
      type: regular
      version: -1
    taskid: 5e4e20c6-80f5-496e-80ae-6f345bf9b97f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1720,
          "y": 1715
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${CrowdStrike.Device.ID}
          operator: hasLength
          right:
            value:
              simple: "1"
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "32"
      "yes":
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 67db678a-8ddd-45f5-8907-82d291dffb7a
      iscommand: false
      name: Is the Count of CS Host ID 1?
      type: condition
      version: -1
    taskid: 67db678a-8ddd-45f5-8907-82d291dffb7a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1445
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      relateToIncident:
        simple: "true"
      tags:
        simple: hostcontaincompliance
      type:
        simple: Host
      value:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: d7352fcd-6d4b-4eba-82e7-7cc08c02a3e1
      iscommand: true
      name: Create Host Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: d7352fcd-6d4b-4eba-82e7-7cc08c02a3e1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -990,
          "y": 2110
        }
      }
  "46":
    continueonerror: true
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          root: CrowdStrike.Device
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Contains containment for a specified host. When contained, a host
        can only communicate with the CrowdStrike cloud and any IPs specified in your
        containment policy.
      id: 4f3bc62c-a67b-4536-83e3-826bb239aa22
      iscommand: true
      name: 'Contain Host '
      script: '|||cs-falcon-contain-host'
      type: regular
      version: -1
    taskid: 4f3bc62c-a67b-4536-83e3-826bb239aa22
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 1080
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      add_fields_to_context:
        simple: occurred,crowdstrikehostname
      query:
        simple: crowdstrikehostname:${inputs.host} and status:Active
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Searches Cortex XSOAR Incidents and returnrs the most relevant
        fields. Default search range is the last 30 days, if you want to change this,
        use the fromDate argument. \n\nReturns the id, name, type, severity, status,
        owner, and created/closed times to context.  You can add additional fields
        using the add_field_to_context argument.\n\nThis automation runs using the
        default Limited User role, unless you explicitly change the permissions.  Based
        on the SearchIncidentsV2 from the Common Scripts pack, but more efficient."
      id: 9cff72c3-f50f-4bb9-82c2-d16d0289993c
      iscommand: false
      name: Get Report of Any Active Incidents for the Host
      script: SearchIncidentsSummary
      type: regular
      version: -1
    taskid: 9cff72c3-f50f-4bb9-82c2-d16d0289993c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1090
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${foundIncidents}
      fileName:
        simple: CitiIncidentDetails.csv
      headers:
        simple: id,name,type,severity,status,occurred,crowdstrikehostname,investigationconclusion,investigationanalysis,imtraised,imtnumber,closed
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 6f587ca2-b186-46d2-827a-fabe990a7a02
      iscommand: false
      name: Export Required Fields To CSV
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 6f587ca2-b186-46d2-827a-fabe990a7a02
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": 380
        }
      }
  "49":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: foundIncidents
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: foundIncidents
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "44"
      "yes":
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 23b6df45-d6f5-4ba6-883e-ff2bdcd43550
      iscommand: false
      name: Are any Active incidents for the host found?
      type: condition
      version: -1
    taskid: 23b6df45-d6f5-4ba6-883e-ff2bdcd43550
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1255
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5f404714-1b9b-49fd-8f72-879083204430
      iscommand: false
      name: active found
      type: regular
      version: -1
    taskid: 5f404714-1b9b-49fd-8f72-879083204430
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1900,
          "y": 950
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostNotLiftedDetectionFoundReport
      value:
        complex:
          root: inputs.host
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: f923bb34-83aa-4bad-8049-0f0cbaac47b1
      iscommand: false
      name: Create array for Hosts Not Lifted Due to Detection Found
      script: Set
      type: regular
      version: -1
    taskid: f923bb34-83aa-4bad-8049-0f0cbaac47b1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": 1895
        }
      }
  "53":
    continueonerror: true
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.LastSeen
              operator: isEqualString
              right:
                iscontext: true
                value:
                  simple: ${LastSeenArraySorted.[0]}
          root: CrowdStrike.Device
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Contains containment for a specified host. When contained, a host
        can only communicate with the CrowdStrike cloud and any IPs specified in your
        containment policy.
      id: 586d36ae-7509-4e01-857f-8672d6d23325
      iscommand: true
      name: Contain Host with Latest Last Seen Entry
      script: '|||cs-falcon-contain-host'
      type: regular
      version: -1
    taskid: 586d36ae-7509-4e01-857f-8672d6d23325
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1840,
          "y": 1270
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Status
                root: CrowdStrike.Device
          operator: isEqualString
          right:
            value:
              simple: contained
      label: "yes"
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: af979f85-a6ca-4848-8a78-fee255fec8ba
      iscommand: false
      name: Is Host Found in Contained State?
      type: condition
      version: -1
    taskid: af979f85-a6ca-4848-8a78-fee255fec8ba
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 910
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          accessor: ID
          root: CrowdStrike.Device
      relateToIncident:
        simple: "true"
      tags:
        simple: hostliftcontaincompliance
      type:
        simple: Host
      value:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 465ef52f-d9e2-4d4b-82f4-5f20eb81c2f9
      iscommand: true
      name: Create New Host Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 465ef52f-d9e2-4d4b-82f4-5f20eb81c2f9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": 2100
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostStatusWasNotContainedReport
      value:
        complex:
          accessor: Device
          root: CrowdStrike
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 375a38e2-abc7-446d-894f-342406536241
      iscommand: false
      name: Create array for hosts is not in contained state report
      script: Set
      type: regular
      version: -1
    taskid: 375a38e2-abc7-446d-894f-342406536241
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 1715
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: foundIncidents
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: e081507c-fea9-416a-8c77-88f6eaddb7ec
      iscommand: false
      name: Delete Context Key foundIncidents
      script: DeleteContext
      type: regular
      version: -1
    taskid: e081507c-fea9-416a-8c77-88f6eaddb7ec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": 2350
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          accessor: ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CrowdStrike.Device.LastSeen
              operator: isEqualString
              right:
                value:
                  simple: ${LastSeenArraySorted.[0]}
          root: CrowdStrike.Device
      relateToIncident:
        simple: "true"
      tags:
        simple: hostliftcontaincompliance
      type:
        simple: Host
      value:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: aa45f339-5143-4713-8a36-c6871195d1e4
      iscommand: true
      name: Create New Host Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: aa45f339-5143-4713-8a36-c6871195d1e4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1990
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "26_27_yes": 0.35,
      "29_54_yes": 0.49,
      "44_32_#default#": 0.53,
      "49_44_#default#": 0.51,
      "49_52_yes": 0.35,
      "54_47_yes": 0.5
    },
    "paper": {
      "dimensions": {
        "height": 2605,
        "width": 3680,
        "x": -990,
        "y": 60
      }
    }
  }
