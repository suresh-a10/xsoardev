contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 6c33ba28-5f9e-42c0-889b-5346ae5899e2
inputs: []
name: TCS-Grant Temporary Domain Admin Rights v1.0
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d570a60d-cc4f-4a13-83db-b7c6376793fe
      iscommand: false
      name: ""
      version: -1
    taskid: d570a60d-cc4f-4a13-83db-b7c6376793fe
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": -20
        }
      }
  "2":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Do You Want To Approve This Request ?
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: Your SOC team
      title: Temporary Admin Rights Approval Request
      totalanswers: 0
    formDisplay:
      bodybackgroundcolor: ""
      bodyfontcolor: ""
      headerbackgroundcolor: '#ffffff'
      headerfontcolor: '#2a4aa8'
      isexternalrtl: false
      sender: Cybersecurity Automation Service
      submitbuttonbackgroundcolor: ""
      submitbuttonfontcolor: ""
      submittext: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Please click on the link below to Approve or Deny this request
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: 'Temporary Admin Rights Request From ${incident.teamname} (${incident.empid})
          For ${incident.domain} Domain '
      timings:
        completeafterreplies: 1
        completeaftersla: true
        completeafterv2: true
        retriescount: 1
        retriesinterval: 30
      to:
        simple: naeem.n@tcs.com,jayprakash.tungare@tcs.com,komal.lugade@tcs.com,santosh.sodaye@tcs.com
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    sla:
      days: 0
      hours: 1
      minutes: 0
      weeks: 0
    slareminder:
      days: 0
      hours: 1
      minutes: 0
      weeks: 0
    task:
      brand: ""
      id: d82a1882-12bb-425b-814f-9226dba375b6
      iscommand: false
      name: Send Email To Approver
      type: collection
      version: -1
    taskid: d82a1882-12bb-425b-814f-9226dba375b6
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 450,
          "y": 430
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Temporary Admin Rights Approval Request.Answers
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e3263a1c-0d50-432c-89d1-38788126bdde
      iscommand: false
      name: Admin Rights Request Approved ?
      type: condition
      version: -1
    taskid: e3263a1c-0d50-432c-89d1-38788126bdde
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 650
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello ${incident.firstname},

          Your temporary Admin Rights request for ${incident.domain} domain has been approved.

          Regards,
          CyberAutoBot
          Service Request id: ${incident.investigationId}
      cc:
        simple: Naeem.n@tcs.com,Jayprakash.tungare@tcs.com,Santosh.sodaye@tcs.com
      subject:
        simple: Your Temporary Admin Rights Request  For ${incident.domain} Domain
          Has been Approved
      to:
        simple: ${incident.labels.Email/from}
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 997eefd5-4e1e-45c9-8e3e-57e951676edb
      iscommand: true
      name: Notify Requestor - Request Approved
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 997eefd5-4e1e-45c9-8e3e-57e951676edb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 1530
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello User,

          Your temporary Admin Rights request has NOT been approved.

          Regards,
          CyberAutoBot
          Service Request id: ${incident.investigationId}
      cc:
        simple: Naeem.n@tcs.com,Jayprakash.tungare@tcs.com,Santosh.sodaye@tcs.com
      subject:
        simple: Your Temporary Admin Rights Request Has NOT been Approved
      to:
        simple: ${incident.labels.Email/from}
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 0e8f5327-519d-4e92-80f7-b6e0433aefb9
      iscommand: true
      name: Notify Requestor - Request Not Approved
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 0e8f5327-519d-4e92-80f7-b6e0433aefb9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 850,
          "y": 1530
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: domain
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: india
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4cf6c39d-f438-4a97-83f8-ac471c50c708
      iscommand: false
      name: Is Request For INDIA Domain ?
      type: condition
      version: -1
    taskid: 4cf6c39d-f438-4a97-83f8-ac471c50c708
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 870
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: domain
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: apac
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "20"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4a201c75-a921-4cbb-874f-3deffcf33c41
      iscommand: false
      name: Is Request For APAC Domain ?
      type: condition
      version: -1
    taskid: 4a201c75-a921-4cbb-874f-3deffcf33c41
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -380,
          "y": 870
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: f70de120-6ce1-43fe-8f0d-f9afd9e3761f
      iscommand: true
      name: Close Service Request
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: f70de120-6ce1-43fe-8f0d-f9afd9e3761f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 1780
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f221591a-cabb-4702-853d-1cd05547ffe7
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: f221591a-cabb-4702-853d-1cd05547ffe7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 430,
          "y": 1955
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: "Hello User,\n\nThe automation service for ${incident.domain} domain
          has not been authorized. Please report this to your supervisor.\n \nRegards,\nCyberAutoBot\nService
          Request id: ${incident.investigationId}"
      subject:
        simple: Domain Not Found - Automation Service For ${incident.domain} Domain
          Has Not Been Authorized
      to:
        simple: ${incident.labels.Email/from}
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 2ed24dd0-c3cd-4c7d-8948-4f99e1b55679
      iscommand: true
      name: Notify Requestor - Domain Not Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 2ed24dd0-c3cd-4c7d-8948-4f99e1b55679
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2920,
          "y": 1310
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: TempAdminRightsIndia
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 7e78f4cb-665d-4e57-8269-d105a3491dae
      iscommand: true
      name: Add Employee To Indicator With Expiry Date/Time - India
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 7e78f4cb-665d-4e57-8269-d105a3491dae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -650,
          "y": 1970
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: TempAdminRightsAPAC
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 3c91ceff-9e0d-4852-8ad7-2b09fdd79de7
      iscommand: true
      name: Add Employee To Indicator With Expiry Date/Time - APAC
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 3c91ceff-9e0d-4852-8ad7-2b09fdd79de7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -190,
          "y": 1970
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: domain
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: noam
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0ce42e07-0178-486d-865d-b9628b96f47e
      iscommand: false
      name: Is Request For NOAM Domain ?
      type: condition
      version: -1
    taskid: 0ce42e07-0178-486d-865d-b9628b96f47e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -800,
          "y": 870
        }
      }
  "21":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: domain
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: soam
      label: "yes"
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 27016ee0-250d-403b-89c3-1e600a6c32a0
      iscommand: false
      name: Is Request For SOAM Domain ?
      type: condition
      version: -1
    taskid: 27016ee0-250d-403b-89c3-1e600a6c32a0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1220,
          "y": 870
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: domain
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: emea
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d31418f8-5b4b-4a49-8290-fd6d0093e4c5
      iscommand: false
      name: Is Request For EMEA Domain ?
      type: condition
      version: -1
    taskid: d31418f8-5b4b-4a49-8290-fd6d0093e4c5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1640,
          "y": 870
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: domain
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: globe
      label: "yes"
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      "yes":
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bd3ad337-e5dc-44d6-89b8-913f15d172b0
      iscommand: false
      name: Is Request For Globe Domain ?
      type: condition
      version: -1
    taskid: bd3ad337-e5dc-44d6-89b8-913f15d172b0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2060,
          "y": 870
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      group-cn:
        simple: Domain Admins
      username:
        complex:
          accessor: empid
          root: incident
      using:
        simple: Active Directory Query v2_NOAMVSDC9,Active Directory Query v2_NOAMVSDC10
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Adds an Active Directory user or computer to a group.
      id: c62e9c5e-ae51-4674-80de-9ec41c8f5bb5
      iscommand: true
      name: 'Add User In NOAM Admin Grp '
      script: Active Directory Query v2|||ad-add-to-group
      type: regular
      version: -1
    taskid: c62e9c5e-ae51-4674-80de-9ec41c8f5bb5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -800,
          "y": 1050
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      group-cn:
        simple: Domain Admins
      username:
        complex:
          accessor: empid
          root: incident
      using:
        simple: Active Directory Query v2_SOAMVSDC13,Active Directory Query v2_SOAMVSDC14
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Adds an Active Directory user or computer to a group.
      id: 9a59e39d-2e7a-4792-888b-a562bb6b4d6a
      iscommand: true
      name: 'Add User In SOAM Admin Grp '
      script: Active Directory Query v2|||ad-add-to-group
      type: regular
      version: -1
    taskid: 9a59e39d-2e7a-4792-888b-a562bb6b4d6a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1220,
          "y": 1060
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      group-cn:
        simple: Domain Admins
      username:
        complex:
          accessor: empid
          root: incident
      using:
        simple: Active Directory Query v2_EMEAVSDC11,Active Directory Query v2_EMEAVSDC10
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Adds an Active Directory user or computer to a group.
      id: e4ee22a5-0c79-4ad3-8fd7-1afa568b1299
      iscommand: true
      name: 'Add User In EMEA Admin Grp '
      script: Active Directory Query v2|||ad-add-to-group
      type: regular
      version: -1
    taskid: e4ee22a5-0c79-4ad3-8fd7-1afa568b1299
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1640,
          "y": 1060
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      group-cn:
        simple: Domain Admins
      username:
        complex:
          accessor: empid
          root: incident
      using:
        simple: Active Directory Query v2_MUMTDCDC11,Active Directory Query v2_MUMTDCDC10
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Adds an Active Directory user or computer to a group.
      id: a6693e46-a39c-4605-8458-6ced35bf8d43
      iscommand: true
      name: 'Add User In Globe Admin Grp '
      script: Active Directory Query v2|||ad-add-to-group
      type: regular
      version: -1
    taskid: a6693e46-a39c-4605-8458-6ced35bf8d43
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2060,
          "y": 1060
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      group-cn:
        simple: Domain Admins
      username:
        complex:
          accessor: empid
          root: incident
      using:
        simple: Active Directory Query v2_APACVSDC5,Active Directory Query v2_APACVSDC4
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Adds an Active Directory user or computer to a group.
      id: d106259a-13a7-42d1-8476-8188f4795625
      iscommand: true
      name: 'Add User In APAC Admin Grp '
      script: Active Directory Query v2|||ad-add-to-group
      type: regular
      version: -1
    taskid: d106259a-13a7-42d1-8476-8188f4795625
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -380,
          "y": 1060
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 0
    scriptarguments:
      group-cn:
        simple: Domain Admins
      username:
        complex:
          accessor: empid
          root: incident
      using:
        simple: Active Directory Query v2_INMUMTDCDC20,Active Directory Query v2_INMUMTDCDC13
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Adds an Active Directory user or computer to a group.
      id: 19d97640-bcdc-479a-8a60-eaab7c246f90
      iscommand: true
      name: 'Add User In INDIA Admin Grp '
      script: Active Directory Query v2|||ad-add-to-group
      type: regular
      version: -1
    taskid: 19d97640-bcdc-479a-8a60-eaab7c246f90
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1060
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: TempAdminRightsNOAM
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: a7047b89-ae70-446d-82c1-2adb9c938cc2
      iscommand: true
      name: Add Employee To Indicator With Expiry Date/Time - NOAM
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: a7047b89-ae70-446d-82c1-2adb9c938cc2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1080,
          "y": 1955
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: TempAdminRightsSOAM
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: d452cedb-469f-4797-8d6d-a9b939610d69
      iscommand: true
      name: Add Employee To Indicator With Expiry Date/Time - SOAM
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: d452cedb-469f-4797-8d6d-a9b939610d69
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1430,
          "y": 2010
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: TempAdminRightsEMEA
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 682d44f8-9a5d-43a1-8613-5d6072e6b5aa
      iscommand: true
      name: Add Employee To Indicator With Expiry Date/Time - EMEA
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 682d44f8-9a5d-43a1-8613-5d6072e6b5aa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1690,
          "y": 1930
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: TempAdminRightsGlobe
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 2f6dd6ab-7a23-4d9e-8be3-d83232c5d085
      iscommand: true
      name: Add Employee To Indicator With Expiry Date/Time - Globe
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 2f6dd6ab-7a23-4d9e-8be3-d83232c5d085
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2080,
          "y": 1940
        }
      }
  "39":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: domain
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: tcs
      label: "yes"
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e2f389ad-66ea-42c3-80bc-9a16f3d3cc53
      iscommand: false
      name: Is Request For TCS Domain ?
      type: condition
      version: -1
    taskid: e2f389ad-66ea-42c3-80bc-9a16f3d3cc53
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2480,
          "y": 870
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    scriptarguments:
      group-cn:
        simple: Domain Admins
      username:
        complex:
          accessor: empid
          root: incident
      using:
        simple: Active Directory Query v2_ROOTDC17,Active Directory Query v2_ROOTDC19
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Adds an Active Directory user or computer to a group.
      id: 4fd67e9a-5d3d-4b66-8fe8-1aaefd1514a4
      iscommand: true
      name: 'Add User In TCS Admin Grp '
      script: Active Directory Query v2|||ad-add-to-group
      type: regular
      version: -1
    taskid: 4fd67e9a-5d3d-4b66-8fe8-1aaefd1514a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2480,
          "y": 1060
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: TempAdminRightsTCS
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: b697c940-2ca1-4926-889d-918b77c281f0
      iscommand: true
      name: Add Employee To Indicator With Expiry Date/Time - TCS
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: b697c940-2ca1-4926-889d-918b77c281f0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2510,
          "y": 1950
        }
      }
  "43":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: inList
          right:
            value:
              simple: ${lists.TempAdminAuthorizedUsers}
      label: "yes"
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "44"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e72bf5d5-312b-45bd-8d1f-82e938ffa6bc
      iscommand: false
      name: Is Email From Authorized Sender ?
      type: condition
      version: -1
    taskid: e72bf5d5-312b-45bd-8d1f-82e938ffa6bc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 150
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: "Hello JP/Naeem\n\nUnauthorized Requestor  ${incident.teamname} (${incident.empid})
          Requesting Admin Rights For ${incident.domain} Domain \n\nRegards,\nCyberAutoBot\nService
          Request id: ${incident.investigationId}"
      subject:
        simple: 'Unauthorized Requestor  ${incident.teamname} (${incident.empid})
          Requesting Admin Rights For ${incident.domain} Domain '
      to:
        simple: Naeem.n@tcs.com,Jayprakash.tungare@tcs.com,Santosh.sodaye@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: b6975ccc-0381-470b-8330-ca9521cce39a
      iscommand: true
      name: Notify Approvers - Request From Un-Authorized User
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: b6975ccc-0381-470b-8330-ca9521cce39a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1250,
          "y": 1530
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: TempAdminRightsTCS
      tags:
        simple: TempAdminRightsTCS
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      id: b2a99640-c22a-4ef1-83a8-af7c0d6b9eae
      iscommand: false
      name: Add Employee To Indicator With Expiry Date/Time - Globe
      script: 88adcc81-d279-4bd8-8bea-b7773d15d418
      type: regular
      version: -1
    taskid: b2a99640-c22a-4ef1-83a8-af7c0d6b9eae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2480,
          "y": 1290
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: TempAdminRightsGlobe
      tags:
        simple: TempAdminRightsGlobe
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      id: caffe847-f7dc-4181-8c21-87f71b6595d0
      iscommand: false
      name: Add Employee To Indicator With Expiry Date/Time - Globe
      script: 88adcc81-d279-4bd8-8bea-b7773d15d418
      type: regular
      version: -1
    taskid: caffe847-f7dc-4181-8c21-87f71b6595d0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2060,
          "y": 1300
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: TempAdminRightsEMEA
      tags:
        simple: TempAdminRightsEMEA
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      id: 5a11669d-8414-447a-80e2-e4a52a964956
      iscommand: false
      name: Add Employee To Indicator With Expiry Date/Time - EMEA
      script: 88adcc81-d279-4bd8-8bea-b7773d15d418
      type: regular
      version: -1
    taskid: 5a11669d-8414-447a-80e2-e4a52a964956
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1640,
          "y": 1290
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: TempAdminRightsSOAM
      tags:
        simple: TempAdminRightsSOAM
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      id: c8a96cbb-e7e8-4291-8199-c37725b4ed83
      iscommand: false
      name: Add Employee To Indicator With Expiry Date/Time - SOAM
      script: 88adcc81-d279-4bd8-8bea-b7773d15d418
      type: regular
      version: -1
    taskid: c8a96cbb-e7e8-4291-8199-c37725b4ed83
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1220,
          "y": 1300
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: TempAdminRightsNOAM
      tags:
        simple: TempAdminRightsNOAM
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      id: 09a68a91-311a-470a-8af7-2d8cc1e692a5
      iscommand: false
      name: Add Employee To Indicator With Expiry Date/Time - NOAM
      script: 88adcc81-d279-4bd8-8bea-b7773d15d418
      type: regular
      version: -1
    taskid: 09a68a91-311a-470a-8af7-2d8cc1e692a5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -800,
          "y": 1300
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: TempAdminRightsAPAC
      tags:
        simple: TempAdminRightsAPAC
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      id: 0d97da24-d25e-41a2-85b4-e6187a0ced75
      iscommand: false
      name: Add Employee To Indicator With Expiry Date/Time - APAC
      script: 88adcc81-d279-4bd8-8bea-b7773d15d418
      type: regular
      version: -1
    taskid: 0d97da24-d25e-41a2-85b4-e6187a0ced75
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -380,
          "y": 1290
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: TempAdminRightsIndia
      tags:
        simple: TempAdminRightsIndia
      type:
        simple: TCS Employee Id
      value:
        simple: ${incident.empid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      id: 84872d83-c723-46c3-88e3-2618b7221956
      iscommand: false
      name: Add Employee To Indicator With Expiry Date/Time - India
      script: 88adcc81-d279-4bd8-8bea-b7773d15d418
      type: regular
      version: -1
    taskid: 84872d83-c723-46c3-88e3-2618b7221956
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1290
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2125,
        "width": 4550,
        "x": -2920,
        "y": -20
      }
    }
  }
