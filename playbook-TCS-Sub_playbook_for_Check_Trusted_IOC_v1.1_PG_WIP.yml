contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 126baddf-335e-4b23-8883-d502a36a1cc7
inputs:
- description: ""
  key: suspiciousiocs
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: entertheiocsforblocking
      root: incident
name: TCS-Sub playbook for Check Trusted IOC_v1.1_PG_WIP
outputs: []
quiet: true
sourceplaybookid: 1ab12445-475c-47bc-8d35-e4f727fe60df
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2a56ad50-c323-4bd2-846c-9fe77f92eb95
      iscommand: false
      name: ""
      version: -1
    taskid: 2a56ad50-c323-4bd2-846c-9fe77f92eb95
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1970,
          "y": -590
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.IP
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3e6661c4-7ab1-49b2-8665-5c938e4b3415
      iscommand: false
      name: Is There an IPv4 IP Address in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 3e6661c4-7ab1-49b2-8665-5c938e4b3415
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -110,
          "y": 155
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.URL
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4663fbe6-54a4-4a8d-8ec3-200eda272e95
      iscommand: false
      name: Is There a URL in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 4663fbe6-54a4-4a8d-8ec3-200eda272e95
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 320,
          "y": 155
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Domain
          operator: isExists
          right:
            value: {}
        - left:
            iscontext: true
            value:
              complex:
                accessor: Domain_Test_
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8dc4a608-8ecc-4da5-8acf-ba4b3e51277a
      iscommand: false
      name: Is There a Domain in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 8dc4a608-8ecc-4da5-8acf-ba4b3e51277a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 780,
          "y": 140
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          root: inputs.IP
      ipRanges:
        simple: ${lists.Google Public IP Addresses},${lists.Microsoft Public IP Addresses},${lists.TCS_Public_IP_Addresses},${lists.MasterIOC_IP
          Address},${lists.ZscalerIPAddresses},${lists.TCS_RFScanIP_list}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 888e07f4-1b9f-48ba-89d6-bc6a2504f3fe
      iscommand: false
      name: Is The IP Address Part of The Trusted List
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 888e07f4-1b9f-48ba-89d6-bc6a2504f3fe
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -110,
          "y": 470
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.IPV4
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 949a7203-dd42-4164-83c3-064409eac893
      iscommand: false
      name: Set Identified Trusted IP Address in Context
      script: Set
      type: regular
      version: -1
    taskid: 949a7203-dd42-4164-83c3-064409eac893
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 705
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      trustedipaddress:
        complex:
          accessor: IPV4
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 1ec2afca-7014-4529-8dd0-3f4b0c265b99
      iscommand: true
      name: Set Incident Context ' Trusted IP Address'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 1ec2afca-7014-4529-8dd0-3f4b0c265b99
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 960
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: InRange
                root: IP
          operator: isEqualString
          right:
            value:
              simple: "no"
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6135bed5-aa02-4b1e-8195-4d66bb422433
      iscommand: false
      name: Are There Any IP Addresses For Blacklisting ?
      type: condition
      version: -1
    taskid: 6135bed5-aa02-4b1e-8195-4d66bb422433
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -120,
          "y": 1275
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.IPV4
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d1723347-e28a-4548-84c0-381f65d101bc
      iscommand: false
      name: Set The Filtered Blacklisting IP Address in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: d1723347-e28a-4548-84c0-381f65d101bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 1520
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      validatedipaddress:
        complex:
          accessor: IPV4
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 9ddbeb43-cf39-45fc-8720-da48edca46e7
      iscommand: true
      name: Set Incident Context ' Validated IP Address'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 9ddbeb43-cf39-45fc-8720-da48edca46e7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 1740
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      domains:
        simple: ${lists.TCS_Customer_Domain_List},${TCS_Created_Domain}
      urls:
        complex:
          root: inputs.URL
          transformers:
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the supplied URLs are in the specified domains.
      id: 54fd1fd4-bc46-4d4e-86dc-842142ba8b73
      iscommand: false
      name: Is The URL Part of The Trusted List
      script: IsUrlPartOfDomain
      type: regular
      version: -1
    taskid: 54fd1fd4-bc46-4d4e-86dc-842142ba8b73
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 330,
          "y": 470
        }
      }
  "13":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsInternal
                root: IsUrlPartOfDomain
          operator: containsGeneral
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: be60cd88-eb6e-441d-828e-865ce647c271
      iscommand: false
      name: Are There URL(s) Part of The Trusted Domain List
      type: condition
      version: -1
    taskid: be60cd88-eb6e-441d-828e-865ce647c271
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 330,
          "y": 640
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.URL
      value:
        complex:
          accessor: URL
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IsUrlPartOfDomain.IsInternal
              operator: isEqualString
              right:
                value:
                  simple: "true"
          - - left:
                iscontext: true
                value:
                  simple: IsUrlPartOfDomain.URL
              operator: in
              right:
                iscontext: true
                value:
                  simple: Blacklist.URL
          root: IsUrlPartOfDomain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2e9359dd-8824-470a-8fb5-86c4ce0c78a7
      iscommand: false
      name: Set Identified Trusted URL in Context
      script: Set
      type: regular
      version: -1
    taskid: 2e9359dd-8824-470a-8fb5-86c4ce0c78a7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 330,
          "y": 840
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      trustedurl:
        complex:
          accessor: URL
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 456afde1-66a0-43ed-82fe-49b5b947fb98
      iscommand: true
      name: Set Incident Context ' Trusted URL'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 456afde1-66a0-43ed-82fe-49b5b947fb98
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 330,
          "y": 1060
        }
      }
  "16":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.URL
          operator: notIn
          right:
            iscontext: true
            value:
              simple: Trusted.URL
      label: "yes"
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2bd42452-ee88-4578-8366-508116b83b3b
      iscommand: false
      name: Are There Any URLs For Blacklisting ?
      type: condition
      version: -1
    taskid: 2bd42452-ee88-4578-8366-508116b83b3b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 330,
          "y": 1285
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.URL
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.URL
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: Trusted.URL
          root: inputs.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d4720724-6038-4f40-89f8-1bfe56f9d3f4
      iscommand: false
      name: Set The Filtered Blacklisting URLs in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: d4720724-6038-4f40-89f8-1bfe56f9d3f4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 320,
          "y": 1560
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      validatedurl:
        complex:
          accessor: URL
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fdb66845-9bed-4a7e-8d15-a9dc2d0a52ce
      iscommand: true
      name: Set Incident Context ' Validated URL'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: fdb66845-9bed-4a7e-8d15-a9dc2d0a52ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 330,
          "y": 1740
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 2
    scriptarguments:
      main_domains:
        simple: ${lists.TCS_Customer_Domain_List},${lists.TCS_Created_Domain}
      possible_sub_domains_to_test:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script accepts multiple values for both arguments and will
        iterate through each of the domains to check if the specified subdomains are
        located in at least one of the specified main domains. If the tested subdomain
        is in one of the main domains, the result will be true. For example, if the
        domain_to_check values are apps.paloaltonetworks.com and apps.paloaltonetworks.bla
        and the domains_to_compare values are paloaltonetworks.com and demisto.com,
        the result for apps.paloaltonetworks.com will be true since it is a part of
        the paloaltonetworks.com domain. The result for apps.paloaltonetworks.bla
        will be false since it is not a part of the paloaltonetworks.com or demisto.com
        domain.
      id: bd7abae6-2bb8-48cd-84a6-47362b707e73
      iscommand: false
      name: Is The Domain Part of The Trusted List
      script: IsInternalDomainName
      type: regular
      version: -1
    taskid: bd7abae6-2bb8-48cd-84a6-47362b707e73
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 780,
          "y": 590
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsInternal
                root: IsInternalDomain
          operator: containsGeneral
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 21a65797-30ca-48ab-8fdb-4768640107bf
      iscommand: false
      name: Are There Domain(s) Part of The Trusted List
      type: condition
      version: -1
    taskid: 21a65797-30ca-48ab-8fdb-4768640107bf
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 780,
          "y": 735
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.Domain
      value:
        complex:
          accessor: DomainToTest
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IsInternalDomain.DomainToTest
              operator: in
              right:
                iscontext: true
                value:
                  simple: Blacklist.Domain
          - - left:
                iscontext: true
                value:
                  simple: IsInternalDomain.IsInternal
              operator: isEqualString
              right:
                value:
                  simple: "true"
          root: IsInternalDomain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3b063211-33f5-4f61-8bdb-20f27ed7cd90
      iscommand: false
      name: Set Identified Trusted Domain in Context
      script: Set
      type: regular
      version: -1
    taskid: 3b063211-33f5-4f61-8bdb-20f27ed7cd90
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 780,
          "y": 910
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      trusteddomain:
        complex:
          accessor: Domain
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 2d3a6913-6d0f-4fe7-8de6-0c99e259881c
      iscommand: true
      name: Set Incident Context ' Trusted Domain'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 2d3a6913-6d0f-4fe7-8de6-0c99e259881c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 780,
          "y": 1060
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Domain
          operator: notIn
          right:
            iscontext: true
            value:
              simple: Trusted.Domain
      label: "yes"
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 74699f43-f4a7-4c82-8eba-107637940d4a
      iscommand: false
      name: Are There Any Domains For Blacklisting ?
      type: condition
      version: -1
    taskid: 74699f43-f4a7-4c82-8eba-107637940d4a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 780,
          "y": 1275
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.Domain
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: Trusted.Domain
          root: inputs.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 03f9f9f5-4153-4b0d-8f69-c1c5d03cc75f
      iscommand: false
      name: Set The Filtered Blacklisting Domains in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: 03f9f9f5-4153-4b0d-8f69-c1c5d03cc75f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 780,
          "y": 1570
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      validateddomain:
        complex:
          accessor: Domain
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: b4c29afb-846f-4027-864c-8e050574c92c
      iscommand: true
      name: Set Incident Context ' Validated Domain'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: b4c29afb-846f-4027-864c-8e050574c92c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 780,
          "y": 1740
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e072aa81-1ef4-4424-8d27-aefb4d340f27
      iscommand: false
      name: Generate report
      type: title
      version: -1
    taskid: e072aa81-1ef4-4424-8d27-aefb4d340f27
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 320,
          "y": 1960
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IPV4
                root: Trusted
          operator: isExists
        - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: Trusted
          operator: isExists
        - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: Trusted
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 41c478d1-348f-4632-870e-e082b3ba6ed2
      iscommand: false
      name: Is There any trusted IOC present
      type: condition
      version: -1
    taskid: 41c478d1-348f-4632-870e-e082b3ba6ed2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 320,
          "y": 2405
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      bcc:
        simple: porkodi.g@tcs.com
      body:
        simple: "Hello Human,\n\nI did not find any customer IP Addresses in this
          file ${incident.attachment.name}\n\n\nRegards,\nCSOC CyberAutoBot "
      subject:
        simple: No Customer IP Found In This File ${incident.attachment.name}
      to:
        complex:
          accessor: emailfrom
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 56330eca-40dd-40a2-867c-39868df0e627
      iscommand: true
      name: Send Email Notification That No Customer IP Addresses Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 56330eca-40dd-40a2-867c-39868df0e627
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 560,
          "y": 2620
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      bcc:
        simple: porkodi.g@tcs.com
      body:
        simple: "Hello Human,\n\nI Found customer IOC in this file \n\n${Trusted.IPV4}\n${Trusted.Domain}\n${Trusted.URL}\n\n\nRegards,\nCSOC
          CyberAutoBot "
      subject:
        simple: Customer IOC Found In This File ${incident.attachment.name}
      to:
        complex:
          accessor: emailfrom
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 0952439e-4b1f-43f5-8e67-ebc06e747480
      iscommand: true
      name: Send Email Notification That  Customer IOC Addresses Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 0952439e-4b1f-43f5-8e67-ebc06e747480
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 120,
          "y": 2600
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1d8a2e3a-65c9-4e90-84b0-56978d1d06f2
      iscommand: false
      name: END
      type: title
      version: -1
    taskid: 1d8a2e3a-65c9-4e90-84b0-56978d1d06f2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 310,
          "y": 2850
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.Domain
      value:
        complex:
          root: inputs.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a3e303ac-95f1-4e93-8792-4d9b910c2b97
      iscommand: false
      name: Set Blacklist Domain in 'Blacklist.Domain' Context
      script: Set
      type: regular
      version: -1
    taskid: a3e303ac-95f1-4e93-8792-4d9b910c2b97
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 780,
          "y": 440
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: type
                root: incident
          operator: isEqualString
          right:
            value:
              simple: Check For Trusted IOC
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "31"
      "yes":
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 680f361c-9f8f-4a16-8c0b-2a1f935d3edc
      iscommand: false
      name: Check the incident type
      type: condition
      version: -1
    taskid: 680f361c-9f8f-4a16-8c0b-2a1f935d3edc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 320,
          "y": 2170
        }
      }
  "42":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7c2299a5-f961-4eef-80e4-a97eee799534
      iscommand: false
      name: Is There an IPv4 IP Address in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 7c2299a5-f961-4eef-80e4-a97eee799534
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 690
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.IPV4
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b6704f26-45e5-4949-8a12-84c873b2ee4d
      iscommand: false
      name: Set Blacklist IPv4 IP Address in 'Blacklist.IPV4' Context
      script: Set
      type: regular
      version: -1
    taskid: b6704f26-45e5-4949-8a12-84c873b2ee4d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 950
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 99b7fb36-b53c-43cd-8e9a-cfd1fa402d52
      iscommand: false
      name: Is There a URL in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 99b7fb36-b53c-43cd-8e9a-cfd1fa402d52
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 690
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.URL
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.URL
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: fb18f306-d356-40f1-8eeb-6de7c3043458
      iscommand: false
      name: Set Blacklist URL in 'Blacklist.URL' Context
      script: Set
      type: regular
      version: -1
    taskid: fb18f306-d356-40f1-8eeb-6de7c3043458
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 940
        }
      }
  "46":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExtractedIndicators.Domain
                    operator: in
                    right:
                      iscontext: true
                      value:
                        simple: BlacklistIOC
                root: ExtractedIndicators.Domain
          operator: isExists
        - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExtractedIndicators.Domain_Test_
                    operator: in
                    right:
                      iscontext: true
                      value:
                        simple: BlacklistIOC
                root: ExtractedIndicators.Domain_Test_
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b4e6f56d-c485-4a4a-8c13-7c974b36e79d
      iscommand: false
      name: Is There a Domain in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: b4e6f56d-c485-4a4a-8c13-7c974b36e79d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2140,
          "y": 690
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain_Test_
            - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5845afc0-7f16-411d-8577-90c8ff4fa72b
      iscommand: false
      name: Set Blacklist Domain in 'Blacklist.Domain' Context
      script: Set
      type: regular
      version: -1
    taskid: 5845afc0-7f16-411d-8577-90c8ff4fa72b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2140,
          "y": 940
        }
      }
  "48":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExtractedIndicators.File
                    operator: in
                    right:
                      iscontext: true
                      value:
                        simple: BlacklistIOC
                root: ExtractedIndicators.File
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 890ebb29-8446-44d0-822f-2b1987d9f23f
      iscommand: false
      name: Is There a Hash in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 890ebb29-8446-44d0-822f-2b1987d9f23f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2570,
          "y": 690
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.Hash
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.File
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1e0218cd-a9b1-4a88-8e4e-367d84808988
      iscommand: false
      name: Set Blacklist Hash in 'Blacklist.Hash' Context
      script: Set
      type: regular
      version: -1
    taskid: 1e0218cd-a9b1-4a88-8e4e-367d84808988
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2570,
          "y": 940
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IPV4
          root: Blacklist
      ipRanges:
        simple: ${lists.Google Public IP Addresses},${lists.Microsoft Public IP Addresses},${lists.TCS_Public_IP_Addresses},${lists.MasterIOC_IP
          Address},${lists.ZscalerIPAddresses},${lists.TCS_RFScanIP_list}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 7e9a8862-af0e-48cc-8e02-b8f3e17a53c8
      iscommand: false
      name: Is The IP Address Part of The Trusted List
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 7e9a8862-af0e-48cc-8e02-b8f3e17a53c8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 1350
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    scriptarguments:
      domains:
        simple: ${lists.TCS_Customer_Domain_List},${TCS_Created_Domain}
      urls:
        complex:
          accessor: URL
          root: Blacklist
          transformers:
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the supplied URLs are in the specified domains.
      id: b67f80ee-4da9-4064-8cee-6937ecdc3eda
      iscommand: false
      name: Is The URL Part of The Trusted List
      script: IsUrlPartOfDomain
      type: regular
      version: -1
    taskid: b67f80ee-4da9-4064-8cee-6937ecdc3eda
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 1350
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 2
    scriptarguments:
      main_domains:
        simple: ${lists.TCS_Customer_Domain_List},${lists.TCS_Created_Domain}
      possible_sub_domains_to_test:
        complex:
          accessor: Domain
          root: Blacklist
          transformers:
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script accepts multiple values for both arguments and will
        iterate through each of the domains to check if the specified subdomains are
        located in at least one of the specified main domains. If the tested subdomain
        is in one of the main domains, the result will be true. For example, if the
        domain_to_check values are apps.paloaltonetworks.com and apps.paloaltonetworks.bla
        and the domains_to_compare values are paloaltonetworks.com and demisto.com,
        the result for apps.paloaltonetworks.com will be true since it is a part of
        the paloaltonetworks.com domain. The result for apps.paloaltonetworks.bla
        will be false since it is not a part of the paloaltonetworks.com or demisto.com
        domain.
      id: baa1d120-ea27-4205-810d-42da73abf012
      iscommand: false
      name: Is The Domain Part of The Trusted List
      script: IsInternalDomainName
      type: regular
      version: -1
    taskid: baa1d120-ea27-4205-810d-42da73abf012
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2140,
          "y": 1350
        }
      }
  "53":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsInternal
                root: IsInternalDomain
          operator: containsGeneral
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "63"
      "yes":
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 95ae0d3e-f93b-46b7-86e8-9fd02dbdab95
      iscommand: false
      name: Are There Domain(s) Part of The Trusted List
      type: condition
      version: -1
    taskid: 95ae0d3e-f93b-46b7-86e8-9fd02dbdab95
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2140,
          "y": 1520
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsInternal
                root: IsUrlPartOfDomain
          operator: containsGeneral
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "62"
      "yes":
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5c7d796d-1aa3-4a4c-85af-9346c556d11f
      iscommand: false
      name: Are There URL(s) Part of The Trusted Domain List
      type: condition
      version: -1
    taskid: 5c7d796d-1aa3-4a4c-85af-9346c556d11f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 1520
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.IPV4
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 52982078-1d70-4d33-86af-61b3b1b8e14c
      iscommand: false
      name: Set Identified Trusted IP Address in Context
      script: Set
      type: regular
      version: -1
    taskid: 52982078-1d70-4d33-86af-61b3b1b8e14c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 1720
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.URL
      value:
        complex:
          accessor: URL
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IsUrlPartOfDomain.IsInternal
              operator: isEqualString
              right:
                value:
                  simple: "true"
          - - left:
                iscontext: true
                value:
                  simple: IsUrlPartOfDomain.URL
              operator: in
              right:
                iscontext: true
                value:
                  simple: Blacklist.URL
          root: IsUrlPartOfDomain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f11ccb74-3f75-4131-869a-7bbe724d62a5
      iscommand: false
      name: Set Identified Trusted URL in Context
      script: Set
      type: regular
      version: -1
    taskid: f11ccb74-3f75-4131-869a-7bbe724d62a5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 1720
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.Domain
      value:
        complex:
          accessor: DomainToTest
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IsInternalDomain.DomainToTest
              operator: in
              right:
                iscontext: true
                value:
                  simple: Blacklist.Domain
          - - left:
                iscontext: true
                value:
                  simple: IsInternalDomain.IsInternal
              operator: isEqualString
              right:
                value:
                  simple: "true"
          root: IsInternalDomain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 122462dc-3c82-470e-8325-c3333e03edba
      iscommand: false
      name: Set Identified Trusted Domain in Context
      script: Set
      type: regular
      version: -1
    taskid: 122462dc-3c82-470e-8325-c3333e03edba
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2140,
          "y": 1720
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    scriptarguments:
      trustedipaddress:
        complex:
          accessor: IPV4
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 822a66ba-c8d2-4127-855e-242b671ca70c
      iscommand: true
      name: Set Incident Context ' Trusted IP Address'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 822a66ba-c8d2-4127-855e-242b671ca70c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 1940
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      trustedurl:
        complex:
          accessor: URL
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: ed3cf5a3-28a1-4049-8953-8695a3230e1a
      iscommand: true
      name: Set Incident Context ' Trusted URL'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ed3cf5a3-28a1-4049-8953-8695a3230e1a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 1940
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    scriptarguments:
      trusteddomain:
        complex:
          accessor: Domain
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 92592534-2edc-4604-8899-9398fae26187
      iscommand: true
      name: Set Incident Context ' Trusted Domain'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 92592534-2edc-4604-8899-9398fae26187
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2140,
          "y": 1940
        }
      }
  "61":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: InRange
                root: IP
          operator: isEqualString
          right:
            value:
              simple: "no"
      label: "yes"
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "65"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a240732a-43ac-4228-89c6-a1f5ee8539ad
      iscommand: false
      name: Are There Any IP Addresses For Blacklisting ?
      type: condition
      version: -1
    taskid: a240732a-43ac-4228-89c6-a1f5ee8539ad
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 2200
        }
      }
  "62":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: Blacklist
          operator: notIn
          right:
            iscontext: true
            value:
              simple: Trusted.URL
      label: "yes"
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7442d057-3979-45d5-8a12-f19969f09b7f
      iscommand: false
      name: Are There Any URLs For Blacklisting ?
      type: condition
      version: -1
    taskid: 7442d057-3979-45d5-8a12-f19969f09b7f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 2200
        }
      }
  "63":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: Blacklist
          operator: notIn
          right:
            iscontext: true
            value:
              simple: Trusted.Domain
      label: "yes"
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b797106a-08d1-440d-87c2-609c8fd67b6b
      iscommand: false
      name: Are There Any Domains For Blacklisting ?
      type: condition
      version: -1
    taskid: b797106a-08d1-440d-87c2-609c8fd67b6b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2140,
          "y": 2200
        }
      }
  "64":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Hash
                root: FinalBlacklist
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "69"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 16529749-2376-4408-8f21-bcf25a64d06d
      iscommand: false
      name: Check If Context 'FinalBlacklist.Hash' is Set
      type: condition
      version: -1
    taskid: 16529749-2376-4408-8f21-bcf25a64d06d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2570,
          "y": 2200
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "67"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.IPV4
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 70fe3b28-6906-4a45-8d1d-caef2e4d8c0b
      iscommand: false
      name: Set The Filtered Blacklisting IP Address in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: 70fe3b28-6906-4a45-8d1d-caef2e4d8c0b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 2450
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Blacklist.Domain
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: Trusted.Domain
          root: Blacklist.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e728dd86-216f-4717-8415-81023ad00787
      iscommand: false
      name: Set The Filtered Blacklisting Domains in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: e728dd86-216f-4717-8415-81023ad00787
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2140,
          "y": 2450
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    scriptarguments:
      validatedipaddress:
        complex:
          accessor: IPV4
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: cc307e1b-6395-4ada-85ac-72468f4ff176
      iscommand: true
      name: Set Incident Context ' Validated IP Address'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: cc307e1b-6395-4ada-85ac-72468f4ff176
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 2620
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    scriptarguments:
      validateddomain:
        complex:
          accessor: Domain
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 9dd603f2-bf3e-4519-834d-fb2b7e7487ce
      iscommand: true
      name: Set Incident Context ' Validated Domain'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 9dd603f2-bf3e-4519-834d-fb2b7e7487ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2140,
          "y": 2620
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    scriptarguments:
      validatedhash:
        complex:
          accessor: Hash
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 2fb3e92d-19a9-48a3-821d-ee7345a29427
      iscommand: true
      name: Set Incident Context ' Validated Hash'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 2fb3e92d-19a9-48a3-821d-ee7345a29427
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2570,
          "y": 2620
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    scriptarguments:
      validatedurl:
        complex:
          accessor: URL
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: b2f3ca57-e457-4ed5-8064-590c2d61604f
      iscommand: true
      name: Set Incident Context ' Validated URL'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: b2f3ca57-e457-4ed5-8064-590c2d61604f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 2620
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "72"
      - "73"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0ca17591-0815-4454-8c23-25ec1ae2cb55
      iscommand: false
      name: Update Widgets For Trusted & Validated IoC(s)
      type: title
      version: -1
    taskid: 0ca17591-0815-4454-8c23-25ec1ae2cb55
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3290,
          "y": 2750
        }
      }
  "72":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Trusted
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "76"
      "yes":
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 9fca5b36-0a51-4510-8690-463728b8b140
      iscommand: false
      name: Are There Trusted IoC(s)?
      type: condition
      version: -1
    taskid: 9fca5b36-0a51-4510-8690-463728b8b140
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2980,
          "y": 2960
        }
      }
  "73":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: FinalBlacklist
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "76"
      "yes":
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: f2c3cb8f-0efd-492f-89dd-565ff5ffc3d0
      iscommand: false
      name: 'Are There Validated IoC(s)? '
      type: condition
      version: -1
    taskid: f2c3cb8f-0efd-492f-89dd-565ff5ffc3d0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3460,
          "y": 2960
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "76"
    note: false
    quietmode: 0
    scriptarguments:
      trustediocs:
        complex:
          root: Trusted
          transformers:
          - operator: Stringify
          - args:
              chars:
                value:
                  simple: '{}'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: d929d9b9-e6ba-463b-8ca8-19ba3dddea24
      iscommand: true
      name: Set The Trusted IoC(s) Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: d929d9b9-e6ba-463b-8ca8-19ba3dddea24
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2980,
          "y": 3130
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "76"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      validatediocsforblacklisting:
        complex:
          root: FinalBlacklist
          transformers:
          - operator: Stringify
          - args:
              chars:
                value:
                  simple: '{}'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 7bee3612-fb05-48c1-8a81-92df388177ec
      iscommand: true
      name: Set The Trusted IoC(s) Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 7bee3612-fb05-48c1-8a81-92df388177ec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3460,
          "y": 3140
        }
      }
  "76":
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dc985f4c-afd9-4810-862c-011286949c82
      iscommand: false
      name: Verify & Close Automation
      type: title
      version: -1
    taskid: dc985f4c-afd9-4810-862c-011286949c82
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3220,
          "y": 3380
        }
      }
  "77":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.suspiciousiocs
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cff5f17a-2bcc-495d-8c2a-6c3d5c67562f
      iscommand: false
      name: Are There IoC(s) For Blacklisting ?
      type: condition
      version: -1
    taskid: cff5f17a-2bcc-495d-8c2a-6c3d5c67562f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1970,
          "y": -420
        }
      }
  "78":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "87"
      "yes":
      - "79"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 213f0b0c-3405-4411-8851-dc0c1ddd380d
      iscommand: false
      name: Is 'ExtractedIndicators' Context Set ?
      type: condition
      version: -1
    taskid: 213f0b0c-3405-4411-8851-dc0c1ddd380d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1970,
          "y": -210
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "87"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 0c803345-8017-493d-8e4a-0426745f41aa
      iscommand: false
      name: Detele 'ExtractedIndicators' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 0c803345-8017-493d-8e4a-0426745f41aa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1970,
          "y": -10
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
      - "44"
      - "46"
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlacklistIOC
      value:
        complex:
          root: inputs.suspiciousiocs
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a973f94b-984d-43df-87d2-b6a20da9de4a
      iscommand: false
      name: Set IoC(s) In Contest
      script: Set
      type: regular
      version: -1
    taskid: a973f94b-984d-43df-87d2-b6a20da9de4a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1970,
          "y": 390
        }
      }
  "82":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.suspiciousiocs
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2e448047-4345-493b-8994-8dc3b268df3d
      iscommand: false
      name: Are There IoC(s) For Blacklisting ?
      type: condition
      version: -1
    taskid: 2e448047-4345-493b-8994-8dc3b268df3d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 870,
          "y": -190
        }
      }
  "83":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "85"
      "yes":
      - "84"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3a8c2e37-eda9-4803-8f62-f9655cc43b4e
      iscommand: false
      name: Is 'ExtractedIndicators' Context Set ?
      type: condition
      version: -1
    taskid: 3a8c2e37-eda9-4803-8f62-f9655cc43b4e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 870,
          "y": 20
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "85"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 733ccdb6-9e00-45ab-83ac-ab669f0a1aa7
      iscommand: false
      name: Detele 'ExtractedIndicators' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 733ccdb6-9e00-45ab-83ac-ab669f0a1aa7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": 220
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      text:
        simple: ${inputs.suspiciousiocs}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 44158b3c-7c48-4af2-8780-220d78584f09
      iscommand: true
      name: Extract & Enrich Indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 44158b3c-7c48-4af2-8780-220d78584f09
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": 410
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlacklistIOC
      value:
        complex:
          root: inputs.suspiciousiocs
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e38fe4b0-cfe2-49e2-88ab-ae10982ea41a
      iscommand: false
      name: Set IoC(s) In Contest
      script: Set
      type: regular
      version: -1
    taskid: e38fe4b0-cfe2-49e2-88ab-ae10982ea41a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": 620
        }
      }
  "87":
    continueonerrortype: ""
    id: "87"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
    note: false
    quietmode: 1
    reputationcalc: 1
    scriptarguments:
      text:
        simple: ${inputs.suspiciousiocs}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 94db5601-2e2f-4be3-8377-e2c9e65511c6
      iscommand: true
      name: Extract & Enrich Indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 94db5601-2e2f-4be3-8377-e2c9e65511c6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1970,
          "y": 185
        }
      }
  "88":
    continueonerrortype: ""
    id: "88"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      text:
        simple: ${inputs.suspiciousiocs}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: c68fd2f0-107a-46e8-823a-79c8fca731d6
      iscommand: true
      name: Extract & Enrich Indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: c68fd2f0-107a-46e8-823a-79c8fca731d6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2690,
          "y": 210
        }
      }
  "89":
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.URL
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Blacklist.URL
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: Trusted.URL
          root: Blacklist.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 94fb603b-0a1e-4334-8152-51242c42f28a
      iscommand: false
      name: Set The Filtered Blacklisting URLs in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: 94fb603b-0a1e-4334-8152-51242c42f28a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 2420
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4035,
        "width": 3960,
        "x": -120,
        "y": -590
      }
    }
  }
