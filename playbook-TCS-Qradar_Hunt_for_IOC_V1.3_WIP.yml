contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: dd1e4ee9-0732-432a-872a-75ced9ec83bc
inputs:
- description: ""
  key: IP
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: IP
      root: ExtractedIndicators
- description: ""
  key: Domain
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Domain
      root: ExtractedIndicators
- description: ""
  key: File
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: File
      root: ExtractedIndicators
- description: ""
  key: DomainTest
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Domain_Test_
      root: ExtractedIndicators
      transformers:
      - args:
          chars:
            value:
              simple: www.
        operator: StripChars
name: TCS-Qradar Hunt for IOC_V1.3_WIP
outputs: []
sourceplaybookid: 7edb4ef0-ae29-4a85-8df5-6df16b8c3bad
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0917265f-15b2-43ea-8b39-94969a2946e6
      iscommand: false
      name: ""
      version: -1
    taskid: 0917265f-15b2-43ea-8b39-94969a2946e6
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 255,
          "y": -700
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: c88ac983-1940-4432-897f-7c208e9b1369
      iscommand: true
      name: 'Extract Indicators '
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: c88ac983-1940-4432-897f-7c208e9b1369
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 255,
          "y": -20
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: ${incident.id}_Hunt_IOC_IP
      value:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Add or update a value in a reference set.
      id: 19555386-795f-4270-8fe3-12568473affb
      iscommand: true
      name: Populate IP To Reference Set
      script: QRadar_v2_copy|||qradar-create-reference-set-value
      type: regular
      version: -1
    taskid: 19555386-795f-4270-8fe3-12568473affb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 550,
          "y": 605
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 14b99bab-1483-4fd4-89d6-e2d74640b255
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 14b99bab-1483-4fd4-89d6-e2d74640b255
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2150
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      body:
        simple: "Hi Team , \n\nPlease find the attached hunt result .\n\nThanks\nCyberSecurity
          AutoBot\n"
      subject:
        simple: Hunt IOC Report from Qradar
      to:
        simple: ${incident.emailfrom}
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: ef23d006-7e61-437d-85c6-1d4071f87027
      iscommand: true
      name: Send report via email
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: ef23d006-7e61-437d-85c6-1d4071f87027
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 1750
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.IP
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "50"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ad8c5e06-83a0-47f1-8e24-b44c914baddf
      iscommand: false
      name: Are there IPs to Hunt
      type: condition
      version: -1
    taskid: ad8c5e06-83a0-47f1-8e24-b44c914baddf
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 550,
          "y": 170
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        complex:
          accessor: events}
          root: ${QRadar.Search.Result
      fileName:
        simple: Presence of IOC in Destination.csv
      headers:
        simple: Destination IP,Destination Port,Event Count,Event Name,Log Source,Low
          Level Category,Magnitude,Source IP,Source Port,Time
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: bdc052e0-92d1-4c83-87c8-a190f93dca6f
      iscommand: false
      name: Create Report For Presence of IOC in Destination
      script: ExportToCSV
      type: regular
      version: -1
    taskid: bdc052e0-92d1-4c83-87c8-a190f93dca6f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1375
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${QRadar.Search.Result.events}
      fileName:
        simple: Presence of IOC in Source.csv
      headers:
        simple: Destination IP,Destination Port,Event Count,Event Name,Log Source,Low
          Level Category,Magnitude,Source IP,Source Port,Time
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 7925878d-4f1f-4304-8c93-1499c6da7fbe
      iscommand: false
      name: Create Report For Presence of IOC in Source
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 7925878d-4f1f-4304-8c93-1499c6da7fbe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 1375
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AQLIPSearchDestination
      value:
        simple: select QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as
          'Log Source',"eventCount" as 'Event Count',"startTime" as 'Time',categoryname(category)
          as 'Low Level Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source
          Port',"destinationIP" as 'Destination IP',"destinationPort" as 'Destination
          Port',"userName" as 'Username',SUM("eventCount") AS 'AggregatedCount' from
          events where referencesetcontains('${incident.id}_Hunt_IOC_IP', "destinationIP")GROUP
          BY destinationIP last 30 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c3b6bd51-b477-454b-8181-fcf8d9e218e3
      iscommand: false
      name: Create IP Search in Destination AQL
      script: Set
      type: regular
      version: -1
    taskid: c3b6bd51-b477-454b-8181-fcf8d9e218e3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 290,
          "y": 810
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AQLIPSearchSource
      value:
        simple: select QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as
          'Log Source',"eventCount" as 'Event Count',"startTime" as 'Time',categoryname(category)
          as 'Low Level Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source
          Port',"destinationIP" as 'Destination IP',"destinationPort" as 'Destination
          Port',"userName" as 'Username',SUM("eventCount") AS 'AggregatedCount' from
          events where referencesetcontains('${incident.id}_Hunt_IOC_IP', "sourceIP")GROUP
          BY sourceIP last 30 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8361ff1f-d7d2-44af-88f0-1366443f0662
      iscommand: false
      name: Create IP Search in Source AQL
      script: Set
      type: regular
      version: -1
    taskid: 8361ff1f-d7d2-44af-88f0-1366443f0662
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 810
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: ${incident.id}_Hunt_IOC_IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Deletes a reference set corresponding to the name provided.
      id: 234dee9f-4db8-46fd-8414-4b82a479fc3e
      iscommand: true
      name: Delete IP Reference Set
      script: QRadar_v2_copy|||qradar-delete-reference-set
      type: regular
      version: -1
    taskid: 234dee9f-4db8-46fd-8414-4b82a479fc3e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 1950
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      element_type:
        simple: IP
      ref_name:
        simple: ${incident.id}_Hunt_IOC_IP
      using:
        simple: QRadar v3_Typosquat Offences
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Creates a new reference set.
      id: ea50b5b5-0f96-4974-82f3-4e7dda760fcb
      iscommand: true
      name: Create Reference Set
      script: QRadar v3|||qradar-reference-set-create
      type: regular
      version: -1
    taskid: ea50b5b5-0f96-4974-82f3-4e7dda760fcb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 550,
          "y": 420
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: sonam.bhandari@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: internalis.cybersecurityops@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: v.ghule@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: komal.lugade@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e52d115-bdd3-4c14-8b63-0bc5b3ed2775
      iscommand: false
      name: Is Email from Authorised Sender
      type: condition
      version: -1
    taskid: 1e52d115-bdd3-4c14-8b63-0bc5b3ed2775
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 255,
          "y": -290
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: emailfrom
                root: incident
          operator: isExists
      label: Email
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "18"
      Email:
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 95d2d904-e936-4c62-831f-cb3517ded1c6
      iscommand: false
      name: Automation Triggered via Email or Incident ?
      type: condition
      version: -1
    taskid: 95d2d904-e936-4c62-831f-cb3517ded1c6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 255,
          "y": -520
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: QRadar.Search.Result.events
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 880afd53-e28f-48d9-83a4-5ac3c68797f4
      iscommand: false
      name: Did Search Yield Results ?
      type: condition
      version: -1
    taskid: 880afd53-e28f-48d9-83a4-5ac3c68797f4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1170
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: QRadar.Search
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 14dc712e-7fb0-4097-879d-74f908237605
      iscommand: false
      name: Delete Context 'QRadar.Search'
      script: DeleteContext
      type: regular
      version: -1
    taskid: 14dc712e-7fb0-4097-879d-74f908237605
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 300,
          "y": 1540
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: QRadar.Search.Result.events
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e3c83900-6416-4dca-827d-dd7757ac8cf0
      iscommand: false
      name: Did Search Yield Results ?
      type: condition
      version: -1
    taskid: e3c83900-6416-4dca-827d-dd7757ac8cf0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 810,
          "y": 1160
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: emailfrom
                root: incident
          operator: isExists
      label: Email
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      Email:
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c58f35ab-9158-44de-8bbc-de0476aab6a7
      iscommand: false
      name: Automation Triggered via Email or Incident ?
      type: condition
      version: -1
    taskid: c58f35ab-9158-44de-8bbc-de0476aab6a7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 810,
          "y": 1570
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: ${AQLIPSearchDestination}
      timeout:
        simple: "100000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 74cd442e-39ae-4705-808b-8714b3c03556
      iscommand: false
      name: QRadarFullSearch - Destination
      playbookId: QRadarFullSearch
      type: playbook
      version: -1
    taskid: 74cd442e-39ae-4705-808b-8714b3c03556
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 290,
          "y": 985
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: ${AQLIPSearchSource}
      timeout:
        simple: "100000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 2d456c2a-c85a-45e4-89cd-7aa000a6a2ab
      iscommand: false
      name: QRadarFullSearch - Source
      playbookId: QRadarFullSearch
      type: playbook
      version: -1
    taskid: 2d456c2a-c85a-45e4-89cd-7aa000a6a2ab
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 810,
          "y": 985
        }
      }
  "39":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.IP
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: faa2210f-5762-4b98-8909-24eae020dc1c
      iscommand: false
      name: Are there IPs to Hunt
      type: condition
      version: -1
    taskid: faa2210f-5762-4b98-8909-24eae020dc1c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2000,
          "y": 170
        }
      }
  "40":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Domain
          operator: isNotEmpty
        - left:
            iscontext: true
            value:
              complex:
                root: inputs.DomainTest
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 357b0448-9342-4350-8a85-12f298c58613
      iscommand: false
      name: Are there Domains to Hunt ?
      type: condition
      version: -1
    taskid: 357b0448-9342-4350-8a85-12f298c58613
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 810,
          "y": 2900
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      element_type:
        simple: ALNIC
      ref_name:
        simple: ${incident.id}_Hunt_IOC_Domain
      using:
        simple: QRadar v3_Typosquat Offences
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Creates a new reference set.
      id: aa7aa4ea-ce73-4d18-8735-6561c1dfd24b
      iscommand: true
      name: Create Domain Reference Set
      script: QRadar v3|||qradar-reference-set-create
      type: regular
      version: -1
    taskid: aa7aa4ea-ce73-4d18-8735-6561c1dfd24b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 3150
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: ${incident.id}_Hunt_IOC_Domain
      value:
        simple: ${inputs.DomainTest}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Add or update a value in a reference set.
      id: 1acf135d-57b1-42c3-8e9d-e687902bcde9
      iscommand: true
      name: Add Domain To Reference Set
      script: QRadar_v2_copy|||qradar-create-reference-set-value
      type: regular
      version: -1
    taskid: 1acf135d-57b1-42c3-8e9d-e687902bcde9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 3340
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AQLDomainSearchDestination
      value:
        simple: select QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as
          'Log Source',"eventCount" as 'Event Count',"startTime" as 'Time',categoryname(category)
          as 'Low Level Category',"sourceIP" as 'Source IP',"sourcePort" as 'Source
          Port',"destinationIP" as 'Destination IP',"destinationPort" as 'Destination
          Port',"userName" as 'Username',SUM("eventCount") AS 'AggregatedCount' from
          events where ( referencesetcontains('${incident.id}_Hunt_IOC_Domain', "BC_ParentDomain")
          AND "deviceType"='331' ) GROUP BY BC_ParentDomain last 30 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f02c909f-e105-43f2-8faf-d5142eb1e5c6
      iscommand: false
      name: Create Domain Search in Destination AQL
      script: Set
      type: regular
      version: -1
    taskid: f02c909f-e105-43f2-8faf-d5142eb1e5c6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 3520
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: ${AQLDomainSearchDestination}
      timeout:
        simple: "100000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 9ea75eb8-34de-4163-8a07-4b127ddfdb9a
      iscommand: false
      name: QRadarFullSearch - Destination
      playbookId: QRadarFullSearch
      type: playbook
      version: -1
    taskid: 9ea75eb8-34de-4163-8a07-4b127ddfdb9a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 810,
          "y": 3695
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: QRadar.Search.Result.events
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "47"
      "yes":
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 405b67a7-d972-4734-8a45-175cc2646a6a
      iscommand: false
      name: Did Search Yield Results ?
      type: condition
      version: -1
    taskid: 405b67a7-d972-4734-8a45-175cc2646a6a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 810,
          "y": 3880
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        complex:
          accessor: events}
          root: ${QRadar.Search.Result
      fileName:
        simple: Presence of Domain IOC.csv
      headers:
        simple: Destination IP,Destination Port,Event Count,Event Name,Log Source,Low
          Level Category,Magnitude,Source IP,Source Port,Time
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 3ea66175-71e5-482d-88a4-0249e574f239
      iscommand: false
      name: Create Report For Presence of IOC in Destination
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 3ea66175-71e5-482d-88a4-0249e574f239
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 4095
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: QRadar.Search
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 35325992-faf0-417a-8c42-9b160fcfadb4
      iscommand: false
      name: Delete Context 'QRadar.Search'
      script: DeleteContext
      type: regular
      version: -1
    taskid: 35325992-faf0-417a-8c42-9b160fcfadb4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 4270
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: ${incident.id}_Hunt_IOC_Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_v2_copy
      description: Deletes a reference set corresponding to the name provided.
      id: 9ae2d315-0776-48a4-8ce6-74c30fedd3e7
      iscommand: true
      name: Delete Domain Reference Set
      script: QRadar_v2_copy|||qradar-delete-reference-set
      type: regular
      version: -1
    taskid: 9ae2d315-0776-48a4-8ce6-74c30fedd3e7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 4450
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: QRadar.Search
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 6e751b8b-db1b-4178-8c3b-afac99d591c2
      iscommand: false
      name: Delete Context 'QRadar.Search'
      script: DeleteContext
      type: regular
      version: -1
    taskid: 6e751b8b-db1b-4178-8c3b-afac99d591c2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": 2150
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.DomainTest
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 676a55a4-5507-40f3-8fa6-c8b7a4fa47ec
      iscommand: false
      name: Is Domain Test Context Defined ?
      type: condition
      version: -1
    taskid: 676a55a4-5507-40f3-8fa6-c8b7a4fa47ec
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 550,
          "y": 2350
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          accessor: Domain_Test_
          root: ExtractedIndicators
          transformers:
          - args:
              chars:
                value:
                  simple: www.
            operator: StripChars
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3e0a9b01-e3b3-4d08-85ce-f5f638ed4b86
      iscommand: false
      name: Set Extracted Indicators Context (Strip www. & Unique)
      script: Set
      type: regular
      version: -1
    taskid: 3e0a9b01-e3b3-4d08-85ce-f5f638ed4b86
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 550,
          "y": 2615
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "18_30_yes": 0.55,
      "31_1_yes": 0.55,
      "50_51_yes": 0.49
    },
    "paper": {
      "dimensions": {
        "height": 5245,
        "width": 2330,
        "x": 50,
        "y": -700
      }
    }
  }
