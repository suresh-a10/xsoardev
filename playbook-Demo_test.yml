contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: befbbcec-375b-4c79-8451-a34339f0e578
inputs: []
name: Demo test
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ee24e5c0-8a68-4475-8c21-9e2fd9db1aff
      iscommand: false
      name: ""
      version: -1
    taskid: ee24e5c0-8a68-4475-8c21-9e2fd9db1aff
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 65
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostData
      value:
        simple: |-
          {
          "Hostname":"Test123",
          "IPAddress":"1.2.3.4",
          "Asset Category": "IT"
          }
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8f85ba04-8bd6-464e-82cf-d23d8f6eefe0
      iscommand: false
      name: set Context
      script: Set
      type: regular
      version: -1
    taskid: 8f85ba04-8bd6-464e-82cf-d23d8f6eefe0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 400
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 2
    scriptarguments:
      data:
        simple: ${HostData}
      title:
        simple: Host Details
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 626cfe7b-338a-464f-899e-92ed79d5634e
      iscommand: false
      name: To Table
      script: ToTable
      tags:
      - Host Details
      type: regular
      version: -1
    taskid: 626cfe7b-338a-464f-899e-92ed79d5634e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 575
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 3fc1dc00-1858-4314-8cfb-392cc9c12a5b
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 3fc1dc00-1858-4314-8cfb-392cc9c12a5b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 225
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 2
    scriptarguments:
      body:
        simple: '{"pageSize":100,"categories":["attachments"],"tags":[],"notCategories":[],"notTags":[]}'
      uri:
        simple: /investigation/{incidentID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Core REST API
      description: send HTTP POST request
      id: ffb9f9a3-b104-414f-80d6-7c3e0e6fbcd0
      iscommand: true
      name: Get Attachment Entry IDS
      script: Core REST API|||demisto-api-post
      type: regular
      version: -1
    taskid: ffb9f9a3-b104-414f-80d6-7c3e0e6fbcd0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 602.5,
          "y": 50
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      uri:
        simple: /incident/1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Core REST API
      description: send HTTP GET requests
      id: bb8b375a-a10c-4e17-817d-f53b74cc730b
      iscommand: true
      name: Create new Indicator
      script: Core REST API|||demisto-api-get
      type: regular
      version: -1
    taskid: bb8b375a-a10c-4e17-817d-f53b74cc730b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 602.5,
          "y": 225
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: true
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: "300"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sleep for X seconds
      id: bb1122bc-6016-48fb-8c7b-421032c52e03
      iscommand: false
      name: Sleep
      script: Sleep
      type: regular
      version: -1
    taskid: bb1122bc-6016-48fb-8c7b-421032c52e03
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 110,
          "y": 1690
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      commandstatus:
        simple: Running
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 0b3e76a2-2c81-451d-8c82-0120317167ca
      iscommand: true
      name: Set Command Status field to Running
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 0b3e76a2-2c81-451d-8c82-0120317167ca
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 540,
          "y": 1650
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 2
    scriptarguments:
      extend-context:
        simple: IncidentData=.Contents.data={"ID":val.id,"CommandStatus":val.CustomFields.commandstatus}
      fromdate:
        simple: 3 days ago
      ignore-outputs:
        simple: "false"
      query:
        simple: type:Manual and commandstatus:Running
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Searches Demisto incidents. A summarized version of this scrips is avilable with the summarizedversion argument.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: dad11bca-b51c-4817-8233-91f86d1e20de
      iscommand: false
      name: Search Incidents
      script: SearchIncidentsV2
      type: regular
      version: -1
    taskid: dad11bca-b51c-4817-8233-91f86d1e20de
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 750
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: IncidentData.CommandStatus
          operator: isEqualString
          right:
            value:
              simple: Running
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      - "10"
      "yes":
      - "15"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ae9072dd-54b9-477a-81b5-cd55e3c79618
      iscommand: false
      name: Check the commandstatus
      type: condition
      version: -1
    taskid: ae9072dd-54b9-477a-81b5-cd55e3c79618
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 935
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      uri:
        simple: /investigation/${incident.id}/pause
    separatecontext: false
    skipunavailable: false
    task:
      brand: Core REST API
      description: send HTTP POST request.
      id: 8be9d05f-0489-4ac5-8ea6-b21be8b24a45
      iscommand: true
      name: Pause the playbook execution
      script: Core REST API|||demisto-api-post
      type: regular
      version: -1
    taskid: 8be9d05f-0489-4ac5-8ea6-b21be8b24a45
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -750,
          "y": 1410
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${foundIncidents.id}
      listName:
        simple: PauseIncidents
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: f79e287c-4783-4383-8cce-5e6b2a1d2139
      iscommand: true
      name: Update the list with Incident ID to be paused
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: f79e287c-4783-4383-8cce-5e6b2a1d2139
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1630,
          "y": 1140
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      commandstatus:
        simple: Pause
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 413baff7-989e-4747-8974-42a773c64e43
      iscommand: true
      name: Set Command Status to Pause
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 413baff7-989e-4747-8974-42a773c64e43
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -750,
          "y": 1030
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${incident.id}
      listName:
        simple: PauseIncidents
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: 140560fd-7f54-4567-8ac8-189d5304a53f
      iscommand: true
      name: Add the incident to PauseIncidents List
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: 140560fd-7f54-4567-8ac8-189d5304a53f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -750,
          "y": 1200
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      commandstatus:
        simple: Completed
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8efb5ac4-0cdf-4a29-8374-0b234e4bdff5
      iscommand: true
      name: Set Command Status to Completed
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8efb5ac4-0cdf-4a29-8374-0b234e4bdff5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 110,
          "y": 1890
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1935,
        "width": 2612.5,
        "x": -1630,
        "y": 50
      }
    }
  }
