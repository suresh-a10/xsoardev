contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: befbbcec-375b-4c79-8451-a34339f0e578
inputs: []
name: Demo test
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4e959e4d-6815-40b8-8c79-22bf568fb616
      iscommand: false
      name: ""
      version: -1
    taskid: 4e959e4d-6815-40b8-8c79-22bf568fb616
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 65
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: HostData
      value:
        simple: |-
          {
          "Hostname":"Test123",
          "IPAddress":"1.2.3.4",
          "Asset Category": "IT"
          }
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 483d9d45-a524-420e-8205-b5117ea161b5
      iscommand: false
      name: set Context
      script: Set
      type: regular
      version: -1
    taskid: 483d9d45-a524-420e-8205-b5117ea161b5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 400
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 2
    scriptarguments:
      data:
        simple: ${HostData}
      title:
        simple: Host Details
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 1ec19379-850d-4f95-8167-dd77dee4f840
      iscommand: false
      name: To Table
      script: ToTable
      tags:
      - Host Details
      type: regular
      version: -1
    taskid: 1ec19379-850d-4f95-8167-dd77dee4f840
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 575
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 91da8518-6886-4464-8fe7-79d24d4d032d
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 91da8518-6886-4464-8fe7-79d24d4d032d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 225
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 2
    scriptarguments:
      body:
        simple: '{"pageSize":100,"categories":["attachments"],"tags":[],"notCategories":[],"notTags":[]}'
      uri:
        simple: /investigation/{incidentID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Core REST API
      description: send HTTP POST request
      id: 23a7fce1-f612-4f31-8994-7b62ee46f137
      iscommand: true
      name: Get Attachment Entry IDS
      script: Core REST API|||demisto-api-post
      type: regular
      version: -1
    taskid: 23a7fce1-f612-4f31-8994-7b62ee46f137
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 602.5,
          "y": 50
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      uri:
        simple: /incident/1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Core REST API
      description: send HTTP GET requests
      id: 9170be2b-818d-440c-8fcb-df54e46f04a1
      iscommand: true
      name: Create new Indicator
      script: Core REST API|||demisto-api-get
      type: regular
      version: -1
    taskid: 9170be2b-818d-440c-8fcb-df54e46f04a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 602.5,
          "y": 225
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: true
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: "300"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sleep for X seconds
      id: aabdbc1f-716b-4950-8ba7-95b580ae3aed
      iscommand: false
      name: Sleep
      script: Sleep
      type: regular
      version: -1
    taskid: aabdbc1f-716b-4950-8ba7-95b580ae3aed
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 110,
          "y": 1690
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      commandstatus:
        simple: Running
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 94311eb2-a793-4f2e-871f-12f1873b373d
      iscommand: true
      name: Set Command Status field to Running
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 94311eb2-a793-4f2e-871f-12f1873b373d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 540,
          "y": 1650
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 2
    scriptarguments:
      extend-context:
        simple: IncidentData=.Contents.data={"ID":val.id,"CommandStatus":val.CustomFields.commandstatus}
      fromdate:
        simple: 3 days ago
      ignore-outputs:
        simple: "false"
      query:
        simple: type:Manual and commandstatus:Running
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Searches Demisto incidents. A summarized version of this scrips is avilable with the summarizedversion argument.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 71408a9b-d9be-4c69-8159-2bdbfd3ff2ae
      iscommand: false
      name: Search Incidents
      script: SearchIncidentsV2
      type: regular
      version: -1
    taskid: 71408a9b-d9be-4c69-8159-2bdbfd3ff2ae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 750
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: IncidentData.CommandStatus
          operator: isEqualString
          right:
            value:
              simple: Running
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      - "10"
      "yes":
      - "15"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9f8b80f4-4d3c-4951-884f-95769561f54e
      iscommand: false
      name: Check the commandstatus
      type: condition
      version: -1
    taskid: 9f8b80f4-4d3c-4951-884f-95769561f54e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 935
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      uri:
        simple: /investigation/${incident.id}/pause
    separatecontext: false
    skipunavailable: false
    task:
      brand: Core REST API
      description: send HTTP POST request.
      id: 5c73ce03-0cb8-416c-875a-94b23c9cdfd3
      iscommand: true
      name: Pause the playbook execution
      script: Core REST API|||demisto-api-post
      type: regular
      version: -1
    taskid: 5c73ce03-0cb8-416c-875a-94b23c9cdfd3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -750,
          "y": 1410
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${foundIncidents.id}
      listName:
        simple: PauseIncidents
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: 2827771a-5292-44ad-85ad-21fd91a9f5b8
      iscommand: true
      name: Update the list with Incident ID to be paused
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: 2827771a-5292-44ad-85ad-21fd91a9f5b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1630,
          "y": 1140
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      commandstatus:
        simple: Pause
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 05de3c42-3937-498b-84d6-6a35f9709e78
      iscommand: true
      name: Set Command Status to Pause
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 05de3c42-3937-498b-84d6-6a35f9709e78
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -750,
          "y": 1030
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${incident.id}
      listName:
        simple: PauseIncidents
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: 3e20582b-0a3f-4398-8237-a61c1f146105
      iscommand: true
      name: Add the incident to PauseIncidents List
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: 3e20582b-0a3f-4398-8237-a61c1f146105
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -750,
          "y": 1200
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      commandstatus:
        simple: Completed
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: ee7f0d36-67c1-4572-8a5f-660da7a8075a
      iscommand: true
      name: Set Command Status to Completed
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ee7f0d36-67c1-4572-8a5f-660da7a8075a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 110,
          "y": 1890
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1935,
        "width": 2612.5,
        "x": -1630,
        "y": 50
      }
    }
  }
