contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: c600773c-c1e4-418d-8ad9-0c7d0fbc78ed
inputs:
- description: ""
  key: IP Address
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: IP
      root: ExtractedIndicators
name: TCS-IP Address Owner Verification_Playbook  v3.3_old_copy
outputs: []
sourceplaybookid: 10a892d4-e4b5-4b5e-80ea-dcaccb53541a
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8a7793d9-3013-4143-8931-2d278f40a551
      iscommand: false
      name: ""
      version: -1
    taskid: 8a7793d9-3013-4143-8931-2d278f40a551
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -200,
          "y": -790
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e1a76b89-ef28-44ee-8fe3-123be2031844
      iscommand: false
      name: Are there any IP addresses ?
      type: condition
      version: -1
    taskid: e1a76b89-ef28-44ee-8fe3-123be2031844
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -200,
          "y": -570
        }
      }
  "3":
    continueonerror: true
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "7"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        simple: ${lists.Microsoft Public IP Addresses}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 2181a126-38e1-4378-86e7-387f5e053e81
      iscommand: false
      name: Does IP Address Belong To Microsoft ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 2181a126-38e1-4378-86e7-387f5e053e81
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 210,
          "y": -40
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: true
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      actionnotification:
        simple: <p>Found Microsoft  IP Addresses in this file </p>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fefa9ada-9cfb-4983-878c-8ea90deaf669
      iscommand: true
      name: Send Note That Microsoft IP Address Found
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: fefa9ada-9cfb-4983-878c-8ea90deaf669
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -630,
          "y": 1500
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address.MIP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d6d8d0db-be1d-4924-8513-1b377da0071f
      iscommand: false
      name: Set Microsoft IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: d6d8d0db-be1d-4924-8513-1b377da0071f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 10,
          "y": -205
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address1.IP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d5093cdd-0736-432f-8020-a84d77a73b94
      iscommand: false
      name: Set Output into Context
      script: Set
      type: regular
      version: -1
    taskid: d5093cdd-0736-432f-8020-a84d77a73b94
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": -150
        }
      }
  "11":
    continueonerror: true
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "no":
      - "10"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        simple: ${lists.Google Public IP Addresses},${lists.Microsoft Public IP Addresses},${lists.TCS
          Public IP Addresses},${lists.MasterIOC_IP Address}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: af4ae692-b625-4f03-8e5b-4c11ecf94fde
      iscommand: false
      name: Does IP Address Belong To Microsoft, Google or TCS ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: af4ae692-b625-4f03-8e5b-4c11ecf94fde
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 390,
          "y": -510
        }
      }
  "12":
    continueonerror: true
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      - "53"
      "yes":
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        simple: ${lists.TCS Public IP Addresses}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: c606102c-04e4-42e2-8c8b-8261750df692
      iscommand: false
      name: Does IP Address Belong To TCS ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: c606102c-04e4-42e2-8c8b-8261750df692
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -880,
          "y": -310
        }
      }
  "13":
    continueonerror: true
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        simple: ${lists.Google Public IP Addresses}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: a2cd3813-82ee-40b0-88ff-cc80b4b503e9
      iscommand: false
      name: Does IP Address Belong To Google ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: a2cd3813-82ee-40b0-88ff-cc80b4b503e9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -430,
          "y": -310
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.TIP
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: Address.MIP
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              simple: Address.GIP
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5974c310-58ec-4449-8778-add0953974b6
      iscommand: false
      name: Is There a TCS IP Address ?
      type: condition
      version: -1
    taskid: 5974c310-58ec-4449-8778-add0953974b6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 240,
          "y": 1260
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address.GIP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c342fb68-c85a-4a39-881c-ce2eea1092f3
      iscommand: false
      name: Set Google IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: c342fb68-c85a-4a39-881c-ce2eea1092f3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": -110
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address.TIP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8b756300-ea42-4fb0-8d99-250bc2b3d516
      iscommand: false
      name: Set TCS IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: 8b756300-ea42-4fb0-8d99-250bc2b3d516
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -880,
          "y": -110
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.GIP
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: Address.MIP
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              simple: Address.TIP
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2665e44e-3f51-4c49-822c-e9b92c5ad8f5
      iscommand: false
      name: Is There a Google IP Address ?
      type: condition
      version: -1
    taskid: 2665e44e-3f51-4c49-822c-e9b92c5ad8f5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1260
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.MIP
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: Address.GIP
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              simple: Address.TIP
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d9eedd28-b8c1-4acd-885b-6452ffaa748b
      iscommand: false
      name: Is There a  Microsoft           IP Address ?
      type: condition
      version: -1
    taskid: d9eedd28-b8c1-4acd-885b-6452ffaa748b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -630,
          "y": 1260
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: true
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      actionnotification:
        simple: <p>Found Google  IP Addresses in this file </p>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 3cde9a34-5eec-4f7a-8284-065bdce512bb
      iscommand: true
      name: Send Note That Google IP Address Found
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 3cde9a34-5eec-4f7a-8284-065bdce512bb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 1500
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: true
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      actionnotification:
        simple: <p>Found  TCS  IP Addresses in this file </p>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 6ef2245d-431a-4adb-83ae-034918089f48
      iscommand: true
      name: Send Note That TCS IP Address Found
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6ef2245d-431a-4adb-83ae-034918089f48
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1750
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: true
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: <p>Found  Microsoft and TCS  IP Addresses in this file </p>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: ae27477c-bf92-44d6-8535-36b43e1777e7
      iscommand: true
      name: Send Note That TCS & Microsoft IP Address Found
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ae27477c-bf92-44d6-8535-36b43e1777e7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1070,
          "y": 1500
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.GIP
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: Address.TIP
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: Address.MIP
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3fa6ce2c-5189-4289-888c-f607e1cef235
      iscommand: false
      name: Is There a Google & TCS  IP Address ?
      type: condition
      version: -1
    taskid: 3fa6ce2c-5189-4289-888c-f607e1cef235
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 680,
          "y": 1260
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.GIP
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: Address.MIP
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: Address.TIP
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a53db31a-0940-4f69-885c-b8729637683a
      iscommand: false
      name: Is There a Google & Microsoft  IP Address ?
      type: condition
      version: -1
    taskid: a53db31a-0940-4f69-885c-b8729637683a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1120,
          "y": 1260
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.GIP
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: Address.MIP
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: Address.TIP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 60bebcc9-81a7-4ba6-8172-fcea9486226f
      iscommand: false
      name: Is There a Google, Microsoft & TCS  IP Address ?
      type: condition
      version: -1
    taskid: 60bebcc9-81a7-4ba6-8172-fcea9486226f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 1260
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.MIP
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: Address.TIP
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: Address.GIP
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 62865aaf-da5b-4001-88ca-59846a1a04db
      iscommand: false
      name: Is There a Microsoft & TCS  IP Address ?
      type: condition
      version: -1
    taskid: 62865aaf-da5b-4001-88ca-59846a1a04db
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1070,
          "y": 1260
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: true
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: <p>Found Google  and TCS  IP Addresses in this file </p>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 435f3d36-d037-460e-8c91-32aafcabbea9
      iscommand: true
      name: Send Note That Google & TCS IP Address Found
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 435f3d36-d037-460e-8c91-32aafcabbea9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1520
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: true
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      actionnotification:
        simple: <p>Found Google, Microsoft IP Addresses in this file </p>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: d0f47c34-b4e8-4615-86d8-0ae174cf9aa1
      iscommand: true
      name: Send Note That Google & Microsoft IP Address Found
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: d0f47c34-b4e8-4615-86d8-0ae174cf9aa1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1120,
          "y": 1500
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: true
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: Found Google, Microsoft and TCS  IP Addresses in this file
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 0a4c0e94-de1d-4566-8872-bc6f9272bb3b
      iscommand: true
      name: Send Note That Google, Microsoft & TCS IP Address Found
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 0a4c0e94-de1d-4566-8872-bc6f9272bb3b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 1490
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6e296885-81d1-4267-8d14-f48f58d30a13
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 6e296885-81d1-4267-8d14-f48f58d30a13
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 880,
          "y": 775
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7078e289-e38a-48b5-8601-14b31fb847f8
      iscommand: false
      name: Generate Report & Notify
      type: title
      version: -1
    taskid: 7078e289-e38a-48b5-8601-14b31fb847f8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1680,
          "y": 310
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.GIP
          operator: isNotExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: Address.MIP
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              simple: Address.TIP
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d1e4046b-bd1d-4ee3-8275-62bb29216d5a
      iscommand: false
      name: Verify There Are No Customer IP Addresses In The List ?
      type: condition
      version: -1
    taskid: d1e4046b-bd1d-4ee3-8275-62bb29216d5a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1560,
          "y": 1260
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: true
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      actionnotification:
        simple: <p> No Customer IP Addresses Found in this file </p>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: a92765de-18df-4cd3-8e4e-97040f15f4a6
      iscommand: true
      name: Send NoteThat No Customer IP Addresses Found
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: a92765de-18df-4cd3-8e4e-97040f15f4a6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1590,
          "y": 1520
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${Address.MIP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with an IP address.
      id: 66e89beb-f1ab-4152-8f6f-10977e42d6fc
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2|||ip
      type: regular
      version: -1
    taskid: 66e89beb-f1ab-4152-8f6f-10977e42d6fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 30,
          "y": 70
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${Address.GIP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with an IP address.
      id: 1ef7bea0-fec4-4171-8875-5641462485ce
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2|||ip
      type: regular
      version: -1
    taskid: 1ef7bea0-fec4-4171-8875-5641462485ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": 70
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
      - "53"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${Address.TIP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with an IP address.
      id: d4c2177c-532e-4c93-8bd0-0d05be0dc2f7
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2|||ip
      type: regular
      version: -1
    taskid: d4c2177c-532e-4c93-8bd0-0d05be0dc2f7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -880,
          "y": 70
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
      - "25"
      - "18"
      - "17"
      - "14"
      - "22"
      - "23"
    note: true
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${RecordedFuture.IP}
      fileName:
        simple: Risk Score.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: d8e89f4b-2f42-4953-8742-691f83f40f23
      iscommand: false
      name: Generate CSV Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: d8e89f4b-2f42-4953-8742-691f83f40f23
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1430,
          "y": 1020
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: RecordedFuture
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "35"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: debb776b-cd71-4a34-8631-cbca5e3d917a
      iscommand: false
      name: Is There a Report To Generate
      type: condition
      version: -1
    taskid: debb776b-cd71-4a34-8631-cbca5e3d917a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1680,
          "y": 775
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "49"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        complex:
          root: inputs.InternalRange
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: b27d58c3-6768-4896-8687-8b594dc0a3cc
      iscommand: false
      name: Are There Any Internal IP Addresses ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: b27d58c3-6768-4896-8687-8b594dc0a3cc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 950,
          "y": -330
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
      - "52"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: InternalAddress.IP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 062681b8-a7d5-4975-8abd-047a18d8b832
      iscommand: false
      name: Set Internal IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: 062681b8-a7d5-4975-8abd-047a18d8b832
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 950,
          "y": -120
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI did not find an IP Addresses in this file ${incident.attachment.name}.
          \nPlease check your attachment and send it again.\n\nRegards,\nCSOC CyberAutoBot"
      subject:
        simple: Found Google, Microsoft and TCS  IP Addresses in this file ${incident.attachment.name}
      to:
        complex:
          accessor: labels.Email/from
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 074273bb-61c8-4f2b-81f4-30d4445b6200
      iscommand: true
      name: Send Email Notification That Google, Microsoft & TCS IP Address Found
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 074273bb-61c8-4f2b-81f4-30d4445b6200
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2420,
          "y": 1500
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address2.IP
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Address1.IP
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: InternalAddress.IP
          root: Address1.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 052e68f5-b612-43be-8aad-9173daa94217
      iscommand: false
      name: Set Non Customer IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: 052e68f5-b612-43be-8aad-9173daa94217
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 270
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: <p>Found  Internal IP Addresses in this file </p>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 898dd344-9887-4682-8ee7-ccff3593f41b
      iscommand: true
      name: Send Note - Internal IP Addresses Found
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 898dd344-9887-4682-8ee7-ccff3593f41b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1990,
          "y": 1260
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "54"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        simple: ${lists.MasterIOC_IP Address}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 088c432c-1ab1-4fed-821a-6fcb6aee8658
      iscommand: false
      name: Are There Any IP Addresses From Master IOC?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 088c432c-1ab1-4fed-821a-6fcb6aee8658
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1330,
          "y": -310
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address.MasterIP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b08044c3-9e61-4887-8da1-8d7dc42b8b26
      iscommand: false
      name: Set Master IOC IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: b08044c3-9e61-4887-8da1-8d7dc42b8b26
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1320,
          "y": -80
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI found that below IP Addresses from the file ${incident.attachment.name}
          are already in the Master IOC list. I will not be performing any action
          on these IOCs.\n\nIP Address:\n\n${Address.MasterIP} \n\n\n\nRegards,\nCSOC
          CyberAutoBot "
      subject:
        simple: 'Found IP Address In This File ${incident.attachment.name} Already
          In Master IOC List '
      to:
        complex:
          accessor: labels.Email/from
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 649893f5-6480-45ac-8630-b67f758e3ebd
      iscommand: true
      name: Send Email Notification Found IP Address In Master IOC
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 649893f5-6480-45ac-8630-b67f758e3ebd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2470,
          "y": 1510
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "no":
      - "51"
      "yes":
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        complex:
          accessor: IP
          root: Address1
      right:
        complex:
          accessor: IP
          root: InternalAddress
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      id: f9f6de0c-2d73-49ce-854e-99686af750bd
      iscommand: false
      name: AreValuesEqual
      script: AreValuesEqual
      type: condition
      version: -1
    taskid: f9f6de0c-2d73-49ce-854e-99686af750bd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 790,
          "y": 90
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: true
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      actionnotification:
        simple: <p>All IP Address In The List Are From Private IP Address Range </p>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 0251074b-9d90-4381-85d9-e3f05fa33f23
      iscommand: true
      name: Send Note All IP Address In The List Are From Private IP Address Range
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 0251074b-9d90-4381-85d9-e3f05fa33f23
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2820,
          "y": 1180
        }
      }
  "59":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: ajit.menon@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 33ac7a45-fcde-4387-82b1-d0dc40837f97
      iscommand: false
      name: Is This Request From CSO?
      type: condition
      version: -1
    taskid: 33ac7a45-fcde-4387-82b1-d0dc40837f97
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2460,
          "y": 1320
        }
      }
  "63":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.GIP
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: Address.TIP
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: Address.MIP
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: ajit.menon@tcs.com
      - - left:
            iscontext: true
            value:
              simple: Address.ZIP
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "64"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 00d9e143-f4cd-4bac-8f8e-46664989ea81
      iscommand: false
      name: Is There a Zscaler IP Address ?
      type: condition
      version: -1
    taskid: 00d9e143-f4cd-4bac-8f8e-46664989ea81
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3300,
          "y": 1275
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${.=val.File.filter(function(f){return f.EntryID;}).reduce(function(acc,
          f) {return f;}, null).EntryID}
      body:
        simple: "Hello Human,\n\nI found TCS and Google IP Addresses in this file
          ${incident.attachment.name}. \nPFA Risk Score report.\n\nTCS:\n\n${Address.TIP}
          \n\nGoogle:\n\n${Address.GIP}\n\n\nRegards,\nCSOC CyberAutoBot"
      subject:
        simple: Found TCS and Google IP Addresses in this file ${incident.attachment.name}
      to:
        complex:
          accessor: labels.Email/from
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 6a63cced-bf26-4935-8c30-3458c69db609
      iscommand: true
      name: Send Email Notification That Zscaler IP Address Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 6a63cced-bf26-4935-8c30-3458c69db609
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3300,
          "y": 1500
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: dc065623-5941-4d83-83a7-52bc30de7d8b
      iscommand: false
      name: Delete Extracted IP Indicator
      script: DeleteContext
      type: regular
      version: -1
    taskid: dc065623-5941-4d83-83a7-52bc30de7d8b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 460
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators.IP
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Address1.IP
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: InternalAddress.IP
          root: Address1.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: de6a7641-e75f-4dc8-8866-349ac5787e85
      iscommand: false
      name: Set Non Customer IP Address into Extract Indicator IP Context
      script: Set
      type: regular
      version: -1
    taskid: de6a7641-e75f-4dc8-8866-349ac5787e85
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 650
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "14_20_yes": 0.71
    },
    "paper": {
      "dimensions": {
        "height": 2635,
        "width": 6100,
        "x": -2420,
        "y": -790
      }
    }
  }
