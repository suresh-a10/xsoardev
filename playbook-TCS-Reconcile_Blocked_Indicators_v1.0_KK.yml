contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: b9b1dabc-c507-4d09-8c84-032dadf6379d
inputs: []
name: TCS-Reconcile Blocked Indicators v1.0_KK
outputs: []
sourceplaybookid: 3a37bf98-d8e9-4ab9-8889-dba63691e69c
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 06c6c5de-c191-4abb-8233-4b941c7680cd
      iscommand: false
      name: ""
      version: -1
    taskid: 06c6c5de-c191-4abb-8233-4b941c7680cd
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -300,
          "y": 170
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "36000000"
      retry-count:
        simple: "3"
      retry-interval:
        simple: "20"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets the IP risk list as a CSV file from Recorded Future.
      id: a4e36594-d409-4e42-81e9-44e98f0a9fc1
      iscommand: true
      name: Fetch recorded future IP risk list via Integration
      script: Recorded Future v2.1|||recorded-future-get-ip-risklist
      type: regular
      version: -1
    taskid: a4e36594-d409-4e42-81e9-44e98f0a9fc1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 380
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: ip_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: ip
      threshold:
        simple: "65"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8a5aac11-d4ae-4bd9-85d3-b1deb23f4e6c
      iscommand: false
      name: Retrieve IPs with reputation >=65 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: 8a5aac11-d4ae-4bd9-85d3-b1deb23f4e6c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -300,
          "y": 555
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_ip.csv
          root: File
      extend-context:
        simple: extractedIPList=FileData
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: fad08deb-0955-415a-82c3-d8faf7243e84
      iscommand: false
      name: Read extracted list (only IP Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: fad08deb-0955-415a-82c3-d8faf7243e84
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 900
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 911834b2-f70d-4ca6-8aa5-4e833c7d5c22
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 911834b2-f70d-4ca6-8aa5-4e833c7d5c22
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 370,
          "y": 2740
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
      listName:
        simple: RecordedFutureIPRiskList
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 3659b698-acff-47f1-8c0e-56ee084d8fd4
      iscommand: true
      name: Overwrite Recorded Future IPRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 3659b698-acff-47f1-8c0e-56ee084d8fd4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1070
        }
      }
  "49":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: "Yes"
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "Yes":
      - "21"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 02e0485f-c3ca-45f0-8378-55dc2501684a
      iscommand: false
      name: Are there any IP's with replutation >=65?
      type: condition
      version: -1
    taskid: 02e0485f-c3ca-45f0-8378-55dc2501684a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -300,
          "y": 720
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "43200"
      extend-context:
        simple: indicator.ip=value
      ignore-outputs:
        simple: "true"
      query:
        simple: tags:csocblockedip and expirationStatus:active
      retry-count:
        simple: "3"
      size:
        simple: "200000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: d12f8ef5-d4a8-4f27-8d8e-300a85d76310
      iscommand: true
      name: Fetch Indicators With CSOC Tag
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: d12f8ef5-d4a8-4f27-8d8e-300a85d76310
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1440
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${TaggedIndicator}
      right:
        simple: ${RFSCORE65}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 196a1b1e-9330-4870-8e4c-c9d8909c03c7
      iscommand: false
      name: Compare Context 'Extracted Indicator' and 'Indicator.Ip'
      script: CompareLists
      type: regular
      version: -1
    taskid: 196a1b1e-9330-4870-8e4c-c9d8909c03c7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1780
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RFSCORE65
      value:
        complex:
          root: FileData
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b2269509-ef48-4881-83bc-4cbce214c7cd
      iscommand: false
      name: Set IP Risk List Into Context
      script: Set
      type: regular
      version: -1
    taskid: b2269509-ef48-4881-83bc-4cbce214c7cd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1265
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TaggedIndicator
      value:
        complex:
          accessor: ip
          root: indicator
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5e7d182a-884c-4c83-8b7e-15ae3e9ac28b
      iscommand: false
      name: Set Tagged Indictor In Context
      script: Set
      type: regular
      version: -1
    taskid: 5e7d182a-884c-4c83-8b7e-15ae3e9ac28b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1605
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "67"
      - "68"
    note: false
    quietmode: 2
    scriptarguments:
      execution-timeout:
        simple: "100000"
      indicatorsValues:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: ee2596b2-ed5d-495d-8cf7-529aa58eb7fd
      iscommand: true
      name: Expire Indicator With CSOC Tag With Risk Score < 65
      script: Builtin|||expireIndicators
      type: regular
      version: -1
    taskid: ee2596b2-ed5d-495d-8cf7-529aa58eb7fd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 2140
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 0db275f8-5e1a-407a-8e0e-8b86ca9ef771
      iscommand: true
      name: Close Automation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 0db275f8-5e1a-407a-8e0e-8b86ca9ef771
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 2935
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 68eef6b5-682c-436d-8157-618034193d38
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 68eef6b5-682c-436d-8157-618034193d38
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 370,
          "y": 3170
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 986fcf8d-13c6-4853-8bcf-ba074a7bdaa5
      iscommand: false
      name: Is  There An Indicator To Expire ?
      type: condition
      version: -1
    taskid: 986fcf8d-13c6-4853-8bcf-ba074a7bdaa5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1945
        }
      }
  "67":
    continueonerror: true
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes the specified IP addresses from the allow list.
      id: 8c52e560-c7c7-41a7-8393-2280bb649493
      iscommand: true
      name: Unblock IP From Corp Zscaler
      script: Zscaler|||zscaler-undo-blacklist-ip
      type: regular
      version: -1
    taskid: 8c52e560-c7c7-41a7-8393-2280bb649493
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 100,
          "y": 2340
        }
      }
  "68":
    continueonerror: true
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes the specified IP addresses from the allow list.
      id: e5710cce-1dc8-4717-820e-4c8c75d16cf1
      iscommand: true
      name: Unblock IP From BPS Zscaler
      script: Zscaler|||zscaler-undo-blacklist-ip
      type: regular
      version: -1
    taskid: e5710cce-1dc8-4717-820e-4c8c75d16cf1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": 2340
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "49_21_Yes": 0.51,
      "49_24_#default#": 0.1
    },
    "paper": {
      "dimensions": {
        "height": 3065,
        "width": 1330,
        "x": -300,
        "y": 170
      }
    }
  }
