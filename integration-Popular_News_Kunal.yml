category: Utilities
commonfields:
  id: Popular News_Kunal
  version: -1
configuration:
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: Popular News integration fetches from three sources of news - Threatpost,
  The Hacker News and Krebs on Security. It outputs the title, links of the news articles
  and other metadata as a markdown table. The integration commands can either fetch
  the news from one source or all sources at a time.
detaileddescription: |-
  ### Community Contributed Integration
   #### Integration Author: Vibhu Bharadwaj
   No support or maintenance is provided by the author. Customers are encouraged to engage with the user community for questions and guidance at the [Cortex XSOAR Live Discussions](https://live.paloaltonetworks.com/t5/cortex-xsoar-discussions/bd-p/Cortex_XSOAR_Discussions).
  ***
  #### Integration Author: Vibhu Bharadwaj
  No support or maintenance is provided by the author. Customers are encouraged to engage with the user community for questions and guidance at the [Cortex XSOAR Live Discussions](https://live.paloaltonetworks.com/t5/cortex-xsoar-discussions/bd-p/Cortex_XSOAR_Discussions).
  ***
  [View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/popular-news)
display: Popular News_Kunal
image: data:image/png;base64,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
name: Popular News_Kunal
script:
  commands:
  - arguments: []
    description: Get News from KrebsOnSecurity
    name: get-news-KrebsOnSecurity
  - arguments: []
    description: Get News from Threatpost
    name: get-news-Threatpost-Malware
  - arguments: []
    description: Get News from TheHackerNews
    name: get-news-TheHackerNews
  - arguments: []
    description: Get News from all outlets
    name: get-news-generic-all
  - arguments: []
    description: Get News from all outlets
    name: get-news-BleepingComputer
  - arguments: []
    name: get-news-CISA
  - arguments: []
    name: get-news-Threatpost-Vulnerability
  - arguments: []
    name: get-news-TheHackerNews-Vulnerabilites
  dockerimage: demisto/bs4:1.0.0.24033
  runonce: false
  script: |-
    register_module_line('Popular News', 'start', __line__())
    ### pack version: 1.0.5

    import requests
    from bs4 import BeautifulSoup


    TABLE = []
    VERIFY = demisto.params()['insecure']


    def scrape_kos():
        articles = []
        links = []
        dates = []
        response = requests.get("https://krebsonsecurity.com/", verify=VERIFY)
        soup = BeautifulSoup(response.text, "html.parser")

        for article in soup.select(".entry-title"):
            title = article.get_text().strip()
            articles.append(title)
            link = article.find('a').attrs['href']
            links.append(link)

        for date in soup.select(".adt"):
            dates.append(date.find('span').get_text().strip())

        return list(zip(articles, list(zip(links, dates))))


    def scrape_thn():
        articles = []
        links = []
        dates = []
        response = requests.get("https://thehackernews.com/search/label/Cyber%20Attack", verify=VERIFY)
        soup = BeautifulSoup(response.text, "html.parser")

        for article in soup.select(".home-title"):
            articles.append(article.get_text().strip())

        for link in soup.select(".story-link"):
            links.append(link["href"])

        for date in soup.select(".item-label"):
            date_got = date.get_text().split(",")[0][1:]  # February 23
            dates.append(date_got)

        return list(zip(articles, list(zip(links, dates))))


    def scrape_thnv():
        articles = []
        links = []
        dates = []
        response = requests.get("https://thehackernews.com/search/label/Vulnerability", verify=VERIFY)
        soup = BeautifulSoup(response.text, "html.parser")

        for article in soup.select(".home-title"):
            articles.append(article.get_text().strip())

        for link in soup.select(".story-link"):
            links.append(link["href"])

        for date in soup.select(".item-label"):
            date_got = date.get_text().split(",")[0][1:]  # February 23
            dates.append(date_got)

        return list(zip(articles, list(zip(links, dates))))


    def scrape_tpm():
        articles = []
        links = []
        dates = []
        response = requests.get("https://threatpost.com/category/malware-2/", verify=VERIFY)
        soup = BeautifulSoup(response.text, "html.parser")

        for article in soup.select('.c-card__title'):
            articles.append(article.get_text().strip())
            links.append(article.find('a').attrs['href'])

        for date in soup.select('.c-card__time'):
            dates.append(date.get_text().strip())

        return list(zip(articles, list(zip(links, dates))))

    def scrape_tpv():
        articles = []
        links = []
        dates = []
        response = requests.get("https://threatpost.com/category/vulnerabilities/", verify=VERIFY)
        soup = BeautifulSoup(response.text, "html.parser")

        for article in soup.select('.c-card__title'):
            articles.append(article.get_text().strip())
            links.append(article.find('a').attrs['href'])

        for date in soup.select('.c-card__time'):
            dates.append(date.get_text().strip())

        return list(zip(articles, list(zip(links, dates))))


    def scrape_cisa():
        articles = []
        links = []
        dates = []
        response = requests.get("https://www.cisa.gov/news-events/cybersecurity-advisories", verify=VERIFY)
        soup = BeautifulSoup(response.text, "html.parser")

        for article in soup.select(".c-teaser__title"):
            articles.append(article.get_text().strip())
            links.append(article.find('a').attrs['href'])

        for date in soup.select(".c-teaser__date"):
            dates.append(date.get_text().strip())

        return list(zip(articles, list(zip(links, dates))))


    def scrape_bc():
        articles = []
        links = []
        dates = []
        response = requests.get("https://www.bleepingcomputer.com/", verify=VERIFY)
        soup = BeautifulSoup(response.text, "html.parser")

        for article in soup.select(".bc_banner_item"):
            articles.append(article.get_text().strip())
            links.append(article.find('a').attrs['href'])

        for date in soup.select(".bc_news_date"):
            dates.append(date.get_text().strip())

        return list(zip(articles, list(zip(links, dates))))





    def aggregate(feed, source):
        for elem in feed:
            clickable_link = "[" + elem[1][0] + "](" + elem[1][0] + ")"
            TABLE.append({"Article": elem[0], "Link": clickable_link, "Date": elem[1][1], "Source": source})


    def main():
        # # The command demisto.command() holds the command sent from the user.
        if demisto.command() == 'get-news-KrebsOnSecurity':
            kos = scrape_kos()
            aggregate(kos, "Krebs on Security")
        elif demisto.command() == 'get-news-Threatpost-Malware':
            tpm = scrape_tpm()
            aggregate(tpm, "Threatpost")
        elif demisto.command() == 'get-news-Threatpost-Vulnerability':
            tpv = scrape_tpv()
            aggregate(tpv, "Threatpost")
        elif demisto.command() == 'get-news-TheHackerNews':
            thn = scrape_thn()
            aggregate(thn, "The Hacker News")
        elif demisto.command() == 'get-news-TheHackerNews-Vulnerabilites':
            thnv = scrape_thnv()
            aggregate(thnv, "The Hacker News")
        elif demisto.command() == 'get-news-BleepingComputer':
            bc  = scrape_bc()
            aggregate(bc, "BleepingComputer")
        elif demisto.command() == 'get-news-CISA':
            cisa = scrape_cisa()
            aggregate(cisa, "CISA")
        elif demisto.command() == 'test-module':
            # This is the call made when pressing the integration test button.
            test_response = requests.get("https://thehackernews.com/", verify=VERIFY)
            if str(test_response.status_code) == "200":
                demisto.results('ok')
            else:
                demisto.results(test_response)
        elif demisto.command() == 'get-news-generic-all':
            tpm = scrape_tpm()
            tpv = scrape_tpv()
            thn = scrape_thn()
            thnv = scrape_thnv()
            kos = scrape_kos()
            bc  = scrape_bc()
            cisa = scrape_cisa()
            aggregate(kos, "Krebs on Security")
            aggregate(thn, "The Hacker News")
            aggregate(tpm, "Threatpost")
            aggregate(tpv, "Threatpost")
            aggregate(bc, "BleepingComputer")
            aggregate(cisa, "CISA")
        else:
            raise NotImplementedError('Command %s was not implemented.' % demisto.command())

        result = {
            'ContentsFormat': formats['table'],
            'Type': entryTypes['note'],
            'Contents': TABLE,
            'EntryContext': {},
            'IgnoreAutoExtract': True
        }

        if TABLE:
            result['ReadableContentsFormat'] = formats['markdown']
            result['HumanReadable'] = tableToMarkdown('Your popular cybersecurity digest', TABLE, ["Article", "Link", "Date"])
            result['EntryContext'] = {"News": TABLE}

        demisto.results(result)


    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()

    register_module_line('Popular News', 'end', __line__())
  subtype: python3
  type: python
sourcemoduleid: Popular News
