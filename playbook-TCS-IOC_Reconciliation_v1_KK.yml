contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 00faa7e2-91f1-48d5-86e2-af331267ddf4
inputs: []
name: TCS-IOC Reconciliation_v1_KK
outputs: []
sourceplaybookid: 0ccb9021-ad43-4b79-8486-29194c8a9d7d
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5265d917-0f61-44b9-8c86-0b283ae55d09
      iscommand: false
      name: ""
      version: -1
    taskid: 5265d917-0f61-44b9-8c86-0b283ae55d09
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1320,
          "y": -820
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 20cb87c5-2f89-4a31-83ef-b66179c70e10
      iscommand: false
      name: Get IOC Risk Scores
      script: b15a38a4-e760-4de5-80e3-8ff23b052b78
      type: regular
      version: -1
    taskid: 20cb87c5-2f89-4a31-83ef-b66179c70e10
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": -540
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1a87fbe7-8348-4c6e-899a-ecd2041197f5
      iscommand: false
      name: Read file and Extract IOCs to Context
      script: 8ce879aa-e1fe-49a5-85f7-10a0eec2271b
      type: regular
      version: -1
    taskid: 1a87fbe7-8348-4c6e-899a-ecd2041197f5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": -690
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8ba0453b-3388-40fc-8c83-8f8e96f8debe
      iscommand: false
      name: Send report
      type: title
      version: -1
    taskid: 8ba0453b-3388-40fc-8c83-8f8e96f8debe
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 380,
          "y": 225
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2176799a-db80-484d-845a-ca7c9522c241
      iscommand: false
      name: Generate IOC Reports
      type: title
      version: -1
    taskid: 2176799a-db80-484d-845a-ca7c9522c241
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 380,
          "y": -370
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${Above65RiskList}
      fileName:
        simple: Above65RiskscoreReport.csv
      headers:
        simple: ioc,riskscore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: ecc60113-5546-4588-8d2e-27fc101d3407
      iscommand: false
      name: Generate Above 65 IOC Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: ecc60113-5546-4588-8d2e-27fc101d3407
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": -60
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Above65RiskList
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: Above65RiskList
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether the playbook's input contains at least one IP
        address.
      id: 3f395db0-951a-41fb-83ca-1923aa1d87f4
      iscommand: false
      name: Are there any  IOC >=65 ?
      type: condition
      version: -1
    taskid: 3f395db0-951a-41fb-83ca-1923aa1d87f4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 380,
          "y": -225
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: Above65RiskscoreReport.csv
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: Below65RiskscoreReport.csv
          root: File
      body:
        simple: |-
          Hello,

          IOC Reconciliation completed. Please find risk score report attached.
      cc:
        simple: CyberAutoBotGrp@tcscomprod.onmicrosoft.com
      subject:
        simple: IOC Reconciliation- Above 65 Risk Report
      to:
        simple: kunal.krushev@tcs.com,yogesh.gholap@tcs.com,nimisha.prajapati@tcs.com
      using:
        simple: EWS Mail Sender_Autobot
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: abb3a54a-6e46-48d1-89d8-d565fe2ca01d
      iscommand: true
      name: Send Notification with Report
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: abb3a54a-6e46-48d1-89d8-d565fe2ca01d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": 320
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello,

          WAF Inbound Threats Mitigated events count for ${Date} is ${QRadar.Search.Result.events.EventCount}, which has crossed the threshold limit - ${Threshold}. Kindly investigate further.

          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: kunal.krushev@tcs.com,yogesh.gholap@tcs.com,rupesh.sane@tcs.com,nimisha.prajapati@tcs.com,Shahnawaz.Kohati@tcs.com
      subject:
        simple: WAF Inbound Threats Mitigated - Threshold limit exceeded
      to:
        simple: priyadarshani.kate@tcs.com,jha.sweta1@tcs.com,sonam.bhandari@tcs.com,vaithilingam.arumugam@tcs.com,gayathri.pulla@tcs.com,prasad.kaginkar@tcs.com,samadhan.pardeshi@tcs.com
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 7e94ca22-9f70-4d7b-82df-f137325d5265
      iscommand: true
      name: Send email notification to Leads
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 7e94ca22-9f70-4d7b-82df-f137325d5265
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -580,
          "y": 160
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: Below65RiskscoreReport.csv
          root: File
      body:
        simple: |-
          Hello,

          I did not find any IOC with Risk Score >=65.
      cc:
        simple: CyberAutoBotGrp@tcscomprod.onmicrosoft.com
      subject:
        simple: IOC Reconciliation- Above 65 Risk Report
      to:
        simple: kunal.krushev@tcs.com,yogesh.gholap@tcs.com,nimisha.prajapati@tcs.com
      using:
        simple: EWS Mail Sender_Autobot
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: a421018d-6cb8-4dbc-8cfe-cb00150a2dce
      iscommand: true
      name: Send Notification For No IOC Above Risk Score 65
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: a421018d-6cb8-4dbc-8cfe-cb00150a2dce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 620,
          "y": 195
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ef801397-c2b9-4111-8023-761310550433
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
    taskid: ef801397-c2b9-4111-8023-761310550433
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 580,
          "y": 490
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${Below65RiskList}
      fileName:
        simple: Below65RiskscoreReport.csv
      headers:
        simple: ioc,riskscore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 0fce1564-40ef-4c29-8df8-01463baa7190
      iscommand: false
      name: Generate Below 65 IOC Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 0fce1564-40ef-4c29-8df8-01463baa7190
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 380,
          "y": 85
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: tags:csocblockedip and expirationStatus:active
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 178a8c14-3143-4717-8696-1f8f68c1113b
      iscommand: true
      name: Fetch CSOC Blocked Indicators
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 178a8c14-3143-4717-8696-1f8f68c1113b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": -650
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 2
    scriptarguments:
      execution-timeout:
        simple: "36000000"
      ip:
        complex:
          root: CSOCIP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with an IP address.
      id: 1267b5e0-6748-496b-8e89-12731c4dbc32
      iscommand: true
      name: get rf risk score
      script: Recorded Future v2|||ip
      type: regular
      version: -1
    taskid: 1267b5e0-6748-496b-8e89-12731c4dbc32
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": -170
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 2
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 37105c99-2d43-46a7-86d8-6fb1c878834d
      iscommand: false
      name: Read file
      script: ReadFile
      type: regular
      version: -1
    taskid: 37105c99-2d43-46a7-86d8-6fb1c878834d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": -490
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 2
    scriptarguments:
      key:
        simple: CSOCIP
      value:
        complex:
          root: FileData
          transformers:
          - operator: ParseJSON
          - args:
              field:
                value:
                  simple: value
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4e9a4149-5b6f-4bf9-8a9d-3c330a7680fe
      iscommand: false
      name: set
      script: Set
      type: regular
      version: -1
    taskid: 4e9a4149-5b6f-4bf9-8a9d-3c330a7680fe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": -330
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: RecordedFuture.IP.riskScore
          operator: greaterThan
          right:
            value:
              simple: "65"
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether the playbook's input contains at least one IP
        address.
      id: b1d07e6b-0844-4426-8384-4b70ffac379b
      iscommand: false
      name: Are there any  IOC < 65 ?
      type: condition
      version: -1
    taskid: b1d07e6b-0844-4426-8384-4b70ffac379b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 20
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Above65
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: 'RecordedFuture.IP.riskScore '
              operator: greaterThan
              right:
                value:
                  simple: "65"
          root: RecordedFuture.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 11c2f2ec-a400-4766-8287-bfd994235fb8
      iscommand: false
      name: Above 65 Score
      script: Set
      type: regular
      version: -1
    taskid: 11c2f2ec-a400-4766-8287-bfd994235fb8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1620,
          "y": 235
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Below65
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.IP.riskScore
              operator: lessThan
              right:
                value:
                  simple: "65"
          root: RecordedFuture.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2f76ad4c-7993-4046-87c1-65c116c681ff
      iscommand: false
      name: Less than 65
      script: Set
      type: regular
      version: -1
    taskid: 2f76ad4c-7993-4046-87c1-65c116c681ff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 225
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      fileName:
        simple: Below65
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 07328875-4177-4a56-895a-02c2a5e905dd
      iscommand: false
      name: Export
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 07328875-4177-4a56-895a-02c2a5e905dd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -10,
          "y": 475
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        simple: ${Below65}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: 6d9de061-4dc6-4da3-8b4f-fa1234b71c96
      iscommand: true
      name: Expire Indictor
      script: Builtin|||expireIndicators
      type: regular
      version: -1
    taskid: 6d9de061-4dc6-4da3-8b4f-fa1234b71c96
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 435
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "43200"
      extend-context:
        simple: indicator.ip=value
      ignore-outputs:
        simple: "true"
      query:
        simple: tags:csocblockedip and expirationStatus:active
      retry-count:
        simple: "3"
      size:
        simple: "20"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: dcbc1931-8157-44bc-810c-2872a3f0c947
      iscommand: true
      name: Fetch Indicators Blocked By CSOC Team
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: dcbc1931-8157-44bc-810c-2872a3f0c947
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1320,
          "y": -670
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1390,
        "width": 2580,
        "x": -580,
        "y": -820
      }
    }
  }
