contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 6ade50e3-c5a7-410e-8bb2-f026a0c12832
inputs: []
name: MasterIOC updation above 65
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 59225ff8-af6d-4a26-8699-7cbe3b2fce59
      iscommand: false
      name: ""
      version: -1
    taskid: 59225ff8-af6d-4a26-8699-7cbe3b2fce59
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 530,
          "y": -170
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "36000000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets the IP risk list as a CSV file from Recorded Future.
      id: 767e1e0e-f0dd-4058-853d-c8b5f6262372
      iscommand: true
      name: Fetch recorded future IP risk list via Integration
      script: Recorded Future v2.1|||recorded-future-get-ip-risklist
      type: regular
      version: -1
    taskid: 767e1e0e-f0dd-4058-853d-c8b5f6262372
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 225
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: ip_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: ip
      threshold:
        simple: "65"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5db88834-07bb-4de9-8c2e-79501ab585c2
      iscommand: false
      name: Retrieve IPs with reputation >=65 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: 5db88834-07bb-4de9-8c2e-79501ab585c2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 400
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${IP.Address}
      right:
        simple: ${lists.MasterIOCList_IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 2c6e1574-68d6-43a4-8731-accc36f01f6e
      iscommand: false
      name: Compare IP's
      script: CompareLists
      type: regular
      version: -1
    taskid: 2c6e1574-68d6-43a4-8731-accc36f01f6e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1100
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: IPs Exist
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      IPs Exist:
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ce94304f-ac2b-4cbf-8209-4dffea4569ff
      iscommand: false
      name: Are there any IP's with replutation >=65?
      type: condition
      version: -1
    taskid: ce94304f-ac2b-4cbf-8209-4dffea4569ff
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 575
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_ip.csv
          root: File
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ','
              toReplace:
                value:
                  simple: '""'
            operator: replace
      extend-context:
        simple: extractedIPList=FileData
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 5a9b2e29-50a4-497b-8e0f-acc048f4b38f
      iscommand: false
      name: Read extracted list (only IP Column) into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: 5a9b2e29-50a4-497b-8e0f-acc048f4b38f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 750
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ListCompare.Both
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 75d8de11-e28b-49ee-80cb-f2dd85bbd2c2
      iscommand: false
      name: "check if any ip to be add \n"
      type: condition
      version: -1
    taskid: 75d8de11-e28b-49ee-80cb-f2dd85bbd2c2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1275
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${ListCompare.Both}
      listName:
        simple: p3
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: 24d22d5a-69c6-4b0d-8362-35f5c38b396d
      iscommand: true
      name: 'creating list with both ips '
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: 24d22d5a-69c6-4b0d-8362-35f5c38b396d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 1520
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d1370f1c-f1a0-49bb-8a06-d694b20e2258
      iscommand: false
      name: Close Incident
      type: title
      version: -1
    taskid: d1370f1c-f1a0-49bb-8a06-d694b20e2258
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 120,
          "y": 1800
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 76747def-3ef2-4f8e-8376-f8b0754ba722
      iscommand: false
      name: OnDemand Risk Score Check_copy
      playbookId: 447ecb6e-2439-4a42-8129-71f6c1ea2142
      type: playbook
      version: -1
    taskid: 76747def-3ef2-4f8e-8376-f8b0754ba722
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 925
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 11f791ef-bcd4-4b36-8a8e-07cf666bbd23
      iscommand: false
      name: Download Recorded Future Hash List and Save to Demisto Lists
      type: title
      version: -1
    taskid: 11f791ef-bcd4-4b36-8a8e-07cf666bbd23
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 115
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "72000000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets the hash risk list from Recorded Future.
      id: c27043db-e5a2-4aa9-861d-c24c6a4d35e7
      iscommand: true
      name: Fetch recorded future Hash risk list via Integration
      script: Recorded Future v2.1|||recorded-future-get-hash-risklist
      type: regular
      version: -1
    taskid: c27043db-e5a2-4aa9-861d-c24c6a4d35e7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 275
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: hash_risk_list.csv
          root: InfoFile
      extend-context:
        simple: CSVReputationToList.count=HashAddressCount
      ioc_type:
        simple: hash
      threshold:
        simple: "65"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5dfb845b-44aa-4a3d-83bc-48ab33324771
      iscommand: false
      name: Retrieve Hashs with reputation > =65 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: 5dfb845b-44aa-4a3d-83bc-48ab33324771
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 450
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: Hashs Exist
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Hashs Exist:
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1b0b8f34-b9db-4e4c-8cfc-d3e321986736
      iscommand: false
      name: Are there any Hashs witth replutation >=65?
      type: condition
      version: -1
    taskid: 1b0b8f34-b9db-4e4c-8cfc-d3e321986736
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 625
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_hash.csv
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f6503a95-4a31-42f9-8e9e-8f76585ee5db
      iscommand: false
      name: Read extracted list (only HASH Column) into context key
      script: 329e9c72-53ce-4dc2-8fd2-23cb51526a05
      type: regular
      version: -1
    taskid: f6503a95-4a31-42f9-8e9e-8f76585ee5db
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 800
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[a-fA-F\d]{32}\b
            operator: RegexExtractAll
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      listName:
        simple: RecordedFutureHashRiskList-MD5
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 02ab3da2-143e-4e28-8995-b83beb9e96db
      iscommand: true
      name: Overwrite Recorded Future MD5 HashRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 02ab3da2-143e-4e28-8995-b83beb9e96db
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 950
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[a-fA-F\d]{40}\b
            operator: RegexExtractAll
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      listName:
        simple: RecordedFutureHashRiskList-SHA1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: b4444e81-5b03-4a95-8790-7ba3a6bcf621
      iscommand: true
      name: Overwrite Recorded Future SHA1 HashRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: b4444e81-5b03-4a95-8790-7ba3a6bcf621
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 1150
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: ${FileData}
          transformers:
          - operator: LastArrayElement
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[a-fA-F\d]{64}\b
            operator: RegexExtractAll
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      listName:
        simple: RecordedFutureHashRiskList-SHA256
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 74721328-6a29-43c6-8bf8-9b4490805ff4
      iscommand: true
      name: Overwrite Recorded Future SHA256 HashRiskList List with new CSV
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 74721328-6a29-43c6-8bf8-9b4490805ff4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 1315
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4143f379-eaca-4f45-85ca-31f2ba23c3a2
      iscommand: false
      name: Download Recorded Future Domain List and Save to Demisto Lists
      type: title
      version: -1
    taskid: 4143f379-eaca-4f45-85ca-31f2ba23c3a2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 560,
          "y": 115
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "72000000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets the domain risk list as a CSV file from Recorded Future.
      id: 71380d10-8157-426e-8c67-c33bf8037de3
      iscommand: true
      name: Fetch recorded future Domain risk list via Integration
      script: Recorded Future v2.1|||recorded-future-get-domain-risklist
      type: regular
      version: -1
    taskid: 71380d10-8157-426e-8c67-c33bf8037de3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 570,
          "y": 220
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: domain_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: domain
      threshold:
        simple: "65"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 88fc7858-8a01-4dce-816d-81aa403c219c
      iscommand: false
      name: Retrieve Domains with reputation >=65 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: 88fc7858-8a01-4dce-816d-81aa403c219c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 580,
          "y": 370
        }
      }
  "41":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: Domains Exist
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Domains Exist:
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3d900827-2062-4222-899c-9b76bb3ef186
      iscommand: false
      name: Are there any Domains with reputation >=65?
      type: condition
      version: -1
    taskid: 3d900827-2062-4222-899c-9b76bb3ef186
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 580,
          "y": 530
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_domain.csv
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0c2b8274-9570-4e29-82c0-30726353307c
      iscommand: false
      name: Read extracted list (only Domain Column) into context key
      script: 329e9c72-53ce-4dc2-8fd2-23cb51526a05
      type: regular
      version: -1
    taskid: 0c2b8274-9570-4e29-82c0-30726353307c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 580,
          "y": 690
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${IOC.Domain_Test_}
      right:
        simple: ${lists.MasterIOCList_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 761be906-4d60-40a4-8ea6-e808e5cc3356
      iscommand: false
      name: Compare IP's
      script: CompareLists
      type: regular
      version: -1
    taskid: 761be906-4d60-40a4-8ea6-e808e5cc3356
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 590,
          "y": 885
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ListCompare.Both
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "58"
      "yes":
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 007064c5-6c32-40ea-8b12-2c7a40c1b88f
      iscommand: false
      name: "check if any ip to be add \n"
      type: condition
      version: -1
    taskid: 007064c5-6c32-40ea-8b12-2c7a40c1b88f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 590,
          "y": 1100
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${ListCompare.Both}
      listName:
        simple: DomainTest
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: b1cef9b1-3712-48a9-82a0-b704037769a2
      iscommand: true
      name: 'creating list with both ips '
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: b1cef9b1-3712-48a9-82a0-b704037769a2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 590,
          "y": 1275
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f56dd6aa-2846-4124-8300-f825fdec1a7e
      iscommand: false
      name: Download Recorded Future URL List and Save to Demisto Lists
      type: title
      version: -1
    taskid: f56dd6aa-2846-4124-8300-f825fdec1a7e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 980,
          "y": 115
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "72000000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets the URL risk list as a CSV file from Recorded Future.
      id: 30807406-761a-4bd9-8278-09d2e8a32164
      iscommand: true
      name: Fetch recorded future URL risk list via Integration
      script: Recorded Future v2.1|||recorded-future-get-url-risklist
      type: regular
      version: -1
    taskid: 30807406-761a-4bd9-8278-09d2e8a32164
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1000,
          "y": 220
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: isEqualString
              right:
                value:
                  simple: url_risk_list.csv
          root: InfoFile
      ioc_type:
        simple: url
      threshold:
        simple: "65"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5f3e11e2-2dc7-4a5f-878f-c75e24049910
      iscommand: false
      name: Retrieve URLs with reputation >=65 and add to a CSV file
      script: 40fd8ee0-fb65-4904-8f41-b67431f89af9
      type: regular
      version: -1
    taskid: 5f3e11e2-2dc7-4a5f-878f-c75e24049910
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1000,
          "y": 370
        }
      }
  "49":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: count
                root: CSVReputationToList
                transformers:
                - operator: LastArrayElement
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: URLs Exist
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      URLs Exist:
      - "50"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5c1c6804-f0b8-4f53-837c-1781d386ae45
      iscommand: false
      name: Are there any URLs with replutation >=65?
      type: condition
      version: -1
    taskid: 5c1c6804-f0b8-4f53-837c-1781d386ae45
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1000,
          "y": 530
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: reduced_csv_url.csv
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9972abd6-5ea1-4e22-876c-863a2db0f7a8
      iscommand: false
      name: Read extracted list (only URL Column) into context key
      script: 329e9c72-53ce-4dc2-8fd2-23cb51526a05
      type: regular
      version: -1
    taskid: 9972abd6-5ea1-4e22-876c-863a2db0f7a8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1000,
          "y": 705
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${IOC.URL}
      right:
        simple: ${lists.MasterIOCList_URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: cf187ad1-7102-4b17-80d0-9ffb316d1d81
      iscommand: false
      name: Compare IP's
      script: CompareLists
      type: regular
      version: -1
    taskid: cf187ad1-7102-4b17-80d0-9ffb316d1d81
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 885
        }
      }
  "52":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ListCompare.Both
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "59"
      "yes":
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 158974aa-8f62-44a0-822e-493aecc2e4df
      iscommand: false
      name: "check if any ip to be add \n"
      type: condition
      version: -1
    taskid: 158974aa-8f62-44a0-822e-493aecc2e4df
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 1100
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${ListCompare.Both}
      listName:
        simple: UrlTest
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: 31812ddf-8060-4f44-845f-0f746050adba
      iscommand: true
      name: 'creating list with both ips '
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: 31812ddf-8060-4f44-845f-0f746050adba
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 1275
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${IOC.Hash}
      right:
        simple: ${lists.MasterIOCList_Hash}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: ab8dc250-9244-42e5-842c-42af90f7990d
      iscommand: false
      name: Compare IP's
      script: CompareLists
      type: regular
      version: -1
    taskid: ab8dc250-9244-42e5-842c-42af90f7990d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 980
        }
      }
  "55":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ListCompare.Both
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "60"
      "yes":
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 16498dc2-8345-4f1d-8a81-4cfa6f983a19
      iscommand: false
      name: "check if any ip to be add \n"
      type: condition
      version: -1
    taskid: 16498dc2-8345-4f1d-8a81-4cfa6f983a19
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 1160
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${ListCompare.Both}
      listName:
        simple: HashTest
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: b1b1eed1-d2a4-4b8f-89bd-da0120c7ec63
      iscommand: true
      name: 'creating list with both ips '
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: b1b1eed1-d2a4-4b8f-89bd-da0120c7ec63
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 1365
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6e13cc90-de70-4d43-8ad6-3e4f65e5ebf5
      iscommand: false
      name: Download Recorded Future IP List and Save to Demisto Lists
      type: title
      version: -1
    taskid: 6e13cc90-de70-4d43-8ad6-3e4f65e5ebf5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 100
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 486e8a90-3c10-4712-8d95-a2196f6f8804
      iscommand: false
      name: Close Incident
      type: title
      version: -1
    taskid: 486e8a90-3c10-4712-8d95-a2196f6f8804
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1480
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7b12fe07-b5d4-4b6e-87f7-eb53005ab468
      iscommand: false
      name: Close Incident
      type: title
      version: -1
    taskid: 7b12fe07-b5d4-4b6e-87f7-eb53005ab468
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 830,
          "y": 1810
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9662e1f1-5f24-46e5-83dd-58d7cdd9edc6
      iscommand: false
      name: Close Incident
      type: title
      version: -1
    taskid: 9662e1f1-5f24-46e5-83dd-58d7cdd9edc6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1450,
          "y": 1810
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "23_24_yes": 0.46
    },
    "paper": {
      "dimensions": {
        "height": 2045,
        "width": 2280,
        "x": 50,
        "y": -170
      }
    }
  }
