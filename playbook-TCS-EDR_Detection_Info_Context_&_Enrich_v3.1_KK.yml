contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: dcc07753-526b-42a3-80be-be8c894d063a
inputs: []
name: TCS-EDR Detection Info Context & Enrich v3.1_KK
outputs: []
quiet: true
sourceplaybookid: 58a33f37-14f8-4fae-8ec5-ee4d39f9ff19
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
      - "53"
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 61985788-319c-4706-87c5-83ae950fe007
      iscommand: false
      name: ""
      version: -1
    taskid: 61985788-319c-4706-87c5-83ae950fe007
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 410,
          "y": -1505
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ParentProcessID
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ParentProcessID
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 93cd153e-122f-49ce-8832-d34e4c4079a1
      iscommand: false
      name: Is There Context ParentProcessID ?
      type: condition
      version: -1
    taskid: 93cd153e-122f-49ce-8832-d34e4c4079a1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": 190
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeparentprocessid:
        complex:
          accessor: ParentProcessID
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f7b1e121-759f-41e6-87c5-74e0a9da8cd4
      iscommand: true
      name: Set Context ParentProcessID
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f7b1e121-759f-41e6-87c5-74e0a9da8cd4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 400
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: FileName
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: FileName
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f080ebf9-a9b5-41ab-8763-aa6542a525a1
      iscommand: false
      name: Is There Context FileName ?
      type: condition
      version: -1
    taskid: f080ebf9-a9b5-41ab-8763-aa6542a525a1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 190
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikefilename:
        complex:
          accessor: FileName
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: dbe1cfa8-4107-4775-8d5b-39fa89757af8
      iscommand: true
      name: Set Context FileName
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: dbe1cfa8-4107-4775-8d5b-39fa89757af8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 400
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 11d2ea63-bd66-47ec-8359-4df71080a1e7
      iscommand: false
      name: Check If There Are Any Reports
      type: title
      version: -1
    taskid: 11d2ea63-bd66-47ec-8359-4df71080a1e7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1195
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: SHA256
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: SHA256
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 486b4a81-3e9d-4575-8271-39016ba8f5a3
      iscommand: false
      name: Is There Context SHA256?
      type: condition
      version: -1
    taskid: 486b4a81-3e9d-4575-8271-39016ba8f5a3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 190
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      crowdstrikefilehash:
        complex:
          accessor: SHA256
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: '"'
            operator: split
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 0c92bbed-cd43-47df-8115-5ce29d56b6e2
      iscommand: true
      name: Set Context SHA256
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 0c92bbed-cd43-47df-8115-5ce29d56b6e2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 400
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: UserName
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: UserName
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5233ed10-89e7-4150-812d-d4ac686ada7b
      iscommand: false
      name: Is There Context UserName?
      type: condition
      version: -1
    taskid: 5233ed10-89e7-4150-812d-d4ac686ada7b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 190
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeusername:
        complex:
          accessor: UserName
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: aa13f27d-8b44-45c5-87fa-804e00c20313
      iscommand: true
      name: Set Context UserName
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: aa13f27d-8b44-45c5-87fa-804e00c20313
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 400
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LocalIP
                root: CrowdStrike.Device
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LocalIP
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fe5dfb2b-41fb-408c-8f7d-2be22b8d28af
      iscommand: false
      name: Is There Context LocalIP ?
      type: condition
      version: -1
    taskid: fe5dfb2b-41fb-408c-8f7d-2be22b8d28af
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2640,
          "y": 190
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeinternalipaddress:
        complex:
          accessor: LocalIP
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 07659c20-addc-4b11-8631-2d74b811d069
      iscommand: true
      name: Set Context LocalIP
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 07659c20-addc-4b11-8631-2d74b811d069
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2640,
          "y": 390
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ExternalIP
                root: CrowdStrike.Device
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ExternalIP
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fa6cabdd-105d-4da2-8b49-9e5de25c6d3c
      iscommand: false
      name: Is There Context ExternalIP ?
      type: condition
      version: -1
    taskid: fa6cabdd-105d-4da2-8b49-9e5de25c6d3c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3090,
          "y": 190
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikeexternalipaddress:
        complex:
          accessor: ExternalIP
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 23fb5cdf-b870-48aa-86ed-57db077b1dad
      iscommand: true
      name: Set Context ExternalIP
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 23fb5cdf-b870-48aa-86ed-57db077b1dad
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3090,
          "y": 390
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: CommandLine
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: CommandLine
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e014fd70-c418-421e-820b-201a94d67bda
      iscommand: false
      name: Is There Context CommandLine ?
      type: condition
      version: -1
    taskid: e014fd70-c418-421e-820b-201a94d67bda
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3540,
          "y": 190
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikecmdline:
        complex:
          accessor: CommandLine
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 96e7b8e2-288a-4b6b-86d3-d4091634b312
      iscommand: true
      name: 'Set Context CommandLine '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 96e7b8e2-288a-4b6b-86d3-d4091634b312
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3540,
          "y": 390
        }
      }
  "16":
    continueonerror: true
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        complex:
          accessor: crowdstrikeusername
          root: incident
      retry-count:
        simple: "1"
      using:
        simple: Active Directory Query v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a user account. The user can
        be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filter is specified, all users are returned.
      id: 4101683a-a990-4371-8d2c-91cae2cfc557
      iscommand: true
      name: Get User Information From AD
      script: Active Directory Query v2|||ad-get-user
      tags:
      - ADRESULT
      type: regular
      version: -1
    taskid: 4101683a-a990-4371-8d2c-91cae2cfc557
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 780
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: System
                root: CrowdStrike.Detection
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: System
                root: CrowdStrike.Detection
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3aea1423-f937-450a-8364-997382eeee4c
      iscommand: false
      name: Is There Context System ?
      type: condition
      version: -1
    taskid: 3aea1423-f937-450a-8364-997382eeee4c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3980,
          "y": 190
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      crowdstrikehostname:
        complex:
          accessor: System
          root: CrowdStrike.Detection
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 33e6c0e9-f9ab-43ab-8266-ac474ed68a10
      iscommand: true
      name: Set Context System
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 33e6c0e9-f9ab-43ab-8266-ac474ed68a10
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3980,
          "y": 400
        }
      }
  "19":
    continueonerror: true
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        complex:
          accessor: crowdstrikehostname
          root: incident
      retry-count:
        simple: "1"
      using:
        simple: Active Directory Query v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a computer account. The computer
        can be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filters are provided, all computers are returned.
      id: c3d26ea0-2892-4be9-8e00-621c20c5a9a1
      iscommand: true
      name: Get Computer Info From AD
      script: Active Directory Query v2|||ad-get-computer
      tags:
      - ADRESULT
      type: regular
      version: -1
    taskid: c3d26ea0-2892-4be9-8e00-621c20c5a9a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": -180
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOCValue
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOCValue
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3c50f5f6-84ad-4817-877a-d2accaf4fcb9
      iscommand: false
      name: Is There Context IOCValue
      type: condition
      version: -1
    taskid: 3c50f5f6-84ad-4817-877a-d2accaf4fcb9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4440,
          "y": 190
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Scenario
                root: CrowdStrike.Detection.Behavior
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Scenario
                root: CrowdStrike.Detection.Behavior
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 54daabb8-f664-4bd0-8523-870dcdaee2b6
      iscommand: false
      name: Is There Context Scenario
      type: condition
      version: -1
    taskid: 54daabb8-f664-4bd0-8523-870dcdaee2b6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4870,
          "y": 190
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
      - "69"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      csiocvalue:
        complex:
          accessor: IOCValue
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: InnerServicesModule
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 988cba00-ac5d-4822-823a-b54453e4d49b
      iscommand: true
      name: Set Context IOCValue
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 988cba00-ac5d-4822-823a-b54453e4d49b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4440,
          "y": 380
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: csiocvalue
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: f180ddb5-2b76-473b-8cfc-66515dcc3a5f
      iscommand: true
      name: Enrich IOC
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: f180ddb5-2b76-473b-8cfc-66515dcc3a5f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4440,
          "y": 570
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: SHA256
          root: CrowdStrike.Detection.Behavior
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 30dcdab3-5360-4587-874f-1f98ce92fbc6
      iscommand: true
      name: Enrich IOC
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 30dcdab3-5360-4587-874f-1f98ce92fbc6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 570
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      csscenario:
        complex:
          accessor: Scenario
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: InnerServicesModule
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 10b30581-5327-4c4f-8f8f-fadce889afb3
      iscommand: true
      name: Set Context Scenario
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 10b30581-5327-4c4f-8f8f-fadce889afb3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4870,
          "y": 380
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: description
                root: CrowdStrike.Detections.behaviors
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: description
                root: CrowdStrike.Detections.behaviors
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a91f5a41-c66a-4a76-8164-2a76334eb9dc
      iscommand: false
      name: Is There description ?
      type: condition
      version: -1
    taskid: a91f5a41-c66a-4a76-8164-2a76334eb9dc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 0,
          "y": 190
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      descriptionoffense:
        complex:
          accessor: description
          root: CrowdStrike.Detections.behaviors
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 809c7cbc-467b-42d0-8200-35cecc967b1d
      iscommand: true
      name: Set Context Description
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 809c7cbc-467b-42d0-8200-35cecc967b1d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 0,
          "y": 400
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tactic
                root: CrowdStrike.Detections.behaviors
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tactic
                root: CrowdStrike.Detections.behaviors
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 580575bd-7f09-44ee-8d21-1c357c5c91ad
      iscommand: false
      name: Is There tactic?
      type: condition
      version: -1
    taskid: 580575bd-7f09-44ee-8d21-1c357c5c91ad
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -440,
          "y": 190
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstriketactic:
        complex:
          accessor: tactic
          root: CrowdStrike.Detections.behaviors
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      descriptionoffense:
        complex:
          accessor: description
          root: CrowdStrike.Detections.behaviors
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: c3780693-e059-4c71-80e4-792d0bce25bc
      iscommand: true
      name: Set Context tactic
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: c3780693-e059-4c71-80e4-792d0bce25bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -440,
          "y": 400
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: technique
                root: CrowdStrike.Detections.behaviors
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: technique
                root: CrowdStrike.Detections.behaviors
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 49cb23a4-789a-4fc7-8e7b-82d2b3f56d79
      iscommand: false
      name: Is There technique?
      type: condition
      version: -1
    taskid: 49cb23a4-789a-4fc7-8e7b-82d2b3f56d79
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -880,
          "y": 190
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      crowdstriketechnique:
        complex:
          accessor: Technique
          root: CrowdStrike.Detection.Behavior
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fc66e586-3bd6-47e3-8d6f-c48e907b5a7d
      iscommand: true
      name: Set Context technique
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: fc66e586-3bd6-47e3-8d6f-c48e907b5a7d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -880,
          "y": 400
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: parent_cmdline
                root: CrowdStrike.Detections.behaviors.parent_details
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: parent_cmdline
                root: CrowdStrike.Detections.behaviors.parent_details
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e1e628a5-d644-466d-81b1-eaaeb44faf4a
      iscommand: false
      name: Is There parent_cmdline?
      type: condition
      version: -1
    taskid: e1e628a5-d644-466d-81b1-eaaeb44faf4a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1320,
          "y": 190
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      csparentcmdline:
        complex:
          accessor: parent_cmdline
          root: CrowdStrike.Detections.behaviors.parent_details
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 99324c2c-3ab4-4ecc-8d99-81847c66de62
      iscommand: true
      name: Set Context parent_cmdline
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 99324c2c-3ab4-4ecc-8d99-81847c66de62
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1320,
          "y": 400
        }
      }
  "36":
    continueonerror: true
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      retry-count:
        simple: "3"
      using:
        simple: Active Directory Query v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a user account. The user can
        be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filter is specified, all users are returned.
      id: 37fc1986-9e35-4a76-8691-808b6d2fd024
      iscommand: true
      name: Get User Information From AD
      script: Active Directory Query v2|||ad-get-user
      tags:
      - ADRESULT
      type: regular
      version: -1
    taskid: 37fc1986-9e35-4a76-8691-808b6d2fd024
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 780
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikeusername
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: '@'
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      - "59"
      - "63"
      - "67"
      "yes":
      - "36"
      - "58"
      - "62"
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a946e27f-4f19-4867-835b-57d0f07bc5bf
      iscommand: false
      name: Does The Username Contain @ ?
      type: condition
      version: -1
    taskid: a946e27f-4f19-4867-835b-57d0f07bc5bf
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 570
        }
      }
  "38":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Status
                root: WildFire.Report
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Status
                root: WildFire.Report
          operator: isEqualString
          right:
            value:
              simple: Success
      label: "yes"
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0f749307-d06f-4e66-85df-6681651f30b1
      iscommand: false
      name: Is There Context WildFire ?
      type: condition
      version: -1
    taskid: 0f749307-d06f-4e66-85df-6681651f30b1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1320
        }
      }
  "39":
    continueonerror: true
    continueonerrortype: ""
    evidencedata:
      customfields: {}
      description:
        simple: Wild Fire Report
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 2
    scriptarguments:
      sha256:
        complex:
          accessor: SHA256
          root: WildFire.Report
      using:
        simple: WildFire-v2_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: WildFire-v2
      description: Retrieves results for a file hash using WildFire.
      id: 0f7711b4-03f4-43b5-80e0-1592c7257e3a
      iscommand: true
      name: Get Wild Fire Report
      script: WildFire-v2|||wildfire-report
      tags:
      - sandboxreport
      type: regular
      version: -1
    taskid: 0f7711b4-03f4-43b5-80e0-1592c7257e3a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1550
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b75d18b3-4676-4eab-8b87-3811df28a83e
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: b75d18b3-4676-4eab-8b87-3811df28a83e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1770
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        simple: ${incident.crowdstrikecompositeid}
      retry-count:
        simple: "3"
      using:
        simple: ${incident.sourceInstance}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Search for details of specific detections, either using a filter
        query, or by providing the IDs of the detections.
      id: 7cc32c19-262c-412c-832f-f176114f4da1
      iscommand: true
      name: Fetch Detection Details CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-search-detection
      type: regular
      version: -1
    taskid: 7cc32c19-262c-412c-832f-f176114f4da1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": -1150
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        simple: ${incident.crowdstrikecompositeid}
      retry-count:
        simple: "3"
      using:
        simple: ${incident.sourceInstance}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Lists detection summaries.
      id: 78bb286d-7b45-46df-88b9-1a4ca2ca8bfe
      iscommand: true
      name: Fetch Detection Summary CrowdStrike
      script: CrowdstrikeFalcon|||cs-falcon-list-detection-summaries
      type: regular
      version: -1
    taskid: 78bb286d-7b45-46df-88b9-1a4ca2ca8bfe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": -950
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
      - "33"
      - "31"
      - "29"
      - "27"
      - "3"
      - "6"
      - "8"
      - "10"
      - "12"
      - "14"
      - "19"
      - "20"
      - "22"
      - "50"
      - "48"
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          accessor: crowdstrikehostname
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: ${incident.sourceInstance}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: 1c97a32f-90e8-4630-8985-97d48c3a1c4b
      iscommand: true
      name: Fetch Host Details
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: 1c97a32f-90e8-4630-8985-97d48c3a1c4b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": -640
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikecompositeid
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f6797409-c9f4-47bd-8ece-99b361fe575f
      iscommand: false
      name: Is There A CrowdStrike Detection ?
      type: condition
      version: -1
    taskid: f6797409-c9f4-47bd-8ece-99b361fe575f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 280,
          "y": -1350
        }
      }
  "48":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketacticid
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c660d976-c729-4168-892c-d714cf4a77b3
      iscommand: false
      name: Is There Tactic id ?
      type: condition
      version: -1
    taskid: c660d976-c729-4168-892c-d714cf4a77b3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1760,
          "y": 190
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: crowdstriketacticid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 1aa892fe-0e27-433d-8f4a-b92d291fe4ff
      iscommand: true
      name: Enrich MITRE Id
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 1aa892fe-0e27-433d-8f4a-b92d291fe4ff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1760,
          "y": 400
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketechniqueid
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aa847d56-8ab5-4f64-8ce6-a9c01b980e21
      iscommand: false
      name: Is There Technique id ?
      type: condition
      version: -1
    taskid: aa847d56-8ab5-4f64-8ce6-a9c01b980e21
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2170,
          "y": 190
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          accessor: crowdstriketechniqueid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 9242461c-80c4-4cdd-8ccf-4396c4616da1
      iscommand: true
      name: Enrich MITRE Id
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 9242461c-80c4-4cdd-8ccf-4396c4616da1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2170,
          "y": 400
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      playbookrepository:
        simple: https://tcscomprod.sharepoint.com/sites/CSOC/Shared%20Documents/Forms/AllItems.aspx?csf=1&web=1&e=KYjw1j&cid=921a35a0%2D0000%2D4c6c%2D8408%2Dba87b58b62ce&RootFolder=%2Fsites%2FCSOC%2FShared%20Documents%2FGeneral%2FInvestigation%20Steps&FolderCTID=0x0120000CB0DB63BA83C14C9572FB2178E87F0B
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: ff4975e2-6c9b-4ea0-8378-4f5e496fd148
      iscommand: true
      name: 'Set Playbook Repository Link '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ff4975e2-6c9b-4ea0-8378-4f5e496fd148
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2600,
          "y": 400
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      prioritymatrix:
        simple: |-
          <table style="height: 212px; border-style: solid; width: 658px; background-color: #ffffff;" width="658">
          <tbody>
          <tr style="height: 46px;">
          <td style="height: 92px; width: 199.688px; border-style: solid;" colspan="2" rowspan="2">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Priority</span><span style="color: #0000ff;"> Matrix</span></strong></h3>
          </td>
          <td style="height: 46px; width: 442.312px; border-style: solid;" colspan="3">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Impact</span></strong></h3>
          </td>
          </tr>
          <tr style="height: 46px;">
          <td style="height: 46px; width: 124.094px; border-style: solid;">
          <h3><strong>&nbsp;1 - High</strong></h3>
          </td>
          <td style="height: 46px; width: 120.297px; border-style: solid;">
          <h3><strong>&nbsp;2 - Medium</strong></h3>
          </td>
          <td style="height: 46px; width: 185.922px; border-style: solid;">
          <h3><strong>&nbsp;3 - Low</strong></h3>
          </td>
          </tr>
          <tr style="height: 46px;">
          <td style="height: 120px; width: 93.25px; border-style: solid;" rowspan="3">
          <h3 style="text-align: center;"><strong><span style="color: #0000ff;">Urgency</span></strong></h3>
          </td>
          <td style="height: 46px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;1 - High</strong></h3>
          </td>
          <td style="height: 46px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff0000;">0- Critical</span></strong></h3>
          </td>
          <td style="height: 46px; width: 120.297px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff9900;">1 - High</span></strong></h3>
          </td>
          <td style="height: 46px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #00ccff;">2 - Medium</span></strong></h3>
          </td>
          </tr>
          <tr style="height: 64px;">
          <td style="height: 64px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;2 - Medium</strong></h3>
          </td>
          <td style="height: 64px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #ff9900;">1 - High</span></strong></h3>
          </td>
          <td style="height: 64px; width: 120.297px; border-style: solid;">
          <h3><strong><span style="color: #00ccff;">&nbsp;2 - Medium</span></strong></h3>
          </td>
          <td style="height: 64px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<span style="color: #ff00ff;"><strong>3 - Low</strong></span></h3>
          </td>
          </tr>
          <tr style="height: 10px;">
          <td style="height: 10px; width: 100.438px; border-style: solid;">
          <h3><strong>&nbsp;3 - Low</strong></h3>
          </td>
          <td style="height: 10px; width: 124.094px; border-style: solid;">
          <h3>&nbsp;<span style="color: #00ccff;"><strong>2 - Medium</strong></span></h3>
          </td>
          <td style="height: 10px; width: 120.297px; border-style: solid;">
          <h3><span style="color: #ff00ff;">&nbsp;<strong>3 - Low</strong></span></h3>
          </td>
          <td style="height: 10px; width: 185.922px; border-style: solid;">
          <h3>&nbsp;<strong><span style="color: #339966;">4 - Informational</span></strong></h3>
          </td>
          </tr>
          </tbody>
          </table>
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8f794301-5b98-4c26-8701-13b335ae8e17
      iscommand: true
      name: Set Priority Matrix Table
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8f794301-5b98-4c26-8701-13b335ae8e17
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -3030,
          "y": 400
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: true
    quietmode: 0
    scriptarguments:
      fieldExactMatch:
        simple: incident.crowdstrikehostname
      fromDate:
        simple: 12 months ago
      similarTextField:
        simple: incident.crowdstrikehostname
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Find past similar incidents based on incident fields' similarity.
        Includes an option to also display indicators similarity.
      id: eddb711b-962d-4e40-83e9-30c69dfc5c2a
      iscommand: false
      name: Find Past Detection For Same Host
      script: DBotFindSimilarIncidents
      tags:
      - Note
      - pastevents
      type: regular
      version: -1
    taskid: eddb711b-962d-4e40-83e9-30c69dfc5c2a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 5310,
          "y": 190
        }
      }
  "57":
    continueonerror: true
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      hostname:
        complex:
          accessor: crowdstrikehostname
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: 58871248-4517-483d-88cb-54574aaf6b74
      iscommand: true
      name: Get Computer Info From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: 58871248-4517-483d-88cb-54574aaf6b74
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": 10
        }
      }
  "58":
    continueonerror: true
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      empid:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: 826ce524-d947-4a2c-8977-58f9da1df0b7
      iscommand: true
      name: Get User Information From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: 826ce524-d947-4a2c-8977-58f9da1df0b7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2570,
          "y": 780
        }
      }
  "59":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikeusername
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsGeneral
          right:
            value:
              simple: ad.
      label: "yes"
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4d2a50c4-2cc1-4912-8971-93c9f4de4f46
      iscommand: false
      name: Does The Username Contain "ad."?
      type: condition
      version: -1
    taskid: 4d2a50c4-2cc1-4912-8971-93c9f4de4f46
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 780
        }
      }
  "60":
    continueonerror: true
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      empid:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              from:
                value:
                  simple: .
            operator: substringFrom
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: 9c0933da-0904-4ab3-8639-3de4326efbbb
      iscommand: true
      name: Get User Information From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: 9c0933da-0904-4ab3-8639-3de4326efbbb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": 960
        }
      }
  "61":
    continueonerror: true
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      empid:
        complex:
          accessor: crowdstrikeusername
          root: incident
      retry-count:
        simple: "3"
      using:
        simple: Sentinel_instance
    separatecontext: false
    skipunavailable: false
    task:
      brand: Sentinel
      id: b65e9dee-bcd6-474a-84f5-58230406c5b7
      iscommand: true
      name: Get User Information From Sentinel
      script: Sentinel|||sentinel-get-details
      tags:
      - SentinelResult
      type: regular
      version: -1
    taskid: b65e9dee-bcd6-474a-84f5-58230406c5b7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 960
        }
      }
  "62":
    continueonerror: true
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      employee_id:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      retry-count:
        simple: "3"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Gurucul-GRA
      description: Get details of the user
      id: 6218dd8a-f2b1-409d-828b-2dbe04937404
      iscommand: true
      name: Get User From UEBA
      script: Gurucul-GRA|||gra-fetch-users-details
      tags:
      - userueba
      type: regular
      version: -1
    taskid: 6218dd8a-f2b1-409d-828b-2dbe04937404
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2980,
          "y": 780
        }
      }
  "63":
    continueonerror: true
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      employee_id:
        complex:
          accessor: crowdstrikeusername
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Gurucul-GRA
      description: Get details of the user
      id: b1aee5d6-bd75-4803-8caa-2c3169fe39aa
      iscommand: true
      name: Get User From UEBA
      script: Gurucul-GRA|||gra-fetch-users-details
      tags:
      - userueba
      type: regular
      version: -1
    taskid: b1aee5d6-bd75-4803-8caa-2c3169fe39aa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 780
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      emp:
        complex:
          accessor: crowdstrikeusername
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1b38bae4-e34a-49f0-89cc-6fd817cfedd0
      iscommand: false
      name: TCS-Create User Indicator & Relate To Incident v1.0
      playbookId: a8f14eae-50f0-476d-84bb-1c0d7fb01027
      type: playbook
      version: -1
    taskid: 1b38bae4-e34a-49f0-89cc-6fd817cfedd0
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 960
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      emp:
        complex:
          accessor: crowdstrikeusername
          root: incident
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1a565db0-9aed-470b-82ba-e8d53d8a03ad
      iscommand: false
      name: TCS-Create User Indicator & Relate To Incident v1.0
      playbookId: a8f14eae-50f0-476d-84bb-1c0d7fb01027
      type: playbook
      version: -1
    taskid: 1a565db0-9aed-470b-82ba-e8d53d8a03ad
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 960
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 2
    scriptarguments:
      enrichiocs:
        complex:
          accessor: csiocvalue
          root: incident
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook is designed to enrich IoCs with Gen AI Intelligence
        using Recorded Future Services
      id: 0df62e9c-2c24-43d7-8f14-2855788d111c
      iscommand: false
      name: 'Sub-Playbook: Gen AI Threat Intel Enrichment'
      playbookId: 381d8605-be6e-4715-816e-8f6f2f3c9d2a
      type: playbook
      version: -1
    taskid: 0df62e9c-2c24-43d7-8f14-2855788d111c
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 4020,
          "y": 570
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "37_36_yes": 0.47,
      "44_40_#default#": 0.1,
      "59_60_yes": 0.53
    },
    "paper": {
      "dimensions": {
        "height": 3340,
        "width": 8720,
        "x": -3030,
        "y": -1505
      }
    }
  }
