contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 22178fe9-0a50-44b0-843a-862f71d9e790
inputs: []
name: TCS-Block IOC_Analyst Reviewed_Playbook Trigger v1.0_KK_copy
outputs: []
sourceplaybookid: 0a608f75-4154-430b-81e0-3a7bc08ad2e0
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f7eb68ee-c9f6-463e-8c57-3e62f69138ce
      iscommand: false
      name: ""
      version: -1
    taskid: f7eb68ee-c9f6-463e-8c57-3e62f69138ce
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 920,
          "y": -2130
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2e022de9-3419-453c-8302-31a34eada7fa
      iscommand: false
      name: Notify IoC(s) Blocked
      type: title
      version: -1
    taskid: 2e022de9-3419-453c-8302-31a34eada7fa
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1110
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: CSOCBlockURL
      type:
        simple: URL
      value:
        simple: ${BELOWSIXFIVE.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 8283165c-96c8-417d-8ea9-1148e8c98517
      iscommand: true
      name: Tag 'CSOC' Bad URL Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 8283165c-96c8-417d-8ea9-1148e8c98517
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1130,
          "y": -110
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: Domain
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 0c900cbc-ce76-489c-8580-53b9866625bb
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 0c900cbc-ce76-489c-8580-53b9866625bb
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 680,
          "y": -180
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: URL
          root: BELOWSIXFIVE
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 9089f824-3fc8-454e-80fe-d2432f6aaca4
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 9089f824-3fc8-454e-80fe-d2432f6aaca4
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1130,
          "y": -300
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "104"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${BELOWSIXFIVE.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5e2e92ff-69a0-4621-80ff-64bf4d499f9e
      iscommand: false
      name: TCS-Add New CSOC IP Indicator v1.0_Kunal
      playbookId: e653e5ab-6658-4f7a-806d-6a79d92d5d98
      type: playbook
      version: -1
    taskid: 5e2e92ff-69a0-4621-80ff-64bf4d499f9e
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: playbook
    view: |-
      {
        "position": {
          "x": -250,
          "y": -285
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 5
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        complex:
          accessor: File
          root: BELOWSIXFIVE
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 99e6706c-ebee-45e1-800f-91aa2a2008ad
      iscommand: false
      name: TCS-CSOC Block Malicious Hash on CS v1.0_Kunal
      playbookId: 9d6b9cb3-059d-4b12-865c-f73bed1daa8a
      type: playbook
      version: -1
    taskid: 99e6706c-ebee-45e1-800f-91aa2a2008ad
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: playbook
    view: |-
      {
        "position": {
          "x": 1990,
          "y": -300
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: Domain
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 57ca563e-092e-4a12-8092-3feb7e23b3cd
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 57ca563e-092e-4a12-8092-3feb7e23b3cd
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 680,
          "y": -25
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: URL
          root: BELOWSIXFIVE
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: d41bd204-1526-47e2-8127-7904cea61cf0
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: d41bd204-1526-47e2-8127-7904cea61cf0
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1560,
          "y": -300
        }
      }
  "69":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: BELOWSIXFIVE
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b9dd8e20-c3c0-46ae-8a25-516da5f188d8
      iscommand: false
      name: Are There Any IPs For Blocking ?
      type: condition
      version: -1
    taskid: b9dd8e20-c3c0-46ae-8a25-516da5f188d8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -250,
          "y": -740
        }
      }
  "70":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: BELOWSIXFIVE
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 460187e9-8d55-4203-8ea0-b31ba4cfcd51
      iscommand: false
      name: Are There Any Domains For Blocking ?
      type: condition
      version: -1
    taskid: 460187e9-8d55-4203-8ea0-b31ba4cfcd51
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": -740
        }
      }
  "71":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: BELOWSIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "40"
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2e7c02ff-7a41-41ca-8e7a-71ebd7a6047a
      iscommand: false
      name: Are There Any URLs For Blocking ?
      type: condition
      version: -1
    taskid: 2e7c02ff-7a41-41ca-8e7a-71ebd7a6047a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1340,
          "y": -730
        }
      }
  "72":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: File
                root: BELOWSIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aa26f076-6566-4fa1-8614-8dd93609b507
      iscommand: false
      name: Are There Any Hashs For Blocking ?
      type: condition
      version: -1
    taskid: aa26f076-6566-4fa1-8614-8dd93609b507
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1990,
          "y": -730
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #ff00ff;">IoC
          65 &amp; Above Have Been Blocked</span><br /></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 5fd063e9-7487-4080-8f11-2590983af2f6
      iscommand: true
      name: Set Action Notification - IoCs Blocked
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 5fd063e9-7487-4080-8f11-2590983af2f6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1290
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f8e0b1b0-0441-4dc6-8b76-ab74ea4714e9
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: f8e0b1b0-0441-4dc6-8b76-ab74ea4714e9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1460
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "82"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #008000;">Processing
          IoC(s) For Blocking</span><br /></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: a9f24472-ccc7-428a-884c-2c6a82afe1b3
      iscommand: true
      name: Set Action Notification - Processing IoC(s) For Blocking
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: a9f24472-ccc7-428a-884c-2c6a82afe1b3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1085
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4dd9fec7-23f1-4a81-8828-6cd86fd44d96
      iscommand: false
      name: Notify Processing IoCs For Blocking
      type: title
      version: -1
    taskid: 4dd9fec7-23f1-4a81-8828-6cd86fd44d96
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1260
        }
      }
  "82":
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
      - "70"
      - "71"
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e9de8b03-8d76-4af7-8f78-2fbe7a729c6c
      iscommand: false
      name: Check Which IoC(s) 65 & Above
      type: title
      version: -1
    taskid: e9de8b03-8d76-4af7-8f78-2fbe7a729c6c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 920,
          "y": -900
        }
      }
  "83":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ISOTimeNow
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "88"
      "yes":
      - "84"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 971d856c-58d5-449e-8720-024dcd76c0b8
      iscommand: false
      name: Is ISO Time Context Set?
      type: condition
      version: -1
    taskid: 971d856c-58d5-449e-8720-024dcd76c0b8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1950
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "88"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ISOTimeNow
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 802fb7c1-1344-495e-8531-3fac659414de
      iscommand: false
      name: Delete Old Time Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 802fb7c1-1344-495e-8531-3fac659414de
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1720
        }
      }
  "88":
    continueonerrortype: ""
    id: "88"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: ISO
      dateFormat:
        simple: ISO
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: 4370354a-27bd-4635-8ee9-5dee8872088a
      iscommand: false
      name: Get Current Date
      script: GetTime
      type: regular
      version: -1
    taskid: 4370354a-27bd-4635-8ee9-5dee8872088a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1520
        }
      }
  "89":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
          operator: isEqualString
          right:
            value:
              simple: EWS v2
      label: "yes"
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "97"
      "yes":
      - "90"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b8699f08-a2f4-4471-8aaf-811939eaca8f
      iscommand: false
      name: Triggered From Email ?
      type: condition
      version: -1
    taskid: b8699f08-a2f4-4471-8aaf-811939eaca8f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 260,
          "y": -560
        }
      }
  "90":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: email
      label: Email
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      Email:
      - "92"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c2077ab7-0b3f-4c90-89b3-72b66a8edbd1
      iscommand: false
      name: Does the subject line include 'Email'?
      type: condition
      version: -1
    taskid: c2077ab7-0b3f-4c90-89b3-72b66a8edbd1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 260,
          "y": -370
        }
      }
  "91":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
          operator: isEqualString
          right:
            value:
              simple: EWS v2
      label: "yes"
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "98"
      "yes":
      - "95"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bb5f0fad-edb2-4098-84bb-c38e4a2f2f5d
      iscommand: false
      name: Triggered From Email ?
      type: condition
      version: -1
    taskid: bb5f0fad-edb2-4098-84bb-c38e4a2f2f5d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 700,
          "y": 470
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: emailblock
      type:
        simple: Domain
      value:
        simple: ${BELOWSIXFIVE.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 61816eed-f7ec-449c-8671-2fde94b007a6
      iscommand: true
      name: Tag 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 61816eed-f7ec-449c-8671-2fde94b007a6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 480
        }
      }
  "93":
    continueonerrortype: ""
    id: "93"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: CSOCBlockDomain,emailblock
      type:
        simple: Domain
      value:
        simple: ${BELOWSIXFIVE.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: c0a6394f-4a28-4f25-816a-221171b9c4a4
      iscommand: true
      name: Tag 'CSOC' and 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: c0a6394f-4a28-4f25-816a-221171b9c4a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 710,
          "y": 900
        }
      }
  "94":
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: CSOCBlockDomain
      type:
        simple: Domain
      value:
        simple: ${BELOWSIXFIVE.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: f2f1092b-366f-479d-8223-876b05e87e67
      iscommand: true
      name: Tag 'CSOC' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: f2f1092b-366f-479d-8223-876b05e87e67
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 910
        }
      }
  "95":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: internet
      label: Internet
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "93"
      Internet:
      - "94"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a221d402-08e5-4b4e-8c2d-a99479f045ac
      iscommand: false
      name: Does the subject line include 'Internet'?
      type: condition
      version: -1
    taskid: a221d402-08e5-4b4e-8c2d-a99479f045ac
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 670
        }
      }
  "96":
    continueonerrortype: ""
    id: "96"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      alert_time:
        complex:
          accessor: created
          root: incident
          transformers:
          - operator: 8726aa62-638b-41b0-8fd7-8d8892145289
          - args:
              delimiter:
                value:
                  simple: .
              fields:
                value:
                  simple: "1"
            operator: Cut
          - args:
              prefix: {}
              suffix:
                value:
                  simple: .0Z
            operator: concat
      destination_domain:
        complex:
          accessor: Domain
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      destination_url:
        simple: http://abc.com
      device_id:
        simple: abcdefghij
      device_version:
        simple: "1.0"
      retry-count:
        simple: "3"
      using:
        simple: Cisco Umbrella Enforcement Block Domain_instance,Cisco Umbrella Enforcement
          Block Domain GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Enforcement Block Domain
      description: Posts a malware event to the API for processing and optionally
        adding to a customer's domain lists.
      id: 428db383-5294-4948-8b57-d03430bbbd4f
      iscommand: true
      name: Block Domain on Cisco Umbrella (opendns)
      script: Cisco Umbrella Enforcement Block Domain|||umbrella-domain-event-add
      type: regular
      version: -1
    taskid: 428db383-5294-4948-8b57-d03430bbbd4f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 700,
          "y": 285
        }
      }
  "97":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: email only
      label: Email Only
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      Email Only:
      - "92"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d71accb5-3d4e-426a-83f4-ebeb95e72fa8
      iscommand: false
      name: ' ''Block IOC On'' Email?'
      type: condition
      version: -1
    taskid: d71accb5-3d4e-426a-83f4-ebeb95e72fa8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 680,
          "y": -380
        }
      }
  "98":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: internet only
      label: Internet Only
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "93"
      Internet Only:
      - "94"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f4fc98aa-ca6f-4873-875d-6ab55b63b32f
      iscommand: false
      name: ' ''Block IOC On'' Internet?'
      type: condition
      version: -1
    taskid: f4fc98aa-ca6f-4873-875d-6ab55b63b32f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 710,
          "y": 660
        }
      }
  "99":
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "96"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: Domain
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 3f2fb69f-b8de-4929-8549-fa3a4763695c
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 3f2fb69f-b8de-4929-8549-fa3a4763695c
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 120
        }
      }
  "100":
    continueonerrortype: ""
    id: "100"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: URL
          root: BELOWSIXFIVE
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: c85d333a-b376-4484-8be2-7f077cef848e
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: c85d333a-b376-4484-8be2-7f077cef848e
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1560,
          "y": -120
        }
      }
  "104":
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "105"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_132
      ip:
        complex:
          accessor: IP
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "3"
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 185b7cd2-8530-4022-8572-621df347ab9e
      iscommand: true
      name: 'Block IP on Zscaler Corporate '
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 185b7cd2-8530-4022-8572-621df347ab9e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": -110
        }
      }
  "105":
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_241
      ip:
        complex:
          accessor: IP
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "3"
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 27350cfd-f126-4e5e-8486-b5b3c0e9eb4a
      iscommand: true
      name: Block IP on Zscaler BPS
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 27350cfd-f126-4e5e-8486-b5b3c0e9eb4a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": 55
        }
      }
  "106":
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_57
      ip:
        complex:
          accessor: IP
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "3"
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 3e6617f5-7bff-4ddd-85a1-35cdd7845f03
      iscommand: true
      name: Block IP on Zscaler GNDM
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 3e6617f5-7bff-4ddd-85a1-35cdd7845f03
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": 225
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "69_79_#default#": 0.14,
      "70_79_#default#": 0.1,
      "71_79_#default#": 0.1,
      "72_79_#default#": 0.17,
      "89_90_yes": 0.49,
      "90_92_Email": 0.51,
      "91_98_#default#": 0.52,
      "95_94_Internet": 0.46,
      "97_39_#default#": 0.57,
      "97_92_Email Only": 0.13,
      "98_93_#default#": 0.49
    },
    "paper": {
      "dimensions": {
        "height": 3655,
        "width": 2620,
        "x": -250,
        "y": -2130
      }
    }
  }
