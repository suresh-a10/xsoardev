contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: d0467e0b-cffe-40cd-883c-dd52a89e5833
inputs: []
name: TCS-IP Address Owner Verification_Playbook  v3.3_KK
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 89177c72-f18d-41e8-85c7-08f1cdf57739
      iscommand: false
      name: ""
      version: -1
    taskid: 89177c72-f18d-41e8-85c7-08f1cdf57739
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1042.5,
          "y": -120
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b196792e-4a95-4a2c-877e-fefb49ed3e29
      iscommand: false
      name: Are there any IP addresses ?
      type: condition
      version: -1
    taskid: b196792e-4a95-4a2c-877e-fefb49ed3e29
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1042.5,
          "y": 205
        }
      }
  "2":
    continueonerror: true
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "9"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        simple: ${lists.Microsoft Public IP Addresses}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 46c485c5-3e6c-489f-8c6a-49c05172ddb1
      iscommand: false
      name: Does IP Address Belong To Microsoft ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 46c485c5-3e6c-489f-8c6a-49c05172ddb1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1042.5,
          "y": 1420
        }
      }
  "3":
    continueonerror: true
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "no":
      - "6"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        simple: ${lists.Google Public IP Addresses},${lists.Microsoft Public IP Addresses},${lists.TCS_Public_IP_Addresses},${lists.MasterIOC_IP
          Address},${lists.ZscalerIPAddresses},${lists.TCS_RFScanIP_list},${lists.Zscaler
          Aggregate IP Address Ranges},${lists.customer IP Addresses},${lists.Crowdstrike
          indicators}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: be0d69b6-ca09-4c54-8ff9-cffb928253b9
      iscommand: false
      name: Does IP Address Belong To Microsoft, Google, Zscaler, Master IOC or TCS
        ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: be0d69b6-ca09-4c54-8ff9-cffb928253b9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1480,
          "y": 720
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "5"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        complex:
          root: inputs.InternalRange
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 37efcb97-0fb3-4feb-8f5e-8b03e74313b7
      iscommand: false
      name: Are There Any Internal IP Addresses ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 37efcb97-0fb3-4feb-8f5e-8b03e74313b7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1480,
          "y": 370
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: InternalAddress.IP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2572ac4e-9ce5-44ea-8253-b487898123ed
      iscommand: false
      name: Set Internal IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: 2572ac4e-9ce5-44ea-8253-b487898123ed
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1920,
          "y": 540
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address1.IP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5be4c3f6-2396-49e5-8c63-0c423905195f
      iscommand: false
      name: Set Output into Context
      script: Set
      type: regular
      version: -1
    taskid: 5be4c3f6-2396-49e5-8c63-0c423905195f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1830,
          "y": 895
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "no":
      - "21"
      "yes":
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        complex:
          accessor: IP
          root: Address1
      right:
        complex:
          accessor: IP
          root: InternalAddress
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      id: d4d1b4f8-f134-420e-8b9a-ebcf45e90e6f
      iscommand: false
      name: AreValuesEqual
      script: AreValuesEqual
      type: condition
      version: -1
    taskid: d4d1b4f8-f134-420e-8b9a-ebcf45e90e6f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1830,
          "y": 1030
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${Address.MIP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with an IP address.
      id: f93d4c9b-a7af-489a-8929-5d0072f92f76
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2|||ip
      type: regular
      version: -1
    taskid: f93d4c9b-a7af-489a-8929-5d0072f92f76
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 1770
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address.MIP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: be690c19-4b88-4a4b-8924-bae10039d7df
      iscommand: false
      name: Set Microsoft IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: be690c19-4b88-4a4b-8924-bae10039d7df
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 1595
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address.GIP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: bd578d98-903c-4702-856f-f1f40a1a0cb5
      iscommand: false
      name: Set Google IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: bd578d98-903c-4702-856f-f1f40a1a0cb5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 2120
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${Address.GIP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with an IP address.
      id: bdc29862-bd5f-4791-8885-f56a9b708d76
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2|||ip
      type: regular
      version: -1
    taskid: bdc29862-bd5f-4791-8885-f56a9b708d76
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 2295
        }
      }
  "12":
    continueonerror: true
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        simple: ${lists.Google Public IP Addresses}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 1b254352-8446-4b23-82c5-22c3079cffc1
      iscommand: false
      name: Does IP Address Belong To Google ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 1b254352-8446-4b23-82c5-22c3079cffc1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1042.5,
          "y": 1955
        }
      }
  "13":
    continueonerror: true
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      - "18"
      "yes":
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        simple: ${lists.TCS Public IP Addresses}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: ed1f9c89-a938-46f4-84a1-1717aca29ced
      iscommand: false
      name: Does IP Address Belong To TCS ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: ed1f9c89-a938-46f4-84a1-1717aca29ced
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 2470
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address.TIP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 55ed69bd-8123-47dd-8bb1-b6aba34d9308
      iscommand: false
      name: Set TCS IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: 55ed69bd-8123-47dd-8bb1-b6aba34d9308
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 2645
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${Address.TIP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with an IP address.
      id: 3adb662e-d235-4c99-828d-b64d1b25ff2d
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2|||ip
      type: regular
      version: -1
    taskid: 3adb662e-d235-4c99-828d-b64d1b25ff2d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 2820
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
      - "30"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address.MasterIP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8eb5f2ab-de87-4b10-81fd-479692ddc0bf
      iscommand: false
      name: Set Master IOC IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: 8eb5f2ab-de87-4b10-81fd-479692ddc0bf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3695
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "16"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        simple: ${lists.MasterIOC_IP Address}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: dbff9321-044a-441e-894c-a8d6cdc9f96a
      iscommand: false
      name: Are There Any IP Addresses From Master IOC?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: dbff9321-044a-441e-894c-a8d6cdc9f96a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3520
        }
      }
  "18":
    continueonerror: true
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
      ipRanges:
        simple: ${lists.ZscalerIPAddresses}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 9cbe24e3-deb9-4ebf-8f4d-2dca74787d42
      iscommand: false
      name: Does IP Address Belong To Zscaler?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 9cbe24e3-deb9-4ebf-8f4d-2dca74787d42
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 2995
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address.ZIP
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: bbedbdfb-c137-47b2-8543-633a80221b72
      iscommand: false
      name: Set Zscaler IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: bbedbdfb-c137-47b2-8543-633a80221b72
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1145,
          "y": 3170
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${Address.ZIP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with an IP address.
      id: d9774168-17bf-4471-82a4-4cbef971ff32
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2|||ip
      type: regular
      version: -1
    taskid: d9774168-17bf-4471-82a4-4cbef971ff32
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1145,
          "y": 3345
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Address2.IP
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Address1.IP
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: InternalAddress.IP
          root: Address1.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d515e69d-5bc2-4b07-811c-318c93a548f5
      iscommand: false
      name: Set Non Customer IP Address into Context
      script: Set
      type: regular
      version: -1
    taskid: d515e69d-5bc2-4b07-811c-318c93a548f5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2340,
          "y": 1200
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 02566589-1125-4431-8032-413ca673fca5
      iscommand: false
      name: Generate Report & Notify
      type: title
      version: -1
    taskid: 02566589-1125-4431-8032-413ca673fca5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3870
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${RecordedFuture.IP}
      fileName:
        simple: Risk Score.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 35cc5c42-458a-4957-8edc-ae2482e546c1
      iscommand: false
      name: Generate CSV Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 35cc5c42-458a-4957-8edc-ae2482e546c1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": 4190
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: RecordedFuture
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a0cdf224-73b9-4c18-8415-c7f942fefd5a
      iscommand: false
      name: Is There a Report To Generate
      type: condition
      version: -1
    taskid: a0cdf224-73b9-4c18-8415-c7f942fefd5a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3975
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.TIP
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              simple: Address.MIP
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              simple: Address.GIP
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              simple: Address.ZIP
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6dda66e0-9afc-4065-8eee-53142384593b
      iscommand: false
      name: Verify There Are No Customer IP Addresses In The List ?
      type: condition
      version: -1
    taskid: 6dda66e0-9afc-4065-8eee-53142384593b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 220,
          "y": 4160
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI did not find any customer IP Addresses in this
          file ${incident.attachment.name}\n\n\nRegards,\nCSOC CyberAutoBot "
      subject:
        simple: No Customer IP Addresses Found In This File ${incident.attachment.name}
      to:
        complex:
          accessor: labels.Email/from
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 8a7fe157-b3e5-44ee-8f4b-ba228d63028d
      iscommand: true
      name: Send Email Notification That No Customer IP Addresses Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 8a7fe157-b3e5-44ee-8f4b-ba228d63028d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 4660
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4c60a271-65b4-44a9-8d6a-7c22a6da22fa
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 4c60a271-65b4-44a9-8d6a-7c22a6da22fa
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4690
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI found the following  internal IP addresses in this
          list ${incident.attachment.name}. Will be excluding them from my tasks.\n\nInternal
          IP Address: \n\n${InternalAddress.IP}\n\n\nRegards,\nCSOC Cyber AutoBot"
      subject:
        simple: Found Internal IP Addresses In This List ${incident.attachment.name}
      to:
        simple: ${incident.labels.Email/from}
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 94b148f8-502c-4ad2-8700-ecea48e1262f
      iscommand: true
      name: Send Email Notification - Internal IP Addresses Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 94b148f8-502c-4ad2-8700-ecea48e1262f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1690,
          "y": 4365
        }
      }
  "30":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: ajit.menon@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "31"
      "yes":
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e2e2c935-ff4c-46af-81a0-8955bdc1ce0e
      iscommand: false
      name: Is This Request From CSO?
      type: condition
      version: -1
    taskid: e2e2c935-ff4c-46af-81a0-8955bdc1ce0e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4190
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI found that below IP Addresses from the file ${incident.attachment.name}
          are already in the Master IOC list. I will not be performing any action
          on these IOCs.\n\nIP Address:\n\n${Address.MasterIP} \n\n\n\nRegards,\nCSOC
          CyberAutoBot "
      subject:
        simple: 'Found IP Address In This File ${incident.attachment.name} Already
          In Master IOC List '
      to:
        complex:
          accessor: labels.Email/from
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 5d888eb3-068b-464c-8ef0-019340c177a4
      iscommand: true
      name: Send Email Notification Found IP Address In Master IOC
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 5d888eb3-068b-464c-8ef0-019340c177a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4365
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Mail
      value:
        simple: Google
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: ea259a25-4663-46af-8fce-28ba8eda6c3b
      iscommand: false
      name: Add Google Ips msg
      script: Set
      type: regular
      version: -1
    taskid: ea259a25-4663-46af-8fce-28ba8eda6c3b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 0,
          "y": 4840
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.GIP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 78368f1b-c507-42ba-85f1-0bfa6317774b
      iscommand: false
      name: Are there Google Ips?
      type: condition
      version: -1
    taskid: 78368f1b-c507-42ba-85f1-0bfa6317774b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 690,
          "y": 4830
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Output
      value:
        simple: 'Google IPs: ${Address.GIP} '
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 123e6cc1-a3f3-4cd6-8399-f374fcab3b9d
      iscommand: false
      name: Add Google Ips msg
      script: Set
      type: regular
      version: -1
    taskid: 123e6cc1-a3f3-4cd6-8399-f374fcab3b9d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 0,
          "y": 5020
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Mail
      value:
        simple: Microsoft
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1764a0fc-c657-42fe-88e4-fac26eb1fd91
      iscommand: false
      name: Add Microsoft Ips msg
      script: Set
      type: regular
      version: -1
    taskid: 1764a0fc-c657-42fe-88e4-fac26eb1fd91
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -80,
          "y": 5280
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.MIP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f69a73ed-8d59-45e0-870d-ba709a944d39
      iscommand: false
      name: Are there Microsoft Ips?
      type: condition
      version: -1
    taskid: f69a73ed-8d59-45e0-870d-ba709a944d39
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 690,
          "y": 5205
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.ZIP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "45"
      "yes":
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b45a8658-b0c9-4b58-8001-9f30a3a81ba3
      iscommand: false
      name: Are there ZScaler Ips?
      type: condition
      version: -1
    taskid: b45a8658-b0c9-4b58-8001-9f30a3a81ba3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5660
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Output
      value:
        simple: 'Microsoft IPs: ${Address.MIP} '
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9a28bcee-bee2-48e3-8b45-36571761fb13
      iscommand: false
      name: Add Microsoft Ips msg
      script: Set
      type: regular
      version: -1
    taskid: 9a28bcee-bee2-48e3-8b45-36571761fb13
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -80,
          "y": 5480
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Mail
      value:
        simple: ZScaler
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 39273f8e-1d59-4d97-8c59-c20a15cfacb8
      iscommand: false
      name: Add Zscaler Ips msg
      script: Set
      type: regular
      version: -1
    taskid: 39273f8e-1d59-4d97-8c59-c20a15cfacb8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": 5750
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Output
      value:
        simple: 'ZScaler  IPs: ${Address.ZIP} '
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 92d3d8da-907a-4e23-870e-1ef91c302084
      iscommand: false
      name: Add Zscaler Ips msg
      script: Set
      type: regular
      version: -1
    taskid: 92d3d8da-907a-4e23-870e-1ef91c302084
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -70,
          "y": 5950
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Mail
      value:
        simple: TCS
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4ee71cf2-bf1c-4329-801e-b08246feb5a0
      iscommand: false
      name: Add TCS Ips msg
      script: Set
      type: regular
      version: -1
    taskid: 4ee71cf2-bf1c-4329-801e-b08246feb5a0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -80,
          "y": 6210
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Output
      value:
        simple: 'TCS  IPs: ${Address.TIP} '
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 383e9d0e-b056-45f4-8df4-77e359403a76
      iscommand: false
      name: Add TCS Ips msg
      script: Set
      type: regular
      version: -1
    taskid: 383e9d0e-b056-45f4-8df4-77e359403a76
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -80,
          "y": 6400
        }
      }
  "43":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Mail
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6c4a03ec-d1a4-4340-8b64-8943f2c67b32
      iscommand: false
      name: Is Mail Context Defined?
      type: condition
      version: -1
    taskid: 6c4a03ec-d1a4-4340-8b64-8943f2c67b32
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 380,
          "y": 6600
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${.=val.File.filter(function(f){return f.EntryID;}).reduce(function(acc,
          f) {return f;}, null).EntryID}
      body:
        simple: "Hello Human,\n\nI found ${Mail}  IP Addresses in this file ${incident.attachment.name}.
          \nPFA Risk Score Report.\n\n${Output}\n\n\nRegards,\nCSOC CyberAutoBot"
      subject:
        simple: Found ${Mail}  IP Addresses in this file ${incident.attachment.name}
      to:
        complex:
          accessor: labels.Email/from
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 9b858c7f-adeb-4527-8cf0-fd0462e87814
      iscommand: true
      name: Send Email Notification That Google, Microsoft & TCS IP Address Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 9b858c7f-adeb-4527-8cf0-fd0462e87814
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 642.5,
          "y": 7000
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Address.TIP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e242f906-ab50-4ca0-83c4-80bedeca272a
      iscommand: false
      name: Are there TCS Ips?
      type: condition
      version: -1
    taskid: e242f906-ab50-4ca0-83c4-80bedeca272a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 695,
          "y": 6145
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8faff122-72ed-4155-82d2-d30f2fecb952
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 8faff122-72ed-4155-82d2-d30f2fecb952
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 380,
          "y": 7240
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 4dfdac35-3353-4c64-8f77-339f4e0be5a5
      iscommand: true
      name: Extract Indicators From Text File
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 4dfdac35-3353-4c64-8f77-339f4e0be5a5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 720,
          "y": -10
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 8016232b-457b-49cc-8797-e1253884e757
      iscommand: false
      name: Delete Extracted IP Indicator
      script: DeleteContext
      type: regular
      version: -1
    taskid: 8016232b-457b-49cc-8797-e1253884e757
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2340,
          "y": 1335
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators.IP
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Address1.IP
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: InternalAddress.IP
          root: Address1.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 946ae5d8-eea4-4571-893f-2f14954d1c02
      iscommand: false
      name: Set Non Customer IP Address into Extract Indicator IP Context
      script: Set
      type: regular
      version: -1
    taskid: 946ae5d8-eea4-4571-893f-2f14954d1c02
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2340,
          "y": 1480
        }
      }
  "52":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: manual
      label: Manual
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "54"
      Manual:
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c7e900f4-ede3-42c3-8c7d-b7b8928eeb98
      iscommand: false
      name: Is this Manual or Tool Triggered
      type: condition
      version: -1
    taskid: c7e900f4-ede3-42c3-8c7d-b7b8928eeb98
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -80,
          "y": 4300
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: ajit.menon@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a9ff2ce3-4d6a-479c-8082-d31a66bfba18
      iscommand: false
      name: Is Block Email From CSO ?
      type: condition
      version: -1
    taskid: a9ff2ce3-4d6a-479c-8082-d31a66bfba18
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 280,
          "y": 4490
        }
      }
  "55":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: ajit.menon@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6964dea6-a374-46da-8fa2-496979c47e7d
      iscommand: false
      name: Is This Request From CSO?
      type: condition
      version: -1
    taskid: 6964dea6-a374-46da-8fa2-496979c47e7d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1700,
          "y": 3160
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI found the following  internal IP addresses in the
          email sent for blocking by Ajit Menon. \nWill be excluding them from my
          tasks.\n\nInternal IP Address: \n\n${InternalAddress.IP}\n\nXSOAR Incident
          id: ${incident.id}\n\n\nRegards,\nCSOC CyberAutoBot "
      subject:
        simple: Found Internal IP Addresses In Incident ${incident.id}
      to:
        simple: yogesh.gholap@tcs.com,nimisha.prajapati@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 7be291ab-3a28-4add-809d-53bcae8cee20
      iscommand: true
      name: Send Email Notification To Managers- Internal IP Addresses Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 7be291ab-3a28-4add-809d-53bcae8cee20
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2150,
          "y": 4350
        }
      }
  "57":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: ajit.menon@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "44"
      "yes":
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: efd68602-4fa9-4373-8e28-6a36d4193a52
      iscommand: false
      name: Is This Request From CSO?
      type: condition
      version: -1
    taskid: efd68602-4fa9-4373-8e28-6a36d4193a52
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 642.5,
          "y": 6780
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "30_27_yes": 0.21,
      "57_44_#default#": 0.39
    },
    "paper": {
      "dimensions": {
        "height": 7425,
        "width": 2840,
        "x": -120,
        "y": -120
      }
    }
  }
