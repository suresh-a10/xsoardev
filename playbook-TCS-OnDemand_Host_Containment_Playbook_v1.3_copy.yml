contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: cd91bfce-97d0-4fb8-8616-db7042fa6d66
inputs: []
name: TCS-OnDemand Host Containment Playbook v1.3_copy
outputs: []
sourceplaybookid: dc7d02c4-9e4e-4e78-866e-35dde9c38272
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ad7f5e3f-f423-44c5-8596-5b431cab5b82
      iscommand: false
      name: ""
      version: -1
    taskid: ad7f5e3f-f423-44c5-8596-5b431cab5b82
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 0
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 08108f32-252b-4802-8b59-06f1acab1246
      iscommand: false
      name: Read The Text Attachment
      script: ReadFile
      type: regular
      version: -1
    taskid: 08108f32-252b-4802-8b59-06f1acab1246
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 400
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: TCSHostname
      value:
        complex:
          root: FileData
          transformers:
          - operator: trim
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 31588c47-c53f-4ede-8836-b29caa41d1e9
      iscommand: false
      name: Set Data To Context
      script: Set
      type: regular
      version: -1
    taskid: 31588c47-c53f-4ede-8836-b29caa41d1e9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 575
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          root: TCSHostname
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: d7e69203-fc7d-435f-855a-bb922bba069b
      iscommand: true
      name: Get Host Data From Crowdstrike
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: d7e69203-fc7d-435f-855a-bb922bba069b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 1100
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        complex:
          accessor: Device
          root: CrowdStrike
      fileName:
        simple: Crowdstrike_Host_Contained_Report.csv
      headers:
        simple: Hostname,ID,FirstSeen,LastSeen,OS,ExternalIP,LocalIP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 4f098312-a3a0-4ca5-8156-122047def876
      iscommand: false
      name: Create Excel Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 4f098312-a3a0-4ca5-8156-122047def876
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2150
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d658f095-0746-497e-8760-1882714fa43b
      iscommand: false
      name: Set Report To New Context
      script: Set
      type: regular
      version: -1
    taskid: d658f095-0746-497e-8760-1882714fa43b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2325
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        complex:
          root: TCSHostname
          transformers:
          - operator: toUpperCase
      right:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
          transformers:
          - operator: toUpperCase
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: eed66218-7eef-401a-8d7b-7f839937af98
      iscommand: false
      name: Compare Submitted List With CS Results
      script: CompareLists
      type: regular
      version: -1
    taskid: eed66218-7eef-401a-8d7b-7f839937af98
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2500
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e13b0356-de21-4c9f-8596-cb5e9e37f92b
      iscommand: false
      name: Are There Any Hosts Not Found in CrowdStrike ?
      type: condition
      version: -1
    taskid: e13b0356-de21-4c9f-8596-cb5e9e37f92b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2675
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Hostnotfound
      value:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c192bf7d-b512-4766-82f4-11ba9db77b89
      iscommand: false
      name: Set The Host To Context
      script: Set
      type: regular
      version: -1
    taskid: c192bf7d-b512-4766-82f4-11ba9db77b89
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2850
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: CrowdStrike
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Hostname
                root: CrowdStrike.Device
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6c69cda4-619c-48c2-8809-faf67c8b3401
      iscommand: false
      name: Host Found on CrowdStrike?
      type: condition
      version: -1
    taskid: 6c69cda4-619c-48c2-8809-faf67c8b3401
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 1285
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |
          Hello Human,

          None of the Hostname in this list - ${incident.attachment.name} were found in Crowdstrike.

          Regards,
          Cyber Autobot
          Automation task id : ${incident.id}
      cc:
        simple: amankumar.sinha@tcs.com
      subject:
        simple: None of The Hostname in this list - ${incident.attachment.name} Were
          Found in Crowdstrike
      to:
        complex:
          accessor: Email/from
          root: incident.labels
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 71f7e8d6-1e4d-4ad6-8ea1-faca680ac93f
      iscommand: true
      name: Send Notification 'No Hosts Found on Crowdstrike'
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 71f7e8d6-1e4d-4ad6-8ea1-faca680ac93f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3550
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${Report}
      body:
        simple: |
          Hello Human,

          I have contained all the hosts shared in this list - ${incident.attachment.name}. Please refer to the attached report.


          Regards,
          Cyber Autobot
          Automation id : ${incident.id}
      cc:
        simple: amankumar.sinha@tcs.com
      subject:
        simple: ' Crowdstrike Contained Host Report For Submitted File (Compliance
          Team)- ${incident.attachment.name}'
      to:
        complex:
          accessor: Email/from
          root: incident.labels
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: c7ad7b63-147b-4191-8ac2-27237181d0e7
      iscommand: true
      name: Send Host Containment Report (All Hosts)
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: c7ad7b63-147b-4191-8ac2-27237181d0e7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3550
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${Report}
      body:
        simple: |
          Hello Human,

          I have contained some of the hosts shared in this list - ${incident.attachment.name}

          PFA report of hosts contained and also a list of hosts not found in the CrowdStrike database.


          Regards,
          Cyber Autobot
          Automation id : ${incident.id}
      cc:
        simple: amankumar.sinha@tcs.com
      subject:
        simple: ' Crowdstrike Contained Host Report For Submitted File(Compliance
          Team) - ${incident.attachment.name}'
      to:
        complex:
          accessor: Email/from
          root: incident.labels
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 1f07e3b5-a058-4122-8130-6c09603e2fa1
      iscommand: true
      name: Send Host Containment Report (Some Hosts)
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 1f07e3b5-a058-4122-8130-6c09603e2fa1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3550
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello Human,

          You are not on my authorized list of senders. Please contact Your XSOAR Support team.

          Regards,
          CSOC Cyber AutoBot
          Automation task id : ${incident.id}
      cc:
        simple: amankumar.sinha@tcs.com
      subject:
        simple: Not Authorized For This Task
      to:
        complex:
          accessor: Email/from
          root: incident.labels
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 02c68b6f-2b68-4c8d-8604-9d4afad8d9fa
      iscommand: true
      name: Send Notification 'Not Authorized Sender'
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 02c68b6f-2b68-4c8d-8604-9d4afad8d9fa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 150,
          "y": 1530
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: b01aaf2a-74bf-41f7-8166-5d93b55d6906
      iscommand: true
      name: Close Playbook
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: b01aaf2a-74bf-41f7-8166-5d93b55d6906
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3725
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ec92ec48-d2fa-48fb-8230-54cea8479f9f
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: ec92ec48-d2fa-48fb-8230-54cea8479f9f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3900
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      context_key:
        simple: Hostnotfoundarray
      file_name:
        simple: Host_Not_Found.csv
      header:
        simple: Hostname
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c815b1d9-0416-4e84-848c-929ff8b39b0e
      iscommand: false
      name: Create Excel Report of Hosts Not Found
      script: 98fd7176-124d-4739-8f9d-2f1edb20aa55
      type: regular
      version: -1
    taskid: c815b1d9-0416-4e84-848c-929ff8b39b0e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3200
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Report
      value:
        simple: '${.=(val.File instanceof Array ? val.File[val.File.length-1].EntryID
          : val.File.EntryID)}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 40140396-73d2-4ed9-847b-85c08d03a667
      iscommand: false
      name: Set Report To New Context
      script: Set
      type: regular
      version: -1
    taskid: 40140396-73d2-4ed9-847b-85c08d03a667
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3375
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        complex:
          root: Hostnotfound
      contextKey:
        simple: Hostnotfoundarray
      separator:
        simple: ','
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: dde167e8-0e4a-4acf-833b-5f1027252628
      iscommand: false
      name: Create Array For Report
      script: CreateArray
      type: regular
      version: -1
    taskid: dde167e8-0e4a-4acf-833b-5f1027252628
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3025
        }
      }
  "21":
    continueonerror: true
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        complex:
          accessor: ID
          root: CrowdStrike.Device
          transformers:
          - operator: uniq
      using:
        simple: CrowdstrikeFalcon_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Contains containment for a specified host. When contained, a host
        can only communicate with the CrowdStrike cloud and any IPs specified in your
        containment policy.
      id: fff126b0-4d79-47cb-8e32-14c6964546a7
      iscommand: true
      name: Contain Host
      script: '|||cs-falcon-contain-host'
      type: regular
      version: -1
    taskid: fff126b0-4d79-47cb-8e32-14c6964546a7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 1800
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      arrayData:
        simple: ${TCSHostname}
      contextKey:
        simple: TCSHostnameArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Will create an array object in context from given string input '
      id: 6c28e0f5-5c99-4ef8-8e81-ab10ddc6a075
      iscommand: false
      name: Create Array of Input Data
      script: CreateArray
      type: regular
      version: -1
    taskid: 6c28e0f5-5c99-4ef8-8e81-ab10ddc6a075
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 750
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        simple: ${TCSHostnameArray}
      contextKey:
        simple: TCSHostnameArrayCount
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 3e6031c0-f872-4fca-84f4-70d5e310b57d
      iscommand: false
      name: Count The Array Data And Set It To Context
      script: CountArraySize
      type: regular
      version: -1
    taskid: 3e6031c0-f872-4fca-84f4-70d5e310b57d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 925
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        simple: ${CrowdStrike.Device.ID}
      contextKey:
        simple: CrowdStrikeDeviceIDCount
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 0a185a57-eb6d-4b0f-8df5-9de0d5b8b071
      iscommand: false
      name: Count The CS Host ID Array Count And Set It To Context
      script: CountArraySize
      type: regular
      version: -1
    taskid: 0a185a57-eb6d-4b0f-8df5-9de0d5b8b071
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1470
        }
      }
  "25":
    continueonerror: true
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "21"
      "yes":
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      first:
        simple: ${CrowdStrikeDeviceIDCount}
      second:
        simple: ${TCSHostnameArrayCount}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Checks if one number(float) as bigger than the other(float)
        Returns yes: if first > second
        Returns no: if first <= second
        Returns exception if one of the inputs is not a number
      id: bb36304d-392c-445d-8c91-6e7106ad507f
      iscommand: false
      name: Compare The Count Value Of The CrowdStrike Output With The Original Input
      script: IsGreaterThan
      type: condition
      version: -1
    taskid: bb36304d-392c-445d-8c91-6e7106ad507f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1625
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |
          Hello Human,

          One of the Hostnames in this list - ${incident.attachment.name} is not unique, and resolves to multiple device IDs. Unfortunately I've not yet learnt to identify the hostname causing the issue. Request you to review this manually.

          Regards,
          Cyber Autobot
          Automation task id : ${incident.id}
      cc:
        simple: amankumar.sinha@tcs.com
      subject:
        simple: One of The CrowdStrike Host(s) Is Not Unique - ${incident.attachment.name}
      to:
        complex:
          accessor: Email/from
          root: incident.labels
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 256ed0c9-e718-4a81-8ef2-d2dd1770c36e
      iscommand: true
      name: Send Notification 'One of The Host Inputs is Not Unique'
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 256ed0c9-e718-4a81-8ef2-d2dd1770c36e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 3550
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ${CrowdStrike}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 1f20b603-cc51-4907-8338-44762c4b2b66
      iscommand: false
      name: Delete Crowdstrike Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 1f20b603-cc51-4907-8338-44762c4b2b66
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 560,
          "y": 1840
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      relateToIncident:
        simple: "true"
      tags:
        simple: hostcontaincompliance
      type:
        simple: Host
      value:
        complex:
          accessor: Hostname
          root: CrowdStrike.Device
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 20820024-7980-4206-848d-53bf406357ff
      iscommand: true
      name: Create Host Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 20820024-7980-4206-848d-53bf406357ff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1600,
          "y": 1880
        }
      }
  "30":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: komala.kp@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: InternalIS.SecurityCompliance@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: kunal.krushev@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: sonam.bhandari@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: komal.lugade@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.labels.Email/from}
          operator: isEqualString
          right:
            value:
              simple: pawan.pavanje@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9f2aa18b-22e5-4e83-82f2-f425b3b8619e
      iscommand: false
      name: Is Email From Authorized Sender ?
      type: condition
      version: -1
    taskid: 9f2aa18b-22e5-4e83-82f2-f425b3b8619e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 550,
          "y": 140
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: Priyanka.chouhan2@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: shiva1.shankar@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: v.ghule@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: kunal.krushev@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: InternalIS.SecurityCompliance@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: komala.kp@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: 'ramprakash1.r@tcs.com  '
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: arunsastha,p@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: k.premanandhan@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: 'sonali.teli@tcs.com '
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: 'manoharan.g@tcs.com '
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: shreya.nayak@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: somraj.chakravarty@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: s.moharana@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: "sala.e@tcs.com\n "
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: vanita.gonjare@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: pawan.pavanje@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d254b063-f231-42c7-8df1-5d88589b3a69
      iscommand: false
      name: Is Email From Authorized Sender ?
      type: condition
      version: -1
    taskid: d254b063-f231-42c7-8df1-5d88589b3a69
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 570,
          "y": 360
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |
          Hello Human,

          One of the Hostnames in this list - ${incident.attachment.name} is not unique, and resolves to multiple device IDs. Unfortunately I've not yet learnt to identify the hostname causing the issue. Request you to review this manually.

          Regards,
          Cyber Autobot
          Automation task id : ${incident.id}
      cc:
        simple: v.ghule@tcs.com, kunal.krushev@tcs.com,internalis.cybersecurityops@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: One of The CrowdStrike Host(s) Is Not Unique - ${incident.attachment.name}
      to:
        complex:
          accessor: Email/from
          root: incident.labels
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 15b4c3bc-377d-4758-8f68-3298d6e5b58d
      iscommand: true
      name: Send Notification 'One of The Host Inputs is Not Unique'
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 15b4c3bc-377d-4758-8f68-3298d6e5b58d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 3730
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${Report}
      body:
        simple: |
          Hello Human,

          I have contained some of the hosts shared in this list - ${incident.attachment.name}

          PFA report of hosts contained and also a list of hosts not found in the CrowdStrike database.


          Regards,
          Cyber Autobot
          Automation id : ${incident.id}
      cc:
        simple: v.ghule@tcs.com,kunal.krushev@tcs.com,internalis.cybersecurityops@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: ' Crowdstrike Contained Host Report For Submitted File(Compliance
          Team) - ${incident.attachment.name}'
      to:
        complex:
          accessor: Email/from
          root: incident.labels
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 7ee4fff8-0eb8-4300-8cbc-4615da3a55e0
      iscommand: true
      name: Send Host Containment Report (Some Hosts)
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 7ee4fff8-0eb8-4300-8cbc-4615da3a55e0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3730
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${Report}
      body:
        simple: |
          Hello Human,

          I have contained all the hosts shared in this list - ${incident.attachment.name}. Please refer to the attached report.


          Regards,
          Cyber Autobot
          Automation id : ${incident.id}
      cc:
        simple: v.ghule@tcs.com,kunal.krushev@tcs.com,internalis.cybersecurityops@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: ' Crowdstrike Contained Host Report For Submitted File (Compliance
          Team)- ${incident.attachment.name}'
      to:
        complex:
          accessor: Email/from
          root: incident.labels
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 99653f0a-ac82-45ae-879b-ada4d20dbeec
      iscommand: true
      name: Send Host Containment Report (All Hosts)
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 99653f0a-ac82-45ae-879b-ada4d20dbeec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3780
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello Human,

          You are not on my authorized list of senders. Please contact Your XSOAR Support team.

          Regards,
          CSOC Cyber AutoBot
          Automation task id : ${incident.id}
      cc:
        simple: kunal.krushev@tcs.com,v.ghule@tcs.com,sonam.bhandari@tcs.com,InternalIS.SecurityCompliance@tcs.com
      subject:
        simple: Not Authorized For This Task
      to:
        complex:
          accessor: Email/from
          root: incident.labels
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 7a6f8116-08a7-47e3-80b8-7b8cc09c6a5c
      iscommand: true
      name: Send Notification 'Not Authorized Sender'
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 7a6f8116-08a7-47e3-80b8-7b8cc09c6a5c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1420
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |
          Hello Human,

          None of the Hostname in this list - ${incident.attachment.name} were found in Crowdstrike.

          Regards,
          Cyber Autobot
          Automation task id : ${incident.id}
      cc:
        simple: amankumar.sinha@tcs.com
      subject:
        simple: None of The Hostname in this list - ${incident.attachment.name} Were
          Found in Crowdstrike
      to:
        complex:
          accessor: Email/from
          root: incident.labels
      using:
        simple: Mail Sender_instance_AutoBot
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 8967d8cb-c7cb-41e7-8dd6-e1f8600ecd1b
      iscommand: true
      name: Send Notification 'No Hosts Found on Crowdstrike'
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 8967d8cb-c7cb-41e7-8dd6-e1f8600ecd1b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3730
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "25_26_yes": 0.24
    },
    "paper": {
      "dimensions": {
        "height": 3965,
        "width": 2000,
        "x": 150,
        "y": 0
      }
    }
  }
