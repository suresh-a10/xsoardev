contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 1.10.54
    packID: ExpanseV2
    packName: Cortex Xpanse by Palo Alto Networks
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: 'Subplaybook for Expanse Enrich Cloud Assets subplaybook. This playbook
  is used to find the corresponding Public Cloud Region (i.e. AWS us-east-1) and Service
  (i.e. AWS EC2) for a provided IP Address. It works by correlating the provided IP
  address with the IP Range Indicators (CIDRs) that can be collected from Public Cloud
  feeds (i.e. AWS Feed) in XSOAR. CIDR Indicators must be tagged properly using the
  corresponding tags (i.e. AWS for AWS Feed): tags can be configured in the Feed Integrations
  and must match the ones provided in the inputs of this playbook. Correlation is
  done based on the longest match (i.e. smaller CIDR such as /20 range wins over a
  bigger one such as /16).'
id: Expanse Find Cloud IP Address Region and Service
inputs:
- description: IP Address to find.
  key: ip
  playbookInputQuery: null
  required: true
  value:
    simple: ${IP.Address}
- description: Cloud Provider (Google,Amazon web services,Microsoft azure) or empty
    to search in all.
  key: Provider
  playbookInputQuery: null
  required: false
  value: {}
- description: Tags to search for AWS Indicators.
  key: AWSIndicatorTags
  playbookInputQuery: null
  required: false
  value:
    simple: AWS
- description: Tags to search for GCP Indicators.
  key: GCPIndicatorTags
  playbookInputQuery: null
  required: false
  value:
    simple: GCP
- description: Tags to search for Azure Indicators.
  key: AzureIndicatorTags
  playbookInputQuery: null
  required: false
  value:
    simple: Azure
name: Expanse Find Cloud IP Address Region and Service
outputs:
- contextPath: MatchingCIDRIndicator
  description: Matching CIDR Indicator
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 962e831b-47d9-485a-8030-795d6b48c8db
      iscommand: false
      name: ""
      version: -1
    taskid: 962e831b-47d9-485a-8030-795d6b48c8db
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
  "1":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Provider
          operator: inList
          right:
            value:
              simple: AWS,Amazon Web Services,Amazon
      label: AWS
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Provider
          operator: inList
          right:
            value:
              simple: Google,GCP,Google Cloud Platform
      label: GCP
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Provider
          operator: inList
          right:
            value:
              simple: Microsoft,Microsoft Azure,Azure
      label: AZURE
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      AWS:
      - "2"
      AZURE:
      - "4"
      GCP:
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Select the appropriate branch depending on the Cloud Provider
      id: 092e54ea-8f59-4208-89a4-b829124faf5f
      iscommand: false
      name: Cloud Provider Selector
      type: condition
      version: -1
    taskid: 092e54ea-8f59-4208-89a4-b829124faf5f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 210
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          root: inputs.ip
      tags:
        complex:
          root: inputs.AWSIndicatorTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Match IP address in all the CIDRs indicators (longest match)
      id: a63dbb86-7fce-4bde-8e88-0a24826d56ce
      iscommand: false
      name: Search and Match IP in AWS CIDR Indicators
      script: MatchIPinCIDRIndicators
      type: regular
      version: -1
    taskid: a63dbb86-7fce-4bde-8e88-0a24826d56ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -20,
          "y": 670
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          root: inputs.ip
      tags:
        complex:
          root: inputs.GCPIndicatorTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Match IP address in all the CIDRs indicators (longest match)
      id: 7d6a7c75-6f95-4e53-818c-6f16d3912ffb
      iscommand: false
      name: Search and Match IP in GCP CIDR Indicators
      script: MatchIPinCIDRIndicators
      type: regular
      version: -1
    taskid: 7d6a7c75-6f95-4e53-818c-6f16d3912ffb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": 670
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          root: inputs.ip
      tags:
        complex:
          root: inputs.AzureIndicatorTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Match IP address in all the CIDRs indicators (longest match)
      id: b752f7a0-7512-4792-8e99-dbc09a204d3d
      iscommand: false
      name: Search and Match IP in AZURE CIDR Indicators
      script: MatchIPinCIDRIndicators
      type: regular
      version: -1
    taskid: b752f7a0-7512-4792-8e99-dbc09a204d3d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 670
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
      - "3"
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 602ae52b-e637-46be-831f-450c45b13dfb
      iscommand: false
      name: Check All Providers
      type: title
      version: -1
    taskid: 602ae52b-e637-46be-831f-450c45b13dfb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 930,
          "y": 410
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0ae27264-35d4-4aa6-8b01-715a1c5cdae1
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 0ae27264-35d4-4aa6-8b01-715a1c5cdae1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1090
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1105,
        "width": 1330,
        "x": -20,
        "y": 50
      }
    }
  }
