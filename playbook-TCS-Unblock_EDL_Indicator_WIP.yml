contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 6b0ae0fc-79c8-4de1-8588-727cdb5efe36
inputs:
- description: ""
  key: IOC
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Unblock EDL Indicator_WIP
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a27da740-7e9a-4f36-88a6-f57bf5fd2502
      iscommand: false
      name: ""
      version: -1
    taskid: a27da740-7e9a-4f36-88a6-f57bf5fd2502
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 500,
          "y": 230
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: acfa3294-9d51-47cf-8950-597805aea0a5
      iscommand: false
      name: Is Indicator Context Set ?
      type: condition
      version: -1
    taskid: acfa3294-9d51-47cf-8950-597805aea0a5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 500,
          "y": 420
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: indicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: ac0022ec-e3ec-43d1-8685-674c9f340557
      iscommand: false
      name: Delete 'Indicator' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: ac0022ec-e3ec-43d1-8685-674c9f340557
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 635
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 31e5a379-df4a-45e7-8d70-823b38070589
      iscommand: true
      name: Check If Indicators Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 31e5a379-df4a-45e7-8d70-823b38070589
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 800
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e107f82-3019-48f0-86ad-fb4928444eac
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 1e107f82-3019-48f0-86ad-fb4928444eac
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1170
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: qradarsuspiciousip
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 62e2a45e-2143-4706-8045-c651fb9d874c
      iscommand: false
      name: Is This IP Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 62e2a45e-2143-4706-8045-c651fb9d874c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1390
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: 25b7604a-3ac6-43da-87d0-de8f4ea31b6e
      iscommand: true
      name: Expired the indicator
      script: Builtin|||expireIndicators
      type: regular
      version: -1
    taskid: 25b7604a-3ac6-43da-87d0-de8f4ea31b6e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1610
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bbc94fa4-988c-4e30-85cb-066cd5473530
      iscommand: false
      name: END
      type: title
      version: -1
    taskid: bbc94fa4-988c-4e30-85cb-066cd5473530
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1790
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1625,
        "width": 380,
        "x": 500,
        "y": 230
      }
    }
  }
