contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 2.0.10
    packID: ""
    packName: System Diagnostics and Health Check
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: Parse files from log bundle output
id: 549b6c3f-db3e-46b4-8973-9a1bcb89b14f
inputs:
- description: Log bundle files
  key: LogFiles
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: Health Check Thresholds
  playbookInputQuery: null
  required: false
  value:
    simple: ${Health Check Thresholds}
name: Health Check - Log Analysis Read All files_copy
outputs:
- contextPath: HealthCheck.ActionableItems
  description: Data read from war room file
sourceplaybookid: Health Check - Log Analysis Read All files
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2189f14c-4e41-4019-82ab-ce9b17aa439f
      iscommand: false
      name: ""
      version: -1
    taskid: 2189f14c-4e41-4019-82ab-ce9b17aa439f
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.LogFiles.Name
              operator: endWith
              right:
                value:
                  simple: license_data.log
          root: inputs.LogFiles
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read license_data.log and set customer name, license end date
      id: 90cb2b9a-53e0-46cf-8956-2278f384c952
      iscommand: false
      name: Read license_data.log and set customer name, license end date
      script: HealthCheckLicenseData
      type: regular
      version: -1
    taskid: 90cb2b9a-53e0-46cf-8956-2278f384c952
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1710
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      IncidentID:
        simple: ${incident.id}
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.LogFiles.Name
              operator: startWith
              right:
                value:
                  simple: server
          - - left:
                iscontext: true
                value:
                  simple: inputs.LogFiles.Name
              operator: endWith
              right:
                value:
                  simple: .log
          root: inputs.LogFiles
      since:
        simple: ${incident.lasince}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read server log file line by line and display warnings, fatal errors
        and keyword results in a table to the war room
      id: 1d8374c4-0b83-4a32-8979-8ff91becaf82
      iscommand: false
      name: Read server.log file and display
      script: HealthCheckServerLog
      tags:
      - ServerResults
      type: regular
      version: -1
    taskid: 1d8374c4-0b83-4a32-8979-8ff91becaf82
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1710
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 18698174-5a36-4ba7-8e2b-9c24c6c28987
      iscommand: false
      name: Read all files
      type: title
      version: -1
    taskid: 18698174-5a36-4ba7-8e2b-9c24c6c28987
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.LogFiles.Name
              operator: endWith
              right:
                value:
                  simple: docker.log
          root: inputs.LogFiles
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read docker log file
      id: 6ace8530-5cea-4d09-8249-7e1c8c8312d7
      iscommand: false
      name: Read the Docker.log file
      script: HealthCheckDockerLog
      type: regular
      version: -1
    taskid: 6ace8530-5cea-4d09-8249-7e1c8c8312d7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 870
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.LogFiles.Name
          operator: isEqualString
          right:
            value:
              simple: docker.log
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "63"
      "yes":
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if docker log exist
      id: 91326efc-4fcc-4fed-89b9-8c8b3d6d1817
      iscommand: false
      name: 'Do we have a docker log in the bundle ? '
      type: condition
      version: -1
    taskid: 91326efc-4fcc-4fed-89b9-8c8b3d6d1817
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 690
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.LogFiles.Name
              operator: endWith
              right:
                value:
                  simple: filesystem.log
          root: inputs.LogFiles
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: read and parse filesystem.log
      id: 74f7141f-bb14-4c46-8d32-9f0ba4d915e4
      iscommand: false
      name: Read the filesystem.log file
      script: HealthCheckFileSystem
      type: regular
      version: -1
    taskid: 74f7141f-bb14-4c46-8d32-9f0ba4d915e4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 515
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 234d29d1-ec82-422c-8460-6992776b10f1
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 234d29d1-ec82-422c-8460-6992776b10f1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1885
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.LogFiles.Name
              operator: endWith
              right:
                value:
                  simple: conf.log
          root: inputs.LogFiles
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read the conf.log file extracted from the log bundle
      id: 5a360cad-94f9-44ee-8266-32549a67c0c6
      iscommand: false
      name: 'Read the conf.log (demisto.conf) file '
      script: HealthCheckReadConf
      type: regular
      version: -1
    taskid: 5a360cad-94f9-44ee-8266-32549a67c0c6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 515
        }
      }
  "52":
    continueonerror: true
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.LogFiles.Name
              operator: endWith
              right:
                value:
                  simple: telemetry.log
          root: inputs.LogFiles
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read Telemetry file
      id: 1c9d710b-b69b-4379-875c-e87e9b4ab19e
      iscommand: false
      name: Read Telemetry file (check for API)
      script: HealthCheckReadTemeletryLog
      type: regular
      version: -1
    taskid: 1c9d710b-b69b-4379-875c-e87e9b4ab19e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1535
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.LogFiles.Name
              operator: endWith
              right:
                value:
                  simple: version_control.log
          root: inputs.LogFiles
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read the version_control.log file extracted from the log bundle
      id: 70a04ca5-5d8b-49c9-86b3-a98a21642a66
      iscommand: false
      name: Read the version_control.log file to collect dev prod details
      script: HealthCheckReadVC
      type: regular
      version: -1
    taskid: 70a04ca5-5d8b-49c9-86b3-a98a21642a66
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 340
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8873c44c-6fc2-4cc4-85e6-c0a87a3c3e93
      iscommand: false
      name: Continue
      type: title
      version: -1
    taskid: 8873c44c-6fc2-4cc4-85e6-c0a87a3c3e93
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1390
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8124bb9f-7c58-4b74-88c0-37fcd8627172
      iscommand: false
      name: Server Logs Logic
      type: title
      version: -1
    taskid: 8124bb9f-7c58-4b74-88c0-37fcd8627172
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1550
        }
      }
  "63":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.LogFiles.Name
          operator: isEqualString
          right:
            value:
              simple: panic.log
      label: "yes"
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "64"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if docker log exist
      id: 0131847b-fe80-4085-8211-03410722fc9d
      iscommand: false
      name: 'Do we have a docker log in the bundle ? '
      type: condition
      version: -1
    taskid: 0131847b-fe80-4085-8211-03410722fc9d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1040
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.LogFiles.Name
              operator: endWith
              right:
                value:
                  simple: panic.log
          root: inputs.LogFiles
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read panic log file line by line and display warnings, fatal errors
        and keyword results in a table to the war room
      id: 5efed909-d515-4da6-8530-10b6d7950bda
      iscommand: false
      name: Read the panic.log file
      script: HealthCheckPanicLog
      type: regular
      version: -1
    taskid: 5efed909-d515-4da6-8530-10b6d7950bda
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 532.5,
          "y": 1215
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "37_63_#default#": 0.9
    },
    "paper": {
      "dimensions": {
        "height": 1900,
        "width": 872.5,
        "x": 40,
        "y": 50
      }
    }
  }
