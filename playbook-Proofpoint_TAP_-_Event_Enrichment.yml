contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: 1.2.12
    packID: ProofpointTAP
    packName: Proofpoint TAP
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: "This playbook enriches Proofpoint Targeted Attack Protection (TAP) incidents
  with forensic evidence. \nBy utilizing the 'proofpoint-get-forensics' command, the
  playbook retrieves forensic evidence based on the campaign ID and threat ID detected
  in the Proofpoint TAP incidents."
id: Proofpoint TAP - Event Enrichment
inputs: []
name: Proofpoint TAP - Event Enrichment
outputs:
- contextPath: Proofpoint.Campaign
  description: Retrieved Campaign objects
  type: string
- contextPath: Proofpoint.Campaign.info
  description: The campaign information - ID,name, description, startDate, and notable.
  type: string
- contextPath: Proofpoint.Campaign.actors
  description: A list of actor objects.
  type: string
- contextPath: Proofpoint.Campaign.families
  description: A list of family objects.
  type: string
- contextPath: Proofpoint.Campaign.malware
  description: A list of malware objects.
  type: string
- contextPath: Proofpoint.Campaign.techniques
  description: A list of technique objects.
  type: string
- contextPath: Proofpoint.Campaign.brands
  description: A list of brand objects.
  type: string
- contextPath: Proofpoint.Campaign.campaignMembers
  description: A list of campaign member objects.
  type: string
- contextPath: Proofpoint.Report
  description: Retrieved Report object identifies
  type: string
- contextPath: Proofpoint.Report.ID
  description: The ID of the report.
  type: string
- contextPath: Proofpoint.Report.Type
  description: 'The threat type. Can be: "attachment", "url", or "hybrid".'
  type: string
- contextPath: Proofpoint.Report.Scope
  description: Whether the report scope covers a campaign or an individual threat.
  type: string
- contextPath: Proofpoint.Report.Attachment
  description: Attachments evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.Attachment.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.Attachment.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.Attachment.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.Attachment.SHA256
  description: The SHA256 hash of the attachment's contents.
  type: string
- contextPath: Proofpoint.Report.Attachment.MD5
  description: The MD5 hash of the attachment's contents.
  type: string
- contextPath: Proofpoint.Report.Attachment.Blacklisted
  description: Optional. Whether the file was block listed.
  type: string
- contextPath: Proofpoint.Report.Attachment.Offset
  description: Optional. The offset in bytes where the malicious content was found.
  type: string
- contextPath: Proofpoint.Report.Attachment.Size
  description: Optional. The size in bytes of the attachment's contents.
  type: string
- contextPath: Proofpoint.Report.Attachment.Platform.Name
  description: The name of the platform.
  type: string
- contextPath: Proofpoint.Report.Attachment.Platform.OS
  description: The operating system of the platform.
  type: string
- contextPath: Proofpoint.Report.Attachment.Platform.Version
  description: The version of the platform.
  type: string
- contextPath: Proofpoint.Report.Cookie
  description: Cookies evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.Cookie.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.Cookie.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.Cookie.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.Cookie.Action
  description: Whether the cookie was set or deleted.
  type: string
- contextPath: Proofpoint.Report.Cookie.Domain
  description: The domain that set the cookie.
  type: string
- contextPath: Proofpoint.Report.Cookie.Key
  description: The name of the cookie being set or deleted.
  type: string
- contextPath: Proofpoint.Report.Cookie.Value
  description: Optional. The content of the cookie being set.
  type: string
- contextPath: Proofpoint.Report.Cookie.Platform.Name
  description: Name of the platform.
  type: string
- contextPath: Proofpoint.Report.Cookie.Platform.OS
  description: The operating system of the platform.
  type: string
- contextPath: Proofpoint.Report.Cookie.Platform.Version
  description: The version of the platform.
  type: string
- contextPath: Proofpoint.Report.DNS
  description: DNS evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.DNS.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.DNS.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.DNS.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.DNS.Host
  description: The hostname being resolved.
  type: string
- contextPath: Proofpoint.Report.DNS.CNames
  description: Optional. An array of CNames, which were associated with the hostname.
  type: string
- contextPath: Proofpoint.Report.DNS.IP
  description: Optional. An array of IP addresses that were resolved to the hostname.
  type: string
- contextPath: Proofpoint.Report.DNS.NameServers
  description: Optional. The nameservers responsible for the hostname's domain.
  type: string
- contextPath: Proofpoint.Report.DNS.NameServersList
  description: Optional. The nameservers responsible for the hostnames.
  type: string
- contextPath: Proofpoint.Report.DNS.Platform.Name
  description: The name of the platform.
  type: string
- contextPath: Proofpoint.Report.DNS.Platform.OS
  description: The operating system of the platform.
  type: string
- contextPath: Proofpoint.Report.DNS.Platform.Version
  description: The version of the platform.
  type: string
- contextPath: Proofpoint.Report.Dropper
  description: Droppers evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.Dropper.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.Dropper.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.Dropper.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.Dropper.Path
  description: The location of the dropper file.
  type: string
- contextPath: Proofpoint.Report.Dropper.URL
  description: Optional. The name of the static rule inside the sandbox that identified
    the dropper.
  type: string
- contextPath: Proofpoint.Report.Dropper.Rule
  description: Optional. The URL the dropper contacted.
  type: string
- contextPath: Proofpoint.Report.Dropper.Platform.Name
  description: The name of the platform.
  type: string
- contextPath: Proofpoint.Report.Dropper.Platform.OS
  description: The operating system of the platform.
  type: string
- contextPath: Proofpoint.Report.Dropper.Platform.Version
  description: The version of the platform.
  type: string
- contextPath: Proofpoint.Report.File
  description: Files evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.File.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.File.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.File.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.File.Path
  description: Optional. The location of the file operated on.
  type: string
- contextPath: Proofpoint.Report.File.Action
  description: Optional. The filesystem call made (create, modify, or delete).
  type: string
- contextPath: Proofpoint.Report.File.Rule
  description: Optional. The name of the static rule inside the sandbox that identified
    the suspicious file.
  type: string
- contextPath: Proofpoint.Report.File.SHA256
  description: Optional. The SH256 hash of the file's contents.
  type: string
- contextPath: Proofpoint.Report.File.MD5
  description: Optional. The MD5 hash of the file's contents.
  type: string
- contextPath: Proofpoint.Report.File.Size
  description: Optional. The size in bytes of the file's contents.
  type: string
- contextPath: Proofpoint.Report.File.Platform.Name
  description: The name of the platform.
  type: string
- contextPath: Proofpoint.Report.File.Platform.OS
  description: The operating system of the platform.
  type: string
- contextPath: Proofpoint.Report.File.Platform.Version
  description: The version of the platform.
  type: string
- contextPath: Proofpoint.Report.IDS
  description: IDS evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.IDS.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.IDS.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.IDS.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.IDS.Name
  description: The friendly name of the IDS rule that observed the malicious traffic.
  type: string
- contextPath: Proofpoint.Report.IDS.SignatureID
  description: The identifier of the IDS rule that observed the malicious traffic.
  type: string
- contextPath: Proofpoint.Report.IDS.Platform.Name
  description: The name of the platform.
  type: string
- contextPath: Proofpoint.Report.IDS.Platform.OS
  description: The operating system of the platform.
  type: string
- contextPath: Proofpoint.Report.IDS.Platform.Version
  description: The version of the platform.
  type: string
- contextPath: Proofpoint.Report.Mutex
  description: Mutex evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.Mutex.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.Mutex.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.Mutex.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.Mutex.Name
  description: The name of the mutex.
  type: string
- contextPath: Proofpoint.Report.Mutex.Path
  description: Optional. The path to the process which spawned the mutex.
  type: string
- contextPath: Proofpoint.Report.Mutex.Platform.Name
  description: The name of the platform.
  type: string
- contextPath: Proofpoint.Report.Mutex.Platform.OS
  description: The operating system of the platform.
  type: string
- contextPath: Proofpoint.Report.Mutex.Platform.Version
  description: The version of the platform.
  type: string
- contextPath: Proofpoint.Report.Network
  description: Network evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.Network.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.Network.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.Network.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.Network.Action
  description: The type of network activity being initiated (connect or listen).
  type: string
- contextPath: Proofpoint.Report.Network.IP
  description: The remote IP address being contacted.
  type: string
- contextPath: Proofpoint.Report.Network.Port
  description: The remote IP port being contacted.
  type: string
- contextPath: Proofpoint.Report.Network.Type
  description: The protocol being used (tcp or udp).
  type: string
- contextPath: Proofpoint.Report.Network.Platform.Name
  description: The name of the platform.
  type: string
- contextPath: Proofpoint.Report.Network.Platform.OS
  description: The operating system of the platform.
  type: string
- contextPath: Proofpoint.Report.Network.Platform.Version
  description: The version of the platform.
  type: string
- contextPath: Proofpoint.Report.Process
  description: Processes evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.Process.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.Process.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.Process.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.Process.Action
  description: The action performed on the process. Relevant when create is produced.
  type: string
- contextPath: Proofpoint.Report.Process.Path
  description: The location of the executable that spawned the process.
  type: string
- contextPath: Proofpoint.Report.Process.Platform.Name
  description: The name of the platform.
  type: string
- contextPath: Proofpoint.Report.Process.Platform.OS
  description: The operating system of the platform.
  type: string
- contextPath: Proofpoint.Report.Process.Platform.Version
  description: The version of the platform.
  type: string
- contextPath: Proofpoint.Report.Registry
  description: Registry evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.Registry.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.Registry.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.Registry.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.Registry.Name
  description: Optional. The name of the registry entry being created or set.
  type: string
- contextPath: Proofpoint.Report.Registry.Action
  description: The registry change made (create or set).
  type: string
- contextPath: Proofpoint.Report.Registry.Key
  description: The location of the registry key being modified.
  type: string
- contextPath: Proofpoint.Report.Registry.Value
  description: Optional. The contents of the key being created or set.
  type: string
- contextPath: Proofpoint.Report.Registry.Platform.Name
  description: The name of the platform.
  type: string
- contextPath: Proofpoint.Report.Registry.Platform.OS
  description: The operating system of the platform.
  type: string
- contextPath: Proofpoint.Report.Registry.Platform.Version
  description: The version of the platform.
  type: string
- contextPath: Proofpoint.Report.URL
  description: URL evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.URL.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.URL.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.URL.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.URL.URL
  description: The URL which was observed.
  type: string
- contextPath: Proofpoint.Report.URL.Blacklisted
  description: Optional. Whether the URL appeared on a block list.
  type: boolean
- contextPath: Proofpoint.Report.URL.SHA256
  description: Optional. The SHA256 hash of the file downloaded from the URL.
  type: string
- contextPath: Proofpoint.Report.URL.MD5
  description: Optional. The MD5 hash of the file downloaded from the URL.
  type: string
- contextPath: Proofpoint.Report.URL.Size
  description: Optional. The size in bytes of the file retrieved from the URL.
  type: string
- contextPath: Proofpoint.Report.URL.HTTPStatus
  description: Optional. The HTTP status code that was produced when our sandbox visited
    the URL.
  type: string
- contextPath: Proofpoint.Report.URL.IP
  description: Optional. The IP address that was resolved to the hostname by the sandbox.
  type: string
- contextPath: Proofpoint.Report.URL.Platform.Name
  description: The name of the platform.
  type: string
- contextPath: Proofpoint.Report.URL.Platform.OS
  description: The operating system of the platform.
  type: string
- contextPath: Proofpoint.Report.URL.Platform.Version
  description: The version of the platform.
  type: string
- contextPath: Proofpoint.Report.Behavior
  description: Behavior evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.Behavior.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.Behavior.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.Behavior.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.Behavior.URL
  description: The URL that was observed.
  type: string
- contextPath: Proofpoint.Report.Behavior.Path
  description: The location of the executable which spawned the behavior.
  type: string
- contextPath: Proofpoint.Report.Behavior.Platform.Name
  description: The name of the platform.
  type: string
- contextPath: Proofpoint.Report.Behavior.Platform.OS
  description: The operating system of the platform.
  type: string
- contextPath: Proofpoint.Report.Behavior.Platform.Version
  description: The version of the platform.
  type: string
- contextPath: Proofpoint.Report.Screenshot
  description: Screenshot evidence type objects retrieved from Proofpoint TAP.
  type: string
- contextPath: Proofpoint.Report.Screenshot.Time
  description: The relative time at which the evidence was observed during sandboxing.
  type: date
- contextPath: Proofpoint.Report.Screenshot.Malicious
  description: Whether the evidence was used to reach a malicious verdict.
  type: string
- contextPath: Proofpoint.Report.Screenshot.Display
  description: A friendly display string.
  type: string
- contextPath: Proofpoint.Report.Screenshot.URL
  description: The URL hosting the screenshot image.
  type: string
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d0a6d09f-cfce-4fbe-8803-cd7c64d5dc12
      iscommand: false
      name: ""
      version: -1
    taskid: d0a6d09f-cfce-4fbe-8803-cd7c64d5dc12
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 540,
          "y": -240
        }
      }
  "1":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: type
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: message
      label: Message
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: incident.type
          operator: containsGeneral
          right:
            value:
              simple: click
      label: Clicks
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      Clicks:
      - "26"
      Message:
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine the type of event that has been triggered.
      id: 9e439bc0-d507-47a2-81b6-2a03648f15f2
      iscommand: false
      name: Which Proofpoint Event?
      type: condition
      version: -1
    taskid: 9e439bc0-d507-47a2-81b6-2a03648f15f2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 540,
          "y": -100
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: campaignid
                root: incident.proofpointtapthreatinfomap
          operator: isNotEmpty
          right:
            value: {}
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: incident.proofpointtapthreatinfomap.campaignid
          operator: isNotEqualString
          right:
            value:
              simple: "null"
      label: Campaign ID Found
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      Campaign ID Found:
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Verifies whether a campaign ID exists in the incident data.
      id: ef809bf9-0ff6-4c9f-8125-0fd4b6a1df87
      iscommand: false
      name: Check if Campaign ID Exists
      type: condition
      version: -1
    taskid: ef809bf9-0ff6-4c9f-8125-0fd4b6a1df87
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 320,
          "y": 200
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: proofpointtapcampaignid
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: incident.proofpointtapcampaignid
          operator: isNotEqualString
          right:
            value:
              simple: "null"
      label: 'Campiagn ID Found '
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "21"
      'Campiagn ID Found ':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Verifies whether a campaign ID exists in the incident data.
      id: 13e328af-657a-4dd0-82a0-ed4f85588d7c
      iscommand: false
      name: Check if Campaign ID Exists
      type: condition
      version: -1
    taskid: 13e328af-657a-4dd0-82a0-ed4f85588d7c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 760,
          "y": 200
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: No information to enrich
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to War Room (Markdown supported)
      id: e18da134-5586-4335-83de-5a41e78bbcde
      iscommand: false
      name: No Threat ID or Campaign ID Retrieved
      script: Print
      tags:
      - ProofPoint Event Enrichment
      type: regular
      version: -1
    taskid: e18da134-5586-4335-83de-5a41e78bbcde
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1260,
          "y": 720
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    reputationcalc: 3
    scriptarguments:
      campaign_id:
        complex:
          accessor: campaignid
          root: Proofpoint
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get details for a given campaign.
      id: dc9751ab-8580-40a7-8915-cb58110df9ae
      iscommand: true
      name: Get Campaign Information given ID
      script: '|||proofpoint-get-campaign'
      tags:
      - ProofPoint Event Enrichment
      type: regular
      version: -1
    taskid: dc9751ab-8580-40a7-8915-cb58110df9ae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 310,
          "y": 1520
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      campaignId:
        complex:
          accessor: campaignid
          root: Proofpoint
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Proofpoint TAP v2
      description: Returns forensics evidence.
      id: a5fcdcc0-0934-41d8-8f5c-5f0735032993
      iscommand: true
      name: Get Forensics given Campaign ID
      script: Proofpoint TAP v2|||proofpoint-get-forensics
      tags:
      - ProofPoint Event Enrichment
      type: regular
      version: -1
    taskid: a5fcdcc0-0934-41d8-8f5c-5f0735032993
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 310,
          "y": 1360
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      includeCampaignForensics:
        simple: "true"
      threatId:
        complex:
          accessor: threatid
          root: Proofpoint
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Proofpoint TAP v2
      description: Returns forensics evidence.
      id: ea01903c-cfa4-43bc-8193-73526c49a367
      iscommand: true
      name: Get Forensics Information given Threat ID
      script: Proofpoint TAP v2|||proofpoint-get-forensics
      tags:
      - ProofPoint Event Enrichment
      type: regular
      version: -1
    taskid: ea01903c-cfa4-43bc-8193-73526c49a367
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 770,
          "y": 1195
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Proofpoint.campaignid
      value:
        complex:
          accessor: campaignid
          root: incident.proofpointtapthreatinfomap
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: a22d7083-0b03-4fa7-80f5-79d76501e77b
      iscommand: false
      name: Extract Campaign ID to Context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: a22d7083-0b03-4fa7-80f5-79d76501e77b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -60,
          "y": 370
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: threatid
                root: incident.proofpointtapthreatinfomap
          operator: isNotEmpty
          right:
            value: {}
      label: Threat ID Found
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      Threat ID Found:
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Verifies whether a threat ID exists in the incident data.
      id: 0a29535c-be88-4006-831c-452f37c74488
      iscommand: false
      name: Check if Threat ID Exists
      type: condition
      version: -1
    taskid: 0a29535c-be88-4006-831c-452f37c74488
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 320,
          "y": 540
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    reputationcalc: 3
    scriptarguments:
      includeCampaignForensics:
        simple: "true"
      threatId:
        complex:
          accessor: threatid
          root: Proofpoint
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Proofpoint TAP v2
      description: Returns forensics evidence.
      id: 61afbde2-5346-4987-8d24-ef91c7ee79aa
      iscommand: true
      name: Get Forensics Information given Threat ID
      script: Proofpoint TAP v2|||proofpoint-get-forensics
      tags:
      - ProofPoint Event Enrichment
      type: regular
      version: -1
    taskid: 61afbde2-5346-4987-8d24-ef91c7ee79aa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 310,
          "y": 1195
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 95e67cf0-0f94-4a5d-84a2-1a2be7dd4977
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 95e67cf0-0f94-4a5d-84a2-1a2be7dd4977
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 540,
          "y": 1695
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Proofpoint.campaignid
      value:
        complex:
          accessor: proofpointtapcampaignid
          root: incident
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 7cb6f7b6-3f59-470a-8a63-c483f182ffc9
      iscommand: false
      name: Extract Campaign ID to Context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 7cb6f7b6-3f59-470a-8a63-c483f182ffc9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 370
        }
      }
  "21":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: proofpointtapthreatid
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      label: Threat ID Found
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      Threat ID Found:
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Verifies whether a threat ID exists in the incident data.
      id: 6e9097a2-1f5c-43e5-83e5-1422cd0fb645
      iscommand: false
      name: Check if Threat ID Exists
      type: condition
      version: -1
    taskid: 6e9097a2-1f5c-43e5-83e5-1422cd0fb645
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 760,
          "y": 540
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Proofpoint.threatid
      value:
        complex:
          accessor: threatid
          root: incident.proofpointtapthreatinfomap
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 6c14be7c-81f6-4b79-89cb-9f94b01f932c
      iscommand: false
      name: Extract Threat ID to Context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 6c14be7c-81f6-4b79-89cb-9f94b01f932c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 320,
          "y": 720
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Proofpoint.threatid
      value:
        complex:
          accessor: proofpointtapthreatid
          root: incident
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 50cbc688-45b4-4760-852e-997e82d0ac73
      iscommand: false
      name: Extract Threat ID to Context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 50cbc688-45b4-4760-852e-997e82d0ac73
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 760,
          "y": 720
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3284ae9f-6610-4455-8442-9ca77569cebd
      iscommand: false
      name: Enrichment
      type: title
      version: -1
    taskid: 3284ae9f-6610-4455-8442-9ca77569cebd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 540,
          "y": 890
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2784076f-d470-483f-82a8-17c7a03c465d
      iscommand: false
      name: Message Events
      type: title
      version: -1
    taskid: 2784076f-d470-483f-82a8-17c7a03c465d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 320,
          "y": 70
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 401e49ee-717d-4d26-8b1b-876978b22a77
      iscommand: false
      name: Click Events
      type: title
      version: -1
    taskid: 401e49ee-717d-4d26-8b1b-876978b22a77
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 760,
          "y": 70
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: campaignid
                root: Proofpoint
          operator: isExists
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: Proofpoint.threatid
          operator: isExists
      label: Campaign ID and ThreatID
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: campaignid
                root: Proofpoint
          operator: isExists
      label: 'Campaign ID '
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: threatid
                root: Proofpoint
          operator: isExists
      label: ThreatID
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "19"
      'Campaign ID ':
      - "6"
      Campaign ID and ThreatID:
      - "18"
      ThreatID:
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether campaign ID and/or threat ID were extracted from
        the incident data.
      id: 3735b5e0-33f2-4cc7-8f34-48a5fbd4e85c
      iscommand: false
      name: What Information has been Fetched?
      type: condition
      version: -1
    taskid: 3735b5e0-33f2-4cc7-8f34-48a5fbd4e85c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 540,
          "y": 1020
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      message:
        simple: The detected event type cannot be enriched with forensic evidence.
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints an error entry with a given message
      id: 90d452b9-2684-42b9-8cc1-d69c5e092053
      iscommand: false
      name: Irrelevant Event Type
      script: PrintErrorEntry
      tags:
      - ProofPoint Event Enrichment
      type: regular
      version: -1
    taskid: 90d452b9-2684-42b9-8cc1-d69c5e092053
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1250,
          "y": 70
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "10_22_Threat ID Found": 0.65,
      "1_25_Message": 0.41,
      "1_26_Clicks": 0.4,
      "27_18_Campaign ID and ThreatID": 0.59,
      "27_7_ThreatID": 0.65,
      "2_8_Campaign ID Found": 0.52
    },
    "paper": {
      "dimensions": {
        "height": 2000,
        "width": 1700,
        "x": -60,
        "y": -240
      }
    }
  }
