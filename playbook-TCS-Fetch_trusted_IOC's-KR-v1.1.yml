contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 200ef570-1daa-49bd-8d92-66a11f1b896e
inputs: []
name: TCS-Fetch trusted IOC's-KR-v1.1
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 78784554-8ad0-4491-8f3f-4f6a94fe013f
      iscommand: false
      name: ""
      version: -1
    taskid: 78784554-8ad0-4491-8f3f-4f6a94fe013f
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -440,
          "y": -10
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      method:
        simple: GET
      proxy:
        simple: "true"
      url:
        simple: https://endpoints.office.com/endpoints/worldwide?clientrequestid=b10c5ed1-bad1-445f-b386-b919946339a7
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends http request. Returns the response as json.
      id: dc02fb1b-af85-4fd4-85c7-9472f54053e4
      iscommand: false
      name: Get 0365 indicators
      script: http
      type: regular
      version: -1
    taskid: dc02fb1b-af85-4fd4-85c7-9472f54053e4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -440,
          "y": 120
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${HttpRequest.Response.Body}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 74844fe4-59c9-42a2-8c25-68a8e3dec544
      iscommand: true
      name: extract indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 74844fe4-59c9-42a2-8c25-68a8e3dec544
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -440,
          "y": 300
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Trusted
      value:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3bb36bdb-f96a-4ab4-8c1e-8a28d87aa415
      iscommand: false
      name: Set common context for IP
      script: Set
      type: regular
      version: -1
    taskid: 3bb36bdb-f96a-4ab4-8c1e-8a28d87aa415
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -640,
          "y": 480
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted
      value:
        complex:
          accessor: CIDR
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2a0f18e3-c042-4d4d-8bf4-5a720b25bb85
      iscommand: false
      name: Set common context  for CIDR
      script: Set
      type: regular
      version: -1
    taskid: 2a0f18e3-c042-4d4d-8bf4-5a720b25bb85
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": 490
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted
      value:
        complex:
          accessor: Domain
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5dcf032a-82c2-4f5c-8b8b-07fec61d18ef
      iscommand: false
      name: Set common context for Domain
      script: Set
      type: regular
      version: -1
    taskid: 5dcf032a-82c2-4f5c-8b8b-07fec61d18ef
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -640,
          "y": 660
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted
      value:
        complex:
          accessor: Domain_Test_
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c43b51f0-fd63-461d-8a49-2397d20b5a0b
      iscommand: false
      name: Set common context for Domain test
      script: Set
      type: regular
      version: -1
    taskid: c43b51f0-fd63-461d-8a49-2397d20b5a0b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": 660
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      method:
        simple: GET
      proxy:
        simple: "true"
      url:
        simple: https://www.gstatic.com/ipranges/cloud.json
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends http request. Returns the response as json.
      id: 01a2993d-732c-4d18-8637-750cf08a4b8a
      iscommand: false
      name: Get Google indicators(1)
      script: http
      type: regular
      version: -1
    taskid: 01a2993d-732c-4d18-8637-750cf08a4b8a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 330,
          "y": 120
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${HttpRequest.Response.Body}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 120d00fd-f7be-433e-8037-e5241eabfe32
      iscommand: true
      name: Extract indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 120d00fd-f7be-433e-8037-e5241eabfe32
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 330,
          "y": 270
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted
      value:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: bb8ab49c-a38f-43fb-8635-f401b7f65e34
      iscommand: false
      name: Set common context for IP
      script: Set
      type: regular
      version: -1
    taskid: bb8ab49c-a38f-43fb-8635-f401b7f65e34
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 330,
          "y": 430
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted
      value:
        complex:
          accessor: CIDR
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c1f69514-57f4-440d-8361-8ce5b5f3ecac
      iscommand: false
      name: Set common context  for CIDR
      script: Set
      type: regular
      version: -1
    taskid: c1f69514-57f4-440d-8361-8ce5b5f3ecac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 330,
          "y": 585
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      method:
        simple: GET
      proxy:
        simple: "true"
      url:
        simple: https://www.gstatic.com/ipranges/goog.json
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends http request. Returns the response as json.
      id: 41f5ba6a-e458-4084-8fec-06e25e2d05e3
      iscommand: false
      name: Get google indicators(2)
      script: http
      type: regular
      version: -1
    taskid: 41f5ba6a-e458-4084-8fec-06e25e2d05e3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 120
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${HttpRequest.Response.Body}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: cc22f832-5cfc-4095-8b50-c1244d635039
      iscommand: true
      name: Extract indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: cc22f832-5cfc-4095-8b50-c1244d635039
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 280
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted
      value:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: caf7d37b-d483-4c3f-86a7-01f913633870
      iscommand: false
      name: Set common context for IP
      script: Set
      type: regular
      version: -1
    taskid: caf7d37b-d483-4c3f-86a7-01f913633870
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 440
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted
      value:
        complex:
          accessor: CIDR
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: eab1ef95-5bdb-4a2e-81f0-d160f81bb979
      iscommand: false
      name: Set common context  for CIDR
      script: Set
      type: regular
      version: -1
    taskid: eab1ef95-5bdb-4a2e-81f0-d160f81bb979
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 605
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: intuneindicators=value
      query:
        simple: sourceInstances:"Microsoft Intune Feed_instance_1"
      size:
        simple: "500"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 1cd6fa44-b3da-438d-8ab0-0643637146b4
      iscommand: true
      name: Get intune indicators
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 1cd6fa44-b3da-438d-8ab0-0643637146b4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 110
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: intuneindicators
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 54067f36-c056-4d39-8e17-2acfe819c831
      iscommand: false
      name: are there any result?
      type: condition
      version: -1
    taskid: 54067f36-c056-4d39-8e17-2acfe819c831
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 270
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted
      value:
        complex:
          root: intuneindicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5e23f522-0431-49cd-80e7-cdb5de07f345
      iscommand: false
      name: Set common Context
      script: Set
      type: regular
      version: -1
    taskid: 5e23f522-0431-49cd-80e7-cdb5de07f345
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 430
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ExtractedIndicators,HttpRequest
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: a5f8acf9-8207-498f-8477-4381ac742214
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: a5f8acf9-8207-498f-8477-4381ac742214
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": 840
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ExtractedIndicators,HttpRequest
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 20fac418-27dc-4fe5-8816-97ff1a829e50
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 20fac418-27dc-4fe5-8816-97ff1a829e50
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 330,
          "y": 735
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ExtractedIndicators,HttpRequest
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 699d6f6f-4be6-40ca-8a7f-77f0650ae152
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 699d6f6f-4be6-40ca-8a7f-77f0650ae152
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 770
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: intuneindicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 816501a9-4770-4bc2-8d2e-a49eda68cf8e
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 816501a9-4770-4bc2-8d2e-a49eda68cf8e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 575
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: Trusted
          transformers:
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      listName:
        simple: TrustedIOClist-Autofetched
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 465aaf3d-c0d9-4363-8a8b-e83f8c853662
      iscommand: true
      name: Setlist
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 465aaf3d-c0d9-4363-8a8b-e83f8c853662
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 755
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ExtractedIndicators,HttpRequest
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 8909dd70-4830-4ee5-8038-afa74076e68f
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 8909dd70-4830-4ee5-8038-afa74076e68f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2950,
          "y": 2450
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hi Team,

                  Trusted IOC's fetched and updated successfully in list

          Regards,
          Cyberbot
      subject:
        simple: Autofetch Trusted indicators
      to:
        simple: keerthana.ramesh@tcs.com,porkodi.g@tcs.com.komal.lugade@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: ad995e33-4797-4924-898d-0f4cff1edf6d
      iscommand: true
      name: Send Mail to Team
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: ad995e33-4797-4924-898d-0f4cff1edf6d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 940
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: a85629e1-a39e-40ad-8427-125946bba802
      iscommand: true
      name: Closeinvestigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: a85629e1-a39e-40ad-8427-125946bba802
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 1130
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4b0adf00-a6a9-4d81-82c8-ac69bc177c7f
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: 4b0adf00-a6a9-4d81-82c8-ac69bc177c7f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1290,
          "y": 1300
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2555,
        "width": 3970,
        "x": -640,
        "y": -10
      }
    }
  }
