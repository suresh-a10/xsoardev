contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 1f5d8553-6158-4663-8db3-ab634b754996
inputs:
- description: ""
  key: Indicators
  playbookInputQuery: null
  required: false
  value: {}
name: TCS - Reconcillation playbook_CSOC_KR
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e2e7427d-0a44-49a8-8ee7-a1c96dc7e956
      iscommand: false
      name: ""
      version: -1
    taskid: e2e7427d-0a44-49a8-8ee7-a1c96dc7e956
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1110,
          "y": -280
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${indicator}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: c05c0539-8e35-48dc-845b-37bd934334f9
      iscommand: true
      name: Extract Indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: c05c0539-8e35-48dc-845b-37bd934334f9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 265
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 28f3ea44-9919-469e-8a6a-568584ee8f35
      iscommand: false
      name: Is There an IPv4 IP Address in the Context?
      type: condition
      version: -1
    taskid: 28f3ea44-9919-469e-8a6a-568584ee8f35
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -3860,
          "y": 690
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6f680964-3a27-434f-812f-2cf7da769b58
      iscommand: false
      name: Is There a URL in The Context?
      type: condition
      version: -1
    taskid: 6f680964-3a27-434f-812f-2cf7da769b58
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -3430,
          "y": 690
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: File
                root: ExtractedIndicators
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5b914857-4938-49fe-8cbf-2c29e93a21d1
      iscommand: false
      name: Is There a Hash in The Context?
      type: condition
      version: -1
    taskid: 5b914857-4938-49fe-8cbf-2c29e93a21d1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2130,
          "y": 690
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Unblock.IPV4
      value:
        simple: ${ExtractedIndicators.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8aac5d3d-ebc3-4127-8b6a-27550491f016
      iscommand: false
      name: Set Context
      script: Set
      type: regular
      version: -1
    taskid: 8aac5d3d-ebc3-4127-8b6a-27550491f016
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -4040,
          "y": 945
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Unblock.URL
      value:
        simple: ${ExtractedIndicators.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 47066b58-9a70-4519-8dbb-def29b2193ae
      iscommand: false
      name: Set URL in context
      script: Set
      type: regular
      version: -1
    taskid: 47066b58-9a70-4519-8dbb-def29b2193ae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -3430,
          "y": 865
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Unblock.Domain
      value:
        complex:
          accessor: Domain
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 55b4fcd5-631a-4dd9-8fd3-b42a0948c659
      iscommand: false
      name: Set Domain in context
      script: Set
      type: regular
      version: -1
    taskid: 55b4fcd5-631a-4dd9-8fd3-b42a0948c659
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2530,
          "y": 880
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Unblock.Hash
      value:
        simple: ${ExtractedIndicators.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 84c668cd-915c-46f0-809c-1254faae0cc7
      iscommand: false
      name: Set hash in context
      script: Set
      type: regular
      version: -1
    taskid: 84c668cd-915c-46f0-809c-1254faae0cc7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2060,
          "y": 880
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5a32a5fc-3f61-410c-84ba-9b0e5b096fe7
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: 5a32a5fc-3f61-410c-84ba-9b0e5b096fe7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -3000,
          "y": 880
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator=value
      query:
        simple: (tags:"csocblockedip" or tags:"CSOCBlockURL" or tags:"CSOCBlockDomain"
          or tags:"csocblockedhash") and expirationStatus:active and creationdate:>="${sixmonthsago.[0]}T00:00:00
          +0530" and creationdate:<="${sixmonthsago.[0]}T23:59:00 +0530"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 2ebac6cd-549a-4264-87ea-85ab100651ae
      iscommand: true
      name: Find reconcile indicators
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 2ebac6cd-549a-4264-87ea-85ab100651ae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 70
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0fcd3455-6bfa-4443-8fa7-8dfc98981e4e
      iscommand: false
      name: Check for Risk score Below 65
      type: title
      version: -1
    taskid: 0fcd3455-6bfa-4443-8fa7-8dfc98981e4e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 440
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f28c5821-c674-4ac6-8d53-130697961946
      iscommand: false
      name: Is There a Domain in The Context?
      type: condition
      version: -1
    taskid: f28c5821-c674-4ac6-8d53-130697961946
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2795,
          "y": 690
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: BELOWSIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6f072132-c8b6-4c16-8b12-487cf6bd0467
      iscommand: false
      name: 'Any IoC(s) Below Risk Score 65 ? '
      type: condition
      version: -1
    taskid: 6f072132-c8b6-4c16-8b12-487cf6bd0467
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 740
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7bfea310-5a9a-43e3-8231-2baede731e32
      iscommand: false
      name: TCS-Preprocessing Playbook For Reconciliation Review Request v1.0_KR
      playbookId: 45310316-33ad-43c8-8d62-e52d24af459e
      type: playbook
      version: -1
    taskid: 7bfea310-5a9a-43e3-8231-2baede731e32
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 920
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      emailbodyhtml:
        simple: ${HTMLBody}
      iocvalue:
        complex:
          root: Below65
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: \n
            operator: split
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      name:
        simple: IOC Reconciliation Review - CSOC Blocked IOC
      parentincidentlink:
        simple: ${incidentlink}
      reviewdomain:
        complex:
          accessor: Domain
          root: BELOWSIXFIVE
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      reviewhash:
        complex:
          accessor: File
          root: BELOWSIXFIVE
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      reviewip:
        complex:
          accessor: IP
          root: BELOWSIXFIVE
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      reviewipaddress:
        complex:
          accessor: IP
          root: BELOWSIXFIVE
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      reviewurl:
        complex:
          accessor: URL
          root: BELOWSIXFIVE
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      ticketnumber:
        simple: HT-${incident.id}
      type:
        simple: IOC Reconcillation Review
      whyareyoublacklistingtheseiocs:
        simple: ${incident.whyareyoublacklistingtheseiocs}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.create.inc
      id: fafb9568-08db-4d45-85e1-ce138b798356
      iscommand: true
      name: Create a New Ticket To Track IoC Blocking
      script: Builtin|||createNewIncident
      type: regular
      version: -1
    taskid: fafb9568-08db-4d45-85e1-ce138b798356
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 1080
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #ff00ff;">IoCs
          With Risk Score Below 65 Have Been Submitted For L3 Review</span><br /></em></h2>'
      below65:
        simple: '<h2 style="text-align: center;"><em><span style="color: #ff00ff;">IoCs
          With Risk Score Below 65 Have Been Submitted For L3 Review</span><br /></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 70857584-c948-405e-8947-e93820b9c6c1
      iscommand: true
      name: Set Action Notification - IoCs With Risk Score Below 65 Have Been Submitted
        For L2 Review
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 70857584-c948-405e-8947-e93820b9c6c1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 1250
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 071e2477-f202-4065-8968-795a8b8afec1
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 071e2477-f202-4065-8968-795a8b8afec1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 1430
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      File:
        complex:
          accessor: File
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      MD5:
        complex:
          accessor: MD5
          root: File
          transformers:
          - operator: uniq
      SHA1:
        complex:
          accessor: SHA1
          root: File
          transformers:
          - operator: uniq
      SHA256:
        complex:
          accessor: SHA256
          root: File
          transformers:
          - operator: uniq
      URL:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Entity Reputation using sub-playbooks
      id: 1f1e0d3c-f2ee-478e-82e2-6a9b3d43c2a1
      iscommand: false
      name: TCS-Recorded Future IOC Reputation v3.0_Copy_KR
      playbookName: TCS-Recorded Future IOC Reputation v3.0_Copy_KR
      type: playbook
      version: -1
    taskid: 1f1e0d3c-f2ee-478e-82e2-6a9b3d43c2a1
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 520,
          "y": 470
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      File:
        complex:
          accessor: File
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      MD5:
        complex:
          accessor: MD5
          root: File
          transformers:
          - operator: uniq
      SHA1:
        complex:
          accessor: SHA1
          root: File
          transformers:
          - operator: uniq
      SHA256:
        complex:
          accessor: SHA256
          root: File
          transformers:
          - operator: uniq
      URL:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Entity Reputation using sub-playbooks
      id: 188e810d-05c2-45da-81c7-9132642046d4
      iscommand: false
      name: TCS-Recorded Future IOC Reputation v3.0_KK
      playbookId: 03487cba-86c9-4b9b-8a78-3805d1df14e3
      type: playbook
      version: -1
    taskid: 188e810d-05c2-45da-81c7-9132642046d4
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 575
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: sixmonthsago
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: 6 months ago
            operator: ModifyDateTime
          - args:
              delimiter:
                value:
                  simple: T
            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9887fd1e-e540-4250-8f37-90d70a81711d
      iscommand: false
      name: Set the creation date
      script: Set
      type: regular
      version: -1
    taskid: 9887fd1e-e540-4250-8f37-90d70a81711d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": -120
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 549f5693-0612-40d0-8984-7577909d1fa3
      iscommand: false
      name: END
      type: title
      version: -1
    taskid: 549f5693-0612-40d0-8984-7577909d1fa3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 1600
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1945,
        "width": 5530,
        "x": -4040,
        "y": -280
      }
    }
  }
