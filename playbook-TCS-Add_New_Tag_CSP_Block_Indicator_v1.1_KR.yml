contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 90ec7565-d8f5-4878-89ff-e5fb6325be06
inputs:
- description: ""
  key: IOC
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Add New Tag CSP Block Indicator v1.1_KR
outputs: []
quiet: true
sourceplaybookid: 3186f946-ebeb-4fec-8c59-71f81733bb52
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b8681a7f-7018-4dfe-8ff4-7a45790f088f
      iscommand: false
      name: ""
      version: -1
    taskid: b8681a7f-7018-4dfe-8ff4-7a45790f088f
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -390,
          "y": -5260
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0b3f1028-fbb5-4056-859c-4fa6f3ae0ab6
      iscommand: false
      name: Is Indicator Context Set ?
      type: condition
      version: -1
    taskid: 0b3f1028-fbb5-4056-859c-4fa6f3ae0ab6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -390,
          "y": -5120
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: indicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 18b9ad54-ba78-4046-8623-65f028e4b2f3
      iscommand: false
      name: Delete 'Indicator' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 18b9ad54-ba78-4046-8623-65f028e4b2f3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -390,
          "y": -4905
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: a3a8f393-a3fb-4ffb-863a-fde1030cc313
      iscommand: true
      name: Check If IP Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: a3a8f393-a3fb-4ffb-863a-fde1030cc313
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -350,
          "y": -315
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 218564d1-f619-41b6-8273-a80eddf26b0a
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 218564d1-f619-41b6-8273-a80eddf26b0a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -350,
          "y": -90
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: expirydate
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: in 24 months
            operator: ModifyDateTime
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 21ff9800-176e-4aa2-8033-45195f00a4a2
      iscommand: false
      name: Calculate Expiry Date
      script: Set
      type: regular
      version: -1
    taskid: 21ff9800-176e-4aa2-8033-45195f00a4a2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 120
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a22acbb2-b534-42a5-8ee3-7e89df14a505
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: a22acbb2-b534-42a5-8ee3-7e89df14a505
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -310,
          "y": 660
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 41ccb432-5cef-44e3-8dfc-d069d6c18297
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 41ccb432-5cef-44e3-8dfc-d069d6c18297
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -290,
          "y": 890
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 544a01b4-f484-41c2-8c57-585afa9a8262
      iscommand: true
      name: Add New CSP Tag to IP
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 544a01b4-f484-41c2-8c57-585afa9a8262
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -310,
          "y": 1165
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: IP
      value:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: b36036f9-f6bc-4a42-8ac5-6eaf154cc4c0
      iscommand: true
      name: Tag The IP Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: b36036f9-f6bc-4a42-8ac5-6eaf154cc4c0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1650,
          "y": -75
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 86c622e0-2816-41fb-80df-21a78ee60a03
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 86c622e0-2816-41fb-80df-21a78ee60a03
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -20,
          "y": 2220
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: d53b0ef4-48ea-4cb1-8a5d-0e42faedb2f6
      iscommand: true
      name: Check If  domain Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: d53b0ef4-48ea-4cb1-8a5d-0e42faedb2f6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 120,
          "y": -410
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 50dc4463-b833-440b-82c0-b623618d3c60
      iscommand: true
      name: Check If Indicators Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 50dc4463-b833-440b-82c0-b623618d3c60
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -390,
          "y": -4740
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e197363c-42c8-45ae-8ff0-3a934464b09b
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: e197363c-42c8-45ae-8ff0-3a934464b09b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -340,
          "y": 135
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: Domain
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: b6dc6ca7-48b0-4c08-8204-0db89e4c1b69
      iscommand: true
      name: Tag The Domain Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: b6dc6ca7-48b0-4c08-8204-0db89e4c1b69
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 20
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: URL
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: c7300a41-c1f3-4b80-8fc3-af9cf02e4ee4
      iscommand: true
      name: Tag The URL Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: c7300a41-c1f3-4b80-8fc3-af9cf02e4ee4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1270,
          "y": 40
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 659dfe6d-2ce0-4428-877f-25268a6d0538
      iscommand: true
      name: Add New CSP Tag to Domain
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 659dfe6d-2ce0-4428-877f-25268a6d0538
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 1165
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 53d2f5e3-6d8a-4a20-8e43-e0c2756f55bf
      iscommand: true
      name: Add New CSP Tag to URL
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 53d2f5e3-6d8a-4a20-8e43-e0c2756f55bf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -800,
          "y": 1165
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Address2.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 09a7a253-0808-4cc0-8e3f-ed4f14ce0095
      iscommand: false
      name: Delete IP IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 09a7a253-0808-4cc0-8e3f-ed4f14ce0095
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -280,
          "y": 355
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: ffcb7ded-18b6-41f3-8af7-57d608a9811b
      iscommand: false
      name: Delete URL IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: ffcb7ded-18b6-41f3-8af7-57d608a9811b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 355
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: d2cee158-d149-4edb-86c1-245268d86916
      iscommand: false
      name: Delete  domain IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: d2cee158-d149-4edb-86c1-245268d86916
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 140,
          "y": 355
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: IP
      value:
        simple: ${inputs.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: d7e48271-4cc0-4b0d-81d4-019e2ece88eb
      iscommand: true
      name: Tag The Hash Indicator With 'CSP Block'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: d7e48271-4cc0-4b0d-81d4-019e2ece88eb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2080,
          "y": -75
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 695caf04-a0a0-49af-87aa-6bef02ea1524
      iscommand: false
      name: Delete hash IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 695caf04-a0a0-49af-87aa-6bef02ea1524
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 340
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 3e078198-d8b8-4db7-845b-cbdba1e427f5
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 3e078198-d8b8-4db7-845b-cbdba1e427f5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 180,
          "y": 900
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 88a419d7-b96f-4503-824f-6b8a54221de6
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 88a419d7-b96f-4503-824f-6b8a54221de6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -830,
          "y": 880
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: d03e86a1-eaab-47e1-82d5-bf5f65eae248
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: d03e86a1-eaab-47e1-82d5-bf5f65eae248
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 900
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: d379bda5-a287-4b92-83da-26f8f787da22
      iscommand: true
      name: Add New CSP Tag to  hash
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: d379bda5-a287-4b92-83da-26f8f787da22
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 1165
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicator.value=value::indicator.tag=CustomFields.tags::indicator.expirystatus=expirationStatus
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: c0d48eb3-8f0b-4bf7-8918-68539106dcd9
      iscommand: true
      name: Check If  hash Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: c0d48eb3-8f0b-4bf7-8918-68539106dcd9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 590,
          "y": -450
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: ip
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.URL
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: url
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: domain
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.File
          operator: containsGeneral
          right:
            iscontext: true
            value:
              simple: inputs.IOC
      label: file
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      domain:
      - "39"
      file:
      - "67"
      ip:
      - "65"
      url:
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4a42de0b-c4c2-4bb2-8664-ad46fdfd87fa
      iscommand: false
      name: Check which input is defined
      type: condition
      version: -1
    taskid: 4a42de0b-c4c2-4bb2-8664-ad46fdfd87fa
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -390,
          "y": -4560
        }
      }
  "30":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8b15384a-e2c6-40d1-8e67-91e81a15743d
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 8b15384a-e2c6-40d1-8e67-91e81a15743d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1150,
          "y": -345
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 52cbf2b6-1d63-454d-8c6c-1a3eb51f1e2b
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 52cbf2b6-1d63-454d-8c6c-1a3eb51f1e2b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 120,
          "y": -250
        }
      }
  "32":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f5e157cf-6ca7-452a-85b6-1b6cfa46508d
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: f5e157cf-6ca7-452a-85b6-1b6cfa46508d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 580,
          "y": -240
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5c8dc921-b9e4-406f-887e-be1e869bba41
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 5c8dc921-b9e4-406f-887e-be1e869bba41
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 630,
          "y": 120
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 83816813-a982-4510-843b-1955eeefc296
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 83816813-a982-4510-843b-1955eeefc296
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -930,
          "y": 120
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ab1bafc3-01d1-4c21-8096-ad3a159a46cc
      iscommand: false
      name: Is This Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: ab1bafc3-01d1-4c21-8096-ad3a159a46cc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 130,
          "y": 120
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4ba9e75b-4224-45b1-8475-bcea5e4631b4
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 4ba9e75b-4224-45b1-8475-bcea5e4631b4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 620,
          "y": 680
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5621f4a1-6ddd-485e-8068-df26c0ab1038
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 5621f4a1-6ddd-485e-8068-df26c0ab1038
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 160,
          "y": 670
        }
      }
  "38":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "18"
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 949ba80e-8a1b-4782-800f-194bb33b91da
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 949ba80e-8a1b-4782-800f-194bb33b91da
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -960,
          "y": 680
        }
      }
  "39":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "75"
      "yes":
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a7386a27-96b8-4f25-83cb-9a5277103d61
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: a7386a27-96b8-4f25-83cb-9a5277103d61
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -800,
          "y": -4350
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: certblockipaddress
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: csocblockedip
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "54"
      "yes":
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b5904bb9-0eae-4306-8dde-8bc382d0f92d
      iscommand: false
      name: Is This IP Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: b5904bb9-0eae-4306-8dde-8bc382d0f92d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2130,
          "y": -4160
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "76"
      "yes":
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 884cebbf-d696-4f5d-8ebf-e0a9311b3f40
      iscommand: false
      name: Is This Domain Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 884cebbf-d696-4f5d-8ebf-e0a9311b3f40
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -800,
          "y": -4140
        }
      }
  "47":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "104"
      "yes":
      - "101"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f3fee620-1b4d-4597-8083-3d9adcb8583c
      iscommand: false
      name: Is This Hash Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: f3fee620-1b4d-4597-8083-3d9adcb8583c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1880,
          "y": -4160
        }
      }
  "48":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockURL
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: COSCBlockDomain
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: emailblock
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: CERTBlockDomain
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "82"
      "yes":
      - "84"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d3832e29-7884-415f-8113-9d02025d02db
      iscommand: false
      name: Is This URL Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: d3832e29-7884-415f-8113-9d02025d02db
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": -4140
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 54c10505-21fe-453f-8112-ea8c944073a7
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 54c10505-21fe-453f-8112-ea8c944073a7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1970,
          "y": -3990
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      reconcillationdate:
        simple: ${Reconcillation date}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 6b30f907-9f6d-4e9f-81d4-811deb3d0829
      iscommand: true
      name: Add New CSP Tag to IP and Set Expiry to 30 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 6b30f907-9f6d-4e9f-81d4-811deb3d0829
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1930,
          "y": -3640
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 58209f63-498d-47b6-8013-dc88a7b15017
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 58209f63-498d-47b6-8013-dc88a7b15017
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1970,
          "y": -3810
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "70"
      "yes":
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 47e4ccc6-5aa7-457b-8f38-4bbdfd470390
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 47e4ccc6-5aa7-457b-8f38-4bbdfd470390
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1900,
          "y": -4350
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "81"
      "yes":
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 47c2722f-940f-4e84-8f24-fde188403965
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 47c2722f-940f-4e84-8f24-fde188403965
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 370,
          "y": -4330
        }
      }
  "67":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "102"
      "yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6697bf7d-a3a9-468c-8861-7e7b813576fc
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 6697bf7d-a3a9-468c-8861-7e7b813576fc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1870,
          "y": -4330
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7c2095ee-f615-49db-8d30-f8b0e662a6ca
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 7c2095ee-f615-49db-8d30-f8b0e662a6ca
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -640,
          "y": -3380
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: IP
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 84afa070-77b3-4d45-8293-52ccca248385
      iscommand: true
      name: Create New CSP IP Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 84afa070-77b3-4d45-8293-52ccca248385
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1520,
          "y": -4140
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: bafcf89c-7294-4ed7-8ffc-99bafb786a5a
      iscommand: true
      name: 'Set expiry date to 30 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: bafcf89c-7294-4ed7-8ffc-99bafb786a5a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1520,
          "y": -3745
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 5ee58df0-99c3-4c3a-8e6c-ca2d8ac14979
      iscommand: false
      name: Delete IP IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 5ee58df0-99c3-4c3a-8e6c-ca2d8ac14979
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2340,
          "y": -3690
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "80"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: Domain
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 4888d895-8780-4045-812c-e61b68ccfb43
      iscommand: true
      name: Create New CSP Domain Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 4888d895-8780-4045-812c-e61b68ccfb43
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -360,
          "y": -4065
        }
      }
  "76":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 872edef1-958b-4a39-8796-e0b789f5217e
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 872edef1-958b-4a39-8796-e0b789f5217e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -780,
          "y": -3965
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 05969296-8eb3-416d-8f0c-7da7601d40ed
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 05969296-8eb3-416d-8f0c-7da7601d40ed
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -770,
          "y": -3730
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: b1c2e6ce-71b3-4d07-812b-54a834abad98
      iscommand: false
      name: Delete Domain IOC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: b1c2e6ce-71b3-4d07-812b-54a834abad98
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1140,
          "y": -3610
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      reconcillationdate:
        simple: ${Reconcillation date}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 37ace682-de6b-4b3b-8565-22da47c536cc
      iscommand: true
      name: Add New CSP Tag to Domain and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 37ace682-de6b-4b3b-8565-22da47c536cc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -730,
          "y": -3560
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: b9640476-b960-42e0-89d3-da0b9fb583f0
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: b9640476-b960-42e0-89d3-da0b9fb583f0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -340,
          "y": -3690
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: URL
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 707c959f-a365-46c1-88ed-63e2265075ce
      iscommand: true
      name: Create New CSP URL Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 707c959f-a365-46c1-88ed-63e2265075ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": -3990
        }
      }
  "82":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "85"
      "yes":
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5d96d539-954c-44f3-892a-e4a7eed4ea1c
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 5d96d539-954c-44f3-892a-e4a7eed4ea1c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 420,
          "y": -3920
        }
      }
  "83":
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "85"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: c9184452-23d0-4653-8c52-5922ac6665e6
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: c9184452-23d0-4653-8c52-5922ac6665e6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": -3745
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 2a8a05f6-7235-4fb3-8b0b-2b37a2b7a1e9
      iscommand: false
      name: Delete  URL OC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 2a8a05f6-7235-4fb3-8b0b-2b37a2b7a1e9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -40,
          "y": -3580
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      reconcillationdate:
        simple: ${Reconcillation date}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 220700c3-eda7-4e59-8110-d501c720c7fa
      iscommand: true
      name: Add New CSP Tag to URL and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 220700c3-eda7-4e59-8110-d501c720c7fa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 420,
          "y": -3595
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: 14cf6d72-c19e-4505-86ba-bd883f81774f
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: 14cf6d72-c19e-4505-86ba-bd883f81774f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 830,
          "y": -3605
        }
      }
  "101":
    continueonerrortype: ""
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: File
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: ce217151-850c-4ba9-872d-fb4c3e80b1d0
      iscommand: false
      name: Delete  File OC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: ce217151-850c-4ba9-872d-fb4c3e80b1d0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1730,
          "y": -3785
        }
      }
  "102":
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "103"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: File
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 161c0dff-c3c8-412d-8892-618facc91c99
      iscommand: true
      name: Create New CSP File Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 161c0dff-c3c8-412d-8892-618facc91c99
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1290,
          "y": -3980
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: f68a6f96-a976-4786-82f4-bf91c5785dad
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: f68a6f96-a976-4786-82f4-bf91c5785dad
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1280,
          "y": -3650
        }
      }
  "104":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "106"
      "yes":
      - "105"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 91cd92f0-eda4-4229-8f68-26ca70885479
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 91cd92f0-eda4-4229-8f68-26ca70885479
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2170,
          "y": -3940
        }
      }
  "105":
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 2dae91ed-7d87-4f6d-81a8-31dca83b9790
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 2dae91ed-7d87-4f6d-81a8-31dca83b9790
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2190,
          "y": -3760
        }
      }
  "106":
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      reconcillationdate:
        simple: ${Reconcillation date}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: c2fa7bed-0c9e-4503-8b5a-7312191cf6a5
      iscommand: true
      name: Add New CSP Tag to File and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: c2fa7bed-0c9e-4503-8b5a-7312191cf6a5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2170,
          "y": -3560
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "1_2_yes": 0.44,
      "29_67_file": 0.45,
      "39_45_yes": 0.51,
      "54_56_yes": 0.53,
      "65_44_yes": 0.35,
      "66_48_yes": 0.37,
      "67_47_yes": 0.58
    },
    "paper": {
      "dimensions": {
        "height": 7545,
        "width": 4910,
        "x": -2340,
        "y": -5260
      }
    }
  }
