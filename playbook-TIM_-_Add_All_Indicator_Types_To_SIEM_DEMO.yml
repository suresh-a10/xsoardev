contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.5.0
    itemVersion: 1.0.4
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: |-
  This playbook runs sub playbooks that send indicators to your SIEM. To select the indicators you want to add, go to playbook inputs, choose “from indicators” and set your query. For example tags:approved_black, approved_white etc. The purpose of the playbook is to send to SIEM only indicators that have been processed and tagged accordingly after an automatic or manual review process. The default playbook query is"
  (type:ip or type:file or type:Domain or type:URL) -tags:pending_review and (tags:approved_black or tags:approved_white or tags:approved_watchlist)"
  In case more indicator types need to be sent to the SIEM, the query must be edited accordingly.
id: ea1c597f-e916-4822-8034-05df24083a3e
inputs:
- description: ""
  key: ""
  playbookInputQuery:
    daterange:
      fromdate: "0001-01-01T00:00:00Z"
      fromdatelicenseval: "0001-01-01T00:00:00Z"
      period:
        by: ""
        byfrom: ""
        byto: ""
        field: ""
        fromvalue: null
        tovalue: null
      todate: "0001-01-01T00:00:00Z"
    query: (type:ip or type:file or type:Domain or type:URL) -tags:pending_review
      and (tags:approved_black or tags:approved_white or tags:approved_watchlist)
      and expirationStatus:active
    queryEntity: indicators
    results: null
    runFromLastJobTime: false
  required: false
  value: {}
name: TIM - Add All Indicator Types To SIEM_DEMO
outputs: []
sourceplaybookid: TIM - Add All Indicator Types To SIEM
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
      - "5"
      - "7"
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 72eaef0a-e8d6-4f6e-8f21-927ddaccf86d
      iscommand: false
      name: ""
      version: -1
    taskid: 72eaef0a-e8d6-4f6e-8f21-927ddaccf86d
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": -430
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 429654a8-1662-49b9-87fe-995f796c7522
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 429654a8-1662-49b9-87fe-995f796c7522
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 70
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: playbookQuery.indicator_type
                    operator: isEqualString
                    right:
                      value:
                        simple: IP
                root: playbookQuery
                transformers:
                - operator: uniq
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7f27a8d8-2fe5-432b-8c66-34f9e2f9eeb8
      iscommand: false
      name: Are there IP results?
      type: condition
      version: -1
    taskid: 7f27a8d8-2fe5-432b-8c66-34f9e2f9eeb8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 200,
          "y": -270
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: playbookQuery.indicator_type
                    operator: isEqualString
                    right:
                      value:
                        simple: File
                - - left:
                      iscontext: true
                      value:
                        simple: playbookQuery.CustomFields.tags
                    operator: isEqualString
                    right:
                      value:
                        simple: approved_black
                root: playbookQuery
                transformers:
                - operator: uniq
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2a2ae8d6-8ff3-4ceb-802c-36fb3320b4b6
      iscommand: false
      name: Are there bad Hash results?
      type: condition
      version: -1
    taskid: 2a2ae8d6-8ff3-4ceb-802c-36fb3320b4b6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 700,
          "y": -270
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: playbookQuery.indicator_type
                    operator: isEqualString
                    right:
                      value:
                        simple: Domain
                root: playbookQuery
                transformers:
                - operator: uniq
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a5e29656-49a5-49c7-81d2-aa455bf59a38
      iscommand: false
      name: Are there Domain results?
      type: condition
      version: -1
    taskid: a5e29656-49a5-49c7-81d2-aa455bf59a38
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1510,
          "y": -270
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: playbookQuery.indicator_type
                    operator: isEqualString
                    right:
                      value:
                        simple: URL
                root: playbookQuery
                transformers:
                - operator: uniq
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 003721dd-8aec-43db-84fe-47d0ac084cae
      iscommand: false
      name: Are there URL results?
      type: condition
      version: -1
    taskid: 003721dd-8aec-43db-84fe-47d0ac084cae
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -670,
          "y": -270
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        TIM playbook - This playbook receives indicators from its parent playbook
          and provides the indicators as inputs for the sub-playbooks that push the indicators
          to your SIEM.
      id: ae223c31-d8ca-45df-8ac5-c85deaa365e4
      iscommand: false
      name: TIM - Add Url Indicators To SIEM_DEMO
      playbookId: ce933941-714f-451a-8a93-8c3e4c2b8d28
      type: playbook
      version: -1
    taskid: ae223c31-d8ca-45df-8ac5-c85deaa365e4
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -900,
          "y": -100
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: b4863c65-52f5-481f-8905-3ee32b68fd45
      iscommand: false
      name: TIM - Add Bad Hash Indicators To SIEM_DEMO
      playbookId: 89f8a496-58b0-4562-87d1-fd9169e0dd56
      type: playbook
      version: -1
    taskid: b4863c65-52f5-481f-8905-3ee32b68fd45
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 870,
          "y": -100
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 758fdf44-68b2-405f-8d55-a05903609924
      iscommand: false
      name: TIM - Add Domain Indicators To SIEM_DEMO
      playbookId: 473dc5a5-a9ce-4293-88a8-26200f4b4a72
      type: playbook
      version: -1
    taskid: 758fdf44-68b2-405f-8d55-a05903609924
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1670,
          "y": -100
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 5dca3994-0163-469c-82fd-917b4eefecf7
      iscommand: false
      name: TIM - Add IP Indicators To SIEM_DEMO
      playbookId: 01987ea0-aa31-4db8-8cf8-d46080346c57
      type: playbook
      version: -1
    taskid: 5dca3994-0163-469c-82fd-917b4eefecf7
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -150,
          "y": -120
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 565,
        "width": 2950,
        "x": -900,
        "y": -430
      }
    }
  }
