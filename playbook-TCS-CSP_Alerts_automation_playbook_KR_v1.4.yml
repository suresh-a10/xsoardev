contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: f0b405a8-bcf0-408f-832e-25b67ff85868
inputs: []
name: TCS-CSP Alerts automation playbook_KR_v1.4
outputs: []
sourceplaybookid: 988d87a9-fb4c-4d7b-82cd-f2fbfa1b2070
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "117"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9ef34ee9-17f5-4768-8082-e545885e0263
      iscommand: false
      name: ""
      version: -1
    taskid: 9ef34ee9-17f5-4768-8082-e545885e0263
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 980,
          "y": -1690
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Expose the incident owner into IncidentOwner context key
      id: fbc61a18-3c0f-441d-869c-b08a04edb64e
      iscommand: false
      name: Populate Incident Owner Context
      script: ExposeIncidentOwner
      type: regular
      version: -1
    taskid: fbc61a18-3c0f-441d-869c-b08a04edb64e
    timertriggers:
    - action: start
      fieldname: closuresla
    - action: start
      fieldname: detectionsla
    type: regular
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 220
        }
      }
  "41":
    continueonerror: true
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        simple: AutoAssignment_Lock
      timeout:
        simple: "600"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Demisto Lock
      description: Gets a specific lock. If the lock doesn't exist, it creates one.
        If the lock is already in use, the command waits until the lock is released
        or until timeout is reached. If timeout is reached and the lock hasn't been
        released, the command fails to get the lock.
      id: 567fe206-5905-4d71-88c2-a32cda915340
      iscommand: true
      name: Locking the Assignment Task
      script: Demisto Lock|||demisto-lock-get
      type: regular
      version: -1
    taskid: 567fe206-5905-4d71-88c2-a32cda915340
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1010,
          "y": -260
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 2
    scriptarguments:
      desc:
        complex:
          accessor: subject
          root: incident
      incidentid:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 41a5428e-a803-41ce-86c5-a5f943bb102d
      iscommand: false
      name: AutoAssign Analyst To Incident
      script: 0021cb92-321d-4754-81a1-66fc6a41635d
      type: regular
      version: -1
    taskid: 41a5428e-a803-41ce-86c5-a5f943bb102d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1010,
          "y": -105
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 2
    scriptarguments:
      name:
        simple: AutoAssignment_Lock
    separatecontext: false
    skipunavailable: false
    task:
      brand: Demisto Lock
      description: Release a lock
      id: 13d75d55-6763-4c3a-8da9-b8eb66d18233
      iscommand: true
      name: Release the Assignment Task
      script: Demisto Lock|||demisto-lock-release
      type: regular
      version: -1
    taskid: 13d75d55-6763-4c3a-8da9-b8eb66d18233
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 60
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      selectshift:
        complex:
          accessor: roles
          root: UserByUsername
          transformers:
          - args:
              from:
                value:
                  simple: '['
            operator: substringFrom
          - args:
              to:
                value:
                  simple: ']'
            operator: substringTo
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ' '
            operator: join
          - args:
              regex:
                value:
                  simple: ' CSOC-XSOAR-Admin'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Read-Only'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Operator'
              replaceWith: {}
            operator: replaceMatch
          - args:
              delimiter: {}
            operator: splitAndTrim
      shift:
        complex:
          accessor: roles
          root: UserByUsername
          transformers:
          - args:
              from:
                value:
                  simple: '['
            operator: substringFrom
          - args:
              to:
                value:
                  simple: ']'
            operator: substringTo
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ' '
            operator: join
          - args:
              regex:
                value:
                  simple: ' CSOC-XSOAR-Admin'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Read-Only'
              replaceWith: {}
            operator: replaceMatch
          - args:
              regex:
                value:
                  simple: ' Operator'
              replaceWith: {}
            operator: replaceMatch
          - args:
              delimiter: {}
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: c95412f0-3996-4de9-89ae-b882cf9cd501
      iscommand: true
      name: Set Investigator Role In Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: c95412f0-3996-4de9-89ae-b882cf9cd501
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1012.5,
          "y": 680
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    scriptarguments:
      username:
        complex:
          accessor: owner
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.get.user.by.username
      id: d71dcb41-de02-4205-8e8a-d8690b1d56a2
      iscommand: true
      name: Get Incident Owner Details
      script: Builtin|||getUserByUsername
      type: regular
      version: -1
    taskid: d71dcb41-de02-4205-8e8a-d8690b1d56a2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 370
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "97"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9957baaf-ade7-41b3-8e2f-449b83f4f9dc
      iscommand: false
      name: Start Detection and Closure SLA Timers
      type: title
      version: -1
    taskid: 9957baaf-ade7-41b3-8e2f-449b83f4f9dc
    timertriggers:
    - action: start
      fieldname: closuresla
    - action: start
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 1010,
          "y": -565
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b4f91b60-b7c4-4caa-8f32-3f76db08fece
      iscommand: false
      name: Start Acknowledgement SLA
      type: title
      version: -1
    taskid: b4f91b60-b7c4-4caa-8f32-3f76db08fece
    timertriggers:
    - action: start
      fieldname: responsesla
    - action: start
      fieldname: acknowledgementsla
    type: title
    view: |-
      {
        "position": {
          "x": 1012.5,
          "y": 535
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5940179b-3856-4b11-874a-5e059c14a36a
      iscommand: false
      name: Set Severity
      type: title
      version: -1
    taskid: 5940179b-3856-4b11-874a-5e059c14a36a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1012.5,
          "y": 855
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: OrignalSeverity
      value:
        simple: ${incident.severity}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: ec7b7c20-4693-4c08-8d9f-31bc753a86f6
      iscommand: false
      name: Set Orignal Severity to Context
      script: Set
      type: regular
      version: -1
    taskid: ec7b7c20-4693-4c08-8d9f-31bc753a86f6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1012.5,
          "y": 1000
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "0.5"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 6778a20f-6eba-40e8-833c-1a0e82cf9ee6
      iscommand: true
      name: Set Severity to Informational
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6778a20f-6eba-40e8-833c-1a0e82cf9ee6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 1160
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "1"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f58940ec-21c5-4874-8c7b-fbf64cbbd82f
      iscommand: true
      name: 'Set Original Severity to Incident '
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f58940ec-21c5-4874-8c7b-fbf64cbbd82f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 1320
        }
      }
  "52":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: runStatus
                root: incident.responsesla
          operator: isEqualString
          right:
            value:
              simple: running
      label: "yes"
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "54"
      "yes":
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: db8697b9-fb14-4a16-8b21-84f57e00bd8e
      iscommand: false
      name: Is Response SLA Still Running ?
      type: condition
      version: -1
    taskid: db8697b9-fb14-4a16-8b21-84f57e00bd8e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 1480
        }
      }
  "53":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Have You Completed This Task
        options: []
        optionsarg:
        - {}
        - simple: Yes - Move To The Next Task
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Please Click The 'Lets Get Started!' Button
      totalanswers: 0
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aa5a7994-336d-4ebb-8fb4-c9a0df607b4b
      iscommand: false
      name: Please Click The 'Lets Get Started!' Button
      type: collection
      version: -1
    taskid: aa5a7994-336d-4ebb-8fb4-c9a0df607b4b
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 1665
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "92"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 70d54c64-4c7b-4030-891c-467654859ef1
      iscommand: false
      name: Stop Acknowledgement SLA
      type: title
      version: -1
    taskid: 70d54c64-4c7b-4030-891c-467654859ef1
    timertriggers:
    - action: stop
      fieldname: responsesla
    - action: stop
      fieldname: acknowledgementsla
    type: title
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 1830
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c00257ff-f325-46b0-87ad-755b1278616a
      iscommand: false
      name: False Positive (Stop Detection Timer)
      type: title
      version: -1
    taskid: c00257ff-f325-46b0-87ad-755b1278616a
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 782.5,
          "y": 2485
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Is This a True Positive Alert ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No, Its a Confirmed - False Positive
      - No, Its a Benign-True Positive
      - Yes, it is True Positive
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      No, Its a Benign-True Positive:
      - "58"
      No, Its a Confirmed - False Positive:
      - "55"
      Yes, it is True Positive:
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 189a3fd1-2efc-4348-816c-311cf5db12e5
      iscommand: false
      name: Is This a True Positive Alert ?
      type: condition
      version: -1
    taskid: 189a3fd1-2efc-4348-816c-311cf5db12e5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1012.5,
          "y": 2280
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "101"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5f50fd4c-8546-42de-8ef1-d47f2c491856
      iscommand: false
      name: True Positive (Stop Detection SLA & Start Threat Response SLA)
      type: title
      version: -1
    taskid: 5f50fd4c-8546-42de-8ef1-d47f2c491856
    timertriggers:
    - action: stop
      fieldname: detectionsla
    - action: start
      fieldname: threatresponsesla
    type: title
    view: |-
      {
        "position": {
          "x": 1285,
          "y": 2505
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "98"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 726f9c94-9263-4fb6-86a4-07ac028575d0
      iscommand: false
      name: Benign True Positive (Stop Detection Timer)
      type: title
      version: -1
    taskid: 726f9c94-9263-4fb6-86a4-07ac028575d0
    timertriggers:
    - action: stop
      fieldname: detectionsla
    type: title
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2485
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 887cd5f8-bc7a-4431-8aab-8409b59c775c
      iscommand: false
      name: Document & Close Investigation
      type: title
      version: -1
    taskid: 887cd5f8-bc7a-4431-8aab-8409b59c775c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2170,
          "y": 3650
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 2
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: f5a92385-57a0-4f6a-83e6-8c662f7e56dc
      iscommand: false
      name: 'Sub Playbook: Document & Close'
      playbookId: 4a46e3dc-82da-4b3a-86ca-eb2f9dfd589f
      type: playbook
      version: -1
    taskid: f5a92385-57a0-4f6a-83e6-8c662f7e56dc
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2190,
          "y": 3820
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1281c018-2ef6-4e87-8435-1375f2bcfa4f
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 1281c018-2ef6-4e87-8435-1375f2bcfa4f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2247.5,
          "y": 4035
        }
      }
  "64":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: anyimpact
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Was there any Impact ? (service disruption, malware installed,
            successful C&C communication..etc) '
        options: []
        optionsarg:
        - {}
        - simple: "No"
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Was there any Impact ? (service disruption, malware installed, successful
        C&C communication..etc)
      totalanswers: 0
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "65"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 23446c24-34c5-4ed4-8dda-bb7faaf9db8b
      iscommand: false
      name: 'Was there any Impact ? ( malware installed, successful C&C communication..etc) '
      type: collection
      version: -1
    taskid: 23446c24-34c5-4ed4-8dda-bb7faaf9db8b
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1285,
          "y": 2850
        }
      }
  "65":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Was there any Impact ? .Answers
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "66"
    note: false
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bd9a6188-fcb8-4227-85d7-f22c3e58c836
      iscommand: false
      name: Does The CSOC Manager Need To Be Notified ? (auto select if impact is
        'Yes')
      tags:
      - report
      type: condition
      version: -1
    taskid: bd9a6188-fcb8-4227-85d7-f22c3e58c836
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1285,
          "y": 3015
        }
      }
  "66":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: emailbody
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter Notification Message To CSOC Manager (give a brief about the
            true positive alert and the impact)
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: Your SOC team
      title: Enter Notification Message To CSOC Manager
      totalanswers: 0
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "67"
    note: true
    quietmode: 2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d1705213-b822-47f9-888a-0fdff59296f9
      iscommand: false
      name: Enter Notification Message To CSOC Manager (give a brief about the true
        positive alert and the impact)
      type: collection
      version: -1
    taskid: d1705213-b822-47f9-888a-0fdff59296f9
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1295,
          "y": 3220
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 2
    scriptarguments:
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          ${incident.emailbody}

          Investigation Link --> https://soar.tcsapps.com/#/Custom/caseinfoid/${incident.id}
      cc:
        simple: ${UserByUsername.email}
      subject:
        simple: '*True Positive Notification* EDR Investigation - Severity - ${incident.mailerseverity}'
      to:
        simple: 'nimisha.prajapati@tcs.com,yogesh.gholap@tcs.com,csocsenioroperator@tcscomprod.onmicrosoft.com,csocanalyst@tcscomprod.onmicrosoft.com '
      using:
        simple: Mail Sender_instance_CSOC_Mail
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 1d16b155-0f09-4c6e-8e35-3ba9cc615df0
      iscommand: true
      name: Notify CSOC Manager & Necessary Stakeholders
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 1d16b155-0f09-4c6e-8e35-3ba9cc615df0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1295,
          "y": 3405
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Review The Alert - Check If You Need To Raise an IMT ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - No -  IMT Not Required
      - Yes - I Have Raised an IMT
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      No -  IMT Not Required:
      - "84"
      Yes - I Have Raised an IMT:
      - "85"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7ec4a09b-fc7c-480b-8efc-cd48cc926797
      iscommand: false
      name: Review The Alert - Check If You Need To Raise an IMT ?
      type: condition
      version: -1
    taskid: 7ec4a09b-fc7c-480b-8efc-cd48cc926797
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1295,
          "y": 3590
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "no"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: e2144d57-d8fb-42ff-8ca9-d6f55c197300
      iscommand: true
      name: Update IMT Context To - No
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: e2144d57-d8fb-42ff-8ca9-d6f55c197300
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1035,
          "y": 3790
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      imtraised:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f90c0d0d-fa92-42f3-82f7-e4689381360d
      iscommand: true
      name: Update IMT Context To - Yes
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f90c0d0d-fa92-42f3-82f7-e4689381360d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1550,
          "y": 3790
        }
      }
  "86":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: imtnumber
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Enter The IMT Number
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: ""
      title: Enter The IMT Number
      totalanswers: 0
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6cc323df-1017-4d04-84e2-5f7a804fc2dd
      iscommand: false
      name: Enter The IMT Number
      type: collection
      version: -1
    taskid: 6cc323df-1017-4d04-84e2-5f7a804fc2dd
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1550,
          "y": 3960
        }
      }
  "89":
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c75c6869-3719-448d-8d2b-537d3931a609
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: c75c6869-3719-448d-8d2b-537d3931a609
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 620,
          "y": 5690
        }
      }
  "90":
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "89"
    note: false
    quietmode: 2
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 3f60fb98-6bff-4601-8649-7a4da0a7ca5d
      iscommand: false
      name: 'Sub Playbook: Document & Close'
      playbookId: 4a46e3dc-82da-4b3a-86ca-eb2f9dfd589f
      type: playbook
      version: -1
    taskid: 3f60fb98-6bff-4601-8649-7a4da0a7ca5d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 620,
          "y": 5230
        }
      }
  "91":
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "118"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5b884093-0d40-4caf-8132-3e804405fa7e
      iscommand: false
      name: Share response to CSP team
      type: title
      version: -1
    taskid: 5b884093-0d40-4caf-8132-3e804405fa7e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 830,
          "y": 4180
        }
      }
  "92":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: whichslabreached
                root: incident
          operator: isEqualString
          right:
            value:
              simple: acknowledgementsla
        - left:
            iscontext: true
            value:
              complex:
                accessor: whichslabreached
                root: incident
          operator: containsGeneral
          right:
            value:
              simple: acknowledgementsla
      label: "yes"
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "93"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 880be6ea-1688-4c1a-864b-b5f40960a991
      iscommand: false
      name: Is response sla breached?
      type: condition
      version: -1
    taskid: 880be6ea-1688-4c1a-864b-b5f40960a991
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 1960
        }
      }
  "93":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: justificationforacknowledgementslabreached
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Provide justification for response sla violated
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: longText
      sender: Your SOC team
      title: Provide justification for response sla violated
      totalanswers: 0
    id: "93"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Provide justification for response sla violated
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8f59561b-5f7c-40cb-8951-f65d58a4d087
      iscommand: false
      name: Provide justification for response sla violated
      type: collection
      version: -1
    taskid: 8f59561b-5f7c-40cb-8951-f65d58a4d087
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 2120
        }
      }
  "97":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: owner
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 967bede0-d698-4427-8221-6486c147ce93
      iscommand: false
      name: Has Owner Been Assigned
      type: condition
      version: -1
    taskid: 967bede0-d698-4427-8221-6486c147ce93
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1010,
          "y": -420
        }
      }
  "98":
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: Benign-True positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 80c4f63f-4109-40a6-8f47-a8d1edf8d5c1
      iscommand: true
      name: Set incident as 'Benign-True positive'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 80c4f63f-4109-40a6-8f47-a8d1edf8d5c1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 350,
          "y": 2660
        }
      }
  "99":
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 876b9785-34df-43e3-8392-302b6543a218
      iscommand: true
      name: Set incident as 'False Positive'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 876b9785-34df-43e3-8392-302b6543a218
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 782.5,
          "y": 2670
        }
      }
  "101":
    continueonerrortype: ""
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 0
    scriptarguments:
      investigationconclusion:
        simple: True Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 3441ae38-9357-4818-83f7-d17bf8e94c3f
      iscommand: true
      name: set incident as 'True Positive'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 3441ae38-9357-4818-83f7-d17bf8e94c3f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1285,
          "y": 2680
        }
      }
  "102":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationanalysis
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationconclusion
                root: incident
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: closingnote
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "104"
      "yes":
      - "121"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1fc2ce00-158f-4ddb-8b43-9b42962d963c
      iscommand: false
      name: Check Report summary is not empty
      type: condition
      version: -1
    taskid: 1fc2ce00-158f-4ddb-8b43-9b42962d963c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 830,
          "y": 4690
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${Report.FileID}
      attachNames:
        simple: ${Report.Name}
      bcc:
        simple: porkodi.g@tcs.com,komal.lugade@tcs.com,keerthana.ramesh@tcs.com
      body:
        simple: |-
          Hi Team,

                Please find the above sheet for  analysis of ${incident.name}

          Thanks & Regards,
          Cyberautobot.
      subject:
        simple: ${incident.name} -${incident.occurred}
      to:
        simple: porkodi.g@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 2d58b3ed-2d78-446c-846c-dce36e75cd65
      iscommand: true
      name: share report to CSP team
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 2d58b3ed-2d78-446c-846c-dce36e75cd65
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -240,
          "y": 6460
        }
      }
  "104":
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "115"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h1 style="text-align: center;"><span style="color: #ffffff; background-color:
          #ff0000;"><strong>Oops!!You''ve Missed Filling a Mandatory Field. Double
          Check The ''Report Summary'' Tab</strong></span></h1>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: bf170db7-710a-4c98-8a46-58e4ccfd62cd
      iscommand: true
      name: Notify Mandatory Field Not Filled
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: bf170db7-710a-4c98-8a46-58e4ccfd62cd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 4870
        }
      }
  "108":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "108"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "122"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 45004d2a-67fe-4b35-885f-c792c21fad56
      iscommand: false
      name: Is there any  file ?
      tags:
      - report
      type: condition
      version: -1
    taskid: 45004d2a-67fe-4b35-885f-c792c21fad56
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 990,
          "y": -1110
        }
      }
  "109":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Name
                root: File.[0]
                transformers:
                - operator: toLowerCase
          operator: AnyMatch
          right:
            value:
              simple: analysis sheet
        - left:
            iscontext: true
            value:
              complex:
                accessor: Name
                root: File.[1]
          operator: AnyMatch
          right:
            value:
              simple: analysis sheet
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Name
                root: File.[2]
                transformers:
                - operator: toLowerCase
          operator: AnyMatch
          right:
            value:
              simple: analysis sheet
      label: "yes"
    continueonerrortype: ""
    id: "109"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2de9a5c8-bc2a-4442-8c32-b6586434698e
      iscommand: false
      name: Check file with Name "Analysis Sheet" and Extension
      type: condition
      version: -1
    taskid: 2de9a5c8-bc2a-4442-8c32-b6586434698e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -630,
          "y": -400
        }
      }
  "110":
    continueonerror: true
    continueonerrortype: ""
    id: "110"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: true
    quietmode: 0
    scriptarguments:
      entryId:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: xlsx
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: The automation takes Excel file (entryID) as an input and parses
        its content to the war room and context.
      id: 1affe043-f0aa-4add-83f5-05ad24a2af66
      iscommand: false
      name: Parseexcel
      script: ParseExcel
      type: regular
      version: -1
    taskid: 1affe043-f0aa-4add-83f5-05ad24a2af66
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1000,
          "y": -780
        }
      }
  "111":
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "124"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |+
          Hi team,

          There is no attachment present in the email. ${incident.rawName}
          Please attach relevant artifacts and share the mail to autobot.


          Thanks and Regards,
          Cyberautobot

      cc:
        simple: internalis.cybersecurityops@tcs.com,CyberAutoBotGrp@tcscomprod.onmicrosoft.com
      subject:
        simple: No attachment present -${incident.rawName}
      to:
        simple: ${incident.email}
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 8116d0e6-d9d8-46b3-825b-1c5530e482b4
      iscommand: true
      name: Inform team to CSP team there is no attachment present
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 8116d0e6-d9d8-46b3-825b-1c5530e482b4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1505,
          "y": -440
        }
      }
  "112":
    continueonerrortype: ""
    id: "112"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "126"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello Human,

          You are not in my authorized list of senders . Please contact Your XSOAR Support team.

          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: internalis.cybersecurityops@tcs.com,CyberAutoBotGrp@tcscomprod.onmicrosoft.com
      subject:
        simple: Not Authorized To Send Mail-CSP
      to:
        complex:
          accessor: email}
          root: ${incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: dd280261-ca7a-4883-86de-8cae78119934
      iscommand: true
      name: Send Email Notification - Not Authorized User
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: dd280261-ca7a-4883-86de-8cae78119934
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 300,
          "y": -1100
        }
      }
  "114":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationanalysis
                root: incident
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationconclusion
                root: incident
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "114"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "116"
      "yes":
      - "121"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 073afecb-bc46-4901-8c32-66524abce71e
      iscommand: false
      name: Check Report summary is not empty
      type: condition
      version: -1
    taskid: 073afecb-bc46-4901-8c32-66524abce71e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 5200
        }
      }
  "115":
    continueonerrortype: ""
    id: "115"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Oops!!You've Missed Filling a Mandatory Field. Double Check The 'Report
          Summary'
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes, I've finished Writing My Report summary
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Yes, I've finished Writing My Report summary:
      - "114"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a6a5919b-37c0-4696-820f-f5035ac053b2
      iscommand: false
      name: Oops!!You've Missed Filling a Mandatory Field. Double Check The 'Report
        Summary'
      type: condition
      version: -1
    taskid: a6a5919b-37c0-4696-820f-f5035ac053b2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 5015
        }
      }
  "116":
    continueonerrortype: ""
    id: "116"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "89"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hi Team,

               The report summary is blank Please check
      subject:
        simple: Blank report summary-${incident.name} -{incident.id}
      to:
        simple: internalis.cyberautobot@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 8dd0685c-06eb-4c9b-8680-23c6115af804
      iscommand: true
      name: 'Notify to Auto-bot Group '
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 8dd0685c-06eb-4c9b-8680-23c6115af804
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 5380
        }
      }
  "117":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: email
                root: incident
          operator: inList
          right:
            value:
              simple: ${lists.CSP-Authorizedsenders}
      label: "yes"
    continueonerrortype: ""
    id: "117"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "112"
      "yes":
      - "127"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3af0da6a-63c1-42b1-8eac-18d8983feefd
      iscommand: false
      name: Is user is part of CSP-authorized sender list?
      type: condition
      version: -1
    taskid: 3af0da6a-63c1-42b1-8eac-18d8983feefd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 980,
          "y": -1530
        }
      }
  "118":
    continueonerrortype: ""
    id: "118"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Please make sure to add investigation analysis in paragaraph, Dont
          give line in between also don't attach artifacts in analysis column.
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes, I've finished My analysis
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Yes, I've finished My analysis:
      - "119"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: af2725df-4ab2-4d1a-89de-defd509f03ac
      iscommand: false
      name: Have you Concluded The Investigation Analysis and  Conclusion?
      type: condition
      version: -1
    taskid: af2725df-4ab2-4d1a-89de-defd509f03ac
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 830,
          "y": 4320
        }
      }
  "119":
    continueonerrortype: ""
    id: "119"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Please male sure to update Investigation analysis and conclusion without
          fail
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes,Please share
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Yes,Please share:
      - "102"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c39f207c-c3cf-45a0-87f9-5f8caa1a1585
      iscommand: false
      name: Are You Ready To share report to CSP team?
      type: condition
      version: -1
    taskid: c39f207c-c3cf-45a0-87f9-5f8caa1a1585
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 830,
          "y": 4510
        }
      }
  "120":
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 875d977e-a8ed-4b86-8143-63cdc8b4d7e9
      iscommand: true
      name: Closeinvestigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 875d977e-a8ed-4b86-8143-63cdc8b4d7e9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1790,
          "y": 2230
        }
      }
  "121":
    continueonerrortype: ""
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    scriptarguments:
      name:
        simple: Investigation Analysis
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: 101be40a-0efb-4b5e-8968-153a463099fa
      iscommand: false
      name: Generate Report summary
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: 101be40a-0efb-4b5e-8968-153a463099fa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 620,
          "y": 4870
        }
      }
  "122":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File.Extension
          operator: isEqualString
          right:
            value:
              simple: xlsx
      label: "yes"
    continueonerrortype: ""
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "110"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 25b7d3b0-bd3c-4da9-872c-2fe99878b8ca
      iscommand: false
      name: Check the file extension
      type: condition
      version: -1
    taskid: 25b7d3b0-bd3c-4da9-872c-2fe99878b8ca
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1000,
          "y": -940
        }
      }
  "123":
    continueonerrortype: ""
    id: "123"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${Report.FileID}
      attachNames:
        simple: ${Report.Name}
      bcc:
        simple: porkodi.g@tcs.com,komal.lugade@tcs.com,keerthana.ramesh@tcs.com
      body:
        simple: |-
          Hi Team,

                Please find the above sheet for  analysis of ${incident.name}

          Thanks & Regards,
          Cyberautobot.
      cc:
        simple: madhhura.r@tcs.com,sri.sudhakar@tcs.com,ajithkumar.s5@tcs.com,akshitha.suram@tcs.com,praveenhariharan.ar@tcs.com,syamkiran.c@tcs.com,saisudheer.bandi@tcs.com,lavanya.mundru@tcs.com,internalis.cybersecurityops@tcs.com,shyam.kannan@tcs.com
      subject:
        simple: ${incident.name} -${incident.occurred}
      to:
        simple: ${incident.email},TCS.ISOCteam@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 41a6e3f3-673d-41c4-8022-2b0d5a838c03
      iscommand: true
      name: share report to CSP team
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 41a6e3f3-673d-41c4-8022-2b0d5a838c03
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 620,
          "y": 5045
        }
      }
  "124":
    continueonerrortype: ""
    id: "124"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      closingnote:
        simple: There is no file attachment present
      investigationanalysis:
        simple: There is no file attachment present
      investigationconclusion:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 1d41ec42-00b8-43be-80bf-406b324a05d1
      iscommand: true
      name: Set incident
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 1d41ec42-00b8-43be-80bf-406b324a05d1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": -180
        }
      }
  "125":
    continueonerrortype: ""
    id: "125"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 79deaf72-10e4-4d19-8b7a-6885bfc39b4c
      iscommand: true
      name: Close investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 79deaf72-10e4-4d19-8b7a-6885bfc39b4c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 110,
          "y": 5410
        }
      }
  "126":
    continueonerrortype: ""
    id: "126"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "125"
    note: false
    quietmode: 0
    scriptarguments:
      closingnote:
        simple: Not Authorized To Send Mail-CSP
      incidentclosingreason:
        simple: False positive
      investigationanalysis:
        simple: Not Authorized To Sender
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: c7ebc0eb-6d7c-429f-8199-57fbc789129a
      iscommand: true
      name: Set incident
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: c7ebc0eb-6d7c-429f-8199-57fbc789129a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 300,
          "y": -930
        }
      }
  "127":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: subject
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsGeneral
          right:
            value:
              simple: recall
      label: "yes"
    continueonerrortype: ""
    id: "127"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "108"
      "yes":
      - "128"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4696ec27-4338-4a50-8a26-fcfdd2a4e4d1
      iscommand: false
      name: Is the email recalled?
      type: condition
      version: -1
    taskid: 4696ec27-4338-4a50-8a26-fcfdd2a4e4d1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 980,
          "y": -1360
        }
      }
  "128":
    continueonerrortype: ""
    id: "128"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "125"
    note: false
    quietmode: 0
    scriptarguments:
      closingnote:
        simple: The email was recalled, so closing the incident
      investigationanalysis:
        simple: The email was recalled
      investigationconclusion:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 488a415b-2bf4-447b-865c-89adf03c01d4
      iscommand: true
      name: Set incident
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 488a415b-2bf4-447b-865c-89adf03c01d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -210,
          "y": -930
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 8245,
        "width": 3257.5,
        "x": -630,
        "y": -1690
      }
    }
  }
