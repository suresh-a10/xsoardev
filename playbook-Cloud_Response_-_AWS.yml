contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.5.0
    itemVersion: 1.1.20
    packID: AWS-Enrichment-Remediation
    packName: AWS Enrichment and Remediation
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: |-
  This playbook provides response actions to AWS. The following are available for execution automatically/manually:
   - Resource remediation:
     - Terminate the instance
     - Stop the instance
   - Identity remediation:
     - Delete the user
     - Revoke the user's credentials
  - Access key remediation:
     - Disable the access key
     - Delete the access key
  - Block indicators.
id: Cloud Response - AWS
inputs:
- description: |-
    Choose the remediation type for the user's access key.
    Disable - for disabling the user's access key.
    Delete - for the user's access key deletion.
  key: accessKeyRemediationType
  playbookInputQuery: null
  required: false
  value:
    simple: Disable
- description: |-
    Choose the remediation type for the user involved.
    Delete - for the user deletion.
    Revoke - for revoking the user's credentials.
  key: userRemediationType
  playbookInputQuery: null
  required: false
  value:
    simple: Revoke
- description: |-
    Choose the remediation type for the instances created.
    Stop - for stopping the instances.
    Terminate - for terminating the instances.
  key: resourceRemediationType
  playbookInputQuery: null
  required: false
  value:
    simple: Stop
- description: Whether to execute the resource remediation flow automatically.
  key: autoResourceRemediation
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Whether to execute the user remediation flow automatically.
  key: autoUserRemediation
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Whether to execute the access key remediation flow automatically.
  key: autoAccessKeyRemediation
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Whether to block the indicators automatically.
  key: autoBlockIndicators
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: The resource name to take action on.
  key: resourceName
  playbookInputQuery: null
  required: false
  value: {}
- description: The resource's region.
  key: region
  playbookInputQuery: null
  required: false
  value: {}
- description: The username to take action on.
  key: username
  playbookInputQuery: null
  required: false
  value: {}
- description: The user's access key ID.
  key: accessKeyId
  playbookInputQuery: null
  required: false
  value: {}
- description: The source IP address of the attacker.
  key: sourceIP
  playbookInputQuery: null
  required: false
  value: {}
name: Cloud Response - AWS
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
      - "1"
      - "4"
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cf64eba4-df4f-44d1-84c4-65c9ef85b786
      iscommand: false
      name: ""
      version: -1
    taskid: cf64eba4-df4f-44d1-84c4-65c9ef85b786
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 720,
          "y": 390
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4e285d3b-924b-48ab-8bb3-b1092e74a8a5
      iscommand: false
      name: Resource
      type: title
      version: -1
    taskid: 4e285d3b-924b-48ab-8bb3-b1092e74a8a5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2120,
          "y": 560
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: daead8d0-6cad-4acb-811a-c5eeb75fda74
      iscommand: false
      name: Block Indicators
      type: title
      version: -1
    taskid: daead8d0-6cad-4acb-811a-c5eeb75fda74
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2020,
          "y": 570
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3e349c03-2c6a-4283-8a64-50a326832bc6
      iscommand: false
      name: Identity
      type: title
      version: -1
    taskid: 3e349c03-2c6a-4283-8a64-50a326832bc6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 720,
          "y": 570
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.username
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is a user available for remediation.
      id: 1cfce3f9-b342-42b2-8b98-7ff57898aeae
      iscommand: false
      name: Is there a user to remediate?
      type: condition
      version: -1
    taskid: 1cfce3f9-b342-42b2-8b98-7ff57898aeae
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 720,
          "y": 710
        }
      }
  "18":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.autoUserRemediation
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "48"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the user chose automatic remediation.
      id: bab366d6-42ab-4202-8212-32c140333cda
      iscommand: false
      name: Should remediate automatically?
      type: condition
      version: -1
    taskid: bab366d6-42ab-4202-8212-32c140333cda
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 720,
          "y": 880
        }
      }
  "19":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.userRemediationType
          operator: isEqualString
          right:
            value:
              simple: Delete
      label: Delete
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.userRemediationType
          operator: isEqualString
          right:
            value:
              simple: Revoke
      label: Revoke
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      Delete:
      - "20"
      Revoke:
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks for the user's chosen remediation type.
      id: 09df0c87-0d3f-44aa-8590-36b83ceca692
      iscommand: false
      name: Continue by remediation type
      type: condition
      version: -1
    taskid: 09df0c87-0d3f-44aa-8590-36b83ceca692
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 720,
          "y": 1560
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      userName:
        complex:
          accessor: "0"
          root: Manual resource remediation.Answers
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.username
            operator: SetIfEmpty
          - operator: uniq
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Deletes the specified IAM user. The user must not belong to any
        groups or have any access keys, signing certificates, or attached policies.
      id: bcb34737-5db4-4545-8808-2a0cb92ce218
      iscommand: true
      name: Delete the user
      script: '|||aws-iam-delete-user'
      type: regular
      version: -1
    taskid: bcb34737-5db4-4545-8808-2a0cb92ce218
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 720,
          "y": 1750
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      userName:
        complex:
          accessor: "0"
          root: Manual resource remediation.Answers
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.username
            operator: SetIfEmpty
          - operator: uniq
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Deletes the password for the specified IAM user, which terminates
        the user's ability to access AWS services through the AWS Management Console.
      id: 8f08abbe-aa5b-4c80-839a-9ab12a7ef590
      iscommand: true
      name: Revoke user credentials
      script: '|||aws-iam-delete-login-profile'
      type: regular
      version: -1
    taskid: 8f08abbe-aa5b-4c80-839a-9ab12a7ef590
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 1750
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 710a1688-0775-418f-8cf2-3ff25fce9336
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 710a1688-0775-418f-8cf2-3ff25fce9336
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 80,
          "y": 1920
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.resourceName
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is a resource available for remediation.
      id: 312cdbd3-aab2-41e2-8a69-341cd3913558
      iscommand: false
      name: Is there a resource to remediate?
      type: condition
      version: -1
    taskid: 312cdbd3-aab2-41e2-8a69-341cd3913558
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2120,
          "y": 700
        }
      }
  "25":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.autoResourceRemediation
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "45"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the user chose automatic remediation.
      id: b27c6a54-04b8-445e-8321-7dee13880686
      iscommand: false
      name: Should remediate automatically?
      type: condition
      version: -1
    taskid: b27c6a54-04b8-445e-8321-7dee13880686
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2120,
          "y": 870
        }
      }
  "26":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.resourceRemediationType
          operator: isEqualString
          right:
            value:
              simple: Terminate
      label: Terminate
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.resourceRemediationType
          operator: isEqualString
          right:
            value:
              simple: Stop
      label: Stop
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "30"
      Stop:
      - "28"
      Terminate:
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks for the user's chosen remediation type.
      id: c4e8138a-50f0-48a0-8ac0-cd0850a67b71
      iscommand: false
      name: Continue by remediation type
      type: condition
      version: -1
    taskid: c4e8138a-50f0-48a0-8ac0-cd0850a67b71
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2120,
          "y": 1560
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      instanceIds:
        complex:
          root: remediateResourceList
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.resourceName
            operator: SetIfEmpty
      region:
        complex:
          root: inputs.region
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Shuts down one or more instances. This operation is idempotent;
        if you terminate an instance more than once, each call succeeds.
      id: c8b84c8e-9761-4faa-8549-5230b0bee94c
      iscommand: true
      name: Terminate the instance
      script: '|||aws-ec2-terminate-instances'
      type: regular
      version: -1
    taskid: c8b84c8e-9761-4faa-8549-5230b0bee94c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2120,
          "y": 1740
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      instanceIds:
        complex:
          root: remediateResourceList
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.resourceName
            operator: SetIfEmpty
      region:
        complex:
          root: inputs.region
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Stops an Amazon EBS-backed instance.
      id: aaa32ade-89a0-4bb6-8e31-1bf8b76a3244
      iscommand: true
      name: Stop the instance
      script: '|||aws-ec2-stop-instances'
      type: regular
      version: -1
    taskid: aaa32ade-89a0-4bb6-8e31-1bf8b76a3244
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2540,
          "y": 1740
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4103b833-432f-4188-81e4-624e0ce96ab6
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 4103b833-432f-4188-81e4-624e0ce96ab6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 1910
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 15ee420e-c091-45a1-8976-c55ba3885b17
      iscommand: false
      name: Privileges
      type: title
      version: -1
    taskid: 15ee420e-c091-45a1-8976-c55ba3885b17
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -790,
          "y": 570
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.accessKeyId
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is an access key available for remediation.
      id: 543841c1-14ca-425f-84e2-5611a40cf800
      iscommand: false
      name: Is there an access key to remediate?
      type: condition
      version: -1
    taskid: 543841c1-14ca-425f-84e2-5611a40cf800
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -790,
          "y": 700
        }
      }
  "37":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.autoAccessKeyRemediation
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the user chose automatic remediation.
      id: eabd4b85-795a-4fcb-8c8c-8125875c346a
      iscommand: false
      name: Should remediate automatically?
      type: condition
      version: -1
    taskid: eabd4b85-795a-4fcb-8c8c-8125875c346a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -790,
          "y": 885
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      accessKeyId:
        complex:
          root: inputs.accessKeyId
      status:
        simple: Inactive
      userName:
        complex:
          accessor: "0"
          root: Manual access key remediation.Answers
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.username
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Changes the status of the specified access key from Active to Inactive,
        or vice versa. This operation can be used to disable a user's key as part
        of a key rotation workflow.
      id: 07ee3ac8-53c2-49f2-8fc8-0a1394be0059
      iscommand: true
      name: Disable the access key
      script: '|||aws-iam-update-access-key'
      type: regular
      version: -1
    taskid: 07ee3ac8-53c2-49f2-8fc8-0a1394be0059
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 1600
        }
      }
  "39":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.accessKeyRemediationType
          operator: isEqualString
          right:
            value:
              simple: Disable
      label: Disable
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.accessKeyRemediationType
          operator: isEqualString
          right:
            value:
              simple: Rotate
      label: Delete
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "41"
      Delete:
      - "40"
      Disable:
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks for the user's chosen remediation type.
      id: 3524216f-4549-402a-82c5-9d06e60925c4
      iscommand: false
      name: Continue by remediation type
      type: condition
      version: -1
    taskid: 3524216f-4549-402a-82c5-9d06e60925c4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -790,
          "y": 1390
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      AccessKeyId:
        complex:
          root: inputs.accessKeyId
      userName:
        complex:
          accessor: "0"
          root: Manual access key remediation.Answers
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.username
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Deletes the access key pair associated with the specified IAM user.
      id: ace50672-d4ae-463b-8068-027b07a9f4b9
      iscommand: true
      name: Delete the access key
      script: '|||aws-iam-delete-access-key'
      type: regular
      version: -1
    taskid: ace50672-d4ae-463b-8068-027b07a9f4b9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -370,
          "y": 1600
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      id: 78c2d61c-90f3-4a29-8a15-62f7e07afbc3
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 78c2d61c-90f3-4a29-8a15-62f7e07afbc3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1420,
          "y": 1770
        }
      }
  "42":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Choose the user for access key remediation
        options: []
        optionsarg:
        - complex:
            root: inputs.username
            transformers:
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Manual access key remediation
      totalanswers: 0
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Analyst interaction is needed for the credentials remediation.
      cc: null
      format: ""
      methods: []
      subject:
        simple: Cloud Response - AWS - Credentials Remediation
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${incident.assigneduser}
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, nothing is returned.
      id: 6ee1b8cf-879c-4592-8e24-cf77e77047cb
      iscommand: false
      name: Choose a user for access key remediation
      type: collection
      version: -1
    taskid: 6ee1b8cf-879c-4592-8e24-cf77e77047cb
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -1170,
          "y": 1060
        }
      }
  "43":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Manual access key remediation.Answers
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks the user's answer.
      id: 913072c5-9f1a-4572-8cad-fd2024262ffe
      iscommand: false
      name: Check user answer
      type: condition
      version: -1
    taskid: 913072c5-9f1a-4572-8cad-fd2024262ffe
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1170,
          "y": 1220
        }
      }
  "45":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Choose resources to remediate
        options: []
        optionsarg:
        - simple: ALL
        - complex:
            root: inputs.resourceName
            transformers:
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: Your SOC team
      title: Manual resource remediation
      totalanswers: 0
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Analyst interaction is needed for the resource remediation.
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: Cloud Response - AWS - Resource Remediation
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${incident.assigneduser}
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, nothing is returned.
      id: 45617fee-be4e-455e-823b-d808752896f5
      iscommand: false
      name: Choose resources to remediate
      type: collection
      version: -1
    taskid: 45617fee-be4e-455e-823b-d808752896f5
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 1050
        }
      }
  "46":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Manual resource remediation.Answers
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks the user's answer.
      id: 1f73cc8e-b5b5-40cf-8c8d-8963f17c4e5b
      iscommand: false
      name: Check user answer
      type: condition
      version: -1
    taskid: 1f73cc8e-b5b5-40cf-8c8d-8963f17c4e5b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 1210
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: remediateResourceList
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Manual resource remediation.Answers.0
              operator: isNotEqualString
              right:
                value:
                  simple: ALL
          root: Manual resource remediation.Answers.0
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.resourceName
            operator: SetIfEmpty
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 66f67863-87e4-4f5e-8856-2d6b25a95053
      iscommand: false
      name: Set selected resources to remediate
      script: Set
      type: regular
      version: -1
    taskid: 66f67863-87e4-4f5e-8856-2d6b25a95053
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 1390
        }
      }
  "48":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Choose user to remediate
        options: []
        optionsarg:
        - complex:
            root: inputs.username
            transformers:
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: Your SOC team
      title: Manual user remediation
      totalanswers: 0
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Analyst interaction is needed for the user remediation.
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: Cloud Response - AWS - User Remediation
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${incident.assigneduser}
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, nothing is returned.
      id: 45209b5d-6952-45fd-8874-0254ec26d039
      iscommand: false
      name: Choose user to remediate
      type: collection
      version: -1
    taskid: 45209b5d-6952-45fd-8874-0254ec26d039
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 330,
          "y": 1050
        }
      }
  "49":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Manual user remediation.Answers
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks the user's answer.
      id: f522ce9e-32a4-41b3-8f08-3e461e320b7d
      iscommand: false
      name: Check user answer
      type: condition
      version: -1
    taskid: f522ce9e-32a4-41b3-8f08-3e461e320b7d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 330,
          "y": 1210
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        simple: "No"
      CustomBlockRule:
        simple: "True"
      IP:
        complex:
          root: blockIndicatorsList
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.sourceIP
            operator: SetIfEmpty
          - operator: uniq
      InputEnrichment:
        simple: "False"
      RuleDirection:
        simple: inbound
      RuleName:
        simple: XSOAR - Block IP playbook - ${incident.id}
      UserVerification:
        simple: "False"
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: "This playbook blocks malicious IP addresses using all integrations
        that are enabled. The direction of the traffic that will be blocked is determined
        by the Cortex XSOAR user (and set by default to outgoing)\nNote the following:\n-
        Some of those integrations require specific parameters to run, which are based
        on the playbook inputs. Also, certain integrations use FW rules or appended
        network objects.\n- Note that the appended network objects should be specified
        in blocking rules inside the system later on. \n\n\nSupported integrations
        for this playbook [Network security products such as FW/WAF/IPs/etc.]: \n\n*
        Check Point Firewall\n* Palo Alto Networks PAN-OS\n* Zscaler\n* FortiGate\n*
        Aria Packet Intelligence\n* Cisco Firepower \n* Cisco Secure Cloud Analytics\n*
        Cisco ASA\n* Akamai WAF\n* F5 SilverLine\n* ThreatX\n* Signal Sciences WAF\n*
        Sophos Firewall\n\n"
      id: eeac60d9-2cab-42cb-8a43-f2ee0bee6bbb
      iscommand: false
      name: Block IP - Generic v3
      playbookId: Block IP - Generic v3
      type: playbook
      version: -1
    taskid: eeac60d9-2cab-42cb-8a43-f2ee0bee6bbb
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -2020,
          "y": 1420
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 27f24ac8-e957-471f-880c-a659bc0d94ff
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 27f24ac8-e957-471f-880c-a659bc0d94ff
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2590,
          "y": 1600
        }
      }
  "52":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.autoBlockIndicators
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "53"
      "yes":
      - "50"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the user chose automatic.remediation.
      id: 607a944f-e0c5-44c1-8682-3d8212c85882
      iscommand: false
      name: Should block indicators automatically?
      type: condition
      version: -1
    taskid: 607a944f-e0c5-44c1-8682-3d8212c85882
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2020,
          "y": 700
        }
      }
  "53":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Choose indicators to block
        options: []
        optionsarg:
        - complex:
            root: inputs.sourceIP
            transformers:
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Block Indicators
      totalanswers: 0
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Analyst interaction is needed for the indicators remediation.
      cc: null
      format: ""
      methods: []
      subject:
        simple: Cloud Response - AWS - Block Indicators
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${incident.assigneduser}
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, nothing is returned.
      id: ffac410b-ada0-42a8-819b-a017faff78aa
      iscommand: false
      name: Choose indicators to block
      type: collection
      version: -1
    taskid: ffac410b-ada0-42a8-819b-a017faff78aa
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -2300,
          "y": 885
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Block Indicators.Answers
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "51"
      "yes":
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks the user's answer.
      id: f10149ae-cb98-4e78-8a85-c18ef55b99e4
      iscommand: false
      name: Check user answer
      type: condition
      version: -1
    taskid: f10149ae-cb98-4e78-8a85-c18ef55b99e4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2300,
          "y": 1050
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: blockIndicatorsList
      value:
        complex:
          accessor: "0"
          root: Block Indicators.Answers
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b00c02fa-87ff-4541-82aa-8117ebf4a1e0
      iscommand: false
      name: Set selected indicators to remediate
      script: Set
      type: regular
      version: -1
    taskid: b00c02fa-87ff-4541-82aa-8117ebf4a1e0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2300,
          "y": 1240
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "17_18_yes": 0.4,
      "17_23_#default#": 0.37,
      "18_19_yes": 0.4,
      "19_23_#default#": 0.77,
      "24_25_yes": 0.37,
      "24_30_#default#": 0.37,
      "25_26_yes": 0.12,
      "25_45_#default#": 0.56,
      "26_27_Terminate": 0.68,
      "26_28_Stop": 0.45,
      "26_30_#default#": 0.77,
      "36_37_yes": 0.52,
      "36_41_#default#": 0.36,
      "39_41_#default#": 0.78,
      "43_39_yes": 0.65,
      "43_41_#default#": 0.3,
      "46_30_#default#": 0.32,
      "49_19_yes": 0.63,
      "49_23_#default#": 0.31,
      "54_51_#default#": 0.57
    },
    "paper": {
      "dimensions": {
        "height": 1595,
        "width": 5510,
        "x": -2590,
        "y": 390
      }
    }
  }
