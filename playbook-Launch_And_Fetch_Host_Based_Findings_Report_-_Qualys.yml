contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.5.0
    itemVersion: 3.0.2
    packID: qualys
    packName: Qualys
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: Launches a host based report and fetches the report when it's ready.
id: Launch And Fetch Host Based Findings Report - Qualys
inputs:
- description: The template ID of the report you want to launch. Can be found by running
    the qualys-report-template-list command.
  key: template_id
  playbookInputQuery: null
  required: true
  value: {}
- description: One output format may be specified. When output_format=pdf is specified,
    the Secure PDF Distribution may be used.
  key: output_format
  playbookInputQuery: null
  required: true
  value: {}
- description: A user-defined report title. The title may have a maximum of 128 characters.
    For a PCI compliance report, the report title is provided by Qualys and cannot
    be changed.
  key: report_title
  playbookInputQuery: null
  required: false
  value: {}
- description: (Valid for CSV format report only). Specify hide_header=1 to omit the
    header information from the report. By default, this information is included.
  key: hide_header
  playbookInputQuery: null
  required: false
  value: {}
- description: Specify users who will receive the email notification when the report
    is complete (i.e,. supply a distribution group ID). Where do I find this ID? Log
    in to your Qualys account, go to Users > Distribution Groups and select Info for
    a group in the list.
  key: recipient_group_id
  playbookInputQuery: null
  required: false
  value: {}
- description: '''(Optional; Required for secure PDF distribution) The password to
    be used for encryption. Requirements: - the password must have a minimum of 8
    characters (ascii), and a maximum of 32 characters - the password must contain
    alpha and numeric characters - the password cannot match the password for the
    user’s Qualys account. - the password must follow the password security guidelines
    defined for your subscription (log in and go to Subscription Setup—>Security Options).'''
  key: pdf_password
  playbookInputQuery: null
  required: false
  value: {}
- description: Optional; Optional for secure PDF distribution) The report recipients
    in the form of one or more distribution groups, as defined using the Qualys UI.
    Multiple distribution groups are comma separated. A maximum of 50 distribution
    groups may be entered. Chapter 4 — Report API Launch Report  recipient_group={value}
  key: recipient_group
  playbookInputQuery: null
  required: false
  value: {}
- description: Specify IPs/ranges to change (override) the report target, as defined
    in the scan report template. Multiple IPs/ranges are comma separated. When specified,
    hosts defined in the report template are not included in the report. See also
    “Using Asset Tags.”
  key: ips
  playbookInputQuery: null
  required: false
  value: {}
- description: Specify asset group IDs to change (override) the report target, as
    defined in the scan report template. When specified, hosts defined in the report
    template are not included in the report. Looking for asset group IDs? Use the
    asset_group_list.php function (see the API v1 User Guide).
  key: asset_group_ids
  playbookInputQuery: null
  required: false
  value: {}
- description: Optional, and valid only when the Network Support feature is enabled
    for the user’s account) The ID of a network that is used to restrict the report’s
    target to the IPs/ranges specified in the“ips” parameter. Set to a custom network
    ID (note this does not filter IPs/ranges specified in “asset_group_ids”). Or set
    to “0” (the default) for the Global Default Network - this is used to report on
    hosts outside of your custom networks.
  key: ips_network_id
  playbookInputQuery: null
  required: false
  value: {}
name: Launch And Fetch Host Based Findings Report - Qualys
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: feaf59d2-f107-4395-862c-895cd5406872
      iscommand: false
      name: ""
      version: -1
    taskid: feaf59d2-f107-4395-862c-895cd5406872
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      asset_group_ids:
        simple: ${inputs.asset_group_ids}
      hide_header:
        simple: ${inputs.hide_header}
      ips:
        simple: ${inputs.ips}
      ips_network_id:
        simple: ${inputs.ips_network_id}
      output_format:
        simple: ${inputs.output_format}
      pdf_password:
        simple: ${inputs.pdf_password}
      recipient_group:
        simple: ${inputs.recipient_group}
      recipient_group_id:
        simple: ${inputs.recipient_group_id}
      report_title:
        simple: ${inputs.report_title}
      template_id:
        simple: ${inputs.template_id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QualysV2
      description: Run host based findings report
      id: 1cf38b7c-b0a7-4d1d-8d40-84a54dd5d7ba
      iscommand: true
      name: qualys-report-launch-host-based-findings
      script: QualysV2|||qualys-report-launch-host-based-findings
      type: regular
      version: -1
    taskid: 1cf38b7c-b0a7-4d1d-8d40-84a54dd5d7ba
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 210
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "180"
      file_format:
        simple: ${inputs.output_format}
      id:
        simple: ${Qualys.Report.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QualysV2
      description: Download report
      id: 9ef2d59d-bbaa-4c75-8849-64f1265e069c
      iscommand: true
      name: qualys-report-fetch
      script: QualysV2|||qualys-report-fetch
      type: regular
      version: -1
    taskid: 9ef2d59d-bbaa-4c75-8849-64f1265e069c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 540
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      Ids:
        simple: ${Qualys.Report.ID}
      Interval:
        simple: "1"
      PollingCommandArgName:
        simple: id
      PollingCommandName:
        simple: qualys-report-list
      Timeout:
        simple: "30"
      dt:
        simple: Qualys.Report(val.STATUS.STATE != 'Finished').ID.
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      id: 41604736-edc1-4f39-81c5-0d7711b91261
      iscommand: false
      name: GenericPolling
      playbookId: GenericPolling
      type: playbook
      version: -1
    taskid: 41604736-edc1-4f39-81c5-0d7711b91261
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 585,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
