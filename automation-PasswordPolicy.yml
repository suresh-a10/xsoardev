args:
- name: password
  required: true
commonfields:
  id: c2b23250-2549-444c-875c-a6f87625903d
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.8.6.13358
enabled: true
engineinfo: {}
mainengineinfo: {}
name: PasswordPolicy
outputs:
- contextPath: MeetsPolicy
  type: string
pswd: ""
runas: DBotWeakRole
runonce: false
script: |-
  import re

  #get input
  password1 = demisto.args()['password']
  password=str(password1);

  while True:
      if (len(password)<8):
          flag = -1
          break
      elif (len(password)>23):
          flag = -1
          break
      elif not re.search("[a-z]", password):
          flag = -1
          break
      elif not re.search("[A-Z]", password):
          flag = -1
          break
      elif not re.search("[0-9]", password):
          flag = -1
          break
      elif not re.search("[_@$#!^&*~ ]", password):
          flag = -1
          break
      elif re.search("\s", password):
          flag = -1
          break
      else:
          flag = 0
          verdict = "Valid Password"
          break

  if flag ==-1:
      verdict = "Not a Valid Password"

  return_outputs(readable_output=verdict,
              outputs={"Verdict": verdict
                  },
              raw_response={})
scripttarget: 0
subtype: python3
tags: []
type: python
