contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.5.0
    itemVersion: 1.1.19
    packID: GCP-Enrichment-Remediation
    packName: GCP Enrichment and Remediation
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: |-
  This playbook provides response actions to GCP. The following are available for execution automatically/manually:
  - Resource remediation:
     - Delete the instance
     - Stop the instance
  - Identity remediation:
     - Disable the user
     - Delete the user
  - Access key remediation:
     - Disable the access key
     - Delete the access key
  - Block indicators.
id: Cloud Response - GCP
inputs:
- description: |-
    Choose the remediation type for the user's access key.
    Disable - For disabling the user's access key.
    Delete - For deleting user's access key.
  key: accessKeyRemediationType
  playbookInputQuery: null
  required: false
  value:
    simple: Disable
- description: |-
    Choose the remediation type for the user involved.
    Delete - For deleting the user.
    Disable - For disabling the user.
  key: userRemediationType
  playbookInputQuery: null
  required: false
  value:
    simple: Disable
- description: |-
    Choose the remediation type for the instances created.
    Stop - For stopping the instances.
    Delete - For deleting the instances.
  key: resourceRemediationType
  playbookInputQuery: null
  required: false
  value:
    simple: Stop
- description: Whether to execute the resource remediation flow automatically.
  key: autoResourceRemediation
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Whether to execute the user remediation flow automatically.
  key: autoUserRemediation
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Whether to execute the access key remediation flow automatically.
  key: autoAccessKeyRemediation
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Whether to block the indicators automatically.
  key: autoBlockIndicators
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: The resource name to take action on.
  key: resourceName
  playbookInputQuery: null
  required: false
  value: {}
- description: The resource's zone.
  key: resourceZone
  playbookInputQuery: null
  required: false
  value: {}
- description: The username to take action on.
  key: username
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    The access key name in the following format:
    projects/{PROJECT_ID}/serviceAccounts/{ACCOUNT}/keys/{key}
  key: accessKeyName
  playbookInputQuery: null
  required: false
  value: {}
- description: The source IP address of the attacker.
  key: sourceIP
  playbookInputQuery: null
  required: false
  value: {}
- description: The GCP Project ID. Will be used for handling service account
  key: GCPprojectID
  playbookInputQuery: null
  required: false
  value: {}
- description: 'Determine the account type you are dealing with: "user" / "service_account".
    Default: "user"'
  key: accountType
  playbookInputQuery: null
  required: false
  value:
    simple: user
name: Cloud Response - GCP
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
      - "9"
      - "1"
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cf64eba4-df4f-44d1-84c4-65c9ef85b786
      iscommand: false
      name: ""
      version: -1
    taskid: cf64eba4-df4f-44d1-84c4-65c9ef85b786
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 70,
          "y": 370
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4e285d3b-924b-48ab-8bb3-b1092e74a8a5
      iscommand: false
      name: Resource
      type: title
      version: -1
    taskid: 4e285d3b-924b-48ab-8bb3-b1092e74a8a5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1980,
          "y": 530
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: daead8d0-6cad-4acb-811a-c5eeb75fda74
      iscommand: false
      name: Block Indicators
      type: title
      version: -1
    taskid: daead8d0-6cad-4acb-811a-c5eeb75fda74
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1830,
          "y": 530
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3e349c03-2c6a-4283-8a64-50a326832bc6
      iscommand: false
      name: Identity
      type: title
      version: -1
    taskid: 3e349c03-2c6a-4283-8a64-50a326832bc6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 640,
          "y": 530
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d0710c00-62c5-4984-83af-85c319fc9699
      iscommand: false
      name: Privileges
      type: title
      version: -1
    taskid: d0710c00-62c5-4984-83af-85c319fc9699
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -750,
          "y": 530
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.accessKeyName
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is an access key available for remediation.
      id: 35a2a97e-51fc-41a7-88d6-24c7aa59c52c
      iscommand: false
      name: Is there an access key to remediate?
      type: condition
      version: -1
    taskid: 35a2a97e-51fc-41a7-88d6-24c7aa59c52c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -750,
          "y": 670
        }
      }
  "11":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.autoAccessKeyRemediation
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the user chose automatic remediation.
      id: 0102ae72-ebe0-44ac-844f-5844d224320a
      iscommand: false
      name: Should remediate automatically?
      type: condition
      version: -1
    taskid: 0102ae72-ebe0-44ac-844f-5844d224320a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -750,
          "y": 860
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      key_name:
        complex:
          root: inputs.accessKeyName
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Disables a service account key.
      id: df4a0a5a-9ef2-4e1f-88eb-3859bc2f932b
      iscommand: true
      name: Disable the access key
      script: '|||gcp-iam-service-account-key-disable'
      type: regular
      version: -1
    taskid: df4a0a5a-9ef2-4e1f-88eb-3859bc2f932b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -750,
          "y": 1660
        }
      }
  "13":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.accessKeyRemediationType
          operator: isEqualString
          right:
            value:
              simple: Rotate
      label: Delete
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.accessKeyRemediationType
          operator: isEqualString
          right:
            value:
              simple: Disable
      label: Disable
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Delete:
      - "14"
      Disable:
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Checks for the user's chosen remediation type.
      id: 6ea41880-e0bd-4635-8243-a5449efbcff5
      iscommand: false
      name: Continue by remediation type
      type: condition
      version: -1
    taskid: 6ea41880-e0bd-4635-8243-a5449efbcff5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -750,
          "y": 1400
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      key_name:
        complex:
          root: inputs.accessKeyName
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Deletes a service account key.
      id: 6ad0514c-34c6-45d4-888a-6336734940aa
      iscommand: true
      name: Delete the access key
      script: '|||gcp-iam-service-account-key-delete'
      type: regular
      version: -1
    taskid: 6ad0514c-34c6-45d4-888a-6336734940aa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -330,
          "y": 1660
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 250543fb-7b16-48fb-8de6-0bdd0681c273
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 250543fb-7b16-48fb-8de6-0bdd0681c273
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1430,
          "y": 1840
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.username
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is a user available for remediation.
      id: ef7d1d56-2219-4e84-8363-9847b74d54df
      iscommand: false
      name: Is there a user to remediate?
      type: condition
      version: -1
    taskid: ef7d1d56-2219-4e84-8363-9847b74d54df
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 640,
          "y": 670
        }
      }
  "18":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.autoUserRemediation
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the user chose automatic remediation.
      id: 0c7568e0-ca17-44f2-80fc-1944b2f51b40
      iscommand: false
      name: Should remediate automatically?
      type: condition
      version: -1
    taskid: 0c7568e0-ca17-44f2-80fc-1944b2f51b40
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1220
        }
      }
  "19":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.username
          operator: notContainsGeneral
          right:
            value:
              simple: gserviceaccount
      label: User
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.userRemediationType
          operator: isEqualString
          right:
            value:
              simple: Revoke
      label: Disable
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.userRemediationType
          operator: isEqualString
          right:
            value:
              simple: Delete
      label: Delete
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Delete:
      - "20"
      Disable:
      - "33"
      User:
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks for the user's chosen remediation type.
      id: 2ee9ba9a-9171-4cf5-8ab6-5eeee52bbb45
      iscommand: false
      name: Continue by remediation type
      type: condition
      version: -1
    taskid: 2ee9ba9a-9171-4cf5-8ab6-5eeee52bbb45
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1750
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      service_account_name:
        complex:
          accessor: "0"
          root: Manual user remediation.Answers
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: username
            operator: SetIfEmpty
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: service_account
            operator: SetIfEmpty
          - operator: uniq
          - args:
              empty_values: {}
              remove_keys:
                iscontext: true
                value:
                  simple: "true"
            operator: RemoveEmpty
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Deletes a service account.
      id: 1bde297b-0d24-4663-8b78-6034dc4c26ea
      iscommand: true
      name: Delete the user
      script: '|||gcp-iam-service-account-delete'
      type: regular
      version: -1
    taskid: 1bde297b-0d24-4663-8b78-6034dc4c26ea
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1960
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      id: 710a1688-0775-418f-8cf2-3ff25fce9336
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 710a1688-0775-418f-8cf2-3ff25fce9336
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -50,
          "y": 2210
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.resourceName
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is a resource available for remediation.
      id: ac88602d-417d-4649-8f84-64cfc1f0a244
      iscommand: false
      name: Is there a resource to remediate?
      type: condition
      version: -1
    taskid: ac88602d-417d-4649-8f84-64cfc1f0a244
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1980,
          "y": 670
        }
      }
  "25":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.autoResourceRemediation
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the user chose automatic remediation.
      id: 050459fa-9edc-4342-8f51-ec4b535e1090
      iscommand: false
      name: Should remediate automatically?
      type: condition
      version: -1
    taskid: 050459fa-9edc-4342-8f51-ec4b535e1090
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1980,
          "y": 860
        }
      }
  "26":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.resourceRemediationType
          operator: isEqualString
          right:
            value:
              simple: Terminate
      label: Delete
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.resourceRemediationType
          operator: isEqualString
          right:
            value:
              simple: Stop
      label: Stop
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Delete:
      - "27"
      Stop:
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks for the user's chosen remediation type.
      id: dcd2adf0-93e1-4672-8cd6-29469a65105b
      iscommand: false
      name: Continue by remediation type
      type: condition
      version: -1
    taskid: dcd2adf0-93e1-4672-8cd6-29469a65105b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1980,
          "y": 1605
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      instance:
        complex:
          root: remediateResourceList
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.resourceName
            operator: SetIfEmpty
      zone:
        complex:
          root: inputs.resourceZone
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Deletes the specified instance resource. For more information,
        see Stopping or Deleting an Instance.
      id: b7c92358-4c34-42ab-844a-87cc9cbac517
      iscommand: true
      name: Delete the instance
      script: '|||gcp-compute-delete-instance'
      type: regular
      version: -1
    taskid: b7c92358-4c34-42ab-844a-87cc9cbac517
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1730,
          "y": 1800
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      instance:
        complex:
          root: remediateResourceList
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.resourceName
            operator: SetIfEmpty
      zone:
        complex:
          root: inputs.resourceZone
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Stops a running instance, shutting it down cleanly, and allows
        you to restart the instance at a later time. Stopped instances do not incur
        VM usage charges while they are stopped. However, resources that the VM is
        using, such as persistent disks and static IP addresses, will continue to
        be charged until they are deleted. For more information, see Stopping an instance.
      id: 434c2cb3-871e-4e21-8035-bd26a4287da4
      iscommand: true
      name: Stop the instance
      script: '|||gcp-compute-stop-instance'
      type: regular
      version: -1
    taskid: 434c2cb3-871e-4e21-8035-bd26a4287da4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2250,
          "y": 1800
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4103b833-432f-4188-81e4-624e0ce96ab6
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 4103b833-432f-4188-81e4-624e0ce96ab6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2145
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      service_account_name:
        complex:
          accessor: "0"
          root: Manual user remediation.Answers
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.username
            operator: SetIfEmpty
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: service_account
            operator: SetIfEmpty
          - operator: uniq
          - args:
              empty_values: {}
              remove_keys:
                value:
                  simple: "true"
            operator: RemoveEmpty
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Disables a project service account.
      id: 085fbe39-ffbe-4094-8566-f791528d9a3f
      iscommand: true
      name: Disable the user
      script: '|||gcp-iam-service-account-disable'
      type: regular
      version: -1
    taskid: 085fbe39-ffbe-4094-8566-f791528d9a3f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1050,
          "y": 1960
        }
      }
  "34":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Choose resources to remediate
        options: []
        optionsarg:
        - complex:
            root: inputs.resourceName
            transformers:
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: Your SOC team
      title: Manual resource remediation
      totalanswers: 0
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Analyst interaction is needed for the resource remediation.
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: Cloud Response - GCP - Resource Remediation
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${incident.assigneduser}
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, nothing is returned.
      id: f6ad987e-75a5-4529-8c7f-08ff8953346c
      iscommand: false
      name: Choose resources to remediate
      type: collection
      version: -1
    taskid: f6ad987e-75a5-4529-8c7f-08ff8953346c
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1600,
          "y": 1090
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Manual resource remediation.Answers
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks the user's answer.
      id: acc1466a-abd3-474a-877d-cba5d4ce452b
      iscommand: false
      name: Check user answer
      type: condition
      version: -1
    taskid: acc1466a-abd3-474a-877d-cba5d4ce452b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1600,
          "y": 1250
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: remediateResourceList
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Manual resource remediation.Answers.0
              operator: isNotEqualString
              right:
                value:
                  simple: ALL
          root: Manual resource remediation.Answers.0
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.resourceName
            operator: SetIfEmpty
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f4cc0f82-e042-4d02-8776-ddc8f91bf93a
      iscommand: false
      name: Set selected resources to remediate
      script: Set
      type: regular
      version: -1
    taskid: f4cc0f82-e042-4d02-8776-ddc8f91bf93a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1600,
          "y": 1430
        }
      }
  "37":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Choose user to remediate
        options: []
        optionsarg:
        - complex:
            root: username
            transformers:
            - args:
                item:
                  iscontext: true
                  value:
                    simple: service_account
              operator: append
            - operator: uniq
            - args:
                empty_values: {}
                remove_keys:
                  value:
                    simple: "true"
              operator: RemoveEmpty
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: Your SOC team
      title: Manual user remediation
      totalanswers: 0
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Analyst interaction is needed for the user remediation.
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: Cloud Response - GCP - User Remediation
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${incident.assigneduser}
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, nothing is returned.
      id: 52e5c7ce-7d4a-4b74-8761-9c3d05929209
      iscommand: false
      name: Choose a user to remediate
      type: collection
      version: -1
    taskid: 52e5c7ce-7d4a-4b74-8761-9c3d05929209
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 180,
          "y": 1400
        }
      }
  "38":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Manual user remediation.Answers
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks the user's answer.
      id: c7ec6a0c-fe6b-4a31-8841-142794939002
      iscommand: false
      name: Check user answer
      type: condition
      version: -1
    taskid: c7ec6a0c-fe6b-4a31-8841-142794939002
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 180,
          "y": 1560
        }
      }
  "39":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Choose the user for access key remediation
        options: []
        optionsarg:
        - complex:
            root: inputs.username
            transformers:
            - operator: uniq
        - simple: None
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Manual access key remediation
      totalanswers: 0
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Analyst interaction is needed for the user's access key remediation.
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: Cloud Response - GCP - Access Key Remediation
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${incident.assigneduser}
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, nothing is returned.
      id: 44972c36-ce1e-403d-8f23-3654f35aaff7
      iscommand: false
      name: Choose a user for access key remediation
      type: collection
      version: -1
    taskid: 44972c36-ce1e-403d-8f23-3654f35aaff7
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -1140,
          "y": 1070
        }
      }
  "40":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Manual access key remediation.Answers
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks the user's answer.
      id: abea9bd3-ea7d-42a7-8a90-af2faaafd301
      iscommand: false
      name: Check user answer
      type: condition
      version: -1
    taskid: abea9bd3-ea7d-42a7-8a90-af2faaafd301
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1140,
          "y": 1230
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        simple: "No"
      CustomBlockRule:
        simple: "True"
      IP:
        complex:
          root: blockIndicatorsList
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: inputs.sourceIP
            operator: SetIfEmpty
          - operator: uniq
      InputEnrichment:
        simple: "False"
      RuleDirection:
        simple: inbound
      RuleName:
        simple: XSOAR - Block IP playbook - ${incident.id}
      UserVerification:
        simple: "False"
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: "This playbook blocks malicious IP addresses using all integrations
        that are enabled. The direction of the traffic that will be blocked is determined
        by the Cortex XSOAR user (and set by default to outgoing).\nNote the following:\n-
        \ Some of those integrations require specific parameters to run, which are
        based on the playbook inputs. Also, certain integrations use FW rules or appended
        network objects.\n- Note that the appended network objects should be specified
        in blocking rules inside the system later on. \n\n\nSupported integrations
        for this playbook [Network security products such as FW/WAF/IPs/etc.]: \n\n*
        Check Point Firewall\n* Palo Alto Networks PAN-OS\n* Zscaler\n* FortiGate\n*
        Aria Packet Intelligence\n* Cisco Firepower \n* Cisco Secure Cloud Analytics\n*
        Cisco ASA\n* Akamai WAF\n* F5 SilverLine\n* ThreatX\n* Signal Sciences WAF\n*
        Sophos Firewall\n\n"
      id: 4f647538-9413-4e60-889d-15ccc0bda9d6
      iscommand: false
      name: Block IP - Generic v3
      playbookId: Block IP - Generic v3
      type: playbook
      version: -1
    taskid: 4f647538-9413-4e60-889d-15ccc0bda9d6
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1830,
          "y": 1420
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 70e627c4-1366-4679-8ebc-174bf130f7e1
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 70e627c4-1366-4679-8ebc-174bf130f7e1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2410,
          "y": 1610
        }
      }
  "43":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.autoBlockIndicators
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "44"
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the user chose automatic remediation.
      id: 34d1f3f4-55cf-43d8-8859-76aa49ee3def
      iscommand: false
      name: Should block indicators automatically?
      type: condition
      version: -1
    taskid: 34d1f3f4-55cf-43d8-8859-76aa49ee3def
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1830,
          "y": 670
        }
      }
  "44":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Choose indicators to block
        options: []
        optionsarg:
        - complex:
            root: inputs.sourceIP
            transformers:
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Block Indicators
      totalanswers: 0
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Analyst interaction is needed for the indicators remediation.
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: Cloud Response - GCP - Block Indicators
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${incident.assigneduser}
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, nothing is returned.
      id: 1c979519-3966-4131-8ccb-8fa5a22aee70
      iscommand: false
      name: Choose indicators to block
      type: collection
      version: -1
    taskid: 1c979519-3966-4131-8ccb-8fa5a22aee70
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -2110,
          "y": 860
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Block Indicators.Answers
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks the user's answer.
      id: 2b930c09-2a7a-473a-8606-b8e2cd2f0618
      iscommand: false
      name: Check user answer
      type: condition
      version: -1
    taskid: 2b930c09-2a7a-473a-8606-b8e2cd2f0618
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2110,
          "y": 1060
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: blockIndicatorsList
      value:
        complex:
          accessor: "0"
          root: Block Indicators.Answers
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f4e8b070-914f-47c4-8720-6746d9de54bb
      iscommand: false
      name: Set selected indicators to remediate
      script: Set
      type: regular
      version: -1
    taskid: f4e8b070-914f-47c4-8720-6746d9de54bb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2110,
          "y": 1250
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      user_key:
        complex:
          accessor: "0"
          root: Manual user remediation.Answers
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: username
            operator: SetIfEmpty
          - args:
              applyIfEmpty: {}
              defaultValue:
                iscontext: true
                value:
                  simple: service_account
            operator: SetIfEmpty
          - operator: uniq
          - args:
              empty_values: {}
              remove_keys:
                value:
                  simple: "true"
            operator: RemoveEmpty
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Deletes a user.
      id: cae32c6c-c9f5-4392-87ea-4fd3d72f588c
      iscommand: true
      name: Delete regular user
      script: '|||gsuite-user-delete'
      type: regular
      version: -1
    taskid: cae32c6c-c9f5-4392-87ea-4fd3d72f588c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 1960
        }
      }
  "48":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.accountType
          operator: isEqualString
          right:
            value:
              simple: service_account
      label: "yes"
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "50"
      "yes":
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Check if the user is a service account.
      id: f0d5235c-42a6-494b-84cd-dfd057f01729
      iscommand: false
      name: Check if the user is a service account
      type: condition
      version: -1
    taskid: f0d5235c-42a6-494b-84cd-dfd057f01729
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 640,
          "y": 870
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: username
      value:
        complex:
          root: inputs.username
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b735ecde-e743-450e-8ffb-edbc3bac25a1
      iscommand: false
      name: Set regular user pattern
      script: Set
      type: regular
      version: -1
    taskid: b735ecde-e743-450e-8ffb-edbc3bac25a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 1040
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: service_account
      value:
        simple: projects/${inputs.GCPprojectID}/serviceAccount/${inputs.username}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 64c46d68-3417-4cf5-8d7c-a0b7c03ef352
      iscommand: false
      name: Set service account user pattern
      script: Set
      type: regular
      version: -1
    taskid: 64c46d68-3417-4cf5-8d7c-a0b7c03ef352
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 840,
          "y": 1040
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "10_11_yes": 0.42,
      "10_16_#default#": 0.44,
      "11_13_yes": 0.27,
      "11_39_#default#": 0.57,
      "17_23_#default#": 0.43,
      "18_19_yes": 0.47,
      "18_37_#default#": 0.57,
      "24_25_yes": 0.41,
      "24_30_#default#": 0.37,
      "25_26_yes": 0.41,
      "25_34_#default#": 0.56,
      "26_27_Delete": 0.68,
      "35_30_#default#": 0.32,
      "35_36_yes": 0.51,
      "38_23_#default#": 0.28,
      "40_13_yes": 0.44,
      "40_16_#default#": 0.27
    },
    "paper": {
      "dimensions": {
        "height": 1905,
        "width": 5040,
        "x": -2410,
        "y": 370
      }
    }
  }
