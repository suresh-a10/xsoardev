contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.2.0
    itemVersion: 1.4.8
    packID: CaseManagement-Generic
    packName: CaseManagement-Generic
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: "This playbook will extract and enrich indicators upon trigger, calculate
  Severity, and set SLAs and Timers. \n\nCan be used as a default playbook to ingest
  new Incidents, or for manually created Incidents. "
id: Case Management - Generic v2
inputs:
- description: |-
    Determines whether to extract and enrich all indicators in the Incident.  This is run on all Incident fields.

    Set to "True" to enable extraction and enrichment.
  key: Enrich
  playbookInputQuery: null
  required: false
  value:
    simple: "True"
- description: "Set to \"True\" to enable setting SLAs for the Incident, Time to Assignment,
    and Remediation SLA Timers.  \n\nComplete the other inputs to set the SLA, and
    Timer SLAs based on Severity."
  key: SetSLAs
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to "True" to set the SLA on the Incident.
  key: SetIncidentSLAs
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to "True" to set the SLAs on the Time to Assignment Timer.
  key: SetTimeToAssignmentSLAs
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Set to "True" to set the SLAs on the Remediation SLA Timer.
  key: SetRemediationTimerSLA
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Number in minutes for the Incident and Remediation Timer SLAs, when
    the severity of the Incident is Critical.
  key: CriticalRemediationSLA
  playbookInputQuery: null
  required: false
  value:
    simple: "180"
- description: Number in minutes for the Incident and Remediation Timer SLAs, when
    the severity of the Incident is High.
  key: HighRemediationSLA
  playbookInputQuery: null
  required: false
  value:
    simple: "300"
- description: Number in minutes for the Incident and Remediation Timer SLAs, when
    the severity of the Incident is Medium.
  key: MediumRemediationSLA
  playbookInputQuery: null
  required: false
  value:
    simple: "1440"
- description: Number in minutes for the Incident and Remediation Timer SLAs, when
    the severity of the Incident is Low or Informational.
  key: LowRemediationSLA
  playbookInputQuery: null
  required: false
  value:
    simple: "7200"
- description: 'Number in minutes for the Time to Assignment Timer SLA, when the severity
    of the Incident is Critical. '
  key: CriticalTimeToAssignSLA
  playbookInputQuery: null
  required: false
  value:
    simple: "15"
- description: 'Number in minutes for the Time to Assignment Timer SLA, when the severity
    of the Incident is High. '
  key: HighTimeToAssignSLA
  playbookInputQuery: null
  required: false
  value:
    simple: "60"
- description: 'Number in minutes for the Time to Assignment Timer SLA, when the severity
    of the Incident is Medium. '
  key: MediumTimeToAssignSLA
  playbookInputQuery: null
  required: false
  value:
    simple: "180"
- description: 'Number in minutes for the Time to Assignment Timer SLA, when the severity
    of the Incident is Low or Informational. '
  key: LowTimeToAssignSLA
  playbookInputQuery: null
  required: false
  value:
    simple: "1440"
- description: "Whether to send the on call notification email based on the Incidents
    Severity. \n\nSet to Yes to send notifications, and add the emails to the NotificationEmails. "
  key: SendOnCallNotification
  playbookInputQuery: null
  required: false
  value:
    simple: "No"
- description: 'The email addresses to send the message to, can be comma separated. '
  key: NotificationEmails
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    The minimum severity level for the Incident to send notification for.  Default is 3 (High).   XSOAR Severity values:
    Critical (4), High (3), Medium (2), Low (1), Information (0.5), Unknown (0)
  key: MinimumSeverity
  playbookInputQuery: null
  required: false
  value:
    simple: "3"
name: Case Management - Generic v2
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f0095fd7-5fa2-4f35-82a3-f9e25b9bc811
      iscommand: false
      name: ""
      version: -1
    taskid: f0095fd7-5fa2-4f35-82a3-f9e25b9bc811
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e71cd0e0-cd3c-4f90-8ae7-822cfa854559
      iscommand: false
      name: 'Done '
      type: title
      version: -1
    taskid: e71cd0e0-cd3c-4f90-8ae7-822cfa854559
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2640
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: "### Analyst Investigation\n\nPlease ensure to take the following
        actions:\n\n### Assign to yourself, or another Analyst\n- Click Assign to
        Me to assign this to yourself.\n- Select an Owner via the Owner field to assign
        or reassign to another Analyst.\n\n### Select Actions -> Close Incident to
        close this when completed. \n- Please ensure to capture the appropriate close
        reason, and closing notes/resolution as required.\n\n### Timers\n- Time to
        Assignment will stop when an Owner is assigned, and the Remediation SLA Timer
        will be started.\n- The Remediation SLA timers will not stop until the Incident
        is closed"
      id: ea2c0e6c-b67f-4a0e-879d-1d3ff47b86f8
      iscommand: false
      name: Manual - Analyst Investigation
      type: regular
      version: -1
    taskid: ea2c0e6c-b67f-4a0e-879d-1d3ff47b86f8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2465
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: dac6c740-325c-4206-82c1-c89f91f37da4
      iscommand: false
      name: Calculate Severity - Standard
      playbookId: Calculate Severity - Standard
      type: playbook
      version: -1
    taskid: dac6c740-325c-4206-82c1-c89f91f37da4
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 835
        }
      }
  "24":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Enrich
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the Enrich playbook input is set to True.
      id: d9cecc86-bac0-4873-8091-67f54141dfad
      iscommand: false
      name: Should indicators be extracted and enriched?
      type: condition
      version: -1
    taskid: d9cecc86-bac0-4873-8091-67f54141dfad
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b376d9f7-c94a-4d0d-8fac-8065f6972c8f
      iscommand: false
      name: Enrich indicators
      type: title
      version: -1
    taskid: b376d9f7-c94a-4d0d-8fac-8065f6972c8f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 370
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Extracts all indicators that match the regex for the indicator
        type, and enriches the repuration using the reputation command defined for
        the indicator type.
      id: 7de47577-2c67-4421-8875-216993c60f11
      iscommand: true
      name: Extract Indicators from Incident
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 7de47577-2c67-4421-8875-216993c60f11
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 515
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5c66c155-dc5b-49e3-8d31-50757dd9d4e6
      iscommand: false
      name: Calculate Severity
      type: title
      version: -1
    taskid: 5c66c155-dc5b-49e3-8d31-50757dd9d4e6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 690
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 974cd6d9-8675-4823-8444-ff091aed82c0
      iscommand: false
      name: Start SLA Timers
      type: title
      version: -1
    taskid: 974cd6d9-8675-4823-8444-ff091aed82c0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1505
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.SetSLAs
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the SetSLAs input is set to True, and if so moves to
        the sub-playbook to set the SLAs based on Severity.
      id: dc09d806-3b03-4112-88df-aed9b28de993
      iscommand: false
      name: Should we set SLAs based on Severity?
      type: condition
      version: -1
    taskid: dc09d806-3b03-4112-88df-aed9b28de993
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1155
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      CriticalRemediationSLA:
        complex:
          root: inputs.CriticalRemediationSLA
      CriticalTimeToAssignSLA:
        complex:
          root: inputs.CriticalTimeToAssignSLA
      HighRemediationSLA:
        complex:
          root: inputs.HighRemediationSLA
      HighTimeToAssignSLA:
        complex:
          root: inputs.HighTimeToAssignSLA
      LowRemediationSLA:
        complex:
          root: inputs.LowRemediationSLA
      LowTimeToAssignSLA:
        complex:
          root: inputs.LowTimeToAssignSLA
      MediumRemediationSLA:
        complex:
          root: inputs.MediumRemediationSLA
      MediumTimeToAssignSLA:
        complex:
          root: inputs.MediumTimeToAssignSLA
      SetIncidentSLAs:
        complex:
          root: inputs.SetIncidentSLAs
      SetRemediationTimerSLA:
        complex:
          root: inputs.SetRemediationTimerSLA
      SetTimeToAssignmentSLAs:
        complex:
          root: inputs.SetTimeToAssignmentSLAs
      Severity:
        complex:
          accessor: severity
          root: incident
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 7115607e-0d36-492d-876f-d971fc975e8c
      iscommand: false
      name: Case Management - Generic - Set SLAs based on Severity
      playbookId: Case Management - Generic - Set SLAs based on Severity
      type: playbook
      version: -1
    taskid: 7115607e-0d36-492d-876f-d971fc975e8c
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1330
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 76089d0f-8f55-40a8-8ba1-d0a0e54d6ffb
      iscommand: false
      name: Set SLAs
      type: title
      version: -1
    taskid: 76089d0f-8f55-40a8-8ba1-d0a0e54d6ffb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1010
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
      - "34"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: ce018ba1-f304-480d-8c40-c65226809c70
      iscommand: false
      name: Case Management - Generic - Start SLA Timers
      playbookId: Case Management - Generic - Start SLA Timers
      type: playbook
      version: -1
    taskid: ce018ba1-f304-480d-8c40-c65226809c70
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1650
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3490ded4-1832-46e1-8b91-19eede066c95
      iscommand: false
      name: Investigation
      type: title
      version: -1
    taskid: 3490ded4-1832-46e1-8b91-19eede066c95
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2320
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bdbb8546-1d2e-44c8-84a2-c289a7af3007
      iscommand: false
      name: Notification
      type: title
      version: -1
    taskid: bdbb8546-1d2e-44c8-84a2-c289a7af3007
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1825
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      emails:
        complex:
          root: inputs.NotificationEmails
      minimum_severity:
        complex:
          root: inputs.MinimumSeverity
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook can be used to send email notification if an Incidents
        severity is Critical or High.  \n\nCan be used as a sub-playbook to perform
        the same logic across different playbooks/use cases."
      id: f1918e2d-b3ec-4d45-81bb-beef42cbeb15
      iscommand: false
      name: Case Management - Generic - Send On Call Notification
      playbookId: Case Management - Generic - Send On Call Notification
      type: playbook
      version: -1
    taskid: f1918e2d-b3ec-4d45-81bb-beef42cbeb15
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2145
        }
      }
  "36":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.SendOnCallNotification
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the SendOnCallNotification is set to Yes, and will
        send the on call notification if the Incident severity is critical or high.
      id: 6ddf3aa2-3e0c-46a7-8986-3d1a472d7e5b
      iscommand: false
      name: Should we send on call notification?
      type: condition
      version: -1
    taskid: 6ddf3aa2-3e0c-46a7-8986-3d1a472d7e5b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1970
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2655,
        "width": 492.5,
        "x": 50,
        "y": 50
      }
    }
  }
