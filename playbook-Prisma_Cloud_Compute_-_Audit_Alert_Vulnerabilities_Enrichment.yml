contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.10.0
    itemVersion: 1.7.4
    packID: PrismaCloudCompute
    packName: Prisma Cloud Compute by Palo Alto Networks
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: "This is a sub-playbook of the \"Prisma Cloud Compute - Audit Alert v2\"
  playbook.\nIt creates CVE indicators based on image or host vulnerabilities. "
id: Prisma Cloud Compute - Audit Alert Vulnerabilities Enrichment
inputs:
- description: Image vulnerabilities that were retrieved.
  key: ImageVulnerabilities
  playbookInputQuery: null
  required: false
  value: {}
- description: Host vulnerabilities that were retrieved.
  key: HostVulnerabilities
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    A list of the image or host CVE severities that the playbook creates indicators from.
    Available options (not case sensitive):
    - Critical
    - High
    - Medium
    - moderate
    - Important
    - Low
    - Negligible

    Default value: High, Critical.
  key: CVEsIndicatorsSeverities
  playbookInputQuery: null
  required: false
  value:
    simple: High, Critical
name: Prisma Cloud Compute - Audit Alert Vulnerabilities Enrichment
outputs:
- contextPath: CVEReport
  description: CVE report.
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6ae5787f-ae72-4469-8cd5-46a403ecbf09
      iscommand: false
      name: ""
      version: -1
    taskid: 6ae5787f-ae72-4469-8cd5-46a403ecbf09
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 410,
          "y": 190
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      cvedescription:
        complex:
          accessor: description
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: inputs.ImageVulnerabilities.severity
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.CVEsIndicatorsSeverities
          root: inputs.ImageVulnerabilities
      cvss:
        complex:
          accessor: cvss
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: inputs.ImageVulnerabilities.severity
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.CVEsIndicatorsSeverities
          root: inputs.ImageVulnerabilities
      cvssscore:
        complex:
          accessor: cvss
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: inputs.ImageVulnerabilities.severity
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.CVEsIndicatorsSeverities
          root: inputs.ImageVulnerabilities
      description:
        complex:
          accessor: description
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: inputs.ImageVulnerabilities.severity
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.CVEsIndicatorsSeverities
          root: inputs.ImageVulnerabilities
      source:
        simple: Prisma Cloud Compute
      tags:
        complex:
          accessor: packageName
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: inputs.ImageVulnerabilities.severity
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.CVEsIndicatorsSeverities
          root: inputs.ImageVulnerabilities
      type:
        simple: CVE
      value:
        complex:
          accessor: cve
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: inputs.ImageVulnerabilities.severity
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.CVEsIndicatorsSeverities
          root: inputs.ImageVulnerabilities
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 86b1e524-e5ad-4039-82fd-6201e064178d
      iscommand: true
      name: Create Indicators from Image Vulnerabilities
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 86b1e524-e5ad-4039-82fd-6201e064178d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 640
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dc19e613-67d1-46d7-8a80-9b3e83a0dbdc
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: dc19e613-67d1-46d7-8a80-9b3e83a0dbdc
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 410,
          "y": 950
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.ImageVulnerabilities
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: cve
                root: inputs.ImageVulnerabilities
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "1"
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1f36cc8d-83e6-4797-86be-e6238f5a26a6
      iscommand: false
      name: Check if alert has image vulnerabilities
      type: condition
      version: -1
    taskid: 1f36cc8d-83e6-4797-86be-e6238f5a26a6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": 350
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: CVEReport
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.ImageVulnerabilities.cve
              operator: isNotEmpty
          root: inputs.ImageVulnerabilities
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 7a4b4e86-15f4-47ad-881e-3e26fd7e9ac6
      iscommand: false
      name: Save CVEs (for report)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 7a4b4e86-15f4-47ad-881e-3e26fd7e9ac6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1050,
          "y": 640
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.HostVulnerabilities
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: cve
                root: inputs.HostVulnerabilities
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "6"
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 98519006-1495-492f-82ef-979e2c2523a9
      iscommand: false
      name: Check host vulnerabilities
      type: condition
      version: -1
    taskid: 98519006-1495-492f-82ef-979e2c2523a9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -30,
          "y": 560
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      cvedescription:
        complex:
          accessor: description
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: inputs.HostVulnerabilities.severity
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.CVEsIndicatorsSeverities
          root: inputs.HostVulnerabilities
      cvss:
        complex:
          accessor: cvss
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: inputs.HostVulnerabilities.severity
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.CVEsIndicatorsSeverities
          root: inputs.HostVulnerabilities
      cvssscore:
        complex:
          accessor: cvss
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: inputs.HostVulnerabilities.severity
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.CVEsIndicatorsSeverities
          root: inputs.HostVulnerabilities
      description:
        complex:
          accessor: description
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: inputs.HostVulnerabilities.severity
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.CVEsIndicatorsSeverities
          root: inputs.HostVulnerabilities
      source:
        simple: Prisma Cloud Compute
      tags:
        complex:
          accessor: packageName
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: inputs.HostVulnerabilities.severity
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.CVEsIndicatorsSeverities
          root: inputs.HostVulnerabilities
      type:
        simple: CVE
      value:
        complex:
          accessor: cve
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: inputs.HostVulnerabilities.severity
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.CVEsIndicatorsSeverities
          root: inputs.HostVulnerabilities
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 85b195e3-2e5e-43bf-8be0-b1d21c8d4f9b
      iscommand: true
      name: Create Indicators from host Vulnerabilities
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 85b195e3-2e5e-43bf-8be0-b1d21c8d4f9b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": 735
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: CVEReport
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.HostVulnerabilities.cve
              operator: isNotEmpty
          root: inputs.HostVulnerabilities
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      id: 1fbd0237-637c-4d24-8024-d7a3c93f94e6
      iscommand: false
      name: Save CVEs (for report)
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 1fbd0237-637c-4d24-8024-d7a3c93f94e6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 192.5,
          "y": 735
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "3_1_yes": 0.28,
      "3_4_yes": 0.61,
      "5_2_#default#": 0.1
    },
    "paper": {
      "dimensions": {
        "height": 825,
        "width": 1680,
        "x": -250,
        "y": 190
      }
    }
  }
