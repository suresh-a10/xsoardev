contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 232d5d44-d909-4dfd-879c-d8b9d153dc0a
inputs:
- description: ""
  key: IP
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: Domain
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: URL
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: Hash
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-Blacklist CyberSOC_Shared IOC Above RiskScore 65 v3.0_KK
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b13fc4c0-4966-40e6-82d6-953df8c51404
      iscommand: false
      name: ""
      version: -1
    taskid: b13fc4c0-4966-40e6-82d6-953df8c51404
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1420,
          "y": -670
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Domain
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6cf475e1-bd9e-43be-81b4-61b0b8ccb311
      iscommand: false
      name: Is There Domains For Blocking?
      type: condition
      version: -1
    taskid: 6cf475e1-bd9e-43be-81b4-61b0b8ccb311
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 330
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.IP
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 861ab302-3fff-42f9-8369-2d71c59d443f
      iscommand: false
      name: Is There IP Address For Blocking?
      type: condition
      version: -1
    taskid: 861ab302-3fff-42f9-8369-2d71c59d443f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 310,
          "y": 330
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b0de83f1-88c6-442c-82f4-5e07eca015ae
      iscommand: false
      name: TCS-Add New CSOC IP Indicator v1.0_Kunal
      playbookId: e653e5ab-6658-4f7a-806d-6a79d92d5d98
      type: playbook
      version: -1
    taskid: b0de83f1-88c6-442c-82f4-5e07eca015ae
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: playbook
    view: |-
      {
        "position": {
          "x": 310,
          "y": 540
        }
      }
  "4":
    continueonerror: true
    continueonerrortype: errorPath
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_132
      ip:
        simple: ${SIXFIVE.IP}
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 54dca107-b53a-44af-8809-823f20bf6b03
      iscommand: true
      name: block IP on Zscaler Corporate tenant
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 54dca107-b53a-44af-8809-823f20bf6b03
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -170,
          "y": 700
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: email only
      label: Email Only
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
          operator: isEqualString
          right:
            value:
              simple: internet only
      label: Internet Only
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      Email Only:
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 75520bcc-ade2-47e3-81b5-e17c180b0b03
      iscommand: false
      name: Where Should The IOC Be Blacklisted ?
      type: condition
      version: -1
    taskid: 75520bcc-ade2-47e3-81b5-e17c180b0b03
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 540
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 4008c7e2-c791-4cef-8e0f-969d3f5e9a1c
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 4008c7e2-c791-4cef-8e0f-969d3f5e9a1c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 755
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 01998dea-629a-4f70-8b5b-386da0be0164
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 01998dea-629a-4f70-8b5b-386da0be0164
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1690,
          "y": 730
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 618c702e-e468-4bcc-8e12-d48f720c6bbf
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 618c702e-e468-4bcc-8e12-d48f720c6bbf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1690,
          "y": 540
        }
      }
  "9":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.URL
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e0ca554e-ad8d-4f72-8e55-ad02c9aa3c5a
      iscommand: false
      name: Is There URLs For Blocking?
      type: condition
      version: -1
    taskid: e0ca554e-ad8d-4f72-8e55-ad02c9aa3c5a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1690,
          "y": 330
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          accessor: URL
          root: SIXFIVE
      listName:
        simple: Zscaler_Corp
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: a9dd75e8-7fdc-4d00-8f6d-6401504d634d
      iscommand: true
      name: Create a List of URLs That Failed To Blacklist
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: a9dd75e8-7fdc-4d00-8f6d-6401504d634d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2040,
          "y": 920
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 5
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        complex:
          root: inputs.Hash
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 02587312-46ed-4f0d-8e8b-144399f4a09d
      iscommand: false
      name: TCS-CSOC Block Malicious Hash on CS v1.0_Kunal
      playbookId: 9d6b9cb3-059d-4b12-865c-f73bed1daa8a
      type: playbook
      version: -1
    taskid: 02587312-46ed-4f0d-8e8b-144399f4a09d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 530
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Hash
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1230477a-7790-4002-8229-9813cdcaa3b3
      iscommand: false
      name: Is There Hash For Blocking ?
      type: condition
      version: -1
    taskid: 1230477a-7790-4002-8229-9813cdcaa3b3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 330
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_StandardRiskScore_Hash
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        simple: ${inputs.Hash}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: 3e02c6ff-e9de-4f22-8773-2a0052498cb7
      iscommand: true
      name: Update IP address Reference set "TCS_StandardRiskScore_Hash"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: 3e02c6ff-e9de-4f22-8773-2a0052498cb7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 2000
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: CSOCBlockDomain
      type:
        simple: Domain
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: ad7fb981-ee06-4ac8-8216-c583784b76e5
      iscommand: true
      name: Tag 'CSOC' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: ad7fb981-ee06-4ac8-8216-c583784b76e5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1480,
          "y": 1930
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: CSOCBlockURL
      type:
        simple: URL
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 8385a786-f828-4176-8d11-f3139c655881
      iscommand: true
      name: Tag 'CSOC' Bad URL Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 8385a786-f828-4176-8d11-f3139c655881
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1690,
          "y": 1515
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: ee3665d7-ebe8-4b46-8107-ac605c326eb4
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: ee3665d7-ebe8-4b46-8107-ac605c326eb4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1690,
          "y": 1100
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_StandardRiskScore_Domain
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        simple: ${inputs.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: a8c88e5e-9769-48bb-86b1-e722d23ecbc3
      iscommand: true
      name: Update IP address Reference set "TCS_StandardRiskScore_Domain"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: a8c88e5e-9769-48bb-86b1-e722d23ecbc3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1580,
          "y": 2135
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reconcillationdate:
        simple: ${Reconcillation date}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: CSOCBlockDomain,emailblock
      type:
        simple: Domain
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 5db81f5e-b860-469d-86fe-215c96a70923
      iscommand: true
      name: Tag 'CSOC' and 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 5db81f5e-b860-469d-86fe-215c96a70923
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 1975
        }
      }
  "19":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: internet only
      label: Internet Only
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "18"
      Internet Only:
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fdd153fc-d089-48b7-8677-b837497cdae0
      iscommand: false
      name: To Be Blacklisted Only on Internet ?
      type: condition
      version: -1
    taskid: fdd153fc-d089-48b7-8677-b837497cdae0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 1795
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      alert_time:
        complex:
          accessor: created
          root: incident
          transformers:
          - operator: 8726aa62-638b-41b0-8fd7-8d8892145289
          - args:
              delimiter:
                value:
                  simple: .
              fields:
                value:
                  simple: "1"
            operator: Cut
          - args:
              prefix: {}
              suffix:
                value:
                  simple: .0Z
            operator: concat
      destination_domain:
        complex:
          root: inputs.Domain
      destination_url:
        simple: http://abc.com
      device_id:
        simple: abcdefghij
      device_version:
        simple: "1.0"
      using:
        simple: Cisco Umbrella Enforcement Block Domain_instance,Cisco Umbrella Enforcement
          Block Domain GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Enforcement Block Domain
      description: Posts a malware event to the API for processing and optionally
        adding to a customer's domain lists.
      id: bf198062-94e9-426a-840b-e23dbadee53a
      iscommand: true
      name: Block Domain on Cisco Umbrella (opendns)
      script: Cisco Umbrella Enforcement Block Domain|||umbrella-domain-event-add
      type: regular
      version: -1
    taskid: bf198062-94e9-426a-840b-e23dbadee53a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 1230
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 7acdbbc5-36df-4667-80a0-06b00c52d05a
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 7acdbbc5-36df-4667-80a0-06b00c52d05a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 1075
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 8f671af1-9e5b-4947-8d11-dc8a52058281
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 8f671af1-9e5b-4947-8d11-dc8a52058281
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 920
        }
      }
  "23":
    continueonerror: true
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_241
      ip:
        simple: ${SIXFIVE.IP}
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: dfab2896-374a-40f8-8097-643756749590
      iscommand: true
      name: Block IP on Zscaler BPS tenant
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: dfab2896-374a-40f8-8097-643756749590
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -140,
          "y": 910
        }
      }
  "24":
    continueonerror: true
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_57
      ip:
        simple: ${SIXFIVE.IP}
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 84fb8942-976c-4132-8e0e-49b1c8cf7e7e
      iscommand: true
      name: Block IP on Zscaler GNDM tenant
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 84fb8942-976c-4132-8e0e-49b1c8cf7e7e
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": -230,
          "y": 1005
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: emailblock
      type:
        simple: Domain
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 99d8df49-df5a-489b-839c-276819cb4375
      iscommand: true
      name: Tag 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 99d8df49-df5a-489b-839c-276819cb4375
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 570,
          "y": 1740
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_StandardRiskScore_IP
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        simple: ${inputs.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: 4705c7e9-28c4-49bc-8fdb-e7aa9eab88e0
      iscommand: true
      name: Update IP address Reference set "TCS_IOC_StandardRiskScore_IP"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: 4705c7e9-28c4-49bc-8fdb-e7aa9eab88e0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 310,
          "y": 2000
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ref_name:
        simple: TCS_StandardRiskScore_Domain
      using:
        simple: QRadar v3_Typosquat Offences
      value:
        simple: ${inputs.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Adds or updates an element in a reference set.
      id: cca38fa1-ff77-4444-82e5-5aa122b6f7da
      iscommand: true
      name: Update IP address Reference set "TCS_StandardRiskScore_Domain"
      script: QRadar v3|||qradar-reference-set-value-upsert
      type: regular
      version: -1
    taskid: cca38fa1-ff77-4444-82e5-5aa122b6f7da
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 2135
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ae439a23-ac18-41ce-8bbe-8df6fd1af925
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: ae439a23-ac18-41ce-8bbe-8df6fd1af925
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3110,
          "y": 2370
        }
      }
  "30":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ISOTimeNow
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "32"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6561057c-16c2-4e6b-8ddb-dfaaa5d710d6
      iscommand: false
      name: Is ISO Time Context Set?
      type: condition
      version: -1
    taskid: 6561057c-16c2-4e6b-8ddb-dfaaa5d710d6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1420,
          "y": -350
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ISOTimeNow
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 09e9f369-5ec0-4bc7-859f-db3c65908c9d
      iscommand: false
      name: Delete Old Time Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 09e9f369-5ec0-4bc7-859f-db3c65908c9d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1420,
          "y": -140
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: ISO
      dateFormat:
        simple: ISO
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: 9a7c7834-1657-4136-8b97-949a881f32ae
      iscommand: false
      name: Set Current Date In Context
      script: GetTime
      type: regular
      version: -1
    taskid: 9a7c7834-1657-4136-8b97-949a881f32ae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1420,
          "y": 30
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
      - "9"
      - "2"
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b00cc2d4-24d3-4b05-8b67-427e7fd5b532
      iscommand: false
      name: Stop Block IOC and Mitigation SLA  Timer
      type: title
      version: -1
    taskid: b00cc2d4-24d3-4b05-8b67-427e7fd5b532
    timertriggers:
    - action: stop
      fieldname: mitigationsla
    - action: stop
      fieldname: blockioctimer
    type: title
    view: |-
      {
        "position": {
          "x": 1420,
          "y": 190
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      blockedurl:
        complex:
          root: inputs.URL
          transformers:
          - operator: Stringify
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 3355d9e6-e272-4ce2-8ed2-b5ad7460869d
      iscommand: true
      name: Set Incident
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 3355d9e6-e272-4ce2-8ed2-b5ad7460869d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1690,
          "y": 1670
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      blockeddomain:
        complex:
          root: inputs.Domain
          transformers:
          - operator: Stringify
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fc168344-135b-4d7e-8eec-bba125f9cb21
      iscommand: true
      name: Set Incident
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: fc168344-135b-4d7e-8eec-bba125f9cb21
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 1610
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_17
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          root: inputs.Domain
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_ion
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 45374407-15d3-47d1-8fe3-0504dceef3e9
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - ION
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 45374407-15d3-47d1-8fe3-0504dceef3e9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 1395
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_17
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          root: inputs.URL
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_ion
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: fbcd0430-fb01-4db1-81a9-4ef4d7014e6d
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - ION
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: fbcd0430-fb01-4db1-81a9-4ef4d7014e6d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1690,
          "y": 1325
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      target_value:
        simple: ${inputs.IP}
      value_type:
        simple: ip
    separatecontext: false
    skipunavailable: false
    task:
      brand: Trend Micro Vision One
      description: Adds a file SHA-1, IP address, domain, or URL object to the User-Defined
        Suspicious Objects List, which blocks the objects on subsequent detections
      id: 45909cfe-57b9-4bbc-87ea-9a7faf70f468
      iscommand: true
      name: Blacklist IP on Trendmicro
      script: Trend Micro Vision One|||trendmicro-visionone-add-to-block-list
      type: regular
      version: -1
    taskid: 45909cfe-57b9-4bbc-87ea-9a7faf70f468
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 310,
          "y": 760
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Reconcillation Date
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: in 1 day
            operator: ModifyDateTime
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3a093d41-be8a-4f32-8c1f-ffc8ad7a67a1
      iscommand: false
      name: Calculate Reconcillation Date
      script: Set
      type: regular
      version: -1
    taskid: 3a093d41-be8a-4f32-8c1f-ffc8ad7a67a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 140,
          "y": 70
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Reconcillation Date
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: in 1 day
            operator: ModifyDateTime
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2d24ccdd-142c-482c-81bd-7619545876a8
      iscommand: false
      name: Calculate Reconcillation Date
      script: Set
      type: regular
      version: -1
    taskid: 2d24ccdd-142c-482c-81bd-7619545876a8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 140,
          "y": 70
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Reconcillation date
      value:
        complex:
          accessor: created
          root: incident
          transformers:
          - args:
              variation:
                value:
                  simple: in 6 months
            operator: ModifyDateTime
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c4d318b6-9501-4185-842d-131e06a667a3
      iscommand: false
      name: Calculate reconcillation Date
      script: Set
      type: regular
      version: -1
    taskid: c4d318b6-9501-4185-842d-131e06a667a3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1420,
          "y": -530
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "12_29_#default#": 0.15,
      "1_29_#default#": 0.12,
      "2_29_#default#": 0.1,
      "9_29_#default#": 0.14
    },
    "paper": {
      "dimensions": {
        "height": 3105,
        "width": 3720,
        "x": -230,
        "y": -670
      }
    }
  }
