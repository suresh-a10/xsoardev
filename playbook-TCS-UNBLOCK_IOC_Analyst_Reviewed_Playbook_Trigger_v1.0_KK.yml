contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: c9ee003a-87d4-4858-8a36-7380b4f29135
inputs: []
name: TCS-UNBLOCK IOC_Analyst Reviewed_Playbook Trigger v1.0_KK
outputs: []
sourceplaybookid: 0a608f75-4154-430b-81e0-3a7bc08ad2e0
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1323e6e8-d4a0-47fa-8a18-3f696eaf96b5
      iscommand: false
      name: ""
      version: -1
    taskid: 1323e6e8-d4a0-47fa-8a18-3f696eaf96b5
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1470
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 37fb24b7-6558-4292-8577-5f9d03326a9d
      iscommand: false
      name: Notify IoC(s) Blocked
      type: title
      version: -1
    taskid: 37fb24b7-6558-4292-8577-5f9d03326a9d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 920,
          "y": 240
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: Domain
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes URLs from the specified category.
      id: 60939c3d-f7eb-469c-87bf-e59b3b82de90
      iscommand: true
      name: UNBLOCK Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-remove-url
      type: regular
      version: -1
    taskid: 60939c3d-f7eb-469c-87bf-e59b3b82de90
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 280,
          "y": -380
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: URL
          root: BELOWSIXFIVE
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes URLs from the specified category.
      id: afeff05f-39e5-4702-8107-8d8b14646bba
      iscommand: true
      name: UNBLOCK CSOC Shared URL on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-remove-url
      type: regular
      version: -1
    taskid: afeff05f-39e5-4702-8107-8d8b14646bba
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1130,
          "y": -380
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 5
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        complex:
          accessor: File
          root: BELOWSIXFIVE
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1cad73e6-ee57-4c6a-89dd-3f4a16801391
      iscommand: false
      name: TCS-CSOC Block Malicious Hash on CS v1.0_Kunal
      playbookId: 9d6b9cb3-059d-4b12-865c-f73bed1daa8a
      type: playbook
      version: -1
    taskid: 1cad73e6-ee57-4c6a-89dd-3f4a16801391
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1990,
          "y": -380
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: Domain
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes URLs from the specified category.
      id: 25c6b8ef-1941-4b3a-8cec-ff22df33555c
      iscommand: true
      name: UNBLOCK Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-remove-url
      type: regular
      version: -1
    taskid: 25c6b8ef-1941-4b3a-8cec-ff22df33555c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 700,
          "y": -380
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      url:
        complex:
          accessor: URL
          root: BELOWSIXFIVE
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes URLs from the specified category.
      id: cc0a251d-9989-49d5-8ea4-829f6aff45c6
      iscommand: true
      name: UNBLOCK CSOC Shared URL on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-remove-url
      type: regular
      version: -1
    taskid: cc0a251d-9989-49d5-8ea4-829f6aff45c6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1550,
          "y": -380
        }
      }
  "69":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: BELOWSIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fa95c3ad-eb99-4011-8fea-9fbb4255ee77
      iscommand: false
      name: Are There Any IPs For UNBlocking ?
      type: condition
      version: -1
    taskid: fa95c3ad-eb99-4011-8fea-9fbb4255ee77
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -150,
          "y": -740
        }
      }
  "70":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: BELOWSIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "65"
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c2fbab0d-b695-43a4-8c13-54fc665b6af0
      iscommand: false
      name: Are There Any Domains For UNBlocking ?
      type: condition
      version: -1
    taskid: c2fbab0d-b695-43a4-8c13-54fc665b6af0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": -740
        }
      }
  "71":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: BELOWSIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "40"
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e473d4ef-c206-482e-8104-fbe0039dcb07
      iscommand: false
      name: Are There Any URLs For UNBlocking ?
      type: condition
      version: -1
    taskid: e473d4ef-c206-482e-8104-fbe0039dcb07
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1340,
          "y": -730
        }
      }
  "72":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: File
                root: BELOWSIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6483c288-9e36-4a5a-8cc3-5a29c729d363
      iscommand: false
      name: Are There Any Hashs For UNBlocking ?
      type: condition
      version: -1
    taskid: 6483c288-9e36-4a5a-8cc3-5a29c729d363
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1990,
          "y": -730
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #ff00ff;">IoC
          65 &amp; Above Have Been Blocked</span><br /></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 5bbedeee-a9a2-431b-8c00-84f7668ef3b0
      iscommand: true
      name: Set Action Notification - IoCs Blocked
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 5bbedeee-a9a2-431b-8c00-84f7668ef3b0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": 400
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1bda1750-8f7d-4374-8d9a-065e79f7148b
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 1bda1750-8f7d-4374-8d9a-065e79f7148b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 920,
          "y": 940
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "82"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #008000;">Processing
          IoC(s) For Blocking</span><br /></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 094b109d-c402-4f66-815a-d43dec4c658a
      iscommand: true
      name: Set Action Notification - Processing IoC(s) For Blocking
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 094b109d-c402-4f66-815a-d43dec4c658a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1085
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 83298d6e-8eb9-4dc9-88db-9c9ac6aa7e2e
      iscommand: false
      name: Notify Processing IoCs For Blocking
      type: title
      version: -1
    taskid: 83298d6e-8eb9-4dc9-88db-9c9ac6aa7e2e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1260
        }
      }
  "82":
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
      - "70"
      - "71"
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 73183fa4-2f7c-4bff-8edd-db37835a55c1
      iscommand: false
      name: Check Which IoC(s) 65 & Above
      type: title
      version: -1
    taskid: 73183fa4-2f7c-4bff-8edd-db37835a55c1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 920,
          "y": -900
        }
      }
  "89":
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 2
    scriptarguments:
      execution-timeout:
        simple: "100000"
      indicatorsValues:
        complex:
          accessor: IP
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: 3c89c276-ee0a-4d52-884c-0d32a5bbbd26
      iscommand: true
      name: Expire Indicator With CSOC Tag With Risk Score < 65
      script: Builtin|||expireIndicators
      type: regular
      version: -1
    taskid: 3c89c276-ee0a-4d52-884c-0d32a5bbbd26
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -150,
          "y": -380
        }
      }
  "90":
    continueonerror: true
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - args:
              delimiter: {}
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "3"
      using:
        simple: Zscaler_instance_1,Zscaler_instance_BPS,Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes the specified IP addresses from the allow list.
      id: 98cfcbb8-69c7-4d04-84bf-a5fb04cb1dcb
      iscommand: true
      name: Unblock IP From Zscaler
      script: Zscaler|||zscaler-undo-blacklist-ip
      type: regular
      version: -1
    taskid: 98cfcbb8-69c7-4d04-84bf-a5fb04cb1dcb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -150,
          "y": -170
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "69_79_#default#": 0.14,
      "69_89_yes": 0.46,
      "70_79_#default#": 0.1,
      "71_79_#default#": 0.1,
      "72_79_#default#": 0.17
    },
    "paper": {
      "dimensions": {
        "height": 2475,
        "width": 2520,
        "x": -150,
        "y": -1470
      }
    }
  }
