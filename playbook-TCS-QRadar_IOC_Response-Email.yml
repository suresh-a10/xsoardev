contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 3b75d8e0-5aaa-4dc4-88fd-e7ac9f950441
inputs: []
name: TCS-QRadar IOC Response-Email
outputs: []
sourceplaybookid: 3a37bf98-d8e9-4ab9-8889-dba63691e69c
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2f8d501f-06a5-457a-80c9-f6c921110410
      iscommand: false
      name: ""
      version: -1
    taskid: 2f8d501f-06a5-457a-80c9-f6c921110410
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1260,
          "y": -770
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 0ad1efa6-0c02-4363-827d-075aeaaf6908
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 0ad1efa6-0c02-4363-827d-075aeaaf6908
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1090
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f2c00dc0-8583-4d8e-8ab3-eda342aa141f
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: f2c00dc0-8583-4d8e-8ab3-eda342aa141f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1260,
          "y": -270
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 386bec83-44fb-417c-86e7-499d65b55bb1
      iscommand: false
      name: 'Phase1: Invoke IOC Blocking Playbooks'
      type: title
      version: -1
    taskid: 386bec83-44fb-417c-86e7-499d65b55bb1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1260,
          "y": -670
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6193a2b5-ebba-48c7-8213-f7e26e77dc20
      iscommand: false
      name: 'Phase2: QRadar'
      type: title
      version: -1
    taskid: 6193a2b5-ebba-48c7-8213-f7e26e77dc20
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1260,
          "y": -160
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      EmailedFileData:
        simple: ${File.Data}
      File:
        simple: ${File}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: d30e0aea-0954-45c8-8980-fa3c25914e50
      iscommand: false
      name: TCS-Generic EDL Upload IP BlockList handler
      playbookId: bcaddc7b-d2e8-46c5-8761-d197e5d28e19
      type: playbook
      version: -1
    taskid: d30e0aea-0954-45c8-8980-fa3c25914e50
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1260,
          "y": -570
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9cfa8b75-3729-4b07-8d8a-5d0dbef1de3a
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 9cfa8b75-3729-4b07-8d8a-5d0dbef1de3a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 670
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8687ec6d-f431-404a-803b-040ed35b6c36
      iscommand: false
      name: 'Phase 2: Update existing QRadar IoC detection rule/reference set'
      type: title
      version: -1
    taskid: 8687ec6d-f431-404a-803b-040ed35b6c36
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1260,
          "y": -50
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: TCS_MasterIOC_IP
      value:
        complex:
          root: JoinedFilesUnique
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds or updates a value in a reference set.
      id: e8305ce9-285d-432c-86e3-e461a85786af
      iscommand: true
      name: Update IP address Reference set "TCS_MasterIOC_IP"
      script: '|||qradar-update-reference-set-value'
      type: regular
      version: -1
    taskid: e8305ce9-285d-432c-86e3-e461a85786af
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 540,
          "y": 340
        }
      }
  "42":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: EmailedDomainsURLsUnique
          operator: isExists
      label: else
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "51"
      else:
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ebae100d-77cf-42a1-8c78-0dfd8f4028c0
      iscommand: false
      name: Check if EmailedDomainURLUnique file is exist
      type: condition
      version: -1
    taskid: ebae100d-77cf-42a1-8c78-0dfd8f4028c0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 980,
          "y": 130
        }
      }
  "43":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: JoinedFilesUnique
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2eaa3300-3cdc-41c5-8a3a-4a264bb6deb2
      iscommand: false
      name: Check If JoinedFileUnique file exist
      type: condition
      version: -1
    taskid: 2eaa3300-3cdc-41c5-8a3a-4a264bb6deb2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 540,
          "y": 130
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: TCS_MasterIOC_Domain
      value:
        complex:
          root: EmailedDomainsURLsUnique
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds or updates a value in a reference set.
      id: ee80c50b-b4e3-4acc-8e6f-8a586e9dc700
      iscommand: true
      name: Update Domain Reference set "TCS_MasterIOC_Domain"
      script: '|||qradar-update-reference-set-value'
      type: regular
      version: -1
    taskid: ee80c50b-b4e3-4acc-8e6f-8a586e9dc700
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 980,
          "y": 330
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: TCS_MasterIOC_SHA256
      value:
        complex:
          root: EmailedHashs-SHA256
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds or updates a value in a reference set.
      id: aeac8c80-18c3-44f0-834c-e6035c740e51
      iscommand: true
      name: Update SHA256 Reference set "TCS_MasterIOC_SHA256"
      script: '|||qradar-update-reference-set-value'
      type: regular
      version: -1
    taskid: aeac8c80-18c3-44f0-834c-e6035c740e51
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 310
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      ref_name:
        simple: TCS_MasterIOC_MD5
      value:
        complex:
          root: EmailedHashs-MD5
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds or updates a value in a reference set.
      id: 45b56232-9daf-4d2a-8558-8516685d0e33
      iscommand: true
      name: Update MD5 Reference set "TCS_MasterIOC_MD5"
      script: '|||qradar-update-reference-set-value'
      type: regular
      version: -1
    taskid: 45b56232-9daf-4d2a-8558-8516685d0e33
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1870,
          "y": 310
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 0
      wait: 0
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      IPAddress:
        simple: ${EmailedIPs}
      InvestigationIPFields:
        simple: sourceip, destinationip
      InvestigationUserFields:
        simple: username
      MD5:
        simple: ${inputs.HashMD5ReferenceSet}
      QradarIPfield:
        simple: sourceip, destinationip
      QradarMD5Field:
        simple: File Hash
      QradarSHA256Field:
        simple: File Hash
      QradarURLDomainField:
        simple: URL
      SHA256:
        simple: ${inputs.Hash256ReferenceSet}
      TimeFrame:
        simple: LAST 30 DAYS
      URLDomain:
        simple: ${EmailedDomainsURLsUnique}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: 'The Playbook queries QRadar SIEM for indicators such as file hashes,
        IP addresses, domains, or urls. '
      id: 63d80d4b-cf39-4c44-8288-e0e2bcae9642
      iscommand: false
      name: QRadar Indicator Hunting V2
      playbookId: QRadar Indicator Hunting V2
      type: playbook
      version: -1
    taskid: 63d80d4b-cf39-4c44-8288-e0e2bcae9642
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 785
        }
      }
  "51":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: EmailedHashs-SHA256
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "52"
      "yes":
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9133a94c-1174-4146-8092-e12409f29591
      iscommand: false
      name: Checked if EmailedHash-SHA256 file is exist
      type: condition
      version: -1
    taskid: 9133a94c-1174-4146-8092-e12409f29591
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1420,
          "y": 120
        }
      }
  "52":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: EmailedHashs-MD5
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      "yes":
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9b5648ff-9106-46d0-873e-1c016fe323d2
      iscommand: false
      name: Checked if EmailedHash-MD5 file is exist
      type: condition
      version: -1
    taskid: 9b5648ff-9106-46d0-873e-1c016fe323d2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1860,
          "y": 120
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 60e7fa7b-fe6d-4627-8de2-3cd9cd3ebf22
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 60e7fa7b-fe6d-4627-8de2-3cd9cd3ebf22
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 540,
          "y": 500
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5f1792c2-5e57-41b8-890d-30328fa8adf8
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 5f1792c2-5e57-41b8-890d-30328fa8adf8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 980,
          "y": 510
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8559a311-aa7e-40e2-820a-76b161d2f3da
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 8559a311-aa7e-40e2-820a-76b161d2f3da
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 500
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d4289c97-0c81-4c4f-8421-5c888af07322
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: d4289c97-0c81-4c4f-8421-5c888af07322
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1870,
          "y": 530
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI found a positive detection for the below IOCs in
          my QRadar  historical search. \n\nDetected Users:  ${QRadar.DetectedUsers}\n\nDetected
          InternalIP's:  ${QRadar.DetectedInternalIPs}\n\nDetected ExternalIP's:  ${QRadar.DetectedExternalIPs}\n\nDetected
          Internal Hosts:  ${QRadar.DetectedInternalHosts}\n\nDetected External Hosts:
          \ ${QRadar.DetectedExternalHosts}\n\n\nRegards,\nCyber AutoBot"
      subject:
        simple: 'Found Positive Detection For QRadar  Historical Search '
      to:
        simple: v.ghule@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: b916c7bb-1c7a-4639-8916-ae07bef84105
      iscommand: true
      name: Send Notification Email to CSOC Manager and Analyst
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: b916c7bb-1c7a-4639-8916-ae07bef84105
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 940
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hi,

          Emailed IOC's are blocked  through Demisto.
      cc:
        simple: v.ghule@tcs.com
      subject:
        simple: IOC's are blocked  through Demisto.
      to:
        simple: InternalIs.CyberSecurityOps@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: bd6efae0-fd8c-474a-808d-8e21bcb0baa3
      iscommand: true
      name: Send IOC blocking confirmation mail to team
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: bd6efae0-fd8c-474a-808d-8e21bcb0baa3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1260,
          "y": -420
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 861a3962-b11d-48b5-8053-23925ae13946
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 861a3962-b11d-48b5-8053-23925ae13946
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1250
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "42_51_#default#": 0.17
    },
    "paper": {
      "dimensions": {
        "height": 2085,
        "width": 1710,
        "x": 540,
        "y": -770
      }
    }
  }
