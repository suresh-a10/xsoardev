contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: d54e2056-1443-445f-8ad0-c28e21b6f999
inputs:
- description: ""
  key: Domain
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Domain
      root: ExtractedIndicators
name: TCS-Domain Verification_IOC Blockingv1.0_Kunal_copy
outputs:
- contextPath: ExtractedIndicators.Domain
  description: Domain
  type: unknown
sourceplaybookid: 10a892d4-e4b5-4b5e-80ea-dcaccb53541a
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "96"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1bd366e3-34dc-484a-8e0e-54df584b7d84
      iscommand: false
      name: ""
      version: -1
    taskid: 1bd366e3-34dc-484a-8e0e-54df584b7d84
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 275,
          "y": -475
        }
      }
  "3":
    continueonerror: true
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "62"
      "yes":
      - "7"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.TCS_Customer_Domain_List}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 579ee9de-538c-4abe-80fc-920e80aecebe
      iscommand: false
      name: Does Domain Belong To Customer ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 579ee9de-538c-4abe-80fc-920e80aecebe
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 3870
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain4.Customer
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 84cd6bf2-3938-41a7-8726-0a04c4bad1e0
      iscommand: false
      name: Set Customer Domain into Context
      script: Set
      type: regular
      version: -1
    taskid: 84cd6bf2-3938-41a7-8726-0a04c4bad1e0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 4045
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain3
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4d91359c-8f1f-461f-81de-2bd9ab547721
      iscommand: false
      name: Set Output into Context
      script: Set
      type: regular
      version: -1
    taskid: 4d91359c-8f1f-461f-81de-2bd9ab547721
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 3355
        }
      }
  "11":
    continueonerror: true
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "no":
      - "10"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.TCS_Customer_Domain_List},${lists.MasterIOC_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: b9047f2e-1c74-4eae-8a76-2ff6bcf9c7ab
      iscommand: false
      name: Does Domain Belong To TCS or Customer or In Master IOC List?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: b9047f2e-1c74-4eae-8a76-2ff6bcf9c7ab
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 3170
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      attachIDs:
        simple: ${.=val.File.filter(function(f){return f.EntryID;}).reduce(function(acc,
          f) {return f;}, null).EntryID}
      body:
        simple: "Hello Human,\n\nI found Internal/Customer Domain in this file ${incident.attachment.name}.
          \nPFA Risk Score report.\n\nInternal/Customer Domain:\n\n${Domain4.Customer}\n\n\nRegards,\nCSOC
          CyberAutoBot"
      subject:
        simple: Found Internal/Customer Domain In This File ${incident.attachment.name}
      to:
        complex:
          accessor: emailfrom
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 944ccd71-4182-4984-8e19-c470250c0f58
      iscommand: true
      name: Send Email Notification That Internal/Customer Domain Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 944ccd71-4182-4984-8e19-c470250c0f58
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 5475
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 46cf7824-c435-40f9-8fbd-8f9f4c099bc0
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 46cf7824-c435-40f9-8fbd-8f9f4c099bc0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -490,
          "y": 6110
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
      - "35"
      - "61"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ca875fdc-0774-4d63-803f-1a244ea8cf38
      iscommand: false
      name: Generate Report & Notify
      type: title
      version: -1
    taskid: ca875fdc-0774-4d63-803f-1a244ea8cf38
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 275,
          "y": 5065
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain4.Customer
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: check for trusted ioc
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f636caf2-b9e4-4734-8521-49fece84c890
      iscommand: false
      name: Verify There Are No Customer Domain In The List ?
      type: condition
      version: -1
    taskid: f636caf2-b9e4-4734-8521-49fece84c890
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 5220
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI did not find any customer domain in this file ${incident.attachment.name}\n\n\nRegards,\nCSOC
          CyberAutoBot "
      subject:
        simple: No Customer Domain Found In This File ${incident.attachment.name}
      to:
        complex:
          accessor: emailfrom
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 98559599-ac09-400d-8176-45ad6d0f3355
      iscommand: true
      name: Send Email Notification That No Customer Domain Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 98559599-ac09-400d-8176-45ad6d0f3355
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 5475
        }
      }
  "40":
    continueonerror: true
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "92"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${Domain4.Customer}
      retry-count:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets a quick indicator of the risk associated with a domain.
      id: c702473c-c333-470e-8bdf-99e49f362c4e
      iscommand: true
      name: Get Risk Score
      script: Recorded Future v2.1|||domain
      type: regular
      version: -1
    taskid: c702473c-c333-470e-8bdf-99e49f362c4e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 4210
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 3b8d92b5-a495-47ba-8fc9-f81b42d4653a
      iscommand: false
      name: Delete Extracted Indicators Domain Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 3b8d92b5-a495-47ba-8fc9-f81b42d4653a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 3510
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .tcs.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .ultimatix.net
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .google.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .microsoft.com
          - - left:
                iscontext: true
                value:
                  simple: Domain3
              operator: notContainsGeneral
              right:
                value:
                  simple: .gstatic.com
          root: Domain3
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9a127710-9b27-4784-837a-c134643a4fe0
      iscommand: false
      name: Set New Unique Domains Into Extracted Indicators
      script: Set
      type: regular
      version: -1
    taskid: 9a127710-9b27-4784-837a-c134643a4fe0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 3675
        }
      }
  "61":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain4.Customer
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isNotEqualString
          right:
            value:
              simple: ajit.menon@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a2e21b94-8558-4fb6-8a15-a90e2f2b344a
      iscommand: false
      name: Is There a Internal/Customer Domain ?
      type: condition
      version: -1
    taskid: a2e21b94-8558-4fb6-8a15-a90e2f2b344a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 820,
          "y": 5220
        }
      }
  "62":
    continueonerror: true
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "63"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          accessor: Domain
          root: ExtractedIndicators2
      ipRanges:
        simple: ${lists.MasterIOC_Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: 4841cbe5-c534-4b1c-8a8e-f8848519028f
      iscommand: false
      name: Is Domain In Master IOC List ?
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: 4841cbe5-c534-4b1c-8a8e-f8848519028f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 4570
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: Domain5.MasterIOC
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5415d77a-a50c-4376-846d-e7f2a567533c
      iscommand: false
      name: Set Master IOC Domain into Context
      script: Set
      type: regular
      version: -1
    taskid: 5415d77a-a50c-4376-846d-e7f2a567533c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 4810
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      body:
        simple: "Hello Human,\n\nI found that below Domains from the file ${incident.attachment.name}
          are already in the Master IOC list. I will not be performing any action
          on these IOCs.\n\nDomain:\n\n${Domain5.MasterIOC} \n\n\n\nRegards,\nCSOC
          CyberAutoBot "
      subject:
        simple: Domains In Master IOC List Found In This File ${incident.attachment.name}
      to:
        complex:
          accessor: emailfrom
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: a4afb2a4-cfa0-4db3-8f7c-0f5433f0a275
      iscommand: true
      name: Send Email Notification Found Domain In Master IOC
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: a4afb2a4-cfa0-4db3-8f7c-0f5433f0a275
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -257.5,
          "y": 5475
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: MasterIOC
                root: Domain5
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: check for trusted ioc
        - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: block ioc
        - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: blacklist ioc
      label: "yes"
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "64"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 967788ca-39a7-4127-80f7-5a11bfbb7906
      iscommand: false
      name: Verify The Master IOC & Email Subject Condition
      type: condition
      version: -1
    taskid: 967788ca-39a7-4127-80f7-5a11bfbb7906
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -257.5,
          "y": 5220
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExtractedIndicators.Domain
      value:
        complex:
          accessor: Domain_Test_
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c562393e-d64b-4106-8659-5b7201d80fb3
      iscommand: false
      name: Set Extracted Indicators Context (Strip www. & Unique)
      script: Set
      type: regular
      version: -1
    taskid: c562393e-d64b-4106-8659-5b7201d80fb3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1985
        }
      }
  "68":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain_Test_
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "70"
      "yes":
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 25d41275-380f-48ba-8e19-786038fd4928
      iscommand: false
      name: Is Domain Test Context Defined ?
      type: condition
      version: -1
    taskid: 25d41275-380f-48ba-8e19-786038fd4928
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 820,
          "y": 1800
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "89"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: IOC.Domain2
      value:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: eb78fabf-9ab8-4ac9-8eed-f64e277a6734
      iscommand: false
      name: Set Indicators In Context
      script: Set
      type: regular
      version: -1
    taskid: eb78fabf-9ab8-4ac9-8eed-f64e277a6734
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 2160
        }
      }
  "82":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.URL
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "68"
      "yes":
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2c04e919-823f-45a4-8df5-4843f90a4f5d
      iscommand: false
      name: Is There a URL Context ?
      type: condition
      version: -1
    taskid: 2c04e919-823f-45a4-8df5-4843f90a4f5d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 270
        }
      }
  "83":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "68"
      "yes":
      - "84"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4abb7e90-bc9b-4d37-85e7-c85fd9212373
      iscommand: false
      name: Is there a Domain Context ?
      type: condition
      version: -1
    taskid: 4abb7e90-bc9b-4d37-85e7-c85fd9212373
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 500
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    scriptarguments:
      domains:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      urls:
        complex:
          accessor: URL
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the supplied URLs are in the specified domains.
      id: e2580ecf-2325-4ce1-8c8a-cd61c9925ea2
      iscommand: false
      name: 'Compare Domain & URL Context '
      script: IsUrlPartOfDomain
      type: regular
      version: -1
    taskid: e2580ecf-2325-4ce1-8c8a-cd61c9925ea2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 730
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: IOC.URLDomains
      value:
        complex:
          accessor: Domain
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IsUrlPartOfDomain.IsInternal
              operator: isEqualString
              right:
                value:
                  simple: "true"
          root: IsUrlPartOfDomain
          transformers:
          - args:
              chars:
                value:
                  simple: www.
            operator: StripChars
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d2c18c74-a840-49ec-801b-eaae3712b283
      iscommand: false
      name: Set URL Domains in Context
      script: Set
      type: regular
      version: -1
    taskid: d2c18c74-a840-49ec-801b-eaae3712b283
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 915
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "87"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        complex:
          accessor: URLDomains
          root: IOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2.1
      description: Gets a quick indicator of the risk associated with a domain.
      id: aa9dd7dc-dbd7-4619-8b7d-88872475b918
      iscommand: true
      name: Enrich Domain With RF
      script: Recorded Future v2.1|||domain
      type: regular
      version: -1
    taskid: aa9dd7dc-dbd7-4619-8b7d-88872475b918
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1100
        }
      }
  "87":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.Domain
          operator: lessThan
          right:
            value:
              simple: "65"
      label: "yes"
    continueonerrortype: ""
    id: "87"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "93"
      "yes":
      - "88"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b8f0cac8-e5bc-487e-80c9-723d4272fbdd
      iscommand: false
      name: Any Domain With Risk Score < 65 ?
      type: condition
      version: -1
    taskid: b8f0cac8-e5bc-487e-80c9-723d4272fbdd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1275
        }
      }
  "88":
    continueonerrortype: ""
    id: "88"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: IOC.Domain
      value:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.Domain.riskScore
              operator: lessThan
              right:
                value:
                  simple: "65"
          root: RecordedFuture.Domain
          transformers:
          - args:
              chars:
                value:
                  simple: www.
            operator: StripChars
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2f396818-f79c-4301-8056-3324f2e11a30
      iscommand: false
      name: 'Set Domains < 65 in Context '
      script: Set
      type: regular
      version: -1
    taskid: 2f396818-f79c-4301-8056-3324f2e11a30
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1450
        }
      }
  "89":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: IOC
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: IOC
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "95"
      "yes":
      - "90"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0481f650-e405-4495-8c4b-f551f17af4d9
      iscommand: false
      name: Any URL Domains To Compare ?
      type: condition
      version: -1
    taskid: 0481f650-e405-4495-8c4b-f551f17af4d9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 2335
        }
      }
  "90":
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${IOC.Domain2}
      right:
        simple: ${IOC.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: fecfc8c1-45f2-4ae8-88da-981719a4b7e2
      iscommand: false
      name: Compare The URL Domain < 65 and Extracted Domain
      script: CompareLists
      type: regular
      version: -1
    taskid: fecfc8c1-45f2-4ae8-88da-981719a4b7e2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 2360
        }
      }
  "91":
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators2.Domain
      value:
        complex:
          accessor: LeftOnly
          root: ListCompare
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: c8da724a-ead6-4459-8c3b-a9c387740bcf
      iscommand: false
      name: Set Context Extracted indicators 2
      script: Set
      type: regular
      version: -1
    taskid: c8da724a-ead6-4459-8c3b-a9c387740bcf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 2730
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${RecordedFuture.Domain}
      fileName:
        simple: Domain Risk Score.csv
      headers:
        simple: name,riskScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: cd504295-3ce5-4df6-82a3-eeaa7b7b7140
      iscommand: false
      name: Generate CSV Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: cd504295-3ce5-4df6-82a3-eeaa7b7b7140
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 820,
          "y": 4385
        }
      }
  "93":
    continueonerrortype: ""
    id: "93"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: RecordedFuture
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: a23171f6-7dd3-427d-81dd-d03106ac963a
      iscommand: false
      name: Delete Recorded Future context
      script: DeleteContext
      type: regular
      version: -1
    taskid: a23171f6-7dd3-427d-81dd-d03106ac963a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1625
        }
      }
  "94":
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "98"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1b3fd310-96c6-4f97-8de7-3cb36e50fbf5
      iscommand: false
      name: 'Domain Owner Verification '
      type: title
      version: -1
    taskid: 1b3fd310-96c6-4f97-8de7-3cb36e50fbf5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 275,
          "y": 2870
        }
      }
  "95":
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators2.Domain
      value:
        complex:
          accessor: Domain2
          root: IOC
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 05a1f457-842c-480f-839f-58ef51218a0a
      iscommand: false
      name: Set Context Extracted indicators 2
      script: Set
      type: regular
      version: -1
    taskid: 05a1f457-842c-480f-839f-58ef51218a0a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 2705
        }
      }
  "96":
    continueonerrortype: ""
    id: "96"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "97"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4db13439-d821-4ec7-8307-decf90f12b20
      iscommand: false
      name: Identify Domain Indicators For Owner Verification
      type: title
      version: -1
    taskid: 4db13439-d821-4ec7-8307-decf90f12b20
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 275,
          "y": -290
        }
      }
  "97":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain_Test_
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.URL
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "82"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7da023db-6cd4-4c51-881c-06639e4aeb81
      iscommand: false
      name: Is there a Domain Context ?
      type: condition
      version: -1
    taskid: 7da023db-6cd4-4c51-881c-06639e4aeb81
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -80,
          "y": -50
        }
      }
  "98":
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ExtractedIndicators.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: a80860bd-0c73-48e8-8c4b-e9d1950807d7
      iscommand: false
      name: Delete Extract Indicator Domain Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: a80860bd-0c73-48e8-8c4b-e9d1950807d7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 3010
        }
      }
  "99":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsInternal
                root: IsUrlPartOfDomain
          operator: isEqualString
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "87"
      "yes":
      - "85"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cabac619-deaf-4a9b-8826-67fe58216896
      iscommand: false
      name: Is Domain Found in URL Context
      type: condition
      version: -1
    taskid: cabac619-deaf-4a9b-8826-67fe58216896
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -200,
          "y": 840
        }
      }
  "100":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: LeftOnly
                root: ListCompare
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "100"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "95"
      "yes":
      - "91"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d6f33721-5bbc-4f7d-803a-7ddcffcd3ade
      iscommand: false
      name: Check If Left Context Is NOT Empty
      type: condition
      version: -1
    taskid: d6f33721-5bbc-4f7d-803a-7ddcffcd3ade
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 820,
          "y": 2525
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "100_91_yes": 0.61,
      "11_10_no": 0.53,
      "11_3_#default#": 0.2,
      "35_33_#default#": 0.69,
      "3_62_#default#": 0.49,
      "3_7_yes": 0.52,
      "61_33_#default#": 0.56,
      "62_63_yes": 0.53,
      "66_33_#default#": 0.71,
      "68_67_yes": 0.46,
      "68_70_#default#": 0.48,
      "82_68_#default#": 0.21,
      "82_83_yes": 0.5,
      "83_68_#default#": 0.24,
      "83_84_yes": 0.52,
      "87_88_yes": 0.56,
      "89_90_yes": 0.52,
      "89_95_#default#": 0.55
    },
    "paper": {
      "dimensions": {
        "height": 6650,
        "width": 1690,
        "x": -490,
        "y": -475
      }
    }
  }
