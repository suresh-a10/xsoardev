contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 2898b478-3999-4433-831d-32afd1917690
inputs: []
name: IOC Riskscore_Sonam
outputs: []
sourceplaybookid: 9982ea55-79eb-4481-8f98-e95dd03f3bf2
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ec2c60c7-654c-4f1e-83a2-d921c72854a6
      iscommand: false
      name: ""
      version: -1
    taskid: ec2c60c7-654c-4f1e-83a2-d921c72854a6
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 265,
          "y": 65
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dacbbd27-7051-4a2e-8439-219c9d3c7a92
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: dacbbd27-7051-4a2e-8439-219c9d3c7a92
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: 07be3d5c-b78b-4cd7-888f-e3ed5ca81046
      iscommand: false
      name: Read File
      script: ReadFile
      type: regular
      version: -1
    taskid: 07be3d5c-b78b-4cd7-888f-e3ed5ca81046
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 225
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      array:
        simple: ${IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Count an array size
      id: 5cc61425-4e48-4bcf-84b6-5a29c602436a
      iscommand: false
      name: Count array size
      script: CountArraySize
      type: regular
      version: -1
    taskid: 5cc61425-4e48-4bcf-84b6-5a29c602436a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": 225
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: IOC
      value:
        complex:
          root: FileData
          transformers:
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:\[\.\]|\.)){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\b
            operator: RegexExtractAll
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b230a461-3f3d-4edb-8f03-dcd102e77a11
      iscommand: false
      name: set Context Data
      script: Set
      type: regular
      version: -1
    taskid: b230a461-3f3d-4edb-8f03-dcd102e77a11
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": 50
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1080000"
      ignore-outputs:
        simple: "false"
      ip:
        simple: ${IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      id: 32939188-ddd3-4597-8968-dcb8667d07ed
      iscommand: false
      name: RF Riskscore Check
      script: b15a38a4-e760-4de5-80e3-8ff23b052b78
      type: regular
      version: -1
    taskid: 32939188-ddd3-4597-8968-dcb8667d07ed
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${IPAddress}
      fileName:
        simple: RiskscoreReport.csv
      headers:
        simple: ip,riskscore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 9d67888c-ff27-4374-8e60-0a540cb66cdc
      iscommand: false
      name: Generate Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 9d67888c-ff27-4374-8e60-0a540cb66cdc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Riskscore.Result
      value:
        simple: ${RecordedFuture.IP.riskScore}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2a75132e-bb81-44d1-8ebf-be4354345eac
      iscommand: false
      name: Set array of score
      script: Set
      type: regular
      version: -1
    taskid: 2a75132e-bb81-44d1-8ebf-be4354345eac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 50
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: IPAddress
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 60388e9e-5503-4b3b-8397-1182364e54a2
      iscommand: false
      name: Delete IPaddress Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 60388e9e-5503-4b3b-8397-1182364e54a2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: a55bf6d3-387f-4972-8e77-03b0bce36efa
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: a55bf6d3-387f-4972-8e77-03b0bce36efa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1595
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${Hash}
      fileName:
        simple: HashRiskscoreReport.csv
      headers:
        simple: hash,riskscore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: 691787a5-219f-47e2-8afa-671c48685e9f
      iscommand: false
      name: Generate Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: 691787a5-219f-47e2-8afa-671c48685e9f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Hash
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: c3dcf483-3b17-4898-801f-456b60638c10
      iscommand: false
      name: Delete Hash Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: c3dcf483-3b17-4898-801f-456b60638c10
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: IOC.IP
      data:
        simple: ${FileData}
      regex:
        simple: \b(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:\[\.\]|\.)){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\b
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Extracts regex data from the provided text. The script support
        groups and looping.
      id: 60f8faeb-d810-4bcb-8b56-feae47dfea3c
      iscommand: false
      name: Filter IPs
      script: MatchRegexV2
      type: regular
      version: -1
    taskid: 60f8faeb-d810-4bcb-8b56-feae47dfea3c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 400
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: IOC.Hash
      data:
        simple: ${FileData}
      regex:
        simple: \b[a-fA-F\d]{32}\b|\b[a-fA-F\d]{40}\b|\b[a-fA-F\d]{64}\b|\b[a-fA-F\d]{128}\b
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Extracts regex data from the provided text. The script support
        groups and looping.
      id: 35ede2db-ea02-4e03-87db-8b35c7b7ac49
      iscommand: false
      name: Filter Hash
      script: MatchRegexV2
      type: regular
      version: -1
    taskid: 35ede2db-ea02-4e03-87db-8b35c7b7ac49
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 400
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9a0ed890-7484-4ad8-8cd6-fdf83cd7cb2c
      iscommand: false
      name: Set Context for IOC
      type: title
      version: -1
    taskid: 9a0ed890-7484-4ad8-8cd6-fdf83cd7cb2c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 575
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1785,
        "width": 1455,
        "x": 50,
        "y": 50
      }
    }
  }
