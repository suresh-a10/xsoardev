contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: f29b8808-a5ad-4244-8642-89e6706ef517
inputs: []
name: TCS-Block IOC_Analyst Reviewed_Playbook Trigger v1.0_KK
outputs: []
sourceplaybookid: 0a608f75-4154-430b-81e0-3a7bc08ad2e0
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bea54f61-1c98-42c5-8987-85aaf5474dc3
      iscommand: false
      name: ""
      version: -1
    taskid: bea54f61-1c98-42c5-8987-85aaf5474dc3
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 920,
          "y": -2130
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cb1d8af2-700b-4b1f-8a78-0599e7b68ab8
      iscommand: false
      name: Notify IoC(s) Blocked
      type: title
      version: -1
    taskid: cb1d8af2-700b-4b1f-8a78-0599e7b68ab8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1110
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: CSOCBlockURL
      type:
        simple: URL
      value:
        simple: ${BELOWSIXFIVE.URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 061d9144-c23e-485d-8d54-890d6bd89b3d
      iscommand: true
      name: Tag 'CSOC' Bad URL Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 061d9144-c23e-485d-8d54-890d6bd89b3d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1130,
          "y": -110
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: Domain
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: a014db4d-8c28-494f-84b2-cec915e80f84
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: a014db4d-8c28-494f-84b2-cec915e80f84
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 680,
          "y": -180
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
      - "33"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_126
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: URL
          root: BELOWSIXFIVE
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: b04e5a08-45ba-40ad-87c9-6990ec95632d
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - Corp
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: b04e5a08-45ba-40ad-87c9-6990ec95632d
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1130,
          "y": -300
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "104"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${BELOWSIXFIVE.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ecc40746-0c9b-488a-8052-574df512aec8
      iscommand: false
      name: TCS-Add New CSOC IP Indicator v1.0_Kunal
      playbookId: e653e5ab-6658-4f7a-806d-6a79d92d5d98
      type: playbook
      version: -1
    taskid: ecc40746-0c9b-488a-8052-574df512aec8
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: playbook
    view: |-
      {
        "position": {
          "x": -250,
          "y": -285
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 5
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        complex:
          accessor: File
          root: BELOWSIXFIVE
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 65c036e1-e7be-4d8b-8ad3-8d65fd005b73
      iscommand: false
      name: TCS-CSOC Block Malicious Hash on CS v1.0_Kunal
      playbookId: 9d6b9cb3-059d-4b12-865c-f73bed1daa8a
      type: playbook
      version: -1
    taskid: 65c036e1-e7be-4d8b-8ad3-8d65fd005b73
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: playbook
    view: |-
      {
        "position": {
          "x": 1990,
          "y": -300
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: Domain
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 52b3e30d-515e-45ee-8bc6-e63b6b8c34d1
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 52b3e30d-515e-45ee-8bc6-e63b6b8c34d1
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 680,
          "y": -25
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_240
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: URL
          root: BELOWSIXFIVE
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 686c972f-933f-4d4c-88fe-10d1af1ee1e9
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - BPS
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 686c972f-933f-4d4c-88fe-10d1af1ee1e9
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1560,
          "y": -300
        }
      }
  "69":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: BELOWSIXFIVE
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 609e4180-d248-42b7-8981-c88bd37e3cbd
      iscommand: false
      name: Are There Any IPs For Blocking ?
      type: condition
      version: -1
    taskid: 609e4180-d248-42b7-8981-c88bd37e3cbd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -250,
          "y": -740
        }
      }
  "70":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: BELOWSIXFIVE
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 96d97990-c8a7-4016-8093-83f8221b86ab
      iscommand: false
      name: Are There Any Domains For Blocking ?
      type: condition
      version: -1
    taskid: 96d97990-c8a7-4016-8093-83f8221b86ab
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": -740
        }
      }
  "71":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: BELOWSIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "40"
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ae7e4cc0-f9ad-4098-8b7a-507ca980cce8
      iscommand: false
      name: Are There Any URLs For Blocking ?
      type: condition
      version: -1
    taskid: ae7e4cc0-f9ad-4098-8b7a-507ca980cce8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1340,
          "y": -730
        }
      }
  "72":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: File
                root: BELOWSIXFIVE
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7b53d8cd-932f-45bb-826d-7d95ad837da8
      iscommand: false
      name: Are There Any Hashs For Blocking ?
      type: condition
      version: -1
    taskid: 7b53d8cd-932f-45bb-826d-7d95ad837da8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1990,
          "y": -730
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #ff00ff;">IoC
          65 &amp; Above Have Been Blocked</span><br /></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: e2aa8e06-d26b-4eec-8e77-7223d0089958
      iscommand: true
      name: Set Action Notification - IoCs Blocked
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: e2aa8e06-d26b-4eec-8e77-7223d0089958
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1290
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cdecb60d-6f9b-4f06-8ca0-b7f3dbb51354
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: cdecb60d-6f9b-4f06-8ca0-b7f3dbb51354
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1460
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "82"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h2 style="text-align: center;"><em><span style="color: #008000;">Processing
          IoC(s) For Blocking</span><br /></em></h2>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 5d872ed2-9c29-491d-82e6-71f8f7f80ffc
      iscommand: true
      name: Set Action Notification - Processing IoC(s) For Blocking
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 5d872ed2-9c29-491d-82e6-71f8f7f80ffc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1085
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bc9789f5-4eca-429e-861d-12596b4ea4fb
      iscommand: false
      name: Notify Processing IoCs For Blocking
      type: title
      version: -1
    taskid: bc9789f5-4eca-429e-861d-12596b4ea4fb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1260
        }
      }
  "82":
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
      - "70"
      - "71"
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7128352f-915f-4210-8843-40030fa5e004
      iscommand: false
      name: Check Which IoC(s) 65 & Above
      type: title
      version: -1
    taskid: 7128352f-915f-4210-8843-40030fa5e004
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 920,
          "y": -900
        }
      }
  "83":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ISOTimeNow
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "83"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "88"
      "yes":
      - "84"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 15fba75c-cf54-436e-8678-970f0817131f
      iscommand: false
      name: Is ISO Time Context Set?
      type: condition
      version: -1
    taskid: 15fba75c-cf54-436e-8678-970f0817131f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1950
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "88"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ISOTimeNow
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 584375ae-ced9-4c68-805f-ada852528943
      iscommand: false
      name: Delete Old Time Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 584375ae-ced9-4c68-805f-ada852528943
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1720
        }
      }
  "88":
    continueonerrortype: ""
    id: "88"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: ISO
      dateFormat:
        simple: ISO
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: 6492556d-353a-4b03-8224-d167e04237bd
      iscommand: false
      name: Get Current Date
      script: GetTime
      type: regular
      version: -1
    taskid: 6492556d-353a-4b03-8224-d167e04237bd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": -1520
        }
      }
  "89":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
          operator: isEqualString
          right:
            value:
              simple: EWS v2
      label: "yes"
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "97"
      "yes":
      - "90"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 231f9126-614c-4a72-809a-689137b71003
      iscommand: false
      name: Triggered From Email ?
      type: condition
      version: -1
    taskid: 231f9126-614c-4a72-809a-689137b71003
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 260,
          "y": -560
        }
      }
  "90":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: email
      label: Email
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      Email:
      - "92"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea398aae-a30c-4e72-89ec-a02627953ab9
      iscommand: false
      name: Does the subject line include 'Email'?
      type: condition
      version: -1
    taskid: ea398aae-a30c-4e72-89ec-a02627953ab9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 260,
          "y": -370
        }
      }
  "91":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
          operator: isEqualString
          right:
            value:
              simple: EWS v2
      label: "yes"
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "98"
      "yes":
      - "95"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 645eff67-1798-458d-86f3-b0ce9f2a15f1
      iscommand: false
      name: Triggered From Email ?
      type: condition
      version: -1
    taskid: 645eff67-1798-458d-86f3-b0ce9f2a15f1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 700,
          "y": 470
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: emailblock
      type:
        simple: Domain
      value:
        simple: ${BELOWSIXFIVE.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 80e83d75-d078-4bf9-8e27-28aabe3d9403
      iscommand: true
      name: Tag 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 80e83d75-d078-4bf9-8e27-28aabe3d9403
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 480
        }
      }
  "93":
    continueonerrortype: ""
    id: "93"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: CSOCBlockDomain,emailblock
      type:
        simple: Domain
      value:
        simple: ${BELOWSIXFIVE.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: a88e0cfc-2bd8-4b9e-8a19-7b6d39c5c207
      iscommand: true
      name: Tag 'CSOC' and 'emailblock' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: a88e0cfc-2bd8-4b9e-8a19-7b6d39c5c207
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 710,
          "y": 900
        }
      }
  "94":
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      reputation:
        simple: Bad
      source:
        simple: ${incident.id}
      tags:
        simple: CSOCBlockDomain
      type:
        simple: Domain
      value:
        simple: ${BELOWSIXFIVE.Domain}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an indicator
      id: 911f7a48-2b7a-4d15-8f1b-6ae1668922b6
      iscommand: true
      name: Tag 'CSOC' Bad Domain Indicator
      script: Builtin|||createNewIndicator
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: 911f7a48-2b7a-4d15-8f1b-6ae1668922b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 910
        }
      }
  "95":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Email/subject
                root: incident.labels
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: internet
      label: Internet
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "93"
      Internet:
      - "94"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea7c4b57-e6ca-4e10-81ef-d37e0df096ac
      iscommand: false
      name: Does the subject line include 'Internet'?
      type: condition
      version: -1
    taskid: ea7c4b57-e6ca-4e10-81ef-d37e0df096ac
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1150,
          "y": 670
        }
      }
  "96":
    continueonerrortype: ""
    id: "96"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      alert_time:
        complex:
          accessor: created
          root: incident
          transformers:
          - operator: 8726aa62-638b-41b0-8fd7-8d8892145289
          - args:
              delimiter:
                value:
                  simple: .
              fields:
                value:
                  simple: "1"
            operator: Cut
          - args:
              prefix: {}
              suffix:
                value:
                  simple: .0Z
            operator: concat
      destination_domain:
        complex:
          accessor: Domain
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      destination_url:
        simple: http://abc.com
      device_id:
        simple: abcdefghij
      device_version:
        simple: "1.0"
      retry-count:
        simple: "3"
      using:
        simple: Cisco Umbrella Enforcement Block Domain_instance,Cisco Umbrella Enforcement
          Block Domain GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cisco Umbrella Enforcement Block Domain
      description: Posts a malware event to the API for processing and optionally
        adding to a customer's domain lists.
      id: 86b220e2-4f98-4827-89a9-6f67fcd4dade
      iscommand: true
      name: Block Domain on Cisco Umbrella (opendns)
      script: Cisco Umbrella Enforcement Block Domain|||umbrella-domain-event-add
      type: regular
      version: -1
    taskid: 86b220e2-4f98-4827-89a9-6f67fcd4dade
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 700,
          "y": 285
        }
      }
  "97":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: email only
      label: Email Only
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      Email Only:
      - "92"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9d0bf671-8c4a-4aaa-8582-aca7a9d486be
      iscommand: false
      name: ' ''Block IOC On'' Email?'
      type: condition
      version: -1
    taskid: 9d0bf671-8c4a-4aaa-8582-aca7a9d486be
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 680,
          "y": -380
        }
      }
  "98":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: blockiocon
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: internet only
      label: Internet Only
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "93"
      Internet Only:
      - "94"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8aa996fa-8bc6-49e4-8075-c58b8bf60712
      iscommand: false
      name: ' ''Block IOC On'' Internet?'
      type: condition
      version: -1
    taskid: 8aa996fa-8bc6-49e4-8075-c58b8bf60712
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 710,
          "y": 660
        }
      }
  "99":
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "96"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: Domain
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 7e604762-ed62-4aa1-8c1f-b079e2ae7a3e
      iscommand: true
      name: Blacklist Domain on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 7e604762-ed62-4aa1-8c1f-b079e2ae7a3e
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 120
        }
      }
  "100":
    continueonerrortype: ""
    id: "100"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_09
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: URL
          root: BELOWSIXFIVE
          transformers:
          - args:
              from:
                value:
                  simple: //
            operator: substringFrom
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: splitAndTrim
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds URLs to the specified category.
      id: 88299b4f-d19e-422e-8c73-fc8bbc4ed09e
      iscommand: true
      name: Blacklist CSOC Shared URL on ZScalar Proxy - GNDM
      script: Zscaler|||zscaler-category-add-url
      type: regular
      version: -1
    taskid: 88299b4f-d19e-422e-8c73-fc8bbc4ed09e
    timertriggers:
    - action: stop
      fieldname: blockioctimer
    type: regular
    view: |-
      {
        "position": {
          "x": 1560,
          "y": -120
        }
      }
  "104":
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "105"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_132
      ip:
        complex:
          accessor: IP
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "3"
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: a3a8bbad-a640-4571-837b-4198b24cbb34
      iscommand: true
      name: 'Block IP on Zscaler Corporate '
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: a3a8bbad-a640-4571-837b-4198b24cbb34
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": -110
        }
      }
  "105":
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_241
      ip:
        complex:
          accessor: IP
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "3"
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: adba16d5-a756-42ec-8037-c28cfa8cb6dc
      iscommand: true
      name: Block IP on Zscaler BPS
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: adba16d5-a756-42ec-8037-c28cfa8cb6dc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": 55
        }
      }
  "106":
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      category-id:
        simple: CUSTOM_57
      ip:
        complex:
          accessor: IP
          root: BELOWSIXFIVE
          transformers:
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: ' '
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter:
                value:
                  simple: ' '
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      retry-count:
        simple: "3"
      using:
        simple: Zscaler_instance_GNDM
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Adds IP address to the specified category.
      id: 7321684e-41cd-4bd4-869f-c4b4d7e21e77
      iscommand: true
      name: Block IP on Zscaler GNDM
      script: Zscaler|||zscaler-category-add-ip
      type: regular
      version: -1
    taskid: 7321684e-41cd-4bd4-869f-c4b4d7e21e77
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": 225
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "69_79_#default#": 0.14,
      "70_79_#default#": 0.1,
      "71_79_#default#": 0.1,
      "72_79_#default#": 0.17,
      "89_90_yes": 0.49,
      "90_92_Email": 0.51,
      "91_98_#default#": 0.52,
      "95_94_Internet": 0.46,
      "97_39_#default#": 0.57,
      "97_92_Email Only": 0.13,
      "98_93_#default#": 0.49
    },
    "paper": {
      "dimensions": {
        "height": 3655,
        "width": 2620,
        "x": -250,
        "y": -2130
      }
    }
  }
