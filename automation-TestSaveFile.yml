commonfields:
  id: 291df935-030b-4d8a-8657-ae844d01f818
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
enabled: true
engineinfo: {}
mainengineinfo: {}
name: TestSaveFile
pswd: ""
runas: DBotWeakRole
runonce: false
script: |-
  // Javascript template - reading arguments, calling a command, handling errors and returning results

  var res= {"Body":[{ "one": 1, "two": 2, "three": 3 }]};

  //return JSON.stringify(res.Body)
  return {Type: 3, FileID: saveFile(JSON.stringify(res.Body)), File: 'Test.pcap',  Contents: 'we must have contents for an entry'};
  /*
  if (!res || !res.Body) {
      return 'No data was found in Moloch';
      }
  else{
      return {Type: 9, FileID: saveFile((res.Body).toString()), File: 'Test.csv',  Contents: 'we must have contents for an entry'};
      }
  */
scripttarget: 0
tags: []
type: javascript
