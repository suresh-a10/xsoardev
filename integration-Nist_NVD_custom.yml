category: Vulnerability Management
commonfields:
  id: Nist NVD_custom
  version: -1
configuration:
- defaultvalue: https://services.nvd.nist.gov
  display: Nist NVD CVES URL
  name: url
  required: false
  type: 0
- defaultvalue: "false"
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: "false"
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: National Vulnerability Database
detaileddescription: |-
  ### Community Contributed Integration
   #### Integration Author: Murat Ozfidan
   No support or maintenance is provided by the author. Customers are encouraged to engage with the user community for questions and guidance at the [Cortex XSOAR Live Discussions](https://live.paloaltonetworks.com/t5/cortex-xsoar-discussions/bd-p/Cortex_XSOAR_Discussions).
  ***
  The National Vulnerability Database (NVD), https://nvd.nist.gov, allows government agencies, software
  vendors, and researchers to search and view information about vulnerabilities and vulnerable products. In
  the Fall of 2019, NVD began offering web services to allow computer applications to better access the
  NVD data.

  ---
  [View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/nist-nvd)
display: Nist NVD_custom
image: data:image/png;base64,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
name: Nist NVD_custom
script:
  commands:
  - arguments:
    - default: true
      defaultValue: "12"
      description: 'Get vulnerability last time that given parameter Example: time=24'
      name: time
      required: true
    - defaultValue: "20"
      description: 'Default: 20'
      name: resultsPerPage
    - defaultValue: "0"
      description: 'Using for paging. Default: 0'
      name: startIndex
    description: You can get latest vulnerabilities with given time from National
      Vulnerability Database.
    name: nvd-get-vulnerability
  - arguments:
    - default: true
      description: 'Example: keyword=apple'
      name: keyword
      required: true
    - auto: PREDEFINED
      defaultValue: "true"
      description: If the keyword is a phrase, i.e., contains more than one term,
        then the isExactMatch parameter may be used to influence the response. Use
        isExactMatch=true to retrieve records matching the exact phrase. Otherwise,
        the results contain any record having any of the terms.
      name: isExactMatch
      predefined:
      - "true"
      - "false"
      required: true
    - defaultValue: "24"
      description: 'Get vulnerability last time that given parameter Example: time=24'
      name: time
    - defaultValue: "20"
      description: 'Default: 20'
      name: resultsPerPage
    - defaultValue: "0"
      description: 'Using for paging. Default: 0'
      name: startIndex
    description: The keyword parameter allows your application to retrieve records
      where a word or phrase is found in the vulnerability description or reference
      links.
    name: nvd-search-keyword
  - arguments:
    - auto: PREDEFINED
      default: true
      defaultValue: cvssV3
      description: cvssV3 or cvssV2
      name: cvssType
      predefined:
      - cvssV3
      - cvssV2
      required: true
    - auto: PREDEFINED
      defaultValue: Severity
      description: 'Search parameter that use with CVSS. Example: cvssV2Severity |
        cvssV3Metrics'
      name: key
      predefined:
      - Severity
      - Metrics
      required: true
    - description: 'Two pairs of parameters allow you to filter vulnerabilities based
        on CVSS base scores. Use either the cvssV2Severity or cvssV3Severity parameter
        to find vulnerabilities having a LOW, MEDIUM, or HIGH version 2 or 3.x score,
        respectively. For CVSS V3.x, cvssV3Severity=CRITICAL is also supported. Example:
        cvssV2Severity=HIGH | cvssV3Metrics=C:H/A:N | cvssV3Metrics=AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N'
      name: value
      required: true
    - defaultValue: "24"
      description: 'Get vulnerability last time that given parameter Example: time=24'
      name: time
    - defaultValue: "20"
      description: 'Default: 20'
      name: resultsPerPage
    - defaultValue: "0"
      description: 'Using for paging. Default: 0'
      name: startIndex
    description: CVSS refers to the scoring system used by NIST to assess the severity
      of vulnerabilities, https://www.first.org/cvss/. NVD provides base scores using
      the CVSS version 2 and, more recently, version 3.x.
    name: nvd-search-cvss
  - arguments:
    - default: true
      description: 'Example: cweId=CWE-20'
      name: cweId
      required: true
    - defaultValue: "24"
      description: 'Get vulnerability last time that given parameter Example: time=24'
      name: time
    - defaultValue: "20"
      description: 'Default: 20'
      name: resultsPerPage
    - defaultValue: "0"
      description: 'Using for paging. Default: 0'
      name: startIndex
    description: 'CWE refers to the classification of vulnerabilities at https://cwe.mitre.org/.
      NIST staff associate one or more CWE to each vulnerability during the analysis
      process. In the following example, CWE-20 means vulnerabilities caused by Improper
      Input Validation. To filter search results based on CWE, use the cweId parameter.
      Example: cweId=CWE-20'
    name: nvd-search-cwe
  - arguments:
    - description: 'Example: cpe:2.3:o:microsoft:windows_10 | cpe:2.3:o:microsoft:windows_10:1511
        | cpe:2.3:*:microsoft'
      name: cpe
      required: true
    - defaultValue: "24"
      description: 'Get vulnerability last time that given parameter Example: time=24'
      name: time
    - defaultValue: "20"
      description: 'Default: 20'
      name: resultsPerPage
    - defaultValue: "0"
      description: 'Using for paging. Default: 0'
      name: startIndex
    description: NVD analysts identify which product or products are affected by each
      vulnerability. The set of associated products is known as the applicability
      statement of the CVE. NVD uses the Common Platform Enumeration (CPE), version
      2.3, to convey product vendors, names, versions, etc. For more information,
      see https://cpe.mitre.org/.
    name: nvd-search-cpe
  - arguments:
    - description: 'CVEID. Example: CVE-2020-1000'
      name: cve
      required: true
    description: Search specific CVE
    name: nvd-search-cve
  dockerimage: demisto/python3:3.10.12.66339
  runonce: false
  script: |
    register_module_line('Nist NVD', 'start', __line__())
    ### pack version: 1.0.5


    import sys
    from datetime import datetime, timedelta

    import requests


    ''' CONSTANTS '''
    DATE_FORMAT = "%Y-%m-%dT%H:%M:%SZ"

    VERIFY_SSL = not demisto.params().get('insecure', False)

    if not demisto.params().get('proxy', False):
        handle_proxy()


    def test_module() -> str:
        try:
            base_url = urljoin(demisto.params()['url'], '/rest/json/cves/1.0')
            headers = {'Accept': 'application/json'}
            req = requests.get(base_url, headers=headers, verify=VERIFY_SSL)
            if req.status_code != 200:
                http_status = 'HTTP status is' + str(req.status_code)
                return_error(http_status)
        except Exception as e:
            return_error(e)
        return 'ok'


    def connection(url, additional_parameters):

        headers = {'Accept': 'application/json'}
        endpoint = url + additional_parameters
        req = requests.get(endpoint, headers=headers, verify=VERIFY_SSL)
        print(req.json())
        if req.status_code != 200:
            return_results(req.content)
            sys.exit(1)
        else:
            return req.json()


    # Process of extraction vulnerability details in the NVD
    def extractVulnDetails(requestfromconnection):
        req = requestfromconnection
        pretty_list = []  # list()
        if (not ('vulns') in req):
            for i in req['result']['CVE_Items']:
                pretty_dict = {}
                pretty_dict['CVE ID'] = i['cve']['CVE_data_meta']['ID']
                pretty_dict['Published Date'] = i['publishedDate']
                pretty_dict['Last Modified Date'] = i['lastModifiedDate']
                for k in i['cve']['description']['description_data']:
                    pretty_dict['Description'] = k['value']
                reference_data = []
                for j in i['cve']['references']['reference_data']:
                    reference_data.append(j['url'])
                pretty_dict['References'] = reference_data
                if (('impact') in i and ('baseMetricV3') in i['impact']):
                    pretty_dict['CVSSv3 Base Score'] = i['impact']['baseMetricV3']['cvssV3']['baseScore']
                    pretty_dict['CVSSv3 Base Severity'] = i['impact']['baseMetricV3']['cvssV3']['baseSeverity']
                    pretty_dict['Exploitability Score'] = i['impact']['baseMetricV3']['exploitabilityScore']
                    pretty_dict['Impact Score'] = i['impact']['baseMetricV3']['impactScore']
                    pretty_dict['CVSSv3 Version'] = i['impact']['baseMetricV3']['cvssV3']['version']
                    pretty_dict['CVSSv3 Vector String'] = i['impact']['baseMetricV3']['cvssV3']['vectorString']
                    pretty_dict['CVSSv3 Attack Vector'] = i['impact']['baseMetricV3']['cvssV3']['attackVector']
                    pretty_dict['CVSSv3 Attack Complexity'] = i['impact']['baseMetricV3']['cvssV3']['attackComplexity']
                    pretty_dict['CVSSv3 Privileges Required'] = i['impact']['baseMetricV3']['cvssV3']['privilegesRequired']
                    pretty_dict['CVSSv3 User Interaction'] = i['impact']['baseMetricV3']['cvssV3']['userInteraction']
                    pretty_dict['CVSSv3 Scope'] = i['impact']['baseMetricV3']['cvssV3']['scope']
                    pretty_dict['CVSSv3 Confidentiality Impact'] = i['impact']['baseMetricV3']['cvssV3']['confidentialityImpact']
                    pretty_dict['CVSSv3 Integrity Impact'] = i['impact']['baseMetricV3']['cvssV3']['integrityImpact']
                    pretty_dict['CVSSv3 Availability Impact'] = i['impact']['baseMetricV3']['cvssV3']['availabilityImpact']
                """if (('configurations') in i):
                    cpe23UriString = ''
                    for l in i['configurations']['nodes']:
                        if(('children') in l):
                            for m in l['children']:
                                cpe23Uri = []
                                for n in m['cpe_match']:
                                    cpe23Uri += n['cpe23Uri']+ '\n' #+ n['vulnerable']
                                    #pretty_dict['vulnerable'] = n['vulnerable']
                                    #pretty_dict['cpe23Uri'] = n['cpe23Uri']
                            pretty_dict['configurations'] = cpe23UriString
                        elif(('cpe_match') in l):
                            for m in l['cpe_match']:
                                cpe23UriString += m['cpe23Uri'] + '\n' #+ m['vulnerable']
                                #pretty_dict['vulnerable'] = m['vulnerable']
                                #pretty_dict['cpe23Uri'] = m['cpe23Uri']
                            pretty_dict['configurations'] = cpe23UriString"""
                pretty_list.append(pretty_dict)
        elif ('vulns') in req:
            if (not len(req['vulns'])):
                demisto.results("Vendor name may be wrong or no CPE added")

        if (('result') in req):
            if (not len(req['result']['CVE_Items'])):
                demisto.results("There were no vulnerability in the criteria you were looking for.")
        return pretty_list


    def generalSearch():

        base_url = urljoin(demisto.params()['url'], '/rest/json/cves/1.0')
        time = int(demisto.args().get('time'))
        last_time = datetime.today() - timedelta(hours=int(time))
        start_date = last_time.strftime('%Y-%m-%dT%H:%M:%S:000')
        startIndex = demisto.args().get('startIndex')
        resultsPerPage = demisto.args().get('resultsPerPage')
        additional_parameters = '?modStartDate=' + start_date + ' UTC-00:00' + \
            '&startIndex=' + str(startIndex) + '&resultsPerPage=' + str(resultsPerPage)
        generalSearchRequest = connection(base_url, additional_parameters)
        print(generalSearchRequest.json())
        demisto.results(generalSearchRequest)
        generalVulnerabilityList = extractVulnDetails(generalSearchRequest)



        headers = ['CVE ID', 'Description', 'Published Date', 'Last Modified Date', 'References']
        markdown = 'General Search\n'
        markdown += tableToMarkdown('Vulnerabilities', generalVulnerabilityList, headers=headers, removeNull=True)

        results = CommandResults(
            readable_output=markdown,
            outputs_prefix='NistNVD.GeneralSearch',
            outputs_key_field='CVE ID',
            outputs=generalVulnerabilityList
        )

        return_results(results)


    def keywordSearch():

        base_url = urljoin(demisto.params()['url'], '/rest/json/cves/1.0')
        keyword = demisto.args().get('keyword')
        isExactMatch = demisto.args().get('isExactMatch')
        time = int(demisto.args().get('time'))
        last_time = datetime.today() - timedelta(hours=int(time))
        start_date = last_time.strftime('%Y-%m-%dT%H:%M:%S:000')
        startIndex = demisto.args().get('startIndex')
        resultsPerPage = demisto.args().get('resultsPerPage')
        additional_parameters = '?modStartDate=' + start_date + ' UTC-00:00' + '&keyword=' + keyword + \
            '&isExactMatch=' + isExactMatch + '&startIndex=' + str(startIndex) + '&resultsPerPage=' + str(resultsPerPage)
        generalSearchRequest = connection(base_url, additional_parameters)
        generalVulnerabilityList = extractVulnDetails(generalSearchRequest)

        headers = ['CVE ID', 'Description', 'Published Date', 'Last Modified Date', 'References']
        markdown = 'Keyword Search\n'
        markdown += tableToMarkdown('Vulnerabilities', generalVulnerabilityList, headers=headers, removeNull=True)

        results = CommandResults(
            readable_output=markdown,
            outputs_prefix='NistNVD.KeywordSearch',
            outputs_key_field='CVE ID',
            outputs=generalVulnerabilityList
        )

        return_results(results)


    def cvssSearch():

        base_url = urljoin(demisto.params()['url'], '/rest/json/cves/1.0')
        time = int(demisto.args().get('time'))
        last_time = datetime.today() - timedelta(hours=int(time))
        start_date = last_time.strftime('%Y-%m-%dT%H:%M:%S:000')

        cvssType = demisto.args().get('cvssType')
        key = demisto.args().get('key')
        searchParameters = cvssType + key
        value = demisto.args().get('value')

        startIndex = demisto.args().get('startIndex')
        resultsPerPage = demisto.args().get('resultsPerPage')

        additional_parameters = '?modStartDate=' + start_date + ' UTC-00:00' + '&' + searchParameters + \
            '=' + value + '&startIndex=' + str(startIndex) + '&resultsPerPage=' + str(resultsPerPage)
        generalSearchRequest = connection(base_url, additional_parameters)
        generalVulnerabilityList = extractVulnDetails(generalSearchRequest)

        headers = ['CVE ID', 'Description', 'Published Date', 'Last Modified Date', 'References']
        markdown = 'CVSS Search\n'
        markdown += tableToMarkdown('Vulnerabilities', generalVulnerabilityList, headers=headers, removeNull=True)

        results = CommandResults(
            readable_output=markdown,
            outputs_prefix='NistNVD.CVSSSearch',
            outputs_key_field='CVE ID',
            outputs=generalVulnerabilityList
        )

        return_results(results)


    def cweSearch():

        base_url = urljoin(demisto.params()['url'], '/rest/json/cves/1.0')
        time = int(demisto.args().get('time'))
        last_time = datetime.today() - timedelta(hours=int(time))
        start_date = last_time.strftime('%Y-%m-%dT%H:%M:%S:000')

        cweId = demisto.args().get('cweId')
        startIndex = demisto.args().get('startIndex')
        resultsPerPage = demisto.args().get('resultsPerPage')

        additional_parameters = '?modStartDate=' + start_date + ' UTC-00:00' + '&cweId=' + \
            cweId + '&startIndex=' + str(startIndex) + '&resultsPerPage=' + str(resultsPerPage)
        generalSearchRequest = connection(base_url, additional_parameters)
        generalVulnerabilityList = extractVulnDetails(generalSearchRequest)

        headers = ['CVE ID', 'Description', 'Published Date', 'Last Modified Date', 'References']
        markdown = 'CWE Search\n'
        markdown += tableToMarkdown('Vulnerabilities', generalVulnerabilityList, headers=headers, removeNull=True)

        results = CommandResults(
            readable_output=markdown,
            outputs_prefix='NistNVD.CWESearch',
            outputs_key_field='CVE ID',
            outputs=generalVulnerabilityList
        )

        return_results(results)


    def cpeSearch():

        base_url = urljoin(demisto.params()['url'], '/rest/json/cves/1.0')
        time = int(demisto.args().get('time'))
        last_time = datetime.today() - timedelta(hours=int(time))
        start_date = last_time.strftime('%Y-%m-%dT%H:%M:%S:000')

        cpeMatchString = demisto.args().get('cpe')
        startIndex = demisto.args().get('startIndex')
        resultsPerPage = demisto.args().get('resultsPerPage')

        additional_parameters = '?modStartDate=' + start_date + ' UTC-00:00' + '&cpeMatchString=' + \
            cpeMatchString + '&startIndex=' + str(startIndex) + '&resultsPerPage=' + str(resultsPerPage)
        generalSearchRequest = connection(base_url, additional_parameters)
        generalVulnerabilityList = extractVulnDetails(generalSearchRequest)

        headers = ['CVE ID', 'Description', 'Published Date', 'Last Modified Date', 'References']
        markdown = 'CPE Search\n'
        markdown += tableToMarkdown('Vulnerabilities', generalVulnerabilityList, headers=headers, removeNull=True)

        results = CommandResults(
            readable_output=markdown,
            outputs_prefix='NistNVD.CPESearch',
            outputs_key_field='CVE ID',
            outputs=generalVulnerabilityList
        )

        return_results(results)


    def cveSearch():

        base_url = urljoin(demisto.params()['url'], '/rest/json/cve/1.0/')
        cve = demisto.args().get('cve')

        additional_parameters = cve
        generalSearchRequest = connection(base_url, additional_parameters)
        demisto.results(generalSearchRequest)
        generalVulnerabilityList = extractVulnDetails(generalSearchRequest)
        headers = ['CVE ID', 'Description', 'Published Date', 'Last Modified Date',
                   'References', 'CVSSv3 Base Score', 'CVSSv3 Base Severity',
                   'Exploitability Score', 'Impact Score', 'CVSSv3 Version',
                   'CVSSv3 Vector String', 'CVSSv3 Attack Vector', 'CVSSv3 Attack Complexity',
                   'CVSSv3 Privileges Required', 'CVSSv3 User Interaction', 'CVSSv3 Scope',
                   'CVSSv3 Confidentiality Impact', 'CVSSv3 Integrity Impact', 'CVSSv3 Availability Impact']
        markdown = 'CVE Search\n'
        markdown += tableToMarkdown('Vulnerabilities', generalVulnerabilityList, headers=headers, removeNull=True)

        results = CommandResults(
            readable_output=markdown,
            outputs_prefix='NistNVD.CVESearch',
            outputs_key_field='CVE ID',
            outputs=generalVulnerabilityList
        )

        return_results(results)


    def main() -> None:
        """main function, parses params and runs command functions
        :return:
        :rtype:
        """
        ''' EXECUTION '''
        demisto.debug(f'Command being called is {demisto.command()}')

        ''' EXECUTION '''
        LOG('command is %s' % (demisto.command(), ))
        #try:
        if demisto.command() == 'test-module':
            demisto.results(test_module())
        elif demisto.command() == 'nvd-get-vulnerability':
            generalSearch()
        elif demisto.command() == 'nvd-search-keyword':
            keywordSearch()
        elif demisto.command() == 'nvd-search-cvss':
            cvssSearch()
        elif demisto.command() == 'nvd-search-cwe':
            cweSearch()
        elif demisto.command() == 'nvd-search-cpe':
            cpeSearch()
        elif demisto.command() == 'nvd-search-cve':
            cveSearch()
        # Log exceptions and return errors
        #except Exception as e:
            #demisto.error(traceback.format_exc())  # print the traceback
            #return_error(f'Failed to execute {demisto.command()} command.\nError:\n{str(e)}')


    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()

    register_module_line('Nist NVD', 'end', __line__())
  subtype: python3
  type: python
sourcemoduleid: Nist NVD
