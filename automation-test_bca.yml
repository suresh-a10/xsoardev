commonfields:
  id: 33f5ab27-290f-4b6d-804f-112a1e41daf3
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.10.5.31928
enabled: true
engineinfo: {}
mainengineinfo: {}
name: test_bca
pswd: ""
runas: DBotWeakRole
runonce: false
script: |-
  res = demisto.context()

  final_json = []
  for item in res['result']:
      temp = item.pop('_source')
      hostip = temp['host'].pop('ip')
      hostip = ','.join(hostip)
      hostname = temp['host'].pop('name')
      process_executable = temp['process'].pop('executable')
      username = temp['user'].pop('name')
      item.update( [('hostip', hostip),('hostname',hostname), ('process_executable',process_executable), ('username',username)])
      item.pop('sort')
      final_json.append(item)
  demisto.setContext("finalResult", final_json)
scripttarget: 0
subtype: python3
tags: []
type: python
