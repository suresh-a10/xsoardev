contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 4cd50b8a-b517-4a30-81d7-f9bb8dcfb103
inputs: []
name: TCS-Unblock IOC-Email Trigger v2.4_sweta1
outputs: []
sourceplaybookid: 0a608f75-4154-430b-81e0-3a7bc08ad2e0
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 11e0fde4-d01e-424a-86f7-dc91866b2b2e
      iscommand: false
      name: ""
      version: -1
    taskid: 11e0fde4-d01e-424a-86f7-dc91866b2b2e
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 510,
          "y": -1180
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 236ef0a6-6782-4ed4-8a42-7fcb1cd5c172
      iscommand: false
      name: Report & Notify
      type: title
      version: -1
    taskid: 236ef0a6-6782-4ed4-8a42-7fcb1cd5c172
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1430
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hello Human,

          I've unblocked/removed the IOCs in this list  - ${incident.attachment.name}

          XSOAR Investigation id - ${incident.id}


          Regards,
          Cyber AutoBot
      subject:
        simple: IOC Blacklisting/Blocking Completed For List - ${incident.attachment.name}
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 8134dc1a-f96c-46b5-8fc8-638405641c0d
      iscommand: true
      name: Notify IOC Unblocking Done
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 8134dc1a-f96c-46b5-8fc8-638405641c0d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1620
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a2ec9c69-e826-4bec-8037-b3c2b792e723
      iscommand: false
      name: Close Incident
      type: title
      version: -1
    taskid: a2ec9c69-e826-4bec-8037-b3c2b792e723
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1830
        }
      }
  "7":
    continueonerror: true
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      category-id:
        simple: CUSTOM_134
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: Domain_Test_}
          root: ${ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes URLs from the specified category.
      id: 8e3f172e-e1c6-4334-8dde-bbe326dd65a9
      iscommand: true
      name: Unblock Domain on ZScalar Proxy
      script: Zscaler|||zscaler-category-remove-url
      type: regular
      version: -1
    taskid: 8e3f172e-e1c6-4334-8dde-bbe326dd65a9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 680,
          "y": 630
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 81bd1867-1d42-4274-8e13-be3e886c5777
      iscommand: true
      name: Close Incident
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 81bd1867-1d42-4274-8e13-be3e886c5777
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1980
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d323aec9-1274-4b96-8987-3005538ad98f
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: d323aec9-1274-4b96-8987-3005538ad98f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 2190
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID}
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ${File.Info}
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: ${File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 9c4a375c-4b0d-496e-85c6-738a185161ba
      iscommand: true
      name: Extract Indicators From Text File
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 9c4a375c-4b0d-496e-85c6-738a185161ba
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": -1040
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: fb3dff24-a4ac-4895-8dcb-e24e9e16a2d3
      iscommand: true
      name: Expire Domain Indicator
      script: Builtin|||expireIndicators
      tags:
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: fb3dff24-a4ac-4895-8dcb-e24e9e16a2d3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1100
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        simple: ${ExtractedIndicators.IP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.server.cmd.expireIndicators
      id: b9f2ea3a-be23-45e8-870d-ff56751d08c2
      iscommand: true
      name: Expire IP Indicator
      script: Builtin|||expireIndicators
      tags:
      - CERTDomainBlock
      - ProxyBlockDomain
      type: regular
      version: -1
    taskid: b9f2ea3a-be23-45e8-870d-ff56751d08c2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 1110
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
      - "46"
      - "44"
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 38710a8d-66ee-4901-8a59-a77a44d510e7
      iscommand: false
      name: Both IP and Domain are Present
      type: title
      version: -1
    taskid: 38710a8d-66ee-4901-8a59-a77a44d510e7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 250
        }
      }
  "43":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_}
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.IP}
          operator: isExists
      label: Both
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.IP}
          operator: isExists
      label: IP
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ExtractedIndicators.Domain_Test_}
          operator: isExists
      label: Domain
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Both:
      - "42"
      Domain:
      - "7"
      - "44"
      IP:
      - "45"
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d51dad5f-454f-4401-8b30-5c12581db155
      iscommand: false
      name: what is there in output of compare list?
      type: condition
      version: -1
    taskid: d51dad5f-454f-4401-8b30-5c12581db155
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": -60
        }
      }
  "44":
    continueonerror: true
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      url:
        complex:
          accessor: Domain_Test_}
          root: ${ExtractedIndicators
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
            operator: replace
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes the specified URLs from the blacklist.
      id: d65065e5-a0b8-42ea-8154-eac3341a20ed
      iscommand: true
      name: Unblock Domain on ZScalar BPS Proxy
      script: Zscaler|||zscaler-undo-blacklist-url
      type: regular
      version: -1
    taskid: d65065e5-a0b8-42ea-8154-eac3341a20ed
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": 630
        }
      }
  "45":
    continueonerror: true
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      ip:
        simple: ${ExtractedIndicators.IP}
      retry-count:
        simple: "3"
      using:
        simple: Zscaler_instance_BPS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes the specified IP addresses from the blacklist.
      id: 746f7692-7c48-4f98-8f7b-86f96d10ea79
      iscommand: true
      name: Unblock IP on ZScalar BPS Proxy
      script: Zscaler|||zscaler-undo-blacklist-ip
      type: regular
      version: -1
    taskid: 746f7692-7c48-4f98-8f7b-86f96d10ea79
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -150,
          "y": 630
        }
      }
  "46":
    continueonerror: true
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      ip:
        complex:
          accessor: IP}
          root: ${ExtractedIndicators
      retry-count:
        simple: "3"
      using:
        simple: Zscaler_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler
      description: Removes the specified IP addresses from the blacklist.
      id: 60a81fb9-4264-4d6c-821e-d40b31ffe1f1
      iscommand: true
      name: Unblock IP on ZScalar Proxy
      script: Zscaler|||zscaler-undo-blacklist-ip
      type: regular
      version: -1
    taskid: 60a81fb9-4264-4d6c-821e-d40b31ffe1f1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 290,
          "y": 630
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: indicator.ip
      value:
        complex:
          accessor: Domain_Test}
          root: ${ExtractedIndicators.IP},${ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d3f55334-36fc-4b91-8ba0-ff4e448491aa
      iscommand: false
      name: Set Tagged Indictor In Context
      script: Set
      type: regular
      version: -1
    taskid: d3f55334-36fc-4b91-8ba0-ff4e448491aa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": -740
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "43200"
      extend-context:
        simple: indicator.ip=value
      ignore-outputs:
        simple: "true"
      query:
        simple: '(tags:rfblockeddomain) or (tags:rfblockedURL) or (tags:rftyposquat)
          or (tags:blockedipaddress ) or (tags:QradarSuspiciousIP) or (type:IP and
          tags:rfipblocked80) '
      retry-count:
        simple: "3"
      size:
        simple: "100000"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 31a1254f-1dc8-41ba-8d2b-d9fb703f696b
      iscommand: true
      name: Fetch Indicators With Tags
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 31a1254f-1dc8-41ba-8d2b-d9fb703f696b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": -900
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${TaggedIndicator}
      right:
        simple: ${ExtractedIndicators}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: 1d961891-7784-4c2f-8b68-09eda3b535a3
      iscommand: false
      name: Compare Context 'Extracted Indicator' and 'Indicator.Ip'
      script: CompareLists
      type: regular
      version: -1
    taskid: 1d961891-7784-4c2f-8b68-09eda3b535a3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": -580
        }
      }
  "52":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${ListCompare.LeftOnly}
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 86219c31-675b-4020-86a5-d9f7b22cefea
      iscommand: false
      name: |
        check for tagged IOC from the Extracted List
      type: condition
      version: -1
    taskid: 86219c31-675b-4020-86a5-d9f7b22cefea
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 500,
          "y": -410
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${ListCompare.LeftOnly}
      listName:
        simple: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: add6d59f-ceee-4b9b-8f24-cb46354d9fea
      iscommand: true
      name: add IOC to Extracted List
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: add6d59f-ceee-4b9b-8f24-cb46354d9fea
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": -240
        }
      }
  "55":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ListCompare.RightOnly
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f426821e-42ee-4170-8d93-00aa34673f47
      iscommand: false
      name: Get the Compare list which were not not blocked by CSOC
      type: condition
      version: -1
    taskid: f426821e-42ee-4170-8d93-00aa34673f47
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 0,
          "y": -250
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        simple: ${ListCompare.RightOnly}
      listName:
        simple: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.add
      id: 1c31866d-a4b8-4d8e-89c6-e51ec7f8b540
      iscommand: true
      name: add IOC to Extracted List not blocked by CSOC
      script: Builtin|||addToList
      type: regular
      version: -1
    taskid: 1c31866d-a4b8-4d8e-89c6-e51ec7f8b540
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -10,
          "y": -80
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      attachNames:
        simple: ${ExtractorIndicators}
      body:
        simple: |-
          Hello Human,

          I've unblocked/removed the IOCs in this list  - ${incident.attachment.name}

          XSOAR Investigation id - ${incident.id}


          Regards,
          Cyber AutoBot
      subject:
        simple: IOC Blacklisting/Blocking Completed For List - ${incident.attachment.name}
      to:
        complex:
          accessor: Email/from
          root: incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 9288bb4e-308f-4de5-833c-92919a36e3df
      iscommand: true
      name: Notify  Shared IOC are not blocked by CSOC
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 9288bb4e-308f-4de5-833c-92919a36e3df
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -460,
          "y": 460
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3435,
        "width": 1930,
        "x": -460,
        "y": -1180
      }
    }
  }
