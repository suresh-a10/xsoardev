category: Utilities
commonfields:
  id: AWS - System Manager
  version: -1
configuration:
- display: AWS Default Region
  name: defaultRegion
  options:
  - us-east-1
  - us-east-2
  - us-west-1
  - us-west-2
  - ca-central-1
  - eu-west-1
  - eu-central-1
  - eu-west-2
  - ap-northeast-1
  - ap-northeast-2
  - ap-southeast-1
  - ap-southeast-2
  - ap-south-1
  - sa-east-1
  - eu-north-1
  - eu-west-3
  - us-gov-east-1
  - us-gov-west-1
  required: true
  type: 15
- display: Role Arn
  name: roleArn
  required: false
  type: 0
- display: Role Session Name
  name: roleSessionName
  required: false
  type: 0
- display: Role Session Duration
  name: sessionDuration
  required: false
  type: 0
- display: Access Key
  displaypassword: Secret Key
  name: credentials
  required: false
  type: 9
- additionalinfo: The time in seconds till a timeout exception is reached. You can
    specify just the read timeout (for example 60) or also the connect timeout followed
    after a comma (for example 60,10). If a connect timeout is not specified, a default
    of 10 seconds will be used.
  defaultvalue: 60,10
  display: Timeout
  name: timeout
  required: false
  type: 0
- additionalinfo: 'The maximum number of retry attempts when connection or throttling
    errors are encountered. Set to 0 to disable retries. The default value is 5 and
    the limit is 10. Note: Increasing the number of retries will increase the execution
    time.'
  defaultvalue: "5"
  display: Retries
  name: retries
  required: false
  type: 0
- additionalinfo: Sets the AWS_STS_REGIONAL_ENDPOINTS environment variable to specify
    the AWS STS endpoint resolution logic. By default, this option is set to “legacy”
    in AWS. Leave empty if the environment variable is already set using server configuration.
  display: AWS STS Regional Endpoints
  name: sts_regional_endpoint
  options:
  - legacy
  - regional
  required: false
  section: Connect
  type: 15
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.9.0
    itemVersion: 1.0.3
    packID: AWS_SystemManager
    packName: AWS Systems Manager
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: AWS Systems Manager is the operations hub for your AWS applications and
  resources and a secure end-to-end management solution for hybrid cloud environments
  that enables safe and secure operations at scale.
detaileddescription: "Before you can use AWS System Manager, you need to perform several
  configuration steps in your AWS environment.\n\n### Prerequisites\n- Attach an instance
  profile with the required permissions to the Cortex XSOAR server or engine that
  is running \non your AWS environment.\n- The instance profile requires the following
  minimum permission: sts:AssumeRole.\n- The instance profile requires permission
  to assume the roles needed by the AWS integrations.\n\n### Configure AWS Settings\n1.
  Create an IAM role for the instance profile.\n2. Attach a role to the instance profile.\n3.
  Configure the necessary IAM roles that the AWS integration can assume.\n\nFor detailed
  instructions, see the [AWS Integrations - Authentication](https://xsoar.pan.dev/docs/reference/articles/aws-integrations---authentication).\n\n---\n[View
  Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/aws---system-manager)"
display: AWS - System Manager
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAMAAACgee/qAAAAh1BMVEUAAADXLXDYLW7fMHDYLG3ZLG3XLW3XLGzYLG7ZLW3ZLGzXLHDZLG3YLW3YLG7YLG3aLG7YLG7ZLWzZLXDaOXXaLW/YLGzYK2zYLG3////98vb65e3dRn7iYJH42OTslbb1ytrwsMjuo7/fU4fzvdLme6PpiKzkbprbOXbwr8n65ezgU4joiKzvXfmKAAAAF3RSTlMAIN8Qv59gQIDvcEDv38+vMJBQUP6PkPW29x8AAAPjSURBVFjD7Zdpb9swDIapy4d8J+1C+Uqcq93x/3/fqFiyEwwYNifZgK1vYYlUPzygSZEOfOhDH/oXtbkWTgYiPbTQH3hFSkCpVmRVAS36FZJCKrYcjDdMyxqZF2MGM8QIRCqtlZKPRYmy4moxmJAXyBy0d0ZzCjhTOYBMBegYQ0gwqCxfLAQjaaI5By++54MTVyHxND25SitQKDQqdm+OfeDoFuuM8uAVEYknsGIYUqxcgigQ5R05/lEuwWTM4CJNkiIVIDOdQYgBBjbvOpWPAI+0yzLn3pdWzDlHDRHaeko5jqGqbDEYPeR923/ph9bSfLxzxMEFJKUt7hCgwpygKlkvr2pPxlNdf97uG7N1sbuMOzCXIz4EbmMMUZPH78ixe624ac3xxYK2RHZn7jr9RELcX9VN44y92e+OrWPTBs+Rb1oH8+aS/VKboakPlnl54DnaOJ3N1Dff3ij+waX42eCvvbnpmHsztC5m36qVVOVDwWiDNM0Jr8dFu6e3bW0PZjyP+M2djdQDIm6OLz5a30XavhlPfMekcAUTZDIhSnKKgtFJQgsDlljr98Gd6eZ+1fXnzanvsDNfresiDrFIAFQq7F2OeawKRAw15hgBz2N85TGufht8Mq3PMJ5NbfaG+sj7tt1cXadPiNkqxACkilIAAVwBQw0hCl6Apn/kxW+DDxSxI2/NHgezo/3oJgU4sYCnQkqGYYjZK7PgAKXMMSQrQQZSLshxTyG74LvN++GdGtmZPB/x1K9DlDkAq7gcwSFjDJaD8VDXOysq5P7Y1qY+7GvHdWCdrdd5BpBiYEtJ5cCLUqSvIokWg8frMwyfPw+H086cds1b35/cBfNgJhHzEqAiuI4xXoHGuFxxjD/dBfad+Vh3m+NuM/SbrunHMXE7EAhCYtMBu+sez5935/oFv1Fdb3FT72+/uXyan/NdTcNx2Hbb7nwczGE8hOdoZo7a1b15o47Smwb/CNjDqXXW2/ZsrEWac6yisXWq8JFgvMZ/McY0/nhqIIgXIsfgMeAZOU+mrutaf3AFlpfiIrAok0tNl8yWdWJXezKNDPEr49OyfoDfnHiwsiFzhQGLY8xElPIYNUiM0xBknCOuo3FkFCgXFJe3Z8eDgyKHKGMYiABKSylBZrASIIuE7LzyIyML2cJfEnjjTWCGEY9oBxFUGER4+ZqnlplLkeo1D+aRAcvAty99BsOnOLP7Kq60BzMutZSg8iLwI2MRGKc+NmsGCx7YnUBrDw6QCS4BZaTZPDIeKgz8rjEucgcWPM6UZKkqOIppZDxLQsAsRk+UA5TIrPNnxXjMYw1/Q4wJ+NB/re9bPInmRbz3awAAAABJRU5ErkJggg==
name: AWS - System Manager
script:
  commands:
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - auto: PREDEFINED
      description: |-
        Specifies the type of resource for tagging.
        Note: The ManagedInstance type for this API operation is for on-premises managed nodes.
      name: resource_type
      predefined:
      - Association
      - Automation
      - Document
      - Maintenance Window
      - Managed Instance
      - Ops Item
      - Ops Metadata
      - Patch Baseline
      - Parameter
      required: true
    - description: |-
        'The resource ID to be tagged.
         Note: The format of the id depends on the selected resource type (e.g.. MaintenanceWindow: mw-012345abcde, PatchBaseline: pb-012345abcde).'
      name: resource_id
      required: true
    - description: 'The name of the tag. Note: Don’t enter personally identifiable
        information in this field.'
      name: tag_key
      required: true
    - description: 'The value of the tag. Note: Don’t enter personally identifiable
        information in this field.'
      name: tag_value
      required: true
    description: "Adds or overwrites one tag for the specified resource.\nTags are
      metadata that you can assign to the automations, documents, managed nodes, maintenance
      windows, Parameter Store parameters, and patch baselines.\nTags enable you to
      categorize the resources in different ways, for example, by purpose, owner,
      or environment.\nEach tag consists of a key and an optional value, both of which
      you define.\nFor example, you could define a set of tags for the account’s managed
      nodes that helps you track each node’s owner and stack level, \nKey=Owner Value=SysAdmin."
    name: aws-ssm-tag-add
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - auto: PREDEFINED
      description: |-
        Specifies the type of resource for tagging.
        Note: The ManagedInstance type for this API operation is for on-premises managed nodes.
      name: resource_type
      predefined:
      - Association
      - Automation
      - Document
      - Maintenance Window
      - Managed Instance
      - Ops Item
      - Ops Metadata
      - Patch Baseline
      - Parameter
      required: true
    - description: |-
        'The ID of the resource to remove tags.
         Note: The format of the id depends on the selected resource type (e.g.. MaintenanceWindow: mw-012345abcde, PatchBaseline: pb-012345abcde).'
      name: resource_id
      required: true
    - description: The name of the tag to remove.
      name: tag_key
      required: true
    description: Removes tag keys from the specified resource.
    name: aws-ssm-tag-remove
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - auto: PREDEFINED
      description: Returns a list of tags for a specific resource type.
      name: resource_type
      predefined:
      - Association
      - Automation
      - Document
      - Maintenance Window
      - Managed Instance
      - Ops Item
      - Ops Metadata
      - Patch Baseline
      - Parameter
      required: true
    - description: |-
        'The ID of the resource to list tags.
         Note: The format of the id depends on the selected resource type (e.g.. MaintenanceWindow: mw-012345abcde, PatchBaseline: pb-012345abcde).'
      name: resource_id
      required: true
    description: Returns a list of the tags assigned to the specified resource.
    name: aws-ssm-tag-list
    outputs:
    - contextPath: AWS.SSM.Tag.ResourceId
      description: The ID of the resource to list tags.
      type: String
    - contextPath: AWS.SSM.Tag.Key
      description: The name of the tag.
      type: String
    - contextPath: AWS.SSM.Tag.Value
      description: The value of the tag.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: The maximum number of items to return for this call,. The default
        and max is 50. The call also returns a token that you can specify in a subsequent
        call to get the next set of results.
      name: limit
    - description: The token for the next set of items to return. (Received this token
        from a previous call).
      name: next_token
    - auto: PREDEFINED
      defaultValue: "false"
      description: Determines whether to include inactive instances in the query results.
        (if is true the command use a filter to get also the instance with the status
        Stopped, Terminated, ConnectionLost).
      name: include_inactive_instance
      predefined:
      - "true"
      - "false"
    description: Query inventory information. This includes the managed node status,
      such as Stopped or Terminated.
    name: aws-ssm-inventory-list
    outputs:
    - contextPath: AWS.SSM.InventoryNextToken.NextToken
      description: The token for the next set of items to return.
      type: String
    - contextPath: AWS.SSM.Inventory.Id
      description: ID of the inventory result entity. For example, for managed node
        inventory the result will be the managed node ID. For EC2 instance inventory,
        the result will be the instance ID.
      type: String
    - contextPath: AWS.SSM.Inventory.TypeName
      description: The name of the inventory result item type.
      type: String
    - contextPath: AWS.SSM.Inventory.SchemaVersion
      description: The schema version for the inventory result item.
      type: String
    - contextPath: AWS.SSM.Inventory.CaptureTime
      description: The time inventory item data was captured.
      type: String
    - contextPath: AWS.SSM.Inventory.ContentHash
      description: MD5 hash of the inventory item type contents. The content hash
        is used to determine whether to update inventory information. The PutInventory
        API doesn’t update the inventory item type contents if the MD5 hash hasn’t
        changed since last update.
      type: String
    - contextPath: AWS.SSM.Inventory.Content.AgentType
      description: The type of SSM agent running on the instance.
      type: String
    - contextPath: AWS.SSM.Inventory.Content.AgentVersion
      description: The version of the SSM agent running on the instance.
      type: String
    - contextPath: AWS.SSM.Inventory.Content.ComputerName
      description: The fully qualified host name of the managed node.
      type: String
    - contextPath: AWS.SSM.Inventory.Content.IpAddress
      description: The IP address of the managed node.
      type: String
    - contextPath: AWS.SSM.Inventory.Content.PlatformName
      description: The name of the operating system platform running on the managed
        node.
      type: String
    - contextPath: AWS.SSM.Inventory.Content.PlatformType
      description: The operating system platform type.
      type: String
    - contextPath: AWS.SSM.Inventory.Content.PlatformVersion
      description: The version of the OS platform running on the managed node.
      type: String
    - contextPath: AWS.SSM.Inventory.Content.ResourceType
      description: The type of instance. Instances are either EC2 instances or managed
        instances.
      type: String
    - contextPath: AWS.SSM.Inventory.Content.InstanceId
      description: The managed node ID.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: 'The managed node ID to get inventory information for. Note: to
        get the instance ID, run the aws-ssm-inventory-get command.'
      name: instance_id
      required: true
    - auto: PREDEFINED
      description: The type of inventory item to get information for.
      name: type_name
      predefined:
      - Instance Information
      - File
      - Process
      - Windows Update
      - Network
      - Patch Summary
      - Patch Compliance
      - Compliance Item
      - Instance Detailed Information
      - Service
      - Windows Registry
      - Windows Role
      - Tag
      - Resource Group
      - Billing Info
      - Application
      - AWS Components
      required: true
    - description: The maximum number of items to return for this call. The default
        and max is 50. The call also returns a token that you can specify in a subsequent
        call to get the next set of results.
      name: limit
    - description: The token for the next set of items to return. (Received this token
        from a previous call).
      name: next_token
    description: A list of inventory items returned by the request.
    name: aws-ssm-inventory-entry-list
    outputs:
    - contextPath: AWS.SSM.InventoryEntryNextToken.NextToken
      description: The token for the next set of items to return.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.TypeName
      description: The type of inventory item returned by the request.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstanceId
      description: The managed node ID targeted by the request to query inventory
        information.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.SchemaVersion
      description: The inventory schema version used by the managed node(s).
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CaptureTime
      description: The time that inventory information was collected for the managed
        node(s).
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Entries.AgentVersion
      description: The version of the SSM agent running on the instance.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Entries.AgentType
      description: The type of SSM agent running on the instance.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Entries.ComputerName
      description: The fully qualified host name of the managed node.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Entries.IpAddress
      description: The IP address of the managed node.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Entries.PlatformName
      description: The name of the operating system platform running on the managed
        node.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Entries.PlatformType
      description: The operating system platform type.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Entries.PlatformVersion
      description: The version of the OS platform running on the managed node.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Entries.ResourceType
      description: The type of instance. Instances are either EC2 instances or managed
        instances.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Name
      description: The name of the application.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ApplicationType
      description: The type of application.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Publisher
      description: The publisher of the application.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Version
      description: The version of the application.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Release
      description: The release version of the application.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Epoch
      description: The epoch value of the application version.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledTime
      description: The time when the application was installed.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Architecture
      description: The architecture of the installed application.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.URL
      description: The URL of the application.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Summary
      description: The summary information of the application.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.PackageId
      description: The package ID of the application.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Name
      description: The name of the file.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Size
      description: The size of the file in bytes.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Description
      description: The description of the file.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.FileVersion
      description: The version of the file.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledDate
      description: The date when the file was installed.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ModificationTime
      description: The date and time the file was last modified.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.LastAccessTime
      description: The date and time the file was last accessed.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ProductName
      description: The name of the product the file belongs to.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledDir
      description: The directory where the file is installed.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ProductLanguage
      description: The language of the product the file belongs to.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CompanyName
      description: The name of the company that created the file.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ProductVersion
      description: The version of the product the file belongs to.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.StartTime
      description: The date and time the process started.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CommandLine
      description: The full command line used to start the process.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.User
      description: The user account that ran the process.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.FileName
      description: The name of the executable file for the process.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.FileVersion
      description: The version number of the executable file.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.FileDescription
      description: A description of the executable file.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.FileSize
      description: The size in bytes of the executable file.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CompanyName
      description: The name of the company that released the process.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ProductName
      description: The name of the product the process belongs to.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ProductVersion
      description: The version of the product the process belongs to.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledDate
      description: The date the process was installed.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledDir
      description: The directory where the process is installed.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.UsageId
      description: The usage ID for the process.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Name
      description: The name of the AWS component.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ApplicationType
      description: The application type of the AWS component.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Publisher
      description: The publisher of the AWS component.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Version
      description: The version of the AWS component.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledTime
      description: The time the AWS component was installed.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Architecture
      description: The architecture of the AWS component.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.URL
      description: The URL for the AWS component.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.HotFixId
      description: The ID of the Windows hotfix.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Description
      description: The description of the Windows hotfix.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledTime
      description: The time the Windows hotfix was installed.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledBy
      description: Who installed the Windows hotfix.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Name
      description: The name of the network interface.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.SubnetMask
      description: The subnet mask of the network interface.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Gateway
      description: The gateway for the network interface.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.DHCPServer
      description: The DHCP server for the network interface.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.DNSServer
      description: The DNS server for the network interface.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.MacAddress
      description: The MAC address of the network interface.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.IPV4
      description: The IPv4 address of the network interface.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.IPV6
      description: The IPv6 address of the network interface.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.PatchGroup
      description: The patch group for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.BaselineId
      description: The baseline ID for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.SnapshotId
      description: The snapshot ID for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.OwnerInformation
      description: The owner information for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledCount
      description: The number of patches installed for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledPendingRebootCount
      description: The number of patches installed pending reboot for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledOtherCount
      description: The number of other patches installed for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledRejectedCount
      description: The number of patches installed but rejected for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.NotApplicableCount
      description: The number of not applicable patches for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.UnreportedNotApplicableCount
      description: The number of unreported not applicable patches for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.MissingCount
      description: The number of missing patches for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.FailedCount
      description: The number of patches that failed for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.OperationType
      description: The type of operation for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.OperationStartTime
      description: The start time of the operation for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.OperationEndTime
      description: The end time of the operation for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstallOverrideList
      description: The override list for patch installation for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.RebootOption
      description: The reboot option for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.LastNoRebootInstallOperationTime
      description: The time of the last no-reboot patch installation operation for
        the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ExecutionId
      description: The execution ID for the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.NonCompliantSeverity
      description: The severity level for non-compliant patches in the patch summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.SecurityNonCompliantCount
      description: The number of security patches that are non-compliant in the patch
        summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CriticalNonCompliantCount
      description: The number of critical patches that are non-compliant in the patch
        summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.OtherNonCompliantCount
      description: The number of other patches that are non-compliant in the patch
        summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Title
      description: The title of the patch compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.KBId
      description: The KB ID for the patch compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Classification
      description: The classification for the patch compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Severity
      description: The severity level for the patch compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.State
      description: The state of the patch compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledTime
      description: The time the patch was installed for the patch compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ComplianceType
      description: The compliance type for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ExecutionId
      description: The execution ID for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ExecutionType
      description: The execution type for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ExecutionTime
      description: The execution time for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Id
      description: The ID for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Title
      description: The title of the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Status
      description: The status of the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Severity
      description: The severity of the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.DocumentName
      description: The name of the document for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.DocumentVersion
      description: The version of the document for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Classification
      description: The classification of the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.PatchBaselineId
      description: The ID of the patch baseline for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.PatchSeverity
      description: The severity of the patch for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.PatchState
      description: The patch state for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.PatchGroup
      description: The patch group for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledTime
      description: The time the patch was installed for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstallOverrideList
      description: The override list for installing the patch for the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.DetailedText
      description: Detailed text about the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.DetailedLink
      description: A detailed link related to the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CVEIds
      description: CVE IDs associated with the compliance item.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ComplianceType
      description: The type of compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.PatchGroup
      description: The patch group for the compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.PatchBaselineId
      description: The ID of the patch baseline for the compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Status
      description: The compliance status for the compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.OverallSeverity
      description: The overall severity level for the compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ExecutionId
      description: The execution ID for the compliance scan in the compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ExecutionType
      description: The execution type for the compliance scan in the compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ExecutionTime
      description: The time the compliance scan was executed for the compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CompliantCriticalCount
      description: The number of compliant critical severity findings in the compliance
        summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CompliantHighCount
      description: The number of compliant findings with high severity in the compliance
        summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CompliantMediumCount
      description: The number of compliant findings with medium severity in the compliance
        summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CompliantLowCount
      description: The number of compliant findings with low severity in the compliance
        summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CompliantInformationalCount
      description: The number of compliant findings with informational severity in
        the compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CompliantUnspecifiedCount
      description: The number of compliant findings with unspecified severity in the
        compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.NonCompliantCriticalCount
      description: The number of non-compliant findings with critical severity in
        the compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.NonCompliantHighCount
      description: The number of non-compliant findings with high severity in the
        compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.NonCompliantMediumCount
      description: The number of non-compliant findings with medium severity in the
        compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.NonCompliantLowCount
      description: The number of non-compliant findings with low severity in the compliance
        summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.NonCompliantInformationalCount
      description: The number of non-compliant findings with informational severity
        in the compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.NonCompliantUnspecifiedCount
      description: The number of non-compliant findings with unspecified severity
        in the compliance summary.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CPUModel
      description: The model name of the CPU.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CPUCores
      description: The number of CPU cores.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CPUs
      description: The number of CPUs.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CPUSpeedMHz
      description: The clock speed of the CPU in MHz.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CPUSockets
      description: The number of CPU sockets.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.CPUHyperThreadEnabled
      description: Whether hyperthreading is enabled on the CPU.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.OSServicePack
      description: The service pack version of the operating system.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Name
      description: The name of the service.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.DisplayName
      description: The display name of the service.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ServiceType
      description: The type of the service.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Status
      description: The status of the service.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.DependentServices
      description: List of services that this service depends on.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ServicesDependedOn
      description: List of services that depend on this service.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.StartType
      description: The startup type of the service.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.KeyPath
      description: The path of the registry key.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ValueName
      description: The name of the registry value.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ValueType
      description: The type of the registry value.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Value
      description: The data contained in the registry value.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Name
      description: The name of the Windows role.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.DisplayName
      description: The display name of the Windows role.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Path
      description: The path of the Windows role.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.FeatureType
      description: The feature type of the Windows role.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.DependsOn
      description: List of Windows roles that this role depends on.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Description
      description: Description of the Windows role.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Installed
      description: Whether the Windows role is installed.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.InstalledState
      description: Install state of the Windows role.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.SubFeatures
      description: List of subfeatures for the Windows role.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.ServerComponentDescriptor
      description: Server component descriptor for the Windows role.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Parent
      description: Parent Windows role.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Tag.Key
      description: The name of the tag.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Tag.Value
      description: The value of the tag.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Name
      description: The name of the resource group.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.Arn
      description: The Amazon Resource Name (ARN) of the resource group.
      type: String
    - contextPath: AWS.SSM.InventoryEntry.BillingProductId
      description: The ID of the billing product.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: The maximum number of items to return for this call. The default
        and max is 50. The call also returns a token that you can specify in a subsequent
        call to get the next set of results.
      name: limit
    - description: The token for the next set of items to return. (Received this token
        from a previous call).
      name: next_token
    description: 'Returns all State Manager associations in the current Amazon Web
      Services account and Amazon Web Services Region. Note: An association is a binding
      between a document and a set of targets with a schedule.'
    name: aws-ssm-association-list
    outputs:
    - contextPath: AWS.SSM.AssociationNextToken.NextToken
      description: The token for the next set of items to return.
      type: String
    - contextPath: AWS.SSM.Association.Name
      description: The name of the SSM document.
      type: String
    - contextPath: AWS.SSM.Association.AssociationName
      description: The association name.
      type: String
    - contextPath: AWS.SSM.Association.InstanceId
      description: The managed node ID.
      type: String
    - contextPath: AWS.SSM.Association.AssociationId
      description: The ID created by the system when creating an association. An association
        is a binding between a document and a set of targets with a schedule.
      type: String
    - contextPath: AWS.SSM.Association.AssociationVersion
      description: The association version.
      type: String
    - contextPath: AWS.SSM.Association.DocumentVersion
      description: The version of the document used in the association.
      type: String
    - contextPath: AWS.SSM.Association.Targets.Key
      description: User-defined criteria for sending commands that target managed
        nodes that meet the criteria.
      type: String
    - contextPath: AWS.SSM.Association.Targets.Values
      description: User-defined criteria that maps to Key.
      type: String
    - contextPath: AWS.SSM.Association.LastExecutionDate
      description: The date on which the association was last run.
      type: String
    - contextPath: AWS.SSM.Association.Overview.Status
      description: 'The status of the association. Status can be: Pending, Success,
        or Failed.'
      type: String
    - contextPath: AWS.SSM.Association.Overview.DetailedStatus
      description: A detailed status of the association.
      type: String
    - contextPath: AWS.SSM.Association.Overview.AssociationStatusAggregatedCount
      description: Returns the number of targets for the association status. For example,
        if you created an association with two managed nodes, and one of them was
        successful, this would return the count of managed nodes by status.
      type: String
    - contextPath: AWS.SSM.Association.ScheduleExpression
      description: A cron expression that specifies a schedule when the association
        runs. The schedule runs in Coordinated Universal Time (UTC).
      type: String
    - contextPath: AWS.SSM.Association.ScheduleOffset
      description: Number of days to wait after the scheduled day to run an association.
      type: Number
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: The name of the SSM document.
      name: document_name
    - description: The managed node ID.
      name: instance_id
    - description: The association ID for which information is requested.
      name: association_id
    - description: Specify the association version to retrieve. To view the latest
        version, either specify $LATEST for this parameter, or omit this parameter.
      name: association_version
    description: Describes the association for the specified target or managed node.
      If the association was established using the Targets parameter, the association
      details must be retrieved using the associated ID. This command must provide
      either an association ID, or instance_id and document_name.
    name: aws-ssm-association-get
    outputs:
    - contextPath: AWS.SSM.Association.Name
      description: The name of the SSM document.
      type: String
    - contextPath: AWS.SSM.Association.InstanceId
      description: The managed node ID.
      type: String
    - contextPath: AWS.SSM.Association.AssociationVersion
      description: The association version.
      type: String
    - contextPath: AWS.SSM.Association.Date
      description: The date when the association was made.
      type: String
    - contextPath: AWS.SSM.Association.LastUpdateAssociationDate
      description: The date when the association was last updated.
      type: String
    - contextPath: AWS.SSM.Association.Status.Date
      description: The date when the status changed.
      type: String
    - contextPath: AWS.SSM.Association.Status.Name
      description: The status.
      type: String
    - contextPath: AWS.SSM.Association.Status.Message
      description: The reason for the status.
      type: String
    - contextPath: AWS.SSM.Association.Status.AdditionalInfo
      description: A user-defined string.
      type: String
    - contextPath: AWS.SSM.Association.Overview.Status
      description: 'The status of the association. Status can be: Pending, Success,
        or Failed.'
      type: String
    - contextPath: AWS.SSM.Association.Overview.DetailedStatus
      description: A detailed status of the association.
      type: String
    - contextPath: AWS.SSM.Association.Overview.AssociationStatusAggregatedCount
      description: Returns the number of targets for the association status. For example,
        if an association was created with two managed nodes, and one of them was
        successful, this would return the count of managed nodes by status.
      type: Number
    - contextPath: AWS.SSM.Association.DocumentVersion
      description: The document version.
      type: String
    - contextPath: AWS.SSM.Association.AutomationTargetParameterName
      description: Choose the parameter that will define how the automation will branch
        out. This target is required for associations that use an Automation runbook
        and target resources by using rate controls. Automation is a capability of
        Amazon Web Services Systems Manager.
      type: String
    - contextPath: AWS.SSM.Association.Parameters
      description: A description of the parameters for a document.
      type: Dictionary
    - contextPath: AWS.SSM.Association.AssociationId
      description: The association ID.
      type: String
    - contextPath: AWS.SSM.Association.Targets.Key
      description: User-defined criteria for sending commands that target managed
        nodes that meet the criteria.
      type: String
    - contextPath: AWS.SSM.Association.Targets.Values
      description: User-defined criteria that maps to Key.
      type: String
    - contextPath: AWS.SSM.Association.ScheduleExpression
      description: A cron expression that specifies a schedule when the association
        runs.
      type: String
    - contextPath: AWS.SSM.Association.OutputLocation
      description: An S3 bucket where to store the output details of the request.
    - contextPath: AWS.SSM.Association.OutputLocation.S3Location.OutputS3Region
      description: The Amazon Web Services Region of the S3 bucket.
      type: String
    - contextPath: AWS.SSM.Association.OutputLocation.S3Location.OutputS3BucketName
      description: The name of the S3 bucket.
      type: String
    - contextPath: AWS.SSM.Association.OutputLocation.S3Location.OutputS3KeyPrefix
      description: The S3 bucket subfolder.
      type: String
    - contextPath: AWS.SSM.Association.LastExecutionDate
      description: The date on which the association was last run.
      type: String
    - contextPath: AWS.SSM.Association.LastSuccessfulExecutionDate
      description: The last date on which the association was successfully run.
      type: String
    - contextPath: AWS.SSM.Association.AssociationName
      description: The association name.
      type: String
    - contextPath: AWS.SSM.Association.MaxErrors
      description: The number of errors that are allowed before the system stops sending
        requests to run the association on additional targets.
      type: String
    - contextPath: AWS.SSM.Association.MaxConcurrency
      description: The maximum number of targets allowed to run the association at
        the same time.
      type: String
    - contextPath: AWS.SSM.Association.ComplianceSeverity
      description: The severity level that is assigned to the association.
      type: String
    - contextPath: AWS.SSM.Association.SyncCompliance
      description: The mode for generating association compliance - AUTO or MANUAL.
        In AUTO mode, the system uses the status of the association execution to determine
        the compliance status. If the association execution runs successfully, then
        the association is COMPLIANT. If the association execution doesn’t run successfully,
        the association is NON-COMPLIANT. In MANUAL mode, must specify the AssociationId
        as a parameter for the PutComplianceItems API operation. In this case, compliance
        data isn’t managed by State Manager, a capability of Amazon Web Services Systems
        Manager. It is managed by a direct call to the PutComplianceItems API operation.
        By default, all associations use AUTO mode.
      type: String
    - contextPath: AWS.SSM.Association.ApplyOnlyAtCronInterval
      description: By default, when creating a new association, the system runs it
        immediately after it is created and then according to the schedule that was
        specified. This parameter isn’t supported for rate expressions.
      type: Boolean
    - contextPath: AWS.SSM.Association.CalendarNames
      description: The names or Amazon Resource Names (ARNs) of the Change Calendar
        type documents the associations are gated under. The associations only run
        when that change calendar is open.
      type: String
    - contextPath: AWS.SSM.Association.TargetLocations.Accounts
      description: The Amazon Web Services accounts targeted by the current Automation
        execution.
      type: String
    - contextPath: AWS.SSM.Association.TargetLocations.Regions
      description: The Amazon Web Services Regions targeted by the current Automation
        execution.
      type: String
    - contextPath: AWS.SSM.Association.TargetLocations.TargetLocationMaxConcurrency
      description: The maximum number of Amazon Web Services Regions and Amazon Web
        Services accounts allowed to run the Automation concurrently.
      type: String
    - contextPath: AWS.SSM.Association.TargetLocations.TargetLocationMaxErrors
      description: The maximum number of errors allowed before the system stops queueing
        additional Automation executions for the currently running Automation.
      type: String
    - contextPath: AWS.SSM.Association.TargetLocations.ExecutionRoleName
      description: The Automation execution role used by the currently running Automation.
        If not specified, the default value is AWS-SystemsManager-AutomationExecutionRole.
      type: String
    - contextPath: AWS.SSM.Association.TargetLocations.TargetLocationAlarmConfiguration.IgnorePollAlarmFailure
      description: When this value is true, the automation or command continues to
        run in cases where we can’t retrieve alarm status information from CloudWatch.
        In cases where we successfully retrieve an alarm status of OK or INSUFFICIENT_DATA,
        the automation or command continues to run, regardless of this value. Default
        is false.
      type: Boolean
    - contextPath: AWS.SSM.Association.TargetLocations.TargetLocationAlarmConfiguration.Alarms.Name
      description: The name of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.Association.ScheduleOffset
      description: Number of days to wait after the scheduled day to run an association.
      type: Number
    - contextPath: AWS.SSM.Association.TargetMaps
      description: A key-value mapping of document parameters to target resources.
        Both Targets and TargetMaps can’t be specified together.
      type: List
    - contextPath: AWS.SSM.Association.AlarmConfiguration.IgnorePollAlarmFailure
      description: When this value is true, the automation or command continues to
        run in cases where we can’t retrieve alarm status information from CloudWatch.
        In cases where we successfully retrieve an alarm status of OK or INSUFFICIENT_DATA,
        the automation or command continues to run, regardless of this value. Default
        is false.
      type: Boolean
    - contextPath: AWS.SSM.Association.AlarmConfiguration.Alarms.Name
      description: The name of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.Association.TriggeredAlarms.Name
      description: The CloudWatch alarm that was invoked during the association.
      type: String
    - contextPath: AWS.SSM.Association.TriggeredAlarms.State
      description: The state of the CloudWatch alarm.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: The association ID for which to view all versions.
      name: association_id
      required: true
    - description: The maximum number of items to return for this call. The default
        and max is 50. The call also returns a token that you can specify in a subsequent
        call to get the next set of results.
      name: limit
    - description: The token for the next set of items to return. (Received this token
        from a previous call).
      name: next_token
    description: Retrieves all versions of an association for a specific association
      ID.
    name: aws-ssm-association-version-list
    outputs:
    - contextPath: AWS.SSM.AssociationVersionNextToken.NextToken
      description: The token for the next set of items to return. Use this token to
        get the next set of results.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.AssociationId
      description: The ID created by the system when the association was created.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.AssociationVersion
      description: The association version.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.CreatedDate
      description: The date the association version was created.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.Name
      description: The name specified when the association was created.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.DocumentVersion
      description: The version of an Amazon Web Services Systems Manager document
        (SSM document) used when the association version was created.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.Parameters
      description: Parameters specified when the association version was created.
      type: Dictionary
    - contextPath: AWS.SSM.AssociationVersion.Targets.Key
      description: User-defined criteria for sending commands that target managed
        nodes that meet the criteria.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.Targets.Values
      description: User-defined criteria that maps to Key, Depending on the type of
        target, the maximum number of values for a key might be lower than the global
        maximum of 50.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.ScheduleExpression
      description: The cron or rate schedule specified for the association when the
        association version was created.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.OutputLocation.S3Location
      description: An S3 bucket where to store the output details of the request.
      type: Dictionary
    - contextPath: AWS.SSM.AssociationVersion.OutputLocation.S3Location.OutputS3Region
      description: The Amazon Web Services Region of the S3 bucket.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.OutputLocation.S3Location.OutputS3BucketName
      description: The name of the S3 bucket.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.OutputLocation.S3Location.OutputS3KeyPrefix
      description: The S3 bucket subfolder.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.AssociationName
      description: The name specified for the association version when the association
        version was created.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.MaxErrors
      description: The number of errors that are allowed before the system stops sending
        requests to run the association on additional targets. Executions that are
        already running an association when MaxErrors is reached are allowed to complete,
        but some of these executions may fail as well.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.MaxConcurrency
      description: The maximum number of targets allowed to run the association at
        the same time. If a new managed node starts and attempts to run an association
        while Systems Manager is running MaxConcurrency associations, the association
        is allowed to run. During the next association interval, the new managed node
        will process its association within the limit specified for MaxConcurrency.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.ComplianceSeverity
      description: The severity level that is assigned to the association.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.SyncCompliance
      description: The mode for generating association compliance.. Can be AUTO or
        MANUAL. In AUTO mode, the system uses the status of the association execution
        to determine the compliance status. If the association execution runs successfully,
        then the association is COMPLIANT. If the association execution doesn’t run
        successfully, the association is NON-COMPLIANT. By default, all associations
        use AUTO mode. In MANUAL mode, the AssociationId must be specified as a parameter
        for the PutComplianceItems API operation. In this case, compliance data isn’t
        managed by State Manager, a capability of Amazon Web Services Systems Manager.
        It is managed by the direct call to the PutComplianceItems API operation.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.ApplyOnlyAtCronInterval
      description: By default, when creating a new association, the system runs it
        immediately after it is created and then according to the schedule that was
        specified. This parameter isn’t supported for rate expressions.
      type: Boolean
    - contextPath: AWS.SSM.AssociationVersion.CalendarNames
      description: The names or Amazon Resource Names (ARNs) of the Change Calendar
        type documents the associations are gated under. The associations for this
        version only run when that Change Calendar is open.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.TargetLocations.Accounts
      description: The Amazon Web Services accounts targeted by the current Automation
        execution.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.TargetLocations.Regions
      description: The Amazon Web Services Regions targeted by the current Automation
        execution.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.TargetLocations.TargetLocationMaxConcurrency
      description: The maximum number of Amazon Web Services Regions and Amazon Web
        Services accounts allowed to run the Automation concurrently.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.TargetLocations.TargetLocationMaxErrors
      description: The maximum number of errors allowed before the system stops queueing
        additional Automation executions for the currently running Automation.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.TargetLocations.ExecutionRoleName
      description: The Automation execution role used by the currently running Automation.
        If not specified, the default value is AWS-SystemsManager-AutomationExecutionRole.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.TargetLocations.TargetLocationAlarmConfiguration.IgnorePollAlarmFailure
      description: When this value is true, the automation or command continues to
        run in cases where we can’t retrieve alarm status information from CloudWatch.
        In cases where we successfully retrieve an alarm status of OK or INSUFFICIENT_DATA,
        the automation or command continues to run, regardless of this value. Default
        is false.
      type: Boolean
    - contextPath: AWS.SSM.AssociationVersion.TargetLocations.TargetLocationAlarmConfiguration.Alarms.Name
      description: The name of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.AssociationVersion.ScheduleOffset
      description: Number of days to wait after the scheduled day to run an association.
      type: Number
    - contextPath: AWS.SSM.AssociationVersion.TargetMaps
      description: A key-value mapping of document parameters to target resources.
        Both Targets and TargetMaps can’t be specified together.
      type: Dictionary
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: The maximum number of items to return for this call. The default
        and max is 50. The call also returns a token that you can specify in a subsequent
        call to get the next set of results.
      name: limit
    - description: The token for the next set of items to return. (Received this token
        from a previous call).
      name: next_token
    description: Returns all Systems Manager (SSM) documents in the current Amazon
      Web Services account and Amazon Web Services Region.
    name: aws-ssm-document-list
    outputs:
    - contextPath: AWS.SSM.DocumentNextToken.NextToken
      description: The token to use when requesting the next set of items. If there
        are no additional items to return, the string is empty.
      type: String
    - contextPath: AWS.SSM.Document.Name
      description: The name of the SSM document.
      type: String
    - contextPath: AWS.SSM.Document.CreatedDate
      description: The date the SSM document was created.
      type: String
    - contextPath: AWS.SSM.Document.DisplayName
      description: An optional field allowing the specification of a user-defined,
        friendly name for the SSM document. This value can vary across different versions
        of the document.
      type: String
    - contextPath: AWS.SSM.Document.Owner
      description: The Amazon Web Services user that created the document.
      type: String
    - contextPath: AWS.SSM.Document.VersionName
      description: An optional field specifying the version of the artifact associated
        with the document. For example, “Release 12, Update 6”. This value is unique
        across all versions of a document, and can’t be changed.
      type: String
    - contextPath: AWS.SSM.Document.PlatformTypes
      description: The operating system platform.
      type: String
    - contextPath: AWS.SSM.Document.DocumentVersion
      description: The document version.
      type: String
    - contextPath: AWS.SSM.Document.DocumentType
      description: The document type.
      type: String
    - contextPath: AWS.SSM.Document.SchemaVersion
      description: The schema version.
      type: String
    - contextPath: AWS.SSM.Document.DocumentFormat
      description: The document format, either JSON or YAML.
      type: String
    - contextPath: AWS.SSM.Document.TargetType
      description: The target type which defines the kinds of resources the document
        can run on. For example, /AWS:EC2:Instance. For a list of valid resource types,
        see Amazon Web Services resource and property types reference in the [CloudFormation
        User Guide](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-template-resource-type-ref.html).
      type: String
    - contextPath: AWS.SSM.Document.Tags.Key
      description: The name of the tag.
      type: String
    - contextPath: AWS.SSM.Document.Tags.Value
      description: The value of the tag.
      type: String
    - contextPath: AWS.SSM.Document.Requires.Name
      description: The name of the required SSM document. The name can be an Amazon
        Resource Name (ARN).
      type: String
    - contextPath: AWS.SSM.Document.Requires.Version
      description: The document version required by the current document.
      type: String
    - contextPath: AWS.SSM.Document.Requires.RequireType
      description: The document type of the required SSM document.
      type: String
    - contextPath: AWS.SSM.Document.Requires.VersionName
      description: An optional field specifying the version of the artifact associated
        with the document. For example, “Release 12, Update 6”. This value is unique
        across all versions of a document, and can’t be changed.
      type: String
    - contextPath: AWS.SSM.Document.ReviewStatus
      description: The current status of a document review.
      type: String
    - contextPath: AWS.SSM.Document.Author
      description: The user in the organization who created the document.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: The name of the SSM document.
      name: document_name
      required: true
    - description: 'The document version. Can be a specific version or the default
        version. Valid Values: ''default'' ''latest'' or a specific version number.'
      name: document_version
    - description: Specifying the version of the artifact associated with the document.
        For example, “Release 12, Update 6”. This value is unique across all versions
        of a document, and can’t be changed.
      name: version_name
    description: Describes the specified Amazon Web Services Systems Manager document
      (SSM document).
    name: aws-ssm-document-get
    outputs:
    - contextPath: AWS.SSM.Document.Sha1
      description: The SHA1 hash of the document, which you can use for verification.
      type: String
    - contextPath: AWS.SSM.Document.Hash
      description: The SHA256 or SHA1 hash created by the system when the document
        was created.
      type: String
    - contextPath: AWS.SSM.Document.HashType
      description: The hash type of the document. Valid values include SHA256 or SHA1.
      type: String
    - contextPath: AWS.SSM.Document.Name
      description: The name of the SSM document.
      type: String
    - contextPath: AWS.SSM.Document.DisplayName
      description: The friendly name of the SSM document. This value can differ for
        each version of the document.
      type: String
    - contextPath: AWS.SSM.Document.VersionName
      description: The version of the artifact associated with the document.
      type: String
    - contextPath: AWS.SSM.Document.Owner
      description: The Amazon Web Services user that created the document.
      type: String
    - contextPath: AWS.SSM.Document.CreatedDate
      description: The date when the document was created.
      type: String
    - contextPath: AWS.SSM.Document.Status
      description: The status of the SSM document.
      type: String
    - contextPath: AWS.SSM.Document.StatusInformation
      description: A message returned by Amazon Web Services Systems Manager that
        explains the Status value. For example, a Failed status might be explained
        by the StatusInformation message, “The specified S3 bucket doesn’t exist.
        Verify that the URL of the S3 bucket is correct.”.
      type: String
    - contextPath: AWS.SSM.Document.DocumentVersion
      description: The document version.
      type: String
    - contextPath: AWS.SSM.Document.Description
      description: A description of the document.
      type: String
    - contextPath: AWS.SSM.Document.Parameters.Name
      description: The name of the parameter.
      type: String
    - contextPath: AWS.SSM.Document.Parameters.Type
      description: The type of parameter. The type can be either String or StringList.
      type: String
    - contextPath: AWS.SSM.Document.Parameters.Description
      description: A description of what the parameter does, how to use it, the default
        value, and whether or not the parameter is optional.
      type: String
    - contextPath: AWS.SSM.Document.Parameters.DefaultValue
      description: If specified, the default values for the parameters. Parameters
        without a default value are required. Parameters with a default value are
        optional.
      type: String
    - contextPath: AWS.SSM.Document.PlatformTypes
      description: The list of operating system (OS) platforms compatible with this
        SSM document.
      type: String
    - contextPath: AWS.SSM.Document.DocumentType
      description: The type of document.
      type: String
    - contextPath: AWS.SSM.Document.SchemaVersion
      description: The schema version.
      type: String
    - contextPath: AWS.SSM.Document.LatestVersion
      description: The latest version of the document.
      type: String
    - contextPath: AWS.SSM.Document.DefaultVersion
      description: The default version.
      type: String
    - contextPath: AWS.SSM.Document.DocumentFormat
      description: The document format, either JSON or YAML.
      type: String
    - contextPath: AWS.SSM.Document.TargetType
      description: The target type which defines the kinds of resources the document
        can run on.
      type: String
    - contextPath: AWS.SSM.Document.Tags.Key
      description: The name of the tag.
      type: String
    - contextPath: AWS.SSM.Document.Tags.Value
      description: The value of the tag.
      type: String
    - contextPath: AWS.SSM.Document.AttachmentsInformation.Name
      description: The name of the attachment.
      type: String
    - contextPath: AWS.SSM.Document.Requires.Name
      description: The name of the required SSM document. The name can be an Amazon
        Resource Name (ARN).
      type: String
    - contextPath: AWS.SSM.Document.Requires.Version
      description: The document version required by the current document.
      type: String
    - contextPath: AWS.SSM.Document.Requires.RequireType
      description: The document type of the required SSM document.
      type: String
    - contextPath: AWS.SSM.Document.Requires.VersionName
      description: An optional field specifying the version of the artifact associated
        with the document.
      type: String
    - contextPath: AWS.SSM.Document.Author
      description: The user in the organization who created the document.
      type: String
    - contextPath: AWS.SSM.Document.ReviewInformation.ReviewedTime
      description: The time when the reviewer took action on the document review request.
      type: String
    - contextPath: AWS.SSM.Document.ReviewInformation.Status
      description: The current status of the document review request.
      type: String
    - contextPath: AWS.SSM.Document.ReviewInformation.Reviewer
      description: The reviewer assigned to take action on the document review request.
      type: String
    - contextPath: AWS.SSM.Document.ApprovedVersion
      description: The version of the document currently approved for use in the organization.
      type: String
    - contextPath: AWS.SSM.Document.PendingReviewVersion
      description: The version of the document that is currently under review.
      type: String
    - contextPath: AWS.SSM.Document.ReviewStatus
      description: The current status of the review.
      type: String
    - contextPath: AWS.SSM.Document.Category
      description: The classification of a document to help you identify and categorize
        its use.
      type: String
    - contextPath: AWS.SSM.Document.CategoryEnum
      description: The value that identifies a document’s category.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: 'The name of the SSM document to run. This can be a public document
        or a custom document. To run a shared document belonging to another account,
        specify the document ARN. Note: To get the document name, use the aws-ssm-document-list
        command.'
      name: document_name
      required: true
    - description: User-provided idempotency token. The token must be unique, is case
        insensitive, enforces the UUID format, and can’t be reused.
      name: client_token
    - description: 'The version of the Automation runbook to use for this execution.
        Can be a specific version or the default version. Valid Values: ''default''
        ''latest'' or a specific version number.'
      name: document_version
    - description: The maximum number of targets allowed to run this task in parallel.
        You can specify a number, such as 10, or a percentage, such as 10%. The default
        value is 10.
      name: max_concurrency
    - description: The number of errors that are allowed before the system stops running
        the automation on additional targets. You can specify either an absolute number
        of errors, for example 10, or a percentage of the target set, for example
        10%.
      name: max_errors
    - auto: PREDEFINED
      description: The execution mode of the automation. The default mode is Auto.
      name: mode
      predefined:
      - Auto
      - Interactive
    - description: The name of the tag.
      name: tag_key
    - description: The value of the tag.
      name: tag_value
    - defaultValue: "30"
      description: The interval in seconds between each poll.
      name: interval_in_seconds
    - description: |-
        'A key-value map of execution parameters, which match the declared parameters in the Automation runbook. Note: to run on instance(s) use the target_parameter_name argument instead of specifying instances here, e.g. target_parameter_name=InstanceIds.'
        Example for execute the command in the war-room:
        - `"Role":["Admin", "User"]"`.
        Example for execute the command in the playbook (see screenshot in the README.md file):
        in the first input box:
        Role (without a  quote)
        in the second input box:
        Admin, User (without a quote, and with a comma between values).
      name: parameters
      type: keyValue
    - description: The ID of the execution. This is for the polling to work, not for
        the user.
      hidden: true
      name: execution_id
    - defaultValue: "600"
      description: The timeout in seconds until polling ends.
      name: timeout
    - description: Hide the polling message and only print the final status at the
        end. This argument is for the dev, not for the user.
      hidden: true
      name: hide_polling_output
    - description: The name of the parameter used as the target resource for the rate-controlled
        execution. Required if you specify target_key and target_values arguments.
        For example, instanceIds, LambdaRoleArn.
      name: target_parameter_name
    - auto: PREDEFINED
      description: User-defined criteria for sending commands that target managed
        nodes that meet the criteria. Required if you specify target_parameter_name
        argument.
      name: target_key
      predefined:
      - Parameter Values
      - Tag Key
      - Resource Group
    - description: |-
        User-defined criteria that maps to target_key.
        For example:
         - target_key=ResourceGroup target_values=MyResourceGroup.
         - target_key=TagKey target_values=<my-tag-key-1>,<my-tag-key-2>
         Note: Depending on the type of target, the maximum number of values for a key might be lower than the global maximum of 50.
      name: target_values
    description: Initiates execution of an Automation runbook.
    name: aws-ssm-automation-execution-run
    outputs:
    - contextPath: AWS.SSM.AutomationExecution.AutomationExecutionId
      description: The unique ID of a newly scheduled automation execution.
      type: String
    polling: true
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - defaultValue: "30"
      description: The interval in seconds between each poll.
      name: interval_in_seconds
    - description: The execution ID of the Automation to stop.
      name: automation_execution_id
      required: true
    - auto: PREDEFINED
      description: The stop request type. The default type is Cancel. Can get the
        value by running the aws-ssm-automation-list command.
      name: type
      predefined:
      - Cancel
      - Complete
    - auto: PREDEFINED
      defaultValue: "false"
      description: When set to true, will keep polling results until the command returns
        that the status of the automation execution is updated to Cancelled.
      name: include_polling
      predefined:
      - "true"
      - "false"
    - defaultValue: "true"
      description: This argument is used to determine whether the current execution
        of the command is the initial run. After the command is executed, the argument
        is updated to 'false.' During polling, the code checks the status only for
        the first execution.
      hidden: true
      name: first_run
    - defaultValue: "600"
      description: The timeout in seconds until polling ends.
      name: timeout
    - description: Hide the polling message and only print the final status at the
        end. This argument is for the dev, not for the user.
      hidden: true
      name: hide_polling_output
    description: Stop an Automation execution.
    name: aws-ssm-automation-execution-cancel
    polling: true
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: 'The unique identifier for an existing automation execution to
        examine. The execution ID is returned by aws-ssm-automation-execution-run
        command when the execution of an Automation runbook is initiated. Note: if
        execution_id not provide the command return a list of executions.'
      name: execution_id
    - defaultValue: "50"
      description: The maximum number of items to return for this command. The command
        also returns a token that can specify in a subsequent command to get the next
        set of results.
      name: limit
    - description: The token for the next set of items to return. (Received this token
        from a previous call).
      name: next_token
    description: If the argument execution_id is provided, the command returns detailed
      information about a particular Automation execution. if not provided, the command
      provides details about all active and terminated Automation executions.
    name: aws-ssm-automation-execution-list
    outputs:
    - contextPath: AWS.SSM.AutomationExecutionNextToken.NextToken
      description: The token for the next set of items to return.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.AutomationExecutionId
      description: The execution ID.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.DocumentName
      description: The name of the Automation runbook used during the execution.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.DocumentVersion
      description: The version of the document to use during execution.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.ExecutionStartTime
      description: The time the execution started.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.ExecutionEndTime
      description: The time the execution finished.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.AutomationExecutionStatus
      description: The execution status of the Automation.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.StepName
      description: The name of this execution step.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.Action
      description: The action this step performs. The action determines the behavior
        of the step.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.TimeoutSeconds
      description: The timeout seconds of the step.
      type: Number
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.OnFailure
      description: The action to take if the step fails. The default value is Abort.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.MaxAttempts
      description: The maximum number of tries to run the action of the step. The
        default value is 1.
      type: Number
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.ExecutionStartTime
      description: If a step has begun execution, this contains the time the step
        started. If the step is in Pending status, this field isn’t populated.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.ExecutionEndTime
      description: If a step has finished execution, this contains the time the execution
        ended. If the step hasn’t yet concluded, this field isn’t populated.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.StepStatus
      description: The execution status for this step.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.ResponseCode
      description: The response code returned by the execution of the step.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.Inputs
      description: Fully-resolved values passed into the step before execution.
      type: Dictionary
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.Outputs
      description: Returned values from the execution of the step.
      type: Dictionary
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.Response
      description: A message associated with the response code for an execution.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.FailureMessage
      description: If a step failed, this message explains why the execution failed.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.FailureDetails.FailureStage
      description: 'The stage of the Automation execution when the failure occurred.
        The stages include the following: InputValidation, PreVerification, Invocation,
        PostVerification.'
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.FailureDetails.FailureType
      description: 'The type of Automation failure. Failure types include the following:
        Action, Permission, Throttling, Verification, Internal.'
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.FailureDetails.Details
      description: Detailed information about the Automation step failure.
      type: Dictionary
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.StepExecutionId
      description: The unique ID of a step execution.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.OverriddenParameters
      description: A user-specified list of parameters to override when running a
        step.
      type: Dictionary
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.IsEnd
      description: The flag which can be used to end automation no matter whether
        the step succeeds or fails.
      type: Boolean
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.NextStep
      description: The next step after the step succeeds.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.IsCritical
      description: The flag which can be used to help decide whether the failure of
        the current step leads to the Automation failure.
      type: Boolean
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.ValidNextSteps
      description: Strategies used when a step fails. Supports Continue and Abort.
        Abort will fail the automation when the step fails. Continue will ignore the
        failure of the current step and allow automation to run the next step. With
        conditional branching, AWS added step:stepName to support the automation to
        go to another specific step.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.Targets.Key
      description: User-defined criteria for sending commands that target managed
        nodes that meet the criteria.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.Targets.Values
      description: User-defined criteria that maps to Key.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.TargetLocation.Accounts
      description: The Amazon Web Services accounts targeted by the current Automation
        execution.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.TargetLocation.Regions
      description: The Amazon Web Services Regions targeted by the current Automation
        execution.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.TargetLocation.TargetLocationMaxConcurrency
      description: The maximum number of Amazon Web Services Regions and Amazon Web
        Services accounts allowed to run the Automation concurrently.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.TargetLocation.TargetLocationMaxErrors
      description: The maximum number of errors allowed before the system stops queueing
        additional Automation executions for the currently running Automation.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.TargetLocation.ExecutionRoleName
      description: The Automation execution role used by the currently running Automation.
        If not specified, the default value is AWS-SystemsManager-AutomationExecutionRole.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.TargetLocation.TargetLocationAlarmConfiguration.IgnorePollAlarmFailure
      description: When this value is true, the automation or command continues to
        run in cases where we can’t retrieve alarm status information from CloudWatch.
        In cases where we successfully retrieve an alarm status of OK or INSUFFICIENT_DATA,
        the automation or command continues to run, regardless of this value. Default
        is false.
      type: Boolean
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.TargetLocation.TargetLocationAlarmConfiguration.Alarms.Name
      description: The name of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.TriggeredAlarms.Name
      description: The name of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutions.TriggeredAlarms.State
      description: The state of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.StepExecutionsTruncated
      description: A boolean value that indicates if the response contains the full
        list of the Automation step executions. If true, use the DescribeAutomationStepExecutions
        API operation to get the full list of step executions.
      type: Boolean
    - contextPath: AWS.SSM.AutomationExecution.Parameters.
      description: The key-value map of execution parameters, which were supplied
        when calling StartAutomationExecution.
      type: Dictionary
    - contextPath: AWS.SSM.AutomationExecution.Outputs
      description: The list of execution outputs as defined in the Automation runbook.
      type: Dictionary
    - contextPath: AWS.SSM.AutomationExecution.FailureMessage
      description: A message describing why an execution has failed, if the status
        is set to Failed.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Mode
      description: The automation execution mode.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.ParentAutomationExecutionId
      description: The AutomationExecutionId of the parent automation.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.ExecutedBy
      description: The Amazon Resource Name (ARN) of the user who ran the automation.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.CurrentStepName
      description: The name of the step that is currently running.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.CurrentAction
      description: The action of the step that is currently running.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.TargetParameterName
      description: The parameter name.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Targets.Key
      description: User-defined criteria for sending commands that target managed
        nodes that meet the criteria.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Targets.Values
      description: User-defined criteria that maps to Key.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.TargetMaps
      description: The specified key-value mapping of document parameters to target
        resources.
      type: List Of Dictionaries
    - contextPath: AWS.SSM.AutomationExecution.ResolvedTargets.ParameterValues
      description: A list of parameter values sent to targets that resolved during
        the Automation execution.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.ResolvedTargets.Truncated
      description: A boolean value indicating whether the resolved target list is
        truncated.
      type: Boolean
    - contextPath: AWS.SSM.AutomationExecution.MaxConcurrency
      description: The MaxConcurrency value specified by the user when the execution
        started.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.MaxErrors
      description: The MaxErrors value specified by the user when the execution started.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Target
      description: The target of the execution.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.TargetLocations.Accounts
      description: The Amazon Web Services accounts targeted by the current Automation
        execution.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.TargetLocations.Regions
      description: The Amazon Web Services Regions targeted by the current Automation
        execution.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.TargetLocations.TargetLocationMaxConcurrency
      description: The maximum number of Amazon Web Services Regions and Amazon Web
        Services accounts allowed to run the Automation concurrently.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.TargetLocations.TargetLocationMaxErrors
      description: The maximum number of errors allowed before the system stops queueing
        additional Automation executions for the currently running Automation.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.TargetLocations.ExecutionRoleName
      description: The Automation execution role used by the currently running Automation.
        If not specified, the default value is AWS-SystemsManager-AutomationExecutionRole.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.TargetLocations.TargetLocationAlarmConfiguration.IgnorePollAlarmFailure
      description: When this value is true, the automation or command continues to
        run in cases where we can’t retrieve alarm status information from CloudWatch.
        In cases where we successfully retrieve an alarm status of OK or INSUFFICIENT_DATA,
        the automation or command continues to run, regardless of this value. Default
        is false.
      type: Boolean
    - contextPath: AWS.SSM.AutomationExecution.TargetLocations.TargetLocationAlarmConfiguration.Alarms.Name
      description: The name of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.ProgressCounters.TotalSteps
      description: The total number of steps run in all specified Amazon Web Services
        Regions and Amazon Web Services accounts for the current Automation execution.
      type: Number
    - contextPath: AWS.SSM.AutomationExecution.ProgressCounters.SuccessSteps
      description: The total number of steps that successfully completed in all specified
        Amazon Web Services Regions and Amazon Web Services accounts for the current
        Automation execution.
      type: Number
    - contextPath: AWS.SSM.AutomationExecution.ProgressCounters.FailedSteps
      description: The total number of steps that failed to run in all specified Amazon
        Web Services Regions and Amazon Web Services accounts for the current Automation
        execution.
      type: Number
    - contextPath: AWS.SSM.AutomationExecution.ProgressCounters.CancelledSteps
      description: The total number of steps that the system cancelled in all specified
        Amazon Web Services Regions and Amazon Web Services accounts for the current
        Automation execution.
      type: Number
    - contextPath: AWS.SSM.AutomationExecution.ProgressCounters.TimedOutSteps
      description: The total number of steps that timed out in all specified Amazon
        Web Services Regions and Amazon Web Services accounts for the current Automation
        execution.
      type: Number
    - contextPath: AWS.SSM.AutomationExecution.AlarmConfiguration.IgnorePollAlarmFailure
      description: When this value is true, the automation or command continues to
        run in cases where we can’t retrieve alarm status information from CloudWatch.
        In cases where we successfully retrieve an alarm status of OK or INSUFFICIENT_DATA,
        the automation or command continues to run, regardless of this value. Default
        is false.
      type: Boolean
    - contextPath: AWS.SSM.AutomationExecution.AlarmConfiguration.Alarms.Name
      description: The name of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.TriggeredAlarms.Name
      description: The name of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.TriggeredAlarms.State
      description: The state of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.AutomationSubtype
      description: The subtype of the Automation operation. Currently, the only supported
        value is ChangeRequest.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.ScheduledTime
      description: The date and time the Automation operation is scheduled to start.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.DocumentName
      description: The name of the Automation runbook used in a runbook workflow.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.DocumentVersion
      description: The version of the Automation runbook used in a runbook workflow.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.Parameters
      description: The key-value map of execution parameters, which were supplied
        when calling StartChangeRequestExecution.
      type: Dictionary
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.TargetParameterName
      description: The name of the parameter used as the target resource for the rate-controlled
        runbook workflow. Required if you specify Targets.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.Targets.Key
      description: User-defined criteria for sending commands that target managed
        nodes that meet the criteria.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.Targets.Values
      description: User-defined criteria that maps to Key. For example, if you specified
        tag:ServerRole, you could specify value:WebServer to run a command on instances
        that include EC2 tags of ServerRole,WebServer.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.TargetMaps
      description: A key-value mapping of runbook parameters to target resources.
        Both Targets and TargetMaps can’t be specified together.
      type: List Of Dictionaries
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.MaxConcurrency
      description: The MaxConcurrency value specified by the user when the operation
        started, indicating the maximum number of resources that the runbook operation
        can run on at the same time.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.MaxErrors
      description: The MaxErrors value specified by the user when the execution started,
        indicating the maximum number of errors that can occur during the operation
        before the updates are stopped or rolled back.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.TargetLocations.Accounts
      description: The Amazon Web Services accounts targeted by the current Automation
        execution.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.TargetLocations.Regions
      description: The Amazon Web Services Regions targeted by the current Automation
        execution.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.TargetLocations.TargetLocationMaxConcurrency
      description: The maximum number of Amazon Web Services Regions and Amazon Web
        Services accounts allowed to run the Automation concurrently.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.TargetLocations.TargetLocationMaxErrors
      description: The maximum number of errors allowed before the system stops queueing
        additional Automation executions for the currently running Automation.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.TargetLocations.ExecutionRoleName
      description: The Automation execution role used by the currently running Automation.
        If not specified, the default value is AWS-SystemsManager-AutomationExecutionRole.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.TargetLocations.TargetLocationAlarmConfiguration.IgnorePollAlarmFailure
      description: When this value is true, the automation or command continues to
        run in cases where we can’t retrieve alarm status information from CloudWatch.
        In cases where we successfully retrieve an alarm status of OK or INSUFFICIENT_DATA,
        the automation or command continues to run, regardless of this value. Default
        is false.
      type: Boolean
    - contextPath: AWS.SSM.AutomationExecution.Runbooks.TargetLocations.TargetLocationAlarmConfiguration.Alarms.Name
      description: The name of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.OpsItemId
      description: The ID of an OpsItem that is created to represent a Change Manager
        change request.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.AssociationId
      description: The ID of a State Manager association used in the Automation operation.
      type: String
    - contextPath: AWS.SSM.AutomationExecution.ChangeRequestName
      description: The name of the Change Manager change request.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: A unique identifier for this command. If provided, lists only the
        specified command.
      name: command_id
    - defaultValue: "50"
      description: The maximum number of items to return for this call.
      name: limit
    - description: The token for the next set of items to return. (Received this token
        from a previous call).
      name: next_token
    description: Lists the commands requested by users of the Amazon Web Services
      account.
    name: aws-ssm-command-list
    outputs:
    - contextPath: AWS.SSM.CommandNextToken.NextToken
      description: The token for the next set of items to return. (Received this token
        from a previous call).
      type: String
    - contextPath: AWS.SSM.Command.CommandId
      description: A unique identifier for this command.
      type: String
    - contextPath: AWS.SSM.Command.DocumentName
      description: The name of the document requested for execution.
      type: String
    - contextPath: AWS.SSM.Command.DocumentVersion
      description: The Systems Manager document (SSM document) version.
      type: String
    - contextPath: AWS.SSM.Command.Comment
      description: User-specified information about the command, such as a brief description
        of what the command should do.
      type: String
    - contextPath: AWS.SSM.Command.ExpiresAfter
      description: If a command expires, it changes status to DeliveryTimedOut for
        all invocations that have the status InProgress, Pending, or Delayed. ExpiresAfter
        is calculated based on the total timeout for the overall command.
      type: String
    - contextPath: AWS.SSM.Command.Parameters
      description: The parameter values to be inserted in the document when running
        the command.
      type: String
    - contextPath: AWS.SSM.Command.InstanceIds
      description: The managed node IDs against which this command was requested.
      type: String
    - contextPath: AWS.SSM.Command.Targets.Key
      description: User-defined criteria for sending commands that target managed
        nodes that meet the criteria.
      type: String
    - contextPath: AWS.SSM.Command.Targets.Values
      description: User-defined criteria that maps to Key.
      type: String
    - contextPath: AWS.SSM.Command.RequestedDateTime
      description: The date and time the command was requested.
      type: String
    - contextPath: AWS.SSM.Command.Status
      description: The status of the command.
      type: String
    - contextPath: AWS.SSM.Command.StatusDetails
      description: A detailed status of the command execution. StatusDetails includes
        more information than Status because it includes states resulting from error
        and concurrency control parameters. StatusDetails can show different results
        than Status.
      type: String
    - contextPath: AWS.SSM.Command.OutputS3Region
      description: (Deprecated) The system ignores it. Instead, Systems Manager automatically
        determines the Amazon Web Services Region of the S3 bucket.
      type: String
    - contextPath: AWS.SSM.Command.OutputS3BucketName
      description: The S3 bucket where the responses to the command executions should
        be stored. This was requested when issuing the command.
      type: String
    - contextPath: AWS.SSM.Command.OutputS3KeyPrefix
      description: The S3 directory path inside the bucket where the responses to
        the command executions should be stored. This was requested when issuing the
        command.
      type: String
    - contextPath: AWS.SSM.Command.MaxConcurrency
      description: The maximum number of managed nodes that are allowed to run the
        command at the same time.
      type: String
    - contextPath: AWS.SSM.Command.MaxErrors
      description: The maximum number of errors allowed before the system stops sending
        the command to additional targets.
      type: String
    - contextPath: AWS.SSM.Command.TargetCount
      description: The number of targets for the command.
      type: Number
    - contextPath: AWS.SSM.Command.CompletedCount
      description: 'The number of targets for which the command invocation reached
        a terminal state. Terminal states include the following: Success, Failed,
        Execution Timed Out, Delivery Timed Out, Cancelled, Terminated, or Undeliverable.'
      type: Number
    - contextPath: AWS.SSM.Command.ErrorCount
      description: The number of targets for which the status is Failed or Execution
        Timed Out.
      type: Number
    - contextPath: AWS.SSM.Command.DeliveryTimedOutCount
      description: The number of targets for which the status is Delivery Timed Out.
      type: Number
    - contextPath: AWS.SSM.Command.ServiceRole
      description: The Identity and Access Management (IAM) service role that Run
        Command, a capability of Amazon Web Services Systems Manager, uses to act
        on your behalf when sending notifications about command status changes.
      type: String
    - contextPath: AWS.SSM.Command.NotificationConfig.NotificationArn
      description: An Amazon Resource Name (ARN) for an Amazon Simple Notification
        Service (Amazon SNS) topic.
      type: String
    - contextPath: AWS.SSM.Command.NotificationConfig.NotificationEvents
      description: The different events for receive notifications.
      type: String
    - contextPath: AWS.SSM.Command.NotificationConfig.NotificationType
      description: The type of notification.
      type: String
    - contextPath: AWS.SSM.Command.CloudWatchOutputConfig.CloudWatchLogGroupName
      description: 'The name of the CloudWatch Logs log group where to send command
        output. If a group name is not specified, Amazon Web Services Systems Manager
        automatically creates a log group. The log group uses the following naming
        format: `aws/ssm/SystemsManagerDocumentName`.'
      type: String
    - contextPath: AWS.SSM.Command.CloudWatchOutputConfig.CloudWatchOutputEnabled
      description: Enables Systems Manager to send command output to CloudWatch Logs.
      type: Boolean
    - contextPath: AWS.SSM.Command.TimeoutSeconds
      description: The TimeoutSeconds value specified for a command.
      type: Number
    - contextPath: AWS.SSM.Command.AlarmConfiguration.IgnorePollAlarmFailure
      description: When this value is true, the automation or command continues to
        run in cases where we can’t retrieve alarm status information from CloudWatch.
        In cases where we successfully retrieve an alarm status of OK or INSUFFICIENT_DATA,
        the automation or command continues to run, regardless of this value. Default
        is false.
      type: Boolean
    - contextPath: AWS.SSM.Command.AlarmConfiguration.Alarms.Name
      description: The name of the CloudWatch alarm specified in the configuration.
      type: String
    - contextPath: AWS.SSM.Command.TriggeredAlarms.Name
      description: The name of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.Command.TriggeredAlarms.State
      description: The name of the CloudWatch alarm.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: The name of the Amazon Web Services Systems Manager document (SSM
        document) to run. Can get from the aws-ssm-document-list command. This can
        be a public document or a custom document. To run a shared document belonging
        to another account, specify the document Amazon Resource Name (ARN).
      name: document_name
      required: true
    - auto: PREDEFINED
      description: |-
        User-defined criteria for sending commands that target managed nodes that meet the criteria.
        For example:
         - target_key=InstanceIds target_values=<instance-id-1>,<instance-id-2>.
         - target_key=tag:<my-tag-key> target_values=<my-tag-value-1>,<my-tag-value-2>.
         - target_key=resource-groups:Name target_values=<resource-group-name>.
      name: target_key
      predefined:
      - Instance Ids
      - Tag Key
      - Resource Group
      required: true
    - description: "The value of target_values is determined by what is provided in
        the \"target_key\" argument.\nNote: the maximum number of values for a key
        might be lower than the global maximum of 50.           "
      name: target_values
      required: true
    - description: The SSM document version to use in the request. Can specify $DEFAULT,
        $LATEST, or a specific version number.
      name: document_version
    - defaultValue: "50"
      description: The maximum number of managed nodes that are allowed to run the
        command at the same time. can specify a number such as 10 or a percentage
        such as 10%.
      name: max_concurrency
    - defaultValue: "0"
      description: The maximum number of errors allowed without the command failing.
        When the command fails one more time beyond the value of MaxErrors, the systems
        stops sending the command to additional targets. Can specify a number like
        10 or a percentage like 10%.
      name: max_errors
    - description: The required and optional parameters specified in the document
        being run.
      name: parameters
      type: keyValue
    - description: User-specified information about the command, such as a brief description
        of what the command should do.
      name: comment
    - description: The name of the S3 bucket where command execution responses should
        be stored.
      name: output_s3_bucket_name
    - description: The directory structure within the S3 bucket where the responses
        should be stored.
      name: output_s3_key_prefix
    - defaultValue: "30"
      description: The interval in seconds between each poll.
      name: interval_in_seconds
    - description: A unique identifier for this command. This is for the polling to
        work, not for the user.
      hidden: true
      name: command_id
    - defaultValue: "600"
      description: The timeout in seconds until polling ends.
      name: polling_timeout
    - description: 'If this time is reached and the command hasn’t already started
        running, it won’t run. Valid Range: Minimum value of 30 seconds. Maximum value
        of 2592000 seconds (30 days).'
      name: command_timeout
    - description: Hide the polling message and only print the final status at the
        end. This argument is for the dev, not for the user.
      hidden: true
      name: hide_polling_output
    description: Runs commands on one or more managed nodes.
    name: aws-ssm-command-run
    outputs:
    - contextPath: AWS.SSM.Command.CommandId
      description: A unique identifier for this command.
      type: String
    - contextPath: AWS.SSM.Command.DocumentName
      description: The name of the document requested for execution.
      type: String
    - contextPath: AWS.SSM.Command.DocumentVersion
      description: The Systems Manager document (SSM document) version.
      type: String
    - contextPath: AWS.SSM.Command.Comment
      description: User-specified information about the command, such as a brief description
        of what the command should do.
      type: String
    - contextPath: AWS.SSM.Command.ExpiresAfter
      description: If a command expires, it changes status to DeliveryTimedOut for
        all invocations that have the status InProgress, Pending, or Delayed. ExpiresAfter
        is calculated based on the total timeout for the overall command.
      type: String
    - contextPath: AWS.SSM.Command.Parameters.string
      description: The parameter values to be inserted in the document when running
        the command.
      type: String
    - contextPath: AWS.SSM.Command.InstanceIds
      description: The managed node IDs against which this command was requested.
      type: String
    - contextPath: AWS.SSM.Command.Targets.Key
      description: User-defined criteria for sending commands that target managed
        nodes that meet the criteria.
      type: String
    - contextPath: AWS.SSM.Command.Targets.Values
      description: User-defined criteria that maps to Key.
      type: String
    - contextPath: AWS.SSM.Command.RequestedDateTime
      description: The date and time the command was requested.
      type: String
    - contextPath: AWS.SSM.Command.Status
      description: The status of the command.
      type: String
    - contextPath: AWS.SSM.Command.StatusDetails
      description: A detailed status of the command execution. StatusDetails includes
        more information than Status because it includes states resulting from error
        and concurrency control parameters. StatusDetails can show different results
        than Status.
      type: String
    - contextPath: AWS.SSM.Command.OutputS3Region
      description: (Deprecated) You can no longer specify this parameter. The system
        ignores it. Instead, Systems Manager automatically determines the Amazon Web
        Services Region of the S3 bucket.
      type: String
    - contextPath: AWS.SSM.Command.OutputS3BucketName
      description: The S3 bucket where the responses to the command executions should
        be stored. This was requested when issuing the command.
      type: String
    - contextPath: AWS.SSM.Command.OutputS3KeyPrefix
      description: The S3 directory path inside the bucket where the responses to
        the command executions should be stored. This was requested when issuing the
        command.
      type: String
    - contextPath: AWS.SSM.Command.MaxConcurrency
      description: The maximum number of managed nodes that are allowed to run the
        command at the same time.
      type: String
    - contextPath: AWS.SSM.Command.MaxErrors
      description: The maximum number of errors allowed before the system stops sending
        the command to additional targets.
      type: String
    - contextPath: AWS.SSM.Command.TargetCount
      description: The number of targets for the command.
      type: Number
    - contextPath: AWS.SSM.Command.CompletedCount
      description: 'The number of targets for which the command invocation reached
        a terminal state. Terminal states include the following: Success, Failed,
        Execution Timed Out, Delivery Timed Out, Cancelled, Terminated, or Undeliverable.'
      type: Number
    - contextPath: AWS.SSM.Command.ErrorCount
      description: The number of targets for which the status is Failed or Execution
        Timed Out.
      type: Number
    - contextPath: AWS.SSM.Command.DeliveryTimedOutCount
      description: The number of targets for which the status is Delivery Timed Out.
      type: Number
    - contextPath: AWS.SSM.Command.ServiceRole
      description: The Identity and Access Management (IAM) service role that Run
        Command, a capability of Amazon Web Services Systems Manager, uses to act
        on your behalf when sending notifications about command status changes.
      type: String
    - contextPath: AWS.SSM.Command.NotificationConfig.NotificationArn
      description: An Amazon Resource Name (ARN) for an Amazon Simple Notification
        Service (Amazon SNS) topic. Run Command pushes notifications about command
        status changes to this topic.
      type: String
    - contextPath: AWS.SSM.Command.NotificationConfig.NotificationEvents
      description: The different events for which you can receive notifications.
      type: String
    - contextPath: AWS.SSM.Command.NotificationConfig.NotificationType
      description: The type of notification.
      type: String
    - contextPath: AWS.SSM.Command.CloudWatchOutputConfig.CloudWatchLogGroupName
      description: 'The name of the CloudWatch Logs log group where you want to send
        command output. If you don’t specify a group name, Amazon Web Services Systems
        Manager automatically creates a log group for you. The log group uses the
        following naming format: aws/ssm/SystemsManagerDocumentName.'
      type: String
    - contextPath: AWS.SSM.Command.CloudWatchOutputConfig.CloudWatchOutputEnabled
      description: Enables Systems Manager to send command output to CloudWatch Logs.
      type: Boolean
    - contextPath: AWS.SSM.Command.TimeoutSeconds
      description: The TimeoutSeconds value specified for a command.
      type: Number
    - contextPath: AWS.SSM.Command.AlarmConfiguration.IgnorePollAlarmFailure
      description: When this value is true, your automation or command continues to
        run in cases where we can’t retrieve alarm status information from CloudWatch.
      type: Boolean
    - contextPath: AWS.SSM.Command.AlarmConfiguration.Alarms.Name
      description: The name of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.Command.TriggeredAlarms.Name
      description: The name of the CloudWatch alarm.
      type: String
    - contextPath: AWS.SSM.Command.TriggeredAlarms.State
      description: The state of the CloudWatch alarm.
      type: String
    polling: true
  - arguments:
    - auto: PREDEFINED
      description: The AWS Region. If not specified, the default region will be used.
      name: region
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
    - description: The Amazon Resource Name (ARN) of the role to assume.
      name: roleArn
    - description: An identifier for the assumed role session.
      name: roleSessionName
    - description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
      name: roleSessionDuration
    - description: The ID of the command to cancel. Can get from the aws-ssm-command-list
        command.
      name: command_id
      required: true
    - description: A list of managed node IDs on which you want to cancel the command.
        If not provided, the command is canceled on every node on which it was requested.
      isArray: true
      name: instance_ids
    - auto: PREDEFINED
      defaultValue: "false"
      description: When set to true, will keep polling results until the command return
        that the  status of the command execution is updated to Cancelled.
      name: include_polling
      predefined:
      - "true"
      - "false"
    - defaultValue: "30"
      description: The interval in seconds between each poll.
      name: interval_in_seconds
    - defaultValue: "true"
      description: This argument is used to determine whether the current execution
        of the command is the initial run. After the command is executed, the argument
        is updated to 'false.' During polling, the code checks the status only for
        the first execution.
      hidden: true
      name: first_run
    - defaultValue: "600"
      description: The timeout in seconds until polling ends.
      name: timeout
    - description: Hide the polling message and only print the final status at the
        end. This argument is for the dev, not for the user.
      hidden: true
      name: hide_polling_output
    description: Attempts to cancel the command specified by the Command ID. There
      is no guarantee that the command will be terminated and the underlying process
      stopped.
    name: aws-ssm-command-cancel
    polling: true
  dockerimage: demisto/boto3py3:1.0.0.100294
  runonce: false
  script: |
    register_module_line('AWS - System Manager', 'start', __line__())
    ### pack version: 1.0.3
    import re
    from typing import TYPE_CHECKING, Any, NamedTuple, NoReturn



    ### GENERATED CODE ###: from AWSApiModule import *
    # This code was inserted in place of an API module.
    register_module_line('AWSApiModule', 'start', __line__(), wrapper=-3)


    import boto3
    from botocore.config import Config


    def validate_params(aws_default_region, aws_role_arn, aws_role_session_name, aws_access_key_id, aws_secret_access_key):
        """
        Validates that the provided parameters are compatible with the appropriate authentication method.
        """
        if not aws_default_region:
            raise DemistoException('You must specify AWS default region.')

        if bool(aws_access_key_id) != bool(aws_secret_access_key):
            raise DemistoException('You must provide Access Key id and Secret key id to configure the instance with '
                                   'credentials.')
        if bool(aws_role_arn) != bool(aws_role_session_name):
            raise DemistoException('Role session name is required when using role ARN.')


    def extract_session_from_secret(secret_key, session_token):
        """
        Extract the session token from the secret_key field.
        """
        if secret_key and '@@@' in secret_key and not session_token:
            return secret_key.split('@@@')[0], secret_key.split('@@@')[1]
        else:
            return secret_key, session_token


    class AWSClient:

        def __init__(self, aws_default_region, aws_role_arn, aws_role_session_name, aws_role_session_duration,
                     aws_role_policy, aws_access_key_id, aws_secret_access_key, verify_certificate, timeout, retries,
                     aws_session_token=None, sts_endpoint_url=None, endpoint_url=None):

            self.sts_endpoint_url = sts_endpoint_url
            self.endpoint_url = endpoint_url
            self.aws_default_region = aws_default_region
            self.aws_role_arn = aws_role_arn
            self.aws_role_session_name = aws_role_session_name
            # handle cases where aws_role_session_duration can be also empty string
            self.aws_role_session_duration = aws_role_session_duration if aws_role_session_duration else None
            self.aws_role_policy = aws_role_policy
            self.aws_access_key_id = aws_access_key_id
            self.aws_secret_access_key, self.aws_session_token = extract_session_from_secret(aws_secret_access_key, aws_session_token)
            self.verify_certificate = verify_certificate

            sts_regional_endpoint = demisto.params().get("sts_regional_endpoint") or None
            if sts_regional_endpoint:
                demisto.debug(f"Sets the environment variable AWS_STS_REGIONAL_ENDPOINTS={sts_regional_endpoint}")
                os.environ["AWS_STS_REGIONAL_ENDPOINTS"] = sts_regional_endpoint.lower()

            proxies = handle_proxy(proxy_param_name='proxy', checkbox_default_value=False)
            (read_timeout, connect_timeout) = AWSClient.get_timeout(timeout)
            if int(retries) > 10:
                retries = 10
            self.config = Config(
                connect_timeout=connect_timeout,
                read_timeout=read_timeout,
                retries=dict(
                    max_attempts=int(retries)
                ),
                proxies=proxies
            )

        def update_config(self):
            command_config = {}
            retries = demisto.getArg('retries')  # Supports retries and timeout parameters on the command execution level
            if retries is not None:
                command_config['retries'] = dict(max_attempts=int(retries))
            timeout = demisto.getArg('timeout')
            if timeout is not None:
                (read_timeout, connect_timeout) = AWSClient.get_timeout(timeout)
                command_config['read_timeout'] = read_timeout
                command_config['connect_timeout'] = connect_timeout
            if retries or timeout:
                demisto.debug('Merging client config settings: {}'.format(command_config))
                self.config = self.config.merge(Config(**command_config))  # type: ignore[arg-type]

        def aws_session(self, service, region=None, role_arn=None, role_session_name=None, role_session_duration=None,
                        role_policy=None):
            kwargs = {}

            self.update_config()

            if role_arn and role_session_name is not None:
                kwargs.update({
                    'RoleArn': role_arn,
                    'RoleSessionName': role_session_name,
                })
            elif self.aws_role_arn and self.aws_role_session_name is not None:
                kwargs.update({
                    'RoleArn': self.aws_role_arn,
                    'RoleSessionName': self.aws_role_session_name,
                })

            if role_session_duration is not None:
                kwargs.update({'DurationSeconds': int(role_session_duration)})
            elif self.aws_role_session_duration is not None:
                kwargs.update({'DurationSeconds': int(self.aws_role_session_duration)})

            if role_policy is not None:
                kwargs.update({'Policy': role_policy})
            elif self.aws_role_policy is not None:
                kwargs.update({'Policy': self.aws_role_policy})

            demisto.debug('{kwargs}='.format(kwargs=kwargs))

            if kwargs and not self.aws_access_key_id:  # login with Role ARN
                if not self.aws_access_key_id:
                    sts_client = boto3.client('sts', config=self.config, verify=self.verify_certificate,
                                              region_name=region if region else self.aws_default_region,
                                              endpoint_url=self.sts_endpoint_url)
                    sts_response = sts_client.assume_role(**kwargs)
                    client = boto3.client(
                        service_name=service,
                        region_name=region if region else self.aws_default_region,
                        aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                        aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                        aws_session_token=sts_response['Credentials']['SessionToken'],
                        verify=self.verify_certificate,
                        config=self.config,
                        endpoint_url=self.endpoint_url
                    )
            elif self.aws_access_key_id and (role_arn or self.aws_role_arn):  # login with Access Key ID and Role ARN
                sts_client = boto3.client(
                    service_name='sts',
                    aws_access_key_id=self.aws_access_key_id,
                    aws_secret_access_key=self.aws_secret_access_key,
                    verify=self.verify_certificate,
                    config=self.config,
                    endpoint_url=self.sts_endpoint_url
                )
                kwargs.update({
                    'RoleArn': role_arn or self.aws_role_arn,
                    'RoleSessionName': role_session_name or self.aws_role_session_name,
                })
                sts_response = sts_client.assume_role(**kwargs)
                client = boto3.client(
                    service_name=service,
                    region_name=region if region else self.aws_default_region,
                    aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                    aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                    aws_session_token=sts_response['Credentials']['SessionToken'],
                    verify=self.verify_certificate,
                    config=self.config,
                    endpoint_url=self.endpoint_url
                )
            elif self.aws_session_token and not self.aws_role_arn:  # login with session token
                client = boto3.client(
                    service_name=service,
                    region_name=region if region else self.aws_default_region,
                    aws_access_key_id=self.aws_access_key_id,
                    aws_secret_access_key=self.aws_secret_access_key,
                    aws_session_token=self.aws_session_token,
                    verify=self.verify_certificate,
                    config=self.config,
                    endpoint_url=self.endpoint_url
                )
            elif self.aws_access_key_id and not self.aws_role_arn:  # login with access key id
                client = boto3.client(
                    service_name=service,
                    region_name=region if region else self.aws_default_region,
                    aws_access_key_id=self.aws_access_key_id,
                    aws_secret_access_key=self.aws_secret_access_key,
                    verify=self.verify_certificate,
                    config=self.config,
                    endpoint_url=self.endpoint_url
                )
            else:  # login with default permissions, permissions pulled from the ec2 metadata
                client = boto3.client(service_name=service,
                                      region_name=region if region else self.aws_default_region,
                                      endpoint_url=self.endpoint_url)

            return client

        @staticmethod
        def get_timeout(timeout):
            if not timeout:
                timeout = "60,10"  # default values
            try:

                if isinstance(timeout, int):
                    read_timeout = timeout
                    connect_timeout = 10

                else:
                    timeout_vals = timeout.split(',')
                    read_timeout = int(timeout_vals[0])
                    # the default connect timeout is 10
                    connect_timeout = 10 if len(timeout_vals) == 1 else int(timeout_vals[1])

            except ValueError:
                raise DemistoException("You can specify just the read timeout (for example 60) or also the connect "
                                       "timeout followed after a comma (for example 60,10). If a connect timeout is not "
                                       "specified, a default of 10 second will be used.")
            return read_timeout, connect_timeout

    register_module_line('AWSApiModule', 'end', __line__(), wrapper=1)
    ### END GENERATED CODE ###


    # The following imports are used only for type hints and autocomplete.
    # They are not used at runtime, and not exist in the docker image.
    if TYPE_CHECKING:
        from mypy_boto3_ssm.client import SSMClient
        from mypy_boto3_ssm.literals import ResourceTypeForTaggingType
        from mypy_boto3_ssm.type_defs import (
            DescribeAutomationExecutionsRequestRequestTypeDef,
            DocumentDescriptionTypeDef,
            GetInventoryRequestRequestTypeDef,
            ListAssociationsRequestRequestTypeDef,
            ListDocumentsRequestRequestTypeDef,
        )
    """ CONSTANTS """
    RESOURCE_TYPE_MAP: dict[str, "ResourceTypeForTaggingType"] = {
        "Maintenance Window": "MaintenanceWindow",
        "Managed Instance": "ManagedInstance",
        "Ops Metadata": "OpsMetadata",
        "Patch Baseline": "PatchBaseline",
        "Ops Item": "OpsItem",
        "Association": "Association",
        "Automation": "Automation",
        "Document": "Document",
        "Parameter": "Parameter",
    }
    SERVICE_NAME = "ssm"  # Amazon Simple Systems Manager (SSM).
    DEFAULT_TIMEOUT = 600  # Default timeout for polling commands.
    MAXIMUM_COMMAND_TIMEOUT = (
        2592000  # Maximum timeout for running commands in ssm (30 days).
    )
    MINIMUM_COMMAND_TIMEOUT = 30  # Minimum timeout for running commands in ssm.
    DEFAULT_INTERVAL_IN_SECONDS = 30  # Interval for polling commands.
    TERMINAL_AUTOMATION_STATUSES = {  # the status for run automation command
        "Success": "The automation completed successfully.",
        "TimedOut": "A step or approval wasn't completed before the specified timeout period.",
        "Cancelled": "The automation was stopped by a requester before it completed.",
        "Failed": "The automation didn't complete successfully. This is a terminal state.",
    }
    CANCEL_TERMINAL_AUTOMATION_STATUSES = {  # the status for cancel automation command
        "Success": "The cancel command failed. The automation completed successfully before the cancellation.",
        "TimedOut": "The cancel command failed. The automation failed on timeout before the cancellation.",
        "Cancelled": "The cancel command completed successfully, The automation was stopped by a requester before it completed.",
        "Failed": "The cancel command failed. The automation failed before it completed.",
    }
    TERMINAL_COMMAND_STATUSES = {  # the status for run command command
        "Success": "The command completed successfully.",
        "Failed": "The command wasn't successfully on the managed node.",
        "Delivery Timed Out": "The command wasn't delivered to the managed node before the total timeout expired.",
        "Incomplete": "The command was attempted on all managed nodes and one or more of the invocations "
        "doesn't have a value of Success. However, not enough invocations failed for the status to be Failed.",
        "Cancelled": "The command was canceled before it was completed.",
        "Canceled": "The command was canceled before it was completed.",  # AWS typo, British English (canceled)
        "Rate Exceeded": "The number of managed nodes targeted by the command exceeded the account quota for pending invocations. "
        "The system has canceled the command before executing it on any node.",
        "Access Denied": "The user or role initiating the command doesn't have access to the targeted resource group. AccessDenied "
        "doesn't count against the parent command's max-errors limit, "
        "but does contribute to whether the parent command status is Success or Failed.",
        "No Instances In Tag": "The tag key-pair value or resource group targeted by the command doesn't match any managed nodes. ",
    }

    CANCEL_TERMINAL_COMMAND_STATUSES = {  # the status for cancel command command
        "Success": "The cancel command failed. The command completed successfully before the cancellation.",
        "Failed": "The cancel command failed. The command failed before it completed.",
        "Delivery Timed Out": "The command wasn't delivered to the managed node before the total timeout expired.",
        "Incomplete": "The command was attempted on all managed nodes and one or more of the invocations "
        "doesn't have a value of Success. However, not enough invocations failed for the status to be Failed.",
        "Cancelled": "The cancel command completed successfully, The command was cancelled before it was completed.",
        # AWS typo, British English (canceled)
        "Canceled": "The cancel command completed successfully. The command was canceled before it was completed.",
        "Rate Exceeded": "The number of managed nodes targeted by the command exceeded the account quota for pending invocations. "
        "The system has canceled the command before executing it on any node.",
        "Access Denied": "The user or role initiating the command doesn't have access to the targeted resource group. AccessDenied "
        "doesn't count against the parent command's max-errors limit, "
        "but does contribute to whether the parent command status is Success or Failed.",
        "No Instances In Tag": "The tag key-pair value or resource group targeted by the command doesn't match any managed nodes. ",
    }


    class RegexValidator(NamedTuple):
        name: str
        regex: re.Pattern[str]
        error_template: str


    ASSOCIATION_ID_VALIDATOR = RegexValidator(
        name="association_id",
        regex=re.compile(
            r"[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}",
        ),
        error_template="Invalid association id: {association_id}",
    )

    ASSOCIATION_VERSION_VALIDATOR = RegexValidator(
        name="association_version",
        regex=re.compile(r"([$]LATEST)|([1-9][0-9]*)"),
        error_template="Invalid association version: {association_version}",
    )

    INSTANCE_ID_VALIDATOR = RegexValidator(
        name="instance_id",
        regex=re.compile(r"(^i-(\w{8}|\w{17})$)|(^mi-\w{17}$)"),
        error_template="Invalid instance id: {instance_id}",
    )

    """ Helper functions """


    def update_if_value(
        input_dictionary: dict,
        output_dictionary: Any,
        input_to_output_keys: dict[str, str],
    ) -> Any:
        """
        Update the output dictionary with values from the input dictionary based on specified key mappings.

        This function iterates through the key-value pairs in the `input_to_output_keys` dictionary, and for each pair,
        it checks if the corresponding key exists in the `input_dictionary`. If the key exists, it copies the value to
        the `output_dictionary` under the specified output key.

        Args:
        -----
            input_dictionary (dict): The input dictionary containing data to be copied.
            output_dictionary (dict): The output dictionary where data will be copied.
            input_to_output_keys (dict): A dictionary mapping input keys to output keys.

        Returns:
        -------
            dict: The updated `output_dictionary` containing copied values based on the mapping.

        Example:
        -------
            >>> input_dict = {'next_token': 'test', 'instance_id': test_id}
            >>> output_dict = {}
            >>> key_mapping = {'next_token': 'NextToken', 'instance_id': 'InstanceId'}
            >>> update_if_value(input_dict, output_dict, key_mapping)
            {'NextToken': 'test', 'InstanceId': test_id}
        """
        for input_key, output_key in input_to_output_keys.items():
            if value := input_dictionary.get(input_key):
                output_dictionary[output_key] = value
        return output_dictionary


    def format_parameters_arguments(parameters: str) -> dict[str, Any]:
        """Formats the 'parameters' into a valid format for the AWS SDK(boto3)
            the valid format `{"key": ["value"]}`
        Args:
        ----
            parameters (str): A string containing key-value pairs separated by colons and
                values separated by commas.
                The valid format:
                1. type dict: {"key": "value1, value2"}
                2. type str: `"key":["value1","value2"]`
                3. type str: `{"key":["value1","value2"]}`

        Returns:
        -------
            dict[str, Any]: A dictionary where keys are extracted from the input string,
                and values are lists of values associated with each key.

        Example:
        -------
            Use this function to format a parameters string:

            >>> parameters = `'"key":["value1","value2"], "key2": ["value3"]'`
            >>> formatted_parameters = format_parameters_arguments(parameters)
            >>> print(formatted_parameters)
            {'key1': ['value1', 'value2'], 'key2': ['value3']}

        Note:
        ----
            - The input from the War Room should follow the format `"key":["value1","value2"]` or `{"key":["value1","value2"]}`.
            - The input from the playbook should follow the format {"key": "value1, value2"}.
            - The type of the parameter, from the playbook is dict and from the War Room is str.
        """
        parameters_dict = {}
        if isinstance(parameters, str):
            if not parameters.startswith("{") and not parameters.endswith("}"):
                parameters = "{" + parameters + "}"
            try:
                parameters_dict = json.loads(parameters)
            except json.decoder.JSONDecodeError as e:
                raise DemistoException(
                    "Make sure the parameters are in one of the allowed formats."
                ) from e
        elif isinstance(parameters, dict):  # in case the command running from playbook
            for key, value in parameters.items():
                parameters_dict[key] = argToList(value)
        return parameters_dict


    def format_document_version(document_version: str) -> str:
        """Convert the version str to AWS SSM document version string format.

        Args:
        ----
            document_version (str): The document version to format.

        Returns:
        -------
            str: The formatted document version string.
                - If "latest", it returns "$LATEST".

        Example:
        -------
            >>> version = "latest"
            >>> formatted_version = format_document_version(version)
            >>> print(Formatted version)
            $LATEST
        """
        return {"latest": "$LATEST", "default": "$DEFAULT"}.get(
            document_version, document_version
        )


    def validate_args(args: dict[str, Any]) -> NoReturn | None:
        """Validates the arguments in the provided dictionary using regular expressions,
        from the constants REGEX_PATTERNS.

        Args:
        ----
            args: A dictionary containing the arguments to be validated.

        Raises:
        ------
            DemistoException: If any of the arguments fail to match their respective regex patterns.

        Example:
        -------
            >>> args = {
            >>>    'instance_id': 'i-0a00aaa000000000a', # valid instance id
            >>>    'association_id': '0000' # invalid association id
            >>> }
            >>> try:
            >>>    validate_args(args)
            >>> except DemistoException as e:  # e equals to "Invalid association id: 0000"
            >>>     print(f"Validation error: {e}")
                Validation error: Invalid association id: 0000
        """
        for validator in (
            ASSOCIATION_ID_VALIDATOR,
            ASSOCIATION_VERSION_VALIDATOR,
            INSTANCE_ID_VALIDATOR,
        ):
            if (arg_value := args.get(validator.name)) and not re.search(
                validator.regex,
                arg_value,
            ):
                raise DemistoException(
                    validator.error_template.format(**{validator.name: arg_value}),
                )
        return None


    def config_aws_session(args: dict[str, str], aws_client: AWSClient) -> "SSMClient":
        """Configures an AWS session for the Lambda service,
        Used in all the commands.

        Args:
        ----
            args: A dictionary containing the configuration parameters for the session.
                         - 'region' (str): The AWS region.
                         - 'roleArn' (str): The ARN of the IAM role.
                         - 'roleSessionName' (str): The name of the role session.
                         - 'roleSessionDuration' (str): The duration of the role session.

            aws_client: The AWS client used to configure the session.

        Returns:
        -------
            AWS session (ssm client): The configured AWS session.
        """
        return aws_client.aws_session(
            service=SERVICE_NAME,
            region=args.get("region"),
            role_arn=args.get("roleArn"),
            role_session_name=args.get("roleSessionName"),
            role_session_duration=args.get("roleSessionDuration"),
        )


    def convert_datetime_to_iso(response) -> dict[str, Any]:
        """Converts datetime objects in a response dictionary to ISO formatted strings.

        Args:
        ----
            response (dict): The response dictionary.

        Returns:
        -------
            dict: The response dictionary with datetime objects converted to ISO formatted strings.

        Example:
        -------
            >>> response = {
            >>>    'timestamp': datetime(2023, 8, 20, 12, 30, 0),
            >>>    'data': {
            >>>        'created_at': datetime(2023, 8, 19, 15, 45, 0)
            >>>    }
            >>> }
            >>> iso_response = convert_datetime_to_iso(response)
            >>> print(iso_response)
                {
                'timestamp': '2023-08-20T12:30:00',
                'data': {
                     'created_at': '2023-08-19T15:45:00'
                   }
                }
        """

        def _datetime_to_string(obj: Any) -> str:
            if isinstance(obj, datetime):
                return obj.isoformat()
            raise TypeError(f"Type {type(obj)} is not serializable.")

        # json.dumps(default=): If specified, default should be a function that
        # gets called for objects that can’t otherwise be serialized.
        # It should return a JSON encodable version of the object or raise a TypeError. If not specified, TypeError is raised.
        return json.loads(json.dumps(response, default=_datetime_to_string))


    def next_token_command_result(next_token: str, outputs_prefix: str) -> CommandResults:
        """Creates a CommandResults object with the next token as the output.

        Args:
        ----
            next_token (str): The next token.
            outputs_prefix (str): The prefix for the outputs.

        Returns:
        -------
            CommandResults: A CommandResults object with the next token as the output.

        Example:
        -------
            >>> next_token_command_result("token", "InventoryNextToken")
            in the context output(war room):
            {
                AWS:
                    SSM:
                        InventoryNextToken:
                            NextToken: "token"
            }
        """
        return CommandResults(
            outputs={f"AWS.SSM.{outputs_prefix}(val.NextToken)": {"NextToken": next_token}},
            readable_output=f"For more results, use the next token from the context path: AWS.SSM.{outputs_prefix}.NextToken",
        )


    def get_command_status(command_id: str, ssm_client: "SSMClient") -> str:
        """Gets the status of an AWS Systems Manager (SSM) command.

        Args:
        ----
            command_id (str): The unique identifier of the command.
            ssm_client (SSMClient): An instance of the AWS Systems Manager (SSM) client.

        Returns:
        -------
            str: The status of the command.
            ## Possible values:
            - Pending
            - InProgress
            - Cancelling
            - Delayed
            - Success
            - Delivery Timed Out
            - Execution Timed Out
            - Failed
            - Canceled or Cancelled (AWS typo, British English)
            - Undeliverable
            - Terminated
            - Access Denied
        """
        response = ssm_client.list_commands(CommandId=command_id)
        try:
            return response["Commands"][0]["Status"]
        except IndexError as e:
            raise DemistoException(f"Command ID {command_id} not found in response") from e
        except KeyError as e:
            raise DemistoException(
                f"Status key not found for command ID {command_id}"
            ) from e


    def parse_automation_execution(automation: dict[str, Any]) -> dict[str, Any]:
        """Parses an automation execution
        and returns a dict contain the parsed automation.
        for the readable_output function.
        """
        return {
            "Automation Execution Id": automation.get("AutomationExecutionId"),
            "Document Name": automation.get("DocumentName"),
            "Document Version": automation.get("DocumentVersion"),
            "Start Time": automation.get("ExecutionStartTime"),
            "End Time": automation.get("ExecutionEndTime"),
            "Automation Execution Status": automation.get("AutomationExecutionStatus"),
            "Mode": automation.get("Mode"),
            "Executed By": automation.get("ExecutedBy"),
        }


    """ COMMAND FUNCTIONS """


    def add_tags_to_resource_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> CommandResults:
        """Adds tags to a specified resource.
        The response from the API call when success is empty dict.

        Args:
        ----
            ssm_client ("SSMClient"): An instance of the SSM client.
            args (dict): A dictionary containing the command arguments.
                         - 'resource_type' (str): The type of the resource.
                         - 'resource_id' (str): The ID of the resource.
                         - 'tag_key' (str): The key of the tag to add.
                         - 'tag_value' (str): The value of the tag to add.

        Returns:
        -------
            CommandResults: readable output only,
        """
        kwargs = {
            "ResourceType": RESOURCE_TYPE_MAP[args["resource_type"]],
            "ResourceId": args["resource_id"],
            "Tags": [{"Key": args["tag_key"], "Value": args["tag_value"]}],
        }

        ssm_client.add_tags_to_resource(**kwargs)
        return CommandResults(
            readable_output=f"Tags successfully added to resource {args['resource_id']}.",
        )


    def remove_tags_from_resource_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> CommandResults:
        ssm_client.remove_tags_from_resource(
            ResourceType=RESOURCE_TYPE_MAP[args["resource_type"]],
            ResourceId=args["resource_id"],
            TagKeys=[args["tag_key"]],
        )
        return CommandResults(
            readable_output=f"Tag {args['tag_key']} removed from resource {args['resource_id']} successfully.",
        )


    def list_tags_for_resource_command(args: dict[str, Any], ssm_client: "SSMClient"):
        resource_id = args["resource_id"]
        response = ssm_client.list_tags_for_resource(
            ResourceType=RESOURCE_TYPE_MAP[args["resource_type"]], ResourceId=resource_id
        )
        tag_list = response["TagList"]
        tags = {"ResourceId": resource_id, "TagList": tag_list}

        human_readable = tableToMarkdown(f"Tags for {resource_id}", tag_list)

        command_results = CommandResults(
            outputs_key_field="ResourceId",
            outputs_prefix="AWS.SSM.Tag",
            outputs=tags,
            readable_output=human_readable,
        )

        return command_results


    def list_inventory_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> list[CommandResults]:
        """Fetches inventory information from AWS SSM using the provided SSM client and arguments.

        Args:
        ----
            ssm_client: SSM client object for making API requests.
            args (dict): Command arguments containing filters and parameters.

        Returns:
        -------
            list[CommandResults]: A list of CommandResults containing the inventory information.
        """

        def _parse_inventory_entities(entities: list[dict]) -> list[dict]:
            parsed_entities = []
            for entity in entities:
                entity_content: list = entity.get("Content", [])
                parsed_entity = {"Id": entity.get("Id")}
                for content in entity_content:
                    parsed_entities.append(
                        parsed_entity
                        | {
                            "Instance Id": content.get("InstanceId"),
                            "Computer Name": content.get("ComputerName"),
                            "Platform Type": content.get("PlatformType"),
                            "Platform Name": content.get("PlatformName"),
                            "Agent version": content.get("AgentVersion"),
                            "IP address": content.get("IpAddress"),
                            "Resource Type": content.get("ResourceType"),
                        }
                    )
            return parsed_entities

        kwargs: "GetInventoryRequestRequestTypeDef" = {
            "MaxResults": arg_to_number(args.get("limit", 50)) or 50,
            "Filters": [
                {"Key": "AWS:InstanceInformation.InstanceStatus", "Values": ["active"]}
            ],
        }
        kwargs = update_if_value(args, kwargs, {"next_token": "NextToken"})
        if argToBoolean(args.get("include_inactive_instance")):
            kwargs["Filters"][0]["Values"].extend(
                ["stopped", "terminated", "ConnectionLost"]
            )

        response = ssm_client.get_inventory(**kwargs)
        command_results = []

        if response_next_token := response.get("NextToken"):
            command_results.append(
                next_token_command_result(response_next_token, "InventoryNextToken"),
            )

        entities = list(response.get("Entities", []))
        # Extract the Data field from the object and add it to the main dictionary, Data contain a dict.
        # added type ignore(1) because  "Argument 1 to "update" of "MutableMapping" has incompatible type..."
        # added type ignore(2) because "Argument 1 to "update" of "TypedDict" has incompatible type...."
        for item in entities:
            item["Data"].update(item["Data"].pop("AWS:InstanceInformation", {}))  # type: ignore[arg-type]
            item.update(item.pop("Data"))  # type: ignore[typeddict-item]

        command_results.append(
            CommandResults(
                outputs_prefix="AWS.SSM.Inventory",
                outputs=entities,
                outputs_key_field="Id",
                readable_output=tableToMarkdown(
                    name="AWS SSM Inventory",
                    t=_parse_inventory_entities(entities),  # type: ignore
                ),
            ),
        )
        return command_results


    def list_inventory_entry_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> list[CommandResults]:
        """Lists inventory entries for a specific instance and type name using the provided SSM client and arguments.

        Args:
        ----
            ssm_client: AWS SSM client object for making API requests.
            args (dict): Command arguments containing filters and parameters.
                - instance_id (str): The ID of the instance.
                - type_name (str): The type name of the inventory.
                - limit (int, optional): Maximum number of entries to retrieve. Defaults to 50.
                - next_token (str, optional): Token to retrieve the next set of entries.

        Returns:
        -------
            list[CommandResults]: A list of CommandResults containing the inventory entries information.
                and the next token if exists.

        Raises:
        ------
            DemistoException: If an invalid instance ID is provided.
        """
        map_type_name = {
            "Instance Information": "InstanceInformation",
            "File": "File",
            "Process": "Process",
            "Windows Update": "WindowsUpdate",
            "Network": "Network",
            "Patch Summary": "PatchSummary",
            "Patch Compliance": "PatchCompliance",
            "Compliance Item": "ComplianceItem",
            "Instance Detailed Information": "InstanceDetailedInformation",
            "Service": "Service",
            "Windows Registry": "WindowsRegistry",
            "Windows Role": "WindowsRole",
            "Tag": "Tag",
            "Resource Group": "ResourceGroup",
            "Billing Info": "BillingInfo",
            "Application": "Application",
            "AWS Components": "AWSComponents",
        }
        type_name = map_type_name[args["type_name"]]
        kwargs = {
            "InstanceId": args["instance_id"],
            "TypeName": f"AWS:{type_name}",
            "MaxResults": arg_to_number(args.get("limit", 50)) or 50,
        }

        kwargs = update_if_value(args, kwargs, {"next_token": "NextToken"})

        response = ssm_client.list_inventory_entries(**kwargs)
        # added type ignore because "Key "ResponseMetadata" of TypedDict "ListInventoryEntriesResultTypeDef" cannot be deleted"
        response.pop("ResponseMetadata")  # type: ignore[misc]
        entries = response.get("Entries", [])

        command_results = []
        if next_token := response.get("NextToken"):
            # added type ignore because "Key NextToken" of TypedDict "ListInventoryEntriesResultTypeDef" cannot be deleted"
            response.pop("NextToken")  # type: ignore[misc]
            command_results.append(
                next_token_command_result(next_token, "InventoryEntryNextToken"),
            )

        command_results.append(
            CommandResults(
                outputs_prefix="AWS.SSM.InventoryEntry",
                outputs=response,
                outputs_key_field="InstanceId",
                readable_output=tableToMarkdown(
                    name="AWS SSM Inventory Entry",
                    t=entries,
                ),
            ),
        )

        return command_results


    def list_associations_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> list[CommandResults]:
        """Lists associations in AWS SSM using the provided SSM client and arguments.

        Args:
        ----
            ssm_client: AWS SSM client object for making API requests.
            args (dict): Command arguments containing filters and parameters.
                - limit (int, optional): Maximum number of associations to retrieve. Defaults to 50.
                - next_token (str, optional): Token to retrieve the next set of associations.

        Returns:
        -------
            list[CommandResults]: A list of CommandResults containing the association information.
            and the next token if exists in the response.
        """

        def _parse_associations(associations: list[dict[str, Any]]) -> list[dict[str, Any]]:
            return [
                {
                    "Document name": association.get("Name"),
                    "Association id": association.get("AssociationId"),
                    "Association version": association.get("AssociationVersion"),
                    "Last execution date": association.get("LastExecutionDate"),
                    "Resource status count": dict_safe_get(
                        association,
                        ["Overview", "AssociationStatusAggregatedCount"],
                    ),
                    "Status": dict_safe_get(association, ["Overview", "Status"]),
                }
                for association in associations
            ]

        kwargs: "ListAssociationsRequestRequestTypeDef" = {
            "MaxResults": arg_to_number(args.get("limit", 50)) or 50,
        }

        kwargs = update_if_value(args, kwargs, {"next_token": "NextToken"})

        response = ssm_client.list_associations(**kwargs)
        response = convert_datetime_to_iso(response)
        associations = response.get("Associations", [])
        command_results = []

        if next_token := response.get("NextToken"):
            command_results.append(
                next_token_command_result(next_token, "InventoryNextToken"),
            )

        command_results.append(
            CommandResults(
                outputs_prefix="AWS.SSM.Association",
                outputs=associations,
                outputs_key_field="AssociationId",
                readable_output=tableToMarkdown(
                    name="AWS SSM Associations",
                    t=_parse_associations(associations),
                ),
            ),
        )

        return command_results


    def get_association_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> CommandResults:
        """Retrieves information about an SSM association based on provided parameters.

        Args:
        ----
            ssm_client: The AWS SSM client used to interact with the service.
            args (dict[str, Any]): A dictionary containing the command arguments.

        Returns:
        -------
            CommandResults: A CommandResults object containing information about the retrieved association.

        Raises:
        ------
            DemistoException: If the provided arguments are invalid.
        """

        def _parse_association(association: dict[str, Any]) -> dict[str, Any]:
            return {
                "Document name": association.get("Name"),
                "Document version": association.get("DocumentVersion"),
                "Association name": association.get("AssociationName"),
                "Association id": association.get("AssociationId"),
                "Association version": association.get("AssociationVersion"),
                "Last execution date": association.get("LastExecutionDate"),
                "Resource status count": dict_safe_get(
                    association,
                    ["Overview", "AssociationStatusAggregatedCount"],
                ),
                "Status": dict_safe_get(association, ["Overview", "Status"]),
                "Create date": association.get("Date"),
                "Schedule expression": association.get("ScheduleExpression"),
            }

        association_id = args.get("association_id")
        association_version = args.get("association_version")
        instance_id = args.get("instance_id")
        document_name = args.get("document_name")

        if not (association_id or (instance_id and document_name)):
            msg = "This command must provide either association_id or instance_id and document_name."
            raise DemistoException(msg)

        kwargs = {
            "AssociationId": association_id,
            "AssociationVersion": association_version,
            "InstanceId": instance_id,
            "Name": document_name,
        }
        kwargs = {key: value for key, value in kwargs.items() if value is not None}

        response = ssm_client.describe_association(**kwargs)
        response = convert_datetime_to_iso(response)
        association_description = response.get("AssociationDescription", {})

        return CommandResults(
            outputs=association_description,
            outputs_key_field="AssociationId",
            outputs_prefix="AWS.SSM.Association",
            readable_output=tableToMarkdown(
                name="AWS SSM Association",
                t=_parse_association(association_description),
            ),
        )


    def list_versions_association_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> list[CommandResults]:
        """Lists the versions of an SSM association based on provided parameters.

        Args:
        ----
            ssm_client: The AWS SSM client used to interact with the service.
                - association_id (required): The ID of the association.
                - limit (optional): The maximum number of versions to return. Defaults to 50.
                - next_token (optional): The token for the next set of results.

        Returns:
        -------
            list[CommandResults]: A list of CommandResults objects, containing information about the association versions.
                If next_token provide in the response, the first CommandResults in the list will contain the next token.
        """

        def _parse_association_versions(
            association_versions: list[dict[str, Any]],
        ) -> list[dict[str, Any]]:
            return [
                {
                    "Version": association_version.get("AssociationVersion"),
                    "Name": association_version.get("Name"),
                    "Create date": association_version.get("CreatedDate"),
                    "Association id": association_version.get("AssociationId"),
                    "Document version": association_version.get("DocumentVersion"),
                    "Targets": association_version.get("Targets"),
                    "Parameters": association_version.get("Parameters"),
                    "Schedule expression": association_version.get("ScheduleExpression"),
                    "Output location": association_version.get("OutputLocation"),
                    "MaxConcurrency": association_version.get("MaxConcurrency"),
                    "MaxErrors": association_version.get("MaxErrors"),
                }
                for association_version in association_versions
            ]

        kwargs = {
            "AssociationId": args["association_id"],
            "MaxResults": arg_to_number(args.get("limit", 50)) or 50,
        }
        kwargs = update_if_value(args, kwargs, {"next_token": "NextToken"})

        response = ssm_client.list_association_versions(**kwargs)
        response = convert_datetime_to_iso(response)
        association_versions = response.get("AssociationVersions", [])

        command_results: list[CommandResults] = []
        if response_next_token := response.get("NextToken"):
            command_results.append(
                next_token_command_result(
                    response_next_token,
                    "AssociationVersionNextToken",
                ),
            )
        command_results.append(
            CommandResults(
                outputs=association_versions,
                outputs_key_field="AssociationId",
                outputs_prefix="AWS.SSM.AssociationVersion",
                readable_output=tableToMarkdown(
                    t=_parse_association_versions(association_versions),
                    name="Association Versions",
                    json_transform_mapping={
                        "Parameters": JsonTransformer(
                            is_nested=True,
                        ),
                        "Targets": JsonTransformer(
                            is_nested=True,
                        ),
                    },
                ),
            ),
        )
        return command_results


    def list_documents_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> list[CommandResults]:
        """Lists the documents in AWS SSM using the provided SSM client and arguments.

        Args:
        ----
            ssm_client: AWS SSM client object for making API requests.
            args (dict): Command arguments containing filters and parameters.
                - limit (int, optional): Maximum number of documents to retrieve. Defaults to 50.
                - next_token (str, optional): Token to retrieve the next set of documents.

        Returns:
        -------
            list[CommandResults]: A list of CommandResults containing the documents information.
            and the next token if exists in the response.
        """

        def _parse_documents(documents: list[dict[str, Any]]) -> list[dict[str, Any]]:
            return [
                {
                    "Name": document.get("Name"),
                    "Owner": document.get("Owner"),
                    "Document version": document.get("DocumentVersion"),
                    "Document type": document.get("DocumentType"),
                    "Created date": document.get("CreatedDate"),
                    "Platform types": document.get("PlatformTypes"),
                }
                for document in documents
            ]

        kwargs: "ListDocumentsRequestRequestTypeDef" = {
            "MaxResults": arg_to_number(args.get("limit", 50)) or 50,
        }

        kwargs = update_if_value(args, kwargs, {"next_token": "NextToken"})

        response = ssm_client.list_documents(**kwargs)
        response = convert_datetime_to_iso(response)
        documents = response.get("DocumentIdentifiers", [])

        command_results = []
        if next_token := response.get("NextToken"):
            command_results.append(
                next_token_command_result(next_token, "DocumentNextToken"),
            )

        command_results.append(
            CommandResults(
                outputs=documents,
                outputs_key_field="Name",
                outputs_prefix="AWS.SSM.Document",
                readable_output=tableToMarkdown(
                    name="AWS SSM Documents",
                    t=_parse_documents(documents),
                    headers=[
                        "Name",
                        "Owner",
                        "Document version",
                        "Document type",
                        "Platform types",
                        "Created date",
                    ],
                ),
            ),
        )
        return command_results


    def get_document_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> CommandResults:
        """Retrieves information about an AWS Systems Manager (SSM) document.

        Args:
        ----
            args (dict[str, Any]): A dictionary containing command arguments.
                - document_name (str, required): The name of the SSM document.
                - document_version (str, optional): The version of the SSM document to retrieve.
                - version_name (str, optional): The name of the version of the SSM document to retrieve.

            ssm_client (SSMClient): An instance of the AWS Systems Manager (SSM) client.

        Returns:
        -------
            CommandResults: An object containing the results of the command.
        """

        def _parse_document(document: "DocumentDescriptionTypeDef"):
            return {
                "Name": document.get("Name"),
                "Display Name": document.get("DisplayName"),
                "Document version": document.get("VersionName"),
                "Owner": document.get("Owner"),
                "Description": document.get("Description"),
                "Platform types": document.get("PlatformTypes"),
                "Created date": document.get("CreatedDate"),
                "Status": document.get("Status"),
            }

        kwargs = {"Name": args["document_name"]}
        if document_version := args.get("document_version"):
            kwargs["DocumentVersion"] = format_document_version(document_version)
        kwargs = update_if_value(args, kwargs, {"version_name": "VersionName"})

        response = ssm_client.describe_document(**kwargs)
        response = convert_datetime_to_iso(response)
        document = response["Document"]

        return CommandResults(
            outputs=document,
            outputs_key_field="Name",
            outputs_prefix="AWS.SSM.Document",
            readable_output=tableToMarkdown(
                name="AWS SSM Document",
                t=_parse_document(document),
            ),
        )


    def get_automation_execution_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> CommandResults:
        """Retrieves information about an AWS Systems Manager (SSM) automation execution.

        Args:
        ----
            args (dict[str, Any]): A dictionary containing command arguments.
                - execution_id (str): The unique identifier of the automation execution.

            ssm_client (SSMClient): An instance of the AWS Systems Manager (SSM) client.

        Returns:
        -------
            CommandResults: An object containing the results of the command.
        """
        automation_execution = ssm_client.get_automation_execution(
            AutomationExecutionId=args["execution_id"],
        )["AutomationExecution"]
        automation_execution = convert_datetime_to_iso(automation_execution)
        return CommandResults(
            outputs_prefix="AWS.SSM.AutomationExecution",
            outputs_key_field="AutomationExecutionId",
            outputs=automation_execution,
            readable_output=tableToMarkdown(
                name="AWS SSM Automation Execution",
                t=parse_automation_execution(automation_execution),
                headers=[
                    "Automation Execution Id",
                    "Document Name",
                    "Document Version",
                    "Start Time",
                    "End Time",
                    "Automation Execution Status",
                    "Mode",
                    "Executed By",
                ],
            ),
        )


    def list_automation_executions_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> list[CommandResults]:
        """Lists AWS Systems Manager (SSM) automation executions.

        Args:
        ----
            args (dict): A dictionary containing command arguments.
                - limit (int, optional): The maximum number of results to return (default is 50).
                - next_token (str, optional): A token to continue listing executions from a previous query.

            ssm_client (SSMClient): An instance of the AWS Systems Manager (SSM) client.

        Returns:
        -------
            list[CommandResults]: A list of objects containing the results of the command.
            If next_token provide in the response, the first CommandResults in the list will contain the next token.
        """
        kwargs: "DescribeAutomationExecutionsRequestRequestTypeDef" = {
            "MaxResults": arg_to_number(args.get("limit", 50)) or 50,
        }
        kwargs = update_if_value(args, kwargs, {"next_token": "NextToken"})

        response = ssm_client.describe_automation_executions(**kwargs)
        response = convert_datetime_to_iso(response)

        command_results: list[CommandResults] = []
        if next_token := response.get("NextToken"):
            command_results.append(
                next_token_command_result(next_token, "AutomationExecutionNextToken"),
            )
        automation_execution_list = response["AutomationExecutionMetadataList"]
        command_results.append(
            CommandResults(
                outputs=automation_execution_list,
                outputs_key_field="AutomationExecutionId",
                outputs_prefix="AWS.SSM.AutomationExecution",
                readable_output=tableToMarkdown(
                    name="AWS SSM Automation Executions",
                    t=[
                        parse_automation_execution(automation)
                        for automation in automation_execution_list
                    ],
                    headers=[
                        "Automation Execution Id",
                        "Document Name",
                        "Document Version",
                        "Start Time",
                        "End Time",
                        "Automation Execution Status",
                        "Mode",
                        "Executed By",
                    ],
                ),
            ),
        )
        return command_results


    def validate_target_arguments(args: dict[str, Any]) -> None:
        target_parameter_name = args.get("target_parameter_name")
        target_key = args.get("target_key")
        target_values = args.get("target_values")

        if target_parameter_name and not target_key:
            raise DemistoException(
                "You must provide a target_key when specifying a target_parameter_name."
            )
        if target_key and not target_parameter_name:
            raise DemistoException(
                "You must provide a target_parameter_name when specifying a target_key."
            )
        if target_values and not target_parameter_name:
            raise DemistoException(
                "You must provide a target_parameter_name when specifying target_values."
            )
        if target_key and not target_values:
            raise DemistoException(
                "You must provide target_values when specifying a target_key."
            )


    @polling_function(
        name="aws-ssm-automation-execution-run",
        interval=arg_to_number(
            demisto.args().get("interval_in_seconds", DEFAULT_INTERVAL_IN_SECONDS),
        ),
        timeout=arg_to_number(demisto.args().get("timeout", DEFAULT_TIMEOUT)),
        requires_polling_arg=False,  # means it will always default to poll
    )
    def run_automation_execution_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> PollResult:
        """Initiates or polls the status of an AWS Systems Manager (SSM) automation execution.
        Note: The argument "execution_id" is hidden in the yml file, and is used to pass the execution_id between polling
        Args:
            args (dict[str, Any]): A dictionary containing command arguments.
                - document_name (str, required): The name of the SSM automation document.
                - execution_id (str, optional): The unique identifier of the automation execution.
                    require for polling only.
                - tag_key (str, optional): The key for tagging the automation execution.
                - tag_value (str, optional): The value for tagging the automation execution.
                - parameters (str, optional): JSON-formatted string containing automation parameters.
                - mode (str, optional): The execution mode (default is "Auto").
                - client_token (str, optional): A unique identifier for the automation execution.
                - document_version (str, optional): The version of the SSM document to use.
                - max_concurrency (str, optional): The maximum number of targets to run the automation concurrently.
                - max_error (str, optional): The maximum number of errors allowed before stopping the automation.

            ssm_client (SSMClient): An instance of the AWS Systems Manager (SSM) client.

        Returns
        -------
            PollResult: An object containing the results of the command and whether to continue polling.
        """
        execution_id = args.get("execution_id")

        if not execution_id:  # if this is the first time the function is called
            #  ---start handling kwargs---
            tag_key = args.get("tag_key")
            tag_value = args.get("tag_value")
            kwargs = {
                "DocumentName": args["document_name"],
                "Mode": args.get("mode", "Auto"),
                **(
                    {"Tags": [{"Key": tag_key, "Value": tag_value}]}
                    if tag_key and tag_value
                    else {}
                ),
            }
            input_to_output_keys = {
                "client_token": "ClientToken",
                "max_concurrency": "MaxConcurrency",
                "max_error": "MaxErrors",
                "target_parameter_name": "TargetParameterName",
            }
            kwargs = update_if_value(args, kwargs, input_to_output_keys)
            validate_target_arguments(args)
            if document_version := args.get("document_version"):
                kwargs["DocumentVersion"] = format_document_version(document_version)
            if parameters := args.get("parameters"):
                kwargs["Parameters"] = format_parameters_arguments(parameters)
            if target_key := args.get("target_key"):
                map_target_key = {
                    "Parameter Values": "ParameterValues",
                    "Tag Key": "tag-key",
                    "Resource Group": "ResourceGroup",
                }
                kwargs["Targets"] = [
                    {
                        "Key": map_target_key[target_key],
                        "Values": argToList(args["target_values"]),
                    }
                ]
            #  ---end handling kwargs---
            #  first call to run automation
            response = ssm_client.start_automation_execution(**kwargs)
            # added type ignore
            # because "Key "ResponseMetadata" of TypedDict "StartAutomationExecutionResultTypeDef" cannot be deleted"
            response.pop("ResponseMetadata")  # type: ignore[misc]
            execution_id = response["AutomationExecutionId"]
            # needed for the polling and is `hidden: true` in the yml file.
            args["execution_id"] = execution_id
            return PollResult(
                partial_result=CommandResults(
                    readable_output=f"Execution {args['execution_id']} is in progress",
                    outputs=response,
                    outputs_prefix="AWS.SSM.AutomationExecution",
                ),
                response=None,
                continue_to_poll=True,
                args_for_next_run=args,
            )
        # polling logic
        automation_execution = ssm_client.get_automation_execution(
            AutomationExecutionId=execution_id
        )["AutomationExecution"]
        automation_execution = convert_datetime_to_iso(automation_execution)
        status = automation_execution["AutomationExecutionStatus"]
        if status in TERMINAL_AUTOMATION_STATUSES:
            if FailureMessage := automation_execution.get("FailureMessage"):
                readable_output = (
                    f"Execution {execution_id} failed with message: {FailureMessage}"
                )
            else:
                readable_output = f"The automation status is {status}, {TERMINAL_AUTOMATION_STATUSES[status]}"
            return PollResult(  # if execution not in progress, return the status and end the polling loop
                response=CommandResults(
                    readable_output=readable_output, outputs=automation_execution
                ),
                continue_to_poll=False,
            )
        return PollResult(response=None, continue_to_poll=True, args_for_next_run=args)


    @polling_function(
        name="aws-ssm-automation-execution-cancel",
        interval=arg_to_number(
            demisto.args().get("interval_in_seconds", DEFAULT_INTERVAL_IN_SECONDS),
        ),
        timeout=arg_to_number(demisto.args().get("timeout", DEFAULT_TIMEOUT)),
        requires_polling_arg=True,
        polling_arg_name="include_polling",
    )
    def cancel_automation_execution_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> PollResult:
        """Cancels an AWS Systems Manager (SSM) automation execution or monitors its cancellation status.
            Note: The argument `first_run` is hidden: true in the yml file,
                and is used to determine if this is the first time the function runs.

        Args:
        ----
            args (dict[str, Any]): A dictionary containing command arguments.
                - automation_execution_id (str): The unique identifier of the automation execution to cancel.
                - type (str, optional): The type of cancellation (default is "Cancel").
                - include_polling (bool, optional): Whether to continue polling the cancellation status (default is False).

        Returns:
        -------
            PollResult: An object containing the results of the command and whether to continue polling.
        """
        automation_execution_id = args["automation_execution_id"]
        type_ = args.get("type", "Cancel")
        include_polling = argToBoolean(args.get("include_polling", False))

        if not argToBoolean(args["first_run"]):
            status = ssm_client.get_automation_execution(
                AutomationExecutionId=automation_execution_id
            )["AutomationExecution"]["AutomationExecutionStatus"]
            if status in CANCEL_TERMINAL_AUTOMATION_STATUSES:
                return PollResult(
                    response=CommandResults(
                        readable_output=f"The automation status is {status}, {CANCEL_TERMINAL_AUTOMATION_STATUSES[status]}",
                    ),
                    continue_to_poll=False,
                )
            # Continue polling
            return PollResult(  # CONTINUE POLLING
                continue_to_poll=True,
                args_for_next_run=args,
                response=None,
            )

        # Initial command execution
        ssm_client.stop_automation_execution(
            AutomationExecutionId=automation_execution_id,
            Type=type_,
        )
        args["first_run"] = False
        # if polling stops after the first run, this will be the final result in the war room
        # otherwise this will be the partial result
        return PollResult(
            response=CommandResults(
                readable_output="Cancellation command was sent successfully.",
            ),
            partial_result=CommandResults(
                readable_output="Cancellation command was sent successfully.",
            ),
            continue_to_poll=include_polling,
        )


    def list_commands_command(
        args: dict[str, Any],
        ssm_client: "SSMClient",
    ) -> list[CommandResults]:
        """Lists AWS Systems Manager (SSM) commands.

        Args:
        ----
            args (dict[str, Any]): A dictionary containing command arguments.
                - limit (int, optional): The maximum number of results to return (default is 50).
                - next_token (str, optional): A token to continue listing commands from a previous query.
                - command_id (str, optional): The unique identifier of a specific command to retrieve.

            ssm_client (SSMClient): An instance of the AWS Systems Manager (SSM) client.

        Returns:
        -------
            list[CommandResults]: A list of objects containing the results of the command.
            if next_token provide in the response, the first CommandResults in the list will contain the next token.
        """

        def _parse_list_command(commands: list[dict]):
            return [
                {
                    "Command Id": command.get("CommandId"),
                    "Status": command.get("Status"),
                    "Requested date": command.get("RequestedDateTime"),
                    "Document name": command.get("DocumentName"),
                    "Comment": command.get("Comment"),
                    "Target Count": command.get("TargetCount"),
                    "Error Count": command.get("ErrorCount"),
                    "Delivery Timed Out Count": command.get("DeliveryTimedOutCount"),
                    "Completed Count": command.get("CompletedCount"),
                }
                for command in commands
            ]

        kwargs = {
            "MaxResults": arg_to_number(args.get("limit", 50)) or 50,
        }
        kwargs = update_if_value(
            args, kwargs, {"next_token": "NextToken", "command_id": "CommandId"}
        )

        response = ssm_client.list_commands(**kwargs)
        response = convert_datetime_to_iso(response)

        commands = response.get("Commands", [])
        # aws response sometime return empty commands and nextToken,
        # so instead the user send the command agin with the next_token the code hendle with it
        if not commands and (next_token := response.get("NextToken")):
            kwargs["NextToken"] = next_token
            # added type ignore because "Incompatible types in assignment"
            response = ssm_client.list_commands(**kwargs)  # type: ignore[assignment]
            response = convert_datetime_to_iso(response)
            commands = response.get("Commands", [])
        command_result = []
        if next_token := response.get("NextToken"):
            command_result.append(
                next_token_command_result(next_token, "CommandNextToken"),
            )

        command_result.append(
            CommandResults(
                outputs=commands,
                outputs_key_field="CommandId",
                outputs_prefix="AWS.SSM.Command",
                readable_output=tableToMarkdown(
                    name="AWS SSM Commands",
                    t=_parse_list_command(commands),
                    headers=[
                        "Command Id",
                        "Status",
                        "Requested date",
                        "Document name",
                        "Comment",
                        "Target Count",
                        "Error Count",
                        "Delivery Timed Out Count",
                        "Completed Count",
                    ],
                ),
            ),
        )
        return command_result


    @polling_function(
        name="aws-ssm-command-run",
        interval=arg_to_number(
            demisto.args().get("interval_in_seconds", DEFAULT_INTERVAL_IN_SECONDS),
        ),
        timeout=arg_to_number(demisto.args().get("polling_timeout", DEFAULT_TIMEOUT)),
        requires_polling_arg=False,  # means it will always be default to poll, poll=true,
    )
    def run_command_command(args: dict[str, Any], ssm_client: "SSMClient") -> PollResult:
        if command_id := args.get("command_id"):
            status = get_command_status(command_id, ssm_client)
            if status in TERMINAL_COMMAND_STATUSES:
                return PollResult(
                    response=CommandResults(
                        readable_output=f"The command status is {status}, {TERMINAL_COMMAND_STATUSES[status]}",
                    ),
                    continue_to_poll=False,
                )
            #  if command not in TERMINAL_COMMAND_STATUSES, continue polling
            return PollResult(
                continue_to_poll=True,
                args_for_next_run=args,
                response=None,
            )
        tag_key_map = {
            "Instance Ids": "InstanceIds",
            "Tag Key": "tag-key",
            "Resource Group": "resource-groups:Name",
        }
        kwargs = {
            "DocumentName": args["document_name"],
            "Targets": [
                {
                    "Key": tag_key_map[args["target_key"]],
                    "Values": argToList(args["target_values"]),
                }
            ],
        }

        if command_timeout := arg_to_number(args.get("command_timeout")):
            if MAXIMUM_COMMAND_TIMEOUT < command_timeout < MINIMUM_COMMAND_TIMEOUT:
                raise DemistoException(
                    f"Command timeout must be between {MINIMUM_COMMAND_TIMEOUT} and {MAXIMUM_COMMAND_TIMEOUT} seconds."
                )
            kwargs["TimeoutSeconds"] = command_timeout

        if document_version := args.get("document_version"):
            kwargs["DocumentVersion"] = format_document_version(document_version)
        input_to_output_keys = {
            "comment": "Comment",
            "output_s3_bucket_name": "OutputS3BucketName",
            "output_s3_key_prefix": "OutputS3KeyPrefix",
            "max_concurrency": "MaxConcurrency",
            "max_errors": "MaxErrors",
        }
        kwargs = update_if_value(args, kwargs, input_to_output_keys)
        if parameters := args.get("parameters"):
            parameters = format_parameters_arguments(parameters)
            kwargs["Parameters"] = parameters
        command = ssm_client.send_command(**kwargs)
        command = convert_datetime_to_iso(command)["Command"]

        command_id = command["CommandId"]
        args["command_id"] = command_id
        return PollResult(
            response=None,
            continue_to_poll=True,
            args_for_next_run=args,
            partial_result=CommandResults(
                readable_output=f"Command {command_id} was sent successfully.",
                outputs=command,
                outputs_prefix="AWS.SSM.Command",
                outputs_key_field="CommandId",
            ),
        )


    @polling_function(
        name="aws-ssm-command-cancel",
        interval=arg_to_number(
            demisto.args().get("interval_in_seconds", DEFAULT_INTERVAL_IN_SECONDS),
        ),
        timeout=arg_to_number(demisto.args().get("timeout", DEFAULT_TIMEOUT)),
        requires_polling_arg=True,
        polling_arg_name="include_polling",
    )
    def cancel_command_command(args: dict[str, Any], ssm_client: "SSMClient") -> PollResult:
        command_id = args["command_id"]
        include_polling = argToBoolean(args.get("include_polling", False))

        if not argToBoolean(args["first_run"]):
            status = get_command_status(command_id, ssm_client)
            if status in CANCEL_TERMINAL_COMMAND_STATUSES:
                return PollResult(
                    response=CommandResults(
                        readable_output=f"The command status is {status}, {CANCEL_TERMINAL_COMMAND_STATUSES[status]} polling stops.",
                    ),
                    continue_to_poll=False,
                )
            # else, continue polling
            return PollResult(  # CONTINUE POLLING
                response=None, continue_to_poll=True, args_for_next_run=args
            )

        # Initial command execution
        kwargs = {"CommandId": command_id}
        if instance_ids := argToList(args.get("instance_ids")):
            kwargs["InstanceIds"] = argToList(instance_ids)
        ssm_client.cancel_command(**kwargs)
        args["first_run"] = False
        status = get_command_status(command_id, ssm_client)

        return PollResult(
            response=CommandResults(
                readable_output="Cancellation command was sent successfully.",
            ),  # if the polling is stop after first run, this will be the final result in the war room
            partial_result=CommandResults(
                readable_output="Cancellation command was sent successfully.",
            ),  # if the polling is not stop after first run, this will be the partial result
            continue_to_poll=include_polling,
        )


    def test_module(ssm_client: "SSMClient") -> str:
        """Tests the connectivity to AWS Systems Manager (SSM) by listing associations.

        Args:
        ----
            ssm_client (SSMClient): An instance of the AWS Systems Manager (SSM) client.

        Returns:
        -------
            str: A status message indicating the success of the test.
        """
        ssm_client.list_associations(MaxResults=1)
        return "ok"


    def main():
        params = demisto.params()
        command = demisto.command()
        args = demisto.args()
        verify_certificate = not params.get("insecure", True)

        aws_access_key_id = dict_safe_get(params, ["credentials", "identifier"])
        aws_secret_access_key = dict_safe_get(params, ["credentials", "password"])
        aws_default_region = params["defaultRegion"]
        aws_role_arn = params.get("roleArn")
        aws_role_session_name = params.get("roleSessionName")
        aws_role_session_duration = params.get("sessionDuration")
        aws_role_policy = (
            None  # added it for using AWSClient class without changing the code
        )
        timeout = params["timeout"]
        retries = params["retries"]

        validate_params(
            aws_default_region,
            aws_role_arn,
            aws_role_session_name,
            aws_access_key_id,
            aws_secret_access_key,
        )
        validate_args(args)

        aws_client = AWSClient(
            aws_default_region,
            aws_role_arn,
            aws_role_session_name,
            aws_role_session_duration,
            aws_role_policy,
            aws_access_key_id,
            aws_secret_access_key,
            verify_certificate,
            timeout,
            retries,
        )

        ssm_client = config_aws_session(args, aws_client)

        demisto.debug(f"Command being called is {command}")
        try:
            results: CommandResults | list[CommandResults] | str
            match command:
                case "test-module":
                    results = test_module(ssm_client)
                case "aws-ssm-tag-add":
                    results = add_tags_to_resource_command(args, ssm_client)
                case "aws-ssm-tag-remove":
                    results = remove_tags_from_resource_command(args, ssm_client)
                case "aws-ssm-tag-list":
                    results = list_tags_for_resource_command(args, ssm_client)
                case "aws-ssm-inventory-list":
                    results = list_inventory_command(args, ssm_client)
                case "aws-ssm-inventory-entry-list":
                    results = list_inventory_entry_command(args, ssm_client)
                case "aws-ssm-association-list":
                    results = list_associations_command(args, ssm_client)
                case "aws-ssm-association-get":
                    results = get_association_command(args, ssm_client)
                case "aws-ssm-association-version-list":
                    results = list_versions_association_command(args, ssm_client)
                case "aws-ssm-document-list":
                    results = list_documents_command(args, ssm_client)
                case "aws-ssm-document-get":
                    results = get_document_command(args, ssm_client)
                case "aws-ssm-automation-execution-list":
                    if "execution_id" in args:
                        results = get_automation_execution_command(args, ssm_client)
                    else:
                        results = list_automation_executions_command(args, ssm_client)
                case "aws-ssm-automation-execution-run":
                    results = run_automation_execution_command(args, ssm_client)
                case "aws-ssm-automation-execution-cancel":
                    results = cancel_automation_execution_command(args, ssm_client)
                case "aws-ssm-command-list":
                    results = list_commands_command(args, ssm_client)
                case "aws-ssm-command-run":
                    results = run_command_command(args, ssm_client)
                case "aws-ssm-command-cancel":
                    results = cancel_command_command(args, ssm_client)
                case _:
                    msg = f"Command {command} is not implemented"
                    raise NotImplementedError(msg)
            return_results(results)
        except Exception as e:
            return_error(f"Failed to execute {command} command.\nError:\n{e!s}")


    if __name__ in ("__main__", "__builtin__", "builtins"):
        main()

    register_module_line('AWS - System Manager', 'end', __line__())
  subtype: python3
  type: python
system: true
