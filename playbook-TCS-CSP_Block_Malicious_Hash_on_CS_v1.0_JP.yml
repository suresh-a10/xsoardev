contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 7f7cc5a4-2a45-4ea9-8bc5-df697dc64131
inputs:
- description: ""
  key: file
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: File
      root: ExtractedIndicators
- description: ""
  key: filesha1
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: filemd5
  playbookInputQuery: null
  required: false
  value: {}
name: TCS-CSP Block Malicious Hash on CS v1.0_JP
outputs: []
sourceplaybookid: 9d6b9cb3-059d-4b12-865c-f73bed1daa8a
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 08e26138-199e-45e5-819f-b54e49977224
      iscommand: false
      name: ""
      version: -1
    taskid: 08e26138-199e-45e5-819f-b54e49977224
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": -740
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2a8a1103-a236-4c43-8412-68549a450f33
      iscommand: false
      name: Set Indicator Tag
      type: title
      version: -1
    taskid: 2a8a1103-a236-4c43-8412-68549a450f33
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1430
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "42"
      "yes":
      - "32"
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        simple: ${ExtractedIndicators.File_MD5}
      value:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Indicates whether a given value is a member of given array
      id: 58628dac-16e9-4180-8d50-ba9b57cf5a06
      iscommand: false
      name: Are there MD5 Hash Files ?
      script: IsValueInArray
      type: condition
      version: -1
    taskid: 58628dac-16e9-4180-8d50-ba9b57cf5a06
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 200,
          "y": -90
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "42"
      "yes":
      - "30"
      - "11"
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      array:
        complex:
          accessor: File_SHA256
          root: ExtractedIndicators
      value:
        complex:
          root: inputs.file
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Indicates whether a given value is a member of given array
      id: da2b1155-eb4d-4ab5-8225-d0a72e856c00
      iscommand: false
      name: Are there SHA256 Hash Files ?
      script: IsValueInArray
      type: condition
      version: -1
    taskid: da2b1155-eb4d-4ab5-8225-d0a72e856c00
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 690,
          "y": -90
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      using:
        simple: Crowdstrike Falcon v2.0_instance_1
      value:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Crowdstrike Falcon v2.0
      description: Searches for the IDs of indicators
      id: 2baa369e-62c3-4c7e-8a87-723fe11f359a
      iscommand: true
      name: Search For Hash In CS IOC Inventory
      script: Crowdstrike Falcon v2.0|||csfalcon-search-iocs
      type: regular
      version: -1
    taskid: 2baa369e-62c3-4c7e-8a87-723fe11f359a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 150
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: CrowdStrike
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.file
          operator: isEqualString
          right:
            iscontext: true
            value:
              complex:
                accessor: Value
                root: CrowdStrike.IOC
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b186e041-8bae-4ee1-8400-b777832880ca
      iscommand: false
      name: Is Hash Already Blocked ?
      type: condition
      version: -1
    taskid: b186e041-8bae-4ee1-8400-b777832880ca
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 200,
          "y": 340
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: CrowdStrike
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 0feeec70-a391-459a-8e48-de6be6de336c
      iscommand: false
      name: Delete CS Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 0feeec70-a391-459a-8e48-de6be6de336c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": -310
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      using:
        simple: Crowdstrike Falcon v2.0_instance_1
      value:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Crowdstrike Falcon v2.0
      description: Searches for the IDs of indicators
      id: cc4dc24d-7326-464c-8b1f-40db9b819eef
      iscommand: true
      name: Search For Hash In CS IOC Inventory
      script: Crowdstrike Falcon v2.0|||csfalcon-search-iocs
      type: regular
      version: -1
    taskid: cc4dc24d-7326-464c-8b1f-40db9b819eef
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 150
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: CrowdStrike
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.file
          operator: isEqualString
          right:
            iscontext: true
            value:
              complex:
                accessor: Value
                root: CrowdStrike.IOC
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6c875463-32a0-49c6-880f-78b9828a5cef
      iscommand: false
      name: Is Hash Already Blocked ?
      type: condition
      version: -1
    taskid: 6c875463-32a0-49c6-880f-78b9828a5cef
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 690,
          "y": 340
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "42"
      "yes":
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      id: 96fb33c7-3544-4b21-872f-b655bba3d2f5
      iscommand: false
      name: Did The Previous Task Encounter Error ?
      script: isError
      type: condition
      version: -1
    taskid: 96fb33c7-3544-4b21-872f-b655bba3d2f5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 700,
          "y": 780
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Bocked.Hash
      value:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 7c946bb6-757d-49ae-8898-f00e345c34f5
      iscommand: false
      name: Set Error IOC in Context
      script: Set
      type: regular
      version: -1
    taskid: 7c946bb6-757d-49ae-8898-f00e345c34f5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 930
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "42"
      "yes":
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      id: 6d55cead-982a-4048-8b8d-bdcc6531239c
      iscommand: false
      name: Did The Previous Task Encounter Error ?
      script: isError
      type: condition
      version: -1
    taskid: 6d55cead-982a-4048-8b8d-bdcc6531239c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 200,
          "y": 740
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Bocked.Hash
      value:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8e976edd-9096-4f4f-83a2-cafe5f110460
      iscommand: false
      name: Set Error IOC in Context
      script: Set
      type: regular
      version: -1
    taskid: 8e976edd-9096-4f4f-83a2-cafe5f110460
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 930
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: indicatorfile
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "19"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c6950b3b-5ecc-46c2-83f5-8a4fc3196827
      iscommand: false
      name: Is Indicator Context Set ?
      type: condition
      version: -1
    taskid: c6950b3b-5ecc-46c2-83f5-8a4fc3196827
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1540
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: indicatorfile
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 1305a6f9-47bb-4911-8df7-5d4b24494a4d
      iscommand: false
      name: Delete 'Indicator' Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 1305a6f9-47bb-4911-8df7-5d4b24494a4d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1750
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: indicatorfile.value=value::indicatorfile.tag=CustomFields.tags
      using:
        simple: InnerServicesModule
      value:
        complex:
          root: inputs.file
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 5702969c-a26d-46b9-8e79-544e25bea7a4
      iscommand: true
      name: Check If Indicator Exists
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 5702969c-a26d-46b9-8e79-544e25bea7a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1980
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: value
                root: indicatorfile
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 63e7f5f7-b4e8-4e9c-8daf-ba37aa48f5e3
      iscommand: false
      name: Found Indicator ?
      type: condition
      version: -1
    taskid: 63e7f5f7-b4e8-4e9c-8daf-ba37aa48f5e3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 510,
          "y": 2240
        }
      }
  "21":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicatorfile
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: CSPIPBlocked
      label: "yes"
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e36c6d6a-64a8-4042-8b84-812608b3c3e8
      iscommand: false
      name: Is This Indicator CSP Tagged ?
      type: condition
      version: -1
    taskid: e36c6d6a-64a8-4042-8b84-812608b3c3e8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 520,
          "y": 2500
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicatorfile
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9557f667-9fbc-4204-88c7-6b2ff6373d69
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: 9557f667-9fbc-4204-88c7-6b2ff6373d69
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 500,
          "y": 2680
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicatorfile.tag}
      indicatorsValues:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 3eecaf8f-4687-4034-8254-8420bb8f88b3
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 3eecaf8f-4687-4034-8254-8420bb8f88b3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 2960
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.file}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 7e39891d-7b0c-4b03-831e-d761d2be0475
      iscommand: true
      name: Add New CSP Tag
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 7e39891d-7b0c-4b03-831e-d761d2be0475
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 3170
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      execution-timeout:
        simple: "1000000"
      retry-count:
        simple: "3"
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: File
      value:
        simple: ${inputs.file}
      verdict:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 6f4e41d8-2a15-45ae-8adf-7d3bcb7da5d8
      iscommand: true
      name: Tag The Indicator With 'CSPIPBlocked'
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 6f4e41d8-2a15-45ae-8adf-7d3bcb7da5d8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -420,
          "y": 3420
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4326d01b-a7f9-48b3-8e0a-e5bf0d6ce64e
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: 4326d01b-a7f9-48b3-8e0a-e5bf0d6ce64e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 950,
          "y": 3880
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: CrowdStrike
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 07e23ff7-a06b-45e1-835b-0c5410ec3065
      iscommand: false
      name: Is CrowdStrike Context Defined ?
      type: condition
      version: -1
    taskid: 07e23ff7-a06b-45e1-835b-0c5410ec3065
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1140,
          "y": -510
        }
      }
  "28":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: CrowdStrike
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      - "5"
      "yes":
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 714fb909-4e9f-4821-8c63-c316d1e9b51f
      iscommand: false
      name: Is Custom CrowdStrike Context defined?
      type: condition
      version: -1
    taskid: 714fb909-4e9f-4821-8c63-c316d1e9b51f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": -530
        }
      }
  "30":
    continueonerror: true
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        simple: prevent
      description:
        simple: XSOAR  - ${incident.labels.Email/Header/Subject}
      ioc_type:
        simple: sha256
      platforms:
        simple: windows
      severity:
        simple: high
      using:
        simple: Crowdstrike Falcon v2.0_PCI_BPS_instance,Crowdstrike Falcon v2.0_instance_1
      value:
        complex:
          root: inputs.file
    separatecontext: false
    skipunavailable: false
    task:
      brand: Crowdstrike Falcon v2.0
      description: Uploads an indicator for CrowdStrike to block and monitor.
      id: 4484674d-6766-4e45-8e47-1b0fa6d829fc
      iscommand: true
      name: 'Add SHA256 File Hash For Blocking '
      script: Crowdstrike Falcon v2.0|||csfalcon-upload-ioc
      type: regular
      version: -1
    taskid: 4484674d-6766-4e45-8e47-1b0fa6d829fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 570
        }
      }
  "32":
    continueonerror: true
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        simple: prevent
      description:
        simple: XSOAR  - ${incident.labels.Email/Header/Subject}
      ioc_type:
        simple: md5
      platforms:
        simple: windows
      severity:
        simple: high
      using:
        simple: Crowdstrike Falcon v2.0_PCI_BPS_instance,Crowdstrike Falcon v2.0_instance_1
      value:
        complex:
          root: inputs.file
    separatecontext: false
    skipunavailable: false
    task:
      brand: Crowdstrike Falcon v2.0
      description: Uploads an indicator for CrowdStrike to block and monitor.
      id: 70149220-a2b4-4264-8e3d-b2d14d65e906
      iscommand: true
      name: 'Add MD5 File Hash For Blocking '
      script: Crowdstrike Falcon v2.0|||csfalcon-upload-ioc
      type: regular
      version: -1
    taskid: 70149220-a2b4-4264-8e3d-b2d14d65e906
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 570
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: certblockedhash
        - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: containsString
          right:
            value:
              simple: csocblockedhash
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expirystatus
                root: indicator
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 453230d4-6e4b-4980-8e93-a8739dcbf354
      iscommand: false
      name: Is This Hash Indicator CERT or CSOC Tagged ?
      type: condition
      version: -1
    taskid: 453230d4-6e4b-4980-8e93-a8739dcbf354
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2310,
          "y": 1960
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: File
      value:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 491af2a9-ae18-42a5-8cd9-600c457cce3e
      iscommand: true
      name: Create New CSP File Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 491af2a9-ae18-42a5-8cd9-600c457cce3e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2220,
          "y": 560
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.IOC}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: 4a4b88b5-19c7-4dfe-877d-da916f4cd578
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: 4a4b88b5-19c7-4dfe-877d-da916f4cd578
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 1000
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      index:
        complex:
          accessor: File
          root: ExtractedIndicators
          transformers:
          - args:
              fromLast: {}
              item:
                iscontext: true
                value:
                  simple: inputs.IOC
            operator: indexOf
      key:
        simple: ExtractedIndicators.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: d32af0cd-0ffa-498b-8ec5-679476696b5f
      iscommand: false
      name: Delete  File OC from context
      script: DeleteContext
      type: regular
      version: -1
    taskid: d32af0cd-0ffa-498b-8ec5-679476696b5f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2510,
          "y": 2730
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: tag
                root: indicator
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "39"
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f5fbb808-d34f-4d9c-81c0-d05b9295194e
      iscommand: false
      name: Is Indicator Tag Context Defined ?
      type: condition
      version: -1
    taskid: f5fbb808-d34f-4d9c-81c0-d05b9295194e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 2840
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${indicator.tag}
      indicatorsValues:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      id: 55da2102-c09f-45cf-84b5-2dba9ecc27ba
      iscommand: true
      name: Remove Old Tag
      script: Builtin|||removeIndicatorField
      type: regular
      version: -1
    taskid: 55da2102-c09f-45cf-84b5-2dba9ecc27ba
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 3025
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      expiration:
        simple: ${expirydate}
      tags:
        simple: CSPIOCBlocked
      value:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: a2e29d9b-8f0e-4dac-87c1-cf1350399006
      iscommand: true
      name: Add New CSP Tag to File and Set Expiry to 15 days
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: a2e29d9b-8f0e-4dac-87c1-cf1350399006
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 3195
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      creationdate:
        simple: ${ISOTimeNow}
      source:
        simple: ${incident.id}
      tags:
        simple: CSPIOCBlocked
      type:
        simple: File
      value:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: ae832c8f-34a6-4605-8a5a-5f97297c121f
      iscommand: true
      name: Create New CSP File Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: ae832c8f-34a6-4605-8a5a-5f97297c121f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -10,
          "y": 3140
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      expiration:
        simple: ${expirydate}
      indicatorsValues:
        simple: ${inputs.file}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: 30c0944b-f444-4535-8488-9837410e3731
      iscommand: true
      name: 'Set expiry date to 15 days '
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: 30c0944b-f444-4535-8488-9837410e3731
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -20,
          "y": 3470
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ead722ba-1dfc-47be-886f-00ec495d21b1
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: ead722ba-1dfc-47be-886f-00ec495d21b1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 770,
          "y": 1220
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      hash_list:
        simple: ${inputs.file}
      using:
        simple: Cortex XDR - IR_instance_BPS,Cortex XDR - IR_instance_Corp
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex XDR - IR
      description: Block lists requested files which have not already been block listed
        or added to allow lists.
      id: 64fbe16b-4341-415c-882b-1686b9e2d7e9
      iscommand: true
      name: Add hash for blocking on XDR
      script: Cortex XDR - IR|||xdr-blocklist-files
      type: regular
      version: -1
    taskid: 64fbe16b-4341-415c-882b-1686b9e2d7e9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 590
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "13_14_yes": 0.5,
      "15_16_yes": 0.46
    },
    "paper": {
      "dimensions": {
        "height": 4685,
        "width": 4030,
        "x": -1140,
        "y": -740
      }
    }
  }
