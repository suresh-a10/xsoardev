contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
hidden: true
id: a78b485d-7829-4778-8987-eade8a9114fa
inputs: []
name: TCS - Critical Crowdstrike File Fired
outputs: []
sourceplaybookid: 0ef0b708-4d20-4d40-8cef-d70d7d374941
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e0ea4dc6-abdf-4e84-83bb-98e5bc2f0571
      iscommand: false
      name: ""
      version: -1
    taskid: e0ea4dc6-abdf-4e84-83bb-98e5bc2f0571
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 170,
          "y": 350
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        simple: ${CrowdStrike.Device.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Lifts containment on the host, which returns its network communications
        to normal.
      id: 46e4a7c9-795b-4ea8-8788-e3809b875061
      iscommand: true
      name: lift host containment
      script: CrowdstrikeFalcon|||cs-falcon-lift-host-containment
      type: regular
      version: -1
    taskid: 46e4a7c9-795b-4ea8-8788-e3809b875061
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 170,
          "y": 1700
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        simple: ${QRadar.Search.Result.events.hostname}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Searches for a device that matches the query.
      id: 2b072e31-a35f-46eb-8973-e167a95818dd
      iscommand: true
      name: Get Host ID  from Crowdstrike
      script: CrowdstrikeFalcon|||cs-falcon-search-device
      type: regular
      version: -1
    taskid: 2b072e31-a35f-46eb-8973-e167a95818dd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 170,
          "y": 760
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      ids:
        simple: ${CrowdStrike.Device.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Contains or lifts containment for a specified host. When contained,
        a host can only communicate with the CrowdStrike cloud and any IPs specified
        in your containment policy.
      id: c4f878c8-e5f8-4f3e-881d-0d665a22e27c
      iscommand: true
      name: Contain Host
      script: CrowdstrikeFalcon|||cs-falcon-contain-host
      type: regular
      version: -1
    taskid: c4f878c8-e5f8-4f3e-881d-0d665a22e27c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 170,
          "y": 1080
        }
      }
  "13":
    continueonerrortype: ""
    form:
      description: |2+

      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Critical Host is contain through Demisto
        options:
        - "Yes"
        - "No"
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Critical Host is contain through Demisto
      totalanswers: 0
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: {}
      cc: null
      format: ""
      methods:
      - email
      subject:
        simple: Critical host is contain ${CrowdStrike.Device.Hostname}
      timings:
        completeafterreplies: 0
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 60
      to:
        simple: v.ghule@tcs.com,InternalIs.CyberSecurityOps@tcs.com,kunal.krushev@tcs.com
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    sla:
      days: 0
      hours: 1
      minutes: 0
      weeks: 0
    task:
      brand: ""
      id: b8cc0ccf-3779-42dd-8230-19283b1f6b84
      iscommand: false
      name: 'Notify  Analyst/Operator_lead  for this host containment '
      type: collection
      version: -1
    taskid: b8cc0ccf-3779-42dd-8230-19283b1f6b84
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 170,
          "y": 1230
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Permission to proceed with containment.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Permission to proceed with containment.Answers
          operator: isEqualString
          right:
            value:
              simple: "No"
      label: "no"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8c742e5e-6e1f-48be-870f-4d19e2b90688
      iscommand: false
      name: Check Approval
      type: condition
      version: -1
    taskid: 8c742e5e-6e1f-48be-870f-4d19e2b90688
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -220,
          "y": 1605
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fce15036-dd24-4281-85c0-84687ea4860d
      iscommand: false
      name: Close incident
      type: title
      version: -1
    taskid: fce15036-dd24-4281-85c0-84687ea4860d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 170,
          "y": 1910
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: "Dear Team,\nWe found Critical alert on ${CrowdStrike.Device.Hostname}
          \ host so we have contained the system . \n\nAlert Details:\nHostname: ${CrowdStrike.Device.Hostname}\nFirst
          Seen: ${CrowdStrike.Device.FirstSeen}\nExternal IP: ${CrowdStrike.Device.ExternalIP}\nLocalIP:
          ${CrowdStrike.Device.LocalIP}\n \nThanks & Regards,\nInternalIs CyberSecurityOps\n\n"
      subject:
        simple: Critical alert host contained_${CrowdStrike.Device.Hostname}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: a5e878da-fbb0-471d-8d63-f5badffacb5e
      iscommand: true
      name: Send mail to IS team/User
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: a5e878da-fbb0-471d-8d63-f5badffacb5e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 170,
          "y": 1385
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e702229c-f9a6-41c9-820a-dd6a75a125ce
      iscommand: false
      name: 'Manually review incident/Add comment '
      type: regular
      version: -1
    taskid: e702229c-f9a6-41c9-820a-dd6a75a125ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 170,
          "y": 1540
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: select hostname,username from events where INOFFENSE(${incident.labels.id})
          and (Hostname IS NOT NULL OR username IS NOT NULL)  LAST 192 HOURS
      timeout:
        simple: "900"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: 23cfa2af-8b56-4a15-83f3-e5db85861eca
      iscommand: false
      name: QRadarFullSearch
      playbookId: QRadarFullSearch
      type: playbook
      version: -1
    taskid: 23cfa2af-8b56-4a15-83f3-e5db85861eca
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 170,
          "y": 470
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: CrowdStrike.Device.Hostname
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4735a733-0988-4d93-81f3-3b13a883ad2a
      iscommand: false
      name: Check if Hostname is exist
      type: condition
      version: -1
    taskid: 4735a733-0988-4d93-81f3-3b13a883ad2a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 170,
          "y": 910
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: QRadar.Search.Result.events.hostname
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar_cpy
      description: Gets search results
      id: 6f51e70a-5390-493d-861f-6416a1a8ddc7
      iscommand: false
      name: Check QRadra search results
      type: condition
      version: -1
    taskid: 6f51e70a-5390-493d-861f-6416a1a8ddc7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 170,
          "y": 610
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1625,
        "width": 770,
        "x": -220,
        "y": 350
      }
    }
  }
