contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: c66d466f-3504-425d-8bf3-5732f6a10174
inputs: []
name: TCS-Zscaler autofetch indicators-KR_V1.0
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 52b49951-7a4c-4d69-8f62-6e8a42f7c02a
      iscommand: false
      name: ""
      version: -1
    taskid: 52b49951-7a4c-4d69-8f62-6e8a42f7c02a
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -790,
          "y": -50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      method:
        simple: GET
      proxy:
        simple: "true"
      url:
        simple: https://config.zscaler.com/api/zscaler.net/future/json
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends http request. Returns the response as json.
      id: 11328348-bd29-40ec-88bc-f1c5beddd309
      iscommand: false
      name: Get indicators from json 1(Zscaler Aggregate IP Address Ranges)
      script: http
      type: regular
      version: -1
    taskid: 11328348-bd29-40ec-88bc-f1c5beddd309
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 180
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      ignore-outputs:
        simple: "false"
      text:
        simple: ${HttpRequest.Response.Body}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 3edea219-a61e-4191-8efd-ce230108bd7d
      iscommand: true
      name: Extract Indicators from context
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 3edea219-a61e-4191-8efd-ce230108bd7d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 360
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Zscaler
      value:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 70dd67fa-2430-4459-879c-2ebae2557b9d
      iscommand: false
      name: 'Set  common context for IP '
      script: Set
      type: regular
      version: -1
    taskid: 70dd67fa-2430-4459-879c-2ebae2557b9d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 540
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      method:
        simple: GET
      proxy:
        simple: "true"
      url:
        simple: https://config.zscaler.com/api/zscaler.net/cenr/json
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends http request. Returns the response as json.
      id: 4574777d-4fb7-4a55-8fff-de31f5297841
      iscommand: false
      name: Get indicators from json 2(BPS\PCI)
      script: http
      type: regular
      version: -1
    taskid: 4574777d-4fb7-4a55-8fff-de31f5297841
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": 160
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      method:
        simple: GET
      proxy:
        simple: "true"
      url:
        simple: https://config.zscaler.com/api/zscalerthree.net/cenr/json
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends http request. Returns the response as json.
      id: c3b51a02-627a-4b87-8433-eefb3b862054
      iscommand: false
      name: Get indicators from json 3(Corp)
      script: http
      type: regular
      version: -1
    taskid: c3b51a02-627a-4b87-8433-eefb3b862054
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 180
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      method:
        simple: GET
      proxy:
        simple: "true"
      url:
        simple: https://config.zscaler.com/api/private.zscaler.com/zpa/json
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends http request. Returns the response as json.
      id: 0ab8ff9e-b606-4a38-8354-b6059178fc1d
      iscommand: false
      name: Get indicators from json 4(ZPA broker IPs)
      script: http
      type: regular
      version: -1
    taskid: 0ab8ff9e-b606-4a38-8354-b6059178fc1d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 170
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${HttpRequest.Response.Body}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: d6e8f27a-9a73-4529-89b7-703770687aee
      iscommand: true
      name: Extract indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: d6e8f27a-9a73-4529-89b7-703770687aee
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": 370
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${HttpRequest.Response.Body}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 7c02695a-bfd2-4ee9-885d-51670559cd1f
      iscommand: true
      name: Extract indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 7c02695a-bfd2-4ee9-885d-51670559cd1f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 370
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${HttpRequest.Response.Body}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 29ae3121-ab6f-412e-898c-7c29b421593b
      iscommand: true
      name: Extract indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 29ae3121-ab6f-412e-898c-7c29b421593b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 380
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Zscaler
      value:
        complex:
          accessor: CIDR
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: fad11e96-a9ef-4aab-8003-694078f56ec7
      iscommand: false
      name: set common context for CIDR
      script: Set
      type: regular
      version: -1
    taskid: fad11e96-a9ef-4aab-8003-694078f56ec7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 730
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ExtractedIndicators,HttpRequest
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: b1dec0df-ef1a-4806-8f6f-53d7a05c33c7
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: b1dec0df-ef1a-4806-8f6f-53d7a05c33c7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 910
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Zscaler
      value:
        complex:
          accessor: CIDR
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 091b7799-c4c5-4783-867f-0e5f42c7b956
      iscommand: false
      name: set common context for CIDR
      script: Set
      type: regular
      version: -1
    taskid: 091b7799-c4c5-4783-867f-0e5f42c7b956
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": 705
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Zscaler
      value:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 1689c6dd-5a65-4698-8b8a-06a502bc9b44
      iscommand: false
      name: 'Set  common context for IP '
      script: Set
      type: regular
      version: -1
    taskid: 1689c6dd-5a65-4698-8b8a-06a502bc9b44
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": 540
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ExtractedIndicators,HttpRequest
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: dba97bd3-0701-4b28-877f-78ae29e9fe39
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: dba97bd3-0701-4b28-877f-78ae29e9fe39
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -250,
          "y": 880
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: Zscaler
          transformers:
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      listName:
        simple: Zscaler autofetch indicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 554415c6-219d-45a6-8629-d4c36891da84
      iscommand: true
      name: Setlist
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 554415c6-219d-45a6-8629-d4c36891da84
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1140
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Zscaler
      value:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 58d8e104-d2f9-4670-80cd-ec0c018b1d3f
      iscommand: false
      name: 'Set  common context for IP '
      script: Set
      type: regular
      version: -1
    taskid: 58d8e104-d2f9-4670-80cd-ec0c018b1d3f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 550
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Zscaler
      value:
        complex:
          accessor: CIDR
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f3cb7e13-9348-4a72-8b60-e57445576689
      iscommand: false
      name: set common context for CIDR
      script: Set
      type: regular
      version: -1
    taskid: f3cb7e13-9348-4a72-8b60-e57445576689
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 715
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ExtractedIndicators,HttpRequest
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: dad0bb2b-7aa6-468d-8240-7be5b072f6ef
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: dad0bb2b-7aa6-468d-8240-7be5b072f6ef
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 260,
          "y": 910
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Zscaler
      value:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 65c96c2f-e22d-41f9-8e4a-6350caf75f0d
      iscommand: false
      name: 'Set  common context for IP '
      script: Set
      type: regular
      version: -1
    taskid: 65c96c2f-e22d-41f9-8e4a-6350caf75f0d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 560
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Zscaler
      value:
        complex:
          accessor: CIDR
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2ef49e70-ccdd-4030-828e-d8b58df1005f
      iscommand: false
      name: set common context for CIDR
      script: Set
      type: regular
      version: -1
    taskid: 2ef49e70-ccdd-4030-828e-d8b58df1005f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 730
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ExtractedIndicators,HttpRequest
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 5d222e26-687b-4992-8ad5-e33306a97ae7
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 5d222e26-687b-4992-8ad5-e33306a97ae7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 920
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          Hi Team,

                  Zcaler Ip's fetched and updated successfully in list

          Regards,
          Cyberbot
      subject:
        simple: Zscaler-Autofetch indicators
      to:
        simple: keerthana.ramesh@tcs.com,porkodi.g@tcs.com.komal.lugade@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: c29cfd9c-f602-45ae-8403-937a49dad13c
      iscommand: true
      name: Send Mail to Team
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: c29cfd9c-f602-45ae-8403-937a49dad13c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1320
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b3ce3bc3-3df3-4c81-86f1-a70614326e46
      iscommand: false
      name: End
      type: title
      version: -1
    taskid: b3ce3bc3-3df3-4c81-86f1-a70614326e46
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1700
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: b71ab953-d55f-491b-8d84-cef43f62e3ce
      iscommand: true
      name: Closeinvestigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: b71ab953-d55f-491b-8d84-cef43f62e3ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 740,
          "y": 1510
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1815,
        "width": 1910,
        "x": -790,
        "y": -50
      }
    }
  }
