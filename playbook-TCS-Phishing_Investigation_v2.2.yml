contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: |-
  Use this playbook to investigate and remediate a potential phishing incident. The playbook simultaneously engages with the user that triggered the incident, while investigating the incident itself.

  The final remediation tasks are always decided by a human analyst.
id: bcc7815c-6e7c-46de-8576-6d5ffc12fc85
inputs:
- description: The default role to assign the incident to.
  key: Role
  playbookInputQuery: null
  required: true
  value:
    simple: Administrator
- description: |-
    Enable the "Search and Delete" capability (can be either "True" or "False").
    In case of a malicious email, the "Search and Delete" sub-playbook will look for other instances of the email and delete them pending analyst approval.
  key: SearchAndDelete
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: |-
    Enable the "Block Indicators" capability (can be either "True" or "False").
    In case of a malicious email, the "Block Indicators" sub-playbook will block all malicious indicators in the relevant integrations.
  key: BlockIndicators
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Whether the authenticity of the email should be verified, using SPF,
    DKIM and DMARC.
  key: AuthenticateEmail
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
name: TCS-Phishing Investigation v2.2
outputs: []
sourceplaybookid: Phishing Investigation - Generic v2
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 52819f68-ee8c-4ab7-8e90-f6ff2d61c148
      iscommand: false
      name: ""
      version: -1
    taskid: 52819f68-ee8c-4ab7-8e90-f6ff2d61c148
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 7.5,
          "y": -940
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Name
          root: Domain
          transformers:
          - operator: uniq
      Email:
        complex:
          accessor: Email.Address
          root: Account
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: f4e3f27a-fd5f-4e73-8f25-320575f3fd6f
      iscommand: false
      name: Email Address Enrichment - Generic v2.1
      playbookId: Email Address Enrichment - Generic v2.1
      type: playbook
      version: -1
    taskid: f4e3f27a-fd5f-4e73-8f25-320575f3fd6f
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 1720
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "97"
      - "98"
      - "99"
      - "118"
      - "119"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e6c8144-e6a3-4866-8076-30d7208c1c67
      iscommand: false
      name: Indicator Enrichment
      type: title
      version: -1
    taskid: 1e6c8144-e6a3-4866-8076-30d7208c1c67
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -442.5,
          "y": 580
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "121"
      - "52"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      text:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Email.HTML
              operator: isNotEmpty
          root: Email.HTML
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: a6757c47-128f-4c28-8dd1-c63f54a8a111
      iscommand: true
      name: Extract Indicators From Email Body
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: a6757c47-128f-4c28-8dd1-c63f54a8a111
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -442.5,
          "y": 225
        }
      }
  "96":
    continueonerrortype: ""
    id: "96"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "120"
    note: false
    quietmode: 0
    scriptarguments:
      File:
        complex:
          root: File
      Interval:
        simple: "1"
      Timeout:
        simple: "15"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Detonate one or more files using the Wildfire integration. This playbook
        returns relevant reports to the War Room and file reputations to the context data.
        The detonation supports the following file types -
        APK, JAR, DOC, DOCX, RTF, XLS, XLSX, PPT, PPTX, OOXML, PE32, PDF, DMG, PKG, RAR, 7Z
      id: b3cdbf2d-ec75-4daa-8e67-f0cadaede7a3
      iscommand: false
      name: TCS-Detonate File v2.1
      playbookId: d3596cd5-648f-40d2-8cc9-5829b6672242
      type: playbook
      version: -1
    taskid: b3cdbf2d-ec75-4daa-8e67-f0cadaede7a3
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1455
        }
      }
  "97":
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      Hash:
        complex:
          accessor: File
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a489543e-f4af-49a9-8217-a98424fdf93d
      iscommand: false
      name: TCS-Recorded Future IOC Enrichment Playbook v 1.0
      playbookId: 1328b1fc-695e-4f06-8272-d3223a7640c2
      type: playbook
      version: -1
    taskid: a489543e-f4af-49a9-8217-a98424fdf93d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -720,
          "y": 790
        }
      }
  "98":
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9854b209-be22-46c7-8299-870e9ed1218b
      iscommand: false
      name: TCS-Cisco Umbrella  IOC Enrichment Playbook v 1.0
      playbookId: 801a53c2-3def-4a8d-811e-97ddfb6d0f99
      type: playbook
      version: -1
    taskid: 9854b209-be22-46c7-8299-870e9ed1218b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -160,
          "y": 790
        }
      }
  "99":
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      Hash:
        complex:
          accessor: File
          root: ExtractedIndicators
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 993aa7df-2a13-447f-8d6e-c35f2786e54a
      iscommand: false
      name: TCS-Auto Focus IOC Enrichment Playbook v 1.0
      playbookId: ff9792aa-d59f-4a0d-8cf4-d23be764eed7
      type: playbook
      version: -1
    taskid: 993aa7df-2a13-447f-8d6e-c35f2786e54a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -720,
          "y": 1010
        }
      }
  "102":
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "131"
      "yes":
      - "122"
      - "137"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the investigation found any malicious indicators (file,
        URL, IP address, domain, or email). Returns "yes" if at least one malicious
        indicator is found.
      id: fbef534f-77ef-42ea-86aa-a2f6c1c41ed1
      iscommand: false
      name: Are Indicators Malicious
      script: IsMaliciousIndicatorFound
      type: condition
      version: -1
    taskid: fbef534f-77ef-42ea-86aa-a2f6c1c41ed1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -410,
          "y": 1625
        }
      }
  "104":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: File
                root: Attachment
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "131"
      "yes":
      - "107"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c356d79b-5f24-4965-8497-c6068be27ce6
      iscommand: false
      name: Is There an Attachment in The Email ?
      type: condition
      version: -1
    taskid: c356d79b-5f24-4965-8497-c6068be27ce6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 470,
          "y": 580
        }
      }
  "107":
    continueonerrortype: ""
    id: "107"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "108"
      - "114"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      file:
        complex:
          accessor: SHA256
          root: Attachment.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future v2
      description: Gets a quick indicator of the risk associated with a file.
      id: f03c9067-7f23-474a-83e0-2b1260a3fe14
      iscommand: true
      name: Check Attachment Risk Score In Recorded Future
      script: Recorded Future v2|||file
      type: regular
      version: -1
    taskid: f03c9067-7f23-474a-83e0-2b1260a3fe14
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 800
        }
      }
  "108":
    continueonerrortype: ""
    id: "108"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "112"
      "no":
      - "96"
      "yes":
      - "127"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the investigation found any malicious indicators (file,
        URL, IP address, domain, or email). Returns "yes" if at least one malicious
        indicator is found.
      id: 389993a6-bd1f-4c69-8dd2-7c659f591bf8
      iscommand: false
      name: Attachment Found Malicious ?
      script: IsMaliciousIndicatorFound
      type: condition
      version: -1
    taskid: 389993a6-bd1f-4c69-8dd2-7c659f591bf8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1020
        }
      }
  "110":
    continueonerrortype: ""
    id: "110"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "111"
    note: false
    quietmode: 0
    scriptarguments:
      hash:
        complex:
          accessor: SHA256
          root: WildFire.Report
    separatecontext: false
    skipunavailable: false
    task:
      brand: WildFire-v2
      description: Returns a verdict for a hash.
      id: e614fff0-5d72-4857-8f3e-15d8e4fb64b8
      iscommand: true
      name: Get WildFire Report Verdict
      script: WildFire-v2|||wildfire-get-verdict
      type: regular
      version: -1
    taskid: e614fff0-5d72-4857-8f3e-15d8e4fb64b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1850
        }
      }
  "111":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: VerdictDescription
                root: WildFire.Verdicts
          operator: isEqualString
          right:
            value:
              simple: benign
      label: Benign
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: VerdictDescription
                root: WildFire.Verdicts
          operator: isEqualString
          right:
            value:
              simple: malicious
      label: Malicious
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "112"
      Benign:
      - "131"
      Malicious:
      - "125"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e29e7097-93a3-4223-80df-7c6f40197240
      iscommand: false
      name: Is The WildFire Report Verdict Benign or Malicious?
      type: condition
      version: -1
    taskid: e29e7097-93a3-4223-80df-7c6f40197240
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 470,
          "y": 2020
        }
      }
  "112":
    continueonerrortype: ""
    id: "112"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "145"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ac350b63-c04a-4311-8d25-11de40156c22
      iscommand: false
      name: Generate Report & Notify
      type: title
      version: -1
    taskid: ac350b63-c04a-4311-8d25-11de40156c22
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 890,
          "y": 2470
        }
      }
  "113":
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "131"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          Hello Human,

          I found a suspicious email reported by user - ${incident.labels.Email/from}

          Following are the investigation findings:

          Suspicious Email Sent By: ${Email.From}

          Email subject: ${Email.Subject}

          Malicious attachment hash: ${Malicious.Attachment}

          XSOAR investigation Id : ${incident.id}


          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: kunal.krushev@tcs.com,jha.sweta1@tcs.com,yogesh.gholap@tcs.com,nimisha.prajapati@tcs.com
      subject:
        simple: Found Suspicious Email Reported By User - ${incident.labels.Email/from}
      to:
        simple: internalis.cybersecurityops@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 17d8237d-838b-41c8-855b-78c87b53b270
      iscommand: true
      name: Notify Suspicious Email With Attachment
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 17d8237d-838b-41c8-855b-78c87b53b270
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": 3160
        }
      }
  "114":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.File
          operator: greaterThan
          right:
            value:
              simple: "24"
      label: "yes"
    continueonerrortype: ""
    id: "114"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "108"
      "yes":
      - "126"
      - "140"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the investigation found any malicious indicators (file,
        URL, IP address, domain, or email). Returns "yes" if at least one malicious
        indicator is found.
      id: 3e10408d-62a0-45f2-80fe-45537c98ee88
      iscommand: false
      name: Is Risk Score Greater Than 24 ?
      type: condition
      version: -1
    taskid: 3e10408d-62a0-45f2-80fe-45537c98ee88
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1020
        }
      }
  "117":
    continueonerrortype: ""
    id: "117"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "131"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          Hello Human,

          I found a suspicious email reported by user - ${incident.labels.Email/from}

          Following are the investigation findings:

          Suspicious Email Sent By: ${Email.From}

          Email subject: ${Email.Subject}

          Malicious IOC: ${Malicious.IOC}

          XSOAR investigation Id : ${incident.id}

          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: kunal.krushev@tcs.com,jha.sweta1@tcs.com,yogesh.gholap@tcs.com,nimisha.prajapati@tcs.com
      subject:
        simple: Found Suspicious Email Reported By User - ${incident.labels.Email/from}
      to:
        simple: internalis.cybersecurityops@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: f9548ec9-4b45-4fe5-82ed-461eeda34bb2
      iscommand: true
      name: Notify Suspicious Email Found
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: f9548ec9-4b45-4fe5-82ed-461eeda34bb2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 3160
        }
      }
  "118":
    continueonerror: true
    continueonerrortype: ""
    id: "118"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: OpenPhish_v2
      description: Checks the reputation of a URL.
      id: 08110611-34df-47d5-86d9-8159bf11873f
      iscommand: true
      name: Check if Known Phishing URL Using OpenPhish Data
      script: OpenPhish_v2|||url
      type: regular
      version: -1
    taskid: 08110611-34df-47d5-86d9-8159bf11873f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -160,
          "y": 1010
        }
      }
  "119":
    continueonerror: true
    continueonerrortype: ""
    id: "119"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        complex:
          accessor: URL
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: PhishTank V2
      description: Checks the reputation of the supplied URLs.
      id: c5995258-202c-492b-82dd-87e047b0b014
      iscommand: true
      name: Check if Known  Phishing URL Using PhishTank Data
      script: PhishTank V2|||url
      type: regular
      version: -1
    taskid: c5995258-202c-492b-82dd-87e047b0b014
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -710,
          "y": 1210
        }
      }
  "120":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: SHA256
                root: WildFire.Report
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "112"
      "yes":
      - "110"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8916288b-1298-48c8-8c21-97b5231fdfb6
      iscommand: false
      name: Is There a WildFire Report?
      type: condition
      version: -1
    taskid: 8916288b-1298-48c8-8c21-97b5231fdfb6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1640
        }
      }
  "121":
    continueonerror: true
    continueonerrortype: ""
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      emailBodyHTML:
        simple: ${Email.HTML}
      emailSubject:
        simple: ${Email.Subject}
      retry-count:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Predict phishing incidents using the out-of-the-box pre-trained
        model.
      id: ccdd61ad-49a5-4e6e-86ec-cbb4797af46f
      iscommand: false
      name: DBot Predict Phishing
      script: DBotPredictOutOfTheBoxV2
      type: regular
      version: -1
    taskid: ccdd61ad-49a5-4e6e-86ec-cbb4797af46f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -442.5,
          "y": 385
        }
      }
  "122":
    continueonerrortype: ""
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Malicious.IOC
      value:
        complex:
          accessor: Indicator
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: isEqualString
              right:
                value:
                  simple: "3"
          root: DBotScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: db1ec0b5-d39a-4d28-8e2e-c42ea7076b8e
      iscommand: false
      name: Set Context Key For Malicious IOC
      script: Set
      type: regular
      version: -1
    taskid: db1ec0b5-d39a-4d28-8e2e-c42ea7076b8e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -410,
          "y": 1830
        }
      }
  "123":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOC
                root: Malicious
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Attachment
                root: Malicious
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "123"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "131"
      "yes":
      - "124"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a634665a-fd38-4c5a-826a-09dfc713c562
      iscommand: false
      name: Check If Malicious Indicators Were Detected  In Email Body & Attachment
        Is Malicious
      type: condition
      version: -1
    taskid: a634665a-fd38-4c5a-826a-09dfc713c562
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2920
        }
      }
  "124":
    continueonerrortype: ""
    id: "124"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "131"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          Hello Human,

          I found a suspicious email reported by user - ${incident.labels.Email/from}

          Following are the investigation findings:

          Suspicious Email Sent By: ${Email.From}

          Email subject: ${Email.Subject}

          Malicious attachment hash: ${Malicious.Attachment}

          Malicious IOCs found in the email body: ${Malicious.IOC}

          XSOAR investigation Id : ${incident.id}


          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: kunal.krushev@tcs.com,jha.sweta1@tcs.com,yogesh.gholap@tcs.com,nimisha.prajapati@tcs.com
      subject:
        simple: Found Suspicious Email Reported By User - ${incident.labels.Email/from}
      to:
        simple: internalis.cybersecurityops@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: f9405901-d26d-4a75-8aa6-49411187e970
      iscommand: true
      name: Notify Suspicious Email With Attachment
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: f9405901-d26d-4a75-8aa6-49411187e970
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3160
        }
      }
  "125":
    continueonerrortype: ""
    id: "125"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Malicious.Attachment
      value:
        complex:
          accessor: SHA256
          filters:
          - - left:
                iscontext: true
                value:
                  simple: WildFire.Verdicts.VerdictDescription
              operator: isNotEqualString
              right:
                value:
                  simple: benign
          root: WildFire.Verdicts
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 2ddc4696-4366-40e2-8c15-a15375670788
      iscommand: false
      name: Set Context Key For Malicious Attachment Hash
      script: Set
      type: regular
      version: -1
    taskid: 2ddc4696-4366-40e2-8c15-a15375670788
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 2300
        }
      }
  "126":
    continueonerrortype: ""
    id: "126"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Malicious.Attachment
      value:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: RecordedFuture.File.riskScore
              operator: greaterThan
              right:
                value:
                  simple: "24"
          root: RecordedFuture.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9e156ea9-3055-4753-8143-df6f1d20094a
      iscommand: false
      name: Set Context Key For Malicious Attachment
      script: Set
      type: regular
      version: -1
    taskid: 9e156ea9-3055-4753-8143-df6f1d20094a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 1455
        }
      }
  "127":
    continueonerrortype: ""
    id: "127"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Malicious.Attachment
      value:
        complex:
          accessor: Indicator
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: isEqualString
              right:
                value:
                  simple: "3"
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Vendor
              operator: isEqualString
              right:
                value:
                  simple: Recorded Future v2
          root: DBotScore
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 38990582-774c-4d29-8240-5f1ae2c6f11c
      iscommand: false
      name: Set Context Key For Malicious Attachment
      script: Set
      type: regular
      version: -1
    taskid: 38990582-774c-4d29-8240-5f1ae2c6f11c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": 1455
        }
      }
  "128":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Attachment
                root: Malicious
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOC
                root: Malicious
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "128"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "131"
      "yes":
      - "117"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 03707a1e-2844-474f-8f88-ca74dd8adf73
      iscommand: false
      name: Check If Only Malicious IOCs Were Detected  In Email Body
      type: condition
      version: -1
    taskid: 03707a1e-2844-474f-8f88-ca74dd8adf73
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 430,
          "y": 2920
        }
      }
  "129":
    continueonerrortype: ""
    id: "129"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "102"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 53fbd0f4-7899-48d1-8d1c-adea352a67be
      iscommand: false
      name: Check If Indicator Is Malicious
      type: title
      version: -1
    taskid: 53fbd0f4-7899-48d1-8d1c-adea352a67be
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -410,
          "y": 1440
        }
      }
  "130":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Attachment
                root: Malicious
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOC
                root: Malicious
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "130"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "131"
      "yes":
      - "113"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 12d11bf6-beb7-4746-835d-60568a7a3066
      iscommand: false
      name: Check If Only  Malicious Attachments Found
      type: condition
      version: -1
    taskid: 12d11bf6-beb7-4746-835d-60568a7a3066
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 890,
          "y": 2920
        }
      }
  "131":
    continueonerrortype: ""
    id: "131"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "147"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ac86f9f4-b17a-477c-8c67-353ee12cd75b
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
    taskid: ac86f9f4-b17a-477c-8c67-353ee12cd75b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 7.5,
          "y": 3660
        }
      }
  "132":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Label
                root: DBotPredictPhishingWords
          operator: isEqualString
          right:
            value:
              simple: malicious
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IOC
                root: Malicious
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Attachment
                root: Malicious
          operator: isNotExists
      label: "yes"
    continueonerrortype: ""
    id: "132"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "131"
      "yes":
      - "133"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: babb2772-c3a0-4392-8844-b32a35283ae7
      iscommand: false
      name: Check If Malicious Indicators Were Detected  In Email Body & Attachment
        Is Malicious
      type: condition
      version: -1
    taskid: babb2772-c3a0-4392-8844-b32a35283ae7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 2920
        }
      }
  "133":
    continueonerrortype: ""
    id: "133"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "131"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      bcc:
        simple: kunal.krushev@tcs.com
      body:
        simple: |-
          Hello Human,

          My machine learning algorithm  found a suspected malicious email reported by user - ${incident.labels.Email/from}

          Following are the investigation findings:

          Suspicious Email Sent By: ${Email.From}

          Email subject: ${Email.Subject}

          XSOAR investigation Id : ${incident.id}


          Regards,
          CSOC Cyber AutoBot
      cc:
        simple: kunal.krushev@tcs.com,jha.sweta1@tcs.com,yogesh.gholap@tcs.com,nimisha.prajapati@tcs.com
      subject:
        simple: Found Suspicious Email Reported By User - ${incident.labels.Email/from}
      to:
        simple: internalis.cybersecurityops@tcs.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: b6c9703a-59cd-412e-85c3-f8a1470e1584
      iscommand: true
      name: Notify Suspicious Email With Attachment
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: b6c9703a-59cd-412e-85c3-f8a1470e1584
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 3160
        }
      }
  "134":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: AttachmentNames
                root: Email
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: AttachmentNames
                root: Email
          operator: isNotEmpty
      label: "Yes"
    continueonerrortype: ""
    id: "134"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "131"
      "Yes":
      - "135"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 7e2bc8ce-4e74-4093-82c5-92ad3609fe58
      iscommand: false
      name: 'Is There an Attachment In The Reported Email ? '
      type: condition
      version: -1
    taskid: 7e2bc8ce-4e74-4093-82c5-92ad3609fe58
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 470,
          "y": 70
        }
      }
  "135":
    continueonerrortype: ""
    id: "135"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "104"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Attachment.File
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Info
              operator: notContainsGeneral
              right:
                value:
                  simple: msg,eml
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isNotEqualString
              right:
                value:
                  simple: email.png
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 45b2fe1e-3896-412b-80c1-613294bdd636
      iscommand: false
      name: Set Attachment Info To Context Field
      script: Set
      type: regular
      version: -1
    taskid: 45b2fe1e-3896-412b-80c1-613294bdd636
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 470,
          "y": 370
        }
      }
  "136":
    continueonerrortype: ""
    id: "136"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "153"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "1"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: c23ca1ef-94b4-4cc8-817e-62157dd04cd2
      iscommand: true
      name: Set Incident Severity Low
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: c23ca1ef-94b4-4cc8-817e-62157dd04cd2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 7.5,
          "y": -500
        }
      }
  "137":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Score
                root: DBotScore
          operator: isEqualNumber
          right:
            value:
              simple: "2"
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: DBotScore.Score
                    operator: isEqualString
                    right:
                      value:
                        simple: "3"
                root: DBotScore.Score
          operator: isNotExists
      label: High
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Score
                root: DBotScore
          operator: isEqualNumber
          right:
            value:
              simple: "3"
      label: Critical
    continueonerrortype: ""
    id: "137"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "112"
      Critical:
      - "144"
      High:
      - "139"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      id: cfc0d6a6-476f-4344-8517-a9b4eb24011a
      iscommand: false
      name: 'Check Risk Score To Set Severity '
      type: condition
      version: -1
    taskid: cfc0d6a6-476f-4344-8517-a9b4eb24011a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -822.5,
          "y": 1830
        }
      }
  "139":
    continueonerrortype: ""
    id: "139"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "3"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 199d7a3b-a6a6-4a7f-81df-cac957693fdb
      iscommand: true
      name: Set Severity High
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 199d7a3b-a6a6-4a7f-81df-cac957693fdb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -822.5,
          "y": 2040
        }
      }
  "140":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.File
          operator: greaterThan
          right:
            value:
              simple: "24"
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.File
          operator: lessThan
          right:
            value:
              simple: "65"
      label: Medium
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.File
          operator: greaterThan
          right:
            value:
              simple: "65"
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.File
          operator: lessThan
          right:
            value:
              simple: "90"
      label: High
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: riskScore
                root: RecordedFuture.File
          operator: greaterThan
          right:
            value:
              simple: "89"
      label: Critical
    continueonerrortype: ""
    id: "140"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "112"
      Critical:
      - "142"
      High:
      - "141"
      Medium:
      - "143"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      id: c289bf87-2bea-47ba-81aa-aab6d89181b1
      iscommand: false
      name: 'Check DBot Indicator Score To Set Severity '
      type: condition
      version: -1
    taskid: c289bf87-2bea-47ba-81aa-aab6d89181b1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 1020
        }
      }
  "141":
    continueonerrortype: ""
    id: "141"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "3"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 787e932a-8807-49d7-8b40-295ae9da65ac
      iscommand: true
      name: Set Severity High
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 787e932a-8807-49d7-8b40-295ae9da65ac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 1230
        }
      }
  "142":
    continueonerrortype: ""
    id: "142"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "4"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 7b2e0e69-8306-4fee-81ff-88f5bc99967f
      iscommand: true
      name: Set Severity Critical
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 7b2e0e69-8306-4fee-81ff-88f5bc99967f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1760,
          "y": 1230
        }
      }
  "143":
    continueonerrortype: ""
    id: "143"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: be6ae00b-4fa4-4414-8037-fd1867a802a0
      iscommand: true
      name: Set Severity Medium
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: be6ae00b-4fa4-4414-8037-fd1867a802a0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1230
        }
      }
  "144":
    continueonerrortype: ""
    id: "144"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        simple: "4"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 58f7007a-fde7-4141-8470-894c5f4ede4b
      iscommand: true
      name: Set Severity Critical
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 58f7007a-fde7-4141-8470-894c5f4ede4b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -410,
          "y": 2040
        }
      }
  "145":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: EntryID
                root: InfoFile
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "145"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "128"
      - "130"
      - "123"
      - "132"
      "yes":
      - "146"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dff6e360-06d1-4686-8ea6-b7ba8b3f1a04
      iscommand: false
      name: Check If InfoFile Context Is Set ?
      type: condition
      version: -1
    taskid: dff6e360-06d1-4686-8ea6-b7ba8b3f1a04
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 890,
          "y": 2590
        }
      }
  "146":
    continueonerrortype: ""
    id: "146"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "128"
      - "130"
      - "123"
      - "132"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: File
      value:
        complex:
          root: InfoFile
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 83e425fa-9174-447c-8a92-cbc849a22162
      iscommand: false
      name: Combine InfoFile & File Context
      script: Set
      type: regular
      version: -1
    taskid: 83e425fa-9174-447c-8a92-cbc849a22162
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": 2740
        }
      }
  "147":
    continueonerror: true
    continueonerrortype: ""
    id: "147"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "148"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 27a99b6a-f4aa-4983-8af0-6cf2e7d80dc3
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 27a99b6a-f4aa-4983-8af0-6cf2e7d80dc3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 7.5,
          "y": 3840
        }
      }
  "148":
    continueonerrortype: ""
    id: "148"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2da8587c-bf87-4240-82d5-d57b37663402
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 2da8587c-bf87-4240-82d5-d57b37663402
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 7.5,
          "y": 4030
        }
      }
  "149":
    continueonerrortype: ""
    id: "149"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "152"
      - "52"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      text:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Email.Text
              operator: isNotEmpty
          root: Email.Text
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: c9475069-3998-43b2-89e7-5d37de80f880
      iscommand: true
      name: Extract Indicators From Email Body
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: c9475069-3998-43b2-89e7-5d37de80f880
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -892.5,
          "y": 225
        }
      }
  "150":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: HTML
                root: Email
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "150"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "52"
      "yes":
      - "92"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 08635156-d931-4edd-831a-e3d76087ae1c
      iscommand: false
      name: Is There A Email HTML
      type: condition
      version: -1
    taskid: 08635156-d931-4edd-831a-e3d76087ae1c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -442.5,
          "y": 70
        }
      }
  "151":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Text
                root: Email
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "151"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "52"
      "yes":
      - "149"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 595957cf-0f83-428e-8d42-a2155e6b4e83
      iscommand: false
      name: 'Is There A Email Text '
      type: condition
      version: -1
    taskid: 595957cf-0f83-428e-8d42-a2155e6b4e83
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -892.5,
          "y": 70
        }
      }
  "152":
    continueonerror: true
    continueonerrortype: ""
    id: "152"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "112"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      emailBody:
        simple: ${Email.Text}
      emailSubject:
        simple: ${Email.Subject}
      retry-count:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Predict phishing incidents using the out-of-the-box pre-trained
        model.
      id: 417cead4-2b5f-4187-8cde-915a438ba13e
      iscommand: false
      name: DBot Predict Phishing
      script: DBotPredictOutOfTheBoxV2
      type: regular
      version: -1
    taskid: 417cead4-2b5f-4187-8cde-915a438ba13e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -892.5,
          "y": 385
        }
      }
  "153":
    continueonerrortype: ""
    id: "153"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "154"
    note: false
    quietmode: 0
    scriptarguments:
      Email:
        complex:
          accessor: labels.Email
          root: incident
      Email/cc:
        complex:
          accessor: labels.CC
          root: incident
      Email/format:
        complex:
          accessor: labels.Email/format
          root: incident
      Email/from:
        complex:
          accessor: labels.Email/from
          root: incident
      Email/headers:
        complex:
          accessor: labels.Email/headers
          root: incident
      Email/html:
        complex:
          accessor: labels.Email/html
          root: incident
      Email/subject:
        complex:
          accessor: labels.Email/subject
          root: incident
      Email/text:
        complex:
          accessor: labels.Email/text
          root: incident
      File:
        complex:
          root: File
      GetOriginalEmail:
        simple: "False"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Add email details to the relevant context entities and handle the
        case where original emails are attached.
      id: 53bdc38e-e97a-4caa-8d8b-2ceb53311e0b
      iscommand: false
      name: TCS-Process Email-Generic v2.1
      playbookId: 46473380-0d67-4bd2-8d5c-3a787c6c40d3
      type: playbook
      version: -1
    taskid: 53bdc38e-e97a-4caa-8d8b-2ceb53311e0b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 7.5,
          "y": -330
        }
      }
  "154":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: From
                root: Email.HeadersMap
          operator: containsGeneral
          right:
            value:
              simple: '@tcs'
      label: "yes"
    continueonerrortype: ""
    id: "154"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "151"
      - "150"
      - "134"
      "yes":
      - "131"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 62d8eb07-e707-484a-85aa-2e61d0f10c83
      iscommand: false
      name: Original Mail Sender From TCS ?
      type: condition
      version: -1
    taskid: 62d8eb07-e707-484a-85aa-2e61d0f10c83
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 7.5,
          "y": -160
        }
      }
  "155":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: manual
      label: Manual
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: rawType
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: malware investigation
      label: From Malware Investigation Playbook
    continueonerrortype: ""
    id: "155"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "136"
      From Malware Investigation Playbook:
      - "153"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 68e9c860-6067-4a7b-88f7-9286960675b6
      iscommand: false
      name: Manual or Tool Triggered ?
      type: condition
      version: -1
    taskid: 68e9c860-6067-4a7b-88f7-9286960675b6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 7.5,
          "y": -750
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "145_128_#default#": 0.33,
      "155_136_#default#": 0.45
    },
    "paper": {
      "dimensions": {
        "height": 5035,
        "width": 3670,
        "x": -1510,
        "y": -940
      }
    }
  }
