category: Data Enrichment & Threat Intelligence
commonfields:
  id: ExpanseV2
  version: -1
configuration:
- defaultvalue: https://expander.expanse.co
  display: Your server URL
  name: url
  required: true
  type: 0
- display: ""
  displaypassword: API Key
  hiddenusername: true
  name: credentials
  required: false
  section: Connect
  type: 9
- additionalinfo: Xpanse API Key to use to connect.
  display: API Key
  hidden: true
  name: apikey
  required: false
  section: Connect
  type: 4
- advanced: true
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  section: Connect
  type: 8
- advanced: true
  display: Use system proxy settings
  name: proxy
  required: false
  section: Connect
  type: 8
- display: Fetch incidents
  name: isFetch
  required: false
  section: Collect
  type: 8
- display: Incident type
  name: incidentType
  required: false
  section: Connect
  type: 13
- defaultvalue: "10"
  display: Maximum number of incidents per fetch
  name: max_fetch
  required: false
  section: Collect
  type: 0
- defaultvalue: 3 days
  display: First fetch time
  name: first_fetch
  required: false
  section: Collect
  type: 0
- advanced: true
  display: Fetch Xpanse issues with Priority
  name: priority
  options:
  - Low
  - Medium
  - High
  - Critical
  required: false
  section: Collect
  type: 16
- advanced: true
  defaultvalue: Active
  display: Fetch Xpanse issues with Activity Status
  name: activity_status
  options:
  - Active
  - Inactive
  required: false
  section: Collect
  type: 16
- advanced: true
  display: Fetch Xpanse issues with Progress Status
  name: progress_status
  options:
  - New
  - Investigating
  - InProgress
  - AcceptableRisk
  - Resolved
  required: false
  section: Collect
  type: 16
- advanced: true
  display: Fetch issues with Business Units (comma separated string)
  name: business_unit
  required: false
  section: Collect
  type: 0
- advanced: true
  display: Fetch issues with Tags (comma separated string)
  name: tag
  required: false
  section: Collect
  type: 0
- advanced: true
  display: Fetch issue with Types (comma separated string)
  name: issue_type
  required: false
  section: Collect
  type: 0
- advanced: true
  display: Fetch Xpanse issues with Cloud Management Status
  name: cloud_management_status
  options:
  - NotApplicable
  - ManagedCloud
  - UnmanagedCloud
  required: false
  section: Collect
  type: 16
- defaultvalue: None
  display: Incident Mirroring Direction
  name: mirror_direction
  options:
  - None
  - Incoming
  - Outgoing
  - Both
  required: false
  section: Collect
  type: 15
- advanced: true
  defaultvalue: "false"
  display: Sync Incident Owners
  name: sync_owners
  required: false
  section: Collect
  type: 8
- additionalinfo: Assign these XSOAR tags (comma separated list) to the incoming comments
    mirrored from the Xpanse Issue (must be different from the sync_tags to prevent
    loops).
  advanced: true
  defaultvalue: FromExpanse
  display: Tag(s) for mirrored comments
  name: incoming_tags
  required: false
  section: Collect
  type: 0
- additionalinfo: Mirror XSOAR entries with these XSOAR tags (comma separate list)
    to the corresponding Xpanse Issue as comments (must be different from the incoming_tags
    to prevent loops).
  advanced: true
  display: Mirror out Entries with tag(s)
  name: sync_tags
  required: false
  section: Collect
  type: 0
- additionalinfo: Reliability of the source providing the intelligence data.
  defaultvalue: B - Usually reliable
  display: Source Reliability
  name: integrationReliability
  options:
  - A+ - 3rd party enrichment
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  required: false
  section: Collect
  type: 15
- advanced: true
  defaultvalue: indicatorType
  display: ""
  name: feedExpirationPolicy
  options:
  - never
  - interval
  - indicatorType
  - suddenDeath
  required: false
  section: Collect
  type: 17
- advanced: true
  defaultvalue: "20160"
  display: ""
  name: feedExpirationInterval
  required: false
  section: Collect
  type: 1
- defaultvalue: "1"
  display: Incidents Fetch Interval
  name: incidentFetchInterval
  required: false
  type: 19
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 1.10.54
    packID: ExpanseV2
    packName: Cortex Xpanse by Palo Alto Networks
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
defaultclassifier: ExpanseV2
defaultmapperin: ExpanseV2-mapper
description: The Xpanse integration for Cortex XSOAR leverages the Expander API to
  create incidents from Xpanse issues. It also leverages Xpanse's unparalleled view
  of the Internet to enrich IPs, domains and certificates using information from assets
  discovered by Xpanse Expander and risky flows detected by Xpanse Behavior.
detaileddescription: "## Expanse v2 Instance Configuration\n\n### Basic Information\n\nThe
  API Key can be retrieved by contacting your Expanse Engagement Manager.\n\n### Additional
  Options\n\nYou can determine several filters (**Priority**, **Activity Status**,
  **Progress Status**, **Business Units**, **Tags**, **Issue Types**) to fetch a subset
  of the Expanse Issue and generate Cortex XSOAR Incidents out of them.\n\n### Mirroring\n\nThis
  integration supports bidirectional mirroring to keep Expanse Issues in sync with
  XSOAR Incidents. Enable mirroring by selecting the appropriate **Incident Mirroring
  Direction** (Incoming, Outgoing or Both).\n\nThe following flags will determine
  the behavior of the mirroring:\n- **Tag(s) for mirrored comments (incoming_tags**):
  when comments are created in an Expanse Issue, they are replicated in the War Room
  of the corresponding Cortex XSOAR incident if incoming mirroring is enabled. These
  Cortex XSOAR tags are added to the entries: they must be different from the sync_tags
  to prevent loops in case bidirectional mirroring is used.\n- **Mirror out Entries
  with tag(s) (sync_tags)**: All the Cortex XSOAR entries of an Expanse Incident marked
  with these tags are automatically mirrored to the corresponding Expanse Issue as
  comments if outgoing mirroring is enabled. The tags be different from the incoming_tags
  to prevent loops in case bidirectional mirroring is used.\n- **Sync Incident Owners**:
  if enabled, Cortex XSOAR will try to match the Owner of the Expanse Incident in
  XSOAR to the Assignee in the corresponding Expanse Issue, and vice-versa (depending
  on the mirroring direction). The match is based on the user's email address. If
  the *Owner* is removed in Cortex XSOAR, the Expanse Issue is set to *Unassigned*,
  and vice-versa.\n\n**Mirroring Notes**: \n - The inbound mirroring will synchronize
  only the following fields: Comments, Assignee, Progress Status, Activity Status
  and Priority.\n - For outbound mirroring, to change the *Priority* of an Expanse
  Issue, you must change the *Severity* in the corresponding Cortex XSOAR Incident.\n
  - For outbound mirroring, to change the *Assignee* of an Expanse Issue, you must
  change the *Owner* in the corresponding Cortex XSOAR Incident (and **Sync Incident
  Owners** must be enabled).\n - Cortex XSOAR fetches details for the Expanse Assets
  associated to your incidents, such as tags and attribution reasons, but they are
  not automatically mirrored. You can always collect/refresh this information manually
  by clicking on the **Refresh Assets** button in the Expanse Incident layout.\n\n\n---\n[View
  Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/expanse-v2)"
display: Cortex Xpanse Legacy
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeIAAADFCAMAAAC/6QGrAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAJPUExURUdwTOnr7vn6+vv8/P39/fDx8fH38/7+/v7+/v////r6+/n7+v7+/v/+/v7+/v39/v3+/vf4+f39/fz9/P39/f7///z8/Pv499jd4f39/ff4+f39/klXbNbb3////6y1vv///+rs7v7+/srP1fv8/OHl5+Hk5vv7+/P09u7x88fO1Pv+/c/U2fz8/Pz8/Ons7ba9xfDy9IGOnPj5+vv7/J+ps73Eyt7i5fj5+ebo6s7V24+bpvPw8Ozu8L7Gzs7U2ra/yKm0vtDV18XL0HiGlG9+jba8xG5+jj5TZvDy842YpMLJ0LrBx+Xp7bG5wK+4wp+qtd7j5zNIXr3EypWhrtLX24SRoP3u7lBidqartWx7i+Dj53+LlImWoezv8X6MmZGeq9XY3JagrFxsfoiVo4aToKOrs+/w8fvT0frS0jZKYUxgcamyuv3w7ytAV4+bphAnQjtPZS1CWkdZb5ikrSA1UPdwbB40Tx0zTiE2URsxTRowTCI4UhgvSh41UBYtSRMqRhAoRD9TaSU7VDdLYv///y5DWw4lQio/WNTa4FRmeQohPzJHXkpdcUZZbniGlXKBkWZ2h1prfU9hdTxQZkJVazlNZfdoZPdsaLe/yMrR2PL092Fxg/z+/+fr78/W3K+5w/b5/H2KmW18jOHm652ptIiVooyZpcDI0KOuuPhuauzv8pGdqZeirwMcOdvg5aeyvISRnvZ5df/w7/eAfv/MyviLh//W1P/j4vZzb/menPiVkvZkX/67uPyzsf7DwQAQMPZva/atqv+qp/uqqRXzhNQAAAB1dFJOUwA0DRbMAwEGSx6LCY+mnnt1SJcQZVVfQFPt6oIF+Gn99PovT/f6YNb36/0n+7C5i/h2/jnF9vvu4Vbh96ih6u7g5ZJf+fRQ3BXbXfei8oTx4uKVbeGs2u6ZDZV2FfrWo+hq9u3nlJq39S/U1NTe1PD599Tk7yu+2jkAAB1BSURBVHja7d3ndxTHtijwPhLdIyQjIRSJAoRkEMZkTLDBmOCHsQ1+OPs5huPj9+59595331aFjjM9SZOjcs6yEtngdA73nD/sfpDAYPX09My0wl2r6pPXMt1T+OddXdVdtTfHrWZzrLPvXgInCIJwzNMzPT3aMjUe6w1EXG6v3+8PhVzhQDw2cXOgf3q6Z0gQBEEQbPxLlKznWFt+YoEXjtV919/SNRYNuJ1zPk2WRYwwQoAQQhhjUVS1uTkxlRie6hro79sj8DzPiP+7EAu8IBzwjDZEExGv6lQpIgQMGyEIU9WHQ+HEka7pvs02KTPi5SXmeX6Dp/LNcbcuIYzAWkNY0XXXbI89yox4OYl5vtzT0x0lQfUZQgUhACCPo3nhHxBSnv1D6px3Yr5nS8HKjHj5iHl+U8+JI+6gE/8enwrCGCNZlrztkUg4GQgEAoFkOJJ2exVVRBiB8nuoE+wLRmYme7YUhsyIl4eYdzj40oGoi2r0CS9CSFE1f3Lk05uHTrRsb2ratWvv3r17p3c1Nc2/0HLi0PFb8TA4KULod2bRScK35k86HDwjXlPEvKPUMzQYRvT3+AVJp3L64tVde/b07c5w2c49e3p2NVwM/ZskPTVgU0oCA56TDgcjXjvEfKmnfzYUlB9HLxA95E0P76qzOge/eink9urSk2hW5yJdQ8/nicyIbSfmHQdHx0M+cWEyhRFG7sTFhj2Vud2k6fhIwIsWZ+GEqD7XWH9+yIzYXmLewVeMRr3aYgRjJOuJ4y/sLMnnx/e2fBWh8HippWqp8f51Dka8ysR86aYbs7qGAAAURZEU95k9NQV0oGjvJV1/PMumamjqs7IyByNePWK+bGPfmDeIF5a5yB9KHtpZU2AXqnZ+lQ5JsDBvE4OuSc+6Mka8WsT8Rk9XWFMJACCM9cjFl2o5rvAPCsU7D424JLSArMm9A8eKyhjxqhDzh+fjSEMEABQRBab2VtvVjeKd28+k6MJDmWr6cP+xMka88sR80Zc3vSpeWCUpkYadO2ztyfqdX4UWF1FUdQ2+mEMgM2JbiPmi6v64UwMAQKC7zmzeYXtf1u+95NYxAiDgpMPTL5Yx4pUk5nd4pkJBRQJAVEp/umUjJyxDb/a/FXMTEQAkMZie/K6qjBGvGLGjuj8uaxIAYNF78a2Ny9Wd/ZvPfi1RDEBAk470WAxkRlw4saO5O+1DBEDBSmB7xXJ2SNh/1YUxApBELdF2oIgRrwQxX3XhJg4SAgpWUkf2VSxzl3a/FQthDCDhoLfru6oiRrzsxHztUFSWJQBM/b0tFcvfp92bjyclqgAhmj7RZyGQGXFhxHxzW0CTCQAW289s2boivdq975JXRgCgiSOj2Y0ZcUHEjlOTIR8GUDAKXy1doV4J3J+utWOkABGd4YENRYx4+YgdxfVdXo0AYOof2V66gh07ei6gUwUI1tIt2YwZcQHElZ4xvwYLg/TJ0hXt2dF9w14RAcGaa/LlIka8TMR84yzWCAAVI4eeW5aXHSatbvNf20UMBDm9g+bGjDhvYkfjmFMkABQFWp5bhc4dPZumGIA49QZTY0acJ7Fj/eUxmSoAVI9vXw1hTqg7F0BUAdD8g68UMWK7iYWjngmqAiDZP7xr0+r0Tqh7KY5ERJDTa2bMiPMj5htnZI0Akv23Tm5atf5V7oshWSHIZxbHjDgvYr7xpiZLgET/V5tWs4OVm6NERERy+rsyGjPifIj5+kEkAyDZO/vd6vawcktUEhGA5p7cVMSIbSPm6ye9mgKK7P30Svkqd7FkX1SSQaJapHtTFSO2iZivb/E6JVBU/5lXVr+PJfuiICuEOsNtxsaMOGdivmTerRFQRH3mxTXQR6FkSwyJQKiW6Dc0ZsS5EjtKhhJOBUDUh/eWc2vC+KU4wiCpNNq3lREXTizs90RVDEBRvKl8bfSSLzmXEDEQTZ86WMWICybm66eQDIDFwPbyNdPPU2cjKgbkdHc/V8WICyTmS9oklQAWI1fL11BHT51PyYggX3h06eOYEedE7CjpCfuAKNTdUL6menrhC6+IJFUb6atgxIUQC+s9MR8QoP7ZY2usqzfGJQySRsaWPI4ZcS7EjspBggCwEt+1YY11tfZcgmIgmqvtuWJGnD/x+p6UBoDFyAvla66vNddcKpJEZ3xoIyPOm1i4HA0qBInuaysbw7t3796f/U/Vf+GVkeRU/jhUM2LrxI7KLhUDUH1m3Ur6fl/p8Xg++P7777M48zfGCVWIzz3w7FDNiK0TF0+7NQCEEyv3IN79fd2de7/+9NNPP/326707H5gjV58OUCRRZ+/QDkacF7GjcVhUQMGpQxmEi3f/ybjtLsrr14XddZ4f/3H30S8dHR0dv/zy8P4/H/yrGbJw4d2QiIjmv/nMUM2ILRMXz/tFBFS5dSXDnz7saek2ai1DFXkZ13l+/On2Lx2PWhfaD7/8cvufd/7VLJDfjmIK4Ez2Pz1UM2KrxHxjXEWAxGRThiAWSk7Hve529x9buzcxmo9xnec/b//S0fpUe9jRcf9vZsbVZyMyIqoy7tnBiHMnLu6mIoDsP5TxQSw0Xg/N+Zy+PzRn0Nk7nbtx3Z2fHz0D3Nra2vpDx8PfzIybv/DLhATTA6XFjDhn4ssRFQAr0edN/nzjdbdMpCVNpNG+iqqcfpmvu3O/o7N1aets/dXM+O0YwoT6RjzVjDhHYkfloBMRRF0vmM6mvxzTZYN08U59xpNbAj3e8/OTh/CzrcPUuPZ8O0V60Du5tZgR50ZcNRTCCmD91vPmr5iuRBXRIE2809vwSS5DtVD3T8MYbm1tbe28fe/5TMaC8PawhAE5433VjDgnYkf9BMUAOLU9y5K45J24TJeGMXKGJg/nYCw8eNiRQbj1Uef9O5k/guw43y4C0UJdT8KYEVsiLh5yYQSYTJzMdknN6V4ZLzUGX7ptY5n1IL6fKYZbWx91Pvx13e6Ml749DBiQOuKpZcS5EH80hTEossvCe62SswEDY8BaoseqsVD54OEPGYlbf+j82SyMX03JSPKlnjyNGbEVYkdjUkWA0XErH5jqX42oS2u5EFmLDVk0dnh+fvgoM/Gjjtv3TPZ+vjaBREl0Dj8OY0ZshfijbhkDouHPLF1V/25INZhWq+pw30ZrS6c7d02EW1s7O347ttskjNMikoKRtsUwZsQWiPn6pIyASmNbrF32yZhfXhrHkoZmPEctjdM/mo3Tra2dHWYjNffaOKEgarcWw5gRWyAuG5UxAHZtt/iFqfbKEclg6SQ5vV2HLQzVvOdvnZ1mxI867/5oMlLvOJ+iSJ8Lj9YwYovE/KleigDp0ZNWr6t5JwbU6BWIa97C45jv+63TNIpbzR/G296OSYjI4tjBYkZsjbhq2o8AcOiE9d08Nad7DZbHgIKB6ezGfN9//mBO3Nn6N7OzNl9+E6IgBXv7ahixNeJtMzoCwMl91i/ka04HVIPlMQ3GhzY6CifuNCXmvg1QhWjuE1uLGbEVYr4+gRBgcjynLXk1r4YNlseS7Iz1bSzK9izOSvzQnPjG67oIonjLU8OIrRAXjfopAA1dyenSbfXXXaLBtFql457dWYhf/NWc+FGH6XSL47iPXTKAL9FfwoitEG+bpRSweGtLbtcKF973Gk2rVb2hOttQfc98Rv1Dx/0H5sRvxjCWfO7JrcWMODsxfypAEVCU+ym118Yloy+LPvfAYXNj/sHtLOvinz4wz5m7412/TER13FPDiLMTFw1RCogG9uV8de07MWQQxxBMz5tPuRyen80fxY9+PZDlt78NUKzPJXoYsQXij2ZlCpjObsn5aqH2nREDY0Kdgf6NZsVq+QO/tZq9wey4+yDLkSrhtWGFSr5QdyUjzk68LU0BkHdycx7X155NYIOlE9biWabVd8zeYHZ2ZhunOa58yk8RCs6WFjPibMT8BUUEgGRTXvm1ms+HDd5WA9WGPevNw9hkvtWZbT7NcUL1qxGE9L/HPTWMOBvxR4MKBoXETuZ3h+braaPlsUrHPjGtK/7y/Y7MT+J/fpC9QMGf4xKSfKmBSkacdaAOIADFP7U5z1s0v9tu9PVY0ycPmxgL3IPbHRk/M31goUzQexN+DEgbKy2uZMSmxMKFFAZA3u1550E0Xh6DFmrbaJLC2nHg3qPODGviv1gpBFX9bogCCUY9JXWM2JSYb/NiAJTal/9N3rslGXyRAF+y38yY2/C32x0/GEy1rAlzwscRDMSZ6K9kxFkG6hkdgUKie/O/SfU7cWpgrAQTPabT6g337nZ0/DGEH/30F4vF3N4ckRCoqe6jjNicuHYEECDxRCFJxatPJ4y+LGJn3FNsdt2GB/94+Evno6eAO+7++oFFYaH5dT8FWW8orWbEZsTPewKAAMv7CrpN9dkkRUbL44lPzBe3L//48+2Ojs6F1tF59x9/Kbdc7Ev4MCQSiic85cUM0oy4zaUA4FRhxFzt+bTBVyeQaddhLhvyP366f/f27dt37//8aw7AHMd9nqYKUmPTmxixKfGkHwOisS2F3Uf48gu30dLJ6W3JNu6Wb3r5wY/37t378c7e8tzK9b0ZR1gKJkYZsTlxA6aA1ME9hd7py29CRq+5NPdANmOBKy8v31ReXp5rPcaXxxGV5iJLkjSx9izxBGBAPhtKuFx43W+4PHaNLle549r3JVHyuSdLGbEp8YiCAOsvFX6rbe/FJINzMODszb6ZK8+nw4dukah6AyM2Jb6SxAho5C0b7rXjXMJgWg1Yi3qWh5j7PEwBa4tbbVnLQPyZVwRF7N1nx82qz4ZVo2m1PHN4eaL4zwmEpLlxRmxOjEVA8vAWW+6241raYOMtUHlweR7Hb8YR1v8+/BojNmn8aYUCUmftIeaqj6cMl8d697IYvxfFVP97jBGbRvG/SBSQdnOzTfdr/saNFYMzi+n+imV4Hr8yjKk01/vnIgZpEsXv6xgQHrSLmLtxyWswVCtawLMMvX9lXKJSMPDt/2KQJiud13UMyH/CNmLuja91o6WTL7YMU66XZ/yYOMMfM2JTYoIBhVpsI9627Y3/IAbGJDhmv/GGsRACLcKITUX+D0GAUgObbbzlqwlsMOVC8mCF7cQ33YhoqQ8ZsSmxhABcbTttvOeOQxGjVyDUP2C38YbBdgSy+8P/wSBNiP83QYDS2239j1/9VQopBm+rU/0VdhOnFBBD/5MRmxMrgMMv2XvXU4ZTLikYmN5q6+8cmEwpQL2M2JT4/ylgP/Eb/6EbjNQgBXvtNa75lwhSsJ8RmxL/X7CdeNvlr/1G6yYAIo8MbRVs/KnPkwgx4mzExHbiCxe9xsIAQMdtfQXCiC1GMbKVuPmvblHJRCxLUzYO1QIjXo1ncfP/b5czCi9koLX1WcyIrcyoFRuJm4+7jBbFTxm7J20zPjDpYjNqS+tisG9dXHstiRQwa0RMzdtlzNbFVojtfbtVfa4XYcjS1MB0qV3E7QhU9nYrO7F976jfiyk0mzAoau+QPcYbGtg76uzEr0vIti9Nwhtf6yJkb1ge6bPl98rHQph9acpKrCPbvhdfuOSlYKUh+dODdvwg+15sodm566P5m3YjYaP5NZYa7Biq2a4PC83GvVvN1w1ProHPaOyWQ102GLO9W1ai+DTYtAOz9nxENJpMB2dC1GAZpbbbYMx2YFqJ4s+wCEgsfB917dmksXD0k6mQ0b8Q0wMFG7N91JaIvSIotODTENXneqnhgaaAp6x23OjDkyIm+gs8K8dOQ1givpLECHDBZ5reiyrYsI7AaEURd2FEMjrrJI5MF/irn4cpYJWdaTInfn4EIcBSgS+p33jdT412yOvdFRzHcW8EiNFmLnSpsKF68WTiIDuZaE48gQo/X3z5dcPMW6I4eHjxnci/G23KpHi8IONqdr7YEnEDpYC1grIEXPim3eALMZHFmcOPt3h0pYyMsT5ViDHLEmCNuPBcH83XIwYLYkK16O8pmWoHDXeCYHdXAcMHy/VhjbjgjD21ryZlw+VS79BTxeebJ4w2ZSI5PZC/8edpqiCNZezJRuxJFJZ3q/Z0QDV6b+lMj1Y8neb0smGaCKSGR/M2/jAkEkpZ3q0sxOtqYwVlz6s1LskFTvfAM3nlBeENo3MwBGu9eRovZs+TBln2vCzECzkwlTxzYNa+EwNsWDxxcknlgKawUYY9JI5M52f85gjBRGtnOTCzES9kssXteY3UwmsTulHpRBl3LanxItQMuA2nXNKRvOZ6wscRyjLZWiEWmgvIR13/vlc2mkw7Jz5ZmhRAqGkw+p6MRP1MPmFc/W6IgsTyUVsYqAvIKn/q3ZRqKBz37DeKu/pZ3eirk+ydysP4vQk/BsyyylsgXqwNMZJ7bYhT1yMqJkvD0peYrjAuRt44gwyXTqlDuRuz2hCWiRcqvCi5V3ipybAg9oVHM+RuEYTLMaNpNZLD3bkaswovOQzU29JiPnWaaozzjIMW6jbJzvNG2uhtNlYDTTkal0/5KbA6TdaI86u2VnM6LhrWmpfMa80PGJ6HoXI8N+PFamtuVm3NCnFeNRMzlEuUNDz7iWkV8pIWr2x0ZBHHcnsF8m2AImmul9VMtEKcT+XTbZ/M6EZfl0Qt6jlqfmXloGE9GKqP9+RgzCqf5kLMbRvLuX5x4/sh1UAYO3t7Mkymn1o6TSiG02rv1PM5vNqKYcrqF1smzr0Kef11l/GCODxaUZb16su9RjNxrLqvWf96/LFLBMKqkFsl5usTCAEmx62O1I3GC2ISTLVZEOa4nqRRUmOspg9ZNb7xuk6B0lueGkZshVjYNiMhAJS0OOGqN14QE1+o67CVXetCSX/KYJgHLCatfvD6NkAVorpPbC1mxFaIuappPwJAoUOWwrjktOGGWknVZzx11n62ZMBwWo1xr7VNZF9+E6Ig+Xr7ajhGbImYP9UrI0CSpQK3JRmWS6o43JdtqvWkVQ4anmEUIfaWBWPh7ZiEiEwXt9cy4uzEXNm8RkHBaQvrppLPokg2EnbGn97Ik/VxPmb0agzJ0vCu7MY7zqco0ufC/TUcI7ZIzNcnZQRUGsu6bqq5ckQyECY4mOipyOX42OURwxfcsj6xJ6vxa+MSBVG75allxFaJuY+6ZQxIDH+W9Sk45Td6AYl84dGtOR0Q5IcCqmHC29DUsWxB/GpaRFIw0ra1mBFbJnY0JlUEFGdbNzVebzeqqUac7u6K3I6A8pX9ac0whYAr2/L4tXEsSqJzeDGIGbElYu6jmxiDIrt2bTD743Xnw6rhVi3/zcM5H/KtHPBqxMg4bL483vFqSkaSM9WyGMSM2Bpx8ZALI8Bk3GxSXXc2aSisiUc8Jbn/eOVNMPwiIQfOlZpNp4cJBqSOPA5iRmyN2FE/QTEATW3PHMZ1pxOGL7VkLTa0tSqPH/fcUoy+ZVAxPp/ZuPp8u7iQha+YEedCzFUNhbACWL+V8VtA3TsxTMmSJolab8/WfHIx8JWemIyW3pFQKboro/HbwxIG5Iz3VXOMOCdiR+WgExPArpYNmV55jGhBp0EL5jqZfmqoHuoN+oxuKUczvQKpPd9OkR4MTT4JYkZskZjjLkdUAKxEM4RxfVe63WXQ3MnurXnnU6mcTqYMbxruOpAhiGMIE+qMeao5RpwrcdUAFQFk/yHDMC7ZPDrQZtQGeg4WkDGncqjN+K6jfYbbBZu/8MuEBNMDTx0qZsQWiQW+Ma4iQGKyycBYKD76pwztaFUhPch8W6Ot2NVnIzIiKhr37OAYcc5RzBXP+0UEFB25smb7+3YUUwBnoP/pY+OM2DKxo/GIqACi7Yc2rNHuXng3RBWi+m8efHrkYMSWibniabcGgFBi19o0rj6dpEiiWnxoB8eI8yEWHJVdKgUQ9Zl1a7Gzwo1xEBXiax94NrsHI7YexZxwedinECS6r63FML7whVdEklMZO/jsBI8R50DMre9JaQBYjLxQvub6WnPNpSJJ1uJ9fyhpzohzIXZUDgICwEp8zT2Oa88lKAaiuZYkYWLEuRAL6z0xJxCg/tlja6yrN8YlCpImTR384zqcEedCzDlKesI+IIrovrm2hurGL7wiSKo20rekGg0jzomY40vadJUAFtNX15LxqfMpGQHyhUc3VTHiwog5vv4mkgGwGNi+doxPnY3ICJDT3f3c0teljDhHYm6/J6phAKrEm9aIsVByLkAxEM2/9EHMiPMgdpQMJZwKgChF964N45KX4goFScXDfUaF2hhxrsQcXzKa0gAUUZ95cU3E8JaYQkEStUT/pipGbAcxx1d2e50SKKp+5pU1EMP7oiArEnWG2wyFGXEexBxfP+nVFFBk76cnN62+MJFBwlpkwFiYEedDzPH1XUgEANE7s2d1n8eVW6KSiADU9slNGXaXMOJ8iDm+8aYmEkCyf/bAqgpvjhIREeL0d72Saf8QI86LmOMbZ1VNIkj2H1nFsbpyXwzJCkE+/2BGYUacJzF31DOBNQCQ/cO7Vsu47qU4khFBzpCJMCPOl9ix/vLCGWCqx7c/tzrC5wIKVQA0sxhmxHkTc5yjccwpEgCKAi2rYXz0bBpjAKLpDS+b7eNlxHkTc47GWawRAEojh0pXPIQ3/9UtIiDI6R00FWbEBRBzlZ4xvwYAWGz/9OTKIh/dN+wVAQjWXJPmwoy4EGJHcX2XXyMAmPpHtq+k8dFzAZ0qQLCWbtmQ5bQFIy6AmBMcpybdPgSgYBS+unLGf7rmxkgBIjqTA9mEGXFBxBznaJ4POGUCgEX3mS1bV6RXu/dd8ssIADQ8Mnog64kpRlwYMcfXDkVlWQLAor/30OblR969+XhSoggIUfWJvuzCjLhQYo6vutCAgoSAgpX28emK5RZ+aySEMYCEg6Gu76osnHpkxIUSc7yjeSDtQwRAQSiwfXmN9191KQgBSKIz0XbA0rFWRlwwMcc5qvvjsiYBABK9F9/auGy+m89+LVEEQEDTbw29WMYx4hUi5vgdnqlQUJEAEJVct7YsD/L+t2JuIgIAEX2Rye+qrAkzYluIOb6ouj/uVAEAEOiuM5t32N6X9XsvuXWEAAg46XCPxRBmxHYRc4Kj6MuG0EJOQ4SUSMNOe5HX7zwTkhACAKCqq+vFIsvCjNgmYo7jHIfn44qGAQAUEQWO7622qxvFO7efSYkYLVQv9x/pP1aWw9WM2DZijt/o6UpqKgEAhKkeufhSrT3Ah0ZS0mKpPU2ODxwrykWYEdtIzPFlG/umQkFMAAAh5A8lr+2sKbALVTu/coUeA4tB16RnXVlud2DENhJzAl+66casfyETpqKApLjP7CkAuWhn0yVdB2UhTSJVQ1OflZU5OEa8esQcxzv4itGoV1tMUIoUUUocf2FnST4/vvfqmTBSHhfKVFXXeP86R+73YcT2EnOcwDsO9o+HfI+REUbuwMWGPZW5/a/SdHwk6ceLwISozvRY//OOPIQZse3EHMfxpZ7pqXafvJDWVkFA9JDXdXG0zur/JSdGQm6vtLhIAgB1LtI1lB8wI14WYo53OPjSyTCm+Pdkw5KO1X+/eGJXz56+3Rku27lnz56mhkv+f5Okp2oFUCwFBjwn8wRmxMtDzHEcx/OlbVEX1p5UakEIIUV26uGRT6cOnWh5Yb6paddCa2qaf6HlxKHjt+IRUaMIod+LD4iaFB6fP+lw8Hl3hBEvFzG3jd/k6T9xxB10oieJyBEgrCAkq5K3PRIJJ5OBQDKZDEfSbj9WRQz4aV5CfcHwzGTPFp4v5C/BiJeNmON4ni/39HQP68FnC+QpCAEAIQoAAAEgCwvpZzPIK+pcaGa+ZwtfGDAjXlbiBeUNnso3J9p1CWGD8j6GDVFFl1yzPX2bC/ZlxMtOzHGcwAvCAU9/QzQRCalOlSJCjGUJQZhqPuQOJ4502eTLiFeCeIGZP1Z3YLq7ayyaaNfmgk5VFDHGCCGEEMZYlGXVOTeHXb23proG+vv2CDb5MuKVIuY4TuAEQRCOeXqmp/u7b05E44Gwyx3yer0hdzqcGInONLT1T/f0DAmCIAiCjX+JtU78X7lDYMJuyFZZAAAAAElFTkSuQmCC
name: ExpanseV2
script:
  commands:
  - arguments:
    - description: ID of the Xpanse service to retrieve.
      name: service_id
      required: true
    description: Retrieve Xpanse service by service ID.
    name: expanse-get-service
    outputs:
    - contextPath: Expanse.Service.activityStatus
      description: Activity status of service, whether the service is active or inactive.
      type: String
    - contextPath: Expanse.Service.annotations.tags.id
      description: The Internal Xpanse tag id of the customer added tag.
      type: String
    - contextPath: Expanse.Service.annotations.tags.name
      description: The tag name of the customer added tag.
      type: String
    - contextPath: Expanse.Service.assets.assetKey
      description: Key used to access the asset in the respective Xpanse asset API.
      type: String
    - contextPath: Expanse.Service.assets.assetType
      description: The type of asset the issue primarily relates to.
      type: String
    - contextPath: Expanse.Service.assets.displayName
      description: A friendly name for the asset.
      type: String
    - contextPath: Expanse.Service.assets.id
      description: Internal Xpanse ID the asset.
      type: String
    - contextPath: Expanse.Service.assets.referenceReason.id
      description: ID for asset reference type.
      type: String
    - contextPath: Expanse.Service.assets.referenceReason.name
      description: Description for asset reference reason.
      type: String
    - contextPath: Expanse.Service.businessUnits.id
      description: The internal Xpanse ID for the business unit the affected asset
        belongs to.
      type: String
    - contextPath: Expanse.Service.businessUnits.name
      description: The name of the business unit the affected asset belongs to.
      type: String
    - contextPath: Expanse.Service.certificates.assetId
      description: Internal Asset ID of certificate.
      type: String
    - contextPath: Expanse.Service.certificates.firstObserved
      description: First observation of certificate.
      type: Date
    - contextPath: Expanse.Service.certificates.lastObserved
      description: Most recent observation of certificate.
      type: Date
    - contextPath: Expanse.Service.certificates.certificate.formattedIssuerOrg
      description: The formatted issuer org in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.id
      description: The Internal Xpanse certificate ID.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuer
      description: The issuer in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerAlternativeNames
      description: The issuer alternative names in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerCountry
      description: The issuer country in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerEmail
      description: The issuer email in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerLocality
      description: The issuer locality in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerName
      description: The issuer name in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerOrg
      description: The issuer org in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerOrgUnit
      description: The issuer org unit in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerState
      description: The issuer state in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.md5Hash
      description: The md5hash in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.pemSha1
      description: The pemSha1 in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.pemSha256
      description: The pemSha256 in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.publicKey
      description: The public key in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.publicKeyAlgorithm
      description: The public key algorithm in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.publicKeyBits
      description: The public key bits in the certificate.
      type: Number
    - contextPath: Expanse.Service.certificates.certificate.publicKeyModulus
      description: The public key modulus in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.publicKeyRsaExponent
      description: The public key RSA exponent in the certificate.
      type: Number
    - contextPath: Expanse.Service.certificates.certificate.publicKeySpki
      description: The public key Spki in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.serialNumber
      description: The serial number in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.signatureAlgorithm
      description: The signature algorithm in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subject
      description: The subject in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectAlternativeNames
      description: The subject alternative names in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectCountry
      description: The subject country in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectEmail
      description: The subject email in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectLocality
      description: The subject locality in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectName
      description: The subject name in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectOrg
      description: The subject org in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectOrgUnit
      description: The subject org unit in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectState
      description: The subject state in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.validNotAfter
      description: The valid not after date in the certificate.
      type: Date
    - contextPath: Expanse.Service.certificates.certificate.validNotBefore
      description: The valid not before date in the certificate.
      type: Date
    - contextPath: Expanse.Service.certificates.certificate.version
      description: The version in the certificate.
      type: String
    - contextPath: Expanse.Service.classifications.details.firstObserved
      description: When the service instance was first observed.
      type: Date
    - contextPath: Expanse.Service.classifications.details.lastObserved
      description: When the service instance was last observed.
      type: Date
    - contextPath: Expanse.Service.classifications.details.value.applicationServerSoftware
      description: Application Server Software value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.bgpOpenResponse
      description: BGP Open value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.bgpNotificationResponse.data
      description: BGP Notification Data value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.bgpNotificationResponse.errorCode
      description: BGP Notification Error Code value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.bgpNotificationResponse.errorSubCode
      description: BGP Notification Sub-Error Code value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.bindVersions
      description: Bind version value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.certificateId
      description: Certificate Id value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.connectResponse.statusCode
      description: Connect Response Status Code value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.connectResponse.responseLines
      description: Connect Response Response value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.credSspProtocol
      description: Cred SSP Protocol of the service classification.
      type: Boolean
    - contextPath: Expanse.Service.classifications.details.value.exchanges.request.arguments
      description: Exchange Request Arguments value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.exchanges.request.command
      description: Exchange Request Command value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.exchanges.response.statusCode
      description: Connect Response Status Code value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.exchanges.response.responseLines
      description: Connect Response Response value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.extraInfo
      description: Extra Info about the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.htmlPasswordAction
      description: HTML Password Action value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.htmlPasswordField
      description: HTML Password Field value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.htmlPasswordAction
      description: HTML Password Action value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.httpAuthenticationMethods
      description: HTTP Authentication Methods value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.httpAuthenticationRealm
      description: HTTP Authentication Realm value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.httpHeaders.name
      description: HTTP Header name included in the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.httpHeaders.value
      description: HTTP Header value included in the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.httpStatusCode
      description: HTTP Status code of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.isEncrypted
      description: Is Encrypted service classification.
      type: Boolean
    - contextPath: Expanse.Service.classifications.details.value.isImplicit
      description: Is Implicit service classification.
      type: Boolean
    - contextPath: Expanse.Service.classifications.details.value.loadBalancer
      description: Load Balancer value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.loadBalancerPool
      description: Load Balancer Pool value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.nativeRdpAlgorithms
      description: Native RDP Algorithms of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.nativeRdpProtocol
      description: Native RDP Algorithms of the service classification.
      type: Boolean
    - contextPath: Expanse.Service.classifications.details.value.serverSoftware
      description: Detected Server Software the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.serverVersion
      description: Server Version details for the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.sslProtocol
      description: SSL Protocol for the service classification.
      type: Boolean
    - contextPath: Expanse.Service.classifications.details.value.validWhenScanned
      description: Whether a certificate on the service was valid at scan time.
      type: Boolean
    - contextPath: Expanse.Service.classifications.details.value.version
      description: Version details for the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.firstObserved
      description: First observation of the service classification.
      type: Date
    - contextPath: Expanse.Service.classifications.id
      description: Service classification ID.
      type: String
    - contextPath: Expanse.Service.classifications.lastObserved
      description: Last observation of the service classification.
      type: Date
    - contextPath: Expanse.Service.classifications.name
      description: Service classification name.
      type: String
    - contextPath: Expanse.Service.cloudManagementStatus.id
      description: The Internal ID of the cloud management status.
      type: String
    - contextPath: Expanse.Service.cloudManagementStatus.name
      description: Name of the cloud management status.
      type: String
    - contextPath: Expanse.Service.domain.assetId
      description: The Internal Asset ID of the domain related to the service.
      type: String
    - contextPath: Expanse.Service.domain.domain
      description: The domain name related to the service.
      type: String
    - contextPath: Expanse.Service.domain.firstObserved
      description: The first observation of a domain related to the service.
      type: Date
    - contextPath: Expanse.Service.domain.lastObserved
      description: The last observation of a domain related to the service.
      type: Date
    - contextPath: Expanse.Service.discoveryInfo.type
      description: Whether the service was directly discovered or colocated.
      type: String
    - contextPath: Expanse.Service.firstObserved
      description: First observation of the service.
      type: Date
    - contextPath: Expanse.Service.id
      description: The internal Xpanse ID of the service.
      type: String
    - contextPath: Expanse.Service.ips.assetId
      description: The Internal Asset ID of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.firstObserved
      description: First observation of the ip related to the service.
      type: Date
    - contextPath: Expanse.Service.ips.geolocation.city
      description: Geolocation city of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.geolocation.countryCode
      description: Geolocation country of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.geolocation.latitude
      description: Geolocation latitude of the ip related to the service.
      type: Number
    - contextPath: Expanse.Service.ips.geolocation.longitude
      description: Geolocation longitude of the ip related to the service.
      type: Number
    - contextPath: Expanse.Service.ips.geolocation.regionCode
      description: Geolocation region of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.geolocation.timeZone
      description: Geolocation timeZone of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.ip
      description: IPv4 Address of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.lastObserved
      description: Last observation of the ip related to the service.
      type: Date
    - contextPath: Expanse.Service.ips.provider.id
      description: Provider ID of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.provider.name
      description: provider name of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.transportProtocol
      description: Transport protocol of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.lastObserved
      description: Last observation of the service.
      type: Date
    - contextPath: Expanse.Service.name
      description: Summary of the service observation.
      type: String
    - contextPath: Expanse.Service.portNumber
      description: Summary of the service observation.
      type: Number
    - contextPath: Expanse.Service.tlsVersions.cipherSuite
      description: Cipher suite of the TLS version observed on the service.
      type: String
    - contextPath: Expanse.Service.tlsVersions.firstObserved
      description: First observation of the TLS version observed on the service.
      type: Date
    - contextPath: Expanse.Service.tlsVersions.lastObserved
      description: Last observation of the TLS version observed on the service.
      type: Date
    - contextPath: Expanse.Service.tlsVersions.tlsVersion
      description: TLS version observed on the service.
      type: String
  - arguments:
    - description: Maximum number of services to retrieve.
      name: limit
    - description: Returns only results whose contents match the given query. Query
        can be any generic string (ex. telnet).
      name: content_search
    - description: Returns only results that were found on the given providers (comma
        separated string).
      isArray: true
      name: provider
    - description: Returns only results with a business unit whose name falls in the
        provided list (comma separated string).
      isArray: true
      name: business_unit
    - description: Returns only results whose service type name (or classification
        ID) matches one of the given types (comma separated string).
      isArray: true
      name: service_type
    - description: Returns results whose identifier includes an IP matching the query.
        Search for results in a given IP/CIDR block using a single IP (d.d.d.d), a
        dashed IP range (d.d.d.d-d.d.d.d), a CIDR block (d.d.d.d/m), a partial CIDR
        (d.d.), or a wildcard (d.d.*.d).
      name: inet_search
    - description: Returns results whose identifier includes a domain matching the
        query.
      name: domain_search
    - description: Returns only results whose identifier includes one of the given
        port numbers (comma separated list).
      isArray: true
      name: port_number
    - description: Returns only results whose discovery type matches one of the given
        values (comma separated string, options are 'ColocatedOnIp', 'DirectlyDiscovered').
      isArray: true
      name: discovery_type
    - description: Returns only results whose country code matches one of the given
        ISO-3166 two character country codes (comma separated list).
      isArray: true
      name: country_code
    - description: Returns only results whose activity status matches one of the given
        values. (comma separated string, options are 'Active', 'Inactive').
      isArray: true
      name: activity_status
    - description: Returns only results that are associated with the provided tag
        names (comma separated string).
      isArray: true
      name: tag
    - auto: PREDEFINED
      description: Returns only results whose cloud management status is the following:(comma-separated
        string, options are 'NotApplicable', 'ManagedCloud', 'UnmanagedCloud').
      isArray: true
      name: cloud_management_status
      predefined:
      - NotApplicable
      - ManagedCloud
      - UnmanagedCloud
    - auto: PREDEFINED
      defaultValue: firstObserved
      description: Sort by specified properties.
      name: sort
      predefined:
      - firstObserved
      - -firstObserved
      - lastObserved
      - -lastObserved
      - name
      - -name
    description: Retrieve all Xpanse services matching the supplied parameters.
    name: expanse-get-services
    outputs:
    - contextPath: Expanse.Service.activityStatus
      description: Activity status of service, whether the service is active or inactive.
      type: String
    - contextPath: Expanse.Service.annotations.tags.id
      description: The Internal Xpanse tag id of the customer added tag.
      type: String
    - contextPath: Expanse.Service.annotations.tags.name
      description: The tag name of the customer added tag.
      type: String
    - contextPath: Expanse.Service.assets.assetKey
      description: Key used to access the asset in the respective Xpanse asset API.
      type: String
    - contextPath: Expanse.Service.assets.assetType
      description: The type of asset the issue primarily relates to.
      type: String
    - contextPath: Expanse.Service.assets.displayName
      description: A friendly name for the asset.
      type: String
    - contextPath: Expanse.Service.assets.id
      description: Internal Xpanse ID the asset.
      type: String
    - contextPath: Expanse.Service.assets.referenceReason.id
      description: ID for asset reference type.
      type: String
    - contextPath: Expanse.Service.assets.referenceReason.name
      description: Description for asset reference reason.
      type: String
    - contextPath: Expanse.Service.businessUnits.id
      description: The internal Xpanse ID for the business unit the affected asset
        belongs to.
      type: String
    - contextPath: Expanse.Service.businessUnits.name
      description: The name of the business unit the affected asset belongs to.
      type: String
    - contextPath: Expanse.Service.certificates.assetId
      description: Internal Asset ID of certificate.
      type: String
    - contextPath: Expanse.Service.certificates.firstObserved
      description: First observation of certificate.
      type: Date
    - contextPath: Expanse.Service.certificates.lastObserved
      description: Most recent observation of certificate.
      type: Date
    - contextPath: Expanse.Service.certificates.certificate.formattedIssuerOrg
      description: The formatted issuer org in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.id
      description: The Internal Xpanse certificate ID.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuer
      description: The issuer in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerAlternativeNames
      description: The issuer alternative names in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerCountry
      description: The issuer country in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerEmail
      description: The issuer email in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerLocality
      description: The issuer locality in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerName
      description: The issuer name in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerOrg
      description: The issuer org in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerOrgUnit
      description: The issuer org unit in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.issuerState
      description: The issuer state in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.md5Hash
      description: The md5hash in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.pemSha1
      description: The pemSha1 in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.pemSha256
      description: The pemSha256 in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.publicKey
      description: The public key in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.publicKeyAlgorithm
      description: The public key algorithm in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.publicKeyBits
      description: The public key bits in the certificate.
      type: Number
    - contextPath: Expanse.Service.certificates.certificate.publicKeyModulus
      description: The public key modulus in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.publicKeyRsaExponent
      description: The public key RSA exponent in the certificate.
      type: Number
    - contextPath: Expanse.Service.certificates.certificate.publicKeySpki
      description: The public key Spki in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.serialNumber
      description: The serial number in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.signatureAlgorithm
      description: The signature algorithm in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subject
      description: The subject in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectAlternativeNames
      description: The subject alternative names in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectCountry
      description: The subject country in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectEmail
      description: The subject email in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectLocality
      description: The subject locality in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectName
      description: The subject name in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectOrg
      description: The subject org in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectOrgUnit
      description: The subject org unit in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.subjectState
      description: The subject state in the certificate.
      type: String
    - contextPath: Expanse.Service.certificates.certificate.validNotAfter
      description: The valid not after date in the certificate.
      type: Date
    - contextPath: Expanse.Service.certificates.certificate.validNotBefore
      description: The valid not before date in the certificate.
      type: Date
    - contextPath: Expanse.Service.certificates.certificate.version
      description: The version in the certificate.
      type: String
    - contextPath: Expanse.Service.classifications.details.firstObserved
      description: When the service instance was first observed.
      type: Date
    - contextPath: Expanse.Service.classifications.details.lastObserved
      description: When the service instance was last observed.
      type: Date
    - contextPath: Expanse.Service.classifications.details.value.applicationServerSoftware
      description: Application Server Software value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.bgpOpenResponse
      description: BGP Open value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.bgpNotificationResponse.data
      description: BGP Notification Data value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.bgpNotificationResponse.errorCode
      description: BGP Notification Error Code value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.bgpNotificationResponse.errorSubCode
      description: BGP Notification Sub-Error Code value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.bindVersions
      description: Bind version value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.certificateId
      description: Certificate Id value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.connectResponse.statusCode
      description: Connect Response Status Code value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.connectResponse.responseLines
      description: Connect Response Response value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.credSspProtocol
      description: Cred SSP Protocol of the service classification.
      type: Boolean
    - contextPath: Expanse.Service.classifications.details.value.exchanges.request.arguments
      description: Exchange Request Arguments value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.exchanges.request.command
      description: Exchange Request Command value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.exchanges.response.statusCode
      description: Connect Response Status Code value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.exchanges.response.responseLines
      description: Connect Response Response value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.extraInfo
      description: Extra Info about the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.htmlPasswordAction
      description: HTML Password Action value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.htmlPasswordField
      description: HTML Password Field value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.htmlPasswordAction
      description: HTML Password Action value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.httpAuthenticationMethods
      description: HTTP Authentication Methods value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.httpAuthenticationRealm
      description: HTTP Authentication Realm value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.httpHeaders.name
      description: HTTP Header name included in the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.httpHeaders.value
      description: HTTP Header value included in the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.httpStatusCode
      description: HTTP Status code of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.isEncrypted
      description: Is Encrypted service classification.
      type: Boolean
    - contextPath: Expanse.Service.classifications.details.value.isImplicit
      description: Is Implicit service classification.
      type: Boolean
    - contextPath: Expanse.Service.classifications.details.value.loadBalancer
      description: Load Balancer value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.loadBalancerPool
      description: Load Balancer Pool value of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.nativeRdpAlgorithms
      description: Native RDP Algorithms of the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.nativeRdpProtocol
      description: Native RDP Algorithms of the service classification.
      type: Boolean
    - contextPath: Expanse.Service.classifications.details.value.serverSoftware
      description: Detected Server Software the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.serverVersion
      description: Server Version details for the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.details.value.sslProtocol
      description: SSL Protocol for the service classification.
      type: Boolean
    - contextPath: Expanse.Service.classifications.details.value.validWhenScanned
      description: Whether a certificate on the service was valid at scan time.
      type: Boolean
    - contextPath: Expanse.Service.classifications.details.value.version
      description: Version details for the service classification.
      type: String
    - contextPath: Expanse.Service.classifications.firstObserved
      description: First observation of the service classification.
      type: Date
    - contextPath: Expanse.Service.classifications.id
      description: Service classification ID.
      type: String
    - contextPath: Expanse.Service.classifications.lastObserved
      description: Last observation of the service classification.
      type: Date
    - contextPath: Expanse.Service.classifications.name
      description: Service classification name.
      type: String
    - contextPath: Expanse.Service.cloudManagementStatus.id
      description: The Internal ID of the cloud management status.
      type: String
    - contextPath: Expanse.Service.cloudManagementStatus.name
      description: Name of the cloud management status.
      type: String
    - contextPath: Expanse.Service.domain.assetId
      description: The Internal Asset ID of the domain related to the service.
      type: String
    - contextPath: Expanse.Service.domain.domain
      description: The domain name related to the service.
      type: String
    - contextPath: Expanse.Service.domain.firstObserved
      description: The first observation of a domain related to the service.
      type: Date
    - contextPath: Expanse.Service.domain.lastObserved
      description: The last observation of a domain related to the service.
      type: Date
    - contextPath: Expanse.Service.discoveryInfo.type
      description: Whether the service was directly discovered or colocated.
      type: String
    - contextPath: Expanse.Service.firstObserved
      description: First observation of the service.
      type: Date
    - contextPath: Expanse.Service.id
      description: The internal Xpanse ID of the service.
      type: String
    - contextPath: Expanse.Service.ips.assetId
      description: The Internal Asset ID of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.firstObserved
      description: First observation of the ip related to the service.
      type: Date
    - contextPath: Expanse.Service.ips.geolocation.city
      description: Geolocation city of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.geolocation.countryCode
      description: Geolocation country of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.geolocation.latitude
      description: Geolocation latitude of the ip related to the service.
      type: Number
    - contextPath: Expanse.Service.ips.geolocation.longitude
      description: Geolocation longitude of the ip related to the service.
      type: Number
    - contextPath: Expanse.Service.ips.geolocation.regionCode
      description: Geolocation region of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.geolocation.timeZone
      description: Geolocation timeZone of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.ip
      description: IPv4 Address of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.lastObserved
      description: Last observation of the ip related to the service.
      type: Date
    - contextPath: Expanse.Service.ips.provider.id
      description: Provider ID of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.provider.name
      description: provider name of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.ips.transportProtocol
      description: Transport protocol of the ip related to the service.
      type: String
    - contextPath: Expanse.Service.lastObserved
      description: Last observation of the service.
      type: Date
    - contextPath: Expanse.Service.name
      description: Summary of the service observation.
      type: String
    - contextPath: Expanse.Service.portNumber
      description: Summary of the service observation.
      type: Number
    - contextPath: Expanse.Service.tlsVersions.cipherSuite
      description: Cipher suite of the TLS version observed on the service.
      type: String
    - contextPath: Expanse.Service.tlsVersions.firstObserved
      description: First observation of the TLS version observed on the service.
      type: Date
    - contextPath: Expanse.Service.tlsVersions.lastObserved
      description: Last observation of the TLS version observed on the service.
      type: Date
    - contextPath: Expanse.Service.tlsVersions.tlsVersion
      description: TLS version observed on the service.
      type: String
  - arguments:
    - description: Maximum number of issues to retrieve.
      name: limit
    - description: Returns only results whose contents match the given query.
      name: content_search
    - description: Returns only results that were found on the given providers (comma
        separated string).
      isArray: true
      name: provider
    - description: Returns only results with a business unit whose name falls in the
        provided list (comma separated string).
      isArray: true
      name: business_unit
    - description: Returns only results whose assignee's username matches one of the
        given usernames. Use "Unassigned" to fetch issues that are not assigned to
        any user.
      isArray: true
      name: assignee
    - description: Returns only results whose issue type name matches one of the given
        types (comma separated string).
      isArray: true
      name: issue_type
    - description: Returns results whose identifier includes an IP matching the query.
        Search for results in a given IP/CIDR block using a single IP (d.d.d.d), a
        dashed IP range (d.d.d.d-d.d.d.d), a CIDR block (d.d.d.d/m), a partial CIDR
        (d.d.), or a wildcard (d.d.*.d).
      name: inet_search
    - description: Returns results whose identifier includes a domain matching the
        query.
      name: domain_search
    - description: Returns only results whose identifier includes one of the given
        port numbers (comma separated list).
      isArray: true
      name: port_number
    - description: Returns only results whose priority matches one of the given values
        (comma separated string, options are 'Low', 'Medium', 'High', 'Critical').
      isArray: true
      name: priority
    - description: Returns only results whose progress status matches one of the given
        values (comma separated string, options are 'New', 'Investigating', 'InProgress',
        'AcceptableRisk', 'Resolved').
      isArray: true
      name: progress_status
    - auto: PREDEFINED
      description: Returns only results whose activity status matches one of the given
        values.
      isArray: true
      name: activity_status
      predefined:
      - Active
      - Inactive
    - description: Returns only results that are associated with the provided tag
        names (comma separated string).
      isArray: true
      name: tag
    - description: Returns only results created before the provided timestamp (ISO8601
        format YYYY-MM-DDTHH:MM:SSZ).
      name: created_before
    - description: Returns only results created after the provided timestamp (ISO8601
        format YYYY-MM-DDTHH:MM:SSZ).
      name: created_after
    - description: Returns only results modified before the provided timestamp (ISO8601
        format YYYY-MM-DDTHH:MM:SSZ).
      name: modified_before
    - description: Returns only results modified after the provided timestamp (ISO8601
        format YYYY-MM-DDTHH:MM:SSZ).
      name: modified_after
    - auto: PREDEFINED
      description: Returns only results whose cloud management status is the following.
        (comma separated string, options are 'NotApplicable', 'ManagedCloud', 'UnmanagedCloud').
      isArray: true
      name: cloud_management_status
      predefined:
      - NotApplicable
      - ManagedCloud
      - UnmanagedCloud
    - auto: PREDEFINED
      defaultValue: created
      description: Sort by specified properties.
      isArray: true
      name: sort
      predefined:
      - created
      - -created
      - modified
      - -modified
      - activityStatus
      - -assigneeUsername
      - priority
      - -priority
      - progressStatus
      - -progressStatus
      - activityStatus
      - -activityStatus
      - headline
      - -headline
    description: Retrieve issues.
    name: expanse-get-issues
    outputs:
    - contextPath: Expanse.Issue.activityStatus
      description: Activity status of issue, whether the issue is active or inactive.
      type: String
    - contextPath: Expanse.Issue.annotations.tags.id
      description: The Internal Xpanse tag id of the customer added tag.
      type: String
    - contextPath: Expanse.Issue.annotations.tags.name
      description: The tag name of the customer added tag.
      type: String
    - contextPath: Expanse.Issue.assets.assetKey
      description: Key used to access the asset in the respective Xpanse asset API.
      type: String
    - contextPath: Expanse.Issue.assets.assetType
      description: The type of asset the issue primarily relates to.
      type: String
    - contextPath: Expanse.Issue.assets.displayName
      description: A friendly name for the asset.
      type: String
    - contextPath: Expanse.Issue.assets.id
      description: Internal Xpanse ID the asset.
      type: String
    - contextPath: Expanse.Issue.assigneeUsername
      description: The username of the user that has been assigned to the issue.
      type: String
    - contextPath: Expanse.Issue.businessUnits.id
      description: The internal Xpanse ID for the business unit the affected asset
        belongs to.
      type: String
    - contextPath: Expanse.Issue.businessUnits.name
      description: The name of the business unit the affected asset belongs to.
      type: String
    - contextPath: Expanse.Issue.category
      description: The general category of the issue.
      type: String
    - contextPath: Expanse.Issue.certificate.formattedIssuerOrg
      description: The formatted issuer org in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.id
      description: The Internal Xpanse certificate ID.
      type: String
    - contextPath: Expanse.Issue.certificate.issuer
      description: The issuer in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerAlternativeNames
      description: The issuer alternative names in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerCountry
      description: The issuer country in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerEmail
      description: The issuer email in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerLocality
      description: The issuer locality in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerName
      description: The issuer name in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerOrg
      description: The issuer org in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerOrgUnit
      description: The issuer org unit in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerState
      description: The issuer state in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.md5Hash
      description: The md5hash in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.pemSha1
      description: The pemSha1 in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.pemSha256
      description: The pemSha256 in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.publicKey
      description: The public key in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.publicKeyAlgorithm
      description: The public key algorithm in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.publicKeyBits
      description: The public key bits in the certificate.
      type: Number
    - contextPath: Expanse.Issue.certificate.publicKeyModulus
      description: The public key modulus in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.publicKeyRsaExponent
      description: The public key RSA exponent in the certificate.
      type: Number
    - contextPath: Expanse.Issue.certificate.publicKeySpki
      description: The public key Spki in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.serialNumber
      description: The serial number in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.signatureAlgorithm
      description: The signature algorithm in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subject
      description: The subject in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectAlternativeNames
      description: The subject alternative names in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectCountry
      description: The subject country in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectEmail
      description: The subject email in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectLocality
      description: The subject locality in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectName
      description: The subject name in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectOrg
      description: The subject org in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectOrgUnit
      description: The subject org unit in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectState
      description: The subject state in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.validNotAfter
      description: The valid not after date in the certificate.
      type: Date
    - contextPath: Expanse.Issue.certificate.validNotBefore
      description: The valid not before date in the certificate.
      type: Date
    - contextPath: Expanse.Issue.certificate.version
      description: The version in the certificate.
      type: String
    - contextPath: Expanse.Issue.cloudManagementStatus.id
      description: The id of the cloud management status.
      type: String
    - contextPath: Expanse.Issue.cloudManagementStatus.name
      description: The name of the cloud management status.
      type: String
    - contextPath: Expanse.Issue.created
      description: When the issue instance was created.
      type: Date
    - contextPath: Expanse.Issue.domain
      description: Domain name of the issue.
      type: String
    - contextPath: Expanse.Issue.headline
      description: A brief summary of the issue.
      type: String
    - contextPath: Expanse.Issue.helpText
      description: Why Xpanse this type of issue should be avoided.
      type: String
    - contextPath: Expanse.Issue.id
      description: The internal Xpanse ID of the issue.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.formattedIssuerOrg
      description: The formatted issuer org in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.id
      description: The Internal Xpanse certificate ID in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuer
      description: The issuer in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerAlternativeNames
      description: The issuer alternative names in the certificate in the initial
        observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerCountry
      description: The issuer country in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerEmail
      description: The issuer email in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerLocality
      description: The issuer locality in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerName
      description: The issuer name in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerOrg
      description: The issuer org in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerOrgUnit
      description: The issuer org unit in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerState
      description: The issuer state in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.md5Hash
      description: The md5hash in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.pemSha1
      description: The pemSha1 in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.pemSha256
      description: The pemSha256 in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.publicKey
      description: The public key in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.publicKeyAlgorithm
      description: The public key algorithm in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.publicKeyBits
      description: The public key bits in the certificate in the initial observation.
      type: Number
    - contextPath: Expanse.Issue.initialEvidence.certificate.publicKeyModulus
      description: The public key modulus in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.publicKeyRsaExponent
      description: The public key RSA exponent in the certificate in the initial observation.
      type: Number
    - contextPath: Expanse.Issue.initialEvidence.certificate.publicKeySpki
      description: The public key Spki in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.serialNumber
      description: The serial number in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.signatureAlgorithm
      description: The signature algorithm in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subject
      description: The subject in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectAlternativeNames
      description: The subject alternative names in the certificate in the initial
        observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectCountry
      description: The subject country in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectEmail
      description: The subject email in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectLocality
      description: The subject locality in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectName
      description: The subject name in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectOrg
      description: The subject org in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectOrgUnit
      description: The subject org unit in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectState
      description: The subject state in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.validNotAfter
      description: The valid not after date in the certificate in the initial observation.
      type: Date
    - contextPath: Expanse.Issue.initialEvidence.certificate.validNotBefore
      description: The valid not before date in the certificate in the initial observation.
      type: Date
    - contextPath: Expanse.Issue.initialEvidence.certificate.version
      description: The version in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.cipherSuite
      description: The cipher suite in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.configuration._type
      description: The type of configuration data in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.configuration.validWhenScanned
      description: Whether the configuration was valid in the initial observation.
      type: Boolean
    - contextPath: Expanse.Issue.initialEvidence.discoveryType
      description: The discovery type in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.domain
      description: The domain name in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.evidenceType
      description: The evidence type of the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.exposureId
      description: The exposure ID in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.exposureType
      description: The exposure type in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.geolocation.latitude
      description: The latitude in the initial observation.
      type: Number
    - contextPath: Expanse.Issue.initialEvidence.geolocation.longitude
      description: The longitude in the initial observation.
      type: Number
    - contextPath: Expanse.Issue.initialEvidence.geolocation.city
      description: The city name in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.geolocation.regionCode
      description: The region code in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.geolocation.countryCode
      description: The country code in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.ip
      description: The IPv4 address in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.portNumber
      description: The port number in the initial observation.
      type: Number
    - contextPath: Expanse.Issue.initialEvidence.portProtocol
      description: The port protocol in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.serviceId
      description: The Service ID in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.serviceProperties.serviceProperties.name
      description: The service property name in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.serviceProperties.serviceProperties.reason
      description: The service property reason in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.timestamp
      description: The timestamp of the initial observation.
      type: Date
    - contextPath: Expanse.Issue.initialEvidence.tlsVersion
      description: The TLS version found in the initial observation.
      type: String
    - contextPath: Expanse.Issue.ip
      description: The IPv4 address last associated with the issue.
      type: String
    - contextPath: Expanse.Issue.issueType.archived
      description: Whether the issue type is archived.
      type: Boolean
    - contextPath: Expanse.Issue.issueType.id
      description: The ID of the issue type.
      type: String
    - contextPath: Expanse.Issue.issueType.name
      description: The name of the issue type.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.formattedIssuerOrg
      description: The formatted issuer org in the certificate in the most recent
        observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.id
      description: The Internal Xpanse certificate ID in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuer
      description: The issuer in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerAlternativeNames
      description: The issuer alternative names in the certificate in the most recent
        observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerCountry
      description: The issuer country in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerEmail
      description: The issuer email in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerLocality
      description: The issuer locality in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerName
      description: The issuer name in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerOrg
      description: The issuer org in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerOrgUnit
      description: The issuer org unit in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerState
      description: The issuer state in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.md5Hash
      description: The md5hash in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.pemSha1
      description: The pemSha1 in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.pemSha256
      description: The pemSha256 in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.publicKey
      description: The public key in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.publicKeyAlgorithm
      description: The public key algorithm in the certificate in the most recent
        observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.publicKeyBits
      description: The public key bits in the certificate in the most recent observation.
      type: Number
    - contextPath: Expanse.Issue.latestEvidence.certificate.publicKeyModulus
      description: The public key modulus in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.publicKeyRsaExponent
      description: The public key RSA exponent in the certificate in the most recent
        observation.
      type: Number
    - contextPath: Expanse.Issue.latestEvidence.certificate.publicKeySpki
      description: The public key Spki in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.serialNumber
      description: The serial number in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.signatureAlgorithm
      description: The signature algorithm in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subject
      description: The subject in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectAlternativeNames
      description: The subject alternative names in the certificate in the most recent
        observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectCountry
      description: The subject country in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectEmail
      description: The subject email in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectLocality
      description: The subject locality in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectName
      description: The subject name in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectOrg
      description: The subject org in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectOrgUnit
      description: The subject org unit in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectState
      description: The subject state in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.validNotAfter
      description: The valid not after date in the certificate in the most recent
        observation.
      type: Date
    - contextPath: Expanse.Issue.latestEvidence.certificate.validNotBefore
      description: The valid not before date in the certificate in the most recent
        observation.
      type: Date
    - contextPath: Expanse.Issue.latestEvidence.certificate.version
      description: The version in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.cipherSuite
      description: The cipher suite detected during the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.configuration._type
      description: The type of configuration data in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.configuration.validWhenScanned
      description: Whether the configuration was valid in the most recent observation.
      type: Boolean
    - contextPath: Expanse.Issue.latestEvidence.discoveryType
      description: The discovery type in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.domain
      description: The domain name in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.evidenceType
      description: The evidence type of the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.exposureId
      description: The exposure ID in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.exposureType
      description: The exposure type in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.geolocation.latitude
      description: The latitude in the most recent observation.
      type: Number
    - contextPath: Expanse.Issue.latestEvidence.geolocation.longitude
      description: The latitude in the most recent observation.
      type: Number
    - contextPath: Expanse.Issue.latestEvidence.geolocation.city
      description: The city name in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.geolocation.regionCode
      description: The region code in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.geolocation.countryCode
      description: The country code in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.ip
      description: The IPv4 address in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.portNumber
      description: The port number in the most recent observation.
      type: Number
    - contextPath: Expanse.Issue.latestEvidence.portProtocol
      description: The port protocol in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.serviceId
      description: The Service ID in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.serviceProperties.serviceProperties.name
      description: The service property name in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.serviceProperties.serviceProperties.reason
      description: The service property reason in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.timestamp
      description: The timestamp of the most recent observation.
      type: Date
    - contextPath: Expanse.Issue.latestEvidence.tlsVersion
      description: The TLS version found in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.modified
      description: The timestamp of when the issue was last modified.
      type: Date
    - contextPath: Expanse.Issue.portNumber
      description: The port number the issue was detected on.
      type: Number
    - contextPath: Expanse.Issue.portProtocol
      description: The port protocol the issue was detected on.
      type: String
    - contextPath: Expanse.Issue.priority
      description: The priority of the issue.
      type: String
    - contextPath: Expanse.Issue.progressStatus
      description: The progress status of the issue.
      type: String
    - contextPath: Expanse.Issue.providers.id
      description: The ID of the provider the issue was detected on.
      type: String
    - contextPath: Expanse.Issue.providers.name
      description: The name of the provider the issue was detected on.
      type: String
  - arguments:
    - description: Expanse issue ID to retrieve updates for.
      name: issue_id
      required: true
    - description: Update types to retrieve (comma separated string. Valid options
        are 'Assignee', 'Comment', 'Priority', 'ProgressStatus', 'ActivityStatus').
      name: update_types
    - description: Returns only updates created after the provided timestamp (ISO8601
        format YYYY-MM-DDTHH:MM:SSZ).
      name: created_after
    - description: Maximum number of results to retrieve.
      name: limit
    description: Retrieve updates for an Xpanse issue.
    name: expanse-get-issue-updates
    outputs:
    - contextPath: Expanse.IssueUpdate.created
      description: The timestamp of when the Issue update occurred.
      type: Date
    - contextPath: Expanse.IssueUpdate.id
      description: The unique ID of the issue update event.
      type: String
    - contextPath: Expanse.IssueUpdate.issue_id
      description: The unique ID of the issue that was updated.
      type: String
    - contextPath: Expanse.IssueUpdate.previousValue
      description: The previous value of the field that was updated.
      type: String
    - contextPath: Expanse.IssueUpdate.updateType
      description: The type of update that occurred, valid types are ProgressStatus,
        ActivityStatus, Priority, Assignee, and Comment.
      type: String
    - contextPath: Expanse.IssueUpdate.user.username
      description: The username of the user who made the update.
      type: String
    - contextPath: Expanse.IssueUpdate.value
      description: The new value of the field that was updated.
      type: String
  - arguments:
    - description: Expanse issue ID to retrieve updates for.
      name: issue_id
      required: true
    - description: Returns only comments created after the provided timestamp (ISO8601
        format YYYY-MM-DDTHH:MM:SSZ).
      name: created_after
    description: Retrieve issue comments (subset of updates).
    name: expanse-get-issue-comments
    outputs:
    - contextPath: Expanse.IssueComment.created
      description: The timestamp of when the Issue update occurred.
      type: Date
    - contextPath: Expanse.IssueComment.id
      description: The unique ID of the issue update event.
      type: String
    - contextPath: Expanse.IssueComment.issue_id
      description: The unique ID of the issue that was updated.
      type: String
    - contextPath: Expanse.IssueComment.previousValue
      description: The previous value of the field that was updated.
      type: String
    - contextPath: Expanse.IssueComment.updateType
      description: The type of update that occurred, valid types are ProgressStatus,
        ActivityStatus, Priority, Assignee, and Comment.
      type: String
    - contextPath: Expanse.IssueComment.user.username
      description: The username of the user who made the update.
      type: String
    - contextPath: Expanse.IssueComment.value
      description: The new value of the field that was updated.
      type: String
  - arguments:
    - description: Xpanse issue ID to update.
      name: issue_id
      required: true
    - auto: PREDEFINED
      defaultValue: "false"
      description: Type of update.
      isArray: true
      name: update_type
      predefined:
      - Assignee
      - Comment
      - Priority
      - ProgressStatus
      required: true
    - description: Updated value.
      name: value
      required: true
    description: Update a property of an Xpanse issue.
    name: expanse-update-issue
    outputs:
    - contextPath: Expanse.IssueUpdate.created
      description: The timestamp of when the Issue update occurred.
      type: Date
    - contextPath: Expanse.IssueUpdate.id
      description: The unique ID of the issue update event.
      type: String
    - contextPath: Expanse.IssueUpdate.issue_id
      description: The unique ID of the issue that was updated.
      type: String
    - contextPath: Expanse.IssueUpdate.previousValue
      description: The previous value of the field that was updated.
      type: String
    - contextPath: Expanse.IssueUpdate.updateType
      description: The type of update that occurred, valid types are ProgressStatus,
        ActivityStatus, Priority, Assignee, and Comment.
      type: String
    - contextPath: Expanse.IssueUpdate.user.username
      description: The username of the user who made the update.
      type: String
    - contextPath: Expanse.IssueUpdate.value
      description: The new value of the field that was updated.
      type: String
  - arguments:
    - description: ID of the Xpanse issue to retrieve.
      name: issue_id
      required: true
    description: Retrieve Xpanse issue by issue ID.
    name: expanse-get-issue
    outputs:
    - contextPath: Expanse.Issue.activityStatus
      description: Activity status of issue, whether the issue is active or inactive.
      type: String
    - contextPath: Expanse.Issue.annotations.tags.id
      description: The Internal Xpanse tag id of the customer added tag.
      type: String
    - contextPath: Expanse.Issue.annotations.tags.name
      description: The tag name of the customer added tag.
      type: String
    - contextPath: Expanse.Issue.assets.assetKey
      description: Key used to access the asset in the respective Xpanse asset API.
      type: String
    - contextPath: Expanse.Issue.assets.assetType
      description: The type of asset the issue primarily relates to.
      type: String
    - contextPath: Expanse.Issue.assets.displayName
      description: A friendly name for the asset.
      type: String
    - contextPath: Expanse.Issue.assets.id
      description: Internal Xpanse ID the asset.
      type: String
    - contextPath: Expanse.Issue.assigneeUsername
      description: The username of the user that has been assigned to the issue.
      type: String
    - contextPath: Expanse.Issue.businessUnits.id
      description: The internal Xpanse ID for the business unit the affected asset
        belongs to.
      type: String
    - contextPath: Expanse.Issue.businessUnits.name
      description: The name of the business unit the affected asset belongs to.
      type: String
    - contextPath: Expanse.Issue.category
      description: The general category of the issue.
      type: String
    - contextPath: Expanse.Issue.certificate.formattedIssuerOrg
      description: The formatted issuer org in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.id
      description: The Internal Xpanse certificate ID.
      type: String
    - contextPath: Expanse.Issue.certificate.issuer
      description: The issuer in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerAlternativeNames
      description: The issuer alternative names in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerCountry
      description: The issuer country in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerEmail
      description: The issuer email in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerLocality
      description: The issuer locality in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerName
      description: The issuer name in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerOrg
      description: The issuer org in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerOrgUnit
      description: The issuer org unit in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.issuerState
      description: The issuer state in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.md5Hash
      description: The md5hash in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.pemSha1
      description: The pemSha1 in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.pemSha256
      description: The pemSha256 in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.publicKey
      description: The public key in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.publicKeyAlgorithm
      description: The public key algorithm in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.publicKeyBits
      description: The public key bits in the certificate.
      type: Number
    - contextPath: Expanse.Issue.certificate.publicKeyModulus
      description: The public key modulus in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.publicKeyRsaExponent
      description: The public key RSA exponent in the certificate.
      type: Number
    - contextPath: Expanse.Issue.certificate.publicKeySpki
      description: The public key Spki in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.serialNumber
      description: The serial number in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.signatureAlgorithm
      description: The signature algorithm in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subject
      description: The subject in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectAlternativeNames
      description: The subject alternative names in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectCountry
      description: The subject country in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectEmail
      description: The subject email in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectLocality
      description: The subject locality in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectName
      description: The subject name in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectOrg
      description: The subject org in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectOrgUnit
      description: The subject org unit in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.subjectState
      description: The subject state in the certificate.
      type: String
    - contextPath: Expanse.Issue.certificate.validNotAfter
      description: The valid not after date in the certificate.
      type: Date
    - contextPath: Expanse.Issue.certificate.validNotBefore
      description: The valid not before date in the certificate.
      type: Date
    - contextPath: Expanse.Issue.certificate.version
      description: The version in the certificate.
      type: String
    - contextPath: Expanse.Issue.cloudManagementStatus.id
      description: The ID of the cloud management status.
      type: String
    - contextPath: Expanse.Issue.cloudManagementStatus.name
      description: The name of the cloud management status.
      type: String
    - contextPath: Expanse.Issue.created
      description: When the issue instance was created.
      type: Date
    - contextPath: Expanse.Issue.domain
      description: Domain name of the issue.
      type: String
    - contextPath: Expanse.Issue.headline
      description: A brief summary of the issue.
      type: String
    - contextPath: Expanse.Issue.helpText
      description: Why Xpanse this type of issue should be avoided.
      type: String
    - contextPath: Expanse.Issue.id
      description: The internal Xpanse ID of the issue.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.formattedIssuerOrg
      description: The formatted issuer org in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.id
      description: The Internal Xpanse certificate ID in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuer
      description: The issuer in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerAlternativeNames
      description: The issuer alternative names in the certificate in the initial
        observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerCountry
      description: The issuer country in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerEmail
      description: The issuer email in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerLocality
      description: The issuer locality in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerName
      description: The issuer name in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerOrg
      description: The issuer org in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerOrgUnit
      description: The issuer org unit in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.issuerState
      description: The issuer state in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.md5Hash
      description: The md5hash in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.pemSha1
      description: The pemSha1 in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.pemSha256
      description: The pemSha256 in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.publicKey
      description: The public key in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.publicKeyAlgorithm
      description: The public key algorithm in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.publicKeyBits
      description: The public key bits in the certificate in the initial observation.
      type: Number
    - contextPath: Expanse.Issue.initialEvidence.certificate.publicKeyModulus
      description: The public key modulus in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.publicKeyRsaExponent
      description: The public key RSA exponent in the certificate in the initial observation.
      type: Number
    - contextPath: Expanse.Issue.initialEvidence.certificate.publicKeySpki
      description: The public key Spki in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.serialNumber
      description: The serial number in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.signatureAlgorithm
      description: The signature algorithm in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subject
      description: The subject in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectAlternativeNames
      description: The subject alternative names in the certificate in the initial
        observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectCountry
      description: The subject country in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectEmail
      description: The subject email in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectLocality
      description: The subject locality in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectName
      description: The subject name in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectOrg
      description: The subject org in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectOrgUnit
      description: The subject org unit in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.subjectState
      description: The subject state in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.certificate.validNotAfter
      description: The valid not after date in the certificate in the initial observation.
      type: Date
    - contextPath: Expanse.Issue.initialEvidence.certificate.validNotBefore
      description: The valid not before date in the certificate in the initial observation.
      type: Date
    - contextPath: Expanse.Issue.initialEvidence.certificate.version
      description: The version in the certificate in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.cipherSuite
      description: The cipher suite in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.configuration._type
      description: The type of configuration data in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.configuration.validWhenScanned
      description: Whether the configuration was valid in the initial observation.
      type: Boolean
    - contextPath: Expanse.Issue.initialEvidence.discoveryType
      description: The discovery type in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.domain
      description: The domain name in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.evidenceType
      description: The evidence type of the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.exposureId
      description: The exposure ID in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.exposureType
      description: The exposure type in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.geolocation.latitude
      description: The latitude in the initial observation.
      type: Number
    - contextPath: Expanse.Issue.initialEvidence.geolocation.longitude
      description: The longitude in the initial observation.
      type: Number
    - contextPath: Expanse.Issue.initialEvidence.geolocation.city
      description: The city name in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.geolocation.regionCode
      description: The region code in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.geolocation.countryCode
      description: The country code in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.ip
      description: The IPv4 address in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.portNumber
      description: The port number in the initial observation.
      type: Number
    - contextPath: Expanse.Issue.initialEvidence.portProtocol
      description: The port protocol in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.serviceId
      description: The Service ID in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.serviceProperties.serviceProperties.name
      description: The service property name in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.serviceProperties.serviceProperties.reason
      description: The service property reason in the initial observation.
      type: String
    - contextPath: Expanse.Issue.initialEvidence.timestamp
      description: The timestamp of the initial observation.
      type: Date
    - contextPath: Expanse.Issue.initialEvidence.tlsVersion
      description: The TLS version found in the initial observation.
      type: String
    - contextPath: Expanse.Issue.ip
      description: The IPv4 address last associated with the issue.
      type: String
    - contextPath: Expanse.Issue.issueType.archived
      description: Whether the issue type is archived.
      type: Boolean
    - contextPath: Expanse.Issue.issueType.id
      description: The ID of the issue type.
      type: String
    - contextPath: Expanse.Issue.issueType.name
      description: The name of the issue type.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.formattedIssuerOrg
      description: The formatted issuer org in the certificate in the most recent
        observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.id
      description: The Internal Xpanse certificate ID in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuer
      description: The issuer in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerAlternativeNames
      description: The issuer alternative names in the certificate in the most recent
        observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerCountry
      description: The issuer country in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerEmail
      description: The issuer email in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerLocality
      description: The issuer locality in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerName
      description: The issuer name in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerOrg
      description: The issuer org in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerOrgUnit
      description: The issuer org unit in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.issuerState
      description: The issuer state in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.md5Hash
      description: The md5hash in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.pemSha1
      description: The pemSha1 in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.pemSha256
      description: The pemSha256 in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.publicKey
      description: The public key in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.publicKeyAlgorithm
      description: The public key algorithm in the certificate in the most recent
        observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.publicKeyBits
      description: The public key bits in the certificate in the most recent observation.
      type: Number
    - contextPath: Expanse.Issue.latestEvidence.certificate.publicKeyModulus
      description: The public key modulus in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.publicKeyRsaExponent
      description: The public key RSA exponent in the certificate in the most recent
        observation.
      type: Number
    - contextPath: Expanse.Issue.latestEvidence.certificate.publicKeySpki
      description: The public key Spki in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.serialNumber
      description: The serial number in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.signatureAlgorithm
      description: The signature algorithm in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subject
      description: The subject in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectAlternativeNames
      description: The subject alternative names in the certificate in the most recent
        observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectCountry
      description: The subject country in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectEmail
      description: The subject email in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectLocality
      description: The subject locality in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectName
      description: The subject name in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectOrg
      description: The subject org in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectOrgUnit
      description: The subject org unit in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.subjectState
      description: The subject state in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.certificate.validNotAfter
      description: The valid not after date in the certificate in the most recent
        observation.
      type: Date
    - contextPath: Expanse.Issue.latestEvidence.certificate.validNotBefore
      description: The valid not before date in the certificate in the most recent
        observation.
      type: Date
    - contextPath: Expanse.Issue.latestEvidence.certificate.version
      description: The version in the certificate in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.cipherSuite
      description: The cipher suite detected during the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.configuration._type
      description: The type of configuration data in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.configuration.validWhenScanned
      description: Whether the configuration was valid in the most recent observation.
      type: Boolean
    - contextPath: Expanse.Issue.latestEvidence.discoveryType
      description: The discovery type in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.domain
      description: The domain name in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.evidenceType
      description: The evidence type of the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.exposureId
      description: The exposure ID in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.exposureType
      description: The exposure type in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.geolocation.latitude
      description: The latitude in the most recent observation.
      type: Number
    - contextPath: Expanse.Issue.latestEvidence.geolocation.longitude
      description: The latitude in the most recent observation.
      type: Number
    - contextPath: Expanse.Issue.latestEvidence.geolocation.city
      description: The city name in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.geolocation.regionCode
      description: The region code in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.geolocation.countryCode
      description: The country code in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.ip
      description: The IPv4 address in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.portNumber
      description: The port number in the most recent observation.
      type: Number
    - contextPath: Expanse.Issue.latestEvidence.portProtocol
      description: The port protocol in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.serviceId
      description: The Service ID in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.serviceProperties.serviceProperties.name
      description: The service property name in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.serviceProperties.serviceProperties.reason
      description: The service property reason in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.latestEvidence.timestamp
      description: The timestamp of the most recent observation.
      type: Date
    - contextPath: Expanse.Issue.latestEvidence.tlsVersion
      description: The TLS version found in the most recent observation.
      type: String
    - contextPath: Expanse.Issue.modified
      description: The timestamp of when the issue was last modified.
      type: Date
    - contextPath: Expanse.Issue.portNumber
      description: The port number the issue was detected on.
      type: Number
    - contextPath: Expanse.Issue.portProtocol
      description: The port protocol the issue was detected on.
      type: String
    - contextPath: Expanse.Issue.priority
      description: The priority of the issue.
      type: String
    - contextPath: Expanse.Issue.progressStatus
      description: The progress status of the issue.
      type: String
    - contextPath: Expanse.Issue.providers.id
      description: The ID of the provider the issue was detected on.
      type: String
    - contextPath: Expanse.Issue.providers.name
      description: The name of the provider the issue was detected on.
      type: String
  - arguments:
    - description: Maximum number of results to retrieve.
      name: limit
    description: List available business units from Xpanse.
    name: expanse-list-businessunits
    outputs:
    - contextPath: Expanse.BusinessUnit.id
      description: Business unit ID.
      type: String
    - contextPath: Expanse.BusinessUnit.name
      description: Business unit name.
      type: String
  - arguments:
    - description: Maximum number of results to retrieve.
      name: limit
    description: List available providers from Xpanse.
    name: expanse-list-providers
    outputs:
    - contextPath: Expanse.Provider.id
      description: Provider ID.
      type: String
    - contextPath: Expanse.Provider.name
      description: Provider name.
      type: String
  - arguments:
    - description: Maximum number of results to retrieve.
      name: limit
    description: List available Point of Contacts from Xpanse.
    name: expanse-list-pocs
    outputs:
    - contextPath: Expanse.PointOfContact.created
      description: The date in which the Point of Contact was first created.
      type: Date
    - contextPath: Expanse.PointOfContact.email
      description: Email address of Point of Contact.
      type: String
    - contextPath: Expanse.PointOfContact.firstName
      description: First Name of Point of Contact.
      type: String
    - contextPath: Expanse.PointOfContact.id
      description: Internal ID of Point of Contact.
      type: String
    - contextPath: Expanse.PointOfContact.lastName
      description: Last Name of Point of Contact.
      type: String
    - contextPath: Expanse.PointOfContact.modified
      description: The date in which the Point of Contact was last modified.
      type: Date
    - contextPath: Expanse.PointOfContact.phone
      description: Phone number of Point of Contact.
      type: String
    - contextPath: Expanse.PointOfContact.role
      description: Role of Point of Contact.
      type: String
  - arguments:
    - description: Email for Point of Contact.
      name: email
      required: true
    - description: First name of Point of Contact. Should be less than 64 characters.
      name: first_name
    - description: Last name of Point of Contact. Should be less than 64 characters.
      name: last_name
    - description: Phone number of Point of Contact. Should be a numeric string (ex.
        15551234567).
      name: phone
    - description: Role of Point of Contact. Should be less than 64 characters.
      name: role
    description: Create a new Point of Contact in Xpanse.
    name: expanse-create-poc
    outputs:
    - contextPath: Expanse.PointOfContact.created
      description: The date in which the Point of Contact was first created.
      type: Date
    - contextPath: Expanse.PointOfContact.email
      description: Email address of Point of Contact.
      type: String
    - contextPath: Expanse.PointOfContact.firstName
      description: First Name of Point of Contact.
      type: String
    - contextPath: Expanse.PointOfContact.id
      description: Internal ID of Point of Contact.
      type: String
    - contextPath: Expanse.PointOfContact.lastName
      description: Last Name of Point of Contact.
      type: String
    - contextPath: Expanse.PointOfContact.modified
      description: The date in which the Point of Contact was last modified.
      type: Date
    - contextPath: Expanse.PointOfContact.phone
      description: Phone number of Point of Contact.
      type: String
    - contextPath: Expanse.PointOfContact.role
      description: Role of Point of Contact.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: Type of Xpanse asset to assign the poc to.
      name: asset_type
      predefined:
      - IpRange
      - Certificate
      - Domain
      - CloudResource
      - Network
      - Device
      - ResponsiveIP
      required: true
    - description: ID of the asset to assign the poc to.
      name: asset_id
      required: true
    - description: IDs of the pocs to assign to the asset (comma separated string).
        If used in combination with 'poc_emails' the lists of pocs are merged. At
        least one poc ID or poc email must be provided.
      isArray: true
      name: pocs
    - description: Email Addresses of the pocs to assign to the asset (comma separated
        string). If used in combination with 'pocs' the lists of pocs are merged.
        At least one poc ID or poc email must be provided.
      isArray: true
      name: poc_emails
    description: Assign Point of Contacts to an Xpanse asset.
    name: expanse-assign-pocs-to-asset
  - arguments:
    - auto: PREDEFINED
      description: Type of Xpanse asset to unassign the pocs from.
      name: asset_type
      predefined:
      - IpRange
      - Certificate
      - Domain
      - CloudResource
      - Network
      - Device
      - ResponsiveIP
      required: true
    - description: ID of the asset to unassign the pocs from.
      name: asset_id
      required: true
    - description: IDs of the pocs to unassign from the asset (comma separated string).
        If used in combination with 'poc_emails' the lists of pocs are merged. At
        least one poc ID or poc email must be provided.
      isArray: true
      name: pocs
    - description: Names of the pocs to unassign from the asset (comma separated string).
        If used in combination with 'pocs' the lists of pocs are merged. At least
        one poc ID or poc email must be provided.
      isArray: true
      name: poc_emails
    description: Unassign Point of Contacts from an Xpanse Asset.
    name: expanse-unassign-pocs-from-asset
  - arguments:
    - description: ID of the IP range to assign pocs to.
      name: asset_id
      required: true
    - description: IDs of the pocs to assign to the IP range (comma separated string).
        If used in combination with 'poc_emails' the lists of pocs are merged. At
        least one poc ID or poc email must be provided.
      isArray: true
      name: pocs
    - description: Emails of the pocs to assign to the IP range (comma separated string).
        If used in combination with 'pocs' the lists of pocs are merged. At least
        one poc ID or poc email must be provided.
      isArray: true
      name: poc_emails
    description: Assign Point of Contacts to an Xpanse IP range.
    name: expanse-assign-pocs-to-iprange
  - arguments:
    - description: ID of the IP range to unassign pocs from.
      name: asset_id
      required: true
    - description: IDs of the pocs to unassign from the IP range (comma separated
        string). If used in combination with 'poc_emails' the lists of pocs are merged.
        At least one poc ID or poc email must be provided.
      isArray: true
      name: pocs
    - description: Names of the pocs to unassign from the IP range (comma separated
        string). If used in combination with 'pocs' the lists of pocs are merged.
        At least one poc ID or poc email must be provided.
      isArray: true
      name: poc_emails
    description: Unassign Point of Contacts from an Xpanse IP range.
    name: expanse-unassign-pocs-from-iprange
  - arguments:
    - description: ID of the certificate to assign pocs to.
      name: asset_id
      required: true
    - description: IDs of the pocs to assign to the certificate (comma separated string).
        If used in combination with 'poc_emails' the lists of pocs are merged. At
        least one poc ID or poc email must be provided.
      isArray: true
      name: pocs
    - description: Emails of the pocs to assign to the certificate (comma separated
        string). If used in combination with 'pocs' the lists of pocs are merged.
        At least one poc ID or poc email must be provided.
      isArray: true
      name: poc_emails
    description: Assign pocs to an Xpanse certificate.
    name: expanse-assign-pocs-to-certificate
  - arguments:
    - description: ID of the certificate to assign pocs to.
      name: asset_id
      required: true
    - description: IDs of the pocs to unassign from the certificate (comma separated
        string). If used in combination with 'poc_emails' the lists of pocs are merged.
        At least one poc ID or poc email must be provided.
      isArray: true
      name: pocs
    - description: Emails of the pocs to unassign from the certificate (comma separated
        string). If used in combination with 'pocs' the lists of pocs are merged.
        At least one poc ID or poc email must be provided.
      isArray: true
      name: poc_emails
    description: Unassign pocs from an Xpanse certificate.
    name: expanse-unassign-pocs-from-certificate
  - arguments:
    - description: ID of the domain to assign pocs to.
      name: asset_id
      required: true
    - description: IDs of the pocs to assign to the domain (comma separated string).
        If used in combination with 'poc_emails' the lists of pocs are merged. At
        least one poc ID or poc email must be provided.
      isArray: true
      name: pocs
    - description: Emails of the pocs to assign to the domain (comma separated string).
        If used in combination with 'pocs' the lists of pocs are merged. At least
        one poc ID or poc email must be provided.
      isArray: true
      name: poc_emails
    description: Assign pocs to an Xpanse domain.
    name: expanse-assign-pocs-to-domain
  - arguments:
    - description: ID of the domain to unassign pocs from.
      name: asset_id
      required: true
    - description: IDs of the pocs to unassign from the domain (comma separated string).
        If used in combination with 'poc_emails' the lists of pocs are merged. At
        least one poc ID or poc email must be provided.
      isArray: true
      name: pocs
    - description: Emails of the pocs to unassign from the domain (comma separated
        string). If used in combination with 'pocs' the lists of pocs are merged.
        At least one poc ID or poc email must be provided.
      isArray: true
      name: poc_emails
    description: Unassign pocs from an Xpanse domain.
    name: expanse-unassign-pocs-from-domain
  - arguments:
    - description: Maximum number of results to retrieve.
      name: limit
    description: List available tags from Xpanse.
    name: expanse-list-tags
    outputs:
    - contextPath: Expanse.Tag.created
      description: The date in which the tag was first created.
      type: Date
    - contextPath: Expanse.Tag.description
      description: The description associated with the tag.
      type: String
    - contextPath: Expanse.Tag.disabled
      description: If the tag should be hidden as a tag option in the Expander UI.
      type: Boolean
    - contextPath: Expanse.Tag.id
      description: The Xpanse ID for the tag.
      type: String
    - contextPath: Expanse.Tag.modified
      description: The date in which metadata about the tag was last modified.
      type: Date
    - contextPath: Expanse.Tag.name
      description: The display name for the tag.
      type: String
    - contextPath: Expanse.Tag.tenantId
      description: The tenant ID associated with the tag.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: Type of Xpanse asset to assign the tag to.
      name: asset_type
      predefined:
      - IpRange
      - Certificate
      - Domain
      - CloudResource
      - Network
      - Device
      - ResponsiveIP
      required: true
    - description: ID of the asset to assign the tags to.
      name: asset_id
      required: true
    - description: IDs of the tags to assign to the asset (comma separated string).
        If used in combination with 'tag_names' the lists of tags are merged.
      isArray: true
      name: tags
    - description: Names of the tags to assign to the asset (comma separated string).
        If used in combination with 'tags' the lists of tags are merged.
      isArray: true
      name: tag_names
    description: Assign tags to an Xpanse asset.
    name: expanse-assign-tags-to-asset
  - arguments:
    - auto: PREDEFINED
      description: Type of Xpanse asset to unassign the tags from.
      name: asset_type
      predefined:
      - IpRange
      - Certificate
      - Domain
      - CloudResource
      - Network
      - Device
      - ResponsiveIP
      required: true
    - description: ID of the asset to unassign the tags from.
      name: asset_id
      required: true
    - description: IDs of the tags to unassign from the asset (comma separated string).
        If used in combination with 'tag_names' the lists of tags are merged.
      isArray: true
      name: tags
    - description: Names of the tags to unassign from the asset (comma separated string).
        If used in combination with 'tags' the lists of tags are merged.
      isArray: true
      name: tag_names
    description: Unassign tags from an Xpanse Asset.
    name: expanse-unassign-tags-from-asset
  - arguments:
    - description: ID of the IP range to assign tags to.
      name: asset_id
      required: true
    - description: IDs of the tags to assign to the IP range (comma separated string).
        If used in combination with 'tag_names' the lists of tags are merged.
      isArray: true
      name: tags
    - description: Names of the tags to assign to the IP range (comma separated string).
        If used in combination with 'tags' the lists of tags are merged.
      isArray: true
      name: tag_names
    description: Assign tags to an Xpanse IP range.
    name: expanse-assign-tags-to-iprange
  - arguments:
    - description: ID of the IP range to unassign tags from.
      name: asset_id
      required: true
    - description: IDs of the tags to unassign from the IP range (comma separated
        string). If used in combination with 'tag_names' the lists of tags are merged.
      isArray: true
      name: tags
    - description: Names of the tags to unassign from the IP range (comma separated
        string). If used in combination with 'tags' the lists of tags are merged.
      isArray: true
      name: tag_names
    description: Unassign tags from an Xpanse IP range.
    name: expanse-unassign-tags-from-iprange
  - arguments:
    - description: ID of the certificate to assign tags to.
      name: asset_id
      required: true
    - description: IDs of the tags to assign to the certificate (comma separated string).
        If used in combination with 'tag_names' the lists of tags are merged.
      isArray: true
      name: tags
    - description: Names of the tags to assign to the certificate (comma separated
        string). If used in combination with 'tags' the lists of tags are merged.
      isArray: true
      name: tag_names
    description: Assign tags to an Xpanse certificate.
    name: expanse-assign-tags-to-certificate
  - arguments:
    - description: ID of the certificate to assign tags to.
      name: asset_id
      required: true
    - description: IDs of the tags to unassign from the certificate (comma separated
        string). If used in combination with 'tag_names' the lists of tags are merged.
      isArray: true
      name: tags
    - description: Names of the tags to unassign from the certificate (comma separated
        string). If used in combination with 'tags' the lists of tags are merged.
      isArray: true
      name: tag_names
    description: Unassign tags from an Xpanse certificate.
    name: expanse-unassign-tags-from-certificate
  - arguments:
    - description: ID of the domain to assign tags to.
      name: asset_id
      required: true
    - description: IDs of the tags to assign to the domain (comma separated string).
        If used in combination with 'tag_names' the lists of tags are merged.
      isArray: true
      name: tags
    - description: Names of the tags to assign to the domain (comma separated string).
        If used in combination with 'tags' the lists of tags are merged.
      isArray: true
      name: tag_names
    description: Assign tags to an Xpanse domain.
    name: expanse-assign-tags-to-domain
  - arguments:
    - description: ID of the domain to unassign tags from.
      name: asset_id
      required: true
    - description: IDs of the tags to unassign from the domain (comma separated string).
        If used in combination with 'tag_names' the lists of tags are merged.
      isArray: true
      name: tags
    - description: Names of the tags to unassign from the domain (comma separated
        string). If used in combination with 'tags' the lists of tags are merged.
      isArray: true
      name: tag_names
    description: Unassign tags from an Xpanse domain.
    name: expanse-unassign-tags-from-domain
  - arguments:
    - description: Name of the tag (less than 128 characters).
      name: name
      required: true
    - description: Description of the tag (less than 512 characters).
      name: description
    description: Create a new tag in Xpanse.
    name: expanse-create-tag
    outputs:
    - contextPath: Expanse.Tag.created
      description: The date in which the tag was first created.
      type: Date
    - contextPath: Expanse.Tag.description
      description: The description associated with the tag.
      type: String
    - contextPath: Expanse.Tag.disabled
      description: If the tag should be hidden as a tag option in the Expander UI.
      type: Boolean
    - contextPath: Expanse.Tag.id
      description: The Xpanse ID for the tag.
      type: String
    - contextPath: Expanse.Tag.modified
      description: The date in which metadata about the tag was last modified.
      type: Date
    - contextPath: Expanse.Tag.name
      description: The display name for the tag.
      type: String
    - contextPath: Expanse.Tag.tenantId
      description: The tenant ID associated with the tag.
      type: String
  - arguments:
    - description: Asset ID of the Xpanse IP range to retrieve. If provided, other
        search parameters are ignored.
      name: id
    - description: Returns only results whose Business Unit's ID falls in the provided
        list. (comma separated string). Cannot be used with the 'business_unit_names'
        argument.
      isArray: true
      name: business_units
    - description: Returns only results whose Business Unit's ID falls in the provided
        list. (comma separated string). Cannot be used with the 'business_units' argument.
      isArray: true
      name: business_unit_names
    - description: Search for given IP/CIDR block using a single IP (d.d.d.d), a dashed
        IP range (d.d.d.d-d.d.d.d), a CIDR block (d.d.d.d/m), a partial CIDR (d.d.),
        or a wildcard (d.d.*.d).
      name: inet
    - description: Returns only results whose Tag ID falls in the provided list. (comma
        separated string). Cannot be used with the 'tag_names' argument.
      isArray: true
      name: tags
    - description: Returns only results whose Tag name falls in the provided list.
        (comma separated string). Cannot be used with the 'tags' argument.
      isArray: true
      name: tag_names
    - auto: PREDEFINED
      defaultValue: none
      description: Include "none" or any of the following options in the response
        (comma separated) - annotations, severityCounts, attributionReasons, relatedRegistrationInformation,
        locationInformation.
      name: include
      predefined:
      - annotations
      - severityCounts
      - attributionReasons
      - relatedRegistrationInformation
      - locationInformation
    - description: Maximum number of results to retrieve.
      name: limit
    description: Retrieve Xpanse IP ranges by asset id or search parameters.
    name: expanse-get-iprange
    outputs:
    - contextPath: Expanse.IPRange.annotations.additionalNotes
      description: Customer provided annotation details for an IP range.
      type: String
    - contextPath: Expanse.IPRange.annotations.contacts
      description: Customer provided point-of-contact details for an IP range.
      type: String
    - contextPath: Expanse.IPRange.annotations.tags
      description: Customer provided tags for an IP range.
      type: String
    - contextPath: Expanse.IPRange.attributionReasons.reason
      description: The reasons why an IP range is attributed to the customer.
      type: String
    - contextPath: Expanse.IPRange.businessUnits.id
      description: Business Units that the IP range has been assigned to.
      type: String
    - contextPath: Expanse.IPRange.businessUnits.name
      description: Business Units that the IP range has been assigned to.
      type: String
    - contextPath: Expanse.IPRange.created
      description: The date that the IP range was added to the Expander instance.
      type: Date
    - contextPath: Expanse.IPRange.id
      description: Internal Xpanse ID for the IP Range.
      type: String
    - contextPath: Expanse.IPRange.ipVersion
      description: The IP version of the IP range.
      type: String
    - contextPath: Expanse.IPRange.locationInformation.geolocation.city
      description: The IP range geolocation.
      type: String
    - contextPath: Expanse.IPRange.locationInformation.geolocation.countryCode
      description: The IP range geolocation.
      type: String
    - contextPath: Expanse.IPRange.locationInformation.geolocation.latitude
      description: The IP range geolocation.
      type: Number
    - contextPath: Expanse.IPRange.locationInformation.geolocation.longitude
      description: The IP range geolocation.
      type: Number
    - contextPath: Expanse.IPRange.locationInformation.geolocation.regionCode
      description: The IP range geolocation.
      type: String
    - contextPath: Expanse.IPRange.locationInformation.ip
      description: The IP range geolocation.
      type: String
    - contextPath: Expanse.IPRange.modified
      description: The date on which the IP range was last ingested into Expander.
      type: Date
    - contextPath: Expanse.IPRange.rangeIntroduced
      description: The date that the IP range was added to the Expander instance.
      type: Date
    - contextPath: Expanse.IPRange.rangeSize
      description: The number of IP addresses in the IP range.
      type: Number
    - contextPath: Expanse.IPRange.rangeType
      description: If the IP range is Xpanse-generated parent range or a customer-generated
        custom range.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.country
      description: The country within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.endAddress
      description: The end address within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.handle
      description: The handle within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.ipVersion
      description: The IP version within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.name
      description: The name within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.parentHandle
      description: The parent handle within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.address
      description: The address within the registry entities of the IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.email
      description: The email within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.events.action
      description: The events action within the registry entities of the e IP range
        registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.events.actor
      description: The events actor within the registry entities of the e IP range
        registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.events.date
      description: The events date within the registry entities of the e IP range
        registration information.
      type: Date
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.firstRegistered
      description: The first registered date within the registry entities of the e
        IP range registration information.
      type: Date
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.formattedName
      description: The formatted name within the registry entities of the e IP range
        registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.handle
      description: The handle within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.id
      description: The ID within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.lastChanged
      description: The last changed date within the registry entities of the e IP
        range registration information.
      type: Date
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.org
      description: The org within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.phone
      description: The phone number within the registry entities of the e IP range
        registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.relatedEntityHandles
      description: The related entity handles within the registry entities of the
        e IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.remarks
      description: The remarks within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.roles
      description: The roles within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.statuses
      description: The statuses within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.remarks
      description: The remarks within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.startAddress
      description: The start address within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.updatedDate
      description: The last update date within the IP range registration information.
      type: Date
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.whoisServer
      description: The Whois server within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.responsiveIpCount
      description: The number of IPs responsive on the public Internet within the
        IP range.
      type: Number
    - contextPath: Expanse.IPRange.severityCounts.count
      description: The number of exposures observed on the IP range.
      type: Number
    - contextPath: Expanse.IPRange.severityCounts.type
      description: The severity level of the exposures observed on the IP range.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
  - arguments:
    - description: Domain name to retrieve (exact match). If provided, other search
        parameters are ignored.
      name: domain
    - description: Last date the domain was observed by Xpanse (Format is YYYY-MM-DD).
      name: last_observed_date
    - description: Search domain names that match the specified substring.
      name: search
    - description: Maximum number of entries to retrieve.
      name: limit
    - auto: PREDEFINED
      description: Retrieve only domains with or without DNS resolution.
      name: has_dns_resolution
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: Retrieve only domains with or without an active service discovered
        by Xpanse.
      name: has_active_service
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: Retrieve only domains with or without cloud resources discovered
        by Xpanse.
      name: has_related_cloud_resources
      predefined:
      - "true"
      - "false"
    - description: Returns only results whose Tag ID falls in the provided list. (comma
        separated string). Cannot be used with the 'tag_names' argument.
      name: tags
    - description: Returns only results whose Tag name falls in the provided list.
        (comma separated string). Cannot be used with the 'tags' argument.
      name: tag_names
    - description: Returns only results whose Business Unit's ID falls in the provided
        list. (comma separated string). Cannot be used with the 'business_unit_names'
        argument.
      name: business_units
    - description: Returns only results whose Business Unit's name falls in the provided
        list. (comma separated string). Cannot be used with the 'business_units' argument.
      name: business_unit_names
    - description: Returns only results whose Provider's ID falls in the provided
        list. (comma separated string). Cannot be used with the 'provider_names' argument.
      name: providers
    - description: Returns only results whose Provider's name falls in the provided
        list. (comma separated string). Cannot be used with the 'providers' argument.
      name: provider_names
    description: Retrieve Xpanse domains by domain name or search parameters.
    name: expanse-get-domain
    outputs:
    - contextPath: Expanse.Domain.annotations.note
      description: Customer provided annotation details for a domain.
      type: String
    - contextPath: Expanse.Domain.annotations.contacts.id
      description: ID for customer provided contact details for a domain.
      type: String
    - contextPath: Expanse.Domain.annotations.contacts.name
      description: Customer provided contact details for a domain.
      type: String
    - contextPath: Expanse.Domain.annotations.tags.id
      description: ID for customer added tag on a domain in Expander.
      type: String
    - contextPath: Expanse.Domain.annotations.tags.name
      description: Customer added tag on a domain in Expander.
      type: String
    - contextPath: Expanse.Domain.businessUnits.id
      description: Business Units that the domain has been assigned to.
      type: String
    - contextPath: Expanse.Domain.businessUnits.name
      description: Business Units that the domain has been assigned to.
      type: String
    - contextPath: Expanse.Domain.businessUnits.tenantId
      description: Tenant ID for business Units that the domain has been assigned
        to.
      type: String
    - contextPath: Expanse.Domain.dateAdded
      description: The date that the domain was added to the Expander instance.
      type: Date
    - contextPath: Expanse.Domain.details.recentIps.assetKey
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.assetType
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.businessUnits.id
      description: Business Units for the recent IPs that the domain resolved to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.businessUnits.name
      description: Business Units for the recent IPs that the domain resolved to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.businessUnits.tenantId
      description: Tenant information for business Units that the recent IPs that
        the domain resolved to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.commonName
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.domain
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.ip
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.lastObserved
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: Date
    - contextPath: Expanse.Domain.details.recentIps.provider.id
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.provider.name
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.tenant.id
      description: Tenant information for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.tenant.name
      description: Tenant information for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.tenant.tenantId
      description: Tenant information for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.type
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.dnsResolutionStatus
      description: Latest DNS resolution status.
      type: String
    - contextPath: Expanse.Domain.firstObserved
      description: The date that the domain was first observed.
      type: Date
    - contextPath: Expanse.Domain.hasLinkedCloudResources
      description: Whether the domain has any linked cloud resources associated with
        it.
      type: Boolean
    - contextPath: Expanse.Domain.id
      description: Internal Xpanse ID for Domain.
      type: String
    - contextPath: Expanse.Domain.domain
      description: The domain value.
      type: String
    - contextPath: Expanse.Domain.isCollapsed
      description: Whether or not the subdomains of the domain are collapsed.
      type: Boolean
    - contextPath: Expanse.Domain.isPaidLevelDomain
      description: Whether or not the domain is a PLD.
      type: Boolean
    - contextPath: Expanse.Domain.lastObserved
      description: The date that the domain was most recently observed.
      type: Date
    - contextPath: Expanse.Domain.lastSampledIp
      description: The last observed IPv4 address for the domain.
      type: String
    - contextPath: Expanse.Domain.lastSubdomainMetadata.collapseType
      description: Sub-domain metadata.
      type: String
    - contextPath: Expanse.Domain.lastSubdomainMetadata.numSubdomains
      description: Sub-domain metadata.
      type: Number
    - contextPath: Expanse.Domain.lastSubdomainMetadata.numDistinctIps
      description: Sub-domain metadata.
      type: Number
    - contextPath: Expanse.Domain.lastSubdomainMetadata.date
      description: Sub-domain metadata.
      type: Date
    - contextPath: Expanse.Domain.providers.id
      description: Information about the hosting provider of the IP the domain resolves
        to.
      type: String
    - contextPath: Expanse.Domain.providers.name
      description: Information about the hosting provider of the IP the domain resolves
        to.
      type: String
    - contextPath: Expanse.Domain.serviceStatus
      description: Detected service statuses for the domain.
      type: String
    - contextPath: Expanse.Domain.sourceDomain
      description: The source domain for the domain object.
      type: String
    - contextPath: Expanse.Domain.tenant.id
      description: Tenant information for the domain.
      type: String
    - contextPath: Expanse.Domain.tenant.name
      description: Tenant information for the domain.
      type: String
    - contextPath: Expanse.Domain.tenant.tenantId
      description: Tenant information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.city
      description: The admin city in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.country
      description: The admin country in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.emailAddress
      description: The admin email address in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.faxExtension
      description: The admin fax extension in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.faxNumber
      description: The admin fax number in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.name
      description: The admin name in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.organization
      description: The admin organization in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.phoneExtension
      description: The admin phone extension in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.phoneNumber
      description: The admin phone number in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.postalCode
      description: The admin postal code in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.province
      description: The admin province in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.registryId
      description: The admin registry ID in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.street
      description: The admin street in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.creationDate
      description: The creation date in the Whois information for the domain.
      type: Date
    - contextPath: Expanse.Domain.whois.dnssec
      description: The dnssec in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.domain
      description: The domain in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.domainStatuses
      description: The domain statuses in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.nameServers
      description: The name servers in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.city
      description: The registrant city in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.country
      description: The registrant country in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.emailAddress
      description: The registrant email address in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.faxExtension
      description: The registrant fax extension in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.faxNumber
      description: The registrant fax number in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.name
      description: The registrant name in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.organization
      description: The registrant organization in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.phoneExtension
      description: The registrant phone extension in the Whois information for the
        domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.phoneNumber
      description: The registrant phone number in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.postalCode
      description: The registrant postal code in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.province
      description: The registrant province in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.registryId
      description: The registrant registry ID in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.street
      description: The registrant street in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.abuseContactEmail
      description: The registrar abuse contact email in the Whois information for
        the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.abuseContactPhone
      description: The registrar abuse contact phone in the Whois information for
        the domain''.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.formattedName
      description: The registrar formatted name Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.ianaId
      description: The registrar iana ID in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.name
      description: The registrar name in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.registrationExpirationDate
      description: The registrar registration expiration date in the Whois information
        for the domain.
      type: Date
    - contextPath: Expanse.Domain.whois.registrar.url
      description: The registrar URL in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.whoisServer
      description: The registrar Whois server in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registryDomainId
      description: The registry domain ID in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registryExpiryDate
      description: The registry expiry date in the Whois information for the domain.
      type: Date
    - contextPath: Expanse.Domain.whois.reseller
      description: The reseller in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.city
      description: The tech city in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.country
      description: The tech country in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.emailAddress
      description: The tech email address in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.faxExtension
      description: The tech fax extension in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.faxNumber
      description: The tech fax number in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.name
      description: The tech name in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.organization
      description: The tech organization in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.phoneExtension
      description: The tech phone extension in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.phoneNumber
      description: The tech phone number in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.postalCode
      description: The tech postal code in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.province
      description: The tech province in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.registryId
      description: The tech registry ID in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.street
      description: The tech street in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.updatedDate
      description: The updated date in the Whois information for the domain.
      type: Date
    - contextPath: Expanse.Domain.details.cloudResources.id
      description: The cloud resource ID.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.tenant.id
      description: Tenant information for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.tenant.name
      description: Tenant information for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.tenant.tenantId
      description: Tenant information for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.businessUnits.id
      description: Business Units that the cloud resource has been assigned to.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.businessUnits.name
      description: Business Units that the cloud resource has been assigned to.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.businessUnits.tenantId
      description: Tenant information businessUnits that the cloud resource as been
        assigned to.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.dateAdded
      description: The date that the cloud resource was added to the Expander instance.
      type: Date
    - contextPath: Expanse.Domain.details.cloudResources.firstObserved
      description: The date that the cloud resource was first observed.
      type: Date
    - contextPath: Expanse.Domain.details.cloudResources.lastObserved
      description: The date that the domain was most recently observed.
      type: Date
    - contextPath: Expanse.Domain.details.cloudResources.instanceId
      description: Instance ID for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.type
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.name
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.ips
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.domain
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.provider.id
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.provider.name
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.region
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.vpc.id
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.vpc.name
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.accountIntegration.id
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.accountIntegration.name
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.assetKey
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.assetType
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.businessUnits.id
      description: Business Units that the recent IPs linked to the linked cloud resource
        has been assigned to.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.businessUnits.name
      description: Business Units that the recent IPs linked to the linked cloud resource
        has been assigned to.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.businessUnits.tenantId
      description: Business Units that the recent IPs linked to the linked cloud resource
        has been assigned to.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.commonName
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.domain
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.ip
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.lastObserved
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: Date
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.provider.id
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.provider.name
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.tenant.id
      description: Tenant information for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.tenant.name
      description: Tenant information for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.tenant.tenantId
      description: Tenant information for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.type
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.annotations.note
      description: Customer provided annotation details for a domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.annotations.contacts.id
      description: ID for customer provided contact details for a domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.annotations.contacts.name
      description: Customer provided contact details for a domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.annotations.tags.id
      description: ID for customer added tag on a domain in Expander.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.annotations.tags.name
      description: Customer added tag on a domain in Expander.
      type: String
    - contextPath: Domain.Name
      description: 'The domain name, for example: "google.com".'
      type: String
    - contextPath: Domain.DNS
      description: A list of IP objects resolved by DNS.
      type: String
    - contextPath: Domain.DetectionEngines
      description: The total number of engines that checked the indicator.
      type: Number
    - contextPath: Domain.PositiveDetections
      description: The number of engines that positively detected the indicator as
        malicious.
      type: Number
    - contextPath: Domain.CreationDate
      description: The date that the domain was created.
      type: Date
    - contextPath: Domain.UpdatedDate
      description: The date that the domain was last updated.
      type: String
    - contextPath: Domain.ExpirationDate
      description: The expiration date of the domain.
      type: Date
    - contextPath: Domain.DomainStatus
      description: The status of the domain.
      type: Date
    - contextPath: Domain.NameServers
      description: Name servers of the domain.
      type: String
    - contextPath: Domain.Organization
      description: The organization of the domain.
      type: String
    - contextPath: Domain.Subdomains
      description: Subdomains of the domain.
      type: String
    - contextPath: Domain.Admin.Country
      description: The country of the domain administrator.
      type: String
    - contextPath: Domain.Admin.Email
      description: The email address of the domain administrator.
      type: String
    - contextPath: Domain.Admin.Name
      description: The name of the domain administrator.
      type: String
    - contextPath: Domain.Admin.Phone
      description: The phone number of the domain administrator.
      type: String
    - contextPath: Domain.Registrant.Country
      description: The country of the registrant.
      type: String
    - contextPath: Domain.Registrant.Email
      description: The email address of the registrant.
      type: String
    - contextPath: Domain.Registrant.Name
      description: The name of the registrant.
      type: String
    - contextPath: Domain.Registrant.Phone
      description: The phone number for receiving abuse reports.
      type: String
    - contextPath: Domain.WHOIS.DomainStatus
      description: The status of the domain.
      type: String
    - contextPath: Domain.WHOIS.NameServers
      description: Name servers of the domain.
      type: String
    - contextPath: Domain.WHOIS.CreationDate
      description: The date that the domain was created.
      type: Date
    - contextPath: Domain.WHOIS.UpdatedDate
      description: The date that the domain was last updated.
      type: Date
    - contextPath: Domain.WHOIS.ExpirationDate
      description: The expiration date of the domain.
      type: Date
    - contextPath: Domain.WHOIS.Registrant.Name
      description: The name of the registrant.
      type: String
    - contextPath: Domain.WHOIS.Registrant.Email
      description: The email address of the registrant.
      type: String
    - contextPath: Domain.WHOIS.Registrant.Phone
      description: The phone number of the registrant.
      type: String
    - contextPath: Domain.WHOIS.Registrar.Name
      description: 'The name of the registrar, for example: "GoDaddy".'
      type: String
    - contextPath: Domain.WHOIS.Registrar.AbuseEmail
      description: The email address of the contact for reporting abuse.
      type: String
    - contextPath: Domain.WHOIS.Registrar.AbusePhone
      description: The phone number of contact for reporting abuse.
      type: String
    - contextPath: Domain.WHOIS.Admin.Name
      description: The name of the domain administrator.
      type: String
    - contextPath: Domain.WHOIS.Admin.Email
      description: The email address of the domain administrator.
      type: String
    - contextPath: Domain.WHOIS.Admin.Phone
      description: The phone number of the domain administrator.
      type: String
    - contextPath: Domain.WHOIS.History
      description: List of Whois objects.
      type: String
    - contextPath: Domain.Malicious.Vendor
      description: The vendor reporting the domain as malicious.
      type: String
    - contextPath: Domain.Malicious.Description
      description: A description explaining why the domain was reported as malicious.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
  - arguments:
    - description: The common name of the certificate to search domains for. Fuzzy
        matching is done on this name, however query times can grow quite large when
        searching for short strings. Ex. "*.myhost.com" is a better search term than
        "host".
      name: common_name
    - description: The IP address to search domains for.
      name: ip
    - description: Maximum number of matching certificates to retrieve.
      name: limit
    - description: Maximum number of domains per certificate to retrieve.
      name: domains_limit
    description: Returns all the Xpanse domains which have been seen with the specified
      certificate or IP address.
    name: expanse-get-associated-domains
    outputs:
    - contextPath: Expanse.AssociatedDomain.name
      description: Name of the domain.
      type: String
    - contextPath: Expanse.AssociatedDomain.IP
      description: IP Address the domain resolved to.
      type: String
    - contextPath: Expanse.AssociatedDomain.certificate
      description: Xpanse ID of the certificate associated to this domain.
      type: String
    - contextPath: Domain.Name
      description: 'The domain name, for example: "google.com".'
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
  - arguments:
    - description: MD5 Hash of the certificate. If provided, other search parameters
        are ignored.
      name: md5_hash
    - description: Last date the domain was observed by Xpanse (Format is YYYY-MM-DD),
        to be used with domain argument.
      name: last_observed_date
    - description: Search for  certificates with the specified substring in common
        name.
      name: search
    - description: Maximum number of entries to retrieve.
      name: limit
    - auto: PREDEFINED
      description: Retrieve only certificates actively/not actively advertised.
      name: has_certificate_advertisement
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: Retrieve only certificates with or without an active service discovered
        by Xpanse.
      name: has_active_service
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: Retrieve only certificates with or without cloud resources discovered
        by Xpanse.
      name: has_related_cloud_resources
      predefined:
      - "true"
      - "false"
    - description: Returns only results whose Tag ID falls in the provided list. (comma
        separated string). Cannot be used with the 'tag_names' argument.
      name: tags
    - description: Returns only results whose Tag name falls in the provided list.
        (comma separated string). Cannot be used with the 'tags' argument.
      name: tag_names
    - description: Returns only results whose Business Unit's ID falls in the provided
        list. (comma separated string). Cannot be used with the 'business_unit_names'
        argument.
      name: business_units
    - description: Returns only results whose Business Unit's name falls in the provided
        list. (comma separated string). Cannot be used with the 'business_units' argument.
      name: business_unit_names
    - description: Returns only results whose Provider's ID falls in the provided
        list. (comma separated string). Cannot be used with the 'provider_names' argument.
      name: providers
    - description: Returns only results whose Provider's name falls in the provided
        list. (comma separated string). Cannot be used with the 'providers' argument.
      name: provider_names
    description: Retrieve Xpanse certificates by MD5 hash or search parameters.
    name: expanse-get-certificate
    outputs:
    - contextPath: Expanse.Certificate.annotations.note
      description: Customer provided annotation details for a certificate.
      type: String
    - contextPath: Expanse.Certificate.annotations.contacts.id
      description: ID for customer provided contact details for a certificate.
      type: String
    - contextPath: Expanse.Certificate.annotations.contacts.name
      description: Customer provided contact details for a certificate.
      type: String
    - contextPath: Expanse.Certificate.annotations.tags.id
      description: ID for customer added tag on a certificate in Expander.
      type: String
    - contextPath: Expanse.Certificate.annotations.tags.name
      description: Customer added tag on a certificate in Expander.
      type: String
    - contextPath: Expanse.Certificate.businessUnits.id
      description: Business Units that the certificate has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.businessUnits.name
      description: Business Units that the certificate has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.businessUnits.tenantId
      description: Tenant information for business units that the certificate has
        been assigned to.
      type: String
    - contextPath: Expanse.Certificate.certificate.formattedIssuerOrg
      description: The formatted issuer org in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.id
      description: The certificate ID.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuer
      description: The issuer in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerAlternativeNames
      description: The issuer alternative names in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerCountry
      description: The issuer country in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerEmail
      description: The issuer email in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerLocality
      description: The issuer locality in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerName
      description: The issuer name in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerOrg
      description: The issuer org in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerOrgUnit
      description: The issuer org unit in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerState
      description: The issuer state in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.md5Hash
      description: The md5hash in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.pemSha1
      description: The pemSha1 in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.pemSha256
      description: The pemSha256 in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.publicKey
      description: The public key in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.publicKeyAlgorithm
      description: The public key algorithm in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.publicKeyBits
      description: The public key bits in the certificate.
      type: Number
    - contextPath: Expanse.Certificate.certificate.publicKeyModulus
      description: The public key modulus in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.publicKeyRsaExponent
      description: The public key RSA exponent in the certificate.
      type: Number
    - contextPath: Expanse.Certificate.certificate.publicKeySpki
      description: The public key Spki in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.serialNumber
      description: The serial number in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.signatureAlgorithm
      description: The signature algorithm in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subject
      description: The subject in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectAlternativeNames
      description: The subject alternative names in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectCountry
      description: The subject country in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectEmail
      description: The subject email in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectLocality
      description: The subject locality in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectName
      description: The subject name in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectOrg
      description: The subject org in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectOrgUnit
      description: The subject org unit in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectState
      description: The subject state in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.validNotAfter
      description: The valid not after date in the certificate.
      type: Date
    - contextPath: Expanse.Certificate.certificate.validNotBefore
      description: The valid not before date in the certificate.
      type: Date
    - contextPath: Expanse.Certificate.certificate.version
      description: The version in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificateAdvertisementStatus
      description: Certificate advertisement statuses.
      type: String
    - contextPath: Expanse.Certificate.commonName
      description: Common Name for the certificate.
      type: String
    - contextPath: Expanse.Certificate.dateAdded
      description: The date that the certificate was added to the Expander instance.
      type: Date
    - contextPath: Expanse.Certificate.details.base64Encoded
      description: Additional details for the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.assetKey
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.assetType
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.businessUnits.id
      description: Business Units that the recent IPs linked to the certificate has
        been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.businessUnits.name
      description: Business Units that the recent IPs linked to the certificate has
        been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.businessUnits.tenantId
      description: Tenant information for business Units that the recent IPs linked
        to the certificate has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.commonName
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.domain
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.ip
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.lastObserved
      description: Additional details for the recent IPs linked to the certificate.
      type: Date
    - contextPath: Expanse.Certificate.details.recentIps.provider.id
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.provider.name
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.tenant.id
      description: Tenant information for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.tenant.name
      description: Tenant information for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.tenant.tenantId
      description: Tenant information for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.type
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.firstObserved
      description: The date that the certificate was first observed.
      type: Date
    - contextPath: Expanse.Certificate.hasLinkedCloudResources
      description: Whether the certificate has any linked cloud resources associated
        with it.
      type: Boolean
    - contextPath: Expanse.Certificate.id
      description: Internal Xpanse ID for Certificate.
      type: String
    - contextPath: Expanse.Certificate.lastObserved
      description: The date that the certificate was most recently observed.
      type: Date
    - contextPath: Expanse.Certificate.properties
      description: Xpanse tagged properties of the certificate.
      type: String
    - contextPath: Expanse.Certificate.providers.id
      description: The Provider information for the certificate.
      type: String
    - contextPath: Expanse.Certificate.providers.name
      description: The Provider information for the certificate.
      type: String
    - contextPath: Expanse.Certificate.serviceStatus
      description: Detected service statuses for the certificate.
      type: String
    - contextPath: Expanse.Certificate.tenant.id
      description: Tenant information for the certificate.
      type: String
    - contextPath: Expanse.Certificate.tenant.name
      description: Tenant information for the certificate.
      type: String
    - contextPath: Expanse.Certificate.tenant.tenantId
      description: Tenant information for the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.id
      description: The cloud resource ID.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.tenant.id
      description: Tenant information for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.tenant.name
      description: Tenant information for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.tenant.tenantId
      description: Tenant information for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.businessUnits.id
      description: Business Units that the cloud resource has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.businessUnits.name
      description: Business Units that the cloud resource has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.businessUnits.tenantId
      description: Tenant information businessUnits that the cloud resource as been
        assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.dateAdded
      description: The date that the cloud resource was added to the Expander instance.
      type: Date
    - contextPath: Expanse.Certificate.details.cloudResources.firstObserved
      description: The date that the cloud resource was first observed.
      type: Date
    - contextPath: Expanse.Certificate.details.cloudResources.lastObserved
      description: The date that the certificate was most recently observed.
      type: Date
    - contextPath: Expanse.Certificate.details.cloudResources.instanceId
      description: Instance ID for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.type
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.name
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.ips
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.domain
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.provider.id
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.provider.name
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.region
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.vpc.id
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.vpc.name
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.accountIntegration.id
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.accountIntegration.name
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.assetKey
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.assetType
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.businessUnits.id
      description: Business Units that the recent IPs linked to the linked cloud resource
        has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.businessUnits.name
      description: Business Units that the recent IPs linked to the linked cloud resource
        has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.businessUnits.tenantId
      description: Business Units that the recent IPs linked to the linked cloud resource
        has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.commonName
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.domain
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.ip
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.lastObserved
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: Date
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.provider.id
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.provider.name
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.tenant.id
      description: Tenant information for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.tenant.name
      description: Tenant information for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.tenant.tenantId
      description: Tenant information for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.type
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.annotations.note
      description: Customer provided annotation details for a certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.annotations.contacts.id
      description: ID for customer provided contact details for a certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.annotations.contacts.name
      description: Customer provided contact details for a certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.annotations.tags.id
      description: ID for customer added tag on a certificate in Expander.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.annotations.tags.name
      description: Customer added tag on a certificate in Expander.
      type: String
    - contextPath: Certificate.Name
      description: Name (CN or SAN) appearing in the certificate.
      type: String
    - contextPath: Certificate.SubjectDN
      description: |
        The Subject Distinguished Name of the certificate.
        This field includes the Common Name of the certificate.
      type: String
    - contextPath: Certificate.PEM
      description: Certificate in PEM format.
      type: String
    - contextPath: Certificate.IssuerDN
      description: The Issuer Distinguished Name of the certificate.
      type: String
    - contextPath: Certificate.SerialNumber
      description: The Serial Number of the certificate.
      type: String
    - contextPath: Certificate.ValidityNotAfter
      description: End of certificate validity period.
      type: Date
    - contextPath: Certificate.ValidityNotBefore
      description: Start of certificate validity period.
      type: Date
    - contextPath: Certificate.SubjectAlternativeName.Value
      description: Name of the SAN.
      type: String
    - contextPath: Certificate.SHA256
      description: SHA256 Fingerprint of the certificate in DER format.
      type: String
    - contextPath: Certificate.SHA1
      description: SHA1 Fingerprint of the certificate in DER format.
      type: String
    - contextPath: Certificate.MD5
      description: MD5 Fingerprint of the certificate in DER format.
      type: String
    - contextPath: Certificate.PublicKey.Algorithm
      description: Algorithm used for public key of the certificate.
      type: String
    - contextPath: Certificate.PublicKey.Length
      description: Length in bits of the public key of the certificate.
      type: Number
    - contextPath: Certificate.PublicKey.Modulus
      description: Modulus of the public key for RSA keys.
      type: String
    - contextPath: Certificate.PublicKey.Exponent
      description: Exponent of the public key for RSA keys.
      type: Number
    - contextPath: Certificate.PublicKey.PublicKey
      description: The public key for DSA/Unknown keys.
      type: String
    - contextPath: Certificate.SPKISHA256
      description: SHA256 fingerprint of the certificate Subject Public Key Info.
      type: String
    - contextPath: Certificate.Signature.Algorithm
      description: Algorithm used in the signature of the certificate.
      type: String
    - contextPath: Certificate.Malicious.Vendor
      description: The vendor that reported the file as malicious.
      type: String
    - contextPath: Certificate.Malicious.Description
      description: A description explaining why the file was determined to be malicious.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
  - arguments:
    - default: true
      description: |
        MD5, SHA-1, SHA-256 or SHA-512 hash of the certificate to enrich.
        If MD5 is given, the command will check directly with Xpanse API otherwise
        the script looks first for an indicator with the given hash to retrieve the
        corresponding MD5 hash.
      isArray: true
      name: certificate
    - auto: PREDEFINED
      description: |
        If set to true, the command updates the Xpanse custom fields of the indicator.
        Only if an indicator already exists.
      name: set_expanse_fields
      predefined:
      - "true"
      - "false"
    description: Provides data enrichment for an X509 Certificate from Xpanse.
    name: certificate
    outputs:
    - contextPath: Expanse.Certificate.annotations.note
      description: Customer provided annotation details for a certificate.
      type: String
    - contextPath: Expanse.Certificate.annotations.contacts.id
      description: ID for customer provided contact details for a certificate.
      type: String
    - contextPath: Expanse.Certificate.annotations.contacts.name
      description: Customer provided contact details for a certificate.
      type: String
    - contextPath: Expanse.Certificate.annotations.tags.id
      description: ID for customer added tag on a certificate in Expander.
      type: String
    - contextPath: Expanse.Certificate.annotations.tags.name
      description: Customer added tag on a certificate in Expander.
      type: String
    - contextPath: Expanse.Certificate.businessUnits.id
      description: Business Units that the certificate has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.businessUnits.name
      description: Business Units that the certificate has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.businessUnits.tenantId
      description: Tenant information for business units that the certificate has
        been assigned to.
      type: String
    - contextPath: Expanse.Certificate.certificate.formattedIssuerOrg
      description: The formatted issuer org in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.id
      description: The certificate ID.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuer
      description: The issuer in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerAlternativeNames
      description: The issuer alternative names in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerCountry
      description: The issuer country in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerEmail
      description: The issuer email in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerLocality
      description: The issuer locality in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerName
      description: The issuer name in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerOrg
      description: The issuer org in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerOrgUnit
      description: The issuer org unit in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.issuerState
      description: The issuer state in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.md5Hash
      description: The md5hash in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.pemSha1
      description: The pemSha1 in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.pemSha256
      description: The pemSha256 in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.publicKey
      description: The public key in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.publicKeyAlgorithm
      description: The public key algorithm in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.publicKeyBits
      description: The public key bits in the certificate.
      type: Number
    - contextPath: Expanse.Certificate.certificate.publicKeyModulus
      description: The public key modulus in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.publicKeyRsaExponent
      description: The public key RSA exponent in the certificate.
      type: Number
    - contextPath: Expanse.Certificate.certificate.publicKeySpki
      description: The public key Spki in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.serialNumber
      description: The serial number in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.signatureAlgorithm
      description: The signature algorithm in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subject
      description: The subject in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectAlternativeNames
      description: The subject alternative names in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectCountry
      description: The subject country in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectEmail
      description: The subject email in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectLocality
      description: The subject locality in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectName
      description: The subject name in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectOrg
      description: The subject org in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectOrgUnit
      description: The subject org unit in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.subjectState
      description: The subject state in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificate.validNotAfter
      description: The valid not after date in the certificate.
      type: Date
    - contextPath: Expanse.Certificate.certificate.validNotBefore
      description: The valid not before date in the certificate.
      type: Date
    - contextPath: Expanse.Certificate.certificate.version
      description: The version in the certificate.
      type: String
    - contextPath: Expanse.Certificate.certificateAdvertisementStatus
      description: Certificate advertisement statuses.
      type: String
    - contextPath: Expanse.Certificate.commonName
      description: Common Name for the certificate.
      type: String
    - contextPath: Expanse.Certificate.dateAdded
      description: The date that the certificate was added to the Expander instance.
      type: Date
    - contextPath: Expanse.Certificate.details.base64Encoded
      description: Additional details for the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.assetKey
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.assetType
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.businessUnits.id
      description: Business Units that the recent IPs linked to the certificate has
        been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.businessUnits.name
      description: Business Units that the recent IPs linked to the certificate has
        been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.businessUnits.tenantId
      description: Tenant information for business Units that the recent IPs linked
        to the certificate has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.commonName
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.domain
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.ip
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.lastObserved
      description: Additional details for the recent IPs linked to the certificate.
      type: Date
    - contextPath: Expanse.Certificate.details.recentIps.provider.id
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.provider.name
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.tenant.id
      description: Tenant information for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.tenant.name
      description: Tenant information for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.tenant.tenantId
      description: Tenant information for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.recentIps.type
      description: Additional details for the recent IPs linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.firstObserved
      description: The date that the certificate was first observed.
      type: Date
    - contextPath: Expanse.Certificate.hasLinkedCloudResources
      description: Whether the certificate has any linked cloud resources associated
        with it.
      type: Boolean
    - contextPath: Expanse.Certificate.id
      description: Internal Xpanse ID for Certificate.
      type: String
    - contextPath: Expanse.Certificate.lastObserved
      description: The date that the certificate was most recently observed.
      type: Date
    - contextPath: Expanse.Certificate.properties
      description: Xpanse tagged properties of the certificate.
      type: String
    - contextPath: Expanse.Certificate.providers.id
      description: The Provider information for the certificate.
      type: String
    - contextPath: Expanse.Certificate.providers.name
      description: The Provider information for the certificate.
      type: String
    - contextPath: Expanse.Certificate.serviceStatus
      description: Detected service statuses for the certificate.
      type: String
    - contextPath: Expanse.Certificate.tenant.id
      description: Tenant information for the certificate.
      type: String
    - contextPath: Expanse.Certificate.tenant.name
      description: Tenant information for the certificate.
      type: String
    - contextPath: Expanse.Certificate.tenant.tenantId
      description: Tenant information for the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.id
      description: The cloud resource ID.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.tenant.id
      description: Tenant information for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.tenant.name
      description: Tenant information for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.tenant.tenantId
      description: Tenant information for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.businessUnits.id
      description: Business Units that the cloud resource has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.businessUnits.name
      description: Business Units that the cloud resource has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.businessUnits.tenantId
      description: Tenant information businessUnits that the cloud resource as been
        assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.dateAdded
      description: The date that the cloud resource was added to the Expander instance.
      type: Date
    - contextPath: Expanse.Certificate.details.cloudResources.firstObserved
      description: The date that the cloud resource was first observed.
      type: Date
    - contextPath: Expanse.Certificate.details.cloudResources.lastObserved
      description: The date that the certificate was most recently observed.
      type: Date
    - contextPath: Expanse.Certificate.details.cloudResources.instanceId
      description: Instance ID for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.type
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.name
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.ips
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.domain
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.provider.id
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.provider.name
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.region
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.vpc.id
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.vpc.name
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.accountIntegration.id
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.accountIntegration.name
      description: Additional details for the cloud resource linked to the certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.assetKey
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.assetType
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.businessUnits.id
      description: Business Units that the recent IPs linked to the linked cloud resource
        has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.businessUnits.name
      description: Business Units that the recent IPs linked to the linked cloud resource
        has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.businessUnits.tenantId
      description: Business Units that the recent IPs linked to the linked cloud resource
        has been assigned to.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.commonName
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.domain
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.ip
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.lastObserved
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: Date
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.provider.id
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.provider.name
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.tenant.id
      description: Tenant information for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.tenant.name
      description: Tenant information for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.tenant.tenantId
      description: Tenant information for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.recentIps.type
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.annotations.note
      description: Customer provided annotation details for a certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.annotations.contacts.id
      description: ID for customer provided contact details for a certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.annotations.contacts.name
      description: Customer provided contact details for a certificate.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.annotations.tags.id
      description: ID for customer added tag on a certificate in Expander.
      type: String
    - contextPath: Expanse.Certificate.details.cloudResources.annotations.tags.name
      description: Customer added tag on a certificate in Expander.
      type: String
    - contextPath: Certificate.Name
      description: Name (CN or SAN) appearing in the certificate.
      type: String
    - contextPath: Certificate.SubjectDN
      description: |
        The Subject Distinguished Name of the certificate.
        This field includes the Common Name of the certificate.
      type: String
    - contextPath: Certificate.PEM
      description: Certificate in PEM format.
      type: String
    - contextPath: Certificate.IssuerDN
      description: The Issuer Distinguished Name of the certificate.
      type: String
    - contextPath: Certificate.SerialNumber
      description: The Serial Number of the certificate.
      type: String
    - contextPath: Certificate.ValidityNotAfter
      description: End of certificate validity period.
      type: Date
    - contextPath: Certificate.ValidityNotBefore
      description: Start of certificate validity period.
      type: Date
    - contextPath: Certificate.SubjectAlternativeName.Value
      description: Name of the SAN.
      type: String
    - contextPath: Certificate.SHA256
      description: SHA256 Fingerprint of the certificate in DER format.
      type: String
    - contextPath: Certificate.SHA1
      description: SHA1 Fingerprint of the certificate in DER format.
      type: String
    - contextPath: Certificate.MD5
      description: MD5 Fingerprint of the certificate in DER format.
      type: String
    - contextPath: Certificate.PublicKey.Algorithm
      description: Algorithm used for public key of the certificate.
      type: String
    - contextPath: Certificate.PublicKey.Length
      description: Length in bits of the public key of the certificate.
      type: Number
    - contextPath: Certificate.PublicKey.Modulus
      description: Modulus of the public key for RSA keys.
      type: String
    - contextPath: Certificate.PublicKey.Exponent
      description: Exponent of the public key for RSA keys.
      type: Number
    - contextPath: Certificate.PublicKey.PublicKey
      description: The public key for DSA/Unknown keys.
      type: String
    - contextPath: Certificate.SPKISHA256
      description: SHA256 fingerprint of the certificate Subject Public Key Info.
      type: String
    - contextPath: Certificate.Signature.Algorithm
      description: Algorithm used in the signature of the certificate.
      type: String
    - contextPath: Certificate.Malicious.Vendor
      description: The vendor that reported the file as malicious.
      type: String
    - contextPath: Certificate.Malicious.Description
      description: A description explaining why the file was determined to be malicious.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
  - arguments:
    - description: Maximum number of cloud resources to retrieve.
      name: limit
    - description: Last date the cloud resource was observed by Xpanse (Format is
        YYYY-MM-DD).
      name: last_observed_date
    - description: A domain search string to find related cloud resources.
      name: domain
    - description: An IP search string to find related cloud resources.
      name: ip
    - description: A search string of provider IDs to find cloud resources hosted
        by specific providers.
      isArray: true
      name: providers
    - description: A search string of provider names to find cloud resources hosted
        by specific providers.
      isArray: true
      name: provider_names
    - description: A search string of business unit IDs to find cloud resources belonging
        to a specific business unit.
      isArray: true
      name: business_units
    - description: A search string of business unit names to find cloud resources
        belonging to a specific business unit.
      isArray: true
      name: business_unit_names
    - description: A search string of tag IDs to find cloud resources that have been
        assigned a specific tag.
      isArray: true
      name: tags
    - description: A search string of tag names to find cloud resources that have
        been assigned a specific tag.
      isArray: true
      name: tag_names
    - description: A search string of asset types to find cloud resources of a specific
        type.
      isArray: true
      name: types
    - description: A search string of regions to find cloud resources that are hosted
        in a specific region.
      isArray: true
      name: regions
    description: Retrieve cloud resources from Xpanse.
    name: expanse-get-cloud-resources
    outputs:
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: Expanse.CloudResource.accountIntegration.id
      description: The ID of the cloud resource account integration.
      type: String
    - contextPath: Expanse.CloudResource.accountIntegration.name
      description: The name of the cloud resource account integration.
      type: String
    - contextPath: Expanse.CloudResource.annotations.note
      description: Note metadata on the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.businessUnits.id
      description: The internal ID of the business unit that the cloud resource belongs
        to.
      type: String
    - contextPath: Expanse.CloudResource.businessUnits.name
      description: The name of the business unit that the cloud resource belongs to.
      type: String
    - contextPath: Expanse.CloudResource.businessUnits.tenantId
      description: The internal tenant ID of the business unit that the cloud resource
        belongs to.
      type: String
    - contextPath: Expanse.CloudResource.dateAdded
      description: The date that the cloud resource was added.
      type: Date
    - contextPath: Expanse.CloudResource.details
      description: Details about the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.domain
      description: Domain name associated with the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.firstObserved
      description: The date that the cloud resource was first observed.
      type: Date
    - contextPath: Expanse.CloudResource.id
      description: The internal ID for the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.instanceId
      description: The instance ID of the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.ips
      description: IPs associated with the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.lastObserved
      description: The date that the cloud resource was most recently observed.
      type: Date
    - contextPath: Expanse.CloudResource.name
      description: The friendly name of the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.provider.id
      description: The ID of the provider where the cloud resource is hosted.
      type: String
    - contextPath: Expanse.CloudResource.provider.name
      description: The name of the provider where the cloud resource is hosted.
      type: String
    - contextPath: Expanse.CloudResource.region
      description: The region where the cloud resouce is hosted.
      type: String
    - contextPath: Expanse.CloudResource.serviceStatus
      description: Whether the cloud resource has any known associated services.
      type: String
    - contextPath: Expanse.CloudResource.sourceDetails
      description: The integration source of the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.tenant.id
      description: The internal tenant ID of the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.tenant.name
      description: The tenant name of the cloud resouce.
      type: String
    - contextPath: Expanse.CloudResource.tenant.tenantId
      description: The internal tenant ID of the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.type
      description: The type of cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.vpc.id
      description: Any associated VPC ID.
      type: String
    - contextPath: Expanse.CloudResource.vpc.name
      description: Any associated VPC names.
      type: String
  - arguments:
    - description: The ID of the cloud resource.
      name: id
      required: true
    description: Retrieve a specified cloud resource from Xpanse.
    name: expanse-get-cloud-resource
    outputs:
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: Expanse.CloudResource.accountIntegration.id
      description: The ID of the cloud resource account integration.
      type: String
    - contextPath: Expanse.CloudResource.accountIntegration.name
      description: The name of the cloud resource account integration.
      type: String
    - contextPath: Expanse.CloudResource.annotations.note
      description: Note metadata on the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.businessUnits.id
      description: The internal ID of the business unit that the cloud resource belongs
        to.
      type: String
    - contextPath: Expanse.CloudResource.businessUnits.name
      description: The name of the business unit that the cloud resource belongs to.
      type: String
    - contextPath: Expanse.CloudResource.businessUnits.tenantId
      description: The internal tenant ID of the business unit that the cloud resource
        belongs to.
      type: String
    - contextPath: Expanse.CloudResource.dateAdded
      description: The date that the cloud resource was added.
      type: Date
    - contextPath: Expanse.CloudResource.details
      description: Details about the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.domain
      description: Domain name associated with the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.firstObserved
      description: The date that the cloud resource was first observed.
      type: Date
    - contextPath: Expanse.CloudResource.id
      description: The internal ID for the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.instanceId
      description: The instance ID of the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.ips
      description: IPs associated with the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.lastObserved
      description: The date that the cloud resource was most recently observed.
      type: Date
    - contextPath: Expanse.CloudResource.name
      description: The friendly name of the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.provider.id
      description: The ID of the provider where the cloud resource is hosted.
      type: String
    - contextPath: Expanse.CloudResource.provider.name
      description: The name of the provider where the cloud resource is hosted.
      type: String
    - contextPath: Expanse.CloudResource.region
      description: The region where the cloud resouce is hosted.
      type: String
    - contextPath: Expanse.CloudResource.serviceStatus
      description: Whether the cloud resource has any known associated services.
      type: String
    - contextPath: Expanse.CloudResource.sourceDetails
      description: The integration source of the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.tenant.id
      description: The internal tenant ID of the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.tenant.name
      description: The tenant name of the cloud resouce.
      type: String
    - contextPath: Expanse.CloudResource.tenant.tenantId
      description: The internal tenant ID of the cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.type
      description: The type of cloud resource.
      type: String
    - contextPath: Expanse.CloudResource.vpc.id
      description: Any associated VPC ID.
      type: String
    - contextPath: Expanse.CloudResource.vpc.name
      description: Any associated VPC names.
      type: String
  - arguments:
    - description: Maximum number of flows to retrieve.
      name: limit
    - description: Retrieve only flows matching this risk rule ID.
      name: risk_rule
    - description: Filter by internal IP range. Supported formats a.b.c.d, a.b.c.d/e,
        a.b.c.d-a.b.c.d, a., a.*.
      name: internal_ip_range
    - description: Filter by tag names (comma separated string).
      isArray: true
      name: tag_names
    - description: Created Before date (supports ISO8601 format).
      name: created_before
    - description: Created After date (supports ISO8601 format).
      name: created_after
    deprecated: true
    description: (Deprecated) Retrieve risky flows detected by Xpanse Behavior.
    name: expanse-get-risky-flows
    outputs:
    - contextPath: Expanse.RiskyFlow.acked
      description: Whether the risky flow was acked.
      type: Boolean
    - contextPath: Expanse.RiskyFlow.businessUnit.id
      description: The business unit id of the asset involved in the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.businessUnit.name
      description: The business unit name of the asset involved in the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.created
      description: The timestamp when the risky flow was found and created by Xpanse.
      type: Date
    - contextPath: Expanse.RiskyFlow.externalAddress
      description: The external IPv4 address involved in the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.externalCountryCode
      description: The external country code of the IPv4 involved in the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.externalCountryCodes
      description: The external country codes of the IPv4 involved in the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.externalPort
      description: The external port of the communication involved in the risky flow.
      type: Number
    - contextPath: Expanse.RiskyFlow.flowDirection
      description: The direction of the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.id
      description: The internal ID of the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.internalAddress
      description: The internal IPv4 address involved in the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.internalCountryCode
      description: The internal country code of the IPv4 involved in the risky flow''.
      type: String
    - contextPath: Expanse.RiskyFlow.internalCountryCodes
      description: The internal country codes of the IPv4 involved in the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.internalPort
      description: The internal port of the communication involved in the risky flow.
      type: Number
    - contextPath: Expanse.RiskyFlow.internalTags.ipRange
      description: Any tags associated with with the internal asset involved in the
        risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.observationTimestamp
      description: The timestamp when the risky flow took place.
      type: Date
    - contextPath: Expanse.RiskyFlow.protocol
      description: The protocol of the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.riskRule.additionalDataFields
      description: Additional data fields associated with the risk rule for the risky
        flow.
      type: String
    - contextPath: Expanse.RiskyFlow.riskRule.description
      description: The risk rule description for the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.riskRule.id
      description: The risk rule ID for the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.riskRule.name
      description: The risk rule name for the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.tenantBusinessUnitId
      description: The tenant ID that the risky flow affects.
      type: String
    - contextPath: Expanse.RiskyFlow.internalDomains
      description: The internal domains associated with the risky flow.
      type: String
    - contextPath: Expanse.RiskyFlow.internalExposureTypes
      description: The known exposure types associated with the asset involved in
        the risky flow.
      type: String
  - arguments:
    - description: Maximum number of entries to retrieve.
      name: limit
    deprecated: true
    description: (Deprecated) List risk rules from Xpanse Behavior.
    name: expanse-list-risk-rules
    outputs:
    - contextPath: Expanse.RiskRule.abbreviatedName
      description: The abbreviated name of the risk rule.
      type: String
    - contextPath: Expanse.RiskRule.businessUnits.id
      description: The business unit ID that the risk rule applies to.
      type: String
    - contextPath: Expanse.RiskRule.dataFields
      description: The data fields of the risk rule.
      type: String
    - contextPath: Expanse.RiskRule.description
      description: The description of the risk rule.
      type: String
    - contextPath: Expanse.RiskRule.direction
      description: The directionality of the risk rule.
      type: String
    - contextPath: Expanse.RiskRule.id
      description: The risk rule ID.
      type: String
    - contextPath: Expanse.RiskRule.name
      description: The risk rule name.
      type: String
  - arguments:
    - default: true
      description: The domain name to enrich.
      isArray: true
      name: domain
      required: true
    description: Provides data enrichment for domains.
    name: domain
    outputs:
    - contextPath: Expanse.Domain.annotations.note
      description: Customer provided annotation details for a domain.
      type: String
    - contextPath: Expanse.Domain.annotations.contacts.id
      description: ID for customer provided contact details for a domain.
      type: String
    - contextPath: Expanse.Domain.annotations.contacts.name
      description: Customer provided contact details for a domain.
      type: String
    - contextPath: Expanse.Domain.annotations.tags.id
      description: ID for customer added tag on a domain in Expander.
      type: String
    - contextPath: Expanse.Domain.annotations.tags.name
      description: Customer added tag on a domain in Expander.
      type: String
    - contextPath: Expanse.Domain.businessUnits.id
      description: Business Units that the domain has been assigned to.
      type: String
    - contextPath: Expanse.Domain.businessUnits.name
      description: Business Units that the domain has been assigned to.
      type: String
    - contextPath: Expanse.Domain.businessUnits.tenantId
      description: Tenant ID for business Units that the domain has been assigned
        to.
      type: String
    - contextPath: Expanse.Domain.dateAdded
      description: The date that the domain was added to the Expander instance.
      type: Date
    - contextPath: Expanse.Domain.details.recentIps.assetKey
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.assetType
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.businessUnits.id
      description: Business Units for the recent IPs that the domain resolved to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.businessUnits.name
      description: Business Units for the recent IPs that the domain resolved to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.businessUnits.tenantId
      description: Tenant information for business Units that the recent IPs that
        the domain resolved to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.commonName
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.domain
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.ip
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.lastObserved
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: Date
    - contextPath: Expanse.Domain.details.recentIps.provider.id
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.provider.name
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.tenant.id
      description: Tenant information for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.tenant.name
      description: Tenant information for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.tenant.tenantId
      description: Tenant information for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.details.recentIps.type
      description: Additional details for the recent IPs that the domain resolved
        to.
      type: String
    - contextPath: Expanse.Domain.dnsResolutionStatus
      description: Latest DNS resolution status.
      type: String
    - contextPath: Expanse.Domain.firstObserved
      description: The date that the domain was first observed.
      type: Date
    - contextPath: Expanse.Domain.hasLinkedCloudResources
      description: Whether the domain has any linked cloud resources associated with
        it.
      type: Boolean
    - contextPath: Expanse.Domain.id
      description: Internal Xpanse ID for Domain.
      type: String
    - contextPath: Expanse.Domain.domain
      description: The domain value.
      type: String
    - contextPath: Expanse.Domain.isCollapsed
      description: Whether or not the subdomains of the domain are collapsed.
      type: Boolean
    - contextPath: Expanse.Domain.isPaidLevelDomain
      description: Whether or not the domain is a PLD.
      type: Boolean
    - contextPath: Expanse.Domain.lastObserved
      description: The date that the domain was most recently observed.
      type: Date
    - contextPath: Expanse.Domain.lastSampledIp
      description: The last observed IPv4 address for the domain.
      type: String
    - contextPath: Expanse.Domain.lastSubdomainMetadata.collapseType
      description: Sub-domain metadata.
      type: String
    - contextPath: Expanse.Domain.lastSubdomainMetadata.numSubdomains
      description: Sub-domain metadata.
      type: Number
    - contextPath: Expanse.Domain.lastSubdomainMetadata.numDistinctIps
      description: Sub-domain metadata.
      type: Number
    - contextPath: Expanse.Domain.lastSubdomainMetadata.date
      description: Sub-domain metadata.
      type: Date
    - contextPath: Expanse.Domain.providers.id
      description: Information about the hosting provider of the IP the domain resolves
        to.
      type: String
    - contextPath: Expanse.Domain.providers.name
      description: Information about the hosting provider of the IP the domain resolves
        to.
      type: String
    - contextPath: Expanse.Domain.serviceStatus
      description: Detected service statuses for the domain.
      type: String
    - contextPath: Expanse.Domain.sourceDomain
      description: The source domain for the domain object.
      type: String
    - contextPath: Expanse.Domain.tenant.id
      description: Tenant information for the domain.
      type: String
    - contextPath: Expanse.Domain.tenant.name
      description: Tenant information for the domain.
      type: String
    - contextPath: Expanse.Domain.tenant.tenantId
      description: Tenant information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.city
      description: The admin city in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.country
      description: The admin country in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.emailAddress
      description: The admin email address in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.faxExtension
      description: The admin fax extension in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.faxNumber
      description: The admin fax number in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.name
      description: The admin name in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.organization
      description: The admin organization in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.phoneExtension
      description: The admin phone extension in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.phoneNumber
      description: The admin phone number in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.postalCode
      description: The admin postal code in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.province
      description: The admin province in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.registryId
      description: The admin registry ID in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.admin.street
      description: The admin street in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.creationDate
      description: The creation date in the Whois information for the domain.
      type: Date
    - contextPath: Expanse.Domain.whois.dnssec
      description: The dnssec in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.domain
      description: The domain in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.domainStatuses
      description: The domain statuses in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.nameServers
      description: The name servers in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.city
      description: The registrant city in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.country
      description: The registrant country in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.emailAddress
      description: The registrant email address in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.faxExtension
      description: The registrant fax extension in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.faxNumber
      description: The registrant fax number in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.name
      description: The registrant name in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.organization
      description: The registrant organization in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.phoneExtension
      description: The registrant phone extension in the Whois information for the
        domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.phoneNumber
      description: The registrant phone number in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.postalCode
      description: The registrant postal code in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.province
      description: The registrant province in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.registryId
      description: The registrant registry ID in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrant.street
      description: The registrant street in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.abuseContactEmail
      description: The registrar abuse contact email in the Whois information for
        the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.abuseContactPhone
      description: The registrar abuse contact phone in the Whois information for
        the domain''.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.formattedName
      description: The registrar formatted name Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.ianaId
      description: The registrar iana ID in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.name
      description: The registrar name in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.registrationExpirationDate
      description: The registrar registration expiration date in the Whois information
        for the domain.
      type: Date
    - contextPath: Expanse.Domain.whois.registrar.url
      description: The registrar URL in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registrar.whoisServer
      description: The registrar Whois server in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registryDomainId
      description: The registry domain ID in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.registryExpiryDate
      description: The registry expiry date in the Whois information for the domain.
      type: Date
    - contextPath: Expanse.Domain.whois.reseller
      description: The reseller in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.city
      description: The tech city in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.country
      description: The tech country in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.emailAddress
      description: The tech email address in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.faxExtension
      description: The tech fax extension in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.faxNumber
      description: The tech fax number in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.name
      description: The tech name in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.organization
      description: The tech organization in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.phoneExtension
      description: The tech phone extension in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.phoneNumber
      description: The tech phone number in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.postalCode
      description: The tech postal code in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.province
      description: The tech province in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.registryId
      description: The tech registry ID in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.tech.street
      description: The tech street in the Whois information for the domain.
      type: String
    - contextPath: Expanse.Domain.whois.updatedDate
      description: The updated date in the Whois information for the domain.
      type: Date
    - contextPath: Expanse.Domain.details.cloudResources.id
      description: The cloud resource ID.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.tenant.id
      description: Tenant information for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.tenant.name
      description: Tenant information for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.tenant.tenantId
      description: Tenant information for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.businessUnits.id
      description: Business Units that the cloud resource has been assigned to.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.businessUnits.name
      description: Business Units that the cloud resource has been assigned to.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.businessUnits.tenantId
      description: Tenant information businessUnits that the cloud resource as been
        assigned to.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.dateAdded
      description: The date that the cloud resource was added to the Expander instance.
      type: Date
    - contextPath: Expanse.Domain.details.cloudResources.firstObserved
      description: The date that the cloud resource was first observed.
      type: Date
    - contextPath: Expanse.Domain.details.cloudResources.lastObserved
      description: The date that the domain was most recently observed.
      type: Date
    - contextPath: Expanse.Domain.details.cloudResources.instanceId
      description: Instance ID for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.type
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.name
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.ips
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.domain
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.provider.id
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.provider.name
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.region
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.vpc.id
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.vpc.name
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.accountIntegration.id
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.accountIntegration.name
      description: Additional details for the cloud resource linked to the domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.assetKey
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.assetType
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.businessUnits.id
      description: Business Units that the recent IPs linked to the linked cloud resource
        has been assigned to.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.businessUnits.name
      description: Business Units that the recent IPs linked to the linked cloud resource
        has been assigned to.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.businessUnits.tenantId
      description: Business Units that the recent IPs linked to the linked cloud resource
        has been assigned to.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.commonName
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.domain
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.ip
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.lastObserved
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: Date
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.provider.id
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.provider.name
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.tenant.id
      description: Tenant information for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.tenant.name
      description: Tenant information for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.tenant.tenantId
      description: Tenant information for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.recentIps.type
      description: Additional details for the recent IPs linked to the linked cloud
        resource.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.annotations.note
      description: Customer provided annotation details for a domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.annotations.contacts.id
      description: ID for customer provided contact details for a domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.annotations.contacts.name
      description: Customer provided contact details for a domain.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.annotations.tags.id
      description: ID for customer added tag on a domain in Expander.
      type: String
    - contextPath: Expanse.Domain.details.cloudResources.annotations.tags.name
      description: Customer added tag on a domain in Expander.
      type: String
    - contextPath: Domain.Name
      description: 'The domain name, for example: "google.com".'
      type: String
    - contextPath: Domain.DNS
      description: A list of IP objects resolved by DNS.
      type: String
    - contextPath: Domain.DetectionEngines
      description: The total number of engines that checked the indicator.
      type: Number
    - contextPath: Domain.PositiveDetections
      description: The number of engines that positively detected the indicator as
        malicious.
      type: Number
    - contextPath: Domain.CreationDate
      description: The date that the domain was created.
      type: Date
    - contextPath: Domain.UpdatedDate
      description: The date that the domain was last updated.
      type: String
    - contextPath: Domain.ExpirationDate
      description: The expiration date of the domain.
      type: Date
    - contextPath: Domain.DomainStatus
      description: The status of the domain.
      type: Date
    - contextPath: Domain.NameServers
      description: Name servers of the domain.
      type: String
    - contextPath: Domain.Organization
      description: The organization of the domain.
      type: String
    - contextPath: Domain.Subdomains
      description: Subdomains of the domain.
      type: String
    - contextPath: Domain.Admin.Country
      description: The country of the domain administrator.
      type: String
    - contextPath: Domain.Admin.Email
      description: The email address of the domain administrator.
      type: String
    - contextPath: Domain.Admin.Name
      description: The name of the domain administrator.
      type: String
    - contextPath: Domain.Admin.Phone
      description: The phone number of the domain administrator.
      type: String
    - contextPath: Domain.Registrant.Country
      description: The country of the registrant.
      type: String
    - contextPath: Domain.Registrant.Email
      description: The email address of the registrant.
      type: String
    - contextPath: Domain.Registrant.Name
      description: The name of the registrant.
      type: String
    - contextPath: Domain.Registrant.Phone
      description: The phone number for receiving abuse reports.
      type: String
    - contextPath: Domain.WHOIS.DomainStatus
      description: The status of the domain.
      type: String
    - contextPath: Domain.WHOIS.NameServers
      description: Name servers of the domain.
      type: String
    - contextPath: Domain.WHOIS.CreationDate
      description: The date that the domain was created.
      type: Date
    - contextPath: Domain.WHOIS.UpdatedDate
      description: The date that the domain was last updated.
      type: Date
    - contextPath: Domain.WHOIS.ExpirationDate
      description: The expiration date of the domain.
      type: Date
    - contextPath: Domain.WHOIS.Registrant.Name
      description: The name of the registrant.
      type: String
    - contextPath: Domain.WHOIS.Registrant.Email
      description: The email address of the registrant.
      type: String
    - contextPath: Domain.WHOIS.Registrant.Phone
      description: The phone number of the registrant.
      type: String
    - contextPath: Domain.WHOIS.Registrar.Name
      description: 'The name of the registrar, for example: "GoDaddy".'
      type: String
    - contextPath: Domain.WHOIS.Registrar.AbuseEmail
      description: The email address of the contact for reporting abuse.
      type: String
    - contextPath: Domain.WHOIS.Registrar.AbusePhone
      description: The phone number of contact for reporting abuse.
      type: String
    - contextPath: Domain.WHOIS.Admin.Name
      description: The name of the domain administrator.
      type: String
    - contextPath: Domain.WHOIS.Admin.Email
      description: The email address of the domain administrator.
      type: String
    - contextPath: Domain.WHOIS.Admin.Phone
      description: The phone number of the domain administrator.
      type: String
    - contextPath: Domain.WHOIS.History
      description: List of Whois objects.
      type: String
    - contextPath: Domain.Malicious.Vendor
      description: The vendor reporting the domain as malicious.
      type: String
    - contextPath: Domain.Malicious.Description
      description: A description explaining why the domain was reported as malicious.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
  - arguments:
    - default: true
      description: The IP to enrich.
      isArray: true
      name: ip
      required: true
    description: Provides data enrichment for IPs.
    name: ip
    outputs:
    - contextPath: Expanse.IP.ip
      description: The IPv4 address of the asset.
      type: String
    - contextPath: Expanse.IP.assetKey
      description: Key used to access the asset in the respective Xpanse asset API.
      type: String
    - contextPath: Expanse.IP.assetType
      description: The type of asset.
      type: String
    - contextPath: Expanse.IP.businessUnits.id
      description: The internal Xpanse ID for the business unit the asset belongs
        to.
      type: String
    - contextPath: Expanse.IP.businessUnits.name
      description: The name of the business unit the asset belongs to.
      type: String
    - contextPath: Expanse.IP.businessUnits.tenantId
      description: The ID of the tenant that the asset belongs to.
      type: String
    - contextPath: Expanse.IP.commonName
      description: The certificate common name of the asset.
      type: String
    - contextPath: Expanse.IP.domain
      description: The domain name of the asset.
      type: String
    - contextPath: Expanse.IP.lastObserved
      description: The last observed IPv4 address of the asset.
      type: Date
    - contextPath: Expanse.IP.provider.id
      description: The ID of the provider the asset was detected on.
      type: String
    - contextPath: Expanse.IP.provider.name
      description: The name of the provider the asset was detected on.
      type: String
    - contextPath: Expanse.IP.tenant.id
      description: The internal Xpanse ID of the tenant that the asset belongs to.
      type: String
    - contextPath: Expanse.IP.tenant.name
      description: The name of the tenant that the asset belongs to.
      type: String
    - contextPath: Expanse.IP.tenant.tenantId
      description: The ID of the tenant that the asset belongs to.
      type: String
    - contextPath: Expanse.IP.type
      description: The type of asset that the IPv4 address relates to.
      type: String
    - contextPath: IP.Address
      description: IP address.
      type: String
    - contextPath: IP.ASN
      description: 'The autonomous system name for the IP address, for example: "AS8948".'
      type: String
    - contextPath: IP.Hostname
      description: The hostname that is mapped to this IP address.
      type: String
    - contextPath: IP.Geo.Location
      description: 'The geolocation where the IP address is located, in the format:
        latitude:longitude.'
      type: String
    - contextPath: IP.Geo.Country
      description: The country in which the IP address is located.
      type: String
    - contextPath: IP.Geo.Description
      description: Additional information about the location.
      type: String
    - contextPath: IP.DetectionEngines
      description: The total number of engines that checked the indicator.
      type: Number
    - contextPath: IP.PositiveDetections
      description: The number of engines that positively detected the indicator as
        malicious.
      type: Number
    - contextPath: IP.Malicious.Vendor
      description: The vendor reporting the IP address as malicious.
      type: String
    - contextPath: IP.Malicious.Description
      description: A description explaining why the IP address was reported as malicious.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
  - arguments:
    - default: true
      description: The CIDR block to enrich.
      isArray: true
      name: cidr
    - defaultValue: severityCounts,annotations,attributionReasons,relatedRegistrationInformation,locationInformation
      description: Include "none" or any of the following options (comma separated)
        - annotations, severityCounts, attributionReasons, relatedRegistrationInformation,
        locationInformation.
      name: include
    description: Provides data enrichment for CIDR blocks using Xpanse IP Range.
    name: cidr
    outputs:
    - contextPath: Expanse.IPRange.annotations.additionalNotes
      description: Customer provided annotation details for an IP range.
      type: String
    - contextPath: Expanse.IPRange.annotations.contacts
      description: Customer provided point-of-contact details for an IP range.
      type: String
    - contextPath: Expanse.IPRange.annotations.tags
      description: Customer provided tags for an IP range.
      type: String
    - contextPath: Expanse.IPRange.attributionReasons.reason
      description: The reasons why an IP range is attributed to the customer.
      type: String
    - contextPath: Expanse.IPRange.businessUnits.id
      description: Business Units that the IP range has been assigned to.
      type: String
    - contextPath: Expanse.IPRange.businessUnits.name
      description: Business Units that the IP range has been assigned to.
      type: String
    - contextPath: Expanse.IPRange.created
      description: The date that the IP range was added to the Expander instance.
      type: Date
    - contextPath: Expanse.IPRange.id
      description: Internal Xpanse ID for the IP Range.
      type: String
    - contextPath: Expanse.IPRange.ipVersion
      description: The IP version of the IP range.
      type: String
    - contextPath: Expanse.IPRange.locationInformation.geolocation.city
      description: The IP range geolocation.
      type: String
    - contextPath: Expanse.IPRange.locationInformation.geolocation.countryCode
      description: The IP range geolocation.
      type: String
    - contextPath: Expanse.IPRange.locationInformation.geolocation.latitude
      description: The IP range geolocation.
      type: Number
    - contextPath: Expanse.IPRange.locationInformation.geolocation.longitude
      description: The IP range geolocation.
      type: Number
    - contextPath: Expanse.IPRange.locationInformation.geolocation.regionCode
      description: The IP range geolocation.
      type: String
    - contextPath: Expanse.IPRange.locationInformation.ip
      description: The IP range geolocation.
      type: String
    - contextPath: Expanse.IPRange.modified
      description: The date on which the IP range was last ingested into Expander.
      type: Date
    - contextPath: Expanse.IPRange.rangeIntroduced
      description: The date that the IP range was added to the Expander instance.
      type: Date
    - contextPath: Expanse.IPRange.rangeSize
      description: The number of IP addresses in the IP range.
      type: Number
    - contextPath: Expanse.IPRange.rangeType
      description: If the IP range is Xpanse-generated parent range or a customer-generated
        custom range.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.country
      description: The country within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.endAddress
      description: The end address within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.handle
      description: The handle within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.ipVersion
      description: The IP version within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.name
      description: The name within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.parentHandle
      description: The parent handle within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.address
      description: The address within the registry entities of the IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.email
      description: The email within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.events.action
      description: The events action within the registry entities of the e IP range
        registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.events.actor
      description: The events actor within the registry entities of the e IP range
        registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.events.date
      description: The events date within the registry entities of the e IP range
        registration information.
      type: Date
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.firstRegistered
      description: The first registered date within the registry entities of the e
        IP range registration information.
      type: Date
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.formattedName
      description: The formatted name within the registry entities of the e IP range
        registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.handle
      description: The handle within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.id
      description: The ID within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.lastChanged
      description: The last changed date within the registry entities of the e IP
        range registration information.
      type: Date
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.org
      description: The org within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.phone
      description: The phone number within the registry entities of the e IP range
        registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.relatedEntityHandles
      description: The related entity handles within the registry entities of the
        e IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.remarks
      description: The remarks within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.roles
      description: The roles within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.registryEntities.statuses
      description: The statuses within the registry entities of the e IP range registration
        information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.remarks
      description: The remarks within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.startAddress
      description: The start address within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.updatedDate
      description: The last update date within the IP range registration information.
      type: Date
    - contextPath: Expanse.IPRange.relatedRegistrationInformation.whoisServer
      description: The Whois server within the IP range registration information.
      type: String
    - contextPath: Expanse.IPRange.responsiveIpCount
      description: The number of IPs responsive on the public Internet within the
        IP range.
      type: Number
    - contextPath: Expanse.IPRange.severityCounts.count
      description: The number of exposures observed on the IP range.
      type: Number
    - contextPath: Expanse.IPRange.severityCounts.type
      description: The severity level of the exposures observed on the IP range.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
  - arguments:
    - default: true
      description: The certificate common name. Fuzzy matching is done on this name,
        however query times can grow quite large when searching for short strings.
        Ex. "*.myhost.com" is a better search term than "host".
      name: common_name
      required: true
    description: Returns all domains which have been seen with the specified certificate.
    name: expanse-get-domains-for-certificate
    outputs:
    - contextPath: Expanse.IPDomains.SearchTerm
      description: The common name that was searched.
      type: String
    - contextPath: Expanse.IPDomains.TotalDomainCount
      description: The number of domains found matching the specified certificate.
      type: Number
    - contextPath: Expanse.IPDomains.FlatDomainList
      description: An array of all domain names found. This is truncated at 50.
      type: Unknown
    - contextPath: Expanse.IPDomains.DomainList
      description: An array of domain objects. This is truncated at 50.
      type: Unknown
  dockerimage: demisto/python3:3.10.14.92207
  isfetch: true
  isremotesyncin: true
  isremotesyncout: true
  runonce: false
  script: |
    register_module_line('ExpanseV2', 'start', __line__())
    ### pack version: 1.10.54


    """Cortex XSOAR Integration for Expanse Expander and Behavior

    """



    import urllib3
    import copy
    import json
    import base64
    import re

    from typing import (
        Any, Dict, Optional, Iterator,
        Tuple, Union, cast, Set, List
    )

    from itertools import islice
    from dateparser import parse
    from datetime import datetime, timezone
    from collections import defaultdict
    import ipaddress

    # Disable insecure warnings
    urllib3.disable_warnings()  # pylint: disable=no-member

    """ CONSTANTS """

    TOKEN_DURATION = 7200
    DEFAULT_RESULTS = 20  # default results per search
    MAX_RESULTS = 5000  # max results per search
    MAX_PAGE_SIZE = 1000  # max results per page
    MAX_INCIDENTS = 100  # max incidents per fetch
    MAX_UPDATES = 100  # max updates received
    DATE_FORMAT = "%Y-%m-%dT%H:%M:%S.%fZ"
    DEFAULT_FIRST_FETCH = "3 days"  # default parameter for first fetch

    ISSUE_PROGRESS_STATUS = ['New', 'Investigating', 'InProgress', 'AcceptableRisk', 'Resolved']
    ISSUE_PROGRESS_STATUS_CLOSED = ['AcceptableRisk', 'Resolved', 'NoRisk']
    ISSUE_ACTIVITY_STATUS = ['Active', 'Inactive']
    ISSUE_PRIORITY = ['Critical', 'High', 'Medium', 'Low']
    CLOUD_MANAGEMENT_STATUS = ['ManagedCloud', 'UnmanagedCloud', 'NotApplicable']
    ISSUE_SORT_OPTIONS = ['created', '-created', 'modified', '-modified', 'assigneeUsername',
                          '-assigneeUsername', 'priority', '-priority', 'progressStatus', '-progressStatus',
                          'activityStatus', '-activityStatus', 'headline', '-headline']

    SERVICE_DISCOVERY_TYPE = ["ColocatedOnIp", "DirectlyDiscovered"]
    SERVICE_SORT_OPTIONS = ['firstObserved', '-firstObserved', 'lastObserved', '-lastObserved', 'name', '-name']

    EXPANSE_RESOLVEDSTATUS_TO_XSOAR = {
        'Resolved': 'Resolved',
        'AcceptableRisk': 'Other'
    }

    EXPANSE_ISSUE_READABLE_HEADER_LIST = [
        'id', 'headline', 'issueType', 'category', 'ip', 'portProtocol', 'portNumber', 'domain', 'certificate', 'priority',
        'progressStatus', 'activityStatus', 'providers', 'assigneeUsername', 'businessUnits', 'created', 'modified',
        'annotations', 'assets', 'helpText'
    ]

    EXPANSE_SERVICE_READABLE_HEADER_LIST = [
        'id', 'name', 'ips', 'domains', 'portNumber', 'activityStatus', 'businessUnits', 'certificates', 'tlsVersions',
        'classifications', 'firstObserved', 'lastObserved', 'annotations', 'assets', 'discoveryInfo'
    ]

    EXPANSE_POC_READABLE_HEADER_LIST = [
        'id', 'email', 'firstName', 'lastName', 'phone', 'role', 'created', 'modified'
    ]

    MIRROR_DIRECTION = {
        'None': None,
        'Incoming': 'In',
        'Outgoing': 'Out',
        'Both': 'Both'
    }

    TAGGABLE_ASSET_TYPE_MAP = {
        'Domain': 'domains',
        'Certificate': 'certificates',
        'CloudResource': 'cloud-resources',
        'IpRange': 'ip-range',
        'ResponsiveIP': 'responsive-ip',
        'Network': 'network',
        'Device': 'device'
    }

    ASSET_TAG_OPERATIONS = ['ASSIGN', 'UNASSIGN']
    ASSET_POC_OPERATIONS = ['ASSIGN', 'UNASSIGN']

    ISSUE_UPDATE_TYPES = {
        'Assignee': 'assigneeUsername',
        'Comment': 'comment',
        'Priority': 'priority',
        'ProgressStatus': 'progressStatus',
        'ActivityStatus': 'activityStatus'
    }

    PRIORITY_SEVERITY_MAP = {
        'Unknown': 0,  # unknown
        'Low': 1,  # low severity
        'Medium': 2,  # medium severity
        'High': 3,  # high severity
        'Critical': 4  # critical severity
    }

    SEVERITY_PRIORITY_MAP = {v: k for k, v in PRIORITY_SEVERITY_MAP.items()}

    IPRANGE_INCLUDE_OPTIONS = ["none", "annotations", "severityCounts", "attributionReasons",
                               "relatedRegistrationInformation", "locationInformation"]

    POC_EMAIL_PATTERN = r"^\S+@\S+$"
    DEPRECATED_COMMANDS = {"expanse-get-risky-flows", "expanse-list-risk-rules"}
    """ CLIENT CLASS """


    class Client(BaseClient):
        """Client class to interact with the Expanse API"""

        def __init__(
                self, base_url: str, api_key: str, verify: bool, proxy: bool, **kwargs
        ):
            self.api_key = api_key
            hdr = {
                "Content-Type": "application/json",
                "Accept": "application/json",
                "User-Agent": "Expanse_XSOAR/1.10.0",
            }
            super().__init__(base_url, verify=verify, proxy=proxy, headers=hdr, **kwargs)

        def _paginate(self, method: str, url_suffix: str,
                      params: Optional[Dict[str, Any]]) -> Iterator[Any]:
            next_url: Optional[str] = None

            while True:
                result = self._http_request(
                    method=method,
                    url_suffix=url_suffix,
                    full_url=next_url,
                    params=params,
                    raise_on_status=True
                )

                data = result.get('data', [])
                if data is not None:
                    yield from data

                pagination = result.get('pagination', None)
                if pagination is None:
                    break
                next_url = pagination.get('next', None)
                if next_url is None:
                    break

                params = None

        def _get_utcnow(self) -> datetime:
            """
            Used to allow mocking for Unit Tests
            """
            return datetime.utcnow()

        def authenticate(self) -> None:
            """
            Perform authentication using API_KEY,
            stores token and stored timestamp in integration context,
            retrieves new token when expired
            """
            current_utc_timestamp = int(self._get_utcnow().timestamp())

            stored_token = demisto.getIntegrationContext()
            if (
                    isinstance(stored_token, dict)
                    and "token" in stored_token
                    and "expires" in stored_token
                    and current_utc_timestamp < int(stored_token["expires"])
            ):
                self._headers['Authorization'] = f'JWT {stored_token["token"]}'
            else:
                # fetch new token
                hdr = self._headers.copy()
                hdr["Authorization"] = f"Bearer {self.api_key}"

                r = self._http_request('GET', "/v1/IdToken", headers=hdr)
                if isinstance(r, dict) and r.get("token", None) is None:
                    raise ValueError("Authorization failed")

                token_expiration = current_utc_timestamp + TOKEN_DURATION

                self._headers['Authorization'] = f'JWT {r["token"]}'
                demisto.setIntegrationContext(
                    {"token": r["token"], "expires": token_expiration}
                )

        def get_issue_count(self) -> int:
            r = self._http_request(
                method='GET', url_suffix='/v1/issues/issues/count',
            )
            if not isinstance(r, dict) or 'count' not in r:
                raise DemistoException(f'Error determining issue count. Response from server: {str(r)}')
            return int(r['count'])

        def get_issues(self,
                       limit: int,
                       content_search: Optional[str] = None,
                       provider: Optional[str] = None,
                       business_units: Optional[str] = None,
                       assignee: Optional[str] = None,
                       issue_type: Optional[str] = None,
                       inet_search: Optional[str] = None,
                       domain_search: Optional[str] = None,
                       port_number: Optional[str] = None,
                       progress_status: Optional[str] = None,
                       activity_status: Optional[str] = None,
                       priority: Optional[str] = None,
                       tags: Optional[str] = None,
                       created_before: Optional[str] = None,
                       created_after: Optional[str] = None,
                       modified_before: Optional[str] = None,
                       modified_after: Optional[str] = None,
                       cloud_management_status: Optional[str] = None,
                       sort: Optional[str] = None
                       ) -> Iterator[Any]:

            params = {
                'limit': limit,
                'contentSearch': content_search,
                'providerName': provider if provider else None,
                'businessUnitName': business_units if business_units else None,
                'assigneeUsername': assignee if assignee else None,
                'issueTypeName': issue_type if issue_type else None,
                'inetSearch': inet_search,
                'domainSearch': domain_search,
                'portNumber': port_number if port_number else None,
                'progressStatus': progress_status if progress_status else None,
                'activityStatus': activity_status if activity_status else None,
                'priority': priority if priority else None,
                'tagName': tags if tags else None,
                'createdBefore': created_before,
                'createdAfter': created_after,
                'modifiedBefore': modified_before,
                'modifiedAfter': modified_after,
                'cloudManagementStatus': cloud_management_status if cloud_management_status else None,
                'sort': sort
            }
            demisto.debug(f"ExpanseV2 - Query sent to the server: {params}")
            return self._paginate(
                method='GET', url_suffix="/v1/issues/issues", params=params
            )

        def get_issue_by_id(self, issue_id: str) -> Dict[str, Any]:
            return self._http_request(
                method='GET', url_suffix=f'/v1/issues/issues/{issue_id}')

        def get_issue_updates(self, issue_id: str, update_types: Optional[List],
                              created_after: Optional[str], limit: int = DEFAULT_RESULTS) -> Iterator[Any]:
            updates = self._paginate(
                method='GET', url_suffix=f'/v1/issues/issues/{issue_id}/updates',
                params=dict(limit=limit))
            after = datestring_to_timestamp_us(created_after) if created_after else None

            for u in updates:
                if after and 'created' in u and datestring_to_timestamp_us(u['created']) <= after:
                    continue
                if update_types and 'updateType' in u and u['updateType'] not in update_types:
                    continue
                yield u

        def get_services(self,
                         limit: int,
                         content_search: Optional[str] = None,
                         provider: Optional[str] = None,
                         business_units: Optional[str] = None,
                         service_type: Optional[str] = None,
                         inet_search: Optional[str] = None,
                         domain_search: Optional[str] = None,
                         port_number: Optional[str] = None,
                         activity_status: Optional[str] = None,
                         discovery_type: Optional[str] = None,
                         country_code: Optional[str] = None,
                         tags: Optional[str] = None,
                         cloud_management_status: Optional[str] = None,
                         sort: Optional[str] = None
                         ) -> Iterator[Any]:

            params = {
                'limit': limit,
                'contentSearch': content_search,
                'providerName': provider if provider else None,
                'businessUnitName': business_units if business_units else None,
                'classificationId': service_type if service_type else None,
                'ipSearch': inet_search,
                'domainSearch': domain_search,
                'portNumber': port_number if port_number else None,
                'countryCode': country_code if country_code else None,
                'activityStatus': activity_status if activity_status else None,
                'discoveryType': discovery_type if discovery_type else None,
                'tagName': tags if tags else None,
                'cloudManagementStatus': cloud_management_status if cloud_management_status else None,
                'sort': sort
            }

            return self._paginate(
                method='GET', url_suffix="/v1/services/services", params=params
            )

        def get_service_by_id(self, service_id: str) -> Dict[str, Any]:
            return self._http_request(
                method='GET', url_suffix=f'/v1/services/services/{service_id}')

        def list_businessunits(self, limit: int = DEFAULT_RESULTS) -> Iterator[Any]:
            params = dict(limit=limit)
            return self._paginate(
                method='GET',
                url_suffix='/v1/issues/businessUnits',
                params=params
            )

        def list_providers(self, limit: int = DEFAULT_RESULTS) -> Iterator[Any]:
            params = dict(limit=limit)
            return self._paginate(
                method='GET',
                url_suffix='/v1/issues/providers',
                params=params
            )

        def list_pocs(self, limit: int = DEFAULT_RESULTS) -> Iterator[Any]:
            params = dict(limit=limit)
            return self._paginate(
                method='GET',
                url_suffix='/v2/annotation/point-of-contact',
                params=params
            )

        def create_poc(self, email: str, first_name: Optional[str], last_name: Optional[str], role: Optional[str],
                       phone: Optional[str]) -> Dict[str, Any]:
            data: Dict = {
                'email': email,
                'firstName': first_name,
                'lastName': last_name,
                'phone': phone,
                'role': role
            }
            return self._http_request(
                method='POST',
                url_suffix='/v2/annotation/point-of-contact',
                data=json.dumps(data)
            )

        def list_tags(self, limit: int = DEFAULT_RESULTS) -> Iterator[Any]:
            params = dict(limit=limit)
            return self._paginate(
                method='GET',
                url_suffix='/v3/annotations/tags',
                params=params
            )

        def create_tag(self, name: str, description: Optional[str]) -> Dict[str, Any]:
            data: Dict = {
                'name': name,
                'description': description

            }
            return self._http_request(
                method='POST',
                url_suffix='/v3/annotations/tags',
                data=json.dumps(data)
            )

        def get_asset_details(self, asset_type: str, asset_id: str,
                              include: str = 'annotations,attributionReasons') -> Dict[str, Any]:
            data: Dict = {}
            if asset_type == 'IpRange':
                data = self.get_iprange_by_id(
                    iprange_id=asset_id,
                    include=include
                )
            elif asset_type == 'Certificate':
                data = self.get_certificate_by_md5_hash(asset_id)
            elif asset_type == 'Domain':
                data = self.get_domain_by_domain(domain=asset_id)
            else:
                demisto.debug(f'get_asset_details: unsupported asset type {asset_type}')
            return data

        def manage_asset_tags(self, asset_type: str, operation_type: str, asset_id: str,
                              tag_ids: List[str]) -> Dict[str, Any]:
            # Only custom ranges need to use the v2 APIs, otherwise we should always use v3
            if asset_type == "ip-range":
                tag_url = f'/v2/{asset_type}/tag-assignments/bulk'
                data = {"operations": [{
                    'operationType': operation_type,
                    'tagIds': tag_ids,
                    'assetId': asset_id
                }]}

            else:
                tag_url = '/v3/assets/assets/annotations'
                data = {"operations": [
                    {
                        "operationType": operation_type,
                        "annotationType": "TAG",
                        "annotationIds": tag_ids,
                        "assetId": asset_id
                    }]}

            return self._http_request(
                method='POST',
                url_suffix=tag_url,
                json_data=data,
                retries=3
            )

        def manage_asset_pocs(self, asset_type: str, operation_type: str, asset_id: str, poc_ids: List[str]) -> Dict[str, Any]:
            # Only custom ranges need to use the v2 APIs, otherwise we should always use v3
            if asset_type == "ip-range":
                poc_url = f'/v2/{asset_type}/contact-assignments/bulk'
                data = {"operations": [{
                    'operationType': operation_type,
                    'contactIds': poc_ids,
                    'assetId': asset_id
                }]}

            else:
                poc_url = '/v3/assets/assets/annotations'
                data = {"operations": [
                    {
                        "operationType": operation_type,
                        "annotationType": "CONTACT",
                        "annotationIds": poc_ids,
                        "assetId": asset_id
                    }]}

            return self._http_request(
                method='POST',
                url_suffix=poc_url,
                json_data=data,
                retries=3
            )

        def update_issue(self, issue_id: str, update_type: str, value: str) -> Dict[str, Any]:
            data: Dict = {
                'updateType': update_type,
                'value': value
            }
            return self._http_request(
                method='POST',
                url_suffix=f'/v1/issues/issues/{issue_id}/updates',
                data=json.dumps(data)
            )

        def get_iprange_by_id(self, iprange_id: str, include: str) -> Dict[str, Any]:
            try:
                result: Dict = self._http_request(
                    method='GET',
                    url_suffix=f'/v2/ip-range/{iprange_id}',
                    raise_on_status=True,
                    params={
                        'include': include
                    }
                )
            except DemistoException as e:
                if str(e).startswith('Error in API call [404]') or str(e).startswith('Error in API call [400]'):
                    return {}
                raise e
            return result

        def get_domain_by_domain(self, domain: str, last_observed_date: Optional[str] = None) -> Dict[str, Any]:
            params = {}
            if last_observed_date is not None:
                params['minRecentIpLastObservedDate'] = last_observed_date

            try:
                result = self._http_request(
                    method='GET',
                    url_suffix=f'/v2/assets/domains/{domain}',
                    raise_on_status=True,
                    params=params
                )
            except DemistoException as e:
                if str(e).startswith('Error in API call [404]') or str(e).startswith('Error in API call [400]'):
                    return {}
                raise e
            return result

        def get_certificate_by_md5_hash(self, md5_hash: str, last_observed_date: Optional[str] = None) -> Dict[str, Any]:
            params = {}

            if last_observed_date is not None:
                params['minRecentIpLastObservedDate'] = last_observed_date

            try:
                result: Dict = self._http_request(
                    method='GET',
                    url_suffix=f'/v2/assets/certificates/{md5_hash}',
                    raise_on_status=True,
                    params=params
                )
            except DemistoException as e:
                if str(e).startswith('Error in API call [404]') or str(e).startswith('Error in API call [400]'):
                    return {}
                raise e
            return result

        def get_ipranges(self, params: Dict[str, Any]) -> Iterator[Any]:
            return self._paginate(
                method='GET',
                url_suffix='/v2/ip-range',
                params=params
            )

        def get_domains(self, params: Dict[str, Any]) -> Iterator[Any]:
            return self._paginate(
                method='GET',
                url_suffix='/v2/assets/domains',
                params=params
            )

        def get_certificates(self, params: Dict[str, Any]) -> Iterator[Any]:
            return self._paginate(
                method='GET',
                url_suffix='/v2/assets/certificates',
                params=params
            )

        def get_ips(self, params: Dict[str, Any]) -> Iterator[Any]:
            return self._paginate(
                method='GET',
                url_suffix='/v2/assets/ips',
                params=params
            )

        def get_cloud_resources(self, params: Dict[str, Any]) -> Iterator[Any]:
            return self._paginate(
                method='GET',
                url_suffix='/v2/assets/cloud-resources',
                params=params
            )

        def get_cloud_resource(self, asset_id: str) -> Dict[str, Any]:
            try:
                result: Dict = self._http_request(
                    method='GET',
                    url_suffix=f'/v2/assets/cloud-resources/{asset_id}',
                    raise_on_status=True,
                )
            except DemistoException as e:
                if str(e).startswith('Error in API call [404]') or str(e).startswith('Error in API call [400]'):
                    demisto.info("Cloud resource with ID: {asset_id} was not found. Error message from API: {str(e)}")
                    return {}
                raise e
            return result

        def parse_asset_data(self, issue: Dict[str, Any],
                             fetch_details: Optional[bool] = False) -> Tuple[List[Dict[str, Any]], List[str], bool]:
            assets: List[Dict[str, Any]] = []
            changed = False
            ml_feature_list: List[str] = []
            if issue.get('assets') and isinstance(issue['assets'], list):
                assets = copy.deepcopy(issue['assets'])
                for n, a in enumerate(assets):
                    if not isinstance(a, dict) or 'assetType' not in a:
                        continue

                    # Handle conversion of IP ranges to CIDRs for AutoExtract
                    if (
                            a['assetType'] == 'IpRange'
                            and 'displayName' in a
                            and isinstance(dn := a['displayName'], str)
                            and len(r := dn.split('-')) == 2
                    ):
                        assets[n]['displayName'] = ','.join(range_to_cidrs(r[0], r[1]))
                        changed = True

                    if not fetch_details or 'assetKey' not in a:
                        continue

                    # Fetch additional details for assets
                    details = self.get_asset_details(a['assetType'], a['assetKey'])
                    if not isinstance(details, dict):
                        continue

                    # Replace asset ID with the real asset ID (the ID shown in asset is a reference of the association table)
                    if real_id := details.get('id', None):
                        assets[n]['id'] = real_id
                        changed = True

                    # Handle Tags
                    if (tags := details.get('annotations', {}).get('tags')) and isinstance(tags, list):
                        assets[n]['tags'] = '\n'.join(sorted(t['name'] for t in tags if 'name' in t))
                        changed = True

                    # Handle Attribution reasons
                    if (ar := details.get('attributionReasons')) and isinstance(ar, list):
                        assets[n]['attributionReasons'] = '\n'.join(
                            sorted(
                                str(a.get('reason')) for a in ar if isinstance(a, dict) and a.get('reason')
                            )
                        )
                        changed = True

                    # Handle ML fields

                    if a.get('assetType') == 'IpRange':
                        # for IP Range collect relatedRegistrarInformation.registryEntities.formattedName
                        if (
                                (rri := details.get('relatedRegistrationInformation'))
                                and isinstance(rri, list)
                                and isinstance(rri[0], dict)
                                and (re := rri[0].get('registryEntities'))
                                and isinstance(re, list)
                        ):
                            ml_feature_list.extend({r['formattedName']
                                                    for r in re if 'formattedName' in r})  # pylint: disable=E1133

                    elif a.get('assetType') == "Certificate":
                        # for Certificate collect issuerOrg, issuerName,
                        # subjectName, subjectAlternativeNames, subjectOrg, subjectOrgUnit
                        if (cert := details.get('certificate')) and isinstance(cert, dict):
                            for f in ['issuerOrg', 'issuerName', 'subjectOrg', 'subjectName', 'subjectOrgUnit']:
                                if (x := cert.get(f)):
                                    ml_feature_list.append(x)
                            if (san := cert.get('subjectAlternativeNames')) and isinstance(san, str):
                                ml_feature_list.extend(san.split(' '))

                    elif a.get('assetType') == "Domain":
                        # for Domain collect domain, name servers, registrant and admin name/organization
                        if (
                                (whois := details.get('whois'))
                                and isinstance(whois, list)
                                and isinstance(whois[0], dict)
                        ):
                            if (x := whois[0].get('domain')):
                                ml_feature_list.append(x)

                            # nameServers
                            if (
                                    (ns := whois[0].get('nameServers'))
                                    and isinstance(ns, list)
                            ):
                                ml_feature_list.extend(ns)

                            # admin
                            if (admin := whois[0].get('admin')):
                                for f in ['name', 'organization']:
                                    if (x := admin.get(f)):
                                        ml_feature_list.append(x)
                            # registrant
                            if (reg := whois[0].get('registrant')):
                                for f in ['name', 'organization']:
                                    if (x := reg.get(f)):
                                        ml_feature_list.append(x)

            if len(ml_feature_list) > 0:
                changed = True
            return assets, ml_feature_list, changed


    class DeprecatedCommandException(BaseException):
        def __init__(self):
            super().__init__(
                f'The {demisto.command()} command is no longer supported by the Xpanse API, and has been deprecated.'
            )


    """ HELPER FUNCTIONS """


    class DBotScoreOnlyIndicator(Common.Indicator):
        """
        This class represents a generic indicator and is used only to return DBotScore
        """

        def __init__(self, dbot_score: Common.DBotScore):
            self.dbot_score = dbot_score

        def to_context(self):
            return self.dbot_score.to_context()


    def calculate_limits(limit: Any) -> Tuple[int, int]:
        total_results = check_int(limit, 'limit', None, None, False)
        if not total_results:
            total_results = DEFAULT_RESULTS
        elif total_results > MAX_RESULTS:
            total_results = MAX_RESULTS
        max_page_size = MAX_PAGE_SIZE if total_results > MAX_PAGE_SIZE else total_results
        return (total_results, max_page_size)


    def handle_iprange_include(arg: Optional[str], arg_name: Optional[str]) -> str:
        include = argToList(arg)
        sanitized_include: str = ''
        if include and not any('none' in i for i in include):
            if not all(i in IPRANGE_INCLUDE_OPTIONS for i in include):
                raise ValueError(f'{arg_name} must contain the following options: {", ".join(IPRANGE_INCLUDE_OPTIONS)}')
            else:
                sanitized_include = ','.join(include)

        return sanitized_include


    def range_to_cidrs(start: str, end: str) -> Iterator[str]:
        try:
            for i in ipaddress.summarize_address_range(ipaddress.IPv4Address(start), ipaddress.IPv4Address(end)):
                yield str(i)
        except ipaddress.AddressValueError as e:
            raise ValueError(f'Invalid IP address in range: {str(e)}')


    def check_int(arg: Any, arg_name: str, min_val: int | None = None, max_val: int | None = None,
                  required: bool = False) -> Optional[int]:
        """Converts a string argument to a Python int
        This function is used to quickly validate an argument provided and convert
        it into an ``int`` type. It will throw a ValueError if the input is invalid
        or outside the optional range. If the input is None, it will throw a ValueError
        if required is ``True``, or ``None`` if required is ``False.
        """

        # check if argument is mandatory
        if arg is None:
            if required is True:
                raise ValueError(f'Missing argument "{arg_name}"')
            return None

        i: Optional[int] = None

        if isinstance(arg, str):
            if not arg.isdigit():
                raise ValueError(f'Integer invalid: "{arg_name}"="{arg}"')
            try:
                i = int(arg)
            except ValueError:
                raise ValueError(f'Integer invalid: "{arg_name}"="{arg}"')
        elif isinstance(arg, int):
            i = arg
        else:
            raise ValueError(f'Invalid number: "{arg_name}"')

        # range check
        if min_val and i < min_val:
            raise ValueError(f'Integer outside minimum range: "{arg_name}"="{arg}" ("min={min_val}")')
        if max_val and i > max_val:
            raise ValueError(f'Integer outside maximum range: "{arg_name}"="{arg}" ("max={max_val}")')

        return i


    def convert_priority_to_xsoar_severity(priority: str) -> int:
        """Maps Expanse priority to Cortex XSOAR severity
        Converts the Expanse issue priority  ('Low', 'Medium', 'High',
        'Critical') to Cortex XSOAR incident severity (1 to 4) for mapping.
        :type priority: ``str``
        :param priority: priority as returned from the Expanse API (str)
        :return: Cortex XSOAR Severity (1 to 4)
        :rtype: ``int``
        """

        return PRIORITY_SEVERITY_MAP[priority] if priority in PRIORITY_SEVERITY_MAP else PRIORITY_SEVERITY_MAP['Unknown']


    def datestring_to_timestamp_us(ds: str) -> int:
        dt = parse(ds)
        assert dt is not None
        ts = int(dt.timestamp()) * 1000000 + dt.microsecond
        return ts


    def timestamp_us_to_datestring_utc(ts: int, date_format: str = DATE_FORMAT) -> str:
        dt = datetime.fromtimestamp(ts // 1000000, timezone.utc).replace(microsecond=ts % 1000000)
        ds = dt.strftime(date_format)
        return ds


    def format_cidr_data(cidrs: List[Dict[str, Any]]) -> List[CommandResults]:
        cidr_data_list: List[Dict[str, Any]] = []
        command_results = []
        for cidr_data in cidrs:
            cidr_data['cidr'] = ','.join(range_to_cidrs(cidr_data['startAddress'], cidr_data['endAddress'])) \
                if ('startAddress' in cidr_data and 'endAddress' in cidr_data) else None

            if not cidr_data['cidr']:
                continue

            cidr_context_excluded_fields: List[str] = ['startAddress', 'endAddress']
            cidr_data_list.append({
                k: cidr_data[k]
                for k in cidr_data if k not in cidr_context_excluded_fields
            })

            cidr_standard_context = DBotScoreOnlyIndicator(
                dbot_score=Common.DBotScore(
                    indicator=cidr_data['cidr'],
                    indicator_type=DBotScoreType.CIDR,
                    integration_name="ExpanseV2",
                    score=Common.DBotScore.NONE,
                    reliability=demisto.params().get('integrationReliability')
                )
            )
            command_results.append(CommandResults(
                readable_output=tableToMarkdown("New CIDR indicator was found", cidr_standard_context.to_context()),
                indicator=cidr_standard_context
            ))
        command_results.append(CommandResults(
            outputs_prefix='Expanse.IPRange',
            outputs_key_field='id',
            outputs=cidr_data_list if len(cidr_data_list) > 0 else None,
        ))
        return command_results


    def find_indicator_md5_by_hash(h: str) -> Optional[str]:
        field = {
            40: 'sha1',
            64: 'sha256',
            128: 'sha512'
        }.get(len(h))

        if field is None:
            return None

        search_indicators = IndicatorsSearcher()
        fetched_iocs = search_indicators.search_indicators_by_version(
            query=f'{field}:{h} and type:Certificate and -md5:""', size=1  # we just take the first one
        ).get('iocs')
        if fetched_iocs is None or len(fetched_iocs) == 0:
            return None

        if (custom_fields := fetched_iocs[0].get('CustomFields')) is None:
            return None

        return custom_fields.get('md5')


    def format_domain_data(domains: List[Dict[str, Any]]) -> List[CommandResults]:
        domain_data_list: List[Dict[str, Any]] = []
        command_results = []
        for domain_data in domains:
            if not isinstance(domain_data, dict) or 'domain' not in domain_data:
                continue
            domain = domain_data['domain']

            whois_args = {}
            if (w := domain_data.get('whois')) and isinstance(w, list):
                whois = w[0]
                admin = whois.get('admin', {})
                registrar = whois.get('registrar', {})
                if not isinstance(registrar, dict):
                    registrar = {}
                registrant = whois.get('registrant', {})
                if not isinstance(registrant, dict):
                    registrant = {}
                domain_statuses = whois.get('domainStatuses', [])
                if not isinstance(domain_statuses, list):
                    domain_statuses = []

                whois_args = assign_params(
                    creation_date=whois.get('creationDate'),
                    updated_date=whois.get('updatedDate'),
                    expiration_date=whois.get('registryExpiryDate'),
                    name_servers=whois.get('nameServers'),
                    domain_status=domain_statuses[0] if domain_statuses else [],
                    organization=admin.get('organization'),
                    admin_name=admin.get('name'),
                    admin_email=admin.get('emailAddress'),
                    admin_phone=admin.get('phoneNumber'),
                    admin_country=admin.get('country'),
                    registrar_name=registrar.get('name'),
                    registrant_email=registrant.get('emailAddress'),
                    registrant_name=registrant.get('name'),
                    registrant_phone=registrant.get('phoneNumber'),
                    registrant_country=registrant.get('country')
                )

            domain_standard_context: Common.Domain
            if domain.startswith('*.'):
                indicator_type = DBotScoreType.DOMAINGLOB
            else:
                indicator_type = DBotScoreType.DOMAIN

            domain_standard_context = Common.Domain(
                domain=domain,
                dbot_score=Common.DBotScore(
                    indicator=domain,
                    indicator_type=indicator_type,
                    integration_name="ExpanseV2",
                    score=Common.DBotScore.NONE,
                    reliability=demisto.params().get('integrationReliability')
                ),
                **whois_args
            )
            command_results.append(CommandResults(
                readable_output=tableToMarkdown("New Domain indicator was found", domain_standard_context.to_context()),
                indicator=domain_standard_context
            ))
            domain_context_excluded_fields: List[str] = []
            domain_data_list.append({
                k: domain_data[k]
                for k in domain_data if k not in domain_context_excluded_fields
            })

        readable_output = tableToMarkdown(
            'Expanse Domain List', domain_data_list) if len(domain_data_list) > 0 else "## No Domains found"
        command_results.append(CommandResults(
            readable_output=readable_output,
            outputs_prefix='Expanse.Domain',
            outputs_key_field='domain',
            outputs=domain_data_list if len(domain_data_list) > 0 else None,
        ))
        return command_results


    def format_certificate_data(certificates: List[Dict[str, Any]]) -> List[CommandResults]:
        certificate_data_list: List[Dict[str, Any]] = []
        certificate_context_excluded_fields: List[str] = []
        command_results = []
        for certificate in certificates:
            expanse_certificate = certificate.get('certificate')
            if expanse_certificate is None:
                continue

            # Standard Context (Common.Certificate + DBotScore)
            # they are prefixed with PEM but they really the hashes of DER (like it should be)
            ec_sha256 = expanse_certificate.get('pemSha256')
            if ec_sha256 is None:
                demisto.debug('SHA-256 not found!!!')
                continue
            indicator_value = base64.urlsafe_b64decode(ec_sha256).hex()

            ec_md5 = expanse_certificate.get('md5Hash')
            ec_sha1 = expanse_certificate.get('pemSha1')
            ec_spki = expanse_certificate.get('publicKeySpki')

            ec_modulus = expanse_certificate.get('publicKeyModulus')
            ec_publickey = None
            if (pktemp := expanse_certificate.get('publicKey')) is not None:
                ec_publickey = base64.urlsafe_b64decode(pktemp).hex()

            ec_san = expanse_certificate.get('subjectAlternativeNames')

            pem = None
            if (details := certificate.get('details')) is not None:
                if (base64Encoded := details.get('base64Encoded')) is not None and base64Encoded != '':
                    pem_lines = '\n'.join([base64Encoded[i:i + 64] for i in range(0, len(base64Encoded), 64)])
                    pem = f"-----BEGIN CERTIFICATE-----\n{pem_lines}\n-----END CERTIFICATE-----"

            certificate_standard_context = Common.Certificate(
                serial_number=expanse_certificate.get('serialNumber'),
                subject_dn=expanse_certificate.get('subject'),
                issuer_dn=expanse_certificate.get('issuer'),
                md5=base64.urlsafe_b64decode(ec_md5).hex() if ec_md5 else None,
                sha1=base64.urlsafe_b64decode(ec_sha1).hex() if ec_sha1 else None,
                sha256=indicator_value,
                publickey=Common.CertificatePublicKey(
                    algorithm=expanse_certificate.get('publicKeyAlgorithm'),
                    length=expanse_certificate.get('publicKeyBits'),
                    modulus=':'.join([ec_modulus[i:i + 2] for i in range(0, len(ec_modulus), 2)]) if ec_modulus else None,
                    exponent=expanse_certificate.get('publicKeyRsaExponent'),
                    publickey=':'.join(
                        [ec_publickey[i:i + 2] for i in range(0, len(ec_publickey), 2)]) if ec_publickey else None
                ),
                spki_sha256=base64.urlsafe_b64decode(ec_spki).hex() if ec_spki else None,
                signature_algorithm=expanse_certificate.get('signatureAlgorithm'),
                subject_alternative_name=[san for san in ec_san.split() if len(san) != 0] if ec_san else None,
                validity_not_after=expanse_certificate.get('validNotAfter'),
                validity_not_before=expanse_certificate.get('validNotBefore'),
                pem=pem,
                dbot_score=Common.DBotScore(
                    indicator=indicator_value,
                    indicator_type=DBotScoreType.CERTIFICATE,
                    integration_name="ExpanseV2",
                    score=Common.DBotScore.NONE,
                    reliability=demisto.params().get('integrationReliability')
                )
            )
            command_results.append(CommandResults(
                readable_output=tableToMarkdown("New Certificate indicator was found",
                                                certificate_standard_context.to_context()),
                indicator=certificate_standard_context,
            ))
            # Expanse Context
            certificate_data_list.append({
                k: certificate[k]
                for k in certificate if k not in certificate_context_excluded_fields
            })

        readable_output = tableToMarkdown(
            'Expanse Certificate List', certificate_data_list) if len(
            certificate_data_list) > 0 else "## No Certificates found"
        command_results.append(CommandResults(
            readable_output=readable_output,
            outputs_prefix='Expanse.Certificate',
            outputs_key_field='id',
            outputs=certificate_data_list if len(certificate_data_list) > 0 else None,
            ignore_auto_extract=True,
        ))
        return command_results


    def format_cloud_resource_data(cloud_resources: List[Dict[str, Any]]) -> List[CommandResults]:
        cloud_resource_data_list: List[Dict[str, Any]] = []
        command_results = []
        hr_cloud_resource_list = []
        for cloud_resource_data in cloud_resources:
            cloud_resource_data_list.append(cloud_resource_data)

            cloud_resource_standard_context = DBotScoreOnlyIndicator(
                dbot_score=Common.DBotScore(
                    indicator=cloud_resource_data['ips'][0],
                    indicator_type=DBotScoreType.IP,
                    integration_name="ExpanseV2",
                    score=Common.DBotScore.NONE,
                    reliability=demisto.params().get('integrationReliability')
                )
            )
            command_results.append(CommandResults(
                readable_output=tableToMarkdown("New IP indicator was found", {"IP": cloud_resource_data['ips'][0]}),
                indicator=cloud_resource_standard_context
            ))
            hr_cloud_resource_list.append({
                "ID": cloud_resource_data.get("id"),
                "IP": cloud_resource_data.get("ips"),
                "Domain": cloud_resource_data.get("domain"),
                "Cloud Provider": cloud_resource_data.get("provider", {}).get("name"),
                "Asset Type": cloud_resource_data.get("type"),
                "Instance ID": cloud_resource_data.get("instanceId"),
                "Region": cloud_resource_data.get("region"),
                "Source": cloud_resource_data.get("sourceDetails"),
            })
        readable_output = tableToMarkdown(
            'Expanse Cloud Resource List', hr_cloud_resource_list) if len(hr_cloud_resource_list) > 0 else \
            "## No Cloud Resources found"
        command_results.append(CommandResults(
            outputs_prefix='Expanse.CloudResource',
            outputs_key_field='id',
            outputs=cloud_resource_data_list if len(cloud_resource_data_list) > 0 else None,
            readable_output=readable_output,
            raw_response=cloud_resources
        ))

        return command_results


    """ COMMAND FUNCTIONS """


    def test_module(client: Client) -> str:
        """Tests API connectivity and authentication'

        Returning 'ok' indicates that the integration works like it is supposed to.
        Connection to the service is successful.
        Raises exceptions if something goes wrong.

        :type client: ``Client``
        :param Client: client to use

        :return: 'ok' if test passed, anything else will fail the test.
        :rtype: ``str``
        """

        try:
            client.get_issue_count()
        except DemistoException as e:
            if "Forbidden" in str(e) or "Authorization failed" in str(e):
                return "Authorization Error: make sure API Key is correctly set"
            else:
                raise e
        return "ok"


    def get_issues_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        total_results, max_page_size = calculate_limits(args.get('limit', None))

        provider = ','.join(argToList(args.get('provider')))
        business_units = ','.join(argToList(args.get('business_unit')))
        assignee = ','.join(argToList(args.get('assignee')))
        issue_type = ','.join(argToList(args.get('issue_type')))
        tags = ','.join(argToList(args.get('tag')))

        content_search = args.get('content_search')
        inet_search = args.get('inet_search')
        domain_search = args.get('domain_search')

        arg_list = argToList(args.get('port_number'))
        # this will trigger exceptions if the port provided isn't a valid port number 0-65535
        all(check_int(i, 'port_number', 0, 65535, True) for i in arg_list)
        port_number = ','.join(arg_list)

        arg_list = argToList(args.get('progress_status'))
        if arg_list and not all(i in ISSUE_PROGRESS_STATUS for i in arg_list):
            raise ValueError(f'progress_status must include: {", ".join(ISSUE_PROGRESS_STATUS)}')
        progress_status = ','.join(arg_list)

        arg_list = argToList(args.get('activity_status'))
        if arg_list and not all(i in ISSUE_ACTIVITY_STATUS for i in arg_list):
            raise ValueError(f'activity_status must include: {", ".join(ISSUE_ACTIVITY_STATUS)}')
        activity_status = ','.join(arg_list)

        arg_list = argToList(args.get('priority'))
        if arg_list and not all(i in ISSUE_PRIORITY for i in arg_list):
            raise ValueError(f'priority must include: {", ".join(ISSUE_PRIORITY)}')
        priority = ','.join(arg_list)

        arg_list = argToList(args.get('cloud_management_status'))
        if arg_list and not all(i in CLOUD_MANAGEMENT_STATUS for i in arg_list):
            raise ValueError(f'cloud_management_status must include: {", ".join(CLOUD_MANAGEMENT_STATUS)}')
        cloud_management_status = ','.join(arg_list)

        arg_list = argToList(args.get('sort'))
        if arg_list and not all(i in ISSUE_SORT_OPTIONS for i in arg_list):
            raise ValueError(f'sort must include: {", ".join(ISSUE_SORT_OPTIONS)}')
        sort = ','.join(arg_list)

        d = args.get('created_before', None)
        created_before = parse(d).strftime(DATE_FORMAT) if d else None  # type: ignore

        d = args.get('created_after', None)
        created_after = parse(d).strftime(DATE_FORMAT) if d else None  # type: ignore

        d = args.get('modified_before', None)
        modified_before = parse(d).strftime(DATE_FORMAT) if d else None  # type: ignore

        d = args.get('modified_after', None)
        modified_after = parse(d).strftime(DATE_FORMAT) if d else None  # type: ignore

        issues = list(
            islice(
                client.get_issues(limit=max_page_size, content_search=content_search, provider=provider,
                                  business_units=business_units, assignee=assignee, issue_type=issue_type,
                                  inet_search=inet_search, domain_search=domain_search, port_number=port_number,
                                  progress_status=progress_status, activity_status=activity_status, priority=priority,
                                  tags=tags, created_before=created_before, created_after=created_after,
                                  modified_before=modified_before, modified_after=modified_after,
                                  cloud_management_status=cloud_management_status, sort=sort),
                total_results
            )
        )

        if len(issues) < 1:
            return CommandResults(readable_output='No Issues Found')

        readable_output = tableToMarkdown(
            name='Expanse Issues',
            t=issues,
            headers=EXPANSE_ISSUE_READABLE_HEADER_LIST,
            headerTransform=pascalToSpace
        )

        return CommandResults(
            readable_output=readable_output, outputs_prefix="Expanse.Issue", outputs_key_field="id", outputs=issues
        )


    def get_services_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        total_results, max_page_size = calculate_limits(args.get('limit', None))

        provider = ','.join(argToList(args.get('provider')))
        business_units = ','.join(argToList(args.get('business_unit')))
        service_type = ','.join(argToList(args.get('service_type')))
        tags = ','.join(argToList(args.get('tag')))

        content_search = args.get('content_search')
        inet_search = args.get('inet_search')
        domain_search = args.get('domain_search')

        arg_list = argToList(args.get('port_number'))
        # this will trigger exceptions if data is invalid
        all(check_int(i, 'port_number', 0, 65535, True) for i in arg_list)
        port_number = ','.join(arg_list)

        arg_list = argToList(args.get('country_code'))
        # This will check to make sure that a provided country code is a two character alpha string
        if arg_list and not all(i.isalpha() and len(i) == 2 for i in arg_list):
            raise ValueError('country_code must be an ISO-3166 two character country code')
        country_code = ','.join([i.upper() for i in arg_list])

        arg_list = argToList(args.get('activity_status'))
        if arg_list and not all(i in ISSUE_ACTIVITY_STATUS for i in arg_list):
            raise ValueError(f'activity_status must include: {", ".join(ISSUE_ACTIVITY_STATUS)}')
        activity_status = ','.join(arg_list)

        arg_list = argToList(args.get('discovery_type'))
        if arg_list and not all(i in SERVICE_DISCOVERY_TYPE for i in arg_list):
            raise ValueError(f'discovery_type must include: {", ".join(SERVICE_DISCOVERY_TYPE)}')
        discovery_type = ','.join(arg_list)

        arg_list = argToList(args.get('cloud_management_status'))
        if arg_list and not all(i in CLOUD_MANAGEMENT_STATUS for i in arg_list):
            raise ValueError(f'cloud_management_status must include: {", ".join(CLOUD_MANAGEMENT_STATUS)}')
        cloud_management_status = ','.join(arg_list)

        sort = args.get('sort')
        if sort and sort not in SERVICE_SORT_OPTIONS:
            raise ValueError(f'sort must include: {", ".join(SERVICE_SORT_OPTIONS)}')

        services = list(
            islice(
                client.get_services(limit=max_page_size, content_search=content_search, provider=provider,
                                    business_units=business_units, service_type=service_type,
                                    inet_search=inet_search, domain_search=domain_search, port_number=port_number,
                                    activity_status=activity_status, discovery_type=discovery_type,
                                    tags=tags, cloud_management_status=cloud_management_status,
                                    country_code=country_code, sort=sort),
                total_results
            )
        )

        if len(services) < 1:
            return CommandResults(readable_output='No Services Found')

        # reduce some objects for human readable
        hr_services = copy.deepcopy(services)
        for service in hr_services:
            service["classifications"] = [c.get("name") for c in service.get("classifications", [])]
            service["tlsVersions"] = [f'version: {t.get("tlsVersion")} - cipher_suite: {t.get("cipherSuite")}'
                                      for t in service.get("tlsVersions", [])]
            service["certificates"] = [f'subject_name: {c.get("certificate", {}).get("subjectName")}' for c in
                                       service.get("certificates", [])]

        readable_output = tableToMarkdown(
            name='Expanse Services',
            t=hr_services,
            headers=EXPANSE_SERVICE_READABLE_HEADER_LIST,
            headerTransform=pascalToSpace
        )

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix="Expanse.Service",
            outputs_key_field="id",
            outputs=services
        )


    def get_service_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        if not (service_id := args.get('service_id')):
            raise ValueError('service_id not specified')

        service = client.get_service_by_id(service_id=service_id)

        # reduce some objects for human readable
        hr_service = copy.deepcopy(service)
        if hr_service is not None:
            hr_service["classifications"] = [c.get("name") for c in hr_service.get("classifications", [])]
            hr_service["tlsVersions"] = [f'version: {t.get("tlsVersion")} - cipher_suite: {t.get("cipherSuite")}'
                                         for t in hr_service.get("tlsVersions", [])]
            hr_service["certificates"] = [f'subject_name: {c.get("certificate", {}).get("subjectName")}'
                                          for c in hr_service.get("certificates", [])]

        readable_output = tableToMarkdown(
            name='Expanse Services',
            t=hr_service,
            headers=EXPANSE_SERVICE_READABLE_HEADER_LIST,
            headerTransform=pascalToSpace
        )

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix="Expanse.Service",
            outputs_key_field="id",
            outputs=service
        )


    def get_issue_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        if not (issue_id := args.get('issue_id')):
            raise ValueError('issue_id not specified')

        issue = client.get_issue_by_id(issue_id=issue_id)

        readable_output = tableToMarkdown(
            name='Expanse Issues',
            t=issue,
            headers=EXPANSE_ISSUE_READABLE_HEADER_LIST,
            headerTransform=pascalToSpace
        )

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix="Expanse.Issue",
            outputs_key_field="id",
            outputs=issue
        )


    def get_issue_updates_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        total_results, max_page_size = calculate_limits(args.get('limit', None))

        if not (issue_id := args.get('issue_id')):
            raise ValueError('issue_id not specified')

        update_types = argToList(args.get('update_types'))
        if update_types and not all(i in ISSUE_UPDATE_TYPES.keys() for i in update_types):
            raise ValueError(f'Invalid update_type: {update_types}. Must include: {",".join(ISSUE_UPDATE_TYPES.keys())}')

        d = args.get('created_after')
        created_after = parse(d).strftime(DATE_FORMAT) if d else None  # type: ignore

        issue_updates = [
            {**u, "issueId": issue_id}  # this adds the issue id to the resulting dict
            for u in sorted(
                islice(
                    client.get_issue_updates(
                        issue_id=issue_id,
                        limit=max_page_size,
                        update_types=update_types,
                        created_after=created_after
                    ),
                    total_results
                ),
                key=lambda k: k['created']
            )
        ]

        return CommandResults(
            outputs_prefix="Expanse.IssueUpdate", outputs_key_field="id", outputs=issue_updates
        )


    def get_issue_comments_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        total_results, max_page_size = calculate_limits(args.get('limit', None))

        if not (issue_id := args.get('issue_id')):
            raise ValueError('issue_id not specified')

        d = args.get('created_after')
        created_after = parse(d).strftime(DATE_FORMAT) if d else None  # type: ignore

        issue_comments = [
            {**u, "issueId": issue_id}  # this adds the issue id to the resulting dict
            for u in sorted(
                islice(
                    client.get_issue_updates(
                        issue_id=issue_id,
                        limit=max_page_size,
                        update_types=['Comment'],
                        created_after=created_after
                    ),
                    total_results
                ),
                key=lambda k: k['created']
            )
        ]

        for n, c in enumerate(issue_comments):
            if (u := c.get('user')) and isinstance(u, dict) and 'username' in u:
                issue_comments[n]['user'] = u['username']

        md = tableToMarkdown(
            name='Expanse Issue Comments',
            t=issue_comments,
            headers=['user', 'value', 'created'],
            headerTransform=pascalToSpace,
            removeNull=True
        )

        return CommandResults(
            outputs_prefix="Expanse.IssueComment",
            outputs_key_field="id",
            outputs=issue_comments,
            readable_output=md
        )


    def update_issue_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        if not (issue_id := args.get('issue_id')):
            raise ValueError('issue_id not specified')

        update_type = args.get("update_type")
        if not update_type or update_type not in ISSUE_UPDATE_TYPES:
            raise ValueError(f'update_type must be one of: {",".join(ISSUE_UPDATE_TYPES.keys())}')

        if not (value := args.get('value')):
            raise ValueError('value must be specified')

        issue_update = client.update_issue(issue_id, update_type, value)

        return CommandResults(
            outputs_prefix="Expanse.IssueUpdate",
            outputs_key_field="id",
            outputs={**issue_update, "issueId": issue_id}  # this adds the issue id to the resulting dict
        )


    def fetch_incidents(client: Client, max_incidents: int,
                        last_run: Dict[str, Union[Optional[int], Optional[str]]], first_fetch: Optional[int],
                        priority: Optional[str], activity_status: Optional[str],
                        progress_status: Optional[str], business_units: Optional[str], issue_types: Optional[str],
                        tags: Optional[str], cloud_management_status: Optional[str],
                        mirror_direction: Optional[str], sync_tags: Optional[List[str]],
                        fetch_details: Optional[bool]
                        ) -> Tuple[Dict[str, Union[Optional[int], Optional[str]]], List[dict]]:
        """This function retrieves new alerts every interval (default is 1 minute).
        This function has to implement the logic of making sure that incidents are
        fetched only onces and no incidents are missed. By default it's invoked by
        XSOAR every minute. It will use last_run to save the timestamp of the last
        incident it processed. If last_run is not provided, it should use the
        integration parameter first_fetch to determine when to start fetching
        the first time. Uses "createdAfter" in the Expanse API for timestamp.

        :return:
            A tuple containing two elements:
                next_run (``Dict[str, int]``): Contains the timestamp that will be
                        used in ``last_run`` on the next fetch, and the last issue id.
                incidents (``List[dict]``): List of incidents that will be created in XSOAR
        :rtype: ``Tuple[Dict[str, Union[Optional[int], Optional[str]]], List[dict]]``
        """
        demisto.debug(f"ExpanseV2 - Last run: {json.dumps(last_run)}")
        last_fetch = last_run.get('last_fetch')
        if last_fetch is None:
            last_fetch = cast(int, first_fetch)
        else:
            last_fetch = cast(int, last_fetch)

        latest_created_time = last_fetch

        last_issue_id = last_run.get('last_issue_id')
        latest_issue_id: Optional[str] = None

        incidents: List[Dict[str, Any]] = []

        arg_list = argToList(priority)
        if arg_list and not all(i in ISSUE_PRIORITY for i in arg_list):
            raise ValueError(f'priority must include: {", ".join(ISSUE_PRIORITY)}')
        _priority = ','.join(arg_list)

        arg_list = argToList(progress_status)
        if arg_list and not all(i in ISSUE_PROGRESS_STATUS for i in arg_list):
            raise ValueError(f'progressStatus must include: {", ".join(ISSUE_PROGRESS_STATUS)}')
        _progress_status = ','.join(arg_list)

        arg_list = argToList(activity_status)
        if arg_list and not all(i in ISSUE_ACTIVITY_STATUS for i in arg_list):
            raise ValueError(f'activityStatus must include: {", ".join(ISSUE_ACTIVITY_STATUS)}')
        _activity_status = ','.join(arg_list)

        arg_list = argToList(cloud_management_status)
        if arg_list and not all(i in CLOUD_MANAGEMENT_STATUS for i in arg_list):
            raise ValueError(f'cloudManagementStatus must include: {", ".join(CLOUD_MANAGEMENT_STATUS)}')
        _cloud_management_status = ','.join(arg_list)

        created_after = timestamp_us_to_datestring_utc(latest_created_time, DATE_FORMAT)

        r = client.get_issues(
            limit=max_incidents if not last_issue_id else max_incidents + 1,  # workaround to avoid unnecessary API calls
            priority=_priority, business_units=business_units,
            progress_status=_progress_status, activity_status=_activity_status, tags=tags,
            issue_type=issue_types, cloud_management_status=_cloud_management_status,
            created_after=created_after, sort='created'
        )
        broken = False
        issues: List = []
        skip = cast(str, last_issue_id)
        for i in r:
            if skip and not broken:
                if 'id' not in i or 'created' not in i:
                    continue

                # fix created time to make sure precision is the same to microsecond with no rounding
                i['created'] = timestamp_us_to_datestring_utc(datestring_to_timestamp_us(i['created']), DATE_FORMAT)

                if i['created'] != created_after:
                    issues.append(i)
                    broken = True
                elif i['id'] == skip:
                    broken = True
            else:
                issues.append(i)
            if len(issues) == max_incidents:
                break
        demisto.debug(f"ExpanseV2 - Number of incidents before filtering: {len(issues)}")
        skip_incidents = 0
        for issue in issues:
            ml_feature_list: List[str] = []

            if 'created' not in issue or 'id' not in issue:
                continue
            incident_created_time = datestring_to_timestamp_us(issue.get('created'))

            if last_fetch:
                if incident_created_time < last_fetch:
                    skip_incidents += 1
                    demisto.debug(f"ExpanseV2 - Skipping incident with id={issue.get('id')} and date={incident_created_time} "
                                  "because its creation time is smaller than the last fetch.")
                    continue
            incident_name = issue.get('headline') if 'headline' in issue else issue.get('id')

            # Mirroring
            issue['xsoar_mirroring'] = {
                'mirror_direction': mirror_direction,
                'mirror_id': issue.get('id'),
                'mirror_instance': demisto.integrationInstance(),
                'sync_tags': sync_tags
            }
            issue['xsoar_severity'] = convert_priority_to_xsoar_severity(issue.get('priority', 'Unknown'))

            # Handle asset information
            issue['assets'], ml_feature_list, _ = client.parse_asset_data(issue, fetch_details)

            # add issue specific information to ml key
            if (
                    (provider := issue.get('providers'))
                    and isinstance(provider, list)
                    and 'name' in provider[0]
            ):
                ml_feature_list.append(provider[0].get('name'))
            if (
                    (latest_evidence := issue.get('latestEvidence'))
                    and isinstance(latest_evidence, dict)
            ):
                if (
                        (geolocation := latest_evidence.get('geolocation'))
                        and isinstance(geolocation, dict)
                ):
                    for f in ['countryCode', 'city']:
                        if (x := geolocation.get(f)):
                            ml_feature_list.append(x)

            # dedup, sort and join ml feature list
            issue['ml_features'] = ' '.join(sorted(list(set(ml_feature_list))))
            incident = {
                'name': incident_name,
                'details': issue.get('helpText'),
                'occurred': issue.get('created'),
                'rawJSON': json.dumps(issue),
                'severity': issue.get('xsoar_severity')
            }
            latest_issue_id = issue.get('id')
            incidents.append(incident)
            if incident_created_time > latest_created_time:
                latest_created_time = incident_created_time

        next_run = {
            'last_fetch': latest_created_time,
            'last_issue_id': latest_issue_id if latest_issue_id else last_issue_id}

        demisto.debug(f"ExpanseV2 - Number of incidents after filtering: {len(incidents)}")
        demisto.debug(f"ExpanseV2 - Number of incidents skipped: {skip_incidents}")
        demisto.debug(f"ExpanseV2 - Next run after incidents fetching: : {json.dumps(next_run)}")

        return next_run, incidents


    def get_modified_remote_data_command(client: Client, args: Dict[str, Any]) -> GetModifiedRemoteDataResponse:
        remote_args = GetModifiedRemoteDataArgs(args)
        last_update = remote_args.last_update  # In the first run, this value will be set to 1 minute earlier

        demisto.debug(f'Performing get-modified-remote-data command. Last update is: {last_update}')

        last_update_utc = dateparser.parse(last_update, settings={'TIMEZONE': 'UTC'})
        assert last_update_utc is not None, f'could not parse {last_update}'
        modified_after = last_update_utc.strftime(DATE_FORMAT)

        modified_incidents = client.get_issues(
            limit=100,
            modified_after=modified_after
        )

        modified_incident_ids = list()
        for raw_incident in modified_incidents:
            incident_id = raw_incident.get('id')
            modified_incident_ids.append(incident_id)

        return GetModifiedRemoteDataResponse(modified_incident_ids)


    def get_remote_data_command(client: Client, args: Dict[str, Any], sync_owners: bool = False,
                                incoming_tags: Optional[List[str]] = [],
                                mirror_details: bool = False) -> GetRemoteDataResponse:
        parsed_args = GetRemoteDataArgs(args)
        demisto.debug(f'Performing get-remote-data command with incident id: {parsed_args.remote_incident_id}')
        issue_updates: List[Dict[str, Any]] = sorted(
            islice(
                client.get_issue_updates(
                    issue_id=parsed_args.remote_incident_id,
                    limit=MAX_UPDATES,
                    update_types=None,
                    created_after=parsed_args.last_update
                ),
                MAX_UPDATES
            ),
            key=lambda k: k.get('created')  # type: ignore
        )

        new_entries: List = []
        incident_updates: Dict[str, Any] = {}
        latest_comment: Dict[str, Any] = {}  # used for closing comment
        for update in issue_updates:
            update_type = update.get('updateType')
            if not update_type or update_type not in ISSUE_UPDATE_TYPES:
                demisto.debug('Skipping unknown Expanse incoming update type: {update_type}')
                continue

            if not (new_value := update.get('value')):
                continue

            updated_field = ISSUE_UPDATE_TYPES[update_type]
            previous_value = update.get('previousValue')
            update_user = update['user']['username'] \
                if ('user' in update and isinstance(update['user'], dict)
                    and 'username' in update['user']) else 'Unknown user'

            # handle incoming comment
            if update_type == 'Comment':
                new_entries.append({
                    'Type': EntryType.NOTE,
                    'Contents': f'{update_user} added a comment: [{new_value}]',
                    'ContentsFormat': EntryFormat.TEXT,
                    'Note': True,
                    'Tags': incoming_tags
                })
                latest_comment = update

            # handle incoming ownership change
            elif update_type == 'Assignee':
                incident_updates[updated_field] = new_value
                new_entries.append({
                    'Type': EntryType.NOTE,
                    'Contents': f'Mirroring: {update_user} changed assignee from [{previous_value}] to [{new_value}]',
                    'ContentsFormat': EntryFormat.TEXT,
                    'Note': False
                })
                if not sync_owners:
                    continue
                # handle unassignment
                if new_value == 'Unassigned':
                    incident_updates['xsoar_owner'] = ''
                    continue
                # new user assignment
                user_info = demisto.findUser(email=new_value)
                if user_info:
                    incident_updates['xsoar_owner'] = user_info.get('username')
                else:
                    demisto.debug(f'The user assigned to Expanse incident {parsed_args.remote_incident_id} [{new_value}]'
                                  f'is not registered on XSOAR, cannot change owner')

            elif update_type == 'ProgressStatus':
                # handle issue closure
                if previous_value not in ISSUE_PROGRESS_STATUS_CLOSED and new_value in ISSUE_PROGRESS_STATUS_CLOSED:
                    close_reason = EXPANSE_RESOLVEDSTATUS_TO_XSOAR.get(new_value, 'Other')
                    resolve_comment = latest_comment.get('value', '')
                    demisto.debug(f'Closing Expanse issue {parsed_args.remote_incident_id}')
                    new_entries.append({
                        'Type': EntryType.NOTE,
                        'Contents': {
                            'dbotIncidentClose': True,
                            'closeReason': close_reason,
                            'closeNotes': resolve_comment,
                        },
                        'ContentsFormat': EntryFormat.JSON,
                    })
                    incident_updates['closeReason'] = close_reason
                    incident_updates['closeNotes'] = resolve_comment

                # handle issue reopening
                elif previous_value in ISSUE_PROGRESS_STATUS_CLOSED and new_value not in ISSUE_PROGRESS_STATUS_CLOSED:
                    demisto.debug(f'Reopening Expanse issue {parsed_args.remote_incident_id}')
                    new_entries.append({
                        'Type': EntryType.NOTE,
                        'Contents': {
                            'dbotIncidentReopen': True,
                        },
                        'ContentsFormat': EntryFormat.JSON,
                    })

                    incident_updates['closeReason'] = None
                    incident_updates['closeNotes'] = None

                incident_updates[updated_field] = new_value
                new_entries.append({
                    'Type': EntryType.NOTE,
                    'Contents': f'Mirroring: {update_user} updated field [{updated_field}] from [{previous_value}] to [{new_value}]',
                    'ContentsFormat': EntryFormat.TEXT,
                    'Note': False
                })

            # handle everything else
            else:
                incident_updates[updated_field] = new_value
                if update_type == 'Priority':
                    incident_updates['xsoar_severity'] = convert_priority_to_xsoar_severity(new_value)
                new_entries.append({
                    'Type': EntryType.NOTE,
                    'Contents': f'Mirroring: {update_user} updated field [{updated_field}] from [{previous_value}] to [{new_value}]',
                    'ContentsFormat': EntryFormat.TEXT,
                    'Note': False
                })

        # update_assets
        if mirror_details:
            issue_details: Dict[str, Any] = client.get_issue_by_id(issue_id=parsed_args.remote_incident_id)
            assets, ml_feature_list, changed = client.parse_asset_data(issue_details, mirror_details)
            if changed:
                incident_updates['assets'] = assets
                # dedup, sort and join ml feature list
                incident_updates['ml_features'] = ' '.join(sorted(set(ml_feature_list)))

        # process incident updates only if anything has changed
        if len(incident_updates) > 0 or len(new_entries) > 0:
            incident_updates['id'] = parsed_args.remote_incident_id

        return GetRemoteDataResponse(incident_updates, new_entries)


    def update_remote_system_command(client: Client, args: Dict[str, Any], sync_owners: bool = False) -> str:
        remote_args = UpdateRemoteSystemArgs(args)
        remote_incident_id = remote_args.remote_incident_id
        entries: List = remote_args.entries if remote_args.entries else []
        for e in entries:
            if 'contents' in e and 'category' in e and e.get('category') == 'chat':
                client.update_issue(
                    issue_id=remote_incident_id,
                    update_type='Comment',
                    value=e.get('contents')
                )

        if remote_args.delta and remote_args.incident_changed:
            delta = remote_args.delta

            # handle ownership change
            if sync_owners and 'owner' in delta:
                owner_email: Optional[str] = None
                owner_user = delta.get('owner')
                if owner_user:
                    user_info = demisto.findUser(username=owner_user)
                    if user_info and isinstance(user_info, dict) and 'email' in user_info:
                        owner_email = user_info.get('email')
                    if owner_email:  # change the owner in Expanse only if the XSOAR user has a valid email
                        client.update_issue(
                            issue_id=remote_incident_id,
                            update_type='Assignee',
                            value=owner_email
                        )
                else:  # change to unassigned
                    client.update_issue(
                        issue_id=remote_incident_id,
                        update_type='Assignee',
                        value='Unassigned'
                    )

            # handle severity
            if 'severity' in delta and delta.get('severity') in SEVERITY_PRIORITY_MAP:
                client.update_issue(
                    issue_id=remote_incident_id,
                    update_type='Priority',
                    value=SEVERITY_PRIORITY_MAP[delta.get('severity')]
                )

            # handle issue closing
            if remote_args.inc_status == 2:
                close_reason = remote_args.data.get('closeReason', None)
                close_notes = remote_args.data.get('closeNotes', None)
                close_reason_comment: str = f'XSOAR Incident Close Reason: {close_reason}\n' if close_reason else ''
                close_notes_comment: str = f'XSOAR Incident Close Notes: {close_notes}\n' if close_notes else ''
                client.update_issue(
                    issue_id=remote_incident_id,
                    update_type='Comment',
                    value=f'Issue closed in Cortex XSOAR.\n{close_reason_comment}{close_notes_comment}'
                )
                client.update_issue(
                    issue_id=remote_incident_id,
                    update_type='ProgressStatus',
                    value='Resolved'
                )

            # handle Progress Status change
            elif 'expanseprogressstatus' in delta and delta.get('expanseprogressstatus') in ISSUE_PROGRESS_STATUS:
                client.update_issue(
                    issue_id=remote_incident_id,
                    update_type='ProgressStatus',
                    value=delta.get('expanseprogressstatus')
                )

        return remote_incident_id


    def list_businessunits_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        total_results, max_page_size = calculate_limits(args.get('limit'))
        outputs = list(
            islice(client.list_businessunits(limit=max_page_size), total_results)
        )

        return CommandResults(
            outputs_prefix="Expanse.BusinessUnit",
            outputs_key_field="id",
            outputs=outputs if len(outputs) > 0 else None,
            readable_output="## No Business Units found" if len(outputs) == 0 else None
        )


    def list_providers_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        total_results, max_page_size = calculate_limits(args.get('limit'))
        outputs = list(
            islice(client.list_providers(limit=max_page_size), total_results)
        )
        return CommandResults(
            outputs_prefix="Expanse.Provider",
            outputs_key_field="id",
            outputs=outputs if len(outputs) > 0 else None,
            readable_output="## No Providers found" if len(outputs) == 0 else None
        )


    def list_pocs_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        total_results, max_page_size = calculate_limits(args.get('limit'))
        outputs = list(
            islice(client.list_pocs(limit=max_page_size), total_results)
        )
        readable_output = tableToMarkdown(
            name='Expanse Points of Contact',
            t=outputs,
            headers=EXPANSE_POC_READABLE_HEADER_LIST,
            headerTransform=pascalToSpace
        )

        return CommandResults(
            outputs_prefix="Expanse.PointOfContact",
            outputs_key_field="id",
            outputs=outputs if len(outputs) > 0 else None,
            readable_output="## No Point Of Contacts found" if len(outputs) == 0 else readable_output
        )


    def create_poc_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        email: str = args.get('email', '')
        if not email or not re.match(POC_EMAIL_PATTERN, email):
            raise ValueError('Point of Contact email needs to be a valid email')

        first_name: str = args.get('first_name', '')
        if first_name and len(first_name) > 64:
            raise ValueError('Point of Contact first_name needs to be less than 64 characters')

        last_name: str = args.get('last_name', '')
        if last_name and len(last_name) > 64:
            raise ValueError('Point of Contact last_name needs to be less than 64 characters')

        phone: str = args.get('phone', '')
        if phone and not phone.isnumeric():
            raise ValueError('Point of Contact phone needs to be a numeric string')

        role: str = args.get('role', '')
        if role and len(role) > 64:
            raise ValueError('Point of Contact role needs to be less than 64 characters')

        try:
            poc = client.create_poc(email, first_name, last_name, role, phone)
        except DemistoException as e:
            if str(e).startswith('Error in API call [409]'):
                return CommandResults(readable_output='Point of Contact email already exists')
            raise e

        return CommandResults(
            outputs_prefix="Expanse.PointOfContact",
            outputs_key_field="id",
            outputs=poc,
            readable_output=f"New POC created for {email}"
        )


    def list_tags_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        total_results, max_page_size = calculate_limits(args.get('limit'))
        outputs = list(
            islice(client.list_tags(limit=max_page_size), total_results)
        )
        return CommandResults(
            outputs_prefix="Expanse.Tag",
            outputs_key_field="id",
            outputs=outputs if len(outputs) > 0 else None,
            readable_output="## No Tags found" if len(outputs) == 0 else None
        )


    def create_tag_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        name: str = args.get('name', '')
        if not name or len(name) < 1 or len(name) > 127:
            raise ValueError('Tag name must be less than 128 characters long')

        description: str = args.get('description', '')
        if description and len(description) > 511:
            raise ValueError('Tag description must be less than 512 characters long')

        try:
            tag = client.create_tag(name, description)
        except DemistoException as e:
            if str(e).startswith('Error in API call [409]'):
                return CommandResults(readable_output='Tag already exists')
            raise e

        return CommandResults(
            outputs_prefix="Expanse.Tag",
            outputs_key_field="id",
            outputs=tag
        )


    def manage_asset_tags_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        operation_type = args.get('operation_type')
        if operation_type not in ASSET_TAG_OPERATIONS:
            raise ValueError(f'Operation type must be one of {",".join(ASSET_TAG_OPERATIONS)}')

        asset_type = args.get('asset_type')
        if not asset_type or asset_type not in TAGGABLE_ASSET_TYPE_MAP:
            raise ValueError(f'Asset type must be one of {",".join(TAGGABLE_ASSET_TYPE_MAP.keys())}')
        mapped_asset_type = TAGGABLE_ASSET_TYPE_MAP[asset_type]

        asset_id = args.get('asset_id')
        if not asset_id:
            raise ValueError('Asset id must be provided')

        tag_ids = argToList(args.get('tags'))
        tag_names = argToList(args.get('tag_names'))
        if len(tag_names) > 0:
            [tag_ids.append(t['id']) for t in client.list_tags() if t['name'] in tag_names]
        tags: List[str] = list(set(tag_ids))
        if len(tags) < 1:
            raise ValueError('Must provide valid tag IDs or names')

        client.manage_asset_tags(mapped_asset_type, operation_type, asset_id, tags)
        return CommandResults(
            readable_output='Operation complete'
        )


    def manage_asset_pocs_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        operation_type = args.get('operation_type')
        if operation_type not in ASSET_POC_OPERATIONS:
            raise ValueError(f'Operation type must be one of {",".join(ASSET_POC_OPERATIONS)}')

        asset_type = args.get('asset_type')
        if not asset_type or asset_type not in TAGGABLE_ASSET_TYPE_MAP:
            raise ValueError(f'Asset type must be one of {",".join(TAGGABLE_ASSET_TYPE_MAP.keys())}')
        mapped_asset_type = TAGGABLE_ASSET_TYPE_MAP[asset_type]

        asset_id = args.get('asset_id')
        if not asset_id:
            raise ValueError('Asset id must be provided')

        poc_ids = argToList(args.get('pocs'))
        poc_emails = argToList(args.get('poc_emails'))

        if len(poc_emails) > 0:
            for p in client.list_pocs():
                if p.get('email') in poc_emails:
                    poc_ids.append(p['id'])
        pocs: List[str] = list(set(poc_ids))
        if len(pocs) < 1:
            raise ValueError('Must provide valid Point of Contact IDs or emails')

        client.manage_asset_pocs(mapped_asset_type, operation_type, asset_id, pocs)
        return CommandResults(
            readable_output=f'Operation complete ({operation_type} {poc_emails or poc_ids} to {asset_id})'
        )


    def get_iprange_command(client: Client, args: Dict[str, Any]) -> List[CommandResults]:
        include = handle_iprange_include(args.pop('include', None), 'include')
        id_: Optional[str] = args.pop('id', None)

        if id_ is not None and len(args) != 0:
            raise ValueError("You can only use [id] only with [include] parameter")

        total_results, max_page_size = calculate_limits(args.get('limit'))

        outputs: List[Dict[str, Any]]
        if id_ is not None:
            outputs = [client.get_iprange_by_id(id_, include)]
        else:
            params: Dict = {
                "include": include,
                "limit": max_page_size
            }

            business_units = argToList(args.get('business_units'))
            if len(business_units) != 0:
                params['business-units'] = ','.join(business_units)
            business_unit_names = argToList(args.get('business_unit_names'))
            if len(business_unit_names) != 0:
                params['business-unit-names'] = ','.join(business_unit_names)
            inet = args.get('inet')
            if inet is not None:
                params['inet'] = inet
            tags = argToList(args.get('tags'))
            if len(tags) != 0:
                params['tags'] = ','.join(tags)
            tag_names = argToList(args.get('tag_names'))
            if len(tag_names) != 0:
                params['tag-names'] = ','.join(tag_names)

            outputs = list(
                islice(
                    client.get_ipranges(params=params),
                    total_results
                )
            )

        return (format_cidr_data(outputs))


    def get_domain_command(client: Client, args: Dict[str, Any]) -> List[CommandResults]:
        domain: Optional[str] = args.pop('domain', None)
        last_observed_date: Optional[str] = args.pop('last_observed_date', None)

        if domain is not None and len(args) != 0:
            raise ValueError("The only argument allowed with domain is last_observed_date")

        total_results, max_page_size = calculate_limits(args.get('limit'))

        if domain is not None:
            output = client.get_domain_by_domain(domain=domain, last_observed_date=last_observed_date)
            if output and isinstance(output, dict) and 'domain' not in output:
                output['domain'] = domain
            return format_domain_data([output])

        params: Dict[str, Any] = {
            "limit": max_page_size
        }

        domain_search: Optional[str] = args.get('search')
        if domain_search is not None:
            params['domainSearch'] = domain_search

        provider_id = argToList(args.get('providers'))
        if len(provider_id) > 0:
            params['providerId'] = ','.join(provider_id)

        provider_name = argToList(args.get('provider_names'))
        if len(provider_name) > 0:
            params['providerName'] = ','.join(provider_name)

        business_unit_id = argToList(args.get('business_units'))
        if len(business_unit_id) > 0:
            params['businessUnitId'] = ','.join(business_unit_id)

        business_unit_name = argToList(args.get('business_unit_names'))
        if len(business_unit_name) > 0:
            params['businessUnitName'] = ','.join(business_unit_name)

        tag_id = argToList(args.get('tags'))
        if len(tag_id) > 0:
            params['tagId'] = ','.join(tag_id)

        tag_name = argToList(args.get('tag_names'))
        if len(tag_name) > 0:
            params['tagName'] = ','.join(tag_name)

        dns_resolution_status = args.get('has_dns_resolution')
        if dns_resolution_status is not None:
            params['dnsResolutionStatus'] = "HAS_DNS_RESOLUTION" if argToBoolean(
                dns_resolution_status) else "NO_DNS_RESOLUTION"

        service_status = args.get('has_active_service')
        if service_status is not None:
            params['serviceStatus'] = "HAS_ACTIVE_SERVICE" if argToBoolean(service_status) else "NO_ACTIVE_SERVICE"

        has_related_cloud_resources = args.get('has_related_cloud_resources')
        if has_related_cloud_resources is not None:
            params['hasRelatedCloudResources'] = "true" if argToBoolean(has_related_cloud_resources) else "false"

        if last_observed_date is not None:
            params['minLastObservedDate'] = last_observed_date

        domain_data = list(
            islice(
                client.get_domains(params=params),
                total_results
            )
        )
        return format_domain_data(domain_data)


    def get_cloud_resource_command(client: Client, args: Dict[str, Any]) -> List[CommandResults]:
        asset_id: Optional[str] = args.pop('id', None)

        if asset_id is not None:
            output = client.get_cloud_resource(asset_id=asset_id)
            return format_cloud_resource_data([output])

        total_results, max_page_size = calculate_limits(args.get('limit'))

        params: Dict[str, Any] = {
            "limit": max_page_size
        }

        domain_search: Optional[str] = args.get('domain')
        if domain_search is not None:
            params['domainSearch'] = domain_search

        ip_search: Optional[str] = args.get('ip')
        if ip_search is not None:
            params['inetSearch'] = ip_search

        provider_id = argToList(args.get('providers'))
        if len(provider_id) > 0:
            params['providerId'] = ','.join(provider_id)

        provider_name = argToList(args.get('provider_names'))
        if len(provider_name) > 0:
            params['providerName'] = ','.join(provider_name)

        business_unit_id = argToList(args.get('business_units'))
        if len(business_unit_id) > 0:
            params['businessUnitId'] = ','.join(business_unit_id)

        business_unit_name = argToList(args.get('business_unit_names'))
        if len(business_unit_name) > 0:
            params['businessUnitName'] = ','.join(business_unit_name)

        tag_id = argToList(args.get('tags'))
        if len(tag_id) > 0:
            params['tagId'] = ','.join(tag_id)

        tag_name = argToList(args.get('tag_names'))
        if len(tag_name) > 0:
            params['tagName'] = ','.join(tag_name)

        type_search = argToList(args.get('types'))
        if len(type_search) > 0:
            params['type'] = ','.join(type_search)

        region_search = argToList(args.get('regions'))
        if len(region_search) > 0:
            params['region'] = ','.join(region_search)

        last_observed_date: Optional[str] = args.pop('last_observed_date', None)
        if last_observed_date is not None:
            params['minLastObservedDate'] = last_observed_date

        cloud_resource_data = list(
            islice(
                client.get_cloud_resources(params=params),
                total_results
            )
        )
        return format_cloud_resource_data(cloud_resource_data)


    def get_certificate_command(client: Client, args: Dict[str, Any]) -> List[CommandResults]:
        md5_hash: Optional[str] = args.pop('md5_hash', None)
        last_observed_date: Optional[str] = args.pop('last_observed_date', None)

        if md5_hash is not None and len(args) != 0:
            raise ValueError("The only argument allowed with md5_hash is last_observed_date")

        total_results, max_page_size = calculate_limits(args.get('limit'))

        if md5_hash is not None:
            # we try to convert it as hex, and if we fail we trust it's a base64 encoded
            # MD5 hash
            try:
                if len(ba_hash := bytearray.fromhex(md5_hash)) == 16:
                    md5_hash = base64.urlsafe_b64encode(ba_hash).decode('ascii')
            except ValueError:
                pass

            output = client.get_certificate_by_md5_hash(
                md5_hash=md5_hash,
                last_observed_date=last_observed_date
            )
            return format_certificate_data(certificates=[output])

        params: Dict[str, Any] = {
            "limit": max_page_size
        }
        cn_search: Optional[str] = args.get('search')
        if cn_search is not None:
            params['commonNameSearch'] = cn_search

        provider_id = argToList(args.get('providers'))
        if len(provider_id) > 0:
            params['providerId'] = ','.join(provider_id)

        provider_name = argToList(args.get('provider_names'))
        if len(provider_name) > 0:
            params['providerName'] = ','.join(provider_name)

        business_unit_id = argToList(args.get('business_units'))
        if len(business_unit_id) > 0:
            params['businessUnitId'] = ','.join(business_unit_id)

        business_unit_name = argToList(args.get('business_unit_names'))
        if len(business_unit_name) > 0:
            params['businessUnitName'] = ','.join(business_unit_name)

        tag_id = argToList(args.get('tags'))
        if len(tag_id) > 0:
            params['tagId'] = ','.join(tag_id)

        tag_name = argToList(args.get('tag_names'))
        if len(tag_name) > 0:
            params['tagName'] = ','.join(tag_name)

        certificate_advertisement_status = args.get('has_certificate_advertisement')
        if certificate_advertisement_status is not None:
            if argToBoolean(certificate_advertisement_status):
                params['certificateAdvertisementStatus'] = "HAS_CERTIFICATE_ADVERTISEMENT"
            else:
                params['certificateAdvertisementStatus'] = "NO_CERTIFICATE_ADVERTISEMENT"

        service_status = args.get('has_active_service')
        if service_status is not None:
            params['serviceStatus'] = "HAS_ACTIVE_SERVICE" if argToBoolean(service_status) else "NO_ACTIVE_SERVICE"

        has_related_cloud_resources = args.get('has_related_cloud_resources')
        if has_related_cloud_resources is not None:
            params['hasRelatedCloudResources'] = "true" if argToBoolean(has_related_cloud_resources) else "false"

        if last_observed_date is not None:
            params['minLastObservedDate'] = last_observed_date

        cert_data = list(
            islice(
                client.get_certificates(params=params),
                total_results
            )
        )

        return format_certificate_data(certificates=cert_data)


    def get_associated_domains_command(client: Client, args: Dict[str, Any]) -> List[CommandResults]:
        cn_search = args.get('common_name')
        ip_search = args.get('ip')
        command_results = []
        if ip_search is not None and cn_search is not None:
            raise ValueError("only one of common_name and ip arguments should be specified")

        if cn_search is None and ip_search is None:
            raise ValueError("one of common_name or ip arguments should be specified")

        max_certificates, certificates_max_page_size = calculate_limits(args.get('limit'))
        max_domains, domains_max_page_size = calculate_limits(args.get('domains_limit'))
        ips_base_params: Dict[str, Any] = {
            "limit": domains_max_page_size
        }

        certificates_search_params = {
            "commonNameSearch": cn_search,
            "limit": certificates_max_page_size
        }

        matching_domains: Dict[str, Dict[str, Any]] = {}
        ips_to_query: Dict[str, Set[str]] = defaultdict(set)

        if ip_search is not None:
            ips_to_query[ip_search].clear()  # create an empty set

        if cn_search is not None:
            certificates = islice(client.get_certificates(certificates_search_params), max_certificates)
            for certificate in certificates:
                md5_hash = certificate.get('certificate', {}).get('md5Hash')
                if md5_hash is None:
                    continue

                certificate_details = client.get_certificate_by_md5_hash(md5_hash=md5_hash)
                if certificate_details is None:
                    continue

                for recent_ip in certificate_details.get('details', {}).get('recentIps', []):
                    ip_address = recent_ip.get('ip')
                    if ip_address is None:
                        continue

                    ips_to_query[ip_address].add(md5_hash)

        for ip2q in ips_to_query.keys():
            ips_search_params: Dict[str, Any] = {
                'inetSearch': ip2q,
                'assetType': 'DOMAIN'
            }
            ips_search_params.update(ips_base_params)

            for ipdomain in islice(client.get_ips(ips_search_params), max_domains):
                if (domain := ipdomain.get('domain')) is None:
                    continue

                if domain not in matching_domains:
                    matching_domains[domain] = {
                        'name': domain,
                        'IP': [],
                        'certificate': []
                    }

                matching_domains[domain]['IP'].append(ip2q)
                matching_domains[domain]['certificate'].extend(list(ips_to_query[ip2q]))

        readable_output = tableToMarkdown(
            f"Expanse Domains matching Certificate Common Name: {cn_search}",
            list(matching_domains.values()) if len(matching_domains) > 0 else "## No Domains found",
            headers=['name', 'IP', 'certificate']
        )
        for d in matching_domains.keys():
            indicator = Common.Domain(d, Common.DBotScore(d, DBotScoreType.DOMAIN, "ExpanseV2", Common.DBotScore.NONE))
            command_results.append(CommandResults(
                readable_output=tableToMarkdown("New Domain indicator was found.", indicator.to_context()),
                indicator=indicator
            ))
        command_results.append(CommandResults(
            readable_output=readable_output,
            outputs_prefix='Expanse.AssociatedDomain',
            outputs_key_field='name',
            outputs=list(
                matching_domains.values()) if len(matching_domains) > 0 else None, ))
        return command_results


    def certificate_command(client: Client, args: Dict[str, Any]) -> List[CommandResults]:
        hashes = argToList(args.get('certificate'))
        if len(hashes) == 0:
            raise ValueError('certificate hash(es) not specified')

        set_expanse_fields = argToBoolean(args.get('set_expanse_fields', 'true'))

        if len(hashes) > MAX_RESULTS:
            hashes = hashes[:MAX_RESULTS]

        certificate_data: List[Dict[str, Any]] = []

        for curr_hash in hashes:
            # we try to convert it as hex, and if we fail we trust it's a base64 encoded
            try:
                ba_hash = bytearray.fromhex(curr_hash)
                if len(ba_hash) == 16:
                    # MD5 hash
                    curr_hash = base64.urlsafe_b64encode(ba_hash).decode('ascii')
                else:  # maybe a different hash? let's look for an indicator with a corresponding hash
                    result_hash = find_indicator_md5_by_hash(ba_hash.hex())
                    if result_hash is None:
                        continue

                    curr_hash = base64.urlsafe_b64encode(bytearray.fromhex(result_hash)).decode('ascii')

            except ValueError:
                pass

            c = client.get_certificate_by_md5_hash(md5_hash=curr_hash)
            if not c or not isinstance(c, dict):
                continue

            certificate_data.append(c)

        result = format_certificate_data(certificate_data)

        # XXX - this is a workaround to the lack of the possibility of extending mapper
        # of standard Indicator Types. We need to call createIndicator to set custom fields
        if not set_expanse_fields or (result and result[0].outputs is None):
            return result

        indicators: List[Dict[str, Any]] = []
        result_outputs = cast(List[Dict[str, Any]], result[0].outputs)  # we keep mypy happy
        for certificate in result_outputs:
            ec_sha256 = certificate.get('certificate', {}).get('pemSha256')
            if ec_sha256 is None:
                continue
            indicator_value = base64.urlsafe_b64decode(ec_sha256).hex()

            if find_indicator_md5_by_hash(indicator_value) is None:
                demisto.debug(f'Update: Indicator {indicator_value} not found')
                continue

            annotations = certificate.get('annotations', {})
            tags = []
            if 'tags' in annotations:
                tags = [tag['name'] for tag in annotations['tags']]

            provider_name: Optional[str] = None
            providers = certificate.get('providers')
            if isinstance(providers, list) and len(providers) > 0:
                provider_name = providers[0].get('name')

            tenant_name: Optional[str] = None
            tenant = certificate.get('tenant')
            if tenant is not None:
                tenant_name = tenant.get('name')

            business_unit_names: List[str] = []
            business_units = certificate.get("businessUnits", [])
            for bu in business_units:
                if 'name' not in bu:
                    continue
                business_unit_names.append(bu['name'])

            indicator: Dict[str, Any] = {
                'type': 'Certificate',
                'value': indicator_value,
                'score': Common.DBotScore.NONE,
                'source': 'ExpanseV2',
                'fields': {
                    'expansedateadded': certificate.get('dateAdded'),
                    'expansefirstobserved': certificate.get('firstObserved'),
                    'firstseenbysource': certificate.get('firstObserved'),
                    'expanselastobserved': certificate.get('lastObserved'),
                    'lastseenbysource': certificate.get('lastObserved'),
                    'expansecertificateadvertisementstatus': certificate.get('certificateAdvertisementStatus'),
                    'expansetags': tags,
                    'expanseproperties': '\n'.join(certificate.get('properties', [])),
                    'expanseservicestatus': certificate.get('serviceStatus'),
                    'expanseprovidername': provider_name,
                    'expansetenantname': tenant_name,
                    'expansebusinessunits': business_unit_names
                }
            }
            indicators.append(indicator)

        demisto.createIndicators(indicators)

        return result


    def domain_command(client: Client, args: Dict[str, Any]) -> List[CommandResults]:
        # XXX - implement feed related indicators using recentIPs
        domains = argToList(args.get('domain'))
        if len(domains) == 0:
            raise ValueError('domain(s) not specified')

        # trim down the list to the max number of supported results
        if len(domains) > MAX_RESULTS:
            domains = domains[:MAX_RESULTS]

        domain_data: List[Dict[str, Any]] = []

        for domain in domains:
            d = client.get_domain_by_domain(domain=domain)
            if not d or not isinstance(d, dict):
                continue
            if 'domain' not in d:
                d['domain'] = domain
            domain_data.append(d)

        return format_domain_data(domain_data)


    def ip_command(client: Client, args: Dict[str, Any]) -> List[CommandResults]:
        ips = argToList(args.get('ip'))
        if len(ips) == 0:
            raise ValueError('ip(s) not specified')

        # trim down the list to the max number of supported results
        if len(ips) > MAX_RESULTS:
            ips = ips[:MAX_RESULTS]

        ip_data_list: List[Dict[str, Any]] = []
        command_results = []
        for ip in ips:
            ip_data = next(client.get_ips(params={'inetSearch': f"{ip}", "limit": 1}), None)
            if ip_data is None:
                # If we don't get anything back from the ips endpoint, we can return
                # details from IP Ranges
                ip_data = next(client.get_ipranges(params={'inet': f"{ip}", "limit": 1}), None)
                if ip_data is None:
                    continue

            ip_data['ip'] = ip

            ip_standard_context = Common.IP(
                ip=ip,
                dbot_score=Common.DBotScore(
                    indicator=ip,
                    indicator_type=DBotScoreType.IP,
                    integration_name="ExpanseV2",
                    score=Common.DBotScore.NONE,
                    reliability=demisto.params().get('integrationReliability')
                ),
                hostname=ip_data.get('domain', None)
            )
            command_results.append(CommandResults(
                readable_output=tableToMarkdown("New IP indicator was found", {"IP": ip, "Domain": ip_data.get('domain')}),
                indicator=ip_standard_context
            ))
            ip_context_excluded_fields: List[str] = []
            ip_data_list.append({
                k: ip_data[k]
                for k in ip_data if k not in ip_context_excluded_fields
            })

        readable_output = tableToMarkdown(
            'Expanse IP List', ip_data_list) if len(ip_data_list) > 0 else "## No IPs found"
        command_results.append(CommandResults(
            readable_output=readable_output,
            outputs_prefix='Expanse.IP',
            outputs_key_field=['ip', 'type', 'assetKey', 'assetType'],
            outputs=ip_data_list if len(ip_data_list) > 0 else None,
        ))
        return command_results


    def cidr_command(client: Client, args: Dict[str, Any]) -> List[CommandResults]:
        cidrs = argToList(args.get('cidr'))
        if len(cidrs) == 0:
            raise ValueError('cidr(s) not specified')

        # trim down the list to the max number of supported results
        if len(cidrs) > MAX_RESULTS:
            cidrs = cidrs[:MAX_RESULTS]

        include = handle_iprange_include(args.get('include'), 'include')

        cidr_data: List[Dict[str, Any]] = []

        for cidr in cidrs:
            c = next(client.get_ipranges(params={'inet': cidr, 'include': include, 'limit': 1}), None)

            if not c or not isinstance(c, dict):
                continue
            cidr_data.append(c)

        return format_cidr_data(cidr_data)


    def list_risk_rules_command(client: Client, args: Dict[str, Any]):
        raise DeprecatedCommandException


    def get_risky_flows_command(client: Client, args: Dict[str, Any]):
        raise DeprecatedCommandException


    def domains_for_certificate_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """
        Returns all domains that have resolved to IP addresses a certificate has been seen on. There is no direct way to
        correlate between certificates and domains in Expanse this does so indirectly.
        """
        search = args.get('common_name')
        params = {
            "commonNameSearch": search
        }

        matching_domains = []  # type:ignore

        certificates_iterator = client.get_certificates(params=params)
        certificates = [certificate for certificate in certificates_iterator]

        for certificate in certificates:
            certificate_details = client.get_certificate_by_md5_hash(
                md5_hash=certificate.get('certificate', {}).get('md5Hash'))

            for ip in certificate_details.get('details', {}).get('recentIps', []):
                params = {
                    'inetSearch': ip.get('ip'),
                    'assetType': 'DOMAIN'
                }
                matching_domains += client.get_ips(params=params)

        if len(matching_domains) == 0:
            return CommandResults(readable_output="No data found")

        context = get_expanse_certificate_to_domain_context(common_name=search, data=matching_domains)

        context_copy = context.copy()
        del context_copy['DomainList']  # Remove full objects from human readable response
        human_readable = tableToMarkdown("Expanse Domains matching Certificate Common Name: {search}".format(search=search),
                                         context_copy)

        return CommandResults(
            outputs_prefix="Expanse.IPDomains",
            readable_output=human_readable,
            raw_response=matching_domains,
            outputs_key_field="SearchTerm",
            outputs=context,
        )


    def get_expanse_certificate_to_domain_context(common_name, data):
        """
        Provides custom context information for domains looked up via certificate.

        :param common_name: The original search parameter
        :param data: The data returned from the API query
        :return: A dict of aggregated domain details
        """
        return {
            "SearchTerm": common_name,
            "TotalDomainCount": len(data),
            "FlatDomainList": [domain.get('domain') for domain in data],
            "DomainList": data
        }


    """ MAIN FUNCTION """


    def main() -> None:
        """main function, parses params and runs command functions
        """

        params = demisto.params()
        args = demisto.args()
        command = demisto.command()
        api_key = params.get('credentials', {}).get('password', '') or params.get("apikey", '')
        base_url = urljoin(params.get("url", "").rstrip("/"), "/api")
        verify_certificate = not params.get("insecure", False)
        proxy = params.get("proxy", False)

        try:
            client = Client(
                api_key=api_key, base_url=base_url, verify=verify_certificate, proxy=proxy
            )

            client.authenticate()

            if command == "test-module":
                result = test_module(client)
                return_results(result)

            elif command == 'fetch-incidents':
                max_incidents = check_int(arg=params.get('max_fetch'), arg_name='max_fetch',
                                          min_val=None, max_val=None, required=False)
                if not max_incidents or max_incidents > MAX_INCIDENTS:
                    max_incidents = MAX_INCIDENTS

                ff = params.get('first_fetch', DEFAULT_FIRST_FETCH)
                if not ff:
                    raise ValueError('firstFetch not specified')
                first_fetch = datestring_to_timestamp_us(ff)

                priority = params.get('priority')
                activity_status = params.get('activity_status')
                progress_status = params.get('progress_status')
                business_units = argToList(params.get('business_unit'))
                issue_types = argToList(params.get('issue_type'))
                tags = argToList(params.get('tag'))
                cloud_management_status = params.get('cloud_management_status')

                sync_tags = argToList(params.get('sync_tags'))

                fetch_details: bool = True  # forced to True to retrieve the proper asset IDs

                mirror_direction = MIRROR_DIRECTION.get(params.get('mirror_direction', 'None'))
                next_run, incidents = fetch_incidents(
                    client=client,
                    max_incidents=max_incidents,
                    last_run=demisto.getLastRun(),
                    first_fetch=first_fetch,
                    priority=priority,
                    activity_status=activity_status,
                    progress_status=progress_status,
                    business_units=business_units,
                    tags=tags,
                    cloud_management_status=cloud_management_status,
                    issue_types=issue_types,
                    mirror_direction=mirror_direction,
                    sync_tags=sync_tags,
                    fetch_details=fetch_details
                )

                demisto.setLastRun(next_run)
                demisto.incidents(incidents)

            #  To be compatible with 6.1
            elif command == "get-modified-remote-data":
                return_results(get_modified_remote_data_command(client, args))

            elif command == "get-remote-data":
                sync_owners = argToBoolean(params.get('sync_owners'))
                # XXX: mirror_details forced to be disabled to reduce API calls in the backend.
                # Will be reviewed in next versions to use XSOAR 6.1 mirroring enhancements.
                mirror_details = False
                # mirror_details = argToBoolean(params.get('mirror_details'))
                incoming_tags = argToList(params.get('incoming_tags'))
                return_results(get_remote_data_command(client, args, sync_owners, incoming_tags, mirror_details))

            elif command == "update-remote-system":
                sync_owners = argToBoolean(params.get('sync_owners'))
                return_results(update_remote_system_command(client, args, sync_owners))

            elif command == "expanse-get-issues":
                return_results(get_issues_command(client, args))

            elif command == "expanse-get-issue":
                return_results(get_issue_command(client, args))

            elif command == "expanse-get-issue-updates":
                return_results(get_issue_updates_command(client, args))

            elif command == "expanse-update-issue":
                return_results(update_issue_command(client, args))

            elif command == "expanse-get-issue-comments":
                return_results(get_issue_comments_command(client, args))

            elif command == "expanse-list-businessunits":
                return_results(list_businessunits_command(client, args))

            elif command == "expanse-list-providers":
                return_results(list_providers_command(client, args))

            elif command == "expanse-list-tags":
                return_results(list_tags_command(client, args))

            elif command == "expanse-get-iprange":
                return_results(get_iprange_command(client, args))

            elif command == "expanse-create-tag":
                return_results(create_tag_command(client, args))

            elif command == "expanse-assign-tags-to-asset":
                args['operation_type'] = 'ASSIGN'
                return_results(manage_asset_tags_command(client, args))

            elif command == "expanse-unassign-tags-from-asset":
                args['operation_type'] = 'UNASSIGN'
                return_results(manage_asset_tags_command(client, args))

            elif command == "expanse-assign-tags-to-iprange":
                args['operation_type'] = 'ASSIGN'
                args['asset_type'] = 'IpRange'
                return_results(manage_asset_tags_command(client, args))

            elif command == "expanse-unassign-tags-from-iprange":
                args['operation_type'] = 'UNASSIGN'
                args['asset_type'] = 'IpRange'
                return_results(manage_asset_tags_command(client, args))

            elif command == "expanse-assign-tags-to-certificate":
                args['operation_type'] = 'ASSIGN'
                args['asset_type'] = 'Certificate'
                return_results(manage_asset_tags_command(client, args))

            elif command == "expanse-unassign-tags-from-certificate":
                args['operation_type'] = 'UNASSIGN'
                args['asset_type'] = 'Certificate'
                return_results(manage_asset_tags_command(client, args))

            elif command == "expanse-assign-tags-to-domain":
                args['operation_type'] = 'ASSIGN'
                args['asset_type'] = 'Domain'
                return_results(manage_asset_tags_command(client, args))

            elif command == "expanse-unassign-tags-from-domain":
                args['operation_type'] = 'UNASSIGN'
                args['asset_type'] = 'Domain'
                return_results(manage_asset_tags_command(client, args))

            elif command == "expanse-get-domain":
                return_results(get_domain_command(client, args))

            elif command == "expanse-get-certificate":
                return_results(get_certificate_command(client, args))

            elif command == "expanse-get-associated-domains":
                return_results(get_associated_domains_command(client, args))

            elif command == "certificate":
                return_results(certificate_command(client, args))

            elif command == "domain":
                return_results(domain_command(client, args))

            elif command == "ip":
                return_results(ip_command(client, args))

            elif command == "cidr":
                return_results(cidr_command(client, args))

            elif command == "expanse-get-cloud-resources":
                return_results(get_cloud_resource_command(client, args))

            elif command == "expanse-get-cloud-resource":
                return_results(get_cloud_resource_command(client, args))

            elif command == "expanse-get-risky-flows":
                get_risky_flows_command(client, args)  # deprecated

            elif command == "expanse-list-risk-rules":
                list_risk_rules_command(client, args)  # deprecated

            elif command == "expanse-get-services":
                return_results(get_services_command(client, args))

            elif command == "expanse-get-service":
                return_results(get_service_command(client, args))

            elif command == "expanse-list-pocs":
                return_results(list_pocs_command(client, args))

            elif command == "expanse-create-poc":
                return_results(create_poc_command(client, args))

            elif command == "expanse-assign-pocs-to-asset":
                args['operation_type'] = 'ASSIGN'
                return_results(manage_asset_pocs_command(client, args))

            elif command == "expanse-unassign-pocs-from-asset":
                args['operation_type'] = 'UNASSIGN'
                return_results(manage_asset_pocs_command(client, args))

            elif command == "expanse-assign-pocs-to-iprange":
                args['operation_type'] = 'ASSIGN'
                args['asset_type'] = 'IpRange'
                return_results(manage_asset_pocs_command(client, args))

            elif command == "expanse-unassign-pocs-from-iprange":
                args['operation_type'] = 'UNASSIGN'
                args['asset_type'] = 'IpRange'
                return_results(manage_asset_pocs_command(client, args))

            elif command == "expanse-assign-pocs-to-certificate":
                args['operation_type'] = 'ASSIGN'
                args['asset_type'] = 'Certificate'
                return_results(manage_asset_pocs_command(client, args))

            elif command == "expanse-unassign-pocs-from-certificate":
                args['operation_type'] = 'UNASSIGN'
                args['asset_type'] = 'Certificate'
                return_results(manage_asset_pocs_command(client, args))

            elif command == "expanse-assign-pocs-to-domain":
                args['operation_type'] = 'ASSIGN'
                args['asset_type'] = 'Domain'
                return_results(manage_asset_pocs_command(client, args))

            elif command == "expanse-unassign-pocs-from-domain":
                args['operation_type'] = 'UNASSIGN'
                args['asset_type'] = 'Domain'
                return_results(manage_asset_pocs_command(client, args))

            elif command == 'expanse-get-domains-for-certificate':
                return_results(domains_for_certificate_command(client, args))

            else:
                raise NotImplementedError(f'Command {command} is not implemented.')

        # Log exceptions and return errors
        except Exception as e:
            #  To be compatible with 6.1
            if 'not implemented' in str(e):
                raise e
            return_error(
                f"Failed to execute {command} command.\nError:\n{str(e)}"
            )


    """ ENTRY POINT """

    if __name__ in ("__main__", "__builtin__", "builtins"):
        main()

    register_module_line('ExpanseV2', 'end', __line__())
  subtype: python3
  type: python
system: true
