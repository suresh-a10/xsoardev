contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: ec4bd04b-2e85-4833-804b-be102bed96c3
inputs:
- description: ""
  key: ""
  playbookInputQuery:
    daterange:
      fromdate: "0001-01-01T00:00:00Z"
      fromdatelicenseval: "0001-01-01T00:00:00Z"
      period:
        by: ""
        byfrom: ""
        byto: ""
        field: ""
        fromvalue: null
        tovalue: null
      todate: "0001-01-01T00:00:00Z"
    query: ""
    queryEntity: indicators
    results: null
    runFromLastJobTime: true
  required: false
  value: {}
name: Fireye IOC Enrichment Playbook v 1.0
outputs: []
sourceplaybookid: 08c3b260-77a7-4316-8c5d-802cc55f4e22
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e0025571-4e25-4193-8efb-6d64bc2ad07d
      iscommand: false
      name: ""
      version: -1
    taskid: e0025571-4e25-4193-8efb-6d64bc2ad07d
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 410,
          "y": 380
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 800de4bb-900b-4974-8dca-17a0dfaee55b
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 800de4bb-900b-4974-8dca-17a0dfaee55b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 400,
          "y": 1960
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.IP
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether the playbook's input contains at least one IP
        address.
      id: 57805aaf-3a97-4610-86ef-bc248693287f
      iscommand: false
      name: Are there any IP addresses ?
      type: condition
      version: -1
    taskid: 57805aaf-3a97-4610-86ef-bc248693287f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -60,
          "y": 705
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: AbuseIPDB
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is an active instance of the ThreatCrowd integration
        enabled.
      id: b49ce58f-76f8-4a0f-8541-3debd5f468e4
      iscommand: false
      name: Is AbuseIPDB enabled?
      type: condition
      version: -1
    taskid: b49ce58f-76f8-4a0f-8541-3debd5f468e4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1550,
          "y": 365
        }
      }
  "13":
    continueonerror: true
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IP
          root: ExtractedIndicators
    separatecontext: false
    skipunavailable: false
    task:
      brand: FireEye iSIGHT
      description: basic search reports by ip
      id: 01629caf-c2ec-4526-8b91-337763f592fd
      iscommand: true
      name: Get IP Report From Fireeye
      script: FireEye iSIGHT|||ip
      type: regular
      version: -1
    taskid: 01629caf-c2ec-4526-8b91-337763f592fd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -60,
          "y": 925
        }
      }
  "14":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: FireEye iSIGHT
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      iscontext: true
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is an active instance of the ThreatCrowd integration
        enabled.
      id: ebd2f2aa-f019-432c-81c2-a2e4fc058a26
      iscommand: false
      name: Is Fireeye ISight enabled?
      type: condition
      version: -1
    taskid: ebd2f2aa-f019-432c-81c2-a2e4fc058a26
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1550,
          "y": 540
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: 00c3001c-06d8-43ac-8020-316d3ae6f136
      iscommand: false
      name: Generate Investigation Summary Report
      type: title
      version: -1
    taskid: 00c3001c-06d8-43ac-8020-316d3ae6f136
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1500
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name:
        simple: IOC Threat Intel
      type:
        simple: pdf
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: 80c8a2ee-d626-4250-85a6-324a1c528997
      iscommand: false
      name: Generate Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: 80c8a2ee-d626-4250-85a6-324a1c528997
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 660,
          "y": 1695
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      reportID:
        simple: ${Report.ID}
      using:
        simple: FireEye iSIGHT_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: FireEye iSIGHT
      description: Get specific report
      id: a59d02ea-2049-42f1-812d-a73ff4028259
      iscommand: true
      name: Fetch the Report using Report ID
      script: FireEye iSIGHT|||isight-get-report
      type: regular
      version: -1
    taskid: a59d02ea-2049-42f1-812d-a73ff4028259
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 1250
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: inList
          right:
            value:
              simple: ${lists.AuthorizedSenders}
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: InternalIS.LogForensics@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: InternalIS.SecurityLogReview@tcs.com
        - left:
            iscontext: true
            value:
              simple: ${incident.emailfrom}
          operator: isEqualString
          right:
            value:
              simple: internalis.cybersecurityops@tcs.com
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: deac776e-83a5-4031-83cc-4361374ec979
      iscommand: false
      name: check if sender is present in  list of authorize senders.
      type: condition
      version: -1
    taskid: deac776e-83a5-4031-83cc-4361374ec979
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1550,
          "y": 220
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
      - "24"
      - "27"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: txt
          root: File
      using:
        simple: InnerServicesModule
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 5ae7253b-961b-4c22-84ed-93ff2c361c53
      iscommand: true
      name: Extract Indicator From File
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 5ae7253b-961b-4c22-84ed-93ff2c361c53
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 520
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain_Test_
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.Domain_Test_
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether the playbook's input contains at least one IP
        address.
      id: 803dabac-620c-45ef-81ff-4f84cc559467
      iscommand: false
      name: Are there any IP Domains ?
      type: condition
      version: -1
    taskid: 803dabac-620c-45ef-81ff-4f84cc559467
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 410,
          "y": 705
        }
      }
  "25":
    continueonerror: true
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: ${ExtractedIndicators.Domain_Test_}
    separatecontext: false
    skipunavailable: false
    task:
      brand: FireEye iSIGHT
      description: basic search reports by domain
      id: a1d926d9-729d-435d-88f3-88e0a5a09c79
      iscommand: true
      name: Get Domain Report From Fireeye
      script: FireEye iSIGHT|||domain
      type: regular
      version: -1
    taskid: a1d926d9-729d-435d-88f3-88e0a5a09c79
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 925
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      csvArray:
        simple: ${Report}
      fileName:
        simple: FireeyeRiskscoreReport.csv
      headers:
        simple: audience,tagSection,files
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Export given array to csv file
      id: c17040c0-35d6-43a9-82c2-1824a579ab1c
      iscommand: false
      name: Generate CSV Report
      script: ExportToCSV
      type: regular
      version: -1
    taskid: c17040c0-35d6-43a9-82c2-1824a579ab1c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 135,
          "y": 1695
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.File
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: ExtractedIndicators.File
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether the playbook's input contains at least one IP
        address.
      id: 77d0b39a-5e5d-4261-887a-8a9d4aa2eb1c
      iscommand: false
      name: Are there any Hash ?
      type: condition
      version: -1
    taskid: 77d0b39a-5e5d-4261-887a-8a9d4aa2eb1c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 870,
          "y": 705
        }
      }
  "28":
    continueonerror: true
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        simple: ${ExtractedIndicators.File}
    separatecontext: false
    skipunavailable: false
    task:
      brand: FireEye iSIGHT
      description: basic search file report by md5/sha1. NOTE - specify only one of
        md5/sha1 arguments
      id: 965ea615-559f-4f6e-86a8-ed2eb870687f
      iscommand: true
      name: Get Hash Report From Fireeye
      script: FireEye iSIGHT|||file
      type: regular
      version: -1
    taskid: 965ea615-559f-4f6e-86a8-ed2eb870687f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 870,
          "y": 925
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1805,
        "width": 1990,
        "x": -60,
        "y": 220
      }
    }
  }
