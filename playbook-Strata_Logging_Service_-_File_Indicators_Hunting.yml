contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.5.0
    itemVersion: 1.4.10
    packID: CortexDataLake
    packName: Strata Logging Service by Palo Alto Networks
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: |-
  This playbook queries Strata Logging Service (SLS) for file indicators, including SHA256 hashes, file names, and file types.

  Note that multiple search values should be separated by commas only (without spaces or any special characters).
id: Cortex Data Lake - File Indicators Hunting
inputs:
- description: |-
    A single or multiple SHA256 file hashes to search for within Strata Logging Service .

    Separate multiple search values by commas only (without spaces or any special characters).
  key: SHA256
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    A single or multiple file names to search for within Strata Logging Service .

    Separate multiple search values by commas only (without spaces or any special characters).
  key: Filename
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    A single or multiple file types to search for within Strata Logging Service.

    Separate multiple search values by commas only (without spaces or any special characters).
  key: FileType
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    An alternative to the 'start_time' and 'end_time' inputs that indicates the timeframe for the search, e.g. 1 week, 1 day, 30 minutes.

    When the time_range input is specified, the 'start_time' and 'end_time' inputs should not be used.
  key: time_range
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    Specify the query start time at which to perform a search within Strata Logging Service.

    For example, start_time="2018-04-26 00:00:00"
  key: start_time
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    Specify the query end time at which to perform a search within Strata Logging Service.

    For example, end_time="2018-04-26 00:00:00"
  key: end_time
  playbookInputQuery: null
  required: false
  value: {}
- description: "The maximum number of logs to return. \nDefault is 10."
  key: limit
  playbookInputQuery: null
  required: false
  value: {}
- description: "Select the fields you wish to be included in the query results. \nSelection
    can be \"all\" (same as *) or a comma-separated list of specific fields in the
    table.\n\nSeparate multiple search values by commas only (without spaces or any
    special characters)."
  key: fields
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    Filter network traffic logs that should be retrieved from Strata Logging Service based on firewall action.

    Separate multiple search values by commas only (without spaces or any special characters).
  key: FirewallAction
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    Filter network traffic logs to be retrieved from Strata Logging Service based on security policy rule names that the network traffic matches.

    Separate multiple search values by commas only (without spaces or any special characters).
  key: rule_matched
  playbookInputQuery: null
  required: false
  value: {}
name: Strata Logging Service - File Indicators Hunting
outputs:
- contextPath: CDL.HuntingResults
  description: Event log objects and fields that were retrieved from Strata Logging
    Service (SLS).
  type: string
- contextPath: CDL.HuntingResults.TimeGenerated
  description: Time when the log was generated on the firewall's data plane.
  type: number
- contextPath: CDL.HuntingResults.LogTime
  description: Time the log was received in Strata Logging Service.
  type: number
- contextPath: CDL.HuntingResults.IngestionTime
  description: Ingestion time of the log.
  type: number
- contextPath: CDL.HuntingResults.App
  description: Application associated with the network traffic.
  type: string
- contextPath: CDL.HuntingResults.AppCategory
  description: Identifies the high-level family of the application.
  type: string
- contextPath: CDL.HuntingResults.RiskOfApp
  description: Indicates how risky the application is from a network security perspective.
  type: string
- contextPath: CDL.HuntingResults.CharacteristicOfApp
  description: Identifies the behavioral characteristic of the application associated
    with the network traffic.
  type: string
- contextPath: CDL.HuntingResults.SanctionedStateOfApp
  description: Indicates whether the application has been flagged as sanctioned by
    the firewall administrator.
  type: string
- contextPath: CDL.HuntingResults.SessionID
  description: Identifies the firewall's internal identifier for a specific network
    session.
  type: string
- contextPath: CDL.HuntingResults.Action
  description: Identifies the action that the firewall took for the network traffic.
  type: string
- contextPath: CDL.HuntingResults.Protocol
  description: IP protocol associated with the session.
  type: string
- contextPath: CDL.HuntingResults.SourcePort
  description: Source port utilized by the session.
  type: number
- contextPath: CDL.HuntingResults.DestinationPort
  description: Network traffic's destination port. If this value is 0, then the app
    is using its standard port.
  type: number
- contextPath: CDL.HuntingResults.DestinationIP
  description: Original destination IP address.
  type: string
- contextPath: CDL.HuntingResults.SourceIP
  description: Original source IP address.
  type: string
- contextPath: CDL.HuntingResults.Users
  description: Source/Destination user. If neither is available, source_ip is used.
  type: string
- contextPath: CDL.HuntingResults.IsPhishing
  description: Indicates whether enterprise credentials were submitted by an end user.
  type: string
- contextPath: CDL.HuntingResults.SourceLocation
  description: Source country or internal region for private addresses.
  type: string
- contextPath: CDL.HuntingResults.DestinationLocation
  description: Destination country or internal region for private addresses.
  type: string
- contextPath: CDL.HuntingResults.RuleMatched
  description: Unique identifier for the security policy rule that the network traffic
    matched.
  type: string
- contextPath: CDL.HuntingResults.ThreatCategory
  description: Threat category of the detected threat.
  type: string
- contextPath: CDL.HuntingResults.LogSourceName
  description: Name of the source of the log.
  type: string
- contextPath: CDL.HuntingResults.Direction
  description: Indicates the direction of the attack.
  type: string
- contextPath: CDL.HuntingResults.FileName
  description: The name of the file that is blocked.
  type: string
- contextPath: CDL.HuntingResults.FileSHA256
  description: The binary hash (SHA256) of the file.
  type: string
- contextPath: CDL.HuntingResults.IsURLDenied
  description: Indicates whether the session was denied due to a URL filtering rule.
  type: string
- contextPath: CDL.HuntingResults.URLDomain
  description: The name of the internet domain that was visited in this session.
  type: string
- contextPath: CDL.HuntingResults.URLCategory
  description: The URL category.
  type: string
- contextPath: CDL.HuntingResults.SourceDeviceHost
  description: Hostname of the device from which the session originated.
  type: string
- contextPath: CDL.HuntingResults.DestDeviceHost
  description: Hostname of the device session destination.
  type: string
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "315"
      - "269"
      - "267"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: efd174b1-c3ae-48ce-8d14-52e397954612
      iscommand: false
      name: ""
      version: -1
    taskid: efd174b1-c3ae-48ce-8d14-52e397954612
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -2270,
          "y": -290
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.FileType
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "303"
      "yes":
      - "335"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether any file types are available for threat hunting.
      id: 8866ab9f-b803-4e46-86c8-03b6fe1fd891
      iscommand: false
      name: Any file type to hunt for?
      type: condition
      version: -1
    taskid: 8866ab9f-b803-4e46-86c8-03b6fe1fd891
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2270,
          "y": -20
        }
      }
  "202":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Filename
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "202"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "285"
      "yes":
      - "334"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether any file names are available for threat hunting.
      id: 96c96060-86cc-45ae-8e0f-2a239b289823
      iscommand: false
      name: Any file name to hunt for?
      type: condition
      version: -1
    taskid: 96c96060-86cc-45ae-8e0f-2a239b289823
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1670,
          "y": -20
        }
      }
  "222":
    continueonerrortype: ""
    id: "222"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "280"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.FirewallAction
              operator: isNotEmpty
          root: inputs.FirewallAction
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - operator: uniq
      end_time:
        complex:
          accessor: end_time
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isEmpty
          root: inputs
      fields:
        simple: all
      file_name:
        complex:
          root: inputs.Filename
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - operator: uniq
      limit:
        complex:
          root: inputs.limit
      rule_matched:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.rule_matched
              operator: isNotEmpty
          root: inputs.rule_matched
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - operator: uniq
      start_time:
        complex:
          accessor: start_time
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isEmpty
          root: inputs
      time_range:
        complex:
          accessor: time_range
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isEmpty
          root: inputs
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex Data Lake
      description: Searches the Cortex panw.threat table, which is the threat logs
        table for PAN-OS/Panorama.
      id: ca7291ce-ae1d-43a6-8149-6a243a25a219
      iscommand: true
      name: Query Strata Logging Service - Threat Logs
      script: Cortex Data Lake|||cdl-query-threat-logs
      type: regular
      version: -1
    taskid: ca7291ce-ae1d-43a6-8149-6a243a25a219
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1440,
          "y": 290
        }
      }
  "257":
    continueonerrortype: ""
    id: "257"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c8d89928-54f0-43b4-85a0-c129afe5c8ad
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: c8d89928-54f0-43b4-85a0-c129afe5c8ad
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2270,
          "y": 770
        }
      }
  "267":
    continueonerrortype: ""
    id: "267"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "202"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4724bd19-b2b5-4ebe-8805-363a9d187814
      iscommand: false
      name: File Name Indicators
      type: title
      version: -1
    taskid: 4724bd19-b2b5-4ebe-8805-363a9d187814
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1670,
          "y": -150
        }
      }
  "269":
    continueonerrortype: ""
    id: "269"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 54912fab-85cc-4e40-8c22-b1553d0a2ec0
      iscommand: false
      name: File Type Indicators
      type: title
      version: -1
    taskid: 54912fab-85cc-4e40-8c22-b1553d0a2ec0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2270,
          "y": -150
        }
      }
  "273":
    continueonerrortype: ""
    id: "273"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "283"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.FirewallAction
              operator: isNotEmpty
          root: inputs.FirewallAction
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - operator: uniq
      end_time:
        complex:
          accessor: end_time
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isEmpty
          root: inputs
      file_name:
        complex:
          root: inputs.Filename
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - operator: uniq
      limit:
        complex:
          root: inputs.limit
      start_time:
        complex:
          accessor: start_time
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isEmpty
          root: inputs
      time_range:
        complex:
          accessor: time_range
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isEmpty
          root: inputs
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex Data Lake
      description: Searches the Cortex firewall.file_data table.
      id: 8aeee3d7-9661-4fc0-8616-f9a86b78ec18
      iscommand: true
      name: Query Strata Logging Service - File Data Logs
      script: Cortex Data Lake|||cdl-query-file-data
      type: regular
      version: -1
    taskid: 8aeee3d7-9661-4fc0-8616-f9a86b78ec18
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1030,
          "y": 290
        }
      }
  "280":
    continueonerrortype: ""
    id: "280"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "285"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: CDL.HuntingResults
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CDL.Logging.Threat.FileName
              operator: isNotEmpty
          root: CDL.Logging.Threat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: c4945f97-9b94-4bb7-8363-fc5930f83f23
      iscommand: false
      name: Save Matching Results - Threat Logs
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: c4945f97-9b94-4bb7-8363-fc5930f83f23
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1440,
          "y": 450
        }
      }
  "283":
    continueonerrortype: ""
    id: "283"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "285"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: CDL.HuntingResults
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CDL.Logging.File.FileName
              operator: isNotEmpty
          root: CDL.Logging.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 432ed7f0-b98b-4ed5-82cb-d5e2fd11008c
      iscommand: false
      name: Save Matching Results - File Data Logs
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 432ed7f0-b98b-4ed5-82cb-d5e2fd11008c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1030,
          "y": 450
        }
      }
  "285":
    continueonerrortype: ""
    id: "285"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "257"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 64264f5a-39ba-4c6a-84d0-5ce5df522631
      iscommand: false
      name: File Name Hunting Done
      type: title
      version: -1
    taskid: 64264f5a-39ba-4c6a-84d0-5ce5df522631
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1670,
          "y": 625
        }
      }
  "298":
    continueonerrortype: ""
    id: "298"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "301"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.FirewallAction
              operator: isNotEmpty
          root: inputs.FirewallAction
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - operator: uniq
      end_time:
        complex:
          accessor: end_time
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isEmpty
          root: inputs
      file_type:
        complex:
          root: inputs.FileType
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - operator: uniq
      limit:
        complex:
          root: inputs.limit
      start_time:
        complex:
          accessor: start_time
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isEmpty
          root: inputs
      time_range:
        complex:
          accessor: time_range
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isEmpty
          root: inputs
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex Data Lake
      description: Searches the Cortex firewall.file_data table.
      id: 3ed9a706-c9c4-47a9-8dcf-e18f48e446b8
      iscommand: true
      name: Query Strata Logging Service - File Data Logs
      script: Cortex Data Lake|||cdl-query-file-data
      type: regular
      version: -1
    taskid: 3ed9a706-c9c4-47a9-8dcf-e18f48e446b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2040,
          "y": 290
        }
      }
  "301":
    continueonerrortype: ""
    id: "301"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "303"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: CDL.HuntingResults
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CDL.Logging.File.FileType
              operator: isNotEmpty
          root: CDL.Logging.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: 2d395311-00d8-4da9-880a-34fba6c3550a
      iscommand: false
      name: Save Matching Results - File Data Logs
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 2d395311-00d8-4da9-880a-34fba6c3550a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2040,
          "y": 450
        }
      }
  "303":
    continueonerrortype: ""
    id: "303"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "257"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2907b4b4-0154-4dc1-80b9-e1f95a12a52d
      iscommand: false
      name: File Type Hunting Done
      type: title
      version: -1
    taskid: 2907b4b4-0154-4dc1-80b9-e1f95a12a52d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2270,
          "y": 625
        }
      }
  "309":
    continueonerrortype: ""
    id: "309"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "311"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: CDL.HuntingResults
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CDL.Logging.File.FileSHA256
              operator: isNotEmpty
          root: CDL.Logging.File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: ffa92ddc-e36b-43d6-81a7-ce02bb0eea39
      iscommand: false
      name: Save Matching Results - File Data Logs
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: ffa92ddc-e36b-43d6-81a7-ce02bb0eea39
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2960,
          "y": 450
        }
      }
  "311":
    continueonerrortype: ""
    id: "311"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "257"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bd9bbdcf-efb0-4c8c-8cfa-3211786636bc
      iscommand: false
      name: Hash Hunting Done
      type: title
      version: -1
    taskid: bd9bbdcf-efb0-4c8c-8cfa-3211786636bc
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2730,
          "y": 625
        }
      }
  "312":
    continueonerrortype: ""
    id: "312"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "309"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.FirewallAction
              operator: isNotEmpty
          root: inputs.FirewallAction
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - operator: uniq
      end_time:
        complex:
          accessor: end_time
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isEmpty
          root: inputs
      file_sha_256:
        complex:
          root: inputs.SHA256
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - operator: uniq
      limit:
        complex:
          root: inputs.limit
      start_time:
        complex:
          accessor: start_time
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isEmpty
          root: inputs
      time_range:
        complex:
          accessor: time_range
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isEmpty
          root: inputs
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex Data Lake
      description: Searches the Cortex firewall.file_data table.
      id: 0ff24a27-8674-4e3d-86df-412c636744ce
      iscommand: true
      name: Query Strata Logging Service - File Data Logs (Source Geolocation)
      script: Cortex Data Lake|||cdl-query-file-data
      type: regular
      version: -1
    taskid: 0ff24a27-8674-4e3d-86df-412c636744ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2960,
          "y": 290
        }
      }
  "313":
    continueonerrortype: ""
    id: "313"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "314"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.FirewallAction
              operator: isNotEmpty
          root: inputs.FirewallAction
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - operator: uniq
      end_time:
        complex:
          accessor: end_time
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isEmpty
          root: inputs
      fields:
        simple: all
      file_sha_256:
        complex:
          root: inputs.SHA256
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - operator: uniq
      limit:
        complex:
          root: inputs.limit
      rule_matched:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.rule_matched
              operator: isNotEmpty
          root: inputs.rule_matched
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - operator: uniq
      start_time:
        complex:
          accessor: start_time
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isEmpty
          root: inputs
      time_range:
        complex:
          accessor: time_range
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.time_range
              operator: isNotEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.start_time
              operator: isEmpty
          - - left:
                iscontext: true
                value:
                  simple: inputs.end_time
              operator: isEmpty
          root: inputs
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex Data Lake
      description: Searches the Cortex panw.threat table, which is the threat logs
        table for PAN-OS/Panorama.
      id: 46e5bd61-345e-4ae5-8a73-20a1cf158d4c
      iscommand: true
      name: Query Strata Logging Service - Threat Logs
      script: Cortex Data Lake|||cdl-query-threat-logs
      type: regular
      version: -1
    taskid: 46e5bd61-345e-4ae5-8a73-20a1cf158d4c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -3360,
          "y": 290
        }
      }
  "314":
    continueonerrortype: ""
    id: "314"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "311"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: CDL.HuntingResults
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: CDL.Logging.Threat.SessionID
              operator: isNotEmpty
          root: CDL.Logging.Threat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      id: f5b2703e-d7cc-44a6-833e-c0826aa7fe21
      iscommand: false
      name: Save Matching Results - Threat Logs
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: f5b2703e-d7cc-44a6-833e-c0826aa7fe21
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -3360,
          "y": 450
        }
      }
  "315":
    continueonerrortype: ""
    id: "315"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "316"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 25e2ddbc-2dc8-405f-8066-a4e6d129a2a6
      iscommand: false
      name: SHA256 Indicators
      type: title
      version: -1
    taskid: 25e2ddbc-2dc8-405f-8066-a4e6d129a2a6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2730,
          "y": -150
        }
      }
  "316":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.SHA256
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "316"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "311"
      "yes":
      - "336"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether any SHA256 hashes are available for threat hunting.
      id: 36771b49-0bb3-4ef2-843c-2e54a7df3d87
      iscommand: false
      name: Any SHA256 hash to hunt for?
      type: condition
      version: -1
    taskid: 36771b49-0bb3-4ef2-843c-2e54a7df3d87
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2730,
          "y": -20
        }
      }
  "334":
    continueonerrortype: ""
    id: "334"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "222"
      - "273"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e889d535-b148-4655-8019-f48086e54fbd
      iscommand: false
      name: Search File Name
      type: title
      version: -1
    taskid: e889d535-b148-4655-8019-f48086e54fbd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1240,
          "y": 150
        }
      }
  "335":
    continueonerrortype: ""
    id: "335"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "298"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6445dd7f-687a-45da-8902-9c808435fef4
      iscommand: false
      name: Search File Type
      type: title
      version: -1
    taskid: 6445dd7f-687a-45da-8902-9c808435fef4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2040,
          "y": 150
        }
      }
  "336":
    continueonerrortype: ""
    id: "336"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "312"
      - "313"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d2bb163b-a41a-4e94-80bd-65a9f7062fb1
      iscommand: false
      name: Search SHA256
      type: title
      version: -1
    taskid: d2bb163b-a41a-4e94-80bd-65a9f7062fb1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -3160,
          "y": 150
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1125,
        "width": 2710,
        "x": -3360,
        "y": -290
      }
    }
  }
