contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 14d097bc-dc2b-4454-8bd2-e22c180fcee8
inputs: []
name: TCS-Document & Close Section v3_KK_WIP
outputs: []
sourceplaybookid: 4a46e3dc-82da-4b3a-86ca-eb2f9dfd589f
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e5231c93-8442-443d-82ed-0720dfa61b6b
      iscommand: false
      name: ""
      version: -1
    taskid: e5231c93-8442-443d-82ed-0720dfa61b6b
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 6050
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: 'If You''ve Concluded The Investigation Head Over To The ''Report
          Summary'' Tab And Write Your Report  '
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes, I've finished Writing My Report
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Yes, I've finished Writing My Report:
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cb447440-c450-467d-8215-cbd7002560db
      iscommand: false
      name: 'If You''ve Concluded The Investigation Head Over To The ''Report Summary''
        Tab And Write Your Report  '
      type: condition
      version: -1
    taskid: cb447440-c450-467d-8215-cbd7002560db
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 6420
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Are You Ready To Close The Investigation ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes (make sure all mandatory fields are populated else the investigation will
        not close)
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Yes (make sure all mandatory fields are populated else the investigation will not close):
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e24cfa0a-86cd-4b61-85c7-2005f15c54f6
      iscommand: false
      name: Are You Ready To Close The Investigation ?
      type: condition
      version: -1
    taskid: e24cfa0a-86cd-4b61-85c7-2005f15c54f6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 6620
        }
      }
  "3":
    continueonerror: true
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 841f7370-be52-4041-8c86-1648f481c49d
      iscommand: false
      name: Check If Any Mandatory Fields Have been Missed
      type: title
      version: -1
    taskid: 841f7370-be52-4041-8c86-1648f481c49d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 7430
        }
      }
  "4":
    continueonerror: true
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "8"
      "yes":
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      id: dffc4819-ddfd-4617-8d5f-df228d95d48b
      iscommand: false
      name: Is The Previous Task In Error State ?
      script: isError
      type: condition
      version: -1
    taskid: dffc4819-ddfd-4617-8d5f-df228d95d48b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3440,
          "y": 8950
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      actionnotification:
        simple: '<h1 style="text-align: center;"><span style="color: #ffffff; background-color:
          #ff0000;"><strong>Oops!!You''ve Missed Filling a Mandatory Field. Double
          Check The ''Report Summary'' Tab</strong></span></h1>'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 0d14fbd9-029b-468e-8a45-382d27c186d4
      iscommand: true
      name: Notify Mandatory Field Not Filled
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 0d14fbd9-029b-468e-8a45-382d27c186d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3440,
          "y": 9150
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Oops!! Last Time You Missed Filling A Mandatory Field. Are You Sure
          You're Ready To Close This Investigation ?
      cc: null
      format: ""
      methods: []
      replyOptions:
      - Yes (make sure all mandatory fields are populated else the investigation will
        not close)
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      Yes (make sure all mandatory fields are populated else the investigation will not close):
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1a489e95-db99-4a0e-8dab-c916073f89f1
      iscommand: false
      name: Oops!! Last Time You Missed Filling A Mandatory Field. Are You Sure You're
        Ready To Close This Investigation ?
      type: condition
      version: -1
    taskid: 1a489e95-db99-4a0e-8dab-c916073f89f1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3440,
          "y": 9320
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 5171527d-8f7d-4060-89ec-57a8caed69ba
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 5171527d-8f7d-4060-89ec-57a8caed69ba
    timertriggers:
    - action: stop
      fieldname: closuresla
    type: regular
    view: |-
      {
        "position": {
          "x": 3440,
          "y": 9510
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: be36ceef-6287-4675-8ef8-b3f29eefd80f
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: be36ceef-6287-4675-8ef8-b3f29eefd80f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3150,
          "y": 9700
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c5a303ff-8e9a-41f5-8816-233378763d5d
      iscommand: false
      name: Document & Close
      type: title
      version: -1
    taskid: c5a303ff-8e9a-41f5-8816-233378763d5d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 6230
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: type
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: qradar offences onboarding
      label: SIEM
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: type
                root: incident
          operator: isEqualString
          right:
            value:
              simple: malware investigation
      label: EDR
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      EDR:
      - "16"
      SIEM:
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6b70b5a5-1fe3-4c13-8c16-7d3b5e2b9382
      iscommand: false
      name: Is This an SIEM or EDR ALert
      type: condition
      version: -1
    taskid: 6b70b5a5-1fe3-4c13-8c16-7d3b5e2b9382
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 6820
        }
      }
  "11":
    continueonerror: true
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      assigned_to:
        complex:
          accessor: phone
          root: IncidentOwner.[0]
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      closing_reason_id:
        simple: "55"
      closing_reason_name:
        simple: False Positive
      offense_id:
        complex:
          accessor: idoffense
          root: incident
      status:
        simple: CLOSED
      using:
        simple: QRadar v3_Offence Fetch
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Updates an offense.
      id: cefdd68f-ab8c-4004-86b8-d30bfe1daef0
      iscommand: true
      name: Update Investigation Conclusion in SIEM - False Positive
      script: QRadar v3|||qradar-offense-update
      type: regular
      version: -1
    taskid: cefdd68f-ab8c-4004-86b8-d30bfe1daef0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -290,
          "y": 7190
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationconclusion
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: false positive
      label: FP
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationconclusion
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: true positive
      label: TP
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationconclusion
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: benign-true positive
      label: BTP
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationconclusion
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: duplicate
      label: Duplicate
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      BTP:
      - "14"
      Duplicate:
      - "15"
      FP:
      - "11"
      TP:
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6a25046f-bb50-48e9-8bfd-a5d46c1f6b81
      iscommand: false
      name: SIEM Investigation Conclusion ?
      type: condition
      version: -1
    taskid: 6a25046f-bb50-48e9-8bfd-a5d46c1f6b81
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 330,
          "y": 7000
        }
      }
  "13":
    continueonerror: true
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      assigned_to:
        complex:
          accessor: phone
          root: IncidentOwner.[0]
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      closing_reason_id:
        simple: "54"
      closing_reason_name:
        simple: True Positive
      offense_id:
        complex:
          accessor: idoffense
          root: incident
      status:
        simple: CLOSED
      using:
        simple: QRadar v3_Offence Fetch
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Updates an offense.
      id: ca86cb8c-aee4-4bd0-8635-349a47ae81e7
      iscommand: true
      name: Update Investigation Conclusion in SIEM - True Positive
      script: QRadar v3|||qradar-offense-update
      type: regular
      version: -1
    taskid: ca86cb8c-aee4-4bd0-8635-349a47ae81e7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 120,
          "y": 7190
        }
      }
  "14":
    continueonerror: true
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      assigned_to:
        complex:
          accessor: phone
          root: IncidentOwner.[0]
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      closing_reason_id:
        simple: "105"
      closing_reason_name:
        simple: Benign-True Positive
      offense_id:
        complex:
          accessor: idoffense
          root: incident
      status:
        simple: CLOSED
      using:
        simple: QRadar v3_Offence Fetch
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Updates an offense.
      id: b4ed9b65-b8c3-4626-878f-e19ff3d78edf
      iscommand: true
      name: Update Investigation Conclusion in SIEM - Benign-True Positive
      script: QRadar v3|||qradar-offense-update
      type: regular
      version: -1
    taskid: b4ed9b65-b8c3-4626-878f-e19ff3d78edf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 530,
          "y": 7190
        }
      }
  "15":
    continueonerror: true
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      assigned_to:
        complex:
          accessor: phone
          root: IncidentOwner.[0]
          transformers:
          - args:
              to:
                value:
                  simple: '@'
            operator: substringTo
      closing_reason_id:
        simple: "104"
      closing_reason_name:
        simple: Duplicate
      offense_id:
        complex:
          accessor: idoffense
          root: incident
      status:
        simple: CLOSED
      using:
        simple: QRadar v3_Offence Fetch
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: Updates an offense.
      id: d8efd628-d24b-4323-80c6-75f4eeb3ad7c
      iscommand: true
      name: Update Investigation Conclusion in SIEM - Duplicate
      script: QRadar v3|||qradar-offense-update
      type: regular
      version: -1
    taskid: d8efd628-d24b-4323-80c6-75f4eeb3ad7c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 7190
        }
      }
  "16":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationconclusion
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: false positive
      label: FP
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationconclusion
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: true positive
      label: TP
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "20"
      FP:
      - "18"
      TP:
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 700d9eb1-7345-4955-8330-e61dcc8cd5c7
      iscommand: false
      name: EDR Investigation Conclusion ?
      type: condition
      version: -1
    taskid: 700d9eb1-7345-4955-8330-e61dcc8cd5c7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1880,
          "y": 7000
        }
      }
  "18":
    continueonerror: true
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      comment:
        complex:
          accessor: closingnote
          root: incident
      ids:
        complex:
          accessor: crowdstrikedetectionid
          root: incident
      status:
        simple: false_positive
      username:
        complex:
          accessor: email
          root: IncidentOwner
      using:
        simple: CrowdstrikeFalcon_Detections
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Resolves and updates a detection.
      id: 30061d8a-4522-46a8-8dcf-818b368d4b0d
      iscommand: true
      name: Update Investigation Conclusion in EDR - False Positive
      script: CrowdstrikeFalcon|||cs-falcon-resolve-detection
      type: regular
      version: -1
    taskid: 30061d8a-4522-46a8-8dcf-818b368d4b0d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1450,
          "y": 7190
        }
      }
  "19":
    continueonerror: true
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      comment:
        complex:
          accessor: closingnote
          root: incident
      ids:
        complex:
          accessor: crowdstrikedetectionid
          root: incident
      status:
        simple: true_positive
      username:
        complex:
          accessor: email
          root: IncidentOwner
      using:
        simple: CrowdstrikeFalcon_Detections
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Resolves and updates a detection.
      id: c95a8c09-9d3b-4044-801f-fa4810508725
      iscommand: true
      name: Update Investigation Conclusion in EDR - True Positive
      script: CrowdstrikeFalcon|||cs-falcon-resolve-detection
      type: regular
      version: -1
    taskid: c95a8c09-9d3b-4044-801f-fa4810508725
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1880,
          "y": 7190
        }
      }
  "20":
    continueonerror: true
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      comment:
        complex:
          accessor: closingnote
          root: incident
      ids:
        complex:
          accessor: crowdstrikedetectionid
          root: incident
      status:
        simple: closed
      username:
        complex:
          accessor: email
          root: IncidentOwner
      using:
        simple: CrowdstrikeFalcon_Detections
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Resolves and updates a detection.
      id: b23c670b-3174-4aa8-8e85-5473d06f6270
      iscommand: true
      name: Update Investigation Conclusion in EDR - Other
      script: CrowdstrikeFalcon|||cs-falcon-resolve-detection
      type: regular
      version: -1
    taskid: b23c670b-3174-4aa8-8e85-5473d06f6270
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2300,
          "y": 7190
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b26400e1-82f0-4610-8bbf-fb5c44517a25
      iscommand: false
      name: Check For Error Task
      type: title
      version: -1
    taskid: b26400e1-82f0-4610-8bbf-fb5c44517a25
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3440,
          "y": 8780
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: investigationconclusion
                root: incident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 87a20ddb-60dc-4727-8e0a-4a0cda1b62d3
      iscommand: false
      name: Check If Investigation Conclusion Field Has Been Filled
      type: condition
      version: -1
    taskid: 87a20ddb-60dc-4727-8e0a-4a0cda1b62d3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 7590
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "4_8_no": 0.2
    },
    "paper": {
      "dimensions": {
        "height": 3715,
        "width": 4110,
        "x": -290,
        "y": 6050
      }
    }
  }
