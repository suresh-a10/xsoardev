args:
- description: The value is an array of elements.
  isArray: true
  name: value
  required: true
- description: Provide the value from the array.
  name: array_value
  required: true
comment: |-
  This transformer will get an index of an element from an array.
  ex:["phishing","Malware"], if we provide "Malware" to array_value argument, will get index as 1.
commonfields:
  id: GetIndexOfArrayValue
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.8.0
    itemVersion: 1.3.6
    packID: CommunityCommonScripts
    packName: Community Common Scripts
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
dockerimage: demisto/python3:3.11.10.115186
enabled: true
engineinfo: {}
mainengineinfo: {}
name: GetIndexOfArrayValue
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  register_module_line('GetIndexOfArrayValue', 'start', __line__())
  demisto.debug('pack name = Community Common Scripts, pack version = 1.3.6')




  import traceback


  ''' MAIN FUNCTION '''


  def get_index(json_data, array_val):
      element_index = json_data.index(array_val)
      return element_index


  def main():
      try:
          json_data = argToList(demisto.args()['value'])
          array_val = demisto.args()['array_value']
          res = get_index(json_data, array_val)
          demisto.results(res)
      except Exception as ex:
          demisto.error(traceback.format_exc())  # print the traceback
          return_error(f'Failed to execute BaseScript. Error: {str(ex)}')


  ''' ENTRY POINT '''


  if __name__ in ('__main__', '__builtin__', 'builtins'):
      main()

  register_module_line('GetIndexOfArrayValue', 'end', __line__())
scripttarget: 0
subtype: python3
system: true
tags: []
type: python
