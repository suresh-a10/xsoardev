contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 9bbf22a5-3e3c-429f-8400-aa946328ebfd
inputs: []
name: Demo_Aman_test_WIP
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fcec6815-0d68-4b48-81f5-12a88582613c
      iscommand: false
      name: ""
      version: -1
    taskid: fcec6815-0d68-4b48-81f5-12a88582613c
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 85,
          "y": 35
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketactic
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: persistence
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketechnique
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: scheduled task/job
      - - left:
            iscontext: true
            value:
              simple: incident.crowdstrikefilename
          operator: containsString
          right:
            value:
              simple: schtasks.exe
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3800a62c-786b-4292-87f3-f83bdc375bb5
      iscommand: false
      name: Is the CS Trigger Logic Satisfied ?(Schtask.exe)
      type: condition
      version: -1
    taskid: 3800a62c-786b-4292-87f3-f83bdc375bb5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 85,
          "y": 190
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      device_id:
        simple: ${incident.crowdstrikedeviceid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get policy details of host
      id: 8254ec29-011f-4575-811a-6b7710909944
      iscommand: true
      name: Fetch policy details
      script: '|||cs-get-policy-details'
      type: regular
      version: -1
    taskid: 8254ec29-011f-4575-811a-6b7710909944
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 20
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikecmdline
                root: incident
                transformers:
                - args:
                    regex:
                      value:
                        simple: \d+
                    replaceWith: {}
                  operator: replaceMatch
          operator: isEqualString
          right:
            value:
              simple: 'schtasks  /create /RU SYSTEM /SC Once /ST : /TN SBWS installation
                /TR cmd /c C:\windows\temp\SBWSInstall.bat /F'
        - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikecmdline
                root: incident
          operator: isEqualString
          right:
            value:
              simple: schtasks  /create /RU Users /SC ONLOGON /TN SBWS Trigger /TR
                cmd /c C:\windows\temp\SBWSTrigger.bat /F
        - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstrikecmdline
                root: incident
                transformers:
                - args:
                    regex:
                      value:
                        simple: \d+
                    replaceWith: {}
                  operator: replaceMatch
          operator: isEqualString
          right:
            value:
              simple: 'schtasks  /create /RU SYSTEM /SC Once /ST : /TN SBWS installation
                /TR cmd /c C:\windows\temp\SBWSInstall.bat /F,schtasks  /create /RU
                SYSTEM /SC Once /ST : /TN SBWS installation /TR cmd /c C:\windows\temp\SBWSInstall.bat
                /F'
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3b50ffe8-1370-4b15-8f42-cbbdfcfe71b3
      iscommand: false
      name: chk cmd line using regex
      type: condition
      version: -1
    taskid: 3b50ffe8-1370-4b15-8f42-cbbdfcfe71b3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 230,
          "y": 700
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5051bff3-3fe5-47a4-83d3-11247aeae13f
      iscommand: false
      name: close
      type: title
      version: -1
    taskid: 5051bff3-3fe5-47a4-83d3-11247aeae13f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -60,
          "y": 2280
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: create Ticket
      value:
        simple: "Yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8811fb07-e40e-4c32-8750-f3eca14f29b6
      iscommand: false
      name: Set Context for createTicket
      script: Set
      type: regular
      version: -1
    taskid: 8811fb07-e40e-4c32-8750-f3eca14f29b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 710
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketactic
                root: incident
          operator: containsString
          right:
            value:
              simple: Defense Evasion
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketechnique
                root: incident
          operator: containsString
          right:
            value:
              simple: DLL Side-Loading
      - - left:
            iscontext: true
            value:
              simple: incident.crowdstrikefilename
          operator: containsString
          right:
            value:
              simple: Teams.exe
        - left:
            iscontext: true
            value:
              simple: incident.crowdstrikefilename
          operator: isEqualString
          right:
            value:
              simple: Update.exe
        - left:
            iscontext: true
            value:
              simple: incident.crowdstrikefilename
          operator: isEqualString
          right:
            value:
              simple: AdobeARMHelper.exe
        - left:
            iscontext: true
            value:
              simple: incident.crowdstrikefilename
          operator: isEqualString
          right:
            value:
              simple: Squirrel.exe
      label: "yes"
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 884717e3-be9c-42ec-8037-3a60c96ef41c
      iscommand: false
      name: Is the CS Trigger Logic Satisfied ?(Teams.exe)
      type: condition
      version: -1
    taskid: 884717e3-be9c-42ec-8037-3a60c96ef41c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -360,
          "y": 390
        }
      }
  "13":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${File.PositiveDetections}
          operator: isEqualString
          right:
            value:
              simple: "0"
        - left:
            iscontext: true
            value:
              simple: ${VirusTotal.File.attributes.last_analysis_stats.malicious}
          operator: isEqualString
          right:
            value:
              simple: "0"
        - left:
            iscontext: true
            value:
              simple: ${VirusTotal.File.attributes.last_analysis_stats.suspicious}
          operator: isEqualString
          right:
            value:
              simple: "0"
      label: "yes"
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2f7b0e18-66b2-4704-8422-b87e5e28d2ee
      iscommand: false
      name: Get file score
      type: condition
      version: -1
    taskid: 2f7b0e18-66b2-4704-8422-b87e5e28d2ee
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -360,
          "y": 900
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      device_id:
        simple: ${incident.crowdstrikedeviceid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get policy details of host
      id: 3697c9c9-8d8f-4880-8992-60525f5c9a46
      iscommand: true
      name: Fetch policy details
      script: '|||cs-get-policy-details'
      type: regular
      version: -1
    taskid: 3697c9c9-8d8f-4880-8992-60525f5c9a46
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -360,
          "y": 1100
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: create Ticket
      value:
        simple: "Yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 165292e2-b120-4ba6-892a-1a51efd1379a
      iscommand: false
      name: Ticket creation needed or not
      script: Set
      type: regular
      version: -1
    taskid: 165292e2-b120-4ba6-892a-1a51efd1379a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -360,
          "y": 1855
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AlertTime
      value:
        complex:
          accessor: timestamp}
          root: ${CrowdStrike.Detections.behaviors.[0]
          transformers:
          - args:
              delimiter:
                value:
                  simple: T
              fields:
                value:
                  simple: "1"
            operator: Cut
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets key/value pair in incident's context
      id: 5a2dcb62-ecff-4a01-8fbc-93e64b3a9ce3
      iscommand: false
      name: 'cs alert time '
      script: SetContext
      type: regular
      version: -1
    taskid: 5a2dcb62-ecff-4a01-8fbc-93e64b3a9ce3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -360,
          "y": 1275
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: PolicyDateChanged
      value:
        complex:
          accessor: applied_date}
          root: ${PolicyDetails.[0].device_policies.sensor_update
          transformers:
          - args:
              delimiter:
                value:
                  simple: T
              fields:
                value:
                  simple: "1"
            operator: Cut
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets key/value pair in incident's context
      id: 4e626031-996f-4994-8a1b-f1fb401c42b0
      iscommand: false
      name: Policy date set
      script: SetContext
      type: regular
      version: -1
    taskid: 4e626031-996f-4994-8a1b-f1fb401c42b0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -360,
          "y": 1450
        }
      }
  "19":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${AlertTime}
          operator: isEqualString
          right:
            value:
              simple: ${PolicyDateChanged}
      label: "yes"
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a4cfa967-a7d7-4e12-8a24-ed842c585de1
      iscommand: false
      name: Check if the date is same for policy update
      type: condition
      version: -1
    taskid: a4cfa967-a7d7-4e12-8a24-ed842c585de1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -360,
          "y": 1650
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AlertTime
      value:
        complex:
          accessor: timestamp}
          root: ${CrowdStrike.Detections.behaviors.[0]
          transformers:
          - args:
              delimiter:
                value:
                  simple: T
              fields:
                value:
                  simple: "1"
            operator: Cut
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets key/value pair in incident's context
      id: 69eb125e-8d02-4f4b-8b06-bfb20a9e3477
      iscommand: false
      name: 'cs alert time '
      script: SetContext
      type: regular
      version: -1
    taskid: 69eb125e-8d02-4f4b-8b06-bfb20a9e3477
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 165
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: PolicyDateChanged
      value:
        complex:
          accessor: applied_date}
          root: ${PolicyDetails.[0].device_policies.sensor_update
          transformers:
          - args:
              delimiter:
                value:
                  simple: T
              fields:
                value:
                  simple: "1"
            operator: Cut
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sets key/value pair in incident's context
      id: efab5886-0b49-4611-8885-da2c7f3393b7
      iscommand: false
      name: Policy date set
      script: SetContext
      type: regular
      version: -1
    taskid: efab5886-0b49-4611-8885-da2c7f3393b7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 340
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${AlertTime}
          operator: isEqualString
          right:
            value:
              simple: ${PolicyDateChanged}
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8c8df0ed-40d9-4bd4-8d54-645f1cee6208
      iscommand: false
      name: Check if the date is same for policy update
      type: condition
      version: -1
    taskid: 8c8df0ed-40d9-4bd4-8d54-645f1cee6208
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 495
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        simple: ${incident.crowdstrikefilehash}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the file reputation of the specified hash.
      id: fe1067a2-7d41-440c-8952-09078a0081f7
      iscommand: true
      name: get filehash details
      script: VirusTotal|||file
      type: regular
      version: -1
    taskid: fe1067a2-7d41-440c-8952-09078a0081f7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -360,
          "y": 730
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "12_8_#default#": 0.18
    },
    "paper": {
      "dimensions": {
        "height": 2325,
        "width": 2192.5,
        "x": -360,
        "y": 20
      }
    }
  }
