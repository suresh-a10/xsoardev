contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 4e7addcb-0620-4774-8594-eefac87ece89
inputs: []
name: TCS-CS Suppress False detection over DC playbook _v1.0
outputs: []
sourceplaybookid: 35d7c4a3-3bdc-4a91-8f36-e4746773113f
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4f8d4e06-cc85-4b44-812c-ddffd20eedda
      iscommand: false
      name: ""
      version: -1
    taskid: 4f8d4e06-cc85-4b44-812c-ddffd20eedda
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1040,
          "y": 5
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b211d3fa-eb21-4e87-84a8-4dcc171d0dfe
      iscommand: false
      name: Condition To Trigger Utilman Script
      type: title
      version: -1
    taskid: b211d3fa-eb21-4e87-84a8-4dcc171d0dfe
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 240
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketactic
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: persistence
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketechnique
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: accessibility features
      - - left:
            iscontext: true
            value:
              complex:
                accessor: csioaname
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isNotEqualString
          right:
            value:
              simple: accessibilityregwriteutilmanbypass
      label: "yes"
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1ee298ed-f6b9-4d62-8049-901c77f20b75
      iscommand: false
      name: Is the CS Trigger Logic Satisfied ?
      type: condition
      version: -1
    taskid: 1ee298ed-f6b9-4d62-8049-901c77f20b75
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 420
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      host_ids:
        simple: ${incident.crowdstrikedeviceid}
      script_name:
        simple: Restore_Utilman
      using:
        simple: CrowdstrikeFalcon_Detections
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Runs a script on the agent host.
      id: 9eaf4696-ba45-4ee5-8a89-e9ac43af0cde
      iscommand: true
      name: Execute The Utilman Script
      script: CrowdstrikeFalcon|||cs-falcon-run-script
      type: regular
      version: -1
    taskid: 9eaf4696-ba45-4ee5-8a89-e9ac43af0cde
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 440,
          "y": 640
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: da49f8fe-19f6-429a-84bd-3542770ba3ba
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: da49f8fe-19f6-429a-84bd-3542770ba3ba
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1010
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      comment:
        simple: AutoBot Here! I've run the Utilman Restore Script. Pls Validate.
      ids:
        simple: ${incident.labels.detection_id}
      status:
        simple: in_progress
      using:
        simple: CrowdstrikeFalcon_Detections
    separatecontext: false
    skipunavailable: false
    task:
      brand: CrowdstrikeFalcon
      description: Resolves and updates a detection.
      id: 38f6678f-8592-42f4-83d7-f530616eb51c
      iscommand: true
      name: Add Comment In CS Detection
      script: CrowdstrikeFalcon|||cs-falcon-resolve-detection
      type: regular
      version: -1
    taskid: 38f6678f-8592-42f4-83d7-f530616eb51c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 790
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 24c9dfc7-29b2-4013-881a-1f8a3ff8f9c2
      iscommand: false
      name: condition to trigger cases (DC_MidNight)
      type: title
      version: -1
    taskid: 24c9dfc7-29b2-4013-881a-1f8a3ff8f9c2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1040,
          "y": 145
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketactic
                root: incident
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: impact
      - - left:
            iscontext: true
            value:
              complex:
                accessor: crowdstriketechnique
                root: incident
                transformers:
                - operator: toLowerCase
          operator: containsString
          right:
            value:
              simple: inhibit system recovery
      - - left:
            iscontext: true
            value:
              simple: incident.crowdstrikefilename
          operator: containsString
          right:
            value:
              simple: svchost.exe
        - left:
            iscontext: true
            value:
              simple: incident.crowdstrikefilename
          operator: containsString
          right:
            value:
              simple: wbadmin.exe
        - left:
            iscontext: true
            value:
              simple: incident.crowdstrikefilename
          operator: isEqualString
          right:
            value:
              simple: VMwareHorizon
        - left:
            iscontext: true
            value:
              simple: incident.crowdstrikefilename
          operator: isEqualString
          right:
            value:
              simple: SystemPropertiesComputerName.exe
      label: "yes"
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8322604c-e244-4ecd-8797-39b83a833bfc
      iscommand: false
      name: Is the CS Trigger Logic Satisfied ?
      type: condition
      version: -1
    taskid: 8322604c-e244-4ecd-8797-39b83a833bfc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1040,
          "y": 285
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${NewTime}
          operator: isAfter
          right:
            value:
              simple: ' T10:15:00.00+05:30'
      - - left:
            iscontext: true
            value:
              simple: ${NewTime}
          operator: isBefore
          right:
            value:
              simple: ' T11:20:00.00+05:30'
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      id: f43c0a0c-b808-4b6c-8b2f-b634c6ff177a
      iscommand: false
      name: check time of detection
      type: condition
      version: -1
    taskid: f43c0a0c-b808-4b6c-8b2f-b634c6ff177a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 400
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      tested_time:
        simple: ${NewTime}
      values_to_compare:
        simple: ' 00:15:00.00+05:30'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compares a single timestamp to a list of timestamps.
      id: 0459f760-de0e-48c2-8ef4-2e9bfb32299e
      iscommand: false
      name: time compare 1
      script: TimeStampCompare
      type: regular
      version: -1
    taskid: 0459f760-de0e-48c2-8ef4-2e9bfb32299e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1040,
          "y": 815
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      left:
        simple: ${incident.crowdstrikehostname}
      right:
        simple: ${lists.DChostsFP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compare  two lists and put the differences in context.
      id: d7ceb8f4-30d6-46ac-8da7-a665eae8738e
      iscommand: false
      name: check if host is present in excluded list of hosts.
      script: CompareLists
      type: regular
      version: -1
    taskid: d7ceb8f4-30d6-46ac-8da7-a665eae8738e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1760,
          "y": 70
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ListCompare.Both
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a96345e3-908c-4c81-877b-d3b6a0ab7d5e
      iscommand: false
      name: 'move playbook for time check '
      type: condition
      version: -1
    taskid: a96345e3-908c-4c81-877b-d3b6a0ab7d5e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 225
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: NewTime
      value:
        complex:
          accessor: occurred
          root: incident
          transformers:
          - args:
              delimiter:
                value:
                  simple: T
              fields:
                value:
                  simple: "2"
            operator: Cut
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 4342d7b1-468b-427b-80aa-23577a3d9bc2
      iscommand: false
      name: set time
      script: Set
      type: regular
      version: -1
    taskid: 4342d7b1-468b-427b-80aa-23577a3d9bc2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1040,
          "y": 650
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: TimeStampCompare.Result
          operator: isEqualString
          right:
            value:
              simple: before
      label: "yes"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: db2e6b93-beaf-4dc5-8034-8a80d3d52ddb
      iscommand: false
      name: time compare 1 result
      type: condition
      version: -1
    taskid: db2e6b93-beaf-4dc5-8034-8a80d3d52ddb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1040,
          "y": 970
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      tested_time:
        simple: ${NewTime}
      values_to_compare:
        simple: ' 00:20:00.00+05:30'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Compares a single timestamp to a list of timestamps.
      id: ab2b7826-ed38-4c11-8b55-bbd31a20b2de
      iscommand: false
      name: time compare 2
      script: TimeStampCompare
      type: regular
      version: -1
    taskid: ab2b7826-ed38-4c11-8b55-bbd31a20b2de
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1040,
          "y": 1145
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: TimeStampCompare.Result
          operator: isEqualString
          right:
            value:
              simple: after
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 054e77d9-19c7-4a06-8145-c4e947f9b3f9
      iscommand: false
      name: time compare 2 result
      type: condition
      version: -1
    taskid: 054e77d9-19c7-4a06-8145-c4e947f9b3f9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1040,
          "y": 1290
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: abf23844-f4bb-4eaa-8496-730b8bc36e27
      iscommand: false
      name: done
      type: title
      version: -1
    taskid: abf23844-f4bb-4eaa-8496-730b8bc36e27
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1520,
          "y": 1870
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: create Ticket
      value:
        simple: "Yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d6a5feef-eeaa-462b-85eb-222fbbe80d11
      iscommand: false
      name: Ticket creation needed or not
      script: Set
      type: regular
      version: -1
    taskid: d6a5feef-eeaa-462b-85eb-222fbbe80d11
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1040,
          "y": 1480
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: create Ticket
      value:
        simple: "No"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: bf098ac8-af02-444d-8cef-3345d81560f5
      iscommand: false
      name: Ticket creation needed or not
      script: Set
      type: regular
      version: -1
    taskid: bf098ac8-af02-444d-8cef-3345d81560f5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1450
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${create Ticket}
          operator: containsString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 60a50375-a4fc-4e6e-87dd-afbf0a553f8e
      iscommand: false
      name: 'create ticket or close case '
      type: condition
      version: -1
    taskid: 60a50375-a4fc-4e6e-87dd-afbf0a553f8e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1660
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1a84d183-cff6-42f6-8957-bd6eb387f359
      iscommand: false
      name: Untitled Task
      type: regular
      version: -1
    taskid: 1a84d183-cff6-42f6-8957-bd6eb387f359
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 830,
          "y": 1870
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.crowdstrikehostname}
          operator: inList
          right:
            value:
              simple: ${lists.DChostsFP}
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 92c0a904-ff71-4ee0-886d-175a5e42b32a
      iscommand: false
      name: check if host is present in excluded list of hosts.
      type: condition
      version: -1
    taskid: 92c0a904-ff71-4ee0-886d-175a5e42b32a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1040,
          "y": 460
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1960,
        "width": 1710,
        "x": 440,
        "y": 5
      }
    }
  }
