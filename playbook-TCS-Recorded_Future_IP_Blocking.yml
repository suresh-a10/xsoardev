contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: 3a37bf98-d8e9-4ab9-8889-dba63691e69c
inputs: []
name: TCS-Recorded Future IP Blocking
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 07c475ea-be27-4d31-88ff-a98f972a3611
      iscommand: false
      name: ""
      version: -1
    taskid: 07c475ea-be27-4d31-88ff-a98f972a3611
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 200,
          "y": -930
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      dest-dir:
        simple: /var/lib/tomcat6/webapps/ROOT
      fileID:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: remoteaccess
      description: commands.server.remoteacess.copyto.description
      id: b2e34c9e-7c3e-4511-8aa2-963f7dde94dd
      iscommand: true
      name: Upload File to Webserver
      script: remoteaccess|||copy-to
      type: regular
      version: -1
    taskid: b2e34c9e-7c3e-4511-8aa2-963f7dde94dd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 270
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      entryId:
        simple: ${File.EntryID}
      filename:
        simple: recordedfuture.csv
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Will create a file (using the given data input or entry ID) and upload it to current investigation war room.
      id: ac525374-48fa-4ba6-89a7-ef1597cec76b
      iscommand: false
      name: Grab Recorded Future File List
      script: FileCreateAndUpload
      tags:
      - RecordedFutureIPList
      type: regular
      version: -1
    taskid: ac525374-48fa-4ba6-89a7-ef1597cec76b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -260,
          "y": 130
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: recordedfuture.csv
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Load the contents of a file into context.
      id: af4d1d2f-bd6e-4d98-8dfd-9394fd280e25
      iscommand: false
      name: Read into context key
      script: ReadFile
      type: regular
      version: -1
    taskid: af4d1d2f-bd6e-4d98-8dfd-9394fd280e25
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -260,
          "y": 310
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: fe3a1b8c-7fcc-4543-8f32-2c05352c1208
      iscommand: false
      name: Delete Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: fe3a1b8c-7fcc-4543-8f32-2c05352c1208
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": -800
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8d63d864-2e91-4a76-828e-500d11c6606f
      iscommand: false
      name: 'Trigger #1 - Recorded Future'
      type: title
      version: -1
    taskid: 8d63d864-2e91-4a76-828e-500d11c6606f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 200,
          "y": -160
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c6639712-696e-4000-8184-c94367820bca
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: c6639712-696e-4000-8184-c94367820bca
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -250,
          "y": 675
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7de2841f-0636-476e-8552-20ca9ef77f37
      iscommand: false
      name: Review IOC List and Update EDL
      type: title
      version: -1
    taskid: 7de2841f-0636-476e-8552-20ca9ef77f37
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 200,
          "y": 10
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 633a2ed1-8feb-4e73-84f3-f90c635cc132
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 633a2ed1-8feb-4e73-84f3-f90c635cc132
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 190,
          "y": 570
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 29fa9ee4-2b58-48e8-8b01-f2630128a1f9
      iscommand: true
      name: Close Incident
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 29fa9ee4-2b58-48e8-8b01-f2630128a1f9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 580
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 66b30b8d-075e-48c8-8574-a7ef10e93e98
      iscommand: false
      name: Retrieve List of IP's with Rreputation >=90 and process
      type: title
      version: -1
    taskid: 66b30b8d-075e-48c8-8574-a7ef10e93e98
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -260,
          "y": -55
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ae7d261a-37fe-47d0-836a-54693bd69c87
      iscommand: false
      name: Trigger#2 - IP's received via Email
      type: title
      version: -1
    taskid: ae7d261a-37fe-47d0-836a-54693bd69c87
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 660,
          "y": -160
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b8b2a689-9b94-4b99-8234-833b7e373bfd
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: b8b2a689-9b94-4b99-8234-833b7e373bfd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 660,
          "y": 420
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 307b5541-bcc0-428b-876d-7b29996f28d8
      iscommand: false
      name: Begin Playbook
      type: title
      version: -1
    taskid: 307b5541-bcc0-428b-876d-7b29996f28d8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 200,
          "y": -650
        }
      }
  "33":
    continueonerrortype: ""
    form:
      description: Please answer the following question to determine which trigger
        this incident is for
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Trigger: Recorded Future'
        options:
        - "Yes"
        - "No"
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: 'Trigger: Mail containing IP addreses'
        options:
        - "Yes"
        - "No"
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: 'Answering this question will detrmine whether the Playbook will
          process Trigger#1: Recorded Future, or Trigger#2: Email containing IP address(es)'
        type: singleSelect
      sender: Your SOC team
      title: Determine which Trigger this incident will run
      totalanswers: 0
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Which mechanism will trigger this playbook?
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4a0bef41-14ef-4b75-8894-5ac18f06f77d
      iscommand: false
      name: Q&A to determine Trigger for this Playbook
      type: collection
      version: -1
    taskid: 4a0bef41-14ef-4b75-8894-5ac18f06f77d
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -230,
          "y": -370
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Determine which Trigger this incident will run.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: Recorded Future
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "35"
      Recorded Future:
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7b91b70d-f71e-4622-811a-bd7fc7d6dbb3
      iscommand: false
      name: Is the trigger for this Playbook the Recorded Future Integration?
      type: condition
      version: -1
    taskid: 7b91b70d-f71e-4622-811a-bd7fc7d6dbb3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 200,
          "y": -360
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Determine which Trigger this incident will run.Answers.1
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: Email
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      Email:
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5a3b8bcc-c918-48f9-8973-6f625a84ad01
      iscommand: false
      name: Is the trigger for this an Email containing IP address(es)?
      type: condition
      version: -1
    taskid: 5a3b8bcc-c918-48f9-8973-6f625a84ad01
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 660,
          "y": -360
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ad17b763-4b91-4772-843f-bf06453ba9ee
      iscommand: false
      name: Determine Trigger to use
      type: title
      version: -1
    taskid: ad17b763-4b91-4772-843f-bf06453ba9ee
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 200,
          "y": -530
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      cmd:
        simple: echo "${FileData}" >> /var/lib/tomcat6/webapps/ROOT/Demisto_Block1.txt
          && cat /var/lib/tomcat6/webapps/ROOT/Demisto_Block1.txt | sort -u -o /var/lib/tomcat6/webapps/ROOT/Demisto_Block1.txt
    separatecontext: false
    skipunavailable: false
    task:
      brand: remoteaccess
      description: commands.server.remoteacess.ssh.description
      id: bf806e3f-da82-45ec-81d1-7f7dd3b081b5
      iscommand: true
      name: SSH
      script: remoteaccess|||ssh
      type: regular
      version: -1
    taskid: bf806e3f-da82-45ec-81d1-7f7dd3b081b5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 200,
          "y": 420
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      list:
        simple: ${FileData}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Recorded Future
      description: Gets the IP risk list as a CSV file from Recorded Future.
      id: 5ec79bc2-8db1-464d-8bd8-3d400f459f39
      iscommand: true
      name: Untitled Task
      script: Recorded Future|||recorded-future-get-ip-risklist
      type: regular
      version: -1
    taskid: 5ec79bc2-8db1-464d-8bd8-3d400f459f39
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -260,
          "y": 500
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1670,
        "width": 1570,
        "x": -260,
        "y": -930
      }
    }
  }
