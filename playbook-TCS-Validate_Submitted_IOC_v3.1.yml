contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: d225a56b-e807-4561-85ad-464d65b08963
inputs:
- description: ""
  key: suspiciousiocs
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: entertheiocsforblocking
      root: incident
name: TCS-Validate Submitted IOC v3.1
outputs: []
sourceplaybookid: 7e0105f5-2558-456a-85df-77c9558ebba6
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d27a6ba5-0aa7-4540-8fb1-f93ecb64bc02
      iscommand: false
      name: ""
      version: -1
    taskid: d27a6ba5-0aa7-4540-8fb1-f93ecb64bc02
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 670,
          "y": -180
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.suspiciousiocs
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7fe7cf66-75c0-449b-8a37-79faf3054234
      iscommand: false
      name: Are There IoC(s) For Blacklisting ?
      type: condition
      version: -1
    taskid: 7fe7cf66-75c0-449b-8a37-79faf3054234
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 670,
          "y": -10
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
      - "52"
      - "53"
      - "54"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlacklistIOC
      value:
        complex:
          root: inputs.suspiciousiocs
          transformers:
          - args:
              delimiter:
                value:
                  simple: |2+

            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8c399526-b44a-450b-86fd-baf17839b733
      iscommand: false
      name: Set IoC(s) In Contest
      script: Set
      type: regular
      version: -1
    taskid: 8c399526-b44a-450b-86fd-baf17839b733
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 410
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.URL
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.URL
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 998cd6db-fd6a-4fc3-8b8f-f876bebcc4a1
      iscommand: false
      name: Set Blacklist URL in 'Blacklist.URL' Context
      script: Set
      type: regular
      version: -1
    taskid: 998cd6db-fd6a-4fc3-8b8f-f876bebcc4a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 870
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain_Test_
            - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.Domain
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 527c37ed-dca5-473c-80d0-0d024f02e7b0
      iscommand: false
      name: Set Blacklist Domain in 'Blacklist.Domain' Context
      script: Set
      type: regular
      version: -1
    taskid: 527c37ed-dca5-473c-80d0-0d024f02e7b0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 870
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Blacklist.IPV4
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.IP
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d032e57a-00b8-43ab-8547-2581301eeb95
      iscommand: false
      name: Set Blacklist IPv4 IP Address in 'Blacklist.IPV4' Context
      script: Set
      type: regular
      version: -1
    taskid: d032e57a-00b8-43ab-8547-2581301eeb95
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 870
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.Hash
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: BlacklistIOC
              operator: in
              right:
                iscontext: true
                value:
                  simple: ExtractedIndicators.File
          root: BlacklistIOC
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5cfaf87d-54ba-4153-8539-5467b4bf65cc
      iscommand: false
      name: Set Blacklist Hash in 'Blacklist.Hash' Context
      script: Set
      type: regular
      version: -1
    taskid: 5cfaf87d-54ba-4153-8539-5467b4bf65cc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 870
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 71821987-6fee-41ed-8768-099ce1767954
      iscommand: false
      name: Check If Submitted IoC(s) Are Part of The Trusted Domain List
      type: title
      version: -1
    taskid: 71821987-6fee-41ed-8768-099ce1767954
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1960,
          "y": 1080
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      domains:
        simple: ${lists.TCS_Customer_Domain_List},${lists.TCS_Created_Domain}
      urls:
        complex:
          accessor: URL
          root: Blacklist
          transformers:
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the supplied URLs are in the specified domains.
      id: 61582017-e40b-471b-81ab-e735146ac4da
      iscommand: false
      name: Is The URL Part of The Trusted List
      script: IsUrlPartOfDomain
      type: regular
      version: -1
    taskid: 61582017-e40b-471b-81ab-e735146ac4da
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1280
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.URL
      value:
        complex:
          accessor: URL
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IsUrlPartOfDomain.IsInternal
              operator: isEqualString
              right:
                value:
                  simple: "true"
          - - left:
                iscontext: true
                value:
                  simple: IsUrlPartOfDomain.URL
              operator: in
              right:
                iscontext: true
                value:
                  simple: Blacklist.URL
          root: IsUrlPartOfDomain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8b938c84-d066-4892-83b5-208b8add2732
      iscommand: false
      name: Set Identified Trusted URL in Context
      script: Set
      type: regular
      version: -1
    taskid: 8b938c84-d066-4892-83b5-208b8add2732
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1650
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 2
    scriptarguments:
      main_domains:
        simple: ${lists.TCS_Customer_Domain_List},${lists.TCS_Created_Domain}
      possible_sub_domains_to_test:
        complex:
          accessor: Domain
          root: Blacklist
          transformers:
          - args:
              delimiter: {}
            operator: split
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script accepts multiple values for both arguments and will
        iterate through each of the domains to check if the specified subdomains are
        located in at least one of the specified main domains. If the tested subdomain
        is in one of the main domains, the result will be true. For example, if the
        domain_to_check values are apps.paloaltonetworks.com and apps.paloaltonetworks.bla
        and the domains_to_compare values are paloaltonetworks.com and demisto.com,
        the result for apps.paloaltonetworks.com will be true since it is a part of
        the paloaltonetworks.com domain. The result for apps.paloaltonetworks.bla
        will be false since it is not a part of the paloaltonetworks.com or demisto.com
        domain.
      id: 14967564-4c12-48fd-8f96-718d77917048
      iscommand: false
      name: Is The Domain Part of The Trusted List
      script: IsInternalDomainName
      type: regular
      version: -1
    taskid: 14967564-4c12-48fd-8f96-718d77917048
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1280
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: Blacklist
          operator: notIn
          right:
            iscontext: true
            value:
              simple: Trusted.URL
      label: "yes"
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4f5f444d-76be-45a1-819a-af755f21fe9d
      iscommand: false
      name: Are There Any URLs For Blacklisting ?
      type: condition
      version: -1
    taskid: 4f5f444d-76be-45a1-819a-af755f21fe9d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2130
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.URL
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Blacklist.URL
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: Trusted.URL
          root: Blacklist.URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: b8e5c238-dc26-49ae-896c-9ff48f0128d0
      iscommand: false
      name: Set The Filtered Blacklisting URLs in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: b8e5c238-dc26-49ae-896c-9ff48f0128d0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2380
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsInternal
                root: IsInternalDomain
          operator: containsGeneral
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a014b5f5-5db6-43dc-8ded-66842ed10d62
      iscommand: false
      name: Are There Domain(s) Part of The Trusted List
      type: condition
      version: -1
    taskid: a014b5f5-5db6-43dc-8ded-66842ed10d62
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1450
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.Domain
      value:
        complex:
          accessor: DomainToTest
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IsInternalDomain.DomainToTest
              operator: in
              right:
                iscontext: true
                value:
                  simple: Blacklist.Domain
          - - left:
                iscontext: true
                value:
                  simple: IsInternalDomain.IsInternal
              operator: isEqualString
              right:
                value:
                  simple: "true"
          root: IsInternalDomain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 5142aa3b-e4eb-45f1-82d5-35aa5c4987b7
      iscommand: false
      name: Set Identified Trusted Domain in Context
      script: Set
      type: regular
      version: -1
    taskid: 5142aa3b-e4eb-45f1-82d5-35aa5c4987b7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1650
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: Blacklist
          operator: notIn
          right:
            iscontext: true
            value:
              simple: TrustedDomainNew
      label: "yes"
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 70b10cc1-f8b7-4800-87d9-efe34124426e
      iscommand: false
      name: Are There Any Domains For Blacklisting ?
      type: condition
      version: -1
    taskid: 70b10cc1-f8b7-4800-87d9-efe34124426e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 2130
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.Domain
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Blacklist.Domain
              operator: notIn
              right:
                iscontext: true
                value:
                  simple: TrustedDomainNew
          root: Blacklist.Domain
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: dd973701-fbc5-4807-835b-72565f8758e9
      iscommand: false
      name: Set The Filtered Blacklisting Domains in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: dd973701-fbc5-4807-835b-72565f8758e9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 2380
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "31"
      "yes":
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: IPV4
          root: Blacklist
      ipRanges:
        simple: ${lists.Google Public IP Addresses},${lists.Microsoft Public IP Addresses},${lists.TCS
          Public IP Addresses},${lists.MasterIOC_IP Address},${lists.ZscalerIPAddresses}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns yes if the IP is in one of the ranges provided, returns
        no otherwise.
      id: c63a071f-7e62-4bfe-8d04-0af787ff20c5
      iscommand: false
      name: Is The IP Address Part of The Trusted List
      script: b502efb7-b0a1-449b-8d9e-31e8fe70f470
      type: condition
      version: -1
    taskid: c63a071f-7e62-4bfe-8d04-0af787ff20c5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 20,
          "y": 1280
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Trusted.IPV4
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "yes"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d8f53679-4c63-4466-8d26-f0823513150d
      iscommand: false
      name: Set Identified Trusted IP Address in Context
      script: Set
      type: regular
      version: -1
    taskid: d8f53679-4c63-4466-8d26-f0823513150d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 1650
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: InRange
                root: IP
          operator: isEqualString
          right:
            value:
              simple: "no"
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cd51a63d-e6c9-4220-83e0-41bd5a002dca
      iscommand: false
      name: Are There Any IP Addresses For Blacklisting ?
      type: condition
      version: -1
    taskid: cd51a63d-e6c9-4220-83e0-41bd5a002dca
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 20,
          "y": 2130
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: FinalBlacklist.IPV4
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "no"
          root: IP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 36bf912e-c947-401d-8a9f-3c2f1ce99dc0
      iscommand: false
      name: Set The Filtered Blacklisting IP Address in Context
      script: Set
      tags:
      - validatedioc
      type: regular
      version: -1
    taskid: 36bf912e-c947-401d-8a9f-3c2f1ce99dc0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 2380
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3d5f6cd4-d1cf-4bb5-8e05-2680fd8c5838
      iscommand: false
      name: Update Widgets For Trusted & Validated IoC(s)
      type: title
      version: -1
    taskid: 3d5f6cd4-d1cf-4bb5-8e05-2680fd8c5838
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1960,
          "y": 2720
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Trusted
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 1def4d2a-5d74-40b4-8d6a-afbf2278b571
      iscommand: false
      name: Are There Trusted IoC(s)?
      type: condition
      version: -1
    taskid: 1def4d2a-5d74-40b4-8d6a-afbf2278b571
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1720,
          "y": 2890
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e36aa0ee-8ef7-4c8c-8870-4e2573ad9876
      iscommand: false
      name: The End
      type: title
      version: -1
    taskid: e36aa0ee-8ef7-4c8c-8870-4e2573ad9876
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1960,
          "y": 3310
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      text:
        simple: ${inputs.suspiciousiocs}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 26500f6e-1b85-4c06-82ad-8e71e0626b8d
      iscommand: true
      name: Extract & Enrich Indicators
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 26500f6e-1b85-4c06-82ad-8e71e0626b8d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 670,
          "y": 210
        }
      }
  "40":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: FinalBlacklist
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 0d30118a-1b95-464c-8bd4-5d4b3086fc96
      iscommand: false
      name: 'Are There Validated IoC(s)? '
      type: condition
      version: -1
    taskid: 0d30118a-1b95-464c-8bd4-5d4b3086fc96
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 2890
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      trustediocs:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Trusted
              operator: in
              right:
                iscontext: true
                value:
                  simple: TrustedDomainNew
          root: Trusted
          transformers:
          - operator: Stringify
          - args:
              chars:
                value:
                  simple: '{}'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 0446b6aa-b333-4eb0-819a-25a8ac733333
      iscommand: true
      name: Set The Trusted IoC(s) Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 0446b6aa-b333-4eb0-819a-25a8ac733333
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1720,
          "y": 3060
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      validatediocsforblacklisting:
        complex:
          root: FinalBlacklist
          transformers:
          - operator: Stringify
          - args:
              chars:
                value:
                  simple: '{}'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 68496e63-c2f6-459d-8fc2-751f1c58e7da
      iscommand: true
      name: Set The Trusted IoC(s) Context
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 68496e63-c2f6-459d-8fc2-751f1c58e7da
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 3070
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      validatedurl:
        complex:
          accessor: URL
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 947c5692-3ead-4701-890c-28c5acd73522
      iscommand: true
      name: Set Incident Context ' Validated URL'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 947c5692-3ead-4701-890c-28c5acd73522
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2550
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      validatedipaddress:
        complex:
          accessor: IPV4
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8852e6f2-984a-4006-80d5-592d21fda4a8
      iscommand: true
      name: Set Incident Context ' Validated IP Address'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8852e6f2-984a-4006-80d5-592d21fda4a8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 2550
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      validateddomain:
        complex:
          accessor: Domain
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 23ffb577-95eb-478f-87bc-4b454a41ebb5
      iscommand: true
      name: Set Incident Context ' Validated Domain'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 23ffb577-95eb-478f-87bc-4b454a41ebb5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 2550
        }
      }
  "46":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Hash
                root: FinalBlacklist
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5d520b15-c081-41d9-838f-6df133db1fd4
      iscommand: false
      name: Check If Context 'FinalBlacklist.Hash' is Set
      type: condition
      version: -1
    taskid: 5d520b15-c081-41d9-838f-6df133db1fd4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 2130
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      validatedhash:
        complex:
          accessor: Hash
          root: FinalBlacklist
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 629876ad-3013-48e4-84b7-130da1ce587f
      iscommand: true
      name: Set Incident Context ' Validated Hash'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 629876ad-3013-48e4-84b7-130da1ce587f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 2550
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      trustedipaddress:
        complex:
          accessor: IPV4
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: f09d14b0-fef3-4ec9-8e59-f9d141c4e176
      iscommand: true
      name: Set Incident Context ' Trusted IP Address'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: f09d14b0-fef3-4ec9-8e59-f9d141c4e176
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 1870
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      trustedurl:
        complex:
          accessor: URL
          root: Trusted
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 969bcf82-7026-4903-8886-2870331946ec
      iscommand: true
      name: Set Incident Context ' Trusted URL'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 969bcf82-7026-4903-8886-2870331946ec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1870
        }
      }
  "50":
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      trusteddomain:
        complex:
          root: TrustedDomainNew
          transformers:
          - operator: StringifyArray
          - args:
              chars:
                value:
                  simple: '[" "]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: '","'
            operator: split
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 80771526-295e-4bde-8b74-daf6efccec8e
      iscommand: true
      name: Set Incident Context ' Trusted Domain'
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 80771526-295e-4bde-8b74-daf6efccec8e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1870
        }
      }
  "51":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IP
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7dc8fe19-fe51-40da-837e-b12904215884
      iscommand: false
      name: Is There an IPv4 IP Address in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 7dc8fe19-fe51-40da-837e-b12904215884
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 20,
          "y": 620
        }
      }
  "52":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: URL
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 96a7fdb0-7418-4620-8938-be68921f16a2
      iscommand: false
      name: Is There a URL in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 96a7fdb0-7418-4620-8938-be68921f16a2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 620
        }
      }
  "53":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Domain
                root: ExtractedIndicators
          operator: isExists
        - left:
            iscontext: true
            value:
              complex:
                accessor: Domain_Test_
                root: ExtractedIndicators
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 78a81252-9c07-435a-8d31-f8e8832af9f7
      iscommand: false
      name: Is There a Domain in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 78a81252-9c07-435a-8d31-f8e8832af9f7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 880,
          "y": 620
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExtractedIndicators.File
                    operator: in
                    right:
                      iscontext: true
                      value:
                        simple: BlacklistIOC
                root: ExtractedIndicators.File
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 05854591-0b24-44b7-8076-3b03408d25e5
      iscommand: false
      name: Is There a Hash in The Submitted Blacklist IoC Request ?
      type: condition
      version: -1
    taskid: 05854591-0b24-44b7-8076-3b03408d25e5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 620
        }
      }
  "55":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IsInternal
                root: IsUrlPartOfDomain
          operator: containsGeneral
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 76aa2ac4-62fd-4b73-8bb7-3c3f35184863
      iscommand: false
      name: Are There URL(s) Part of The Trusted Domain List
      type: condition
      version: -1
    taskid: 76aa2ac4-62fd-4b73-8bb7-3c3f35184863
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1450
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      IOC:
        complex:
          accessor: Domain
          root: Trusted
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 89c31af3-ce54-4d8f-82b8-e0c9a22fdb0f
      iscommand: false
      name: Check the TLD
      script: fad6d2f6-867f-4fe4-8d1a-0e20b1f8fa07
      type: regular
      version: -1
    taskid: 89c31af3-ce54-4d8f-82b8-e0c9a22fdb0f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 1650
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "1_14_#default#": 0.15,
      "1_39_yes": 0.61,
      "23_24_yes": 0.45,
      "23_36_#default#": 0.1,
      "25_26_yes": 0.5,
      "25_27_#default#": 0.21,
      "27_28_yes": 0.46,
      "27_36_#default#": 0.11,
      "29_30_yes": 0.47,
      "29_31_#default#": 0.32,
      "31_32_yes": 0.48,
      "31_36_#default#": 0.1,
      "46_36_#default#": 0.15,
      "46_47_yes": 0.21,
      "51_9_yes": 0.5,
      "52_5_yes": 0.45,
      "53_7_yes": 0.47,
      "54_11_yes": 0.47,
      "55_21_yes": 0.44,
      "55_23_#default#": 0.22
    },
    "paper": {
      "dimensions": {
        "height": 3555,
        "width": 2560,
        "x": 20,
        "y": -180
      }
    }
  }
